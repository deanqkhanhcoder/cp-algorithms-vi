{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"code_of_conduct.html","title":"Quy t\u1eafc \u1ee9ng x\u1eed (Code of conduct)","text":"<p>Ch\u00fang t\u00f4i \u1ee7ng h\u1ed9 v\u00e0 tu\u00e2n theo quy t\u1eafc \u1ee9ng x\u1eed c\u1ee7a Olympic Tin h\u1ecdc Qu\u1ed1c t\u1ebf (International Olympiad of Informatics), c\u00f3 s\u1eb5n t\u1ea1i trang web IOI.</p>"},{"location":"code_of_conduct.html#checklist","title":"Checklist","text":"<ul> <li>[x] D\u1ecbch c\u00e1c kh\u00e1i ni\u1ec7m k\u1ef9 thu\u1eadt sang ti\u1ebfng Vi\u1ec7t ch\u00ednh x\u00e1c.</li> <li>[x] \u0110\u00e3 c\u1eadp nh\u1eadt c\u00e1c li\u00ean k\u1ebft n\u1ed9i b\u1ed9 (\u0111\u1ebfn 127.0.0.1:8000).</li> <li>[x] \u0110\u1ecbnh d\u1ea1ng l\u1ea1i c\u00e1c c\u00f4ng th\u1ee9c to\u00e1n h\u1ecdc v\u00e0 code block.</li> <li>[x] Ki\u1ec3m tra ch\u00ednh t\u1ea3 v\u00e0 ng\u1eef ph\u00e1p.</li> <li>[x] \u0110\u1ea3m b\u1ea3o t\u00ednh nh\u1ea5t qu\u00e1n v\u1edbi c\u00e1c thu\u1eadt ng\u1eef \u0111\u00e3 d\u1ecbch kh\u00e1c.</li> </ul>"},{"location":"contrib.html","title":"\u0110\u00f3ng g\u00f3p (Contributing)","text":"<p>Kho l\u01b0u tr\u1eef n\u00e0y l\u00e0 b\u1ea3n d\u1ecbch ti\u1ebfng Vi\u1ec7t c\u1ee7a d\u1ef1 \u00e1n <code>cp-algorithms</code> g\u1ed1c.</p>"},{"location":"contrib.html#how-to-contribute","title":"L\u00e0m th\u1ebf n\u00e0o \u0111\u1ec3 \u0111\u00f3ng g\u00f3p (How to contribute)","text":"<p>B\u1ea1n c\u00f3 th\u1ec3 \u0111\u00f3ng g\u00f3p b\u1eb1ng c\u00e1ch: - S\u1eeda l\u1ed7i d\u1ecbch thu\u1eadt - C\u1ea3i thi\u1ec7n s\u1ef1 r\u00f5 r\u00e0ng ho\u1eb7c thu\u1eadt ng\u1eef - D\u1ecbch c\u00e1c b\u00e0i vi\u1ebft m\u1edbi</p> <p>Xin l\u01b0u \u00fd: - Logic thu\u1eadt to\u00e1n, c\u00f4ng th\u1ee9c v\u00e0 m\u00e3 n\u00ean gi\u1eef nguy\u00ean - Thu\u1eadt ng\u1eef n\u00ean tu\u00e2n theo c\u00e1ch s\u1eed d\u1ee5ng c\u1ea1nh tranh l\u1eadp tr\u00ecnh (competitive programming) ph\u1ed5 bi\u1ebfn</p> <p>C\u00e1c \u0111\u00f3ng g\u00f3p li\u00ean quan \u0111\u1ebfn n\u1ed9i dung ti\u1ebfng Anh g\u1ed1c n\u00ean \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n tr\u1ef1c ti\u1ebfp v\u00e0o kho l\u01b0u tr\u1eef ngu\u1ed3n: https://github.com/cp-algorithms/cp-algorithms</p>"},{"location":"contrib.html#checklist","title":"Checklist","text":"<ul> <li>[x] D\u1ecbch c\u00e1c kh\u00e1i ni\u1ec7m k\u1ef9 thu\u1eadt sang ti\u1ebfng Vi\u1ec7t ch\u00ednh x\u00e1c.</li> <li>[x] \u0110\u00e3 c\u1eadp nh\u1eadt c\u00e1c li\u00ean k\u1ebft n\u1ed9i b\u1ed9 (\u0111\u1ebfn 127.0.0.1:8000).</li> <li>[x] \u0110\u1ecbnh d\u1ea1ng l\u1ea1i c\u00e1c c\u00f4ng th\u1ee9c to\u00e1n h\u1ecdc v\u00e0 code block.</li> <li>[x] Ki\u1ec3m tra ch\u00ednh t\u1ea3 v\u00e0 ng\u1eef ph\u00e1p.</li> <li>[x] \u0110\u1ea3m b\u1ea3o t\u00ednh nh\u1ea5t qu\u00e1n v\u1edbi c\u00e1c thu\u1eadt ng\u1eef \u0111\u00e3 d\u1ecbch kh\u00e1c.</li> </ul>"},{"location":"preview.html","title":"Xem tr\u01b0\u1edbc","text":""},{"location":"preview.html#article-preview","title":"Xem tr\u01b0\u1edbc b\u00e0i vi\u1ebft","text":"<p>Th\u00f4ng tin ng\u01b0\u1eddi \u0111\u00f3ng g\u00f3p</p>  # B\u00e0i vi\u1ebft m\u1eabu {: #example-article}  $$a^2 + b^2 = c^2$$  ```cpp int gcd (int a, int b) {     if (b == 0)         return a;     else         return gcd (b, a % b); } ``` Xem tr\u01b0\u1edbc (Ctrl + Enter) <p></p>"},{"location":"preview.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 58</li> <li>Translated lines: 58</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul> <p>Notes: - Translated UI text outside script. - Kept script strings (Loading..., Internal error!, etc.) in English to ensure script logic/safety. - Added anchors.</p>"},{"location":"tags.html","title":"Th\u1ebb (Tags)","text":"<p>File n\u00e0y ch\u1ee9a m\u1ee5c l\u1ee5c to\u00e0n b\u1ed9 c\u00e1c th\u1ebb \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng tr\u00ean trang web.</p>"},{"location":"tags.html#tag:original","title":"Original","text":"<ul> <li>            B\u00e0i to\u00e1n chia k\u1eb9o (Stars and bars)          </li> <li>            C\u00e1c ph\u00e9p to\u00e1n tr\u00ean \u0111a th\u1ee9c v\u00e0 chu\u1ed7i          </li> <li>            Giao n\u1eeda m\u1eb7t ph\u1eb3ng - Thu\u1eadt to\u00e1n S&amp;I trong O(N log N)          </li> <li>            Ki\u1ec3m tra s\u1ed1 nguy\u00ean t\u1ed1          </li> <li>            Kraut &amp; \u0110\u1ecbnh th\u1ee9c          </li> <li>            Li\u00ean ph\u00e2n s\u1ed1          </li> <li>            Lu\u1ed3ng c\u1ef1c \u0111\u1ea1i - Thu\u1eadt to\u00e1n MPM          </li> <li>            M\u00f4 ph\u1ecfng luy\u1ec7n kim (Simulated Annealing)          </li> <li>            Nh\u00e2n Montgomery          </li> <li>            Ph\u00e2n t\u00edch l\u0169y th\u1eeba (Factoring Exponentiation)          </li> <li>            Ph\u00e2n t\u00edch th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1          </li> <li>            Sparse Table          </li> <li>            S\u1ed1 l\u01b0\u1ee3ng \u01b0\u1edbc / T\u1ed5ng c\u00e1c \u01b0\u1edbc          </li> <li>            Thao t\u00e1c bit          </li> <li>            X\u00f3a kh\u1ecfi c\u1ea5u tr\u00fac d\u1eef li\u1ec7u trong O(T(n) log n)          </li> </ul>"},{"location":"tags.html#tag:translated","title":"Translated","text":"<ul> <li>            0-1 BFS          </li> <li>            2-SAT          </li> <li>            Bellman-Ford - t\u00ecm \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t v\u1edbi tr\u1ecdng s\u1ed1 \u00e2m          </li> <li>            Bi\u1ebfn \u0111\u1ed5i Fourier nhanh (FFT)          </li> <li>            Breadth First Search (BFS)          </li> <li>            B\u00e0i to\u00e1n Josephus          </li> <li>            B\u00e0i to\u00e1n MEX (Ph\u1ea7n t\u1eed nh\u1ecf nh\u1ea5t kh\u00f4ng xu\u1ea5t hi\u1ec7n)          </li> <li>            B\u00e0i to\u00e1n RMQ (Range Minimum Query - ph\u1ea7n t\u1eed nh\u1ecf nh\u1ea5t trong \u0111o\u1ea1n)          </li> <li>            B\u00e0i to\u00e1n c\u00e1i t\u00fai          </li> <li>            B\u00e0i to\u00e1n ph\u00e2n c\u00f4ng          </li> <li>            B\u0103m chu\u1ed7i (String Hashing)          </li> <li>            B\u1ed5 \u0111\u1ec1 Burnside / \u0110\u1ecbnh l\u00fd li\u1ec7t k\u00ea P\u00f3lya          </li> <li>            Convex hull trick v\u00e0 Li Chao tree          </li> <li>            C\u00e2y Stern-Brocot v\u00e0 D\u00e3y Farey          </li> <li>            C\u00e2y khung nh\u1ecf nh\u1ea5t - Kruskal v\u00e0 DSU          </li> <li>            C\u00e2y khung nh\u1ecf nh\u1ea5t - Thu\u1eadt to\u00e1n Kruskal          </li> <li>            C\u00e2y khung nh\u1ecf nh\u1ea5t - Thu\u1eadt to\u00e1n Prim          </li> <li>            C\u00e2y khung nh\u1ecf nh\u1ea5t th\u1ee9 hai - D\u00f9ng Kruskal v\u00e0 LCA          </li> <li>            C\u0103n nguy\u00ean th\u1ee7y          </li> <li>            C\u0103n r\u1eddi r\u1ea1c          </li> <li>            Depth First Search (DFS)          </li> <li>            Dijkstra - t\u00ecm \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t t\u1eeb m\u1ed9t \u0111\u1ec9nh          </li> <li>            Dijkstra tr\u00ean \u0111\u1ed3 th\u1ecb th\u01b0a          </li> <li>            Disjoint Set Union (DSU)          </li> <li>            Di\u1ec7n t\u00edch c\u00f3 h\u01b0\u1edbng c\u1ee7a tam gi\u00e1c          </li> <li>            Di\u1ec7n t\u00edch \u0111a gi\u00e1c \u0111\u01a1n          </li> <li>            D\u00e3y con t\u0103ng d\u00e0i nh\u1ea5t          </li> <li>            D\u00e3y ngo\u1eb7c \u0111\u00fang          </li> <li>            Fenwick Tree          </li> <li>            Floyd-Warshall - t\u00ecm m\u1ecdi \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t          </li> <li>            Gauss &amp; H\u1ec7 ph\u01b0\u01a1ng tr\u00ecnh tuy\u1ebfn t\u00ednh          </li> <li>            Gauss &amp; \u0110\u1ecbnh th\u1ee9c          </li> <li>            Giai th\u1eeba modulo p          </li> <li>            Giao c\u1ee7a c\u00e1c \u0111o\u1ea1n th\u1eb3ng          </li> <li>            Giao c\u1ee7a hai \u0111\u01b0\u1eddng tr\u00f2n          </li> <li>            Giao c\u1ee7a \u0111\u01b0\u1eddng tr\u00f2n v\u00e0 \u0111\u01b0\u1eddng th\u1eb3ng          </li> <li>            Giao \u0111i\u1ec3m c\u1ee7a \u0111\u01b0\u1eddng th\u1eb3ng          </li> <li>            Gi\u1ea3i RMQ b\u1eb1ng LCA          </li> <li>            Gi\u1edbi thi\u1ec7u v\u1ec1 Quy ho\u1ea1ch \u0111\u1ed9ng          </li> <li>            Heavy-light decomposition (HLD)          </li> <li>            H\u00e0m Z (Z-function)          </li> <li>            H\u00e0m phi Euler          </li> <li>            H\u00e0m ti\u1ec1n t\u1ed1 - Knuth-Morris-Pratt          </li> <li>            H\u00ecnh h\u1ecdc c\u01a1 b\u1ea3n          </li> <li>            H\u1ea1ng c\u1ee7a ma tr\u1eadn          </li> <li>            H\u1ec7 s\u1ed1 nh\u1ecb th\u1ee9c          </li> <li>            H\u1ec7 tam ph\u00e2n c\u00e2n b\u1eb1ng          </li> <li>            Kho\u1ea3ng c\u00e1ch Manhattan          </li> <li>            Ki\u1ec3m tra hai \u0111o\u1ea1n th\u1eb3ng c\u1eaft nhau          </li> <li>            Ki\u1ec3m tra t\u00ednh kh\u00f4ng chu tr\u00ecnh v\u00e0 t\u00ecm chu tr\u00ecnh trong O(M)          </li> <li>            Ki\u1ec3m tra \u0111i\u1ec3m thu\u1ed9c \u0111a gi\u00e1c l\u1ed3i trong O(log N)          </li> <li>            Ki\u1ec3m tra \u0111\u1ed3 th\u1ecb hai ph\u00eda          </li> <li>            LCA - Binary Lifting          </li> <li>            LCA - Thu\u1eadt to\u00e1n Farach-Colton v\u00e0 Bender          </li> <li>            LCA - Thu\u1eadt to\u00e1n Tarjan (Offline)          </li> <li>            Li\u1ec7t k\u00ea submask c\u1ee7a m\u1ed9t bitmask          </li> <li>            Logarit r\u1eddi r\u1ea1c          </li> <li>            Lowest Common Ancestor (LCA)          </li> <li>            Lu\u1ed3ng chi ph\u00ed nh\u1ecf nh\u1ea5t          </li> <li>            Lu\u1ed3ng c\u00f3 y\u00eau c\u1ea7u (Flows with demands)          </li> <li>            Lu\u1ed3ng c\u1ef1c \u0111\u1ea1i - Ford-Fulkerson v\u00e0 Edmonds-Karp          </li> <li>            Lu\u1ed3ng c\u1ef1c \u0111\u1ea1i - Thu\u1eadt to\u00e1n Dinic          </li> <li>            Lu\u1ed3ng c\u1ef1c \u0111\u1ea1i - Thu\u1eadt to\u00e1n Push-relabel          </li> <li>            Lu\u1ed3ng c\u1ef1c \u0111\u1ea1i - Thu\u1eadt to\u00e1n Push-relabel c\u1ea3i ti\u1ebfn          </li> <li>            L\u0169y th\u1eeba nh\u1ecb ph\u00e2n          </li> <li>            L\u1eadp l\u1ecbch tr\u00ean hai m\u00e1y          </li> <li>            L\u1eadp l\u1ecbch tr\u00ean m\u1ed9t m\u00e1y          </li> <li>            L\u1ecbch t\u1ed1i \u01b0u v\u1edbi deadline v\u00e0 th\u1eddi l\u01b0\u1ee3ng          </li> <li>            Minimum Stack / Minimum Queue          </li> <li>            M\u00e3 Gray          </li> <li>            M\u00e3 Pr\u00fcfer          </li> <li>            Ngh\u1ecbch \u0111\u1ea3o module          </li> <li>            Nguy\u00ean l\u00fd bao h\u00e0m - lo\u1ea1i tr\u1eeb          </li> <li>            Ph\u00e2n r\u00e3 Lyndon          </li> <li>            Ph\u00e2n r\u00e3 d\u1ecdc (Vertical decomposition)          </li> <li>            Ph\u00e2n t\u00edch bi\u1ec3u th\u1ee9c          </li> <li>            Ph\u01b0\u01a1ng ph\u00e1p Newton t\u00ecm nghi\u1ec7m          </li> <li>            Ph\u01b0\u01a1ng tr\u00ecnh Diophantine tuy\u1ebfn t\u00ednh          </li> <li>            Ph\u01b0\u01a1ng tr\u00ecnh \u0111\u1ed3ng d\u01b0 tuy\u1ebfn t\u00ednh          </li> <li>            Quy ho\u1ea1ch \u0111\u1ed9ng chia \u0111\u1ec3 tr\u1ecb          </li> <li>            Quy ho\u1ea1ch \u0111\u1ed9ng tr\u00ean profile g\u00e3y. B\u00e0i to\u00e1n \"Parquet\"          </li> <li>            Randomized Heap          </li> <li>            Segment Tree          </li> <li>            Sinh t\u1ea5t c\u1ea3 t\u1ed5 h\u1ee3p ch\u1eadp K          </li> <li>            Sqrt Decomposition          </li> <li>            Sqrt Tree          </li> <li>            Suffix Array          </li> <li>            Suffix Automaton          </li> <li>            Suffix Tree          </li> <li>            S\u00e0ng Eratosthenes          </li> <li>            S\u00e0ng tuy\u1ebfn t\u00ednh          </li> <li>            S\u1eafp x\u1ebfp topo          </li> <li>            S\u1ed1 Catalan          </li> <li>            S\u1ed1 Fibonacci          </li> <li>            S\u1ed1 h\u1ecdc \u0111\u1ed9 ch\u00ednh x\u00e1c t\u00f9y \u00fd          </li> <li>            S\u1ed1 \u0111\u01b0\u1eddng \u0111i \u0111\u1ed9 d\u00e0i c\u1ed1 \u0111\u1ecbnh / \u0110\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t \u0111\u1ed9 d\u00e0i c\u1ed1 \u0111\u1ecbnh          </li> <li>            Tam gi\u00e1c h\u00f3a Delaunay v\u00e0 bi\u1ec3u \u0111\u1ed3 Voronoi          </li> <li>            Thu\u1eadt to\u00e1n Aho-Corasick          </li> <li>            Thu\u1eadt to\u00e1n D\u00b4Esopo-Pape          </li> <li>            Thu\u1eadt to\u00e1n Euclid m\u1edf r\u1ed9ng          </li> <li>            Thu\u1eadt to\u00e1n Euclid t\u00ecm \u01b0\u1edbc chung l\u1edbn nh\u1ea5t          </li> <li>            Thu\u1eadt to\u00e1n Hungary          </li> <li>            Thu\u1eadt to\u00e1n Kuhn - C\u1eb7p gh\u00e9p c\u1ef1c \u0111\u1ea1i tr\u00ean \u0111\u1ed3 th\u1ecb hai ph\u00eda          </li> <li>            Thu\u1eadt to\u00e1n Manacher - T\u00ecm t\u1ea5t c\u1ea3 c\u00e1c palindrome con trong O(N)          </li> <li>            Thu\u1eadt to\u00e1n Rabin-Karp cho so kh\u1edbp chu\u1ed7i          </li> <li>            Thu\u1eadt to\u00e1n R\u00f9a v\u00e0 Th\u1ecf (Ph\u00e1t hi\u1ec7n chu tr\u00ecnh trong danh s\u00e1ch li\u00ean k\u1ebft)          </li> <li>            Th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh v\u00e0 \u0111\u1ed3 th\u1ecb n\u00e9n          </li> <li>            Ti\u1ebfp tuy\u1ebfn chung c\u1ee7a hai \u0111\u01b0\u1eddng tr\u00f2n          </li> <li>            Treap          </li> <li>            Tr\u00f2 ch\u01a1i 15 Puzzle: S\u1ef1 t\u1ed3n t\u1ea1i c\u1ee7a l\u1eddi gi\u1ea3i          </li> <li>            Tr\u00f2 ch\u01a1i tr\u00ean \u0111\u1ed3 th\u1ecb b\u1ea5t k\u1ef3          </li> <li>            T\u00ecm chu tr\u00ecnh \u00e2m trong \u0111\u1ed3 th\u1ecb          </li> <li>            T\u00ecm c\u00e1c m\u1eb7t c\u1ee7a \u0111\u1ed3 th\u1ecb ph\u1eb3ng          </li> <li>            T\u00ecm c\u1ea7u Online          </li> <li>            T\u00ecm c\u1ea7u trong O(N+M)          </li> <li>            T\u00ecm c\u1eb7p \u0111i\u1ec3m g\u1ea7n nh\u1ea5t          </li> <li>            T\u00ecm c\u1eb7p \u0111o\u1ea1n th\u1eb3ng c\u1eaft nhau          </li> <li>            T\u00ecm kh\u1edbp trong O(N+M)          </li> <li>            T\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n          </li> <li>            T\u00ecm ki\u1ebfm tam ph\u00e2n          </li> <li>            T\u00ecm l\u1eb7p l\u1ea1i          </li> <li>            T\u00ecm ma tr\u1eadn con to\u00e0n s\u1ed1 0 l\u1edbn nh\u1ea5t          </li> <li>            T\u00ecm ph\u01b0\u01a1ng tr\u00ecnh \u0111\u01b0\u1eddng th\u1eb3ng \u0111i qua \u0111o\u1ea1n th\u1eb3ng          </li> <li>            T\u00ecm s\u1ed1 m\u0169 c\u1ee7a \u01b0\u1edbc giai th\u1eeba          </li> <li>            T\u00ecm th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng          </li> <li>            T\u00ecm th\u1ed1ng k\u00ea th\u1ee9 K trong O(N)          </li> <li>            T\u00ecm \u0111o\u1ea1n con c\u00f3 t\u1ed5ng l\u1edbn nh\u1ea5t/nh\u1ecf nh\u1ea5t          </li> <li>            T\u00edch ph\u00e2n theo c\u00f4ng th\u1ee9c Simpson          </li> <li>            T\u00f4 m\u00e0u c\u00e2y          </li> <li>            T\u1ed1i \u01b0u h\u00f3a Knuth          </li> <li>            T\u1ed5ng Minkowski c\u1ee7a c\u00e1c \u0111a gi\u00e1c l\u1ed3i          </li> <li>            X\u00e1c \u0111\u1ecbnh v\u1ecb tr\u00ed \u0111i\u1ec3m trong O(log N)          </li> <li>            X\u00e2y d\u1ef1ng bao l\u1ed3i          </li> <li>            X\u1ebfp qu\u00e2n T\u01b0\u1ee3ng tr\u00ean b\u00e0n c\u1edd          </li> <li>            \u0110i\u1ec3m nguy\u00ean c\u1ee7a \u0111a gi\u00e1c kh\u00f4ng nguy\u00ean          </li> <li>            \u0110\u01b0\u1eddng tr\u00f2n bao nh\u1ecf nh\u1ea5t          </li> <li>            \u0110\u01b0\u1eddng \u0111i Euler          </li> <li>            \u0110\u1ebfm \u0111\u1ed3 th\u1ecb c\u00f3 nh\u00e3n          </li> <li>            \u0110\u1ecbnh h\u01b0\u1edbng m\u1ea1nh          </li> <li>            \u0110\u1ecbnh l\u00fd Kirchhoff          </li> <li>            \u0110\u1ecbnh l\u00fd Pick - di\u1ec7n t\u00edch \u0111a gi\u00e1c nguy\u00ean          </li> <li>            \u0110\u1ecbnh l\u00fd Sprague-Grundy. Tr\u00f2 ch\u01a1i Nim          </li> <li>            \u0110\u1ecbnh l\u00fd th\u1eb7ng d\u01b0 Trung Hoa          </li> <li>            \u0110\u1ed9 d\u00e0i h\u1ee3p c\u1ee7a c\u00e1c \u0111o\u1ea1n th\u1eb3ng          </li> <li>            \u0110\u1ed9 li\u00ean th\u00f4ng c\u1ea1nh / \u0110\u1ed9 li\u00ean th\u00f4ng \u0111\u1ec9nh          </li> </ul>"},{"location":"tags.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 6</li> <li>Translated lines: 6</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul> <p>Notes: - Added {: #tags} anchor.</p>"},{"location":"algebra/all-submasks.html","title":"Li\u1ec7t k\u00ea Submask","text":"","tags":["Translated"]},{"location":"algebra/all-submasks.html#enumerating-all-submasks-of-a-given-mask","title":"Li\u1ec7t k\u00ea t\u1ea5t c\u1ea3 submask c\u1ee7a m\u1ed9t mask cho tr\u01b0\u1edbc","text":"<p>Cho m\u1ed9t bitmask $m$, b\u1ea1n mu\u1ed1n duy\u1ec7t hi\u1ec7u qu\u1ea3 qua t\u1ea5t c\u1ea3 c\u00e1c submask c\u1ee7a n\u00f3, t\u1ee9c l\u00e0 c\u00e1c mask $s$ m\u00e0 ch\u1ec9 c\u00f3 c\u00e1c bit \u0111\u01b0\u1ee3c b\u1eadt trong mask $m$ m\u1edbi \u0111\u01b0\u1ee3c b\u1eadt.</p> <p>Xem x\u00e9t c\u00e0i \u0111\u1eb7t thu\u1eadt to\u00e1n n\u00e0y, d\u1ef1a tr\u00ean c\u00e1c th\u1ee7 thu\u1eadt thao t\u00e1c bit:</p> <pre><code>int s = m;\nwhile (s &gt; 0) {\n ... you can use s ...\n s = (s-1) &amp; m;\n}\n</code></pre> <p>ho\u1eb7c, s\u1eed d\u1ee5ng v\u00f2ng l\u1eb7p <code>for</code> g\u1ecdn h\u01a1n:</p> <pre><code>for (int s=m; s; s=(s-1)&amp;m)\n ... you can use s ...\n</code></pre> <p>Trong c\u1ea3 hai bi\u1ebfn th\u1ec3 code, submask b\u1eb1ng 0 s\u1ebd kh\u00f4ng \u0111\u01b0\u1ee3c x\u1eed l\u00fd. Ch\u00fang ta c\u00f3 th\u1ec3 x\u1eed l\u00fd n\u00f3 b\u00ean ngo\u00e0i v\u00f2ng l\u1eb7p, ho\u1eb7c s\u1eed d\u1ee5ng thi\u1ebft k\u1ebf k\u00e9m thanh l\u1ecbch h\u01a1n, v\u00ed d\u1ee5:</p> <pre><code>for (int s=m; ; s=(s-1)&amp;m) {\n ... you can use s ...\n if (s==0)  break;\n}\n</code></pre> <p>H\u00e3y xem t\u1ea1i sao code tr\u00ean duy\u1ec7t qua t\u1ea5t c\u1ea3 c\u00e1c submask c\u1ee7a $m$, kh\u00f4ng l\u1eb7p l\u1ea1i, v\u00e0 theo th\u1ee9 t\u1ef1 gi\u1ea3m d\u1ea7n.</p> <p>Gi\u1ea3 s\u1eed ch\u00fang ta c\u00f3 bitmask hi\u1ec7n t\u1ea1i $s$, v\u00e0 ch\u00fang ta mu\u1ed1n chuy\u1ec3n sang bitmask ti\u1ebfp theo. B\u1eb1ng c\u00e1ch tr\u1eeb mask $s$ \u0111i m\u1ed9t \u0111\u01a1n v\u1ecb, ch\u00fang ta s\u1ebd x\u00f3a bit b\u1eadt ph\u1ea3i nh\u1ea5t v\u00e0 t\u1ea5t c\u1ea3 c\u00e1c bit b\u00ean ph\u1ea3i n\u00f3 s\u1ebd tr\u1edf th\u00e0nh 1. Sau \u0111\u00f3 ch\u00fang ta lo\u1ea1i b\u1ecf t\u1ea5t c\u1ea3 c\u00e1c bit 1 \"th\u1eeba\" kh\u00f4ng c\u00f3 trong mask $m$ v\u00e0 do \u0111\u00f3 kh\u00f4ng th\u1ec3 l\u00e0 m\u1ed9t ph\u1ea7n c\u1ee7a submask. Ch\u00fang ta th\u1ef1c hi\u1ec7n vi\u1ec7c lo\u1ea1i b\u1ecf n\u00e0y b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng ph\u00e9p to\u00e1n bit <code>(s-1) &amp; m</code>. K\u1ebft qu\u1ea3 l\u00e0, ch\u00fang ta \"c\u1eaft\" mask $s-1$ \u0111\u1ec3 x\u00e1c \u0111\u1ecbnh gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t m\u00e0 n\u00f3 c\u00f3 th\u1ec3 nh\u1eadn, \u0111\u00f3 l\u00e0 submask ti\u1ebfp theo sau $s$ theo th\u1ee9 t\u1ef1 gi\u1ea3m d\u1ea7n.</p> <p>Do \u0111\u00f3, thu\u1eadt to\u00e1n n\u00e0y sinh t\u1ea5t c\u1ea3 c\u00e1c submask c\u1ee7a mask n\u00e0y theo th\u1ee9 t\u1ef1 gi\u1ea3m d\u1ea7n, ch\u1ec9 th\u1ef1c hi\u1ec7n hai ph\u00e9p to\u00e1n m\u1ed7i l\u1ea7n l\u1eb7p.</p> <p>M\u1ed9t tr\u01b0\u1eddng h\u1ee3p \u0111\u1eb7c bi\u1ec7t l\u00e0 khi $s = 0$. Sau khi th\u1ef1c hi\u1ec7n $s-1$ ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c mask m\u00e0 t\u1ea5t c\u1ea3 c\u00e1c bit \u0111\u1ec1u b\u1eadt (bi\u1ec3u di\u1ec5n bit c\u1ee7a -1), v\u00e0 sau <code>(s-1) &amp; m</code> ch\u00fang ta s\u1ebd c\u00f3 $s$ b\u1eb1ng $m$. V\u00ec v\u1eady, v\u1edbi mask $s = 0$ h\u00e3y c\u1ea9n th\u1eadn \u2014 n\u1ebfu v\u00f2ng l\u1eb7p kh\u00f4ng k\u1ebft th\u00fac t\u1ea1i 0, thu\u1eadt to\u00e1n c\u00f3 th\u1ec3 r\u01a1i v\u00e0o v\u00f2ng l\u1eb7p v\u00f4 h\u1ea1n.</p>","tags":["Translated"]},{"location":"algebra/all-submasks.html#iterating-through-all-masks-with-their-submasks-complexity-o3n","title":"Duy\u1ec7t t\u1ea5t c\u1ea3 mask c\u00f9ng c\u00e1c submask c\u1ee7a n\u00f3. \u0110\u1ed9 ph\u1ee9c t\u1ea1p $O(3^n)$","text":"<p>Trong nhi\u1ec1u b\u00e0i to\u00e1n, \u0111\u1eb7c bi\u1ec7t l\u00e0 nh\u1eefng b\u00e0i s\u1eed d\u1ee5ng quy ho\u1ea1ch \u0111\u1ed9ng bitmask (bitmask DP), b\u1ea1n mu\u1ed1n duy\u1ec7t qua t\u1ea5t c\u1ea3 bitmask v\u00e0 v\u1edbi m\u1ed7i mask, duy\u1ec7t qua t\u1ea5t c\u1ea3 c\u00e1c submask c\u1ee7a n\u00f3:</p> <pre><code>for (int m=0; m&lt;(1&lt;&lt;n); ++m)\n    for (int s=m; s; s=(s-1)&amp;m)\n ... s and m ...\n</code></pre> <p>H\u00e3y ch\u1ee9ng minh r\u1eb1ng v\u00f2ng l\u1eb7p trong s\u1ebd th\u1ef1c hi\u1ec7n t\u1ed5ng c\u1ed9ng $O(3^n)$ l\u1ea7n l\u1eb7p.</p> <p>Ch\u1ee9ng minh 1: Xem x\u00e9t bit th\u1ee9 $i$. C\u00f3 \u0111\u00fang ba kh\u1ea3 n\u0103ng cho n\u00f3:</p> <ol> <li>n\u00f3 kh\u00f4ng n\u1eb1m trong mask $m$ (v\u00e0 do \u0111\u00f3 kh\u00f4ng n\u1eb1m trong submask $s$),</li> <li>n\u00f3 n\u1eb1m trong $m$, nh\u01b0ng kh\u00f4ng n\u1eb1m trong $s$, ho\u1eb7c</li> <li>n\u00f3 n\u1eb1m trong c\u1ea3 $m$ v\u00e0 $s$.</li> </ol> <p>V\u00ec c\u00f3 t\u1ed5ng c\u1ed9ng $n$ bit, s\u1ebd c\u00f3 $3^n$ t\u1ed5 h\u1ee3p kh\u00e1c nhau.</p> <p>Ch\u1ee9ng minh 2: L\u01b0u \u00fd r\u1eb1ng n\u1ebfu mask $m$ c\u00f3 $k$ bit b\u1eadt, th\u00ec n\u00f3 s\u1ebd c\u00f3 $2^k$ submask. V\u00ec ch\u00fang ta c\u00f3 t\u1ed5ng c\u1ed9ng $\\binom{n}{k}$ mask c\u00f3 $k$ bit b\u1eadt (xem h\u1ec7 s\u1ed1 nh\u1ecb th\u1ee9c), n\u00ean t\u1ed5ng s\u1ed1 t\u1ed5 h\u1ee3p cho t\u1ea5t c\u1ea3 c\u00e1c mask s\u1ebd l\u00e0:</p> $$\\sum_{k=0}^n \\binom{n}{k} \\cdot 2^k$$ <p>\u0110\u1ec3 t\u00ednh s\u1ed1 n\u00e0y, l\u01b0u \u00fd r\u1eb1ng t\u1ed5ng tr\u00ean b\u1eb1ng khai tri\u1ec3n c\u1ee7a $(1+2)^n$ s\u1eed d\u1ee5ng \u0111\u1ecbnh l\u00fd nh\u1ecb th\u1ee9c. Do \u0111\u00f3, ch\u00fang ta c\u00f3 $3^n$ t\u1ed5 h\u1ee3p, nh\u01b0 ch\u00fang ta mu\u1ed1n ch\u1ee9ng minh.</p>","tags":["Translated"]},{"location":"algebra/all-submasks.html#practice-problems","title":"B\u00e0i t\u1eadp luy\u1ec7n t\u1eadp","text":"<ul> <li>Atcoder - Close Group</li> <li>Codeforces - Nuclear Fusion</li> <li>Codeforces - Sandy and Nuts</li> <li>Uva 1439 - Exclusive Access 2</li> <li>UVa 11825 - Hackers' Crackdown</li> </ul>","tags":["Translated"]},{"location":"algebra/all-submasks.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 80</li> <li>Translated lines: 80</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul> <p>Notes: - Translated successfully. - Kept 'submask', 'mask', 'bitmask DP' in English.</p>","tags":["Translated"]},{"location":"algebra/balanced-ternary.html","title":"H\u1ec7 tam ph\u00e2n c\u00e2n b\u1eb1ng (Balanced Ternary)","text":"<p>\u0110\u00e2y l\u00e0 m\u1ed9t h\u1ec7 \u0111\u1ebfm v\u1ecb tr\u00ed kh\u00f4ng chu\u1ea9n nh\u01b0ng v\u1eabn l\u00e0 h\u1ec7 \u0111\u1ebfm v\u1ecb tr\u00ed. \u0110\u1eb7c \u0111i\u1ec3m c\u1ee7a n\u00f3 l\u00e0 c\u00e1c ch\u1eef s\u1ed1 c\u00f3 th\u1ec3 nh\u1eadn m\u1ed9t trong c\u00e1c gi\u00e1 tr\u1ecb <code>-1</code>, <code>0</code> v\u00e0 <code>1</code>. Tuy nhi\u00ean, c\u01a1 s\u1ed1 c\u1ee7a n\u00f3 v\u1eabn l\u00e0 <code>3</code> (v\u00ec c\u00f3 ba gi\u00e1 tr\u1ecb c\u00f3 th\u1ec3). V\u00ec vi\u1ec7c vi\u1ebft <code>-1</code> nh\u01b0 m\u1ed9t ch\u1eef s\u1ed1 kh\u00f4ng thu\u1eadn ti\u1ec7n, ch\u00fang t\u00f4i s\u1ebd s\u1eed d\u1ee5ng k\u00fd t\u1ef1 <code>Z</code> sau \u0111\u00e2y cho m\u1ee5c \u0111\u00edch n\u00e0y. N\u1ebfu b\u1ea1n ngh\u0129 \u0111\u00e2y l\u00e0 m\u1ed9t h\u1ec7 th\u1ed1ng kh\u00e1 l\u1ea1 - h\u00e3y nh\u00ecn v\u00e0o b\u1ee9c \u1ea3nh - \u0111\u00e2y l\u00e0 m\u1ed9t trong nh\u1eefng chi\u1ebfc m\u00e1y t\u00ednh s\u1eed d\u1ee5ng n\u00f3.</p> <p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 v\u00e0i s\u1ed1 \u0111\u1ea7u ti\u00ean \u0111\u01b0\u1ee3c vi\u1ebft trong h\u1ec7 tam ph\u00e2n c\u00e2n b\u1eb1ng:</p> <pre><code>    0    0\n    1    1\n    2    1Z\n    3    10\n    4    11\n    5    1ZZ\n    6    1Z0\n    7    1Z1\n    8    10Z\n    9    100\n</code></pre> <p>H\u1ec7 th\u1ed1ng n\u00e0y cho ph\u00e9p b\u1ea1n vi\u1ebft c\u00e1c gi\u00e1 tr\u1ecb \u00e2m m\u00e0 kh\u00f4ng c\u1ea7n d\u1ea5u tr\u1eeb \u1edf \u0111\u1ea7u: b\u1ea1n ch\u1ec9 c\u1ea7n \u0111\u1ea3o ng\u01b0\u1ee3c c\u00e1c ch\u1eef s\u1ed1 trong b\u1ea5t k\u1ef3 s\u1ed1 d\u01b0\u01a1ng n\u00e0o.</p> <pre><code>    -1   Z\n    -2   Z1\n    -3   Z0\n    -4   ZZ\n    -5   Z11\n</code></pre> <p>L\u01b0u \u00fd r\u1eb1ng s\u1ed1 \u00e2m b\u1eaft \u0111\u1ea7u b\u1eb1ng <code>Z</code> v\u00e0 s\u1ed1 d\u01b0\u01a1ng b\u1eaft \u0111\u1ea7u b\u1eb1ng <code>1</code>.</p>","tags":["Translated"]},{"location":"algebra/balanced-ternary.html#conversion-algorithm","title":"Thu\u1eadt to\u00e1n chuy\u1ec3n \u0111\u1ed5i","text":"<p>R\u1ea5t d\u1ec5 d\u00e0ng \u0111\u1ec3 bi\u1ec3u di\u1ec5n m\u1ed9t s\u1ed1 \u0111\u00e3 cho trong h\u1ec7 tam ph\u00e2n c\u00e2n b\u1eb1ng th\u00f4ng qua vi\u1ec7c bi\u1ec3u di\u1ec5n t\u1ea1m th\u1eddi n\u00f3 trong h\u1ec7 tam ph\u00e2n th\u01b0\u1eddng. Khi gi\u00e1 tr\u1ecb \u1edf h\u1ec7 tam ph\u00e2n chu\u1ea9n, c\u00e1c ch\u1eef s\u1ed1 c\u1ee7a n\u00f3 l\u00e0 <code>0</code> ho\u1eb7c <code>1</code> ho\u1eb7c <code>2</code>. Duy\u1ec7t t\u1eeb ch\u1eef s\u1ed1 th\u1ea5p nh\u1ea5t, ch\u00fang ta c\u00f3 th\u1ec3 b\u1ecf qua c\u00e1c s\u1ed1 <code>0</code> v\u00e0 <code>1</code> m\u1ed9t c\u00e1ch an to\u00e0n, tuy nhi\u00ean <code>2</code> n\u00ean \u0111\u01b0\u1ee3c chuy\u1ec3n th\u00e0nh <code>Z</code> c\u00f9ng v\u1edbi vi\u1ec7c c\u1ed9ng <code>1</code> v\u00e0o ch\u1eef s\u1ed1 ti\u1ebfp theo. Ch\u1eef s\u1ed1 <code>3</code> n\u00ean \u0111\u01b0\u1ee3c chuy\u1ec3n th\u00e0nh <code>0</code> v\u1edbi c\u00f9ng \u0111i\u1ec1u ki\u1ec7n - nh\u1eefng ch\u1eef s\u1ed1 nh\u01b0 v\u1eady kh\u00f4ng c\u00f3 trong s\u1ed1 ban \u0111\u1ea7u nh\u01b0ng ch\u00fang c\u00f3 th\u1ec3 xu\u1ea5t hi\u1ec7n sau khi t\u0103ng m\u1ed9t s\u1ed1 <code>2</code>.</p> <p>V\u00ed d\u1ee5 1: H\u00e3y chuy\u1ec3n <code>64</code> sang h\u1ec7 tam ph\u00e2n c\u00e2n b\u1eb1ng. \u0110\u1ea7u ti\u00ean ch\u00fang ta d\u00f9ng h\u1ec7 tam ph\u00e2n th\u01b0\u1eddng \u0111\u1ec3 vi\u1ebft l\u1ea1i s\u1ed1:</p> $$ 64_{10} = 02101_{3} $$ <p>H\u00e3y x\u1eed l\u00fd n\u00f3 t\u1eeb ch\u1eef s\u1ed1 \u00edt quan tr\u1ecdng nh\u1ea5t (ngo\u00e0i c\u00f9ng b\u00ean ph\u1ea3i):</p> <ul> <li><code>1</code>,<code>0</code> v\u00e0 <code>1</code> \u0111\u01b0\u1ee3c b\u1ecf qua gi\u1eef nguy\u00ean. (V\u00ec <code>0</code> v\u00e0 <code>1</code> \u0111\u01b0\u1ee3c ph\u00e9p trong h\u1ec7 tam ph\u00e2n c\u00e2n b\u1eb1ng)</li> <li><code>2</code> \u0111\u01b0\u1ee3c chuy\u1ec3n th\u00e0nh <code>Z</code> t\u0103ng ch\u1eef s\u1ed1 b\u00ean tr\u00e1i n\u00f3, v\u00ec v\u1eady ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c <code>1Z101</code>.</li> </ul> <p>K\u1ebft qu\u1ea3 cu\u1ed1i c\u00f9ng l\u00e0 <code>1Z101</code>.</p> <p>H\u00e3y chuy\u1ec3n \u0111\u1ed5i ng\u01b0\u1ee3c l\u1ea1i sang h\u1ec7 th\u1eadp ph\u00e2n b\u1eb1ng c\u00e1ch c\u1ed9ng c\u00e1c gi\u00e1 tr\u1ecb v\u1ecb tr\u00ed c\u00f3 tr\u1ecdng s\u1ed1:</p> $$ 1Z101 = 81 \\cdot 1 + 27 \\cdot (-1) + 9 \\cdot 1 + 3 \\cdot 0 + 1 \\cdot 1 = 64_{10} $$ <p>V\u00ed d\u1ee5 2: H\u00e3y chuy\u1ec3n <code>237</code> sang h\u1ec7 tam ph\u00e2n c\u00e2n b\u1eb1ng. \u0110\u1ea7u ti\u00ean ch\u00fang ta d\u00f9ng h\u1ec7 tam ph\u00e2n th\u01b0\u1eddng \u0111\u1ec3 vi\u1ebft l\u1ea1i s\u1ed1:</p> $$ 237_{10} = 22210_{3} $$ <p>H\u00e3y x\u1eed l\u00fd n\u00f3 t\u1eeb ch\u1eef s\u1ed1 \u00edt quan tr\u1ecdng nh\u1ea5t (ngo\u00e0i c\u00f9ng b\u00ean ph\u1ea3i):</p> <ul> <li><code>0</code> v\u00e0 <code>1</code> \u0111\u01b0\u1ee3c b\u1ecf qua gi\u1eef nguy\u00ean. (V\u00ec <code>0</code> v\u00e0 <code>1</code> \u0111\u01b0\u1ee3c ph\u00e9p trong h\u1ec7 tam ph\u00e2n c\u00e2n b\u1eb1ng)</li> <li><code>2</code> \u0111\u01b0\u1ee3c chuy\u1ec3n th\u00e0nh <code>Z</code> t\u0103ng ch\u1eef s\u1ed1 b\u00ean tr\u00e1i n\u00f3, v\u00ec v\u1eady ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c <code>23Z10</code>.</li> <li><code>3</code> \u0111\u01b0\u1ee3c chuy\u1ec3n th\u00e0nh <code>0</code> t\u0103ng ch\u1eef s\u1ed1 b\u00ean tr\u00e1i n\u00f3, v\u00ec v\u1eady ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c <code>30Z10</code>.</li> <li><code>3</code> \u0111\u01b0\u1ee3c chuy\u1ec3n th\u00e0nh <code>0</code> t\u0103ng ch\u1eef s\u1ed1 b\u00ean tr\u00e1i n\u00f3 (m\u1eb7c \u0111\u1ecbnh l\u00e0 <code>0</code>), v\u00e0 v\u00ec v\u1eady ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c <code>100Z10</code>.</li> </ul> <p>K\u1ebft qu\u1ea3 cu\u1ed1i c\u00f9ng l\u00e0 <code>100Z10</code>.</p> <p>H\u00e3y chuy\u1ec3n \u0111\u1ed5i ng\u01b0\u1ee3c l\u1ea1i sang h\u1ec7 th\u1eadp ph\u00e2n b\u1eb1ng c\u00e1ch c\u1ed9ng c\u00e1c gi\u00e1 tr\u1ecb v\u1ecb tr\u00ed c\u00f3 tr\u1ecdng s\u1ed1:</p> $$ 100Z10 = 243 \\cdot 1 + 81 \\cdot 0 + 27 \\cdot 0 + 9 \\cdot (-1) + 3 \\cdot 1 + 1 \\cdot 0 = 237_{10} $$","tags":["Translated"]},{"location":"algebra/balanced-ternary.html#practice-problems","title":"B\u00e0i t\u1eadp luy\u1ec7n t\u1eadp","text":"<ul> <li>Topcoder SRM 604, Div1-250</li> </ul>","tags":["Translated"]},{"location":"algebra/balanced-ternary.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 85</li> <li>Translated lines: 85</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Translated"]},{"location":"algebra/big-integer.html","title":"S\u1ed1 h\u1ecdc \u0111\u1ed9 ch\u00ednh x\u00e1c t\u00f9y \u00fd (Arbitrary-Precision Arithmetic)","text":"<p>S\u1ed1 h\u1ecdc \u0111\u1ed9 ch\u00ednh x\u00e1c t\u00f9y \u00fd, c\u00f2n \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 \"bignum\" hay \u0111\u01a1n gi\u1ea3n l\u00e0 \"s\u1ed1 h\u1ecdc l\u1edbn\" (long arithmetic) l\u00e0 m\u1ed9t t\u1eadp h\u1ee3p c\u00e1c c\u1ea5u tr\u00fac d\u1eef li\u1ec7u v\u00e0 thu\u1eadt to\u00e1n cho ph\u00e9p x\u1eed l\u00fd c\u00e1c s\u1ed1 l\u1edbn h\u01a1n nhi\u1ec1u so v\u1edbi kh\u1ea3 n\u0103ng l\u1eefu tr\u1eef c\u1ee7a c\u00e1c ki\u1ec3u d\u1eef li\u1ec7u chu\u1ea9n. D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u1ed9t s\u1ed1 lo\u1ea1i s\u1ed1 h\u1ecdc \u0111\u1ed9 ch\u00ednh x\u00e1c t\u00f9y \u00fd.</p>","tags":["Translated"]},{"location":"algebra/big-integer.html#classical-integer-long-arithmetic","title":"S\u1ed1 h\u1ecdc s\u1ed1 nguy\u00ean l\u1edbn c\u1ed5 \u0111i\u1ec3n","text":"<p>\u00dd t\u01b0\u1edfng ch\u00ednh l\u00e0 s\u1ed1 \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef d\u01b0\u1edbi d\u1ea1ng m\u1ea3ng c\u00e1c \"ch\u1eef s\u1ed1\" c\u1ee7a n\u00f3 trong m\u1ed9t c\u01a1 s\u1ed1 n\u00e0o \u0111\u00f3. M\u1ed9t s\u1ed1 c\u01a1 s\u1ed1 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng th\u01b0\u1eddng xuy\u00ean nh\u1ea5t l\u00e0 th\u1eadp ph\u00e2n, l\u0169y th\u1eeba c\u1ee7a th\u1eadp ph\u00e2n ($10^4$ ho\u1eb7c $10^9$) v\u00e0 nh\u1ecb ph\u00e2n.</p> <p>C\u00e1c ph\u00e9p to\u00e1n tr\u00ean c\u00e1c s\u1ed1 \u1edf d\u1ea1ng n\u00e0y \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng c\u00e1c thu\u1eadt to\u00e1n \"h\u1ecdc \u0111\u01b0\u1eddng\" nh\u01b0 c\u1ed9ng, tr\u1eeb, nh\u00e2n v\u00e0 chia theo c\u1ed9t. C\u0169ng c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng c\u00e1c thu\u1eadt to\u00e1n nh\u00e2n nhanh: bi\u1ebfn \u0111\u1ed5i Fourier nhanh (FFT) v\u00e0 thu\u1eadt to\u00e1n Karatsuba.</p> <p>\u1ede \u0111\u00e2y ch\u00fang t\u00f4i ch\u1ec9 m\u00f4 t\u1ea3 s\u1ed1 h\u1ecdc l\u1edbn cho c\u00e1c s\u1ed1 nguy\u00ean kh\u00f4ng \u00e2m. \u0110\u1ec3 m\u1edf r\u1ed9ng c\u00e1c thu\u1eadt to\u00e1n x\u1eed l\u00fd s\u1ed1 nguy\u00ean \u00e2m, ng\u01b0\u1eddi ta ph\u1ea3i gi\u1edbi thi\u1ec7u v\u00e0 duy tr\u00ec th\u00eam c\u1edd \"s\u1ed1 \u00e2m\" ho\u1eb7c s\u1eed d\u1ee5ng bi\u1ec3u di\u1ec5n s\u1ed1 nguy\u00ean b\u00f9 hai.</p>","tags":["Translated"]},{"location":"algebra/big-integer.html#data-structure","title":"C\u1ea5u tr\u00fac d\u1eef li\u1ec7u","text":"<p>Ch\u00fang ta s\u1ebd l\u01b0u tr\u1eef c\u00e1c s\u1ed1 d\u01b0\u1edbi d\u1ea1ng <code>vector&lt;int&gt;</code>, trong \u0111\u00f3 m\u1ed7i ph\u1ea7n t\u1eed l\u00e0 m\u1ed9t \"ch\u1eef s\u1ed1\" \u0111\u01a1n l\u1ebb c\u1ee7a s\u1ed1 \u0111\u00f3.</p> <pre><code>typedef vector&lt;int&gt; lnum;\n</code></pre> <p>\u0110\u1ec3 c\u1ea3i thi\u1ec7n hi\u1ec7u su\u1ea5t, ch\u00fang ta s\u1ebd s\u1eed d\u1ee5ng $10^9$ l\u00e0m c\u01a1 s\u1ed1, \u0111\u1ec3 m\u1ed7i \"ch\u1eef s\u1ed1\" c\u1ee7a s\u1ed1 l\u1edbn ch\u1ee9a 9 ch\u1eef s\u1ed1 th\u1eadp ph\u00e2n c\u00f9ng m\u1ed9t l\u00fac.</p> <pre><code>const int base = 1000*1000*1000;\n</code></pre> <p>C\u00e1c ch\u1eef s\u1ed1 s\u1ebd \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef theo th\u1ee9 t\u1ef1 t\u1eeb \u00edt quan tr\u1ecdng nh\u1ea5t \u0111\u1ebfn quan tr\u1ecdng nh\u1ea5t. T\u1ea5t c\u1ea3 c\u00e1c ph\u00e9p to\u00e1n s\u1ebd \u0111\u01b0\u1ee3c c\u00e0i \u0111\u1eb7t sao cho sau m\u1ed7i ph\u00e9p to\u00e1n, k\u1ebft qu\u1ea3 kh\u00f4ng c\u00f3 b\u1ea5t k\u1ef3 s\u1ed1 kh\u00f4ng d\u1eabn \u0111\u1ea7u n\u00e0o, mi\u1ec5n l\u00e0 c\u00e1c to\u00e1n h\u1ea1ng c\u0169ng kh\u00f4ng c\u00f3 s\u1ed1 kh\u00f4ng d\u1eabn \u0111\u1ea7u. T\u1ea5t c\u1ea3 c\u00e1c ph\u00e9p to\u00e1n c\u00f3 th\u1ec3 d\u1eabn \u0111\u1ebfn m\u1ed9t s\u1ed1 c\u00f3 s\u1ed1 kh\u00f4ng d\u1eabn \u0111\u1ea7u n\u00ean \u0111\u01b0\u1ee3c theo sau b\u1edfi m\u00e3 lo\u1ea1i b\u1ecf ch\u00fang. L\u01b0u \u00fd r\u1eb1ng trong bi\u1ec3u di\u1ec5n n\u00e0y c\u00f3 hai k\u00fd hi\u1ec7u h\u1ee3p l\u1ec7 cho s\u1ed1 kh\u00f4ng: m\u1ed9t vector r\u1ed7ng, v\u00e0 m\u1ed9t vector v\u1edbi m\u1ed9t ch\u1eef s\u1ed1 kh\u00f4ng duy nh\u1ea5t.</p>","tags":["Translated"]},{"location":"algebra/big-integer.html#output","title":"Xu\u1ea5t (Output)","text":"<p>In ra s\u1ed1 nguy\u00ean l\u1edbn l\u00e0 thao t\u00e1c d\u1ec5 nh\u1ea5t. \u0110\u1ea7u ti\u00ean ch\u00fang ta in ph\u1ea7n t\u1eed cu\u1ed1i c\u00f9ng c\u1ee7a vector (ho\u1eb7c 0 n\u1ebfu vector r\u1ed7ng), theo sau l\u00e0 c\u00e1c ph\u1ea7n t\u1eed c\u00f2n l\u1ea1i \u0111\u01b0\u1ee3c \u0111\u1ec7m b\u1eb1ng c\u00e1c s\u1ed1 kh\u00f4ng d\u1eabn \u0111\u1ea7u n\u1ebfu c\u1ea7n thi\u1ebft \u0111\u1ec3 ch\u00fang c\u00f3 \u0111\u1ed9 d\u00e0i ch\u00ednh x\u00e1c 9 ch\u1eef s\u1ed1.</p> <pre><code>printf (\"%d\", a.empty() ? 0 : a.back());\nfor (int i=(int)a.size()-2; i&gt;=0; --i)\n    printf (\"%09d\", a[i]);\n</code></pre> <p>L\u01b0u \u00fd r\u1eb1ng ch\u00fang ta \u00e9p ki\u1ec3u <code>a.size()</code> sang s\u1ed1 nguy\u00ean \u0111\u1ec3 tr\u00e1nh tr\u00e0n s\u1ed1 nguy\u00ean kh\u00f4ng d\u1ea5u (unsigned underflow) n\u1ebfu vector ch\u1ee9a \u00edt h\u01a1n 2 ph\u1ea7n t\u1eed.</p>","tags":["Translated"]},{"location":"algebra/big-integer.html#input","title":"Nh\u1eadp (Input)","text":"<p>\u0110\u1ec3 \u0111\u1ecdc m\u1ed9t s\u1ed1 nguy\u00ean l\u1edbn, \u0111\u1ecdc k\u00fd hi\u1ec7u c\u1ee7a n\u00f3 v\u00e0o m\u1ed9t <code>string</code> v\u00e0 sau \u0111\u00f3 chuy\u1ec3n \u0111\u1ed5i n\u00f3 th\u00e0nh c\u00e1c \"ch\u1eef s\u1ed1\":</p> <pre><code>for (int i=(int)s.length(); i&gt;0; i-=9)\n    if (i &lt; 9)\n        a.push_back (atoi (s.substr (0, i).c_str()));\n    else\n        a.push_back (atoi (s.substr (i-9, 9).c_str()));\n</code></pre> <p>N\u1ebfu ch\u00fang ta s\u1eed d\u1ee5ng m\u1ea3ng <code>char</code> thay v\u00ec <code>string</code>, code s\u1ebd c\u00f2n ng\u1eafn h\u01a1n:</p> <pre><code>for (int i=(int)strlen(s); i&gt;0; i-=9) {\n    s[i] = 0;\n    a.push_back (atoi (i&gt;=9 ? s+i-9 : s));\n}\n</code></pre> <p>N\u1ebfu \u0111\u1ea7u v\u00e0o c\u00f3 th\u1ec3 ch\u1ee9a c\u00e1c s\u1ed1 kh\u00f4ng d\u1eabn \u0111\u1ea7u, ch\u00fang c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c lo\u1ea1i b\u1ecf nh\u01b0 sau:</p> <pre><code>while (a.size() &gt; 1 &amp;&amp; a.back() == 0)\n    a.pop_back();\n</code></pre>","tags":["Translated"]},{"location":"algebra/big-integer.html#addition","title":"Ph\u00e9p c\u1ed9ng","text":"<p>T\u0103ng s\u1ed1 nguy\u00ean l\u1edbn $a$ th\u00eam $b$ v\u00e0 l\u01b0u k\u1ebft qu\u1ea3 v\u00e0o $a$:</p> <pre><code>int carry = 0;\nfor (size_t i=0; i&lt;max(a.size(),b.size()) || carry; ++i) {\n    if (i == a.size())\n        a.push_back (0);\n    a[i] += carry + (i &lt; b.size() ? b[i] : 0);\n    carry = a[i] &gt;= base;\n    if (carry)  a[i] -= base;\n}\n</code></pre>","tags":["Translated"]},{"location":"algebra/big-integer.html#subtraction","title":"Ph\u00e9p tr\u1eeb","text":"<p>Gi\u1ea3m s\u1ed1 nguy\u00ean l\u1edbn $a$ \u0111i $b$ ($a \\ge b$) v\u00e0 l\u01b0u k\u1ebft qu\u1ea3 v\u00e0o $a$:</p> <pre><code>int carry = 0;\nfor (size_t i=0; i&lt;b.size() || carry; ++i) {\n    a[i] -= carry + (i &lt; b.size() ? b[i] : 0);\n    carry = a[i] &lt; 0;\n    if (carry)  a[i] += base;\n}\nwhile (a.size() &gt; 1 &amp;&amp; a.back() == 0)\n    a.pop_back();\n</code></pre> <p>L\u01b0u \u00fd r\u1eb1ng sau khi th\u1ef1c hi\u1ec7n ph\u00e9p tr\u1eeb, ch\u00fang ta lo\u1ea1i b\u1ecf c\u00e1c s\u1ed1 kh\u00f4ng d\u1eabn \u0111\u1ea7u \u0111\u1ec3 tu\u00e2n th\u1ee7 ti\u1ec1n \u0111\u1ec1 l\u00e0 c\u00e1c s\u1ed1 nguy\u00ean l\u1edbn c\u1ee7a ch\u00fang ta kh\u00f4ng c\u00f3 s\u1ed1 kh\u00f4ng d\u1eabn \u0111\u1ea7u.</p>","tags":["Translated"]},{"location":"algebra/big-integer.html#multiplication-by-short-integer","title":"Nh\u00e2n v\u1edbi s\u1ed1 nguy\u00ean nh\u1ecf","text":"<p>Nh\u00e2n s\u1ed1 nguy\u00ean l\u1edbn $a$ v\u1edbi s\u1ed1 nguy\u00ean nh\u1ecf $b$ ($b &lt; base$) v\u00e0 l\u01b0u k\u1ebft qu\u1ea3 v\u00e0o $a$:</p> <pre><code>int carry = 0;\nfor (size_t i=0; i&lt;a.size() || carry; ++i) {\n    if (i == a.size())\n        a.push_back (0);\n    long long cur = carry + a[i] * 1ll * b;\n    a[i] = int (cur % base);\n    carry = int (cur / base);\n}\nwhile (a.size() &gt; 1 &amp;&amp; a.back() == 0)\n    a.pop_back();\n</code></pre> <p>T\u1ed1i \u01b0u h\u00f3a b\u1ed5 sung: N\u1ebfu th\u1eddi gian ch\u1ea1y c\u1ef1c k\u1ef3 quan tr\u1ecdng, b\u1ea1n c\u00f3 th\u1ec3 th\u1eed thay th\u1ebf hai ph\u00e9p chia b\u1eb1ng m\u1ed9t ph\u00e9p chia b\u1eb1ng c\u00e1ch ch\u1ec9 t\u00ecm k\u1ebft qu\u1ea3 nguy\u00ean c\u1ee7a ph\u00e9p chia (bi\u1ebfn <code>carry</code>) v\u00e0 sau \u0111\u00f3 s\u1eed d\u1ee5ng n\u00f3 \u0111\u1ec3 t\u00ecm modulo b\u1eb1ng ph\u00e9p nh\u00e2n. \u0110i\u1ec1u n\u00e0y th\u01b0\u1eddng l\u00e0m cho code nhanh h\u01a1n, m\u1eb7c d\u00f9 kh\u00f4ng \u0111\u1eb7c bi\u1ec7t nhi\u1ec1u.</p>","tags":["Translated"]},{"location":"algebra/big-integer.html#multiplication-by-long-integer","title":"Nh\u00e2n v\u1edbi s\u1ed1 nguy\u00ean l\u1edbn","text":"<p>Nh\u00e2n c\u00e1c s\u1ed1 nguy\u00ean l\u1edbn $a$ v\u00e0 $b$ v\u00e0 l\u01b0u k\u1ebft qu\u1ea3 v\u00e0o $c$:</p> <pre><code>lnum c (a.size()+b.size());\nfor (size_t i=0; i&lt;a.size(); ++i)\n    for (int j=0, carry=0; j&lt;(int)b.size() || carry; ++j) {\n        long long cur = c[i+j] + a[i] * 1ll * (j &lt; (int)b.size() ? b[j] : 0) + carry;\n        c[i+j] = int (cur % base);\n        carry = int (cur / base);\n    }\nwhile (c.size() &gt; 1 &amp;&amp; c.back() == 0)\n    c.pop_back();\n</code></pre>","tags":["Translated"]},{"location":"algebra/big-integer.html#division-by-short-integer","title":"Chia cho s\u1ed1 nguy\u00ean nh\u1ecf","text":"<p>Chia s\u1ed1 nguy\u00ean l\u1edbn $a$ cho s\u1ed1 nguy\u00ean nh\u1ecf $b$ ($b &lt; base$), l\u01b0u th\u01b0\u01a1ng s\u1ed1 nguy\u00ean v\u00e0o $a$ v\u00e0 ph\u1ea7n d\u01b0 v\u00e0o <code>carry</code>:</p> <pre><code>int carry = 0;\nfor (int i=(int)a.size()-1; i&gt;=0; --i) {\n    long long cur = a[i] + carry * 1ll * base;\n    a[i] = int (cur / b);\n    carry = int (cur % b);\n}\nwhile (a.size() &gt; 1 &amp;&amp; a.back() == 0)\n    a.pop_back();\n</code></pre>","tags":["Translated"]},{"location":"algebra/big-integer.html#long-integer-arithmetic-for-factorization-representation","title":"S\u1ed1 h\u1ecdc s\u1ed1 nguy\u00ean l\u1edbn d\u00f9ng bi\u1ec3u di\u1ec5n ph\u00e2n t\u00edch th\u1eeba s\u1ed1","text":"<p>\u00dd t\u01b0\u1edfng l\u00e0 l\u01b0u tr\u1eef s\u1ed1 nguy\u00ean d\u01b0\u1edbi d\u1ea1ng ph\u00e2n t\u00edch th\u1eeba s\u1ed1 c\u1ee7a n\u00f3, t\u1ee9c l\u00e0 c\u00e1c l\u0169y th\u1eeba c\u1ee7a c\u00e1c s\u1ed1 nguy\u00ean t\u1ed1 chia h\u1ebft cho n\u00f3.</p> <p>C\u00e1ch ti\u1ebfp c\u1eadn n\u00e0y r\u1ea5t d\u1ec5 c\u00e0i \u0111\u1eb7t, v\u00e0 cho ph\u00e9p th\u1ef1c hi\u1ec7n ph\u00e9p nh\u00e2n v\u00e0 chia d\u1ec5 d\u00e0ng (nhanh h\u01a1n v\u1ec1 m\u1eb7t ti\u1ec7m c\u1eadn so v\u1edbi ph\u01b0\u01a1ng ph\u00e1p c\u1ed5 \u0111i\u1ec3n), nh\u01b0ng kh\u00f4ng h\u1ed7 tr\u1ee3 ph\u00e9p c\u1ed9ng ho\u1eb7c tr\u1eeb. N\u00f3 c\u0169ng r\u1ea5t ti\u1ebft ki\u1ec7m b\u1ed9 nh\u1edb so v\u1edbi c\u00e1ch ti\u1ebfp c\u1eadn c\u1ed5 \u0111i\u1ec3n.</p> <p>Ph\u01b0\u01a1ng ph\u00e1p n\u00e0y th\u01b0\u1eddng \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng cho c\u00e1c ph\u00e9p t\u00ednh modulo m\u1ed9t s\u1ed1 kh\u00f4ng nguy\u00ean t\u1ed1 M; trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, m\u1ed9t s\u1ed1 \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef d\u01b0\u1edbi d\u1ea1ng c\u00e1c l\u0169y th\u1eeba c\u1ee7a c\u00e1c \u01b0\u1edbc c\u1ee7a M chia h\u1ebft cho s\u1ed1 \u0111\u00f3, c\u1ed9ng v\u1edbi ph\u1ea7n d\u01b0 modulo M.</p>","tags":["Translated"]},{"location":"algebra/big-integer.html#long-integer-arithmetic-in-prime-modulos-garner-algorithm","title":"S\u1ed1 h\u1ecdc s\u1ed1 nguy\u00ean l\u1edbn theo modulo nguy\u00ean t\u1ed1 (Thu\u1eadt to\u00e1n Garner)","text":"<p>\u00dd t\u01b0\u1edfng l\u00e0 ch\u1ecdn m\u1ed9t t\u1eadp h\u1ee3p c\u00e1c s\u1ed1 nguy\u00ean t\u1ed1 (th\u01b0\u1eddng ch\u00fang \u0111\u1ee7 nh\u1ecf \u0111\u1ec3 v\u1eeba v\u1edbi ki\u1ec3u d\u1eef li\u1ec7u s\u1ed1 nguy\u00ean chu\u1ea9n) v\u00e0 l\u01b0u tr\u1eef m\u1ed9t s\u1ed1 nguy\u00ean d\u01b0\u1edbi d\u1ea1ng vector c\u00e1c ph\u1ea7n d\u01b0 t\u1eeb ph\u00e9p chia s\u1ed1 nguy\u00ean \u0111\u00f3 cho m\u1ed7i s\u1ed1 nguy\u00ean t\u1ed1 n\u00e0y.</p> <p>\u0110\u1ecbnh l\u00fd th\u1eb7ng d\u01b0 Trung Hoa ph\u00e1t bi\u1ec3u r\u1eb1ng bi\u1ec3u di\u1ec5n n\u00e0y l\u00e0 \u0111\u1ee7 \u0111\u1ec3 kh\u00f4i ph\u1ee5c duy nh\u1ea5t b\u1ea5t k\u1ef3 s\u1ed1 n\u00e0o t\u1eeb 0 \u0111\u1ebfn t\u00edch c\u1ee7a c\u00e1c s\u1ed1 nguy\u00ean t\u1ed1 n\u00e0y tr\u1eeb m\u1ed9t. Thu\u1eadt to\u00e1n Garner cho ph\u00e9p kh\u00f4i ph\u1ee5c s\u1ed1 t\u1eeb bi\u1ec3u di\u1ec5n nh\u01b0 v\u1eady v\u1ec1 s\u1ed1 nguy\u00ean b\u00ecnh th\u01b0\u1eddng.</p> <p>Ph\u01b0\u01a1ng ph\u00e1p n\u00e0y cho ph\u00e9p ti\u1ebft ki\u1ec7m b\u1ed9 nh\u1edb so v\u1edbi c\u00e1ch ti\u1ebfp c\u1eadn c\u1ed5 \u0111i\u1ec3n (m\u1eb7c d\u00f9 m\u1ee9c ti\u1ebft ki\u1ec7m kh\u00f4ng \u0111\u00e1ng k\u1ec3 nh\u01b0 trong bi\u1ec3u di\u1ec5n ph\u00e2n t\u00edch th\u1eeba s\u1ed1). Ngo\u00e0i ra, n\u00f3 cho ph\u00e9p th\u1ef1c hi\u1ec7n ph\u00e9p c\u1ed9ng, tr\u1eeb v\u00e0 nh\u00e2n nhanh trong th\u1eddi gian t\u1ef7 l\u1ec7 v\u1edbi s\u1ed1 l\u01b0\u1ee3ng s\u1ed1 nguy\u00ean t\u1ed1 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng l\u00e0m modulo (xem b\u00e0i vi\u1ebft \u0110\u1ecbnh l\u00fd th\u1eb7ng d\u01b0 Trung Hoa \u0111\u1ec3 bi\u1ebft c\u00e0i \u0111\u1eb7t).</p> <p>S\u1ef1 \u0111\u00e1nh \u0111\u1ed5i l\u00e0 vi\u1ec7c chuy\u1ec3n \u0111\u1ed5i s\u1ed1 nguy\u00ean tr\u1edf l\u1ea1i d\u1ea1ng b\u00ecnh th\u01b0\u1eddng kh\u00e1 t\u1ed1n c\u00f4ng s\u1ee9c v\u00e0 \u0111\u00f2i h\u1ecfi ph\u1ea3i c\u00e0i \u0111\u1eb7t s\u1ed1 h\u1ecdc \u0111\u1ed9 ch\u00ednh x\u00e1c t\u00f9y \u00fd c\u1ed5 \u0111i\u1ec3n v\u1edbi ph\u00e9p nh\u00e2n. Ngo\u00e0i ra, ph\u01b0\u01a1ng ph\u00e1p n\u00e0y kh\u00f4ng h\u1ed7 tr\u1ee3 ph\u00e9p chia.</p>","tags":["Translated"]},{"location":"algebra/big-integer.html#fractional-arbitrary-precision-arithmetic","title":"S\u1ed1 h\u1ecdc ph\u00e2n s\u1ed1 \u0111\u1ed9 ch\u00ednh x\u00e1c t\u00f9y \u00fd","text":"<p>Ph\u00e2n s\u1ed1 xu\u1ea5t hi\u1ec7n trong c\u00e1c k\u1ef3 thi l\u1eadp tr\u00ecnh \u00edt th\u01b0\u1eddng xuy\u00ean h\u01a1n s\u1ed1 nguy\u00ean, v\u00e0 s\u1ed1 h\u1ecdc l\u1edbn kh\u00f3 c\u00e0i \u0111\u1eb7t h\u01a1n nhi\u1ec1u \u0111\u1ed1i v\u1edbi ph\u00e2n s\u1ed1, v\u00ec v\u1eady c\u00e1c k\u1ef3 thi l\u1eadp tr\u00ecnh ch\u1ec9 c\u00f3 m\u1ed9t t\u1eadp h\u1ee3p nh\u1ecf s\u1ed1 h\u1ecdc l\u1edbn ph\u00e2n s\u1ed1.</p>","tags":["Translated"]},{"location":"algebra/big-integer.html#arithmetic-in-irreducible-fractions","title":"S\u1ed1 h\u1ecdc tr\u00ean ph\u00e2n s\u1ed1 t\u1ed1i gi\u1ea3n","text":"<p>M\u1ed9t s\u1ed1 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n d\u01b0\u1edbi d\u1ea1ng ph\u00e2n s\u1ed1 t\u1ed1i gi\u1ea3n $\\frac{a}{b}$, trong \u0111\u00f3 $a$ v\u00e0 $b$ l\u00e0 c\u00e1c s\u1ed1 nguy\u00ean. T\u1ea5t c\u1ea3 c\u00e1c ph\u00e9p to\u00e1n tr\u00ean ph\u00e2n s\u1ed1 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n d\u01b0\u1edbi d\u1ea1ng c\u00e1c ph\u00e9p to\u00e1n tr\u00ean t\u1eed s\u1ed1 v\u00e0 m\u1eabu s\u1ed1 nguy\u00ean c\u1ee7a c\u00e1c ph\u00e2n s\u1ed1 n\u00e0y. Th\u01b0\u1eddng th\u00ec \u0111i\u1ec1u n\u00e0y \u0111\u00f2i h\u1ecfi ph\u1ea3i s\u1eed d\u1ee5ng s\u1ed1 h\u1ecdc \u0111\u1ed9 ch\u00ednh x\u00e1c t\u00f9y \u00fd c\u1ed5 \u0111i\u1ec3n \u0111\u1ec3 l\u01b0u tr\u1eef t\u1eed s\u1ed1 v\u00e0 m\u1eabu s\u1ed1, nh\u01b0ng \u0111\u00f4i khi ki\u1ec3u d\u1eef li\u1ec7u s\u1ed1 nguy\u00ean 64-bit t\u00edch h\u1ee3p s\u1eb5n l\u00e0 \u0111\u1ee7.</p>","tags":["Translated"]},{"location":"algebra/big-integer.html#storing-floating-point-position-as-separate-type","title":"L\u01b0u tr\u1eef v\u1ecb tr\u00ed d\u1ea5u ph\u1ea9y \u0111\u1ed9ng d\u01b0\u1edbi d\u1ea1ng ki\u1ec3u ri\u00eang bi\u1ec7t","text":"<p>\u0110\u00f4i khi m\u1ed9t b\u00e0i to\u00e1n y\u00eau c\u1ea7u x\u1eed l\u00fd c\u00e1c s\u1ed1 r\u1ea5t nh\u1ecf ho\u1eb7c r\u1ea5t l\u1edbn m\u00e0 kh\u00f4ng cho ph\u00e9p tr\u00e0n s\u1ed1 (overflow ho\u1eb7c underflow). Ki\u1ec3u d\u1eef li\u1ec7u double t\u00edch h\u1ee3p s\u1eb5n s\u1eed d\u1ee5ng 8-10 byte v\u00e0 cho ph\u00e9p gi\u00e1 tr\u1ecb c\u1ee7a s\u1ed1 m\u0169 trong kho\u1ea3ng $[-308; 308]$, \u0111\u00f4i khi c\u00f3 th\u1ec3 l\u00e0 kh\u00f4ng \u0111\u1ee7.</p> <p>C\u00e1ch ti\u1ebfp c\u1eadn r\u1ea5t \u0111\u01a1n gi\u1ea3n: m\u1ed9t bi\u1ebfn s\u1ed1 nguy\u00ean ri\u00eang bi\u1ec7t \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 l\u01b0u tr\u1eef gi\u00e1 tr\u1ecb c\u1ee7a s\u1ed1 m\u0169, v\u00e0 sau m\u1ed7i ph\u00e9p to\u00e1n, s\u1ed1 d\u1ea5u ph\u1ea9y \u0111\u1ed9ng \u0111\u01b0\u1ee3c chu\u1ea9n h\u00f3a, t\u1ee9c l\u00e0 \u0111\u01b0a v\u1ec1 kho\u1ea3ng $[0.1; 1)$ b\u1eb1ng c\u00e1ch \u0111i\u1ec1u ch\u1ec9nh s\u1ed1 m\u0169 t\u01b0\u01a1ng \u1ee9ng.</p> <p>Khi hai s\u1ed1 nh\u01b0 v\u1eady \u0111\u01b0\u1ee3c nh\u00e2n ho\u1eb7c chia, c\u00e1c s\u1ed1 m\u0169 c\u1ee7a ch\u00fang n\u00ean \u0111\u01b0\u1ee3c c\u1ed9ng ho\u1eb7c tr\u1eeb t\u01b0\u01a1ng \u1ee9ng. Khi c\u00e1c s\u1ed1 \u0111\u01b0\u1ee3c c\u1ed9ng ho\u1eb7c tr\u1eeb, ch\u00fang ph\u1ea3i \u0111\u01b0\u1ee3c \u0111\u01b0a v\u1ec1 c\u00f9ng s\u1ed1 m\u0169 tr\u01b0\u1edbc b\u1eb1ng c\u00e1ch nh\u00e2n m\u1ed9t trong s\u1ed1 ch\u00fang v\u1edbi 10 l\u0169y th\u1eeba hi\u1ec7u c\u1ee7a c\u00e1c gi\u00e1 tr\u1ecb s\u1ed1 m\u0169.</p> <p>Cu\u1ed1i c\u00f9ng, c\u01a1 s\u1ed1 m\u0169 kh\u00f4ng nh\u1ea5t thi\u1ebft ph\u1ea3i b\u1eb1ng 10. D\u1ef1a tr\u00ean bi\u1ec3u di\u1ec5n n\u1ed9i b\u1ed9 c\u1ee7a c\u00e1c s\u1ed1 d\u1ea5u ph\u1ea9y \u0111\u1ed9ng, h\u1ee3p l\u00fd nh\u1ea5t l\u00e0 s\u1eed d\u1ee5ng 2 l\u00e0m c\u01a1 s\u1ed1 m\u0169.</p>","tags":["Translated"]},{"location":"algebra/big-integer.html#practice-problems","title":"B\u00e0i t\u1eadp luy\u1ec7n t\u1eadp","text":"<ul> <li>UVA - How Many Fibs?</li> <li>UVA - Product</li> <li>UVA - Maximum Sub-sequence Product</li> <li>SPOJ - Fast Multiplication</li> <li>SPOJ - GCD2</li> <li>UVA - Division</li> <li>UVA - Fibonacci Freeze</li> <li>UVA - Krakovia</li> <li>UVA - Simplifying Fractions</li> <li>UVA - 500!</li> <li>Hackerrank - Factorial digit sum</li> <li>UVA - Immortal Rabbits</li> <li>SPOJ - 0110SS</li> <li>Codeforces - Notepad</li> </ul>","tags":["Translated"]},{"location":"algebra/big-integer.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 210</li> <li>Translated lines: 210</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Translated"]},{"location":"algebra/binary-exp.html","title":"L\u0169y th\u1eeba nh\u1ecb ph\u00e2n","text":"<p>L\u0169y th\u1eeba nh\u1ecb ph\u00e2n (c\u00f2n \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 l\u0169y th\u1eeba b\u1eb1ng c\u00e1ch b\u00ecnh ph\u01b0\u01a1ng - exponentiation by squaring) l\u00e0 m\u1ed9t th\u1ee7 thu\u1eadt cho ph\u00e9p t\u00ednh $a^n$ ch\u1ec9 s\u1eed d\u1ee5ng $O(\\log n)$ ph\u00e9p nh\u00e2n (thay v\u00ec $O(n)$ ph\u00e9p nh\u00e2n theo c\u00e1ch ti\u1ebfp c\u1eadn ng\u00e2y th\u01a1).</p> <p>N\u00f3 c\u0169ng c\u00f3 nh\u1eefng \u1ee9ng d\u1ee5ng quan tr\u1ecdng trong nhi\u1ec1u b\u00e0i to\u00e1n kh\u00f4ng li\u00ean quan \u0111\u1ebfn s\u1ed1 h\u1ecdc, v\u00ec n\u00f3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng v\u1edbi b\u1ea5t k\u1ef3 ph\u00e9p to\u00e1n n\u00e0o c\u00f3 t\u00ednh ch\u1ea5t k\u1ebft h\u1ee3p (associativity):</p> $$(X \\cdot Y) \\cdot Z = X \\cdot (Y \\cdot Z)$$ <p>R\u00f5 r\u00e0ng nh\u1ea5t \u0111i\u1ec1u n\u00e0y \u00e1p d\u1ee5ng cho ph\u00e9p nh\u00e2n modulo, nh\u00e2n ma tr\u1eadn v\u00e0 c\u00e1c b\u00e0i to\u00e1n kh\u00e1c m\u00e0 ch\u00fang ta s\u1ebd th\u1ea3o lu\u1eadn b\u00ean d\u01b0\u1edbi.</p>","tags":["Translated"]},{"location":"algebra/binary-exp.html#algorithm","title":"Thu\u1eadt to\u00e1n","text":"<p>N\u00e2ng $a$ l\u00ean l\u0169y th\u1eeba $n$ \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n m\u1ed9t c\u00e1ch ng\u00e2y th\u01a1 l\u00e0 nh\u00e2n $a$ v\u1edbi ch\u00ednh n\u00f3 $n - 1$ l\u1ea7n: $a^{n} = a \\cdot a \\cdot \\ldots \\cdot a$. Tuy nhi\u00ean, c\u00e1ch ti\u1ebfp c\u1eadn n\u00e0y kh\u00f4ng th\u1ef1c t\u1ebf v\u1edbi $a$ ho\u1eb7c $n$ l\u1edbn.</p> <p>$a^{b+c} = a^b \\cdot a^c$ v\u00e0 $a^{2b} = a^b \\cdot a^b = (a^b)^2$.</p> <p>\u00dd t\u01b0\u1edfng c\u1ee7a l\u0169y th\u1eeba nh\u1ecb ph\u00e2n l\u00e0, ch\u00fang ta chia nh\u1ecf c\u00f4ng vi\u1ec7c b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng bi\u1ec3u di\u1ec5n nh\u1ecb ph\u00e2n c\u1ee7a s\u1ed1 m\u0169.</p> <p>H\u00e3y vi\u1ebft $n$ trong h\u1ec7 c\u01a1 s\u1ed1 2, v\u00ed d\u1ee5:</p> $$3^{13} = 3^{1101_2} = 3^8 \\cdot 3^4 \\cdot 3^1$$ <p>V\u00ec s\u1ed1 $n$ c\u00f3 ch\u00ednh x\u00e1c $\\lfloor \\log_2 n \\rfloor + 1$ ch\u1eef s\u1ed1 trong h\u1ec7 c\u01a1 s\u1ed1 2, ch\u00fang ta ch\u1ec9 c\u1ea7n th\u1ef1c hi\u1ec7n $O(\\log n)$ ph\u00e9p nh\u00e2n, n\u1ebfu ch\u00fang ta bi\u1ebft c\u00e1c l\u0169y th\u1eeba $a^1, a^2, a^4, a^8, \\dots, a^{2^{\\lfloor \\log_2 n \\rfloor}}$.</p> <p>V\u00ec v\u1eady ch\u00fang ta ch\u1ec9 c\u1ea7n bi\u1ebft c\u00e1ch nhanh ch\u00f3ng \u0111\u1ec3 t\u00ednh ch\u00fang. May m\u1eafn thay \u0111i\u1ec1u n\u00e0y r\u1ea5t d\u1ec5 d\u00e0ng, v\u00ec m\u1ed9t ph\u1ea7n t\u1eed trong d\u00e3y ch\u1ec9 l\u00e0 b\u00ecnh ph\u01b0\u01a1ng c\u1ee7a ph\u1ea7n t\u1eed tr\u01b0\u1edbc \u0111\u00f3.</p> $$\\begin{align} 3^1 &amp;= 3 \\\\ 3^2 &amp;= \\left(3^1\\right)^2 = 3^2 = 9 \\\\ 3^4 &amp;= \\left(3^2\\right)^2 = 9^2 = 81 \\\\ 3^8 &amp;= \\left(3^4\\right)^2 = 81^2 = 6561 \\end{align}$$ <p>V\u00ec v\u1eady \u0111\u1ec3 c\u00f3 \u0111\u01b0\u1ee3c k\u1ebft qu\u1ea3 cu\u1ed1i c\u00f9ng cho $3^{13}$, ch\u00fang ta ch\u1ec9 c\u1ea7n nh\u00e2n ba trong s\u1ed1 ch\u00fang (b\u1ecf qua $3^2$ v\u00ec bit t\u01b0\u01a1ng \u1ee9ng trong $n$ kh\u00f4ng b\u1eadt): $3^{13} = 6561 \\cdot 81 \\cdot 3 = 1594323$</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p cu\u1ed1i c\u00f9ng c\u1ee7a thu\u1eadt to\u00e1n n\u00e0y l\u00e0 $O(\\log n)$: ch\u00fang ta ph\u1ea3i t\u00ednh $\\log n$ l\u0169y th\u1eeba c\u1ee7a $a$, v\u00e0 sau \u0111\u00f3 ph\u1ea3i th\u1ef1c hi\u1ec7n t\u1ed1i \u0111a $\\log n$ ph\u00e9p nh\u00e2n \u0111\u1ec3 c\u00f3 \u0111\u01b0\u1ee3c k\u1ebft qu\u1ea3 cu\u1ed1i c\u00f9ng t\u1eeb ch\u00fang.</p> <p>C\u00e1ch ti\u1ebfp c\u1eadn \u0111\u1ec7 quy sau \u0111\u00e2y th\u1ec3 hi\u1ec7n c\u00f9ng m\u1ed9t \u00fd t\u01b0\u1edfng:</p> $$a^n = \\begin{cases} 1 &amp;\\text{if } n == 0 \\\\ \\left(a^{\\frac{n}{2}}\\right)^2 &amp;\\text{if } n &gt; 0 \\text{ and } n \\text{ even}\\\\ \\left(a^{\\frac{n - 1}{2}}\\right)^2 \\cdot a &amp;\\text{if } n &gt; 0 \\text{ and } n \\text{ odd}\\\\ \\end{cases}$$","tags":["Translated"]},{"location":"algebra/binary-exp.html#implementation","title":"C\u00e0i \u0111\u1eb7t","text":"<p>\u0110\u1ea7u ti\u00ean l\u00e0 c\u00e1ch ti\u1ebfp c\u1eadn \u0111\u1ec7 quy, l\u00e0 b\u1ea3n d\u1ecbch tr\u1ef1c ti\u1ebfp c\u1ee7a c\u00f4ng th\u1ee9c \u0111\u1ec7 quy:</p> <pre><code>long long binpow(long long a, long long b) {\n    if (b == 0)\n        return 1;\n    long long res = binpow(a, b / 2);\n    if (b % 2)\n        return res * res * a;\n    else\n        return res * res;\n}\n</code></pre> <p>C\u00e1ch ti\u1ebfp c\u1eadn th\u1ee9 hai ho\u00e0n th\u00e0nh c\u00f9ng m\u1ed9t nhi\u1ec7m v\u1ee5 m\u00e0 kh\u00f4ng c\u1ea7n \u0111\u1ec7 quy. N\u00f3 t\u00ednh to\u00e1n t\u1ea5t c\u1ea3 c\u00e1c l\u0169y th\u1eeba trong m\u1ed9t v\u00f2ng l\u1eb7p, v\u00e0 nh\u00e2n nh\u1eefng c\u00e1i c\u00f3 bit \u0111\u01b0\u1ee3c b\u1eadt t\u01b0\u01a1ng \u1ee9ng trong $n$. M\u1eb7c d\u00f9 \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a c\u1ea3 hai c\u00e1ch ti\u1ebfp c\u1eadn l\u00e0 nh\u01b0 nhau, c\u00e1ch ti\u1ebfp c\u1eadn n\u00e0y s\u1ebd nhanh h\u01a1n trong th\u1ef1c t\u1ebf v\u00ec ch\u00fang ta kh\u00f4ng t\u1ed1n chi ph\u00ed cho c\u00e1c l\u1eddi g\u1ecdi \u0111\u1ec7 quy.</p> <pre><code>long long binpow(long long a, long long b) {\n    long long res = 1;\n    while (b &gt; 0) {\n        if (b &amp; 1)\n            res = res * a;\n        a = a * a;\n        b &gt;&gt;= 1;\n    }\n    return res;\n}\n</code></pre>","tags":["Translated"]},{"location":"algebra/binary-exp.html#applications","title":"\u1ee8ng d\u1ee5ng","text":"","tags":["Translated"]},{"location":"algebra/binary-exp.html#effective-computation-of-large-exponents-modulo-a-number","title":"T\u00ednh hi\u1ec7u qu\u1ea3 l\u0169y th\u1eeba l\u1edbn theo modulo m\u1ed9t s\u1ed1","text":"<p>B\u00e0i to\u00e1n: T\u00ednh $x^n \\bmod m$. \u0110\u00e2y l\u00e0 m\u1ed9t thao t\u00e1c r\u1ea5t ph\u1ed5 bi\u1ebfn. V\u00ed d\u1ee5 n\u00f3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng trong vi\u1ec7c t\u00ednh ngh\u1ecbch \u0111\u1ea3o nh\u00e2n modulo.</p> <p>L\u1eddi gi\u1ea3i: V\u00ec ch\u00fang ta bi\u1ebft r\u1eb1ng to\u00e1n t\u1eed modulo kh\u00f4ng \u1ea3nh h\u01b0\u1edfng \u0111\u1ebfn ph\u00e9p nh\u00e2n ($a \\cdot b \\equiv (a \\bmod m) \\cdot (b \\bmod m) \\pmod m$), ch\u00fang ta c\u00f3 th\u1ec3 tr\u1ef1c ti\u1ebfp s\u1eed d\u1ee5ng c\u00f9ng m\u1ed9t \u0111o\u1ea1n code, v\u00e0 ch\u1ec9 c\u1ea7n thay th\u1ebf m\u1ed7i ph\u00e9p nh\u00e2n b\u1eb1ng m\u1ed9t ph\u00e9p nh\u00e2n modulo:</p> <pre><code>long long binpow(long long a, long long b, long long m) {\n    a %= m;\n    long long res = 1;\n    while (b &gt; 0) {\n        if (b &amp; 1)\n            res = res * a % m;\n        a = a * a % m;\n        b &gt;&gt;= 1;\n    }\n    return res;\n}\n</code></pre> <p>L\u01b0u \u00fd: C\u00f3 th\u1ec3 t\u0103ng t\u1ed1c thu\u1eadt to\u00e1n n\u00e0y cho $b &gt;&gt; m$ l\u1edbn. N\u1ebfu $m$ l\u00e0 s\u1ed1 nguy\u00ean t\u1ed1 $x^n \\equiv x^{n \\bmod (m-1)} \\pmod{m}$ v\u1edbi $m$ nguy\u00ean t\u1ed1, v\u00e0 $x^n \\equiv x^{n \\bmod{\\phi(m)}} \\pmod{m}$ v\u1edbi $m$ h\u1ee3p s\u1ed1. \u0110i\u1ec1u n\u00e0y suy ra tr\u1ef1c ti\u1ebfp t\u1eeb \u0111\u1ecbnh l\u00fd nh\u1ecf Fermat v\u00e0 \u0111\u1ecbnh l\u00fd Euler, xem b\u00e0i vi\u1ebft v\u1ec1 Ngh\u1ecbch \u0111\u1ea3o Modulo \u0111\u1ec3 bi\u1ebft th\u00eam chi ti\u1ebft.</p>","tags":["Translated"]},{"location":"algebra/binary-exp.html#effective-computation-of-fibonacci-numbers","title":"T\u00ednh hi\u1ec7u qu\u1ea3 s\u1ed1 Fibonacci","text":"<p>B\u00e0i to\u00e1n: T\u00ednh s\u1ed1 Fibonacci th\u1ee9 $n$, $F_n$.</p> <p>L\u1eddi gi\u1ea3i: \u0110\u1ec3 bi\u1ebft th\u00eam chi ti\u1ebft, xem b\u00e0i vi\u1ebft v\u1ec1 S\u1ed1 Fibonacci. Ch\u00fang t\u00f4i s\u1ebd ch\u1ec9 tr\u00ecnh b\u00e0y t\u1ed5ng quan v\u1ec1 thu\u1eadt to\u00e1n. \u0110\u1ec3 t\u00ednh s\u1ed1 Fibonacci ti\u1ebfp theo, ch\u1ec9 c\u1ea7n hai s\u1ed1 tr\u01b0\u1edbc \u0111\u00f3, v\u00ec $F_n = F_{n-1} + F_{n-2}$. Ch\u00fang ta c\u00f3 th\u1ec3 x\u00e2y d\u1ef1ng m\u1ed9t ma tr\u1eadn $2 \\times 2$ m\u00f4 t\u1ea3 ph\u00e9p bi\u1ebfn \u0111\u1ed5i n\u00e0y: vi\u1ec7c chuy\u1ec3n \u0111\u1ed5i t\u1eeb $F_i$ v\u00e0 $F_{i+1}$ sang $F_{i+1}$ v\u00e0 $F_{i+2}$. V\u00ed d\u1ee5, \u00e1p d\u1ee5ng ph\u00e9p bi\u1ebfn \u0111\u1ed5i n\u00e0y cho c\u1eb7p $F_0$ v\u00e0 $F_1$ s\u1ebd thay \u0111\u1ed5i n\u00f3 th\u00e0nh $F_1$ v\u00e0 $F_2$. Do \u0111\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 n\u00e2ng ma tr\u1eadn bi\u1ebfn \u0111\u1ed5i n\u00e0y l\u00ean l\u0169y th\u1eeba $n$ \u0111\u1ec3 t\u00ecm $F_n$ trong \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian $O(\\log n)$.</p>","tags":["Translated"]},{"location":"algebra/binary-exp.html#applying-a-permutation-k-times","title":"\u00c1p d\u1ee5ng ho\u00e1n v\u1ecb $k$ l\u1ea7n","text":"<p>B\u00e0i to\u00e1n: B\u1ea1n \u0111\u01b0\u1ee3c cho m\u1ed9t d\u00e3y \u0111\u1ed9 d\u00e0i $n$. \u00c1p d\u1ee5ng m\u1ed9t ho\u00e1n v\u1ecb cho tr\u01b0\u1edbc $k$ l\u1ea7n l\u00ean n\u00f3.</p> <p>L\u1eddi gi\u1ea3i: \u0110\u01a1n gi\u1ea3n l\u00e0 n\u00e2ng ho\u00e1n v\u1ecb l\u00ean l\u0169y th\u1eeba $k$ b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng l\u0169y th\u1eeba nh\u1ecb ph\u00e2n, v\u00e0 sau \u0111\u00f3 \u00e1p d\u1ee5ng n\u00f3 cho d\u00e3y. \u0110i\u1ec1u n\u00e0y s\u1ebd cho b\u1ea1n \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian $O(n \\log k)$.</p> <pre><code>vector&lt;int&gt; applyPermutation(vector&lt;int&gt; sequence, vector&lt;int&gt; permutation) {\n    vector&lt;int&gt; newSequence(sequence.size());\n    for(int i = 0; i &lt; sequence.size(); i++) {\n        newSequence[i] = sequence[permutation[i]];\n    }\n    return newSequence;\n}\n\nvector&lt;int&gt; permute(vector&lt;int&gt; sequence, vector&lt;int&gt; permutation, long long k) {\n    while (k &gt; 0) {\n        if (k &amp; 1) {\n            sequence = applyPermutation(sequence, permutation);\n        }\n        permutation = applyPermutation(permutation, permutation);\n        k &gt;&gt;= 1;\n    }\n    return sequence;\n}\n</code></pre> <p>L\u01b0u \u00fd: B\u00e0i to\u00e1n n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i quy\u1ebft hi\u1ec7u qu\u1ea3 h\u01a1n trong th\u1eddi gian tuy\u1ebfn t\u00ednh b\u1eb1ng c\u00e1ch x\u00e2y d\u1ef1ng \u0111\u1ed3 th\u1ecb ho\u00e1n v\u1ecb v\u00e0 xem x\u00e9t t\u1eebng chu tr\u00ecnh m\u1ed9t c\u00e1ch \u0111\u1ed9c l\u1eadp. Sau \u0111\u00f3 b\u1ea1n c\u00f3 th\u1ec3 t\u00ednh $k$ modulo k\u00edch th\u01b0\u1edbc c\u1ee7a chu tr\u00ecnh v\u00e0 t\u00ecm v\u1ecb tr\u00ed cu\u1ed1i c\u00f9ng cho m\u1ed7i s\u1ed1 l\u00e0 m\u1ed9t ph\u1ea7n c\u1ee7a chu tr\u00ecnh n\u00e0y.</p>","tags":["Translated"]},{"location":"algebra/binary-exp.html#fast-application-of-a-set-of-geometric-operations-to-a-set-of-points","title":"\u00c1p d\u1ee5ng nhanh t\u1eadp h\u1ee3p c\u00e1c ph\u00e9p bi\u1ebfn \u0111\u1ed5i h\u00ecnh h\u1ecdc v\u00e0o t\u1eadp h\u1ee3p c\u00e1c \u0111i\u1ec3m","text":"<p>B\u00e0i to\u00e1n: Cho $n$ \u0111i\u1ec3m $p_i$, \u00e1p d\u1ee5ng $m$ ph\u00e9p bi\u1ebfn \u0111\u1ed5i cho m\u1ed7i \u0111i\u1ec3m n\u00e0y. M\u1ed7i ph\u00e9p bi\u1ebfn \u0111\u1ed5i c\u00f3 th\u1ec3 l\u00e0 d\u1ecbch chuy\u1ec3n, t\u1ec9 l\u1ec7 ho\u1eb7c xoay quanh m\u1ed9t tr\u1ee5c cho tr\u01b0\u1edbc m\u1ed9t g\u00f3c cho tr\u01b0\u1edbc. Ngo\u00e0i ra c\u00f2n c\u00f3 m\u1ed9t ph\u00e9p to\u00e1n \"l\u1eb7p\" \u00e1p d\u1ee5ng m\u1ed9t danh s\u00e1ch c\u00e1c ph\u00e9p bi\u1ebfn \u0111\u1ed5i $k$ l\u1ea7n (ph\u00e9p to\u00e1n \"l\u1eb7p\" c\u00f3 th\u1ec3 l\u1ed3ng nhau). B\u1ea1n n\u00ean \u00e1p d\u1ee5ng t\u1ea5t c\u1ea3 c\u00e1c ph\u00e9p bi\u1ebfn \u0111\u1ed5i nhanh h\u01a1n $O(n \\cdot length)$, trong \u0111\u00f3 $length$ l\u00e0 t\u1ed5ng s\u1ed1 ph\u00e9p bi\u1ebfn \u0111\u1ed5i c\u1ea7n \u00e1p d\u1ee5ng (sau khi m\u1edf r\u1ed9ng c\u00e1c ph\u00e9p to\u00e1n \"l\u1eb7p\").</p> <p>L\u1eddi gi\u1ea3i: H\u00e3y xem c\u00e1c lo\u1ea1i ph\u00e9p bi\u1ebfn \u0111\u1ed5i kh\u00e1c nhau thay \u0111\u1ed5i t\u1ecda \u0111\u1ed9 nh\u01b0 th\u1ebf n\u00e0o:</p> <ul> <li>Ph\u00e9p d\u1ecbch chuy\u1ec3n: c\u1ed9ng m\u1ed9t h\u1eb1ng s\u1ed1 kh\u00e1c nhau v\u00e0o m\u1ed7i t\u1ecda \u0111\u1ed9.</li> <li>Ph\u00e9p t\u1ec9 l\u1ec7: nh\u00e2n m\u1ed7i t\u1ecda \u0111\u1ed9 v\u1edbi m\u1ed9t h\u1eb1ng s\u1ed1 kh\u00e1c nhau.</li> <li>Ph\u00e9p xoay: ph\u00e9p bi\u1ebfn \u0111\u1ed5i ph\u1ee9c t\u1ea1p h\u01a1n (ch\u00fang t\u00f4i s\u1ebd kh\u00f4ng \u0111i s\u00e2u v\u00e0o chi ti\u1ebft \u1edf \u0111\u00e2y), nh\u01b0ng m\u1ed7i t\u1ecda \u0111\u1ed9 m\u1edbi v\u1eabn c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n d\u01b0\u1edbi d\u1ea1ng t\u1ed5 h\u1ee3p tuy\u1ebfn t\u00ednh c\u1ee7a c\u00e1c t\u1ecda \u0111\u1ed9 c\u0169.</li> </ul> <p>Nh\u01b0 b\u1ea1n c\u00f3 th\u1ec3 th\u1ea5y, m\u1ed7i ph\u00e9p bi\u1ebfn \u0111\u1ed5i c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n d\u01b0\u1edbi d\u1ea1ng m\u1ed9t ph\u00e9p to\u00e1n tuy\u1ebfn t\u00ednh tr\u00ean c\u00e1c t\u1ecda \u0111\u1ed9. Do \u0111\u00f3, m\u1ed9t ph\u00e9p bi\u1ebfn \u0111\u1ed5i c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c vi\u1ebft d\u01b0\u1edbi d\u1ea1ng ma tr\u1eadn $4 \\times 4$ d\u1ea1ng:</p> $$\\begin{pmatrix} a_{11} &amp; a_ {12} &amp; a_ {13} &amp; a_ {14} \\\\ a_{21} &amp; a_ {22} &amp; a_ {23} &amp; a_ {24} \\\\ a_{31} &amp; a_ {32} &amp; a_ {33} &amp; a_ {34} \\\\ a_{41} &amp; a_ {42} &amp; a_ {43} &amp; a_ {44} \\end{pmatrix}$$ <p>khi nh\u00e2n v\u1edbi m\u1ed9t vector v\u1edbi c\u00e1c t\u1ecda \u0111\u1ed9 c\u0169 v\u00e0 m\u1ed9t \u0111\u01a1n v\u1ecb s\u1ebd cho ra m\u1ed9t vector m\u1edbi v\u1edbi c\u00e1c t\u1ecda \u0111\u1ed9 m\u1edbi v\u00e0 m\u1ed9t \u0111\u01a1n v\u1ecb:</p> $$\\begin{pmatrix} x &amp; y &amp; z &amp; 1 \\end{pmatrix} \\cdot \\begin{pmatrix} a_{11} &amp; a_ {12} &amp; a_ {13} &amp; a_ {14} \\\\ a_{21} &amp; a_ {22} &amp; a_ {23} &amp; a_ {24} \\\\ a_{31} &amp; a_ {32} &amp; a_ {33} &amp; a_ {34} \\\\ a_{41} &amp; a_ {42} &amp; a_ {43} &amp; a_ {44} \\end{pmatrix}  = \\begin{pmatrix} x' &amp; y' &amp; z' &amp; 1 \\end{pmatrix}$$ <p>(T\u1ea1i sao l\u1ea1i \u0111\u01b0a v\u00e0o t\u1ecda \u0111\u1ed9 th\u1ee9 t\u01b0 gi\u1ea3 \u0111\u1ecbnh, b\u1ea1n h\u1ecfi? \u0110\u00f3 l\u00e0 v\u1ebb \u0111\u1eb9p c\u1ee7a t\u1ecda \u0111\u1ed9 \u0111\u1ed3ng nh\u1ea5t, t\u00ecm th\u1ea5y \u1ee9ng d\u1ee5ng tuy\u1ec7t v\u1eddi trong \u0111\u1ed3 h\u1ecda m\u00e1y t\u00ednh. N\u1ebfu kh\u00f4ng c\u00f3 \u0111i\u1ec1u n\u00e0y, s\u1ebd kh\u00f4ng th\u1ec3 th\u1ef1c hi\u1ec7n c\u00e1c ph\u00e9p to\u00e1n affine nh\u01b0 ph\u00e9p d\u1ecbch chuy\u1ec3n d\u01b0\u1edbi d\u1ea1ng m\u1ed9t ph\u00e9p nh\u00e2n ma tr\u1eadn \u0111\u01a1n l\u1ebb, v\u00ec n\u00f3 y\u00eau c\u1ea7u ch\u00fang ta c\u1ed9ng m\u1ed9t h\u1eb1ng s\u1ed1 v\u00e0o c\u00e1c t\u1ecda \u0111\u1ed9. Ph\u00e9p bi\u1ebfn \u0111\u1ed5i affine tr\u1edf th\u00e0nh ph\u00e9p bi\u1ebfn \u0111\u1ed5i tuy\u1ebfn t\u00ednh trong chi\u1ec1u cao h\u01a1n!)</p> <p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u1ed9t s\u1ed1 v\u00ed d\u1ee5 v\u1ec1 c\u00e1ch c\u00e1c ph\u00e9p bi\u1ebfn \u0111\u1ed5i \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n d\u01b0\u1edbi d\u1ea1ng ma tr\u1eadn:</p> <ul> <li>Ph\u00e9p d\u1ecbch chuy\u1ec3n: d\u1ecbch chuy\u1ec3n t\u1ecda \u0111\u1ed9 $x$ \u0111i $5$, t\u1ecda \u0111\u1ed9 $y$ \u0111i $7$ v\u00e0 t\u1ecda \u0111\u1ed9 $z$ \u0111i $9$.</li> </ul> $$\\begin{pmatrix} 1 &amp; 0 &amp; 0 &amp; 0 \\\\ 0 &amp; 1 &amp; 0 &amp; 0 \\\\ 0 &amp; 0 &amp; 1 &amp; 0 \\\\ 5 &amp; 7 &amp; 9 &amp; 1 \\end{pmatrix}$$ <ul> <li>Ph\u00e9p t\u1ec9 l\u1ec7: t\u1ec9 l\u1ec7 t\u1ecda \u0111\u1ed9 $x$ g\u1ea5p $10$ v\u00e0 hai t\u1ecda \u0111\u1ed9 kia g\u1ea5p $5$.</li> </ul> $$\\begin{pmatrix} 10 &amp; 0 &amp; 0 &amp; 0 \\\\ 0 &amp; 5 &amp; 0 &amp; 0 \\\\ 0 &amp; 0 &amp; 5 &amp; 0 \\\\ 0 &amp; 0 &amp; 0 &amp; 1 \\end{pmatrix}$$ <ul> <li>Ph\u00e9p xoay: xoay $\\theta$ \u0111\u1ed9 quanh tr\u1ee5c $x$ theo quy t\u1eafc b\u00e0n tay ph\u1ea3i (ng\u01b0\u1ee3c chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3).</li> </ul> $$\\begin{pmatrix} 1 &amp; 0 &amp; 0 &amp; 0 \\\\ 0 &amp; \\cos \\theta &amp; -\\sin \\theta &amp; 0 \\\\ 0 &amp; \\sin \\theta &amp; \\cos \\theta &amp; 0 \\\\ 0 &amp; 0 &amp; 0 &amp; 1 \\end{pmatrix}$$ <p>B\u00e2y gi\u1edd, khi m\u1ed7i ph\u00e9p bi\u1ebfn \u0111\u1ed5i \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 nh\u01b0 m\u1ed9t ma tr\u1eadn, chu\u1ed7i c\u00e1c ph\u00e9p bi\u1ebfn \u0111\u1ed5i c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 nh\u01b0 m\u1ed9t t\u00edch c\u1ee7a c\u00e1c ma tr\u1eadn n\u00e0y, v\u00e0 m\u1ed9t \"v\u00f2ng l\u1eb7p\" $k$ l\u1ea7n c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 nh\u01b0 ma tr\u1eadn \u0111\u01b0\u1ee3c n\u00e2ng l\u00ean l\u0169y th\u1eeba $k$ (c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ednh b\u1eb1ng l\u0169y th\u1eeba nh\u1ecb ph\u00e2n trong $O(\\log{k})$). B\u1eb1ng c\u00e1ch n\u00e0y, ma tr\u1eadn \u0111\u1ea1i di\u1ec7n cho t\u1ea5t c\u1ea3 c\u00e1c ph\u00e9p bi\u1ebfn \u0111\u1ed5i c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ednh tr\u01b0\u1edbc trong $O(m \\log{k})$, v\u00e0 sau \u0111\u00f3 n\u00f3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c \u00e1p d\u1ee5ng cho m\u1ed7i trong s\u1ed1 $n$ \u0111i\u1ec3m trong $O(n)$ v\u1edbi t\u1ed5ng \u0111\u1ed9 ph\u1ee9c t\u1ea1p l\u00e0 $O(n + m \\log{k})$.</p>","tags":["Translated"]},{"location":"algebra/binary-exp.html#number-of-paths-of-length-k-in-a-graph","title":"S\u1ed1 \u0111\u01b0\u1eddng \u0111i \u0111\u1ed9 d\u00e0i $k$ trong \u0111\u1ed3 th\u1ecb","text":"<p>B\u00e0i to\u00e1n: Cho m\u1ed9t \u0111\u1ed3 th\u1ecb c\u00f3 h\u01b0\u1edbng kh\u00f4ng tr\u1ecdng s\u1ed1 g\u1ed3m $n$ \u0111\u1ec9nh, t\u00ecm s\u1ed1 \u0111\u01b0\u1eddng \u0111i c\u00f3 \u0111\u1ed9 d\u00e0i $k$ t\u1eeb b\u1ea5t k\u1ef3 \u0111\u1ec9nh $u$ n\u00e0o \u0111\u1ebfn b\u1ea5t k\u1ef3 \u0111\u1ec9nh $v$ n\u00e0o kh\u00e1c.</p> <p>L\u1eddi gi\u1ea3i: B\u00e0i to\u00e1n n\u00e0y \u0111\u01b0\u1ee3c xem x\u00e9t chi ti\u1ebft h\u01a1n trong m\u1ed9t b\u00e0i vi\u1ebft ri\u00eang. Thu\u1eadt to\u00e1n bao g\u1ed3m vi\u1ec7c n\u00e2ng ma tr\u1eadn k\u1ec1 $M$ c\u1ee7a \u0111\u1ed3 th\u1ecb (m\u1ed9t ma tr\u1eadn m\u00e0 $m_{ij} = 1$ n\u1ebfu c\u00f3 c\u1ea1nh t\u1eeb $i$ \u0111\u1ebfn $j$, ho\u1eb7c $0$ n\u1ebfu ng\u01b0\u1ee3c l\u1ea1i) l\u00ean l\u0169y th\u1eeba $k$. B\u00e2y gi\u1edd $m_{ij}$ s\u1ebd l\u00e0 s\u1ed1 \u0111\u01b0\u1eddng \u0111i c\u00f3 \u0111\u1ed9 d\u00e0i $k$ t\u1eeb $i$ \u0111\u1ebfn $j$. \u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian c\u1ee7a gi\u1ea3i ph\u00e1p n\u00e0y l\u00e0 $O(n^3 \\log k)$.</p> <p>L\u01b0u \u00fd: Trong c\u00f9ng b\u00e0i vi\u1ebft \u0111\u00f3, m\u1ed9t bi\u1ebfn th\u1ec3 kh\u00e1c c\u1ee7a b\u00e0i to\u00e1n n\u00e0y c\u0169ng \u0111\u01b0\u1ee3c xem x\u00e9t: khi c\u00e1c c\u1ea1nh c\u00f3 tr\u1ecdng s\u1ed1 v\u00e0 y\u00eau c\u1ea7u t\u00ecm \u0111\u01b0\u1eddng \u0111i c\u00f3 tr\u1ecdng s\u1ed1 nh\u1ecf nh\u1ea5t ch\u1ee9a ch\u00ednh x\u00e1c $k$ c\u1ea1nh. Nh\u01b0 \u0111\u00e3 tr\u00ecnh b\u00e0y trong b\u00e0i vi\u1ebft \u0111\u00f3, b\u00e0i to\u00e1n n\u00e0y c\u0169ng \u0111\u01b0\u1ee3c gi\u1ea3i quy\u1ebft b\u1eb1ng c\u00e1ch l\u0169y th\u1eeba ma tr\u1eadn k\u1ec1. Ma tr\u1eadn s\u1ebd c\u00f3 tr\u1ecdng s\u1ed1 c\u1ee7a c\u1ea1nh t\u1eeb $i$ \u0111\u1ebfn $j$, ho\u1eb7c $\\infty$ n\u1ebfu kh\u00f4ng c\u00f3 c\u1ea1nh n\u00e0o nh\u01b0 v\u1eady. Thay v\u00ec ph\u00e9p nh\u00e2n hai ma tr\u1eadn th\u00f4ng th\u01b0\u1eddng, m\u1ed9t ph\u00e9p to\u00e1n s\u1eeda \u0111\u1ed5i n\u00ean \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng: thay v\u00ec nh\u00e2n, c\u1ea3 hai gi\u00e1 tr\u1ecb \u0111\u01b0\u1ee3c c\u1ed9ng, v\u00e0 thay v\u00ec t\u00ednh t\u1ed5ng, l\u1ea5y gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t. T\u1ee9c l\u00e0: $result_{ij} = \\min\\limits_{1\\ \\leq\\ k\\ \\leq\\ n}(a_{ik} + b_{kj})$.</p>","tags":["Translated"]},{"location":"algebra/binary-exp.html#variation-of-binary-exponentiation-multiplying-two-numbers-modulo-m","title":"Bi\u1ebfn th\u1ec3 c\u1ee7a l\u0169y th\u1eeba nh\u1ecb ph\u00e2n: nh\u00e2n hai s\u1ed1 theo modulo $m$","text":"<p>B\u00e0i to\u00e1n: Nh\u00e2n hai s\u1ed1 $a$ v\u00e0 $b$ theo modulo $m$. $a$ v\u00e0 $b$ v\u1eeba v\u1edbi c\u00e1c ki\u1ec3u d\u1eef li\u1ec7u t\u00edch h\u1ee3p s\u1eb5n, nh\u01b0ng t\u00edch c\u1ee7a ch\u00fang qu\u00e1 l\u1edbn \u0111\u1ec3 v\u1eeba v\u1edbi m\u1ed9t s\u1ed1 nguy\u00ean 64-bit. \u00dd t\u01b0\u1edfng l\u00e0 t\u00ednh $a \\cdot b \\pmod m$ m\u00e0 kh\u00f4ng s\u1eed d\u1ee5ng s\u1ed1 h\u1ecdc bignum.</p> <p>L\u1eddi gi\u1ea3i: Ch\u00fang ta ch\u1ec9 \u0111\u01a1n gi\u1ea3n \u00e1p d\u1ee5ng thu\u1eadt to\u00e1n x\u00e2y d\u1ef1ng nh\u1ecb ph\u00e2n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 \u1edf tr\u00ean, ch\u1ec9 th\u1ef1c hi\u1ec7n ph\u00e9p c\u1ed9ng thay v\u00ec ph\u00e9p nh\u00e2n. N\u00f3i c\u00e1ch kh\u00e1c, ch\u00fang ta \u0111\u00e3 \"m\u1edf r\u1ed9ng\" ph\u00e9p nh\u00e2n hai s\u1ed1 th\u00e0nh $O (\\log m)$ ph\u00e9p t\u00ednh c\u1ed9ng v\u00e0 nh\u00e2n v\u1edbi hai (v\u1ec1 b\u1ea3n ch\u1ea5t l\u00e0 m\u1ed9t ph\u00e9p c\u1ed9ng).</p> $$a \\cdot b = \\begin{cases} 0 &amp;\\text{if }a = 0 \\\\ 2 \\cdot \\frac{a}{2} \\cdot b &amp;\\text{if }a &gt; 0 \\text{ and }a \\text{ even} \\\\ 2 \\cdot \\frac{a-1}{2} \\cdot b + b &amp;\\text{if }a &gt; 0 \\text{ and }a \\text{ odd} \\end{cases}$$ <p>L\u01b0u \u00fd: B\u1ea1n c\u00f3 th\u1ec3 gi\u1ea3i quy\u1ebft nhi\u1ec7m v\u1ee5 n\u00e0y theo m\u1ed9t c\u00e1ch kh\u00e1c b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng c\u00e1c ph\u00e9p to\u00e1n d\u1ea5u ph\u1ea9y \u0111\u1ed9ng. \u0110\u1ea7u ti\u00ean t\u00ednh bi\u1ec3u th\u1ee9c $\\frac{a \\cdot b}{m}$ s\u1eed d\u1ee5ng s\u1ed1 d\u1ea5u ph\u1ea9y \u0111\u1ed9ng v\u00e0 \u00e9p ki\u1ec3u n\u00f3 sang s\u1ed1 nguy\u00ean kh\u00f4ng d\u1ea5u $q$. Tr\u1eeb $q \\cdot m$ kh\u1ecfi $a \\cdot b$ s\u1eed d\u1ee5ng s\u1ed1 h\u1ecdc s\u1ed1 nguy\u00ean kh\u00f4ng d\u1ea5u v\u00e0 l\u1ea5y n\u00f3 theo modulo $m$ \u0111\u1ec3 t\u00ecm c\u00e2u tr\u1ea3 l\u1eddi. Gi\u1ea3i ph\u00e1p n\u00e0y tr\u00f4ng kh\u00e1 kh\u00f4ng \u0111\u00e1ng tin c\u1eady, nh\u01b0ng n\u00f3 r\u1ea5t nhanh v\u00e0 r\u1ea5t d\u1ec5 c\u00e0i \u0111\u1eb7t. Xem t\u1ea1i \u0111\u00e2y \u0111\u1ec3 bi\u1ebft th\u00eam th\u00f4ng tin.</p>","tags":["Translated"]},{"location":"algebra/binary-exp.html#practice-problems","title":"B\u00e0i t\u1eadp luy\u1ec7n t\u1eadp","text":"<ul> <li>UVa 1230 - MODEX</li> <li>UVa 374 - Big Mod</li> <li>UVa 11029 - Leading and Trailing</li> <li>Codeforces - Parking Lot</li> <li>leetcode - Count good numbers</li> <li>Codechef - Chef and Riffles</li> <li>Codeforces - Decoding Genome</li> <li>Codeforces - Neural Network Country</li> <li>Codeforces - Magic Gems</li> <li>SPOJ - The last digit</li> <li>SPOJ - Locker</li> <li>LA - 3722 Jewel-eating Monsters</li> <li>SPOJ - Just add it</li> <li>Codeforces - Stairs and Lines</li> </ul>","tags":["Translated"]},{"location":"algebra/binary-exp.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 268</li> <li>Translated lines: 268</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Translated"]},{"location":"algebra/bit-manipulation.html","title":"Thao t\u00e1c bit (Bit manipulation)","text":"","tags":["Original"]},{"location":"algebra/bit-manipulation.html#binary-number","title":"S\u1ed1 nh\u1ecb ph\u00e2n (Binary number)","text":"<p>M\u1ed9t s\u1ed1 nh\u1ecb ph\u00e2n l\u00e0 m\u1ed9t s\u1ed1 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n trong h\u1ec7 \u0111\u1ebfm c\u01a1 s\u1ed1 2 hay h\u1ec7 \u0111\u1ebfm nh\u1ecb ph\u00e2n, n\u00f3 l\u00e0 m\u1ed9t ph\u01b0\u01a1ng ph\u00e1p bi\u1ec3u di\u1ec5n to\u00e1n h\u1ecdc ch\u1ec9 s\u1eed d\u1ee5ng hai k\u00fd hi\u1ec7u: th\u01b0\u1eddng l\u00e0 \"0\" (kh\u00f4ng) v\u00e0 \"1\" (m\u1ed9t).</p> <p>Ch\u00fang ta n\u00f3i r\u1eb1ng m\u1ed9t bit nh\u1ea5t \u0111\u1ecbnh l\u00e0 b\u1eadt (set), n\u1ebfu n\u00f3 l\u00e0 m\u1ed9t, v\u00e0 t\u1eaft (cleared) n\u1ebfu n\u00f3 l\u00e0 kh\u00f4ng.</p> <p>S\u1ed1 nh\u1ecb ph\u00e2n $(a_k a_{k-1} \\dots a_1 a_0)_2$ bi\u1ec3u di\u1ec5n s\u1ed1:</p> $$(a_k a_{k-1} \\dots a_1 a_0)_2 = a_k \\cdot 2^k + a_{k-1} \\cdot 2^{k-1} + \\dots + a_1 \\cdot 2^1 + a_0 \\cdot 2^0.$$ <p>V\u00ed d\u1ee5 s\u1ed1 nh\u1ecb ph\u00e2n $1101_2$ bi\u1ec3u di\u1ec5n s\u1ed1 $13$:</p> $$\\begin{align} 1101_2 &amp;= 1 \\cdot 2^3 + 1 \\cdot 2^2 + 0 \\cdot 2^1 + 1 \\cdot 2^0 \\\\        &amp;= 1\\cdot 8 + 1 \\cdot 4 + 0 \\cdot 2 + 1 \\cdot 1 = 13 \\end{align}$$ <p>M\u00e1y t\u00ednh bi\u1ec3u di\u1ec5n c\u00e1c s\u1ed1 nguy\u00ean d\u01b0\u1edbi d\u1ea1ng s\u1ed1 nh\u1ecb ph\u00e2n. C\u00e1c s\u1ed1 nguy\u00ean d\u01b0\u01a1ng (c\u1ea3 c\u00f3 d\u1ea5u v\u00e0 kh\u00f4ng d\u1ea5u) ch\u1ec9 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n b\u1eb1ng c\u00e1c ch\u1eef s\u1ed1 nh\u1ecb ph\u00e2n c\u1ee7a ch\u00fang, v\u00e0 c\u00e1c s\u1ed1 c\u00f3 d\u1ea5u \u00e2m (c\u00f3 th\u1ec3 d\u01b0\u01a1ng v\u00e0 \u00e2m) th\u01b0\u1eddng \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n b\u1eb1ng B\u00f9 hai (Two's complement).</p> <pre><code>unsigned int unsigned_number = 13;\nassert(unsigned_number == 0b1101);\n\nint positive_signed_number = 13;\nassert(positive_signed_number == 0b1101);\n\nint negative_signed_number = -13;\nassert(negative_signed_number == 0b1111'1111'1111'1111'1111'1111'1111'0011);\n</code></pre> <p>CPU thao t\u00e1c c\u00e1c bit n\u00e0y r\u1ea5t nhanh v\u1edbi c\u00e1c ph\u00e9p to\u00e1n c\u1ee5 th\u1ec3. \u0110\u1ed1i v\u1edbi m\u1ed9t s\u1ed1 b\u00e0i to\u00e1n, ch\u00fang ta c\u00f3 th\u1ec3 t\u1eadn d\u1ee5ng c\u00e1c bi\u1ec3u di\u1ec5n s\u1ed1 nh\u1ecb ph\u00e2n n\u00e0y v\u00e0 t\u0103ng t\u1ed1c th\u1eddi gian th\u1ef1c thi. V\u00e0 \u0111\u1ed1i v\u1edbi m\u1ed9t s\u1ed1 b\u00e0i to\u00e1n (th\u01b0\u1eddng l\u00e0 trong t\u1ed5 h\u1ee3p ho\u1eb7c quy ho\u1ea1ch \u0111\u1ed9ng) n\u01a1i ch\u00fang ta mu\u1ed1n theo d\u00f5i c\u00e1c \u0111\u1ed1i t\u01b0\u1ee3ng ch\u00fang ta \u0111\u00e3 ch\u1ecdn t\u1eeb m\u1ed9t t\u1eadp h\u1ee3p c\u00e1c \u0111\u1ed1i t\u01b0\u1ee3ng nh\u1ea5t \u0111\u1ecbnh, ch\u00fang ta ch\u1ec9 c\u1ea7n s\u1eed d\u1ee5ng m\u1ed9t s\u1ed1 nguy\u00ean \u0111\u1ee7 l\u1edbn trong \u0111\u00f3 m\u1ed7i ch\u1eef s\u1ed1 \u0111\u1ea1i di\u1ec7n cho m\u1ed9t \u0111\u1ed1i t\u01b0\u1ee3ng v\u00e0 t\u00f9y thu\u1ed9c v\u00e0o vi\u1ec7c ch\u00fang ta ch\u1ecdn hay b\u1ecf \u0111\u1ed1i t\u01b0\u1ee3ng, ch\u00fang ta b\u1eadt ho\u1eb7c t\u1eaft ch\u1eef s\u1ed1 \u0111\u00f3.</p>","tags":["Original"]},{"location":"algebra/bit-manipulation.html#bit-operators","title":"C\u00e1c to\u00e1n t\u1eed bit (Bit operators)","text":"<p>T\u1ea5t c\u1ea3 c\u00e1c to\u00e1n t\u1eed \u0111\u01b0\u1ee3c gi\u1edbi thi\u1ec7u sau \u0111\u00e2y l\u00e0 t\u1ee9c th\u00ec (c\u00f9ng t\u1ed1c \u0111\u1ed9 v\u1edbi ph\u00e9p c\u1ed9ng) tr\u00ean CPU cho c\u00e1c s\u1ed1 nguy\u00ean c\u00f3 \u0111\u1ed9 d\u00e0i c\u1ed1 \u0111\u1ecbnh.</p>","tags":["Original"]},{"location":"algebra/bit-manipulation.html#bitwise-operators","title":"C\u00e1c to\u00e1n t\u1eed bitwise (Bitwise operators)","text":"<ul> <li> <p>$\\&amp;$ : To\u00e1n t\u1eed AND bitwise so s\u00e1nh t\u1eebng bit c\u1ee7a to\u00e1n h\u1ea1ng \u0111\u1ea7u ti\u00ean v\u1edbi bit t\u01b0\u01a1ng \u1ee9ng c\u1ee7a to\u00e1n h\u1ea1ng th\u1ee9 hai.     N\u1ebfu c\u1ea3 hai bit \u0111\u1ec1u l\u00e0 1, bit k\u1ebft qu\u1ea3 t\u01b0\u01a1ng \u1ee9ng \u0111\u01b0\u1ee3c \u0111\u1eb7t th\u00e0nh 1. Ng\u01b0\u1ee3c l\u1ea1i, bit k\u1ebft qu\u1ea3 t\u01b0\u01a1ng \u1ee9ng \u0111\u01b0\u1ee3c \u0111\u1eb7t th\u00e0nh 0.</p> </li> <li> <p>$|$ : To\u00e1n t\u1eed OR bitwise (bao h\u00e0m) so s\u00e1nh t\u1eebng bit c\u1ee7a to\u00e1n h\u1ea1ng \u0111\u1ea7u ti\u00ean v\u1edbi bit t\u01b0\u01a1ng \u1ee9ng c\u1ee7a to\u00e1n h\u1ea1ng th\u1ee9 hai.     N\u1ebfu m\u1ed9t trong hai bit l\u00e0 1, bit k\u1ebft qu\u1ea3 t\u01b0\u01a1ng \u1ee9ng \u0111\u01b0\u1ee3c \u0111\u1eb7t th\u00e0nh 1. Ng\u01b0\u1ee3c l\u1ea1i, bit k\u1ebft qu\u1ea3 t\u01b0\u01a1ng \u1ee9ng \u0111\u01b0\u1ee3c \u0111\u1eb7t th\u00e0nh 0.</p> </li> <li> <p>$\\wedge$ : To\u00e1n t\u1eed XOR bitwise (lo\u1ea1i tr\u1eeb) so s\u00e1nh t\u1eebng bit c\u1ee7a to\u00e1n h\u1ea1ng \u0111\u1ea7u ti\u00ean v\u1edbi bit t\u01b0\u01a1ng \u1ee9ng c\u1ee7a to\u00e1n h\u1ea1ng th\u1ee9 hai.     N\u1ebfu m\u1ed9t bit l\u00e0 0 v\u00e0 bit kia l\u00e0 1, bit k\u1ebft qu\u1ea3 t\u01b0\u01a1ng \u1ee9ng \u0111\u01b0\u1ee3c \u0111\u1eb7t th\u00e0nh 1. Ng\u01b0\u1ee3c l\u1ea1i, bit k\u1ebft qu\u1ea3 t\u01b0\u01a1ng \u1ee9ng \u0111\u01b0\u1ee3c \u0111\u1eb7t th\u00e0nh 0.</p> </li> <li> <p>$\\sim$ : To\u00e1n t\u1eed NOT bitwise (b\u00f9) l\u1eadt t\u1eebng bit c\u1ee7a m\u1ed9t s\u1ed1, n\u1ebfu m\u1ed9t bit \u0111ang b\u1eadt to\u00e1n t\u1eed s\u1ebd t\u1eaft n\u00f3, n\u1ebfu n\u00f3 \u0111ang t\u1eaft to\u00e1n t\u1eed s\u1ebd b\u1eadt n\u00f3.</p> </li> </ul> <p>V\u00ed d\u1ee5:</p> <pre><code>n         = 01011000\nn-1       = 01010111\n--------------------\nn &amp; (n-1) = 01010000\n</code></pre> <pre><code>n         = 01011000\nn-1       = 01010111\n--------------------\nn | (n-1) = 01011111\n</code></pre> <pre><code>n         = 01011000\nn-1       = 01010111\n--------------------\nn ^ (n-1) = 00001111\n</code></pre> <pre><code>n         = 01011000\n--------------------\n~n        = 10100111\n</code></pre>","tags":["Original"]},{"location":"algebra/bit-manipulation.html#shift-operators","title":"C\u00e1c to\u00e1n t\u1eed d\u1ecbch (Shift operators)","text":"<p>C\u00f3 hai to\u00e1n t\u1eed \u0111\u1ec3 d\u1ecbch bit.</p> <ul> <li> <p>$\\gg$ D\u1ecbch m\u1ed9t s\u1ed1 sang ph\u1ea3i b\u1eb1ng c\u00e1ch lo\u1ea1i b\u1ecf v\u00e0i ch\u1eef s\u1ed1 nh\u1ecb ph\u00e2n cu\u1ed1i c\u00f9ng c\u1ee7a s\u1ed1.     M\u1ed7i l\u1ea7n d\u1ecbch m\u1ed9t bit t\u01b0\u01a1ng \u1ee9ng v\u1edbi ph\u00e9p chia nguy\u00ean cho 2, v\u00ec v\u1eady d\u1ecbch ph\u1ea3i $k$ l\u1ea7n t\u01b0\u01a1ng \u1ee9ng v\u1edbi ph\u00e9p chia nguy\u00ean cho $2^k$.</p> <p>V.d. $5 \\gg 2 = 101_2 \\gg 2 = 1_2 = 1$ gi\u1ed1ng nh\u01b0 $\\frac{5}{2^2} = \\frac{5}{4} = 1$. Tuy nhi\u00ean \u0111\u1ed1i v\u1edbi m\u00e1y t\u00ednh, vi\u1ec7c d\u1ecbch m\u1ed9t s\u1ed1 bit nhanh h\u01a1n nhi\u1ec1u so v\u1edbi th\u1ef1c hi\u1ec7n ph\u00e9p chia.</p> </li> <li> <p>$\\ll$ D\u1ecbch m\u1ed9t s\u1ed1 sang tr\u00e1i b\u1eb1ng c\u00e1ch th\u00eam v\u00e0o c\u00e1c ch\u1eef s\u1ed1 kh\u00f4ng.     T\u01b0\u01a1ng t\u1ef1 nh\u01b0 d\u1ecbch ph\u1ea3i $k$ l\u1ea7n, d\u1ecbch tr\u00e1i $k$ l\u1ea7n t\u01b0\u01a1ng \u1ee9ng v\u1edbi ph\u00e9p nh\u00e2n v\u1edbi $2^k$.</p> <p>V.d. $5 \\ll 3 = 101_2 \\ll 3 = 101000_2 = 40$ gi\u1ed1ng nh\u01b0 $5 \\cdot 2^3 = 5 \\cdot 8 = 40$.</p> <p>Tuy nhi\u00ean h\u00e3y ch\u00fa \u00fd r\u1eb1ng \u0111\u1ed1i v\u1edbi s\u1ed1 nguy\u00ean c\u00f3 \u0111\u1ed9 d\u00e0i c\u1ed1 \u0111\u1ecbnh, \u0111i\u1ec1u \u0111\u00f3 c\u00f3 ngh\u0129a l\u00e0 lo\u1ea1i b\u1ecf c\u00e1c ch\u1eef s\u1ed1 b\u00ean tr\u00e1i nh\u1ea5t, v\u00e0 n\u1ebfu b\u1ea1n d\u1ecbch qu\u00e1 nhi\u1ec1u, b\u1ea1n s\u1ebd nh\u1eadn \u0111\u01b0\u1ee3c s\u1ed1 $0$.</p> </li> </ul>","tags":["Original"]},{"location":"algebra/bit-manipulation.html#useful-tricks","title":"C\u00e1c th\u1ee7 thu\u1eadt h\u1eefu \u00edch","text":"","tags":["Original"]},{"location":"algebra/bit-manipulation.html#set-flip-clear-a-bit","title":"B\u1eadt/l\u1eadt/t\u1eaft m\u1ed9t bit","text":"<p>S\u1eed d\u1ee5ng c\u00e1c ph\u00e9p d\u1ecbch bit v\u00e0 m\u1ed9t s\u1ed1 ph\u00e9p to\u00e1n bitwise c\u01a1 b\u1ea3n, ch\u00fang ta c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng b\u1eadt, l\u1eadt ho\u1eb7c t\u1eaft m\u1ed9t bit. $1 \\ll x$ l\u00e0 s\u1ed1 ch\u1ec9 c\u00f3 bit th\u1ee9 $x$ b\u1eadt, trong khi $\\sim(1 \\ll x)$ l\u00e0 s\u1ed1 c\u00f3 t\u1ea5t c\u1ea3 c\u00e1c bit b\u1eadt ngo\u1ea1i tr\u1eeb bit th\u1ee9 $x$.</p> <ul> <li>$n ~|~ (1 \\ll x)$ b\u1eadt bit th\u1ee9 $x$ trong s\u1ed1 $n$</li> <li>$n ~\\wedge~ (1 \\ll x)$ l\u1eadt bit th\u1ee9 $x$ trong s\u1ed1 $n$</li> <li>$n ~\\&amp;~ \\sim(1 \\ll x)$ t\u1eaft bit th\u1ee9 $x$ trong s\u1ed1 $n$</li> </ul>","tags":["Original"]},{"location":"algebra/bit-manipulation.html#check-if-a-bit-is-set","title":"Ki\u1ec3m tra m\u1ed9t bit c\u00f3 b\u1eadt kh\u00f4ng","text":"<p>Gi\u00e1 tr\u1ecb c\u1ee7a bit th\u1ee9 $x$ c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c ki\u1ec3m tra b\u1eb1ng c\u00e1ch d\u1ecbch s\u1ed1 $x$ v\u1ecb tr\u00ed sang ph\u1ea3i, sao cho bit th\u1ee9 $x$ \u1edf v\u1ecb tr\u00ed \u0111\u01a1n v\u1ecb, sau \u0111\u00f3 ch\u00fang ta c\u00f3 th\u1ec3 tr\u00edch xu\u1ea5t n\u00f3 b\u1eb1ng c\u00e1ch th\u1ef1c hi\u1ec7n ph\u00e9p AND bitwise v\u1edbi 1.</p> <pre><code>bool is_set(unsigned int number, int x) {\n    return (number &gt;&gt; x) &amp; 1;\n}\n</code></pre>","tags":["Original"]},{"location":"algebra/bit-manipulation.html#check-if-the-number-is-divisible-by-a-power-of-2","title":"Ki\u1ec3m tra s\u1ed1 c\u00f3 chia h\u1ebft cho l\u0169y th\u1eeba c\u1ee7a 2 kh\u00f4ng","text":"<p>S\u1eed d\u1ee5ng ph\u00e9p AND, ch\u00fang ta c\u00f3 th\u1ec3 ki\u1ec3m tra xem s\u1ed1 $n$ c\u00f3 ch\u1eb5n hay kh\u00f4ng v\u00ec $n ~\\&amp;~ 1 = 0$ n\u1ebfu $n$ ch\u1eb5n, v\u00e0 $n ~\\&amp;~ 1 = 1$ n\u1ebfu $n$ l\u1ebb. T\u1ed5ng qu\u00e1t h\u01a1n, $n$ chia h\u1ebft cho $2^{k}$ ch\u00ednh x\u00e1c khi $n ~\\&amp;~ (2^{k} \u2212 1) = 0$.</p> <pre><code>bool isDivisibleByPowerOf2(int n, int k) {\n    int powerOf2 = 1 &lt;&lt; k;\n    return (n &amp; (powerOf2 - 1)) == 0;\n}\n</code></pre> <p>Ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh $2^{k}$ b\u1eb1ng c\u00e1ch d\u1ecbch tr\u00e1i 1 \u0111i $k$ v\u1ecb tr\u00ed. Th\u1ee7 thu\u1eadt n\u00e0y ho\u1ea1t \u0111\u1ed9ng, b\u1edfi v\u00ec $2^k - 1$ l\u00e0 s\u1ed1 bao g\u1ed3m \u0111\u00fang $k$ s\u1ed1 m\u1ed9t. V\u00e0 m\u1ed9t s\u1ed1 chia h\u1ebft cho $2^k$ ph\u1ea3i c\u00f3 c\u00e1c ch\u1eef s\u1ed1 kh\u00f4ng \u1edf nh\u1eefng v\u1ecb tr\u00ed \u0111\u00f3.</p>","tags":["Original"]},{"location":"algebra/bit-manipulation.html#check-if-an-integer-is-a-power-of-2","title":"Ki\u1ec3m tra m\u1ed9t s\u1ed1 nguy\u00ean c\u00f3 ph\u1ea3i l\u00e0 l\u0169y th\u1eeba c\u1ee7a 2 kh\u00f4ng","text":"<p>L\u0169y th\u1eeba c\u1ee7a hai l\u00e0 m\u1ed9t s\u1ed1 ch\u1ec9 c\u00f3 m\u1ed9t bit duy nh\u1ea5t trong \u0111\u00f3 (v\u00ed d\u1ee5 $32 = 0010~0000_2$), trong khi s\u1ed1 li\u1ec1n tr\u01b0\u1edbc c\u1ee7a s\u1ed1 \u0111\u00f3 c\u00f3 ch\u1eef s\u1ed1 \u0111\u00f3 kh\u00f4ng b\u1eadt v\u00e0 t\u1ea5t c\u1ea3 c\u00e1c ch\u1eef s\u1ed1 sau n\u00f3 \u0111\u1ec1u b\u1eadt ($31 = 0001~1111_2$). V\u00ec v\u1eady ph\u00e9p AND bitwise c\u1ee7a m\u1ed9t s\u1ed1 v\u1edbi s\u1ed1 li\u1ec1n tr\u01b0\u1edbc c\u1ee7a n\u00f3 s\u1ebd lu\u00f4n l\u00e0 0, v\u00ec ch\u00fang kh\u00f4ng c\u00f3 b\u1ea5t k\u1ef3 ch\u1eef s\u1ed1 chung n\u00e0o b\u1eadt. B\u1ea1n c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng ki\u1ec3m tra r\u1eb1ng \u0111i\u1ec1u n\u00e0y ch\u1ec9 x\u1ea3y ra \u0111\u1ed1i v\u1edbi c\u00e1c l\u0169y th\u1eeba c\u1ee7a hai v\u00e0 s\u1ed1 $0$ v\u1ed1n \u0111\u00e3 kh\u00f4ng c\u00f3 ch\u1eef s\u1ed1 n\u00e0o b\u1eadt.</p> <pre><code>bool isPowerOfTwo(unsigned int n) {\n    return n &amp;&amp; !(n &amp; (n - 1));\n}\n</code></pre>","tags":["Original"]},{"location":"algebra/bit-manipulation.html#clear-the-right-most-set-bit","title":"T\u1eaft bit b\u1eadt ngo\u00e0i c\u00f9ng b\u00ean ph\u1ea3i","text":"<p>Bi\u1ec3u th\u1ee9c $n ~\\&amp;~ (n-1)$ c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 t\u1eaft bit b\u1eadt ngo\u00e0i c\u00f9ng b\u00ean ph\u1ea3i c\u1ee7a s\u1ed1 $n$. \u0110i\u1ec1u n\u00e0y ho\u1ea1t \u0111\u1ed9ng v\u00ec bi\u1ec3u th\u1ee9c $n-1$ l\u1eadt t\u1ea5t c\u1ea3 c\u00e1c bit sau bit b\u1eadt ngo\u00e0i c\u00f9ng b\u00ean ph\u1ea3i c\u1ee7a $n$, bao g\u1ed3m c\u1ea3 bit b\u1eadt ngo\u00e0i c\u00f9ng b\u00ean ph\u1ea3i. V\u00ec v\u1eady t\u1ea5t c\u1ea3 c\u00e1c ch\u1eef s\u1ed1 \u0111\u00f3 \u0111\u1ec1u kh\u00e1c v\u1edbi s\u1ed1 ban \u0111\u1ea7u, v\u00e0 b\u1eb1ng c\u00e1ch th\u1ef1c hi\u1ec7n ph\u00e9p AND bitwise, ch\u00fang \u0111\u1ec1u \u0111\u01b0\u1ee3c \u0111\u1eb7t th\u00e0nh 0, cho b\u1ea1n s\u1ed1 ban \u0111\u1ea7u $n$ v\u1edbi bit b\u1eadt ngo\u00e0i c\u00f9ng b\u00ean ph\u1ea3i \u0111\u00e3 b\u1ecb l\u1eadt.</p> <p>V\u00ed d\u1ee5, xem x\u00e9t s\u1ed1 $52 = 0011~0100_2$:</p> <pre><code>n         = 00110100\nn-1       = 00110011\n--------------------\nn &amp; (n-1) = 00110000\n</code></pre>","tags":["Original"]},{"location":"algebra/bit-manipulation.html#brian-kernighans-algorithm","title":"Thu\u1eadt to\u00e1n Brian Kernighan","text":"<p>Ch\u00fang ta c\u00f3 th\u1ec3 \u0111\u1ebfm s\u1ed1 l\u01b0\u1ee3ng bit b\u1eadt b\u1eb1ng bi\u1ec3u th\u1ee9c tr\u00ean.</p> <p>\u00dd t\u01b0\u1edfng l\u00e0 ch\u1ec9 xem x\u00e9t c\u00e1c bit b\u1eadt c\u1ee7a m\u1ed9t s\u1ed1 nguy\u00ean b\u1eb1ng c\u00e1ch t\u1eaft bit b\u1eadt ngo\u00e0i c\u00f9ng b\u00ean ph\u1ea3i c\u1ee7a n\u00f3 (sau khi \u0111\u1ebfm n\u00f3), v\u00ec v\u1eady l\u1ea7n l\u1eb7p ti\u1ebfp theo c\u1ee7a v\u00f2ng l\u1eb7p s\u1ebd xem x\u00e9t bit B\u1eadt Ngo\u00e0i C\u00f9ng B\u00ean Ph\u1ea3i Ti\u1ebfp Theo.</p> <pre><code>int countSetBits(int n)\n{\n    int count = 0;\n    while (n)\n    {\n        n = n &amp; (n - 1);\n        count++;\n    }\n    return count;\n}\n</code></pre>","tags":["Original"]},{"location":"algebra/bit-manipulation.html#count-set-bits-upto-n","title":"\u0110\u1ebfm s\u1ed1 bit b\u1eadt \u0111\u1ebfn $n$","text":"<p>\u0110\u1ec3 \u0111\u1ebfm s\u1ed1 l\u01b0\u1ee3ng bit b\u1eadt c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 \u0111\u1ebfn s\u1ed1 $n$ (t\u00ednh c\u1ea3 $n$), ch\u00fang ta c\u00f3 th\u1ec3 ch\u1ea1y thu\u1eadt to\u00e1n Brian Kernighan tr\u00ean t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 \u0111\u1ebfn $n$. Nh\u01b0ng \u0111i\u1ec1u n\u00e0y s\u1ebd d\u1eabn \u0111\u1ebfn \"Time Limit Exceeded\" trong c\u00e1c b\u00e0i n\u1ed9p.</p> <p>Ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng th\u1ef1c t\u1ebf l\u00e0 \u0111\u1ed1i v\u1edbi c\u00e1c s\u1ed1 \u0111\u1ebfn $2^x$ (t\u1ee9c l\u00e0 t\u1eeb $1$ \u0111\u1ebfn $2^x - 1$) c\u00f3 $x \\cdot 2^{x-1}$ bit b\u1eadt. \u0110i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c h\u00ecnh dung nh\u01b0 sau. <pre><code>0 -&gt;   0 0 0 0\n1 -&gt;   0 0 0 1\n2 -&gt;   0 0 1 0\n3 -&gt;   0 0 1 1\n4 -&gt;   0 1 0 0\n5 -&gt;   0 1 0 1\n6 -&gt;   0 1 1 0\n7 -&gt;   0 1 1 1\n8 -&gt;   1 0 0 0\n</code></pre></p> <p>Ch\u00fang ta c\u00f3 th\u1ec3 th\u1ea5y r\u1eb1ng t\u1ea5t c\u1ea3 c\u00e1c c\u1ed9t ngo\u1ea1i tr\u1eeb c\u1ed9t ngo\u00e0i c\u00f9ng b\u00ean tr\u00e1i \u0111\u1ec1u c\u00f3 $4$ (t\u1ee9c l\u00e0 $2^2$) bit b\u1eadt m\u1ed7i c\u1ed9t, t\u1ee9c l\u00e0 \u0111\u1ebfn s\u1ed1 $2^3 - 1$, s\u1ed1 l\u01b0\u1ee3ng bit b\u1eadt l\u00e0 $3 \\cdot 2^{3-1}$.</p> <p>V\u1edbi ki\u1ebfn th\u1ee9c m\u1edbi n\u00e0y, ch\u00fang ta c\u00f3 th\u1ec3 \u0111\u01b0a ra thu\u1eadt to\u00e1n sau:</p> <ul> <li>T\u00ecm l\u0169y th\u1eeba cao nh\u1ea5t c\u1ee7a $2$ nh\u1ecf h\u01a1n ho\u1eb7c b\u1eb1ng s\u1ed1 \u0111\u00e3 cho. G\u1ecdi s\u1ed1 n\u00e0y l\u00e0 $x$.</li> <li>T\u00ednh s\u1ed1 l\u01b0\u1ee3ng bit b\u1eadt t\u1eeb $1$ \u0111\u1ebfn $2^x - 1$ b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng c\u00f4ng th\u1ee9c $x \\cdot 2^{x-1}$.</li> <li>\u0110\u1ebfm s\u1ed1 l\u01b0\u1ee3ng bit b\u1eadt \u1edf bit quan tr\u1ecdng nh\u1ea5t t\u1eeb $2^x$ \u0111\u1ebfn $n$ v\u00e0 c\u1ed9ng v\u00e0o.</li> <li>Tr\u1eeb $2^x$ kh\u1ecfi $n$ v\u00e0 l\u1eb7p l\u1ea1i c\u00e1c b\u01b0\u1edbc tr\u00ean s\u1eed d\u1ee5ng $n$ m\u1edbi.</li> </ul> <pre><code>int countSetBits(int n) {\n        int count = 0;\n        while (n &gt; 0) {\n            int x = std::bit_width(n) - 1;\n            count += x &lt;&lt; (x - 1);\n            n -= 1 &lt;&lt; x;\n            count += n + 1;\n        }\n        return count;\n}\n</code></pre>","tags":["Original"]},{"location":"algebra/bit-manipulation.html#additional-tricks","title":"C\u00e1c th\u1ee7 thu\u1eadt kh\u00e1c","text":"<ul> <li>$n ~\\&amp;~ (n + 1)$ t\u1eaft t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 m\u1ed9t \u1edf cu\u1ed1i: $0011~0111_2 \\rightarrow 0011~0000_2$.</li> <li>$n ~|~ (n + 1)$ b\u1eadt bit t\u1eaft cu\u1ed1i c\u00f9ng: $0011~0101_2 \\rightarrow 0011~0111_2$.</li> <li>$n ~\\&amp;~ -n$ tr\u00edch xu\u1ea5t bit b\u1eadt cu\u1ed1i c\u00f9ng: $0011~0100_2 \\rightarrow 0000~0100_2$.</li> </ul> <p>Nhi\u1ec1u th\u1ee7 thu\u1eadt kh\u00e1c c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y trong cu\u1ed1n s\u00e1ch Hacker's Delight.</p>","tags":["Original"]},{"location":"algebra/bit-manipulation.html#language-and-compiler-support","title":"H\u1ed7 tr\u1ee3 c\u1ee7a ng\u00f4n ng\u1eef v\u00e0 tr\u00ecnh bi\u00ean d\u1ecbch","text":"<p>C++ h\u1ed7 tr\u1ee3 m\u1ed9t s\u1ed1 thao t\u00e1c \u0111\u00f3 k\u1ec3 t\u1eeb C++20 th\u00f4ng qua th\u01b0 vi\u1ec7n chu\u1ea9n bit:</p> <ul> <li><code>has_single_bit</code>: ki\u1ec3m tra xem s\u1ed1 c\u00f3 ph\u1ea3i l\u00e0 l\u0169y th\u1eeba c\u1ee7a hai kh\u00f4ng</li> <li><code>bit_ceil</code> / <code>bit_floor</code>: l\u00e0m tr\u00f2n l\u00ean/xu\u1ed1ng \u0111\u1ebfn l\u0169y th\u1eeba ti\u1ebfp theo c\u1ee7a hai</li> <li><code>rotl</code> / <code>rotr</code>: xoay c\u00e1c bit trong s\u1ed1</li> <li><code>countl_zero</code> / <code>countr_zero</code> / <code>countl_one</code> / <code>countr_one</code>: \u0111\u1ebfm s\u1ed1 kh\u00f4ng/s\u1ed1 m\u1ed9t d\u1eabn \u0111\u1ea7u/\u1edf cu\u1ed1i</li> <li><code>popcount</code>: \u0111\u1ebfm s\u1ed1 l\u01b0\u1ee3ng bit b\u1eadt</li> </ul> <p>Ngo\u00e0i ra, c\u0169ng c\u00f3 c\u00e1c h\u00e0m \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a tr\u01b0\u1edbc trong m\u1ed9t s\u1ed1 tr\u00ecnh bi\u00ean d\u1ecbch gi\u00fap l\u00e0m vi\u1ec7c v\u1edbi c\u00e1c bit. V.d. GCC \u0111\u1ecbnh ngh\u0129a m\u1ed9t danh s\u00e1ch t\u1ea1i C\u00e1c H\u00e0m T\u00edch H\u1ee3p \u0110\u01b0\u1ee3c Cung C\u1ea5p B\u1edfi GCC c\u0169ng ho\u1ea1t \u0111\u1ed9ng trong c\u00e1c phi\u00ean b\u1ea3n c\u0169 h\u01a1n c\u1ee7a C++:</p> <ul> <li><code>__builtin_popcount(unsigned int)</code> tr\u1ea3 v\u1ec1 s\u1ed1 l\u01b0\u1ee3ng bit b\u1eadt (<code>__builtin_popcount(0b0001'0010'1100) == 4</code>)</li> <li><code>__builtin_ffs(int)</code> t\u00ecm ch\u1ec9 s\u1ed1 c\u1ee7a bit b\u1eadt \u0111\u1ea7u ti\u00ean (ph\u1ea3i nh\u1ea5t) (<code>__builtin_ffs(0b0001'0010'1100) == 3</code>)</li> <li><code>__builtin_clz(unsigned int)</code> s\u1ed1 l\u01b0\u1ee3ng s\u1ed1 kh\u00f4ng d\u1eabn \u0111\u1ea7u (<code>__builtin_clz(0b0001'0010'1100) == 23</code>)</li> <li><code>__builtin_ctz(unsigned int)</code> s\u1ed1 l\u01b0\u1ee3ng s\u1ed1 kh\u00f4ng \u1edf cu\u1ed1i (<code>__builtin_ctz(0b0001'0010'1100) == 2</code>)</li> <li><code>__builtin_parity(x)</code> t\u00ednh ch\u1eb5n l\u1ebb (ch\u1eb5n ho\u1eb7c l\u1ebb) c\u1ee7a s\u1ed1 l\u01b0\u1ee3ng s\u1ed1 m\u1ed9t trong bi\u1ec3u di\u1ec5n bit</li> </ul> <p>L\u01b0u \u00fd r\u1eb1ng m\u1ed9t s\u1ed1 thao t\u00e1c (c\u1ea3 c\u00e1c h\u00e0m C++20 v\u00e0 c\u00e1c h\u00e0m t\u00edch h\u1ee3p c\u1ee7a tr\u00ecnh bi\u00ean d\u1ecbch) c\u00f3 th\u1ec3 kh\u00e1 ch\u1eadm trong GCC n\u1ebfu b\u1ea1n kh\u00f4ng b\u1eadt m\u1ed9t m\u1ee5c ti\u00eau tr\u00ecnh bi\u00ean d\u1ecbch c\u1ee5 th\u1ec3 b\u1eb1ng <code>#pragma GCC target(\"popcnt\")</code>.</p>","tags":["Original"]},{"location":"algebra/bit-manipulation.html#practice-problems","title":"B\u00e0i t\u1eadp luy\u1ec7n t\u1eadp","text":"<ul> <li>Codeforces - Raising Bacteria</li> <li>Codeforces - Fedor and New Game</li> <li>Codeforces - And Then There Were K</li> </ul>","tags":["Original"]},{"location":"algebra/bit-manipulation.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 261</li> <li>Translated lines: 261</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Original"]},{"location":"algebra/chinese-remainder-theorem.html","title":"\u0110\u1ecbnh l\u00fd th\u1eb7ng d\u01b0 Trung Hoa (Chinese Remainder Theorem)","text":"<p>\u0110\u1ecbnh l\u00fd th\u1eb7ng d\u01b0 Trung Hoa (s\u1ebd \u0111\u01b0\u1ee3c g\u1ecdi t\u1eaft l\u00e0 CRT trong ph\u1ea7n c\u00f2n l\u1ea1i c\u1ee7a b\u00e0i vi\u1ebft) \u0111\u01b0\u1ee3c t\u00ecm ra b\u1edfi nh\u00e0 to\u00e1n h\u1ecdc Trung Qu\u1ed1c T\u00f4n T\u1eed (Sun Zi).</p>","tags":["Translated"]},{"location":"algebra/chinese-remainder-theorem.html#formulation","title":"Ph\u00e1t bi\u1ec3u (Formulation)","text":"<p>Cho $m = m_1 \\cdot m_2 \\cdots m_k$, trong \u0111\u00f3 c\u00e1c $m_i$ \u0111\u00f4i m\u1ed9t nguy\u00ean t\u1ed1 c\u00f9ng nhau. Ngo\u00e0i $m_i$, ch\u00fang ta c\u0169ng \u0111\u01b0\u1ee3c cho m\u1ed9t h\u1ec7 ph\u01b0\u01a1ng tr\u00ecnh \u0111\u1ed3ng d\u01b0:</p> $$\\left\\{\\begin{array}{rcl}     a &amp; \\equiv &amp; a_1 \\pmod{m_1} \\\\     a &amp; \\equiv &amp; a_2 \\pmod{m_2} \\\\       &amp; \\vdots &amp; \\\\     a &amp; \\equiv &amp; a_k \\pmod{m_k} \\end{array}\\right.$$ <p>trong \u0111\u00f3 $a_i$ l\u00e0 c\u00e1c h\u1eb1ng s\u1ed1 \u0111\u00e3 cho. D\u1ea1ng g\u1ed1c c\u1ee7a CRT ph\u00e1t bi\u1ec3u r\u1eb1ng h\u1ec7 ph\u01b0\u01a1ng tr\u00ecnh \u0111\u1ed3ng d\u01b0 \u0111\u00e3 cho lu\u00f4n c\u00f3 m\u1ed9t v\u00e0 ch\u1ec9 m\u1ed9t nghi\u1ec7m theo modulo $m$.</p> <p>V.d. h\u1ec7 ph\u01b0\u01a1ng tr\u00ecnh \u0111\u1ed3ng d\u01b0</p> $$\\left\\{\\begin{array}{rcl}     a &amp; \\equiv &amp; 2 \\pmod{3} \\\\     a &amp; \\equiv &amp; 3 \\pmod{5} \\\\     a &amp; \\equiv &amp; 2 \\pmod{7} \\end{array}\\right.$$ <p>c\u00f3 nghi\u1ec7m l\u00e0 $23$ modulo $105$, b\u1edfi v\u00ec $23 \\bmod{3} = 2$, $23 \\bmod{5} = 3$, v\u00e0 $23 \\bmod{7} = 2$. Ch\u00fang ta c\u00f3 th\u1ec3 vi\u1ebft m\u1ecdi nghi\u1ec7m d\u01b0\u1edbi d\u1ea1ng $23 + 105\\cdot k$ v\u1edbi $k \\in \\mathbb{Z}$.</p>","tags":["Translated"]},{"location":"algebra/chinese-remainder-theorem.html#corollary","title":"H\u1ec7 qu\u1ea3","text":"<p>M\u1ed9t h\u1ec7 qu\u1ea3 c\u1ee7a CRT l\u00e0 ph\u01b0\u01a1ng tr\u00ecnh</p> $$x \\equiv a \\pmod{m}$$ <p>t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi h\u1ec7 ph\u01b0\u01a1ng tr\u00ecnh</p> $$\\left\\{\\begin{array}{rcl}     x &amp; \\equiv &amp; a_1 \\pmod{m_1} \\\\       &amp; \\vdots &amp; \\\\     x &amp; \\equiv &amp; a_k \\pmod{m_k} \\end{array}\\right.$$ <p>(Nh\u01b0 tr\u00ean, gi\u1ea3 s\u1eed r\u1eb1ng $m = m_1 m_2 \\cdots m_k$ v\u00e0 c\u00e1c $m_i$ \u0111\u00f4i m\u1ed9t nguy\u00ean t\u1ed1 c\u00f9ng nhau).</p>","tags":["Translated"]},{"location":"algebra/chinese-remainder-theorem.html#solution-for-two-moduli","title":"L\u1eddi gi\u1ea3i cho hai modulo","text":"<p>Xem x\u00e9t h\u1ec7 hai ph\u01b0\u01a1ng tr\u00ecnh v\u1edbi $m_1, m_2$ nguy\u00ean t\u1ed1 c\u00f9ng nhau:</p> $$ \\left\\{\\begin{align}     a &amp;\\equiv a_1 \\pmod{m_1} \\\\     a &amp;\\equiv a_2 \\pmod{m_2} \\\\ \\end{align}\\right. $$ <p>Ch\u00fang ta mu\u1ed1n t\u00ecm nghi\u1ec7m cho $a \\pmod{m_1 m_2}$. S\u1eed d\u1ee5ng Thu\u1eadt to\u00e1n Euclid m\u1edf r\u1ed9ng ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm c\u00e1c h\u1ec7 s\u1ed1 B\u00e9zout $n_1, n_2$ sao cho</p> $$n_1 m_1 + n_2 m_2 = 1.$$ <p>Th\u1ef1c t\u1ebf $n_1$ v\u00e0 $n_2$ ch\u00ednh l\u00e0 ngh\u1ecbch \u0111\u1ea3o modulo c\u1ee7a $m_1$ v\u00e0 $m_2$ theo modulo $m_2$ v\u00e0 $m_1$. Ch\u00fang ta c\u00f3 $n_1 m_1 \\equiv 1 \\pmod{m_2}$ v\u00ec v\u1eady $n_1 \\equiv m_1^{-1} \\pmod{m_2}$, v\u00e0 ng\u01b0\u1ee3c l\u1ea1i $n_2 \\equiv m_2^{-1} \\pmod{m_1}$. </p> <p>V\u1edbi hai h\u1ec7 s\u1ed1 \u0111\u00f3 ch\u00fang ta c\u00f3 th\u1ec3 \u0111\u1ecbnh ngh\u0129a m\u1ed9t nghi\u1ec7m:</p> $$a = a_1 n_2 m_2 + a_2 n_1 m_1 \\bmod{m_1 m_2}$$ <p>D\u1ec5 d\u00e0ng ki\u1ec3m ch\u1ee9ng r\u1eb1ng \u0111\u00e2y th\u1ef1c s\u1ef1 l\u00e0 m\u1ed9t nghi\u1ec7m b\u1eb1ng c\u00e1ch t\u00ednh $a \\bmod{m_1}$ v\u00e0 $a \\bmod{m_2}$.</p> $$ \\begin{array}{rcll} a &amp; \\equiv &amp; a_1 n_2 m_2 + a_2 n_1 m_1 &amp; \\pmod{m_1}\\\\   &amp; \\equiv &amp; a_1 (1 - n_1 m_1) + a_2 n_1 m_1 &amp; \\pmod{m_1}\\\\   &amp; \\equiv &amp; a_1 - a_1 n_1 m_1 + a_2 n_1 m_1 &amp; \\pmod{m_1}\\\\   &amp; \\equiv &amp; a_1 &amp; \\pmod{m_1} \\end{array} $$ <p>L\u01b0u \u00fd r\u1eb1ng \u0110\u1ecbnh l\u00fd th\u1eb7ng d\u01b0 Trung Hoa c\u0169ng \u0111\u1ea3m b\u1ea3o r\u1eb1ng ch\u1ec9 c\u00f3 1 nghi\u1ec7m t\u1ed3n t\u1ea1i theo modulo $m_1 m_2$. \u0110i\u1ec1u n\u00e0y c\u0169ng d\u1ec5 ch\u1ee9ng minh.</p> <p>Gi\u1ea3 s\u1eed b\u1ea1n c\u00f3 hai nghi\u1ec7m kh\u00e1c nhau $x$ v\u00e0 $y$. V\u00ec $x \\equiv a_i \\pmod{m_i}$ v\u00e0 $y \\equiv a_i \\pmod{m_i}$, suy ra $x \u2212 y \\equiv 0 \\pmod{m_i}$ v\u00e0 do \u0111\u00f3 $x \u2212 y \\equiv 0 \\pmod{m_1 m_2}$ hay t\u01b0\u01a1ng \u0111\u01b0\u01a1ng $x \\equiv y \\pmod{m_1 m_2}$. V\u1eady $x$ v\u00e0 $y$ th\u1ef1c ch\u1ea5t l\u00e0 c\u00f9ng m\u1ed9t nghi\u1ec7m.</p>","tags":["Translated"]},{"location":"algebra/chinese-remainder-theorem.html#solution-for-general-case","title":"L\u1eddi gi\u1ea3i cho tr\u01b0\u1eddng h\u1ee3p t\u1ed5ng qu\u00e1t","text":"","tags":["Translated"]},{"location":"algebra/chinese-remainder-theorem.html#inductive-solution","title":"L\u1eddi gi\u1ea3i quy n\u1ea1p","text":"<p>V\u00ec $m_1 m_2$ nguy\u00ean t\u1ed1 c\u00f9ng nhau v\u1edbi $m_3$, ch\u00fang ta c\u00f3 th\u1ec3 \u00e1p d\u1ee5ng l\u1eb7p l\u1ea1i l\u1eddi gi\u1ea3i cho hai modulo m\u1ed9t c\u00e1ch quy n\u1ea1p cho b\u1ea5t k\u1ef3 s\u1ed1 l\u01b0\u1ee3ng modulo n\u00e0o. \u0110\u1ea7u ti\u00ean b\u1ea1n t\u00ednh $b_2 := a \\pmod{m_1 m_2}$ s\u1eed d\u1ee5ng hai ph\u01b0\u01a1ng tr\u00ecnh \u0111\u1ed3ng d\u01b0 \u0111\u1ea7u ti\u00ean, sau \u0111\u00f3 b\u1ea1n c\u00f3 th\u1ec3 t\u00ednh $b_3 := a \\pmod{m_1 m_2 m_3}$ s\u1eed d\u1ee5ng c\u00e1c ph\u01b0\u01a1ng tr\u00ecnh \u0111\u1ed3ng d\u01b0 $a \\equiv b_2 \\pmod{m_1 m_2}$ v\u00e0 $a \\equiv a_3 \\pmod {m_3}$, v.v.</p>","tags":["Translated"]},{"location":"algebra/chinese-remainder-theorem.html#direct-construction","title":"X\u00e2y d\u1ef1ng tr\u1ef1c ti\u1ebfp","text":"<p>M\u1ed9t c\u00e1ch x\u00e2y d\u1ef1ng tr\u1ef1c ti\u1ebfp t\u01b0\u01a1ng t\u1ef1 nh\u01b0 n\u1ed9i suy Lagrange l\u00e0 kh\u1ea3 thi.</p> <p>G\u1ecdi $M_i := \\prod_{i \\neq j} m_j$, t\u00edch c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c modulo ngo\u1ea1i tr\u1eeb $m_i$, v\u00e0 $N_i$ l\u00e0 ngh\u1ecbch \u0111\u1ea3o modulo $N_i := M_i^{-1} \\bmod{m_i}$. Khi \u0111\u00f3 m\u1ed9t nghi\u1ec7m c\u1ee7a h\u1ec7 ph\u01b0\u01a1ng tr\u00ecnh \u0111\u1ed3ng d\u01b0 l\u00e0:</p> $$a \\equiv \\sum_{i=1}^k a_i M_i N_i \\pmod{m_1 m_2 \\cdots m_k}$$ <p>Ch\u00fang ta c\u00f3 th\u1ec3 ki\u1ec3m tra \u0111\u00e2y th\u1ef1c s\u1ef1 l\u00e0 m\u1ed9t nghi\u1ec7m, b\u1eb1ng c\u00e1ch t\u00ednh $a \\bmod{m_i}$ cho t\u1ea5t c\u1ea3 $i$. V\u00ec $M_j$ l\u00e0 b\u1ed9i c\u1ee7a $m_i$ v\u1edbi $i \\neq j$ ch\u00fang ta c\u00f3</p> $$\\begin{array}{rcll} a &amp; \\equiv &amp; \\sum_{j=1}^k a_j M_j N_j &amp; \\pmod{m_i} \\\\   &amp; \\equiv &amp; a_i M_i N_i              &amp; \\pmod{m_i} \\\\   &amp; \\equiv &amp; a_i M_i M_i^{-1}         &amp; \\pmod{m_i} \\\\   &amp; \\equiv &amp; a_i                      &amp; \\pmod{m_i} \\end{array}$$","tags":["Translated"]},{"location":"algebra/chinese-remainder-theorem.html#implementation","title":"C\u00e0i \u0111\u1eb7t","text":"<pre><code>struct Congruence {\n    long long a, m;\n};\n\nlong long chinese_remainder_theorem(vector&lt;Congruence&gt; const&amp; congruences) {\n    long long M = 1;\n    for (auto const&amp; congruence : congruences) {\n        M *= congruence.m;\n    }\n\n    long long solution = 0;\n    for (auto const&amp; congruence : congruences) {\n        long long a_i = congruence.a;\n        long long M_i = M / congruence.m;\n        long long N_i = mod_inv(M_i, congruence.m);\n        solution = (solution + a_i * M_i % M * N_i) % M;\n    }\n    return solution;\n}\n</code></pre>","tags":["Translated"]},{"location":"algebra/chinese-remainder-theorem.html#solution-for-not-coprime-moduli","title":"L\u1eddi gi\u1ea3i cho c\u00e1c modulo kh\u00f4ng nguy\u00ean t\u1ed1 c\u00f9ng nhau","text":"<p>Nh\u01b0 \u0111\u00e3 \u0111\u1ec1 c\u1eadp, thu\u1eadt to\u00e1n tr\u00ean ch\u1ec9 ho\u1ea1t \u0111\u1ed9ng cho c\u00e1c modulo nguy\u00ean t\u1ed1 c\u00f9ng nhau $m_1, m_2, \\dots m_k$.</p> <p>Trong tr\u01b0\u1eddng h\u1ee3p kh\u00f4ng nguy\u00ean t\u1ed1 c\u00f9ng nhau, m\u1ed9t h\u1ec7 th\u1ed1ng \u0111\u1ed3ng d\u01b0 c\u00f3 \u0111\u00fang m\u1ed9t nghi\u1ec7m theo modulo $\\text{lcm}(m_1, m_2, \\dots, m_k)$, ho\u1eb7c kh\u00f4ng c\u00f3 nghi\u1ec7m n\u00e0o c\u1ea3.</p> <p>V.d. trong h\u1ec7 th\u1ed1ng sau, ph\u01b0\u01a1ng tr\u00ecnh \u0111\u1ed3ng d\u01b0 \u0111\u1ea7u ti\u00ean ng\u1ee5 \u00fd r\u1eb1ng nghi\u1ec7m l\u00e0 s\u1ed1 l\u1ebb, v\u00e0 ph\u01b0\u01a1ng tr\u00ecnh \u0111\u1ed3ng d\u01b0 th\u1ee9 hai ng\u1ee5 \u00fd r\u1eb1ng nghi\u1ec7m l\u00e0 s\u1ed1 ch\u1eb5n. Kh\u00f4ng th\u1ec3 c\u00f3 m\u1ed9t s\u1ed1 v\u1eeba l\u1ebb v\u1eeba ch\u1eb5n, do \u0111\u00f3 r\u00f5 r\u00e0ng kh\u00f4ng c\u00f3 nghi\u1ec7m.</p> $$\\left\\{\\begin{align}     a &amp; \\equiv 1 \\pmod{4} \\\\     a &amp; \\equiv 2 \\pmod{6} \\end{align}\\right.$$ <p>Kh\u00e1 \u0111\u01a1n gi\u1ea3n \u0111\u1ec3 x\u00e1c \u0111\u1ecbnh xem m\u1ed9t h\u1ec7 th\u1ed1ng c\u00f3 nghi\u1ec7m hay kh\u00f4ng. V\u00e0 n\u1ebfu n\u00f3 c\u00f3 nghi\u1ec7m, ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng thu\u1eadt to\u00e1n ban \u0111\u1ea7u \u0111\u1ec3 gi\u1ea3i m\u1ed9t h\u1ec7 th\u1ed1ng \u0111\u1ed3ng d\u01b0 \u0111\u00e3 s\u1eeda \u0111\u1ed5i m\u1ed9t ch\u00fat.</p> <p>M\u1ed9t ph\u01b0\u01a1ng tr\u00ecnh \u0111\u1ed3ng d\u01b0 \u0111\u01a1n l\u1ebb $a \\equiv a_i \\pmod{m_i}$ t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi h\u1ec7 ph\u01b0\u01a1ng tr\u00ecnh \u0111\u1ed3ng d\u01b0 $a \\equiv a_i \\pmod{p_j^{n_j}}$ trong \u0111\u00f3 $p_1^{n_1} p_2^{n_2}\\cdots p_k^{n_k}$ l\u00e0 ph\u00e2n t\u00edch th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1 c\u1ee7a $m_i$.</p> <p>V\u1edbi th\u1ef1c t\u1ebf n\u00e0y, ch\u00fang ta c\u00f3 th\u1ec3 s\u1eeda \u0111\u1ed5i h\u1ec7 th\u1ed1ng \u0111\u1ed3ng d\u01b0 th\u00e0nh m\u1ed9t h\u1ec7 th\u1ed1ng ch\u1ec9 c\u00f3 c\u00e1c l\u0169y th\u1eeba nguy\u00ean t\u1ed1 l\u00e0m modulo. V.d. h\u1ec7 th\u1ed1ng \u0111\u1ed3ng d\u01b0 tr\u00ean t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi:</p> $$\\left\\{\\begin{array}{ll}     a \\equiv 1          &amp; \\pmod{4} \\\\     a \\equiv 2 \\equiv 0 &amp; \\pmod{2} \\\\     a \\equiv 2          &amp; \\pmod{3} \\end{array}\\right.$$ <p>B\u1edfi v\u00ec ban \u0111\u1ea7u m\u1ed9t s\u1ed1 modulo c\u00f3 th\u1eeba s\u1ed1 chung, ch\u00fang ta s\u1ebd nh\u1eadn \u0111\u01b0\u1ee3c m\u1ed9t s\u1ed1 ph\u01b0\u01a1ng tr\u00ecnh \u0111\u1ed3ng d\u01b0 modulo d\u1ef1a tr\u00ean c\u00f9ng m\u1ed9t s\u1ed1 nguy\u00ean t\u1ed1, tuy nhi\u00ean c\u00f3 th\u1ec3 v\u1edbi c\u00e1c l\u0169y th\u1eeba nguy\u00ean t\u1ed1 kh\u00e1c nhau.</p> <p>B\u1ea1n c\u00f3 th\u1ec3 quan s\u00e1t th\u1ea5y r\u1eb1ng, ph\u01b0\u01a1ng tr\u00ecnh \u0111\u1ed3ng d\u01b0 v\u1edbi modulo l\u0169y th\u1eeba nguy\u00ean t\u1ed1 cao nh\u1ea5t s\u1ebd l\u00e0 ph\u01b0\u01a1ng tr\u00ecnh \u0111\u1ed3ng d\u01b0 m\u1ea1nh nh\u1ea5t trong t\u1ea5t c\u1ea3 c\u00e1c ph\u01b0\u01a1ng tr\u00ecnh \u0111\u1ed3ng d\u01b0 d\u1ef1a tr\u00ean c\u00f9ng m\u1ed9t s\u1ed1 nguy\u00ean t\u1ed1. Ho\u1eb7c l\u00e0 n\u00f3 s\u1ebd \u0111\u01b0a ra m\u00e2u thu\u1eabn v\u1edbi m\u1ed9t s\u1ed1 ph\u01b0\u01a1ng tr\u00ecnh \u0111\u1ed3ng d\u01b0 kh\u00e1c, ho\u1eb7c n\u00f3 s\u1ebd bao h\u00e0m t\u1ea5t c\u1ea3 c\u00e1c ph\u01b0\u01a1ng tr\u00ecnh \u0111\u1ed3ng d\u01b0 kh\u00e1c.</p> <p>Trong tr\u01b0\u1eddng h\u1ee3p c\u1ee7a ch\u00fang ta, ph\u01b0\u01a1ng tr\u00ecnh \u0111\u1ea7u ti\u00ean $a \\equiv 1 \\pmod{4}$ ng\u1ee5 \u00fd $a \\equiv 1 \\pmod{2}$, v\u00e0 do \u0111\u00f3 m\u00e2u thu\u1eabn v\u1edbi ph\u01b0\u01a1ng tr\u00ecnh th\u1ee9 hai $a \\equiv 0 \\pmod{2}$. V\u00ec v\u1eady h\u1ec7 th\u1ed1ng \u0111\u1ed3ng d\u01b0 n\u00e0y kh\u00f4ng c\u00f3 nghi\u1ec7m.</p> <p>N\u1ebfu kh\u00f4ng c\u00f3 m\u00e2u thu\u1eabn, th\u00ec h\u1ec7 ph\u01b0\u01a1ng tr\u00ecnh c\u00f3 nghi\u1ec7m. Ch\u00fang ta c\u00f3 th\u1ec3 b\u1ecf qua t\u1ea5t c\u1ea3 c\u00e1c ph\u01b0\u01a1ng tr\u00ecnh \u0111\u1ed3ng d\u01b0 ngo\u1ea1i tr\u1eeb nh\u1eefng ph\u01b0\u01a1ng tr\u00ecnh c\u00f3 modulo l\u0169y th\u1eeba nguy\u00ean t\u1ed1 cao nh\u1ea5t. C\u00e1c modulo n\u00e0y b\u00e2y gi\u1edd l\u00e0 nguy\u00ean t\u1ed1 c\u00f9ng nhau, v\u00e0 do \u0111\u00f3 ch\u00fang ta c\u00f3 th\u1ec3 gi\u1ea3i h\u1ec7 n\u00e0y b\u1eb1ng thu\u1eadt to\u00e1n \u0111\u00e3 th\u1ea3o lu\u1eadn \u1edf c\u00e1c ph\u1ea7n tr\u00ean.</p> <p>V.d. h\u1ec7 th\u1ed1ng sau c\u00f3 nghi\u1ec7m theo modulo $\\text{lcm}(10, 12) = 60$.</p> $$\\left\\{\\begin{align}     a &amp; \\equiv 3 \\pmod{10} \\\\     a &amp; \\equiv 5 \\pmod{12} \\end{align}\\right.$$ <p>H\u1ec7 th\u1ed1ng \u0111\u1ed3ng d\u01b0 t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi h\u1ec7 th\u1ed1ng \u0111\u1ed3ng d\u01b0:</p> $$\\left\\{\\begin{align}     a &amp; \\equiv 3 \\equiv 1 \\pmod{2} \\\\     a &amp; \\equiv 3 \\equiv 3 \\pmod{5} \\\\     a &amp; \\equiv 5 \\equiv 1 \\pmod{4} \\\\     a &amp; \\equiv 5 \\equiv 2 \\pmod{3} \\end{align}\\right.$$ <p>Ph\u01b0\u01a1ng tr\u00ecnh \u0111\u1ed3ng d\u01b0 duy nh\u1ea5t c\u00f3 c\u00f9ng modulo nguy\u00ean t\u1ed1 l\u00e0 $a \\equiv 1 \\pmod{4}$ v\u00e0 $a \\equiv 1 \\pmod{2}$. Ph\u01b0\u01a1ng tr\u00ecnh \u0111\u1ea7u ti\u00ean \u0111\u00e3 bao h\u00e0m ph\u01b0\u01a1ng tr\u00ecnh th\u1ee9 hai, v\u00ec v\u1eady ch\u00fang ta c\u00f3 th\u1ec3 b\u1ecf qua ph\u01b0\u01a1ng tr\u00ecnh th\u1ee9 hai, v\u00e0 gi\u1ea3i h\u1ec7 th\u1ed1ng sau v\u1edbi c\u00e1c modulo nguy\u00ean t\u1ed1 c\u00f9ng nhau thay th\u1ebf:</p> $$\\left\\{\\begin{align}     a &amp; \\equiv 3 \\equiv 3 \\pmod{5} \\\\     a &amp; \\equiv 5 \\equiv 1 \\pmod{4} \\\\     a &amp; \\equiv 5 \\equiv 2 \\pmod{3} \\end{align}\\right.$$ <p>N\u00f3 c\u00f3 nghi\u1ec7m $53 \\pmod{60}$, v\u00e0 th\u1ef1c s\u1ef1 $53 \\bmod{10} = 3$ v\u00e0 $53 \\bmod{12} = 5$.</p>","tags":["Translated"]},{"location":"algebra/chinese-remainder-theorem.html#garners-algorithm","title":"Thu\u1eadt to\u00e1n Garner","text":"<p>M\u1ed9t h\u1ec7 qu\u1ea3 kh\u00e1c c\u1ee7a CRT l\u00e0 ch\u00fang ta c\u00f3 th\u1ec3 bi\u1ec3u di\u1ec5n c\u00e1c s\u1ed1 l\u1edbn b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng m\u1ed9t m\u1ea3ng c\u00e1c s\u1ed1 nguy\u00ean nh\u1ecf.</p> <p>Thay v\u00ec th\u1ef1c hi\u1ec7n nhi\u1ec1u t\u00ednh to\u00e1n v\u1edbi c\u00e1c s\u1ed1 r\u1ea5t l\u1edbn, \u0111i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 t\u1ed1n k\u00e9m (h\u00e3y ngh\u0129 \u0111\u1ebfn vi\u1ec7c th\u1ef1c hi\u1ec7n ph\u00e9p chia v\u1edbi c\u00e1c s\u1ed1 1000 ch\u1eef s\u1ed1), b\u1ea1n c\u00f3 th\u1ec3 ch\u1ecdn m\u1ed9t v\u00e0i modulo nguy\u00ean t\u1ed1 c\u00f9ng nhau v\u00e0 bi\u1ec3u di\u1ec5n s\u1ed1 l\u1edbn d\u01b0\u1edbi d\u1ea1ng m\u1ed9t h\u1ec7 th\u1ed1ng \u0111\u1ed3ng d\u01b0, v\u00e0 th\u1ef1c hi\u1ec7n t\u1ea5t c\u1ea3 c\u00e1c ph\u00e9p to\u00e1n tr\u00ean h\u1ec7 ph\u01b0\u01a1ng tr\u00ecnh. B\u1ea5t k\u1ef3 s\u1ed1 n\u00e0o $a$ nh\u1ecf h\u01a1n $m_1 m_2 \\cdots m_k$ \u0111\u1ec1u c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n d\u01b0\u1edbi d\u1ea1ng m\u1ed9t m\u1ea3ng $a_1, \\ldots, a_k$, trong \u0111\u00f3 $a \\equiv a_i \\pmod{m_i}$.</p> <p>B\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng thu\u1eadt to\u00e1n tr\u00ean, b\u1ea1n c\u00f3 th\u1ec3 kh\u00f4i ph\u1ee5c l\u1ea1i s\u1ed1 l\u1edbn b\u1ea5t c\u1ee9 khi n\u00e0o b\u1ea1n c\u1ea7n.</p> <p>Ngo\u00e0i ra, b\u1ea1n c\u00f3 th\u1ec3 bi\u1ec3u di\u1ec5n s\u1ed1 trong bi\u1ec3u di\u1ec5n c\u01a1 s\u1ed1 h\u1ed7n h\u1ee3p (mixed radix):</p> $$a = x_1 + x_2 m_1 + x_3 m_1 m_2 + \\ldots + x_k m_1 \\cdots m_{k-1} \\text{ v\u1edbi }x_i \\in [0, m_i)$$ <p>Thu\u1eadt to\u00e1n Garner, \u0111\u01b0\u1ee3c th\u1ea3o lu\u1eadn trong b\u00e0i vi\u1ebft d\u00e0nh ri\u00eang Thu\u1eadt to\u00e1n Garner, t\u00ednh to\u00e1n c\u00e1c h\u1ec7 s\u1ed1 $x_i$. V\u00e0 v\u1edbi nh\u1eefng h\u1ec7 s\u1ed1 \u0111\u00f3 b\u1ea1n c\u00f3 th\u1ec3 kh\u00f4i ph\u1ee5c s\u1ed1 \u0111\u1ea7y \u0111\u1ee7.</p>","tags":["Translated"]},{"location":"algebra/chinese-remainder-theorem.html#practice-problems","title":"B\u00e0i t\u1eadp luy\u1ec7n t\u1eadp:","text":"<ul> <li>Google Code Jam - Golf Gophers</li> <li>Hackerrank - Number of sequences</li> <li>Codeforces - Remainders Game</li> </ul>","tags":["Translated"]},{"location":"algebra/chinese-remainder-theorem.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 231</li> <li>Translated lines: 231</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Translated"]},{"location":"algebra/continued-fractions.html","title":"Li\u00ean ph\u00e2n s\u1ed1","text":"","tags":["Original"]},{"location":"algebra/continued-fractions.html#continued-fractions","title":"Li\u00ean ph\u00e2n s\u1ed1 (Continued fractions)","text":"<p>Li\u00ean ph\u00e2n s\u1ed1 (continued fraction) l\u00e0 m\u1ed9t bi\u1ec3u di\u1ec5n c\u1ee7a s\u1ed1 th\u1ef1c d\u01b0\u1edbi d\u1ea1ng m\u1ed9t d\u00e3y s\u1ed1 h\u1eefu t\u1ef7 h\u1ed9i t\u1ee5 c\u1ee5 th\u1ec3. Ch\u00fang r\u1ea5t h\u1eefu \u00edch trong l\u1eadp tr\u00ecnh thi \u0111\u1ea5u v\u00ec ch\u00fang d\u1ec5 t\u00ednh to\u00e1n v\u00e0 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng hi\u1ec7u qu\u1ea3 \u0111\u1ec3 t\u00ecm x\u1ea5p x\u1ec9 h\u1eefu t\u1ef7 t\u1ed1t nh\u1ea5t c\u00f3 th\u1ec3 c\u1ee7a s\u1ed1 th\u1ef1c c\u01a1 b\u1ea3n (trong s\u1ed1 t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 c\u00f3 m\u1eabu s\u1ed1 kh\u00f4ng v\u01b0\u1ee3t qu\u00e1 m\u1ed9t gi\u00e1 tr\u1ecb nh\u1ea5t \u0111\u1ecbnh).</p> <p>B\u00ean c\u1ea1nh \u0111\u00f3, li\u00ean ph\u00e2n s\u1ed1 c\u00f3 li\u00ean quan ch\u1eb7t ch\u1ebd \u0111\u1ebfn thu\u1eadt to\u00e1n Euclid, \u0111i\u1ec1u n\u00e0y l\u00e0m cho ch\u00fang tr\u1edf n\u00ean h\u1eefu \u00edch trong m\u1ed9t lo\u1ea1t c\u00e1c b\u00e0i to\u00e1n l\u00fd thuy\u1ebft s\u1ed1.</p>","tags":["Original"]},{"location":"algebra/continued-fractions.html#continued-fraction-representation","title":"Bi\u1ec3u di\u1ec5n li\u00ean ph\u00e2n s\u1ed1 (Continued fraction representation)","text":"<p>\u0110\u1ecbnh ngh\u0129a</p> <p>Cho $a_0, a_1, \\dots, a_k \\in \\mathbb Z$ v\u00e0 $a_1, a_2, \\dots, a_k \\geq 1$. Khi \u0111\u00f3 bi\u1ec3u th\u1ee9c</p> $$r=a_0 + \\frac{1}{a_1 + \\frac{1}{\\dots + \\frac{1}{a_k}}},$$ <p>\u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 bi\u1ec3u di\u1ec5n li\u00ean ph\u00e2n s\u1ed1 c\u1ee7a s\u1ed1 h\u1eefu t\u1ef7 $r$ v\u00e0 \u0111\u01b0\u1ee3c k\u00fd hi\u1ec7u ng\u1eafn g\u1ecdn l\u00e0 $r=[a_0;a_1,a_2,\\dots,a_k]$.</p> Example <p>Cho $r = \\frac{5}{3}$. C\u00f3 hai c\u00e1ch \u0111\u1ec3 bi\u1ec3u di\u1ec5n n\u00f3 d\u01b0\u1edbi d\u1ea1ng li\u00ean ph\u00e2n s\u1ed1:</p> $$ \\begin{align} r = [1;1,1,1] &amp;= 1+\\frac{1}{1+\\frac{1}{1+\\frac{1}{1}}},\\\\ r = [1;1,2] &amp;= 1+\\frac{1}{1+\\frac{1}{2}}. \\end{align} $$ <p>Ng\u01b0\u1eddi ta ch\u1ee9ng minh \u0111\u01b0\u1ee3c r\u1eb1ng b\u1ea5t k\u1ef3 s\u1ed1 h\u1eefu t\u1ef7 n\u00e0o c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n d\u01b0\u1edbi d\u1ea1ng li\u00ean ph\u00e2n s\u1ed1 theo \u0111\u00fang $2$ c\u00e1ch:</p> $$r = [a_0;a_1,\\dots,a_k,1] = [a_0;a_1,\\dots,a_k+1].$$ <p>h\u01a1n n\u1eefa, \u0111\u1ed9 d\u00e0i $k$ c\u1ee7a li\u00ean ph\u00e2n s\u1ed1 nh\u01b0 v\u1eady \u0111\u01b0\u1ee3c \u01b0\u1edbc t\u00ednh l\u00e0 $k = O(\\log \\min(p, q))$ \u0111\u1ed1i v\u1edbi $r=\\frac{p}{q}$.</p> <p>L\u00fd do \u0111\u1eb1ng sau \u0111i\u1ec1u n\u00e0y s\u1ebd r\u00f5 r\u00e0ng khi ch\u00fang ta \u0111i s\u00e2u v\u00e0o chi ti\u1ebft c\u1ee7a vi\u1ec7c x\u00e2y d\u1ef1ng li\u00ean ph\u00e2n s\u1ed1.</p> <p>\u0110\u1ecbnh ngh\u0129a</p> <p>Cho $a_0,a_1,a_2, \\dots$ l\u00e0 m\u1ed9t d\u00e3y s\u1ed1 nguy\u00ean sao cho $a_1, a_2, \\dots \\geq 1$. G\u1ecdi $r_k = [a_0; a_1, \\dots, a_k]$. Khi \u0111\u00f3 bi\u1ec3u th\u1ee9c</p> $$r = a_0 + \\frac{1}{a_1 + \\frac{1}{a_2+\\dots}} = \\lim\\limits_{k \\to \\infty} r_k.$$ <p>\u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 bi\u1ec3u di\u1ec5n li\u00ean ph\u00e2n s\u1ed1 c\u1ee7a s\u1ed1 v\u00f4 t\u1ef7 $r$ v\u00e0 \u0111\u01b0\u1ee3c k\u00fd hi\u1ec7u ng\u1eafn g\u1ecdn l\u00e0 $r = [a_0;a_1,a_2,\\dots]$.</p> <p>L\u01b0u \u00fd r\u1eb1ng \u0111\u1ed1i v\u1edbi $r=[a_0;a_1,\\dots]$ v\u00e0 s\u1ed1 nguy\u00ean $k$, ta c\u00f3 $r+k = [a_0+k; a_1, \\dots]$.</p> <p>M\u1ed9t quan s\u00e1t quan tr\u1ecdng kh\u00e1c l\u00e0 $\\frac{1}{r}=[0;a_0, a_1, \\dots]$ khi $a_0 &gt; 0$ v\u00e0 $\\frac{1}{r} = [a_1; a_2, \\dots]$ khi $a_0 = 0$.</p> <p>\u0110\u1ecbnh ngh\u0129a</p> <p>Trong \u0111\u1ecbnh ngh\u0129a tr\u00ean, c\u00e1c s\u1ed1 h\u1eefu t\u1ef7 $r_0, r_1, r_2, \\dots$ \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 c\u00e1c gi\u1ea3n ph\u00e2n (convergents) c\u1ee7a $r$.</p> <p>T\u01b0\u01a1ng \u1ee9ng, m\u1ed7i $r_k = [a_0; a_1, \\dots, a_k] = \\frac{p_k}{q_k}$ \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 gi\u1ea3n ph\u00e2n th\u1ee9 $k$ c\u1ee7a $r$.</p> Example <p>X\u00e9t $r = [1; 1, 1, 1, \\dots]$. Ng\u01b0\u1eddi ta c\u00f3 th\u1ec3 ch\u1ee9ng minh b\u1eb1ng quy n\u1ea1p r\u1eb1ng $r_k = \\frac{F_{k+2}}{F_{k+1}}$, trong \u0111\u00f3 $F_k$ l\u00e0 d\u00e3y Fibonacci \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a l\u00e0 $F_0 = 0$, $F_1 = 1$ v\u00e0 $F_{k} = F_{k-1} + F_{k-2}$. T\u1eeb c\u00f4ng th\u1ee9c Binet, ng\u01b0\u1eddi ta bi\u1ebft r\u1eb1ng</p> $$r_k = \\frac{\\phi^{k+2} - \\psi^{k+2}}{\\phi^{k+1} - \\psi^{k+1}},$$ <p>trong \u0111\u00f3 $\\phi = \\frac{1+\\sqrt{5}}{2} \\approx 1.618$ l\u00e0 t\u1ef7 l\u1ec7 v\u00e0ng v\u00e0 $\\psi = \\frac{1-\\sqrt{5}}{2} = -\\frac{1}{\\phi} \\approx -0.618$. Do \u0111\u00f3,</p> $$r = 1+\\frac{1}{1+\\frac{1}{1+\\dots}}=\\lim\\limits_{k \\to \\infty} r_k = \\phi = \\frac{1+\\sqrt{5}}{2}.$$ <p>L\u01b0u \u00fd r\u1eb1ng trong tr\u01b0\u1eddng h\u1ee3p c\u1ee5 th\u1ec3 n\u00e0y, m\u1ed9t c\u00e1ch kh\u00e1c \u0111\u1ec3 t\u00ecm $r$ s\u1ebd l\u00e0 gi\u1ea3i ph\u01b0\u01a1ng tr\u00ecnh</p> $$r = 1+\\frac{1}{r} \\implies r^2 = r + 1. $$ <p>\u0110\u1ecbnh ngh\u0129a</p> <p>Cho $r_k = [a_0; a_1, \\dots, a_{k-1}, a_k]$. C\u00e1c s\u1ed1 $[a_0; a_1, \\dots, a_{k-1}, t]$ v\u1edbi $1 \\leq t \\leq a_k$ \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 b\u00e1n gi\u1ea3n ph\u00e2n (semiconvergents).</p> <p>Ch\u00fang ta th\u01b0\u1eddng s\u1ebd g\u1ecdi c\u00e1c (b\u00e1n) gi\u1ea3n ph\u00e2n l\u1edbn h\u01a1n $r$ l\u00e0 (b\u00e1n) gi\u1ea3n ph\u00e2n tr\u00ean v\u00e0 nh\u1eefng (b\u00e1n) gi\u1ea3n ph\u00e2n nh\u1ecf h\u01a1n $r$ l\u00e0 (b\u00e1n) gi\u1ea3n ph\u00e2n d\u01b0\u1edbi.</p> <p>\u0110\u1ecbnh ngh\u0129a</p> <p>B\u1ed5 sung cho c\u00e1c gi\u1ea3n ph\u00e2n, ch\u00fang ta \u0111\u1ecbnh ngh\u0129a th\u01b0\u01a1ng \u0111\u1ea7y \u0111\u1ee7 (complete quotients) l\u00e0 $s_k = [a_k; a_{k+1}, a_{k+2}, \\dots]$.</p> <p>T\u01b0\u01a1ng \u1ee9ng, ch\u00fang ta s\u1ebd g\u1ecdi m\u1ed7i $s_k$ l\u00e0 th\u01b0\u01a1ng \u0111\u1ea7y \u0111\u1ee7 th\u1ee9 $k$ c\u1ee7a $r$.</p> <p>T\u1eeb c\u00e1c \u0111\u1ecbnh ngh\u0129a tr\u00ean, ng\u01b0\u1eddi ta c\u00f3 th\u1ec3 k\u1ebft lu\u1eadn r\u1eb1ng $s_k \\geq 1$ v\u1edbi $k \\geq 1$.</p> <p>Xem $[a_0; a_1, \\dots, a_k]$ nh\u01b0 m\u1ed9t bi\u1ec3u th\u1ee9c \u0111\u1ea1i s\u1ed1 h\u00ecnh th\u1ee9c v\u00e0 cho ph\u00e9p c\u00e1c s\u1ed1 th\u1ef1c b\u1ea5t k\u1ef3 thay v\u00ec $a_i$, ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c</p> $$r = [a_0; a_1, \\dots, a_{k-1}, s_k].$$ <p>C\u1ee5 th\u1ec3, $r = [s_0] = s_0$. M\u1eb7t kh\u00e1c, ch\u00fang ta c\u00f3 th\u1ec3 bi\u1ec3u di\u1ec5n $s_k$ d\u01b0\u1edbi d\u1ea1ng</p> $$s_k = [a_k; s_{k+1}] = a_k + \\frac{1}{s_{k+1}},$$ <p>c\u00f3 ngh\u0129a l\u00e0 ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh $a_k = \\lfloor s_k \\rfloor$ v\u00e0 $s_{k+1} = (s_k - a_k)^{-1}$ t\u1eeb $s_k$.</p> <p>D\u00e3y $a_0, a_1, \\dots$ \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh r\u00f5 tr\u1eeb khi $s_k=a_k$, \u0111i\u1ec1u n\u00e0y ch\u1ec9 x\u1ea3y ra khi $r$ l\u00e0 m\u1ed9t s\u1ed1 h\u1eefu t\u1ef7.</p> <p>Do \u0111\u00f3, bi\u1ec3u di\u1ec5n li\u00ean ph\u00e2n s\u1ed1 \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh duy nh\u1ea5t cho b\u1ea5t k\u1ef3 s\u1ed1 v\u00f4 t\u1ef7 $r$ n\u00e0o.</p>","tags":["Original"]},{"location":"algebra/continued-fractions.html#implementation","title":"C\u00e0i \u0111\u1eb7t","text":"<p>Trong c\u00e1c \u0111o\u1ea1n m\u00e3, ch\u00fang ta h\u1ea7u nh\u01b0 s\u1ebd gi\u1ea3 s\u1eed c\u00e1c li\u00ean ph\u00e2n s\u1ed1 h\u1eefu h\u1ea1n.</p> <p>T\u1eeb $s_k$, chuy\u1ec3n \u0111\u1ed5i sang $s_{k+1}$ tr\u00f4ng nh\u01b0 sau</p> $$s_k =\\left\\lfloor s_k \\right\\rfloor + \\frac{1}{s_{k+1}}.$$ <p>T\u1eeb bi\u1ec3u th\u1ee9c n\u00e0y, th\u01b0\u01a1ng \u0111\u1ea7y \u0111\u1ee7 ti\u1ebfp theo $s_{k+1}$ thu \u0111\u01b0\u1ee3c l\u00e0</p> $$s_{k+1} = \\left(s_k-\\left\\lfloor s_k\\right\\rfloor\\right)^{-1}.$$ <p>\u0110\u1ed1i v\u1edbi $s_k=\\frac{p}{q}$ \u0111i\u1ec1u \u0111\u00f3 c\u00f3 ngh\u0129a l\u00e0</p> $$ s_{k+1} = \\left(\\frac{p}{q}-\\left\\lfloor \\frac{p}{q} \\right\\rfloor\\right)^{-1} = \\frac{q}{p-q\\cdot \\lfloor \\frac{p}{q} \\rfloor} = \\frac{q}{p \\bmod q}. $$ <p>Do \u0111\u00f3, vi\u1ec7c t\u00ednh to\u00e1n bi\u1ec3u di\u1ec5n li\u00ean ph\u00e2n s\u1ed1 cho $r=\\frac{p}{q}$ tu\u00e2n theo c\u00e1c b\u01b0\u1edbc c\u1ee7a thu\u1eadt to\u00e1n Euclid cho $p$ v\u00e0 $q$.</p> <p>T\u1eeb \u0111i\u1ec1u n\u00e0y c\u0169ng suy ra r\u1eb1ng $\\gcd(p_k, q_k) = 1$ \u0111\u1ed1i v\u1edbi $\\frac{p_k}{q_k} = [a_0; a_1, \\dots, a_k]$. Do \u0111\u00f3, c\u00e1c gi\u1ea3n ph\u00e2n lu\u00f4n l\u00e0 t\u1ed1i gi\u1ea3n.</p> C++Python <pre><code>auto fraction(int p, int q) {\n    vector&lt;int&gt; a;\n    while(q) {\n        a.push_back(p / q);\n        tie(p, q) = make_pair(q, p % q);\n    }\n    return a;\n}\n</code></pre> <pre><code>def fraction(p, q):\n    a = []\n    while q:\n        a.append(p // q)\n        p, q = q, p % q\n    return a\n</code></pre>","tags":["Original"]},{"location":"algebra/continued-fractions.html#key-results","title":"C\u00e1c k\u1ebft qu\u1ea3 ch\u00ednh","text":"<p>\u0110\u1ec3 cung c\u1ea5p m\u1ed9t s\u1ed1 \u0111\u1ed9ng l\u1ef1c cho vi\u1ec7c nghi\u00ean c\u1ee9u s\u00e2u h\u01a1n v\u1ec1 li\u00ean ph\u00e2n s\u1ed1, ch\u00fang t\u00f4i \u0111\u01b0a ra m\u1ed9t s\u1ed1 s\u1ef1 th\u1eadt ch\u00ednh ngay b\u00e2y gi\u1edd.</p> C\u00f4ng th\u1ee9c truy h\u1ed3i <p>\u0110\u1ed1i v\u1edbi c\u00e1c gi\u1ea3n ph\u00e2n $r_k = \\frac{p_k}{q_k}$, c\u00f4ng th\u1ee9c truy h\u1ed3i sau \u0111\u00e2y \u0111\u01b0\u1ee3c \u00e1p d\u1ee5ng, cho ph\u00e9p t\u00ednh to\u00e1n nhanh ch\u00f3ng:</p> $$\\frac{p_k}{q_k}=\\frac{a_k p_{k-1} + p_{k-2}}{a_k q_{k-1} + q_{k-2}},$$ <p>trong \u0111\u00f3 $\\frac{p_{-1}}{q_{-1}}=\\frac{1}{0}$ v\u00e0 $\\frac{p_{-2}}{q_{-2}}=\\frac{0}{1}$.</p> \u0110\u1ed9 l\u1ec7ch <p>\u0110\u1ed9 l\u1ec7ch c\u1ee7a $r_k = \\frac{p_k}{q_k}$ so v\u1edbi $r$ c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c \u01b0\u1edbc t\u00ednh chung l\u00e0</p> $$\\left|\\frac{p_k}{q_k}-r\\right| \\leq \\frac{1}{q_k q_{k+1}} \\leq \\frac{1}{q_k^2}.$$ <p>Nh\u00e2n c\u1ea3 hai v\u1ebf v\u1edbi $q_k$, ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c \u01b0\u1edbc t\u00ednh thay th\u1ebf:</p> $$|p_k - q_k r| \\leq \\frac{1}{q_{k+1}}.$$ <p>T\u1eeb c\u00f4ng th\u1ee9c truy h\u1ed3i \u1edf tr\u00ean suy ra r\u1eb1ng $q_k$ t\u0103ng nhanh \u00edt nh\u1ea5t nh\u01b0 s\u1ed1 Fibonacci.</p> <p>Trong h\u00ecnh d\u01b0\u1edbi \u0111\u00e2y b\u1ea1n c\u00f3 th\u1ec3 th\u1ea5y tr\u1ef1c quan h\u00f3a c\u00e1ch c\u00e1c gi\u1ea3n ph\u00e2n $r_k$ ti\u1ebfn t\u1edbi $r=\\frac{1+\\sqrt 5}{2}$:</p> <p></p> <p>$r=\\frac{1+\\sqrt 5}{2}$ \u0111\u01b0\u1ee3c bi\u1ec3u th\u1ecb b\u1eb1ng \u0111\u01b0\u1eddng ch\u1ea5m xanh. C\u00e1c gi\u1ea3n ph\u00e2n l\u1ebb ti\u1ebfn t\u1edbi n\u00f3 t\u1eeb ph\u00eda tr\u00ean v\u00e0 c\u00e1c gi\u1ea3n ph\u00e2n ch\u1eb5n ti\u1ebfn t\u1edbi n\u00f3 t\u1eeb ph\u00eda d\u01b0\u1edbi.</p> Bao l\u1ed3i l\u01b0\u1edbi <p>Xem x\u00e9t c\u00e1c bao l\u1ed3i c\u1ee7a c\u00e1c \u0111i\u1ec3m n\u1eb1m tr\u00ean v\u00e0 d\u01b0\u1edbi \u0111\u01b0\u1eddng th\u1eb3ng $y=rx$.</p> <p>C\u00e1c gi\u1ea3n ph\u00e2n l\u1ebb $(q_k;p_k)$ l\u00e0 c\u00e1c \u0111\u1ec9nh c\u1ee7a bao l\u1ed3i tr\u00ean, trong khi c\u00e1c gi\u1ea3n ph\u00e2n ch\u1eb5n $(q_k;p_k)$ l\u00e0 c\u00e1c \u0111\u1ec9nh c\u1ee7a bao l\u1ed3i d\u01b0\u1edbi.</p> <p>T\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh nguy\u00ean tr\u00ean c\u00e1c bao l\u1ed3i thu \u0111\u01b0\u1ee3c l\u00e0 $(q;p)$ sao cho</p> $$\\frac{p}{q} = \\frac{tp_{k-1} + p_{k-2}}{tq_{k-1} + q_{k-2}}$$ <p>\u0111\u1ed1i v\u1edbi s\u1ed1 nguy\u00ean $0 \\leq t \\leq a_k$. N\u00f3i c\u00e1ch kh\u00e1c, t\u1eadp h\u1ee3p c\u00e1c \u0111i\u1ec3m l\u01b0\u1edbi tr\u00ean c\u00e1c bao l\u1ed3i t\u01b0\u01a1ng \u1ee9ng v\u1edbi t\u1eadp h\u1ee3p c\u00e1c b\u00e1n gi\u1ea3n ph\u00e2n.</p> <p>Trong h\u00ecnh d\u01b0\u1edbi \u0111\u00e2y, b\u1ea1n c\u00f3 th\u1ec3 th\u1ea5y c\u00e1c gi\u1ea3n ph\u00e2n v\u00e0 b\u00e1n gi\u1ea3n ph\u00e2n (c\u00e1c \u0111i\u1ec3m m\u00e0u x\u00e1m trung gian) c\u1ee7a $r=\\frac{9}{7}$.</p> <p></p> X\u1ea5p x\u1ec9 t\u1ed1t nh\u1ea5t <p>Cho $\\frac{p}{q}$ l\u00e0 ph\u00e2n s\u1ed1 \u0111\u1ec3 t\u1ed1i thi\u1ec3u h\u00f3a $\\left|r-\\frac{p}{q}\\right|$ v\u1edbi \u0111i\u1ec1u ki\u1ec7n $q \\leq x$ cho m\u1ed9t s\u1ed1 $x$.</p> <p>Khi \u0111\u00f3 $\\frac{p}{q}$ l\u00e0 m\u1ed9t b\u00e1n gi\u1ea3n ph\u00e2n c\u1ee7a $r$.</p> <p>S\u1ef1 th\u1eadt cu\u1ed1i c\u00f9ng cho ph\u00e9p t\u00ecm c\u00e1c x\u1ea5p x\u1ec9 h\u1eefu t\u1ef7 t\u1ed1t nh\u1ea5t c\u1ee7a $r$ b\u1eb1ng c\u00e1ch ki\u1ec3m tra c\u00e1c b\u00e1n gi\u1ea3n ph\u00e2n c\u1ee7a n\u00f3.</p> <p>D\u01b0\u1edbi \u0111\u00e2y b\u1ea1n s\u1ebd t\u00ecm th\u1ea5y gi\u1ea3i th\u00edch th\u00eam v\u00e0 m\u1ed9t ch\u00fat tr\u1ef1c gi\u00e1c c\u0169ng nh\u01b0 c\u00e1ch gi\u1ea3i th\u00edch cho nh\u1eefng s\u1ef1 th\u1eadt n\u00e0y.</p>","tags":["Original"]},{"location":"algebra/continued-fractions.html#convergents","title":"Gi\u1ea3n ph\u00e2n (Convergents)","text":"<p>H\u00e3y xem x\u00e9t k\u1ef9 h\u01a1n c\u00e1c gi\u1ea3n ph\u00e2n \u0111\u00e3 \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a tr\u01b0\u1edbc \u0111\u00f3. \u0110\u1ed1i v\u1edbi $r=[a_0, a_1, a_2, \\dots]$, c\u00e1c gi\u1ea3n ph\u00e2n c\u1ee7a n\u00f3 l\u00e0</p> $$\\begin{gather} r_0=[a_0],\\\\r_1=[a_0, a_1],\\\\ \\dots,\\\\ r_k=[a_0, a_1, \\dots, a_k]. \\end{gather}$$ <p>Gi\u1ea3n ph\u00e2n l\u00e0 kh\u00e1i ni\u1ec7m c\u1ed1t l\u00f5i c\u1ee7a li\u00ean ph\u00e2n s\u1ed1, v\u00ec v\u1eady vi\u1ec7c nghi\u00ean c\u1ee9u c\u00e1c t\u00ednh ch\u1ea5t c\u1ee7a ch\u00fang l\u00e0 r\u1ea5t quan tr\u1ecdng.</p> <p>\u0110\u1ed1i v\u1edbi s\u1ed1 $r$, gi\u1ea3n ph\u00e2n th\u1ee9 $k$ c\u1ee7a n\u00f3 $r_k = \\frac{p_k}{q_k}$ c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ednh nh\u01b0 sau</p> $$r_k = \\frac{P_k(a_0,a_1,\\dots,a_k)}{P_{k-1}(a_1,\\dots,a_k)} = \\frac{a_k p_{k-1} + p_{k-2}}{a_k q_{k-1} + q_{k-2}},$$ <p>trong \u0111\u00f3 $P_k(a_0,\\dots,a_k)$ l\u00e0 continuant, m\u1ed9t \u0111a th\u1ee9c nhi\u1ec1u bi\u1ebfn \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a l\u00e0</p> $$P_k(x_0,x_1,\\dots,x_k) = \\det \\begin{bmatrix} x_k &amp; 1 &amp; 0 &amp; \\dots &amp; 0 \\\\ -1 &amp; x_{k-1} &amp; 1 &amp; \\dots &amp; 0 \\\\ 0 &amp; -1 &amp; x_2 &amp; . &amp; \\vdots \\\\ \\vdots &amp; \\vdots &amp; . &amp; \\ddots &amp; 1 \\\\ 0 &amp; 0 &amp; \\dots &amp; -1 &amp; x_0 \\end{bmatrix}_{\\textstyle .}$$ <p>Do \u0111\u00f3, $r_k$ l\u00e0 m\u1ed9t mediant c\u00f3 tr\u1ecdng s\u1ed1 c\u1ee7a $r_{k-1}$ v\u00e0 $r_{k-2}$.</p> <p>\u0110\u1ec3 nh\u1ea5t qu\u00e1n, hai gi\u1ea3n ph\u00e2n b\u1ed5 sung $r_{-1} = \\frac{1}{0}$ v\u00e0 $r_{-2} = \\frac{0}{1}$ \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a.</p> Gi\u1ea3i th\u00edch chi ti\u1ebft <p>T\u1eed s\u1ed1 v\u00e0 m\u1eabu s\u1ed1 c\u1ee7a $r_k$ c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c xem nh\u01b0 c\u00e1c \u0111a th\u1ee9c nhi\u1ec1u bi\u1ebfn c\u1ee7a $a_0, a_1, \\dots, a_k$:</p> $$r_k = \\frac{P_k(a_0, a_1, \\dots, a_k)}{Q_k(a_0,a_1, \\dots, a_k)}.$$ <p>T\u1eeb \u0111\u1ecbnh ngh\u0129a c\u1ee7a c\u00e1c gi\u1ea3n ph\u00e2n,</p> $$r_k = a_0 + \\frac{1}{[a_1;a_2,\\dots, a_k]}= a_0 + \\frac{Q_{k-1}(a_1, \\dots, a_k)}{P_{k-1}(a_1, \\dots, a_k)} = \\frac{a_0 P_{k-1}(a_1, \\dots, a_k) + Q_{k-1}(a_1, \\dots, a_k)}{P_{k-1}(a_1, \\dots, a_k)}.$$ <p>T\u1eeb \u0111i\u1ec1u n\u00e0y suy ra $Q_k(a_0, \\dots, a_k) = P_{k-1}(a_1, \\dots, a_k)$. \u0110i\u1ec1u n\u00e0y mang l\u1ea1i m\u1ed1i quan h\u1ec7</p> $$P_k(a_0, \\dots, a_k) = a_0 P_{k-1}(a_1, \\dots, a_k) + P_{k-2}(a_2, \\dots, a_k).$$ <p>Ban \u0111\u1ea7u, $r_0 = \\frac{a_0}{1}$ v\u00e0 $r_1 = \\frac{a_0 a_1 + 1}{a_1}$, do \u0111\u00f3</p> $$\\begin{align}P_0(a_0)&amp;=a_0,\\\\ P_1(a_0, a_1) &amp;= a_0 a_1 + 1.\\end{align}$$ <p>\u0110\u1ec3 nh\u1ea5t qu\u00e1n, thu\u1eadn ti\u1ec7n khi \u0111\u1ecbnh ngh\u0129a $P_{-1} = 1$ v\u00e0 $P_{-2}=0$ v\u00e0 n\u00f3i m\u1ed9t c\u00e1ch h\u00ecnh th\u1ee9c r\u1eb1ng $r_{-1} = \\frac{1}{0}$ v\u00e0 $r_{-2}=\\frac{0}{1}$.</p> <p>T\u1eeb gi\u1ea3i t\u00edch s\u1ed1, ng\u01b0\u1eddi ta bi\u1ebft r\u1eb1ng \u0111\u1ecbnh th\u1ee9c c\u1ee7a m\u1ed9t ma tr\u1eadn ba \u0111\u01b0\u1eddng ch\u00e9o t\u00f9y \u00fd</p> $$T_k = \\det \\begin{bmatrix} a_0 &amp; b_0 &amp; 0 &amp; \\dots &amp; 0 \\\\ c_0 &amp; a_1 &amp; b_1 &amp; \\dots &amp; 0 \\\\ 0 &amp; c_1 &amp; a_2 &amp; . &amp; \\vdots \\\\ \\vdots &amp; \\vdots &amp; . &amp; \\ddots &amp; c_{k-1} \\\\ 0 &amp; 0 &amp; \\dots &amp; b_{k-1} &amp; a_k \\end{bmatrix}$$ <p>c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n \u0111\u1ec7 quy l\u00e0 $T_k = a_k T_{k-1} - b_{k-1} c_{k-1} T_{k-2}$. So s\u00e1nh n\u00f3 v\u1edbi $P_k$, ch\u00fang ta c\u00f3 m\u1ed9t bi\u1ec3u th\u1ee9c tr\u1ef1c ti\u1ebfp</p> $$P_k = \\det \\begin{bmatrix} x_k &amp; 1 &amp; 0 &amp; \\dots &amp; 0 \\\\ -1 &amp; x_{k-1} &amp; 1 &amp; \\dots &amp; 0 \\\\ 0 &amp; -1 &amp; x_2 &amp; . &amp; \\vdots \\\\ \\vdots &amp; \\vdots &amp; . &amp; \\ddots &amp; 1 \\\\ 0 &amp; 0 &amp; \\dots &amp; -1 &amp; x_0 \\end{bmatrix}_{\\textstyle .}$$ <p>\u0110a th\u1ee9c n\u00e0y c\u00f2n \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 continuant do m\u1ed1i quan h\u1ec7 ch\u1eb7t ch\u1ebd c\u1ee7a n\u00f3 v\u1edbi li\u00ean ph\u00e2n s\u1ed1. Continuant s\u1ebd kh\u00f4ng thay \u0111\u1ed5i n\u1ebfu tr\u00ecnh t\u1ef1 tr\u00ean \u0111\u01b0\u1eddng ch\u00e9o ch\u00ednh b\u1ecb \u0111\u1ea3o ng\u01b0\u1ee3c. \u0110i\u1ec1u n\u00e0y mang l\u1ea1i m\u1ed9t c\u00f4ng th\u1ee9c thay th\u1ebf \u0111\u1ec3 t\u00ednh to\u00e1n n\u00f3:</p> $$P_k(a_0, \\dots, a_k) = a_k P_{k-1}(a_0, \\dots, a_{k-1}) + P_{k-2}(a_0, \\dots, a_{k-2}).$$","tags":["Original"]},{"location":"algebra/continued-fractions.html#implementation-1","title":"C\u00e0i \u0111\u1eb7t","text":"<p>Ch\u00fang ta s\u1ebd t\u00ednh to\u00e1n c\u00e1c gi\u1ea3n ph\u00e2n d\u01b0\u1edbi d\u1ea1ng m\u1ed9t c\u1eb7p c\u00e1c d\u00e3y $p_{-2}, p_{-1}, p_0, p_1, \\dots, p_k$ v\u00e0 $q_{-2}, q_{-1}, q_0, q_1, \\dots, q_k$:</p> C++Python <pre><code>auto convergents(vector&lt;int&gt; a) {\n    vector&lt;int&gt; p = {0, 1};\n    vector&lt;int&gt; q = {1, 0};\n    for(auto it: a) {\n        p.push_back(p[p.size() - 1] * it + p[p.size() - 2]);\n        q.push_back(q[q.size() - 1] * it + q[q.size() - 2]);\n    }\n    return make_pair(p, q);\n}\n</code></pre> <pre><code>def convergents(a):\n    p = [0, 1]\n    q = [1, 0]\n    for it in a:\n        p.append(p[-1]*it + p[-2])\n        q.append(q[-1]*it + q[-2])\n    return p, q\n</code></pre>","tags":["Original"]},{"location":"algebra/continued-fractions.html#trees-of-continued-fractions","title":"C\u00e2y li\u00ean ph\u00e2n s\u1ed1 (Trees of continued fractions)","text":"<p>C\u00f3 hai c\u00e1ch ch\u00ednh \u0111\u1ec3 h\u1ee3p nh\u1ea5t t\u1ea5t c\u1ea3 c\u00e1c li\u00ean ph\u00e2n s\u1ed1 c\u00f3 th\u1ec3 th\u00e0nh c\u00e1c c\u1ea5u tr\u00fac c\u00e2y h\u1eefu \u00edch.</p>","tags":["Original"]},{"location":"algebra/continued-fractions.html#stern-brocot-tree","title":"C\u00e2y Stern-Brocot (Stern-Brocot tree)","text":"<p>C\u00e2y Stern-Brocot l\u00e0 m\u1ed9t c\u00e2y t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n ch\u1ee9a t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 h\u1eefu t\u1ef7 d\u01b0\u01a1ng ph\u00e2n bi\u1ec7t.</p> <p>C\u00e2y th\u01b0\u1eddng tr\u00f4ng nh\u01b0 sau:</p> H\u00ecnh \u1ea3nh b\u1edfi Aaron Rotenberg \u0111\u01b0\u1ee3c c\u1ea5p ph\u00e9p theo CC BY-SA 3.0 <p>C\u00e1c ph\u00e2n s\u1ed1 $\\frac{0}{1}$ v\u00e0 $\\frac{1}{0}$ \u0111\u01b0\u1ee3c gi\u1eef \"\u1ea3o\" \u1edf ph\u00eda b\u00ean tr\u00e1i v\u00e0 b\u00ean ph\u1ea3i c\u1ee7a c\u00e2y t\u01b0\u01a1ng \u1ee9ng.</p> <p>Khi \u0111\u00f3 ph\u00e2n s\u1ed1 trong m\u1ed9t n\u00fat l\u00e0 mediant $\\frac{a+c}{b+d}$ c\u1ee7a hai ph\u00e2n s\u1ed1 $\\frac{a}{b}$ v\u00e0 $\\frac{c}{d}$ ph\u00eda tr\u00ean n\u00f3.</p> <p>C\u00f4ng th\u1ee9c truy h\u1ed3i $\\frac{p_k}{q_k}=\\frac{a_k p_{k-1} + p_{k-2}}{a_k q_{k-1} + q_{k-2}}$ c\u00f3 ngh\u0129a l\u00e0 bi\u1ec3u di\u1ec5n li\u00ean ph\u00e2n s\u1ed1 m\u00e3 h\u00f3a \u0111\u01b0\u1eddng d\u1eabn \u0111i \u0111\u1ebfn $\\frac{p_k}{q_k}$ trong c\u00e2y. \u0110\u1ec3 t\u00ecm $[a_0; a_1, \\dots, a_{k}, 1]$, ng\u01b0\u1eddi ta ph\u1ea3i th\u1ef1c hi\u1ec7n $a_0$ b\u01b0\u1edbc sang ph\u1ea3i, $a_1$ b\u01b0\u1edbc sang tr\u00e1i, $a_2$ b\u01b0\u1edbc sang ph\u1ea3i v\u00e2n v\u00e2n cho \u0111\u1ebfn $a_k$.</p> <p>Cha c\u1ee7a $[a_0; a_1, \\dots, a_k,1]$ khi \u0111\u00f3 l\u00e0 ph\u00e2n s\u1ed1 thu \u0111\u01b0\u1ee3c b\u1eb1ng c\u00e1ch l\u00f9i l\u1ea1i m\u1ed9t b\u01b0\u1edbc theo h\u01b0\u1edbng cu\u1ed1i c\u00f9ng \u0111\u00e3 s\u1eed d\u1ee5ng.</p> <p>N\u00f3i c\u00e1ch kh\u00e1c, \u0111\u00f3 l\u00e0 $[a_0; a_1, \\dots, a_k-1,1]$ khi $a_k &gt; 1$ v\u00e0 $[a_0; a_1, \\dots, a_{k-1}, 1]$ khi $a_k = 1$.</p> <p>Do \u0111\u00f3, c\u00e1c con c\u1ee7a $[a_0; a_1, \\dots, a_k, 1]$ l\u00e0 $[a_0; a_1, \\dots, a_k+1, 1]$ v\u00e0 $[a_0; a_1, \\dots, a_k, 1, 1]$.</p> <p>H\u00e3y \u0111\u00e1nh ch\u1ec9 s\u1ed1 c\u00e2y Stern-Brocot. \u0110\u1ec9nh g\u1ed1c \u0111\u01b0\u1ee3c g\u00e1n ch\u1ec9 s\u1ed1 $1$. Sau \u0111\u00f3 \u0111\u1ed1i v\u1edbi m\u1ed9t \u0111\u1ec9nh $v$, ch\u1ec9 s\u1ed1 c\u1ee7a con b\u00ean tr\u00e1i \u0111\u01b0\u1ee3c g\u00e1n b\u1eb1ng c\u00e1ch thay \u0111\u1ed5i bit d\u1eabn \u0111\u1ea7u c\u1ee7a $v$ t\u1eeb $1$ th\u00e0nh $10$ v\u00e0 \u0111\u1ed1i v\u1edbi con b\u00ean ph\u1ea3i, n\u00f3 \u0111\u01b0\u1ee3c g\u00e1n b\u1eb1ng c\u00e1ch thay \u0111\u1ed5i bit d\u1eabn \u0111\u1ea7u t\u1eeb $1$ th\u00e0nh $11$:</p> <p>Trong c\u00e1ch \u0111\u00e1nh ch\u1ec9 s\u1ed1 n\u00e0y, bi\u1ec3u di\u1ec5n li\u00ean ph\u00e2n s\u1ed1 c\u1ee7a m\u1ed9t s\u1ed1 h\u1eefu t\u1ef7 ch\u1ec9 \u0111\u1ecbnh m\u00e3 h\u00f3a \u0111\u1ed9 d\u00e0i ch\u1ea1y (run-length encoding) c\u1ee7a ch\u1ec9 s\u1ed1 nh\u1ecb ph\u00e2n c\u1ee7a n\u00f3.</p> <p>\u0110\u1ed1i v\u1edbi $\\frac{5}{2} = [2;2] = [2;1,1]$, ch\u1ec9 s\u1ed1 c\u1ee7a n\u00f3 l\u00e0 $1011_2$ v\u00e0 m\u00e3 h\u00f3a \u0111\u1ed9 d\u00e0i ch\u1ea1y c\u1ee7a n\u00f3, x\u00e9t c\u00e1c bit theo th\u1ee9 t\u1ef1 t\u0103ng d\u1ea7n, l\u00e0 $[2;1,1]$.</p> <p>M\u1ed9t v\u00ed d\u1ee5 kh\u00e1c l\u00e0 $\\frac{2}{5} = [0;2,2]=[0;2,1,1]$, c\u00f3 ch\u1ec9 s\u1ed1 $1100_2$ v\u00e0 m\u00e3 h\u00f3a \u0111\u1ed9 d\u00e0i ch\u1ea1y c\u1ee7a n\u00f3, qu\u1ea3 th\u1ef1c, l\u00e0 $[0;2,2]$.</p> <p>\u0110\u00e1ng ch\u00fa \u00fd l\u00e0 c\u00e2y Stern-Brocot, tr\u00ean th\u1ef1c t\u1ebf, l\u00e0 m\u1ed9t treap. Ngh\u0129a l\u00e0, n\u00f3 l\u00e0 m\u1ed9t c\u00e2y t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n theo $\\frac{p}{q}$, nh\u01b0ng n\u00f3 l\u00e0 m\u1ed9t heap theo c\u1ea3 $p$ v\u00e0 $q$.</p> <p>So s\u00e1nh c\u00e1c li\u00ean ph\u00e2n s\u1ed1</p> <p>B\u1ea1n \u0111\u01b0\u1ee3c cho $A=[a_0; a_1, \\dots, a_n]$ v\u00e0 $B=[b_0; b_1, \\dots, b_m]$. Ph\u00e2n s\u1ed1 n\u00e0o nh\u1ecf h\u01a1n?</p> L\u1eddi gi\u1ea3i <p>Gi\u1ea3 s\u1eed r\u1eb1ng $A$ v\u00e0 $B$ l\u00e0 s\u1ed1 v\u00f4 t\u1ef7 v\u00e0 bi\u1ec3u di\u1ec5n li\u00ean ph\u00e2n s\u1ed1 c\u1ee7a ch\u00fang bi\u1ec3u th\u1ecb m\u1ed9t s\u1ef1 \u0111i xu\u1ed1ng v\u00f4 t\u1eadn trong c\u00e2y Stern-Brocot.</p> <p>Nh\u01b0 ch\u00fang ta \u0111\u00e3 \u0111\u1ec1 c\u1eadp, trong bi\u1ec3u di\u1ec5n n\u00e0y $a_0$ bi\u1ec3u th\u1ecb s\u1ed1 l\u1ea7n r\u1ebd ph\u1ea3i trong qu\u00e1 tr\u00ecnh \u0111i xu\u1ed1ng, $a_1$ bi\u1ec3u th\u1ecb s\u1ed1 l\u1ea7n r\u1ebd tr\u00e1i ti\u1ebfp theo, v.v. Do \u0111\u00f3, khi ch\u00fang ta so s\u00e1nh $a_k$ v\u00e0 $b_k$, n\u1ebfu $a_k = b_k$ ch\u00fang ta ch\u1ec9 n\u00ean chuy\u1ec3n sang so s\u00e1nh $a_{k+1}$ v\u00e0 $b_{k+1}$. Ng\u01b0\u1ee3c l\u1ea1i, n\u1ebfu ch\u00fang ta \u0111ang \u1edf c\u00e1c l\u1ea7n r\u1ebd ph\u1ea3i, ch\u00fang ta n\u00ean ki\u1ec3m tra xem $a_k &lt; b_k$ v\u00e0 n\u1ebfu ch\u00fang ta \u0111ang \u1edf c\u00e1c l\u1ea7n r\u1ebd tr\u00e1i, ch\u00fang ta n\u00ean ki\u1ec3m tra xem $a_k &gt; b_k$ \u0111\u1ec3 bi\u1ebft li\u1ec7u $A &lt; B$.</p> <p>N\u00f3i c\u00e1ch kh\u00e1c, \u0111\u1ed1i v\u1edbi $A$ v\u00e0 $B$ v\u00f4 t\u1ef7, $A &lt; B$ khi v\u00e0 ch\u1ec9 khi $(a_0, -a_1, a_2, -a_3, \\dots) &lt; (b_0, -b_1, b_2, -b_3, \\dots)$ v\u1edbi so s\u00e1nh t\u1eeb \u0111i\u1ec3n.</p> <p>B\u00e2y gi\u1edd, s\u1eed d\u1ee5ng $\\infty$ m\u1ed9t c\u00e1ch h\u00ecnh th\u1ee9c nh\u01b0 m\u1ed9t ph\u1ea7n t\u1eed c\u1ee7a bi\u1ec3u di\u1ec5n li\u00ean ph\u00e2n s\u1ed1, c\u00f3 th\u1ec3 m\u00f4 ph\u1ecfng c\u00e1c s\u1ed1 v\u00f4 t\u1ef7 $A-\\varepsilon$ v\u00e0 $A+\\varepsilon$, ngh\u0129a l\u00e0, c\u00e1c ph\u1ea7n t\u1eed nh\u1ecf h\u01a1n (l\u1edbn h\u01a1n) $A$, nh\u01b0ng l\u1edbn h\u01a1n (nh\u1ecf h\u01a1n) b\u1ea5t k\u1ef3 s\u1ed1 th\u1ef1c n\u00e0o kh\u00e1c. C\u1ee5 th\u1ec3, \u0111\u1ed1i v\u1edbi $A=[a_0; a_1, \\dots, a_n]$, m\u1ed9t trong hai ph\u1ea7n t\u1eed n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c m\u00f4 ph\u1ecfng l\u00e0 $[a_0; a_1, \\dots, a_n, \\infty]$ v\u00e0 ph\u1ea7n t\u1eed kia c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c m\u00f4 ph\u1ecfng l\u00e0 $[a_0; a_1, \\dots, a_n - 1, 1, \\infty]$.</p> <p>C\u00e1i n\u00e0o t\u01b0\u01a1ng \u1ee9ng v\u1edbi $A-\\varepsilon$ v\u00e0 c\u00e1i n\u00e0o v\u1edbi $A+\\varepsilon$ c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh b\u1edfi t\u00ednh ch\u1eb5n l\u1ebb c\u1ee7a $n$ ho\u1eb7c b\u1eb1ng c\u00e1ch so s\u00e1nh ch\u00fang nh\u01b0 c\u00e1c s\u1ed1 v\u00f4 t\u1ef7.</p> Python <pre><code># check if a &lt; b assuming that a[-1] = b[-1] = infty and a != b\ndef less(a, b):\n    a = [(-1)**i*a[i] for i in range(len(a))]\n    b = [(-1)**i*b[i] for i in range(len(b))]\n    return a &lt; b\n\n# [a0; a1, ..., ak] -&gt; [a0, a1, ..., ak-1, 1]\ndef expand(a):\n    if a: # empty a = inf\n        a[-1] -= 1\n        a.append(1)\n    return a\n\n# return a-eps, a+eps\ndef pm_eps(a):\n    b = expand(a.copy())\n    a.append(float('inf'))\n    b.append(float('inf'))\n    return (a, b) if less(a, b) else (b, a)\n</code></pre> <p>\u0110i\u1ec3m trong t\u1ed1t nh\u1ea5t</p> <p>B\u1ea1n \u0111\u01b0\u1ee3c cho $\\frac{0}{1} \\leq \\frac{p_0}{q_0} &lt; \\frac{p_1}{q_1} \\leq \\frac{1}{0}$. T\u00ecm s\u1ed1 h\u1eefu t\u1ef7 $\\frac{p}{q}$ sao cho $(q; p)$ nh\u1ecf nh\u1ea5t theo th\u1ee9 t\u1ef1 t\u1eeb \u0111i\u1ec3n v\u00e0 $\\frac{p_0}{q_0} &lt; \\frac{p}{q} &lt; \\frac{p_1}{q_1}$.</p> L\u1eddi gi\u1ea3i <p>V\u1ec1 m\u1eb7t c\u00e2y Stern-Brocot, \u0111i\u1ec1u \u0111\u00f3 c\u00f3 ngh\u0129a l\u00e0 ch\u00fang ta c\u1ea7n t\u00ecm LCA c\u1ee7a $\\frac{p_0}{q_0}$ v\u00e0 $\\frac{p_1}{q_1}$. Do m\u1ed1i li\u00ean h\u1ec7 gi\u1eefa c\u00e2y Stern-Brocot v\u00e0 li\u00ean ph\u00e2n s\u1ed1, LCA n\u00e0y s\u1ebd t\u01b0\u01a1ng \u1ee9ng \u0111\u1ea1i kh\u00e1i v\u1edbi ti\u1ec1n t\u1ed1 chung l\u1edbn nh\u1ea5t c\u1ee7a c\u00e1c bi\u1ec3u di\u1ec5n li\u00ean ph\u00e2n s\u1ed1 cho $\\frac{p_0}{q_0}$ v\u00e0 $\\frac{p_1}{q_1}$.</p> <p>V\u00ec v\u1eady, n\u1ebfu $\\frac{p_0}{q_0} = [a_0; a_1, \\dots, a_{k-1}, a_k, \\dots]$ v\u00e0 $\\frac{p_1}{q_1} = [a_0; a_1, \\dots, a_{k-1}, b_k, \\dots]$ l\u00e0 c\u00e1c s\u1ed1 v\u00f4 t\u1ef7, LCA l\u00e0 $[a_0; a_1, \\dots, \\min(a_k, b_k)+1]$.</p> <p>\u0110\u1ed1i v\u1edbi $r_0$ v\u00e0 $r_1$ h\u1eefu t\u1ef7, m\u1ed9t trong s\u1ed1 ch\u00fang c\u00f3 th\u1ec3 ch\u00ednh l\u00e0 LCA, \u0111i\u1ec1u n\u00e0y \u0111\u00f2i h\u1ecfi ch\u00fang ta ph\u1ea3i x\u00e9t tr\u01b0\u1eddng h\u1ee3p. \u0110\u1ec3 \u0111\u01a1n gi\u1ea3n h\u00f3a l\u1eddi gi\u1ea3i cho $r_0$ v\u00e0 $r_1$ h\u1eefu t\u1ef7, c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng bi\u1ec3u di\u1ec5n li\u00ean ph\u00e2n s\u1ed1 c\u1ee7a $r_0 + \\varepsilon$ v\u00e0 $r_1 - \\varepsilon$ \u0111\u00e3 \u0111\u01b0\u1ee3c r\u00fat ra trong b\u00e0i to\u00e1n tr\u01b0\u1edbc.</p> Python <pre><code># finds lexicographically smallest (q, p)\n# such that p0/q0 &lt; p/q &lt; p1/q1\ndef middle(p0, q0, p1, q1):\n    a0 = pm_eps(fraction(p0, q0))[1]\n    a1 = pm_eps(fraction(p1, q1))[0]\n    a = []\n    for i in range(min(len(a0), len(a1))):\n        a.append(min(a0[i], a1[i]))\n        if a0[i] != a1[i]:\n            break\n    a[-1] += 1\n    p, q = convergents(a)\n    return p[-1], q[-1]\n</code></pre> <p>GCJ 2019, Round 2 - New Elements: Part 2</p> <p>B\u1ea1n \u0111\u01b0\u1ee3c cho $N$ c\u1eb7p s\u1ed1 nguy\u00ean d\u01b0\u01a1ng $(C_i, J_i)$. B\u1ea1n c\u1ea7n t\u00ecm m\u1ed9t c\u1eb7p s\u1ed1 nguy\u00ean d\u01b0\u01a1ng $(x, y)$ sao cho $C_i x + J_i y$ l\u00e0 m\u1ed9t d\u00e3y t\u0103ng nghi\u00eam ng\u1eb7t.</p> <p>Trong s\u1ed1 c\u00e1c c\u1eb7p nh\u01b0 v\u1eady, h\u00e3y t\u00ecm c\u1eb7p nh\u1ecf nh\u1ea5t theo th\u1ee9 t\u1ef1 t\u1eeb \u0111i\u1ec3n.</p> L\u1eddi gi\u1ea3i <p>Di\u1ec5n gi\u1ea3i l\u1ea1i \u0111\u1ec1 b\u00e0i, $A_i x + B_i y$ ph\u1ea3i d\u01b0\u01a1ng v\u1edbi m\u1ecdi $i$, trong \u0111\u00f3 $A_i = C_i - C_{i-1}$ v\u00e0 $B_i = J_i - J_{i-1}$.</p> <p>Trong s\u1ed1 c\u00e1c ph\u01b0\u01a1ng tr\u00ecnh nh\u01b0 v\u1eady, ch\u00fang ta c\u00f3 b\u1ed1n nh\u00f3m quan tr\u1ecdng cho $A_i x + B_i y &gt; 0$:</p> <ol> <li>$A_i, B_i &gt; 0$ c\u00f3 th\u1ec3 b\u1ecb b\u1ecf qua v\u00ec ch\u00fang ta \u0111ang t\u00ecm ki\u1ebfm $x, y &gt; 0$.</li> <li>$A_i, B_i \\leq 0$ s\u1ebd cung c\u1ea5p \"IMPOSSIBLE\" nh\u01b0 m\u1ed9t c\u00e2u tr\u1ea3 l\u1eddi.</li> <li>$A_i &gt; 0$, $B_i \\leq 0$. C\u00e1c r\u00e0ng bu\u1ed9c nh\u01b0 v\u1eady t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi $\\frac{y}{x} &lt; \\frac{A_i}{-B_i}$.</li> <li>$A_i \\leq 0$, $B_i &gt; 0$. C\u00e1c r\u00e0ng bu\u1ed9c nh\u01b0 v\u1eady t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi $\\frac{y}{x} &gt; \\frac{-A_i}{B_i}$.</li> </ol> <p>G\u1ecdi $\\frac{p_0}{q_0}$ l\u00e0 $\\frac{-A_i}{B_i}$ l\u1edbn nh\u1ea5t t\u1eeb nh\u00f3m th\u1ee9 t\u01b0 v\u00e0 $\\frac{p_1}{q_1}$ l\u00e0 $\\frac{A_i}{-B_i}$ nh\u1ecf nh\u1ea5t t\u1eeb nh\u00f3m th\u1ee9 ba.</p> <p>B\u00e0i to\u00e1n b\u00e2y gi\u1edd l\u00e0, cho $\\frac{p_0}{q_0} &lt; \\frac{p_1}{q_1}$, t\u00ecm m\u1ed9t ph\u00e2n s\u1ed1 $\\frac{p}{q}$ sao cho $(q;p)$ nh\u1ecf nh\u1ea5t theo th\u1ee9 t\u1ef1 t\u1eeb \u0111i\u1ec3n v\u00e0 $\\frac{p_0}{q_0} &lt; \\frac{p}{q} &lt; \\frac{p_1}{q_1}$.</p> Python <pre><code>    def solve():\n    n = int(input())\n    C = [0] * n\n    J = [0] * n\n    # p0/q0 &lt; y/x &lt; p1/q1\n    p0, q0 = 0, 1\n    p1, q1 = 1, 0\n    fail = False\n    for i in range(n):\n        C[i], J[i] = map(int, input().split())\n        if i &gt; 0:\n            A = C[i] - C[i-1]\n            B = J[i] - J[i-1]\n            if A &lt;= 0 and B &lt;= 0:\n                fail = True\n            elif B &gt; 0 and A &lt; 0: # y/x &gt; (-A)/B if B &gt; 0\n                if (-A)*q0 &gt; p0*B:\n                    p0, q0 = -A, B\n            elif B &lt; 0 and A &gt; 0: # y/x &lt; A/(-B) if B &lt; 0\n                if A*q1 &lt; p1*(-B):\n                    p1, q1 = A, -B\n    if p0*q1 &gt;= p1*q0 or fail:\n        return 'IMPOSSIBLE'\n\n    p, q = middle(p0, q0, p1, q1)\n    return str(q) + ' ' + str(p)\n</code></pre>","tags":["Original"]},{"location":"algebra/continued-fractions.html#calkin-wilf-tree","title":"C\u00e2y Calkin-Wilf (Calkin-Wilf tree)","text":"<p>M\u1ed9t c\u00e1ch \u0111\u01a1n gi\u1ea3n h\u01a1n \u0111\u1ec3 t\u1ed5 ch\u1ee9c c\u00e1c li\u00ean ph\u00e2n s\u1ed1 trong m\u1ed9t c\u00e2y nh\u1ecb ph\u00e2n l\u00e0 c\u00e2y Calkin-Wilf.</p> <p>C\u00e2y th\u01b0\u1eddng tr\u00f4ng nh\u01b0 sau:</p> H\u00ecnh \u1ea3nh b\u1edfi Olli Niemitalo, Proz \u0111\u01b0\u1ee3c c\u1ea5p ph\u00e9p theo CC0 1.0 <p>\u1ede g\u1ed1c c\u1ee7a c\u00e2y, l\u00e0 s\u1ed1 $\\frac{1}{1}$. Sau \u0111\u00f3, \u0111\u1ed1i v\u1edbi \u0111\u1ec9nh c\u00f3 s\u1ed1 $\\frac{p}{q}$, c\u00e1c con c\u1ee7a n\u00f3 l\u00e0 $\\frac{p}{p+q}$ v\u00e0 $\\frac{p+q}{q}$.</p> <p>Kh\u00f4ng gi\u1ed1ng nh\u01b0 c\u00e2y Stern-Brocot, c\u00e2y Calkin-Wilf kh\u00f4ng ph\u1ea3i l\u00e0 c\u00e2y t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n, v\u00ec v\u1eady n\u00f3 kh\u00f4ng th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 th\u1ef1c hi\u1ec7n t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n h\u1eefu t\u1ef7.</p> <p>Trong c\u00e2y Calkin-Wilf, cha tr\u1ef1c ti\u1ebfp c\u1ee7a m\u1ed9t ph\u00e2n s\u1ed1 $\\frac{p}{q}$ l\u00e0 $\\frac{p-q}{q}$ khi $p&gt;q$ v\u00e0 $\\frac{p}{q-p}$ khi ng\u01b0\u1ee3c l\u1ea1i.</p> <p>\u0110\u1ed1i v\u1edbi c\u00e2y Stern-Brocot, ch\u00fang ta \u0111\u00e3 s\u1eed d\u1ee5ng c\u00f4ng th\u1ee9c truy h\u1ed3i cho c\u00e1c gi\u1ea3n ph\u00e2n. \u0110\u1ec3 v\u1ebd m\u1ed1i li\u00ean h\u1ec7 gi\u1eefa li\u00ean ph\u00e2n s\u1ed1 v\u00e0 c\u00e2y Calkin-Wilf, ch\u00fang ta n\u00ean nh\u1edb l\u1ea1i c\u00f4ng th\u1ee9c truy h\u1ed3i cho c\u00e1c th\u01b0\u01a1ng \u0111\u1ea7y \u0111\u1ee7. N\u1ebfu $s_k = \\frac{p}{q}$, th\u00ec $s_{k+1} = \\frac{q}{p \\mod q} = \\frac{q}{p-\\lfloor p/q \\rfloor \\cdot q}$.</p> <p>M\u1eb7t kh\u00e1c, n\u1ebfu ch\u00fang ta li\u00ean t\u1ee5c \u0111i t\u1eeb $s_k = \\frac{p}{q}$ \u0111\u1ebfn cha c\u1ee7a n\u00f3 trong c\u00e2y Calkin-Wilf khi $p &gt; q$, ch\u00fang ta s\u1ebd k\u1ebft th\u00fac \u1edf $\\frac{p \\mod q}{q} = \\frac{1}{s_{k+1}}$. N\u1ebfu ch\u00fang ta ti\u1ebfp t\u1ee5c l\u00e0m nh\u01b0 v\u1eady, ch\u00fang ta s\u1ebd k\u1ebft th\u00fac \u1edf $s_{k+2}$, sau \u0111\u00f3 l\u00e0 $\\frac{1}{s_{k+3}}$ v\u00e0 c\u1ee9 th\u1ebf. T\u1eeb \u0111i\u1ec1u n\u00e0y ch\u00fang ta c\u00f3 th\u1ec3 suy ra r\u1eb1ng:</p> <ol> <li>Khi $a_0&gt; 0$, cha tr\u1ef1c ti\u1ebfp c\u1ee7a $[a_0; a_1, \\dots, a_k]$ trong c\u00e2y Calkin-Wilf l\u00e0 $\\frac{p-q}{q}=[a_0 - 1; a_1, \\dots, a_k]$.</li> <li>Khi $a_0 = 0$ v\u00e0 $a_1 &gt; 1$, cha tr\u1ef1c ti\u1ebfp c\u1ee7a n\u00f3 l\u00e0 $\\frac{p}{q-p} = [0; a_1 - 1, a_2, \\dots, a_k]$.</li> <li>V\u00e0 khi $a_0 = 0$ v\u00e0 $a_1 = 1$, cha tr\u1ef1c ti\u1ebfp c\u1ee7a n\u00f3 l\u00e0 $\\frac{p}{q-p} = [a_2; a_3, \\dots, a_k]$.</li> </ol> <p>T\u01b0\u01a1ng \u1ee9ng, c\u00e1c con c\u1ee7a $\\frac{p}{q} = [a_0; a_1, \\dots, a_k]$ l\u00e0</p> <ol> <li>$\\frac{p+q}{q}=1+\\frac{p}{q}$, \u0111\u00f3 l\u00e0 $[a_0+1; a_1, \\dots, a_k]$,</li> <li>$\\frac{p}{p+q} = \\frac{1}{1+\\frac{q}{p}}$, \u0111\u00f3 l\u00e0 $[0, 1, a_0, a_1, \\dots, a_k]$ \u0111\u1ed1i v\u1edbi $a_0 &gt; 0$ v\u00e0 $[0, a_1+1, a_2, \\dots, a_k]$ \u0111\u1ed1i v\u1edbi $a_0=0$.</li> </ol> <p>\u0110\u00e1ng ch\u00fa \u00fd, n\u1ebfu ch\u00fang ta li\u1ec7t k\u00ea c\u00e1c \u0111\u1ec9nh c\u1ee7a c\u00e2y Calkin-Wilf theo th\u1ee9 t\u1ef1 t\u00ecm ki\u1ebfm theo chi\u1ec1u r\u1ed9ng (t\u1ee9c l\u00e0, g\u1ed1c c\u00f3 s\u1ed1 $1$, v\u00e0 c\u00e1c con c\u1ee7a \u0111\u1ec9nh $v$ c\u00f3 ch\u1ec9 s\u1ed1 $2v$ v\u00e0 $2v+1$ t\u01b0\u01a1ng \u1ee9ng), ch\u1ec9 s\u1ed1 c\u1ee7a s\u1ed1 h\u1eefu t\u1ef7 trong c\u00e2y Calkin-Wilf s\u1ebd gi\u1ed1ng nh\u01b0 trong c\u00e2y Stern-Brocot.</p> <p>Do \u0111\u00f3, c\u00e1c s\u1ed1 tr\u00ean c\u00f9ng m\u1ed9t c\u1ea5p c\u1ee7a c\u00e2y Stern-Brocot v\u00e0 c\u00e2y Calkin-Wilf l\u00e0 gi\u1ed1ng nhau, nh\u01b0ng th\u1ee9 t\u1ef1 c\u1ee7a ch\u00fang kh\u00e1c nhau th\u00f4ng qua bit-reversal permutation.</p>","tags":["Original"]},{"location":"algebra/continued-fractions.html#convergence","title":"S\u1ef1 h\u1ed9i t\u1ee5 (Convergence)","text":"<p>\u0110\u1ed1i v\u1edbi s\u1ed1 $r$ v\u00e0 gi\u1ea3n ph\u00e2n th\u1ee9 $k$ c\u1ee7a n\u00f3 $r_k=\\frac{p_k}{q_k}$ c\u00f4ng th\u1ee9c sau \u0111\u00e2y \u0111\u01b0\u1ee3c \u00e1p d\u1ee5ng:</p> $$r_k = a_0 + \\sum\\limits_{i=1}^k \\frac{(-1)^{i-1}}{q_i q_{i-1}}.$$ <p>C\u1ee5 th\u1ec3, n\u00f3 c\u00f3 ngh\u0129a l\u00e0</p> $$r_k - r_{k-1} = \\frac{(-1)^{k-1}}{q_k q_{k-1}}$$ <p>v\u00e0 </p> $$p_k q_{k-1} - p_{k-1} q_k = (-1)^{k-1}.$$ <p>T\u1eeb \u0111i\u1ec1u n\u00e0y ch\u00fang ta c\u00f3 th\u1ec3 k\u1ebft lu\u1eadn r\u1eb1ng</p> $$\\left| r-\\frac{p_k}{q_k} \\right| \\leq \\frac{1}{q_{k+1}q_k} \\leq \\frac{1}{q_k^2}.$$ <p>B\u1ea5t \u0111\u1eb3ng th\u1ee9c sau l\u00e0 do th\u1ef1c t\u1ebf r\u1eb1ng $r_k$ v\u00e0 $r_{k+1}$ th\u01b0\u1eddng n\u1eb1m \u1edf c\u00e1c ph\u00eda kh\u00e1c nhau c\u1ee7a $r$, do \u0111\u00f3</p> $$|r-r_k| = |r_k-r_{k+1}|-|r-r_{k+1}| \\leq |r_k - r_{k+1}|.$$ Gi\u1ea3i th\u00edch chi ti\u1ebft <p>\u0110\u1ec3 \u01b0\u1edbc t\u00ednh $|r-r_k|$, ch\u00fang ta b\u1eaft \u0111\u1ea7u b\u1eb1ng c\u00e1ch \u01b0\u1edbc t\u00ednh s\u1ef1 kh\u00e1c bi\u1ec7t gi\u1eefa c\u00e1c gi\u1ea3n ph\u00e2n li\u1ec1n k\u1ec1. Theo \u0111\u1ecbnh ngh\u0129a,</p> $$\\frac{p_k}{q_k} - \\frac{p_{k-1}}{q_{k-1}} = \\frac{p_k q_{k-1} - p_{k-1} q_k}{q_k q_{k-1}}.$$ <p>Thay th\u1ebf $p_k$ v\u00e0 $q_k$ trong t\u1eed s\u1ed1 b\u1eb1ng c\u00e1c c\u00f4ng th\u1ee9c truy h\u1ed3i c\u1ee7a ch\u00fang, ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c</p> $$\\begin{align} p_k q_{k-1} - p_{k-1} q_k &amp;= (a_k p_{k-1} + p_{k-2}) q_{k-1} - p_{k-1} (a_k q_{k-1} + q_{k-2}) \\\\&amp;= p_{k-2} q_{k-1} - p_{k-1} q_{k-2},\\end{align}$$ <p>do \u0111\u00f3 t\u1eed s\u1ed1 c\u1ee7a $r_k - r_{k-1}$ lu\u00f4n l\u00e0 t\u1eed s\u1ed1 ph\u1ee7 \u0111\u1ecbnh c\u1ee7a $r_{k-1} - r_{k-2}$. N\u00f3, \u0111\u1ebfn l\u01b0\u1ee3t n\u00f3, b\u1eb1ng $1$ \u0111\u1ed1i v\u1edbi</p> $$r_1 - r_0=\\left(a_0+\\frac{1}{a_1}\\right)-a_0=\\frac{1}{a_1},$$ <p>do \u0111\u00f3</p> $$r_k - r_{k-1} = \\frac{(-1)^{k-1}}{q_k q_{k-1}}.$$ <p>\u0110i\u1ec1u n\u00e0y mang l\u1ea1i m\u1ed9t bi\u1ec3u di\u1ec5n thay th\u1ebf c\u1ee7a $r_k$ nh\u01b0 m\u1ed9t t\u1ed5ng ri\u00eang c\u1ee7a chu\u1ed7i v\u00f4 h\u1ea1n:</p> $$r_k = (r_k - r_{k-1}) + \\dots + (r_1 - r_0) + r_0 = a_0 + \\sum\\limits_{i=1}^k \\frac{(-1)^{i-1}}{q_i q_{i-1}}.$$ <p>T\u1eeb quan h\u1ec7 truy h\u1ed3i suy ra r\u1eb1ng $q_k$ t\u0103ng \u0111\u01a1n \u0111i\u1ec7u nhanh \u00edt nh\u1ea5t nh\u01b0 s\u1ed1 Fibonacci, do \u0111\u00f3</p> $$r = \\lim\\limits_{k \\to \\infty} r_k = a_0 + \\sum\\limits_{i=1}^\\infty \\frac{(-1)^{i-1}}{q_i q_{i-1}}$$ <p>lu\u00f4n \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh r\u00f5, v\u00ec chu\u1ed7i c\u01a1 b\u1ea3n lu\u00f4n h\u1ed9i t\u1ee5. \u0110\u00e1ng ch\u00fa \u00fd, chu\u1ed7i d\u01b0</p> $$r-r_k = \\sum\\limits_{i=k+1}^\\infty \\frac{(-1)^{i-1}}{q_i q_{i-1}}$$ <p>c\u00f3 c\u00f9ng d\u1ea5u v\u1edbi $(-1)^k$ do t\u1ed1c \u0111\u1ed9 $q_i q_{i-1}$ gi\u1ea3m. Do \u0111\u00f3 c\u00e1c $r_k$ c\u00f3 ch\u1ec9 s\u1ed1 ch\u1eb5n ti\u1ebfn t\u1edbi $r$ t\u1eeb ph\u00eda d\u01b0\u1edbi trong khi c\u00e1c $r_k$ c\u00f3 ch\u1ec9 s\u1ed1 l\u1ebb ti\u1ebfn t\u1edbi n\u00f3 t\u1eeb ph\u00eda tr\u00ean:</p> <p> C\u00e1c gi\u1ea3n ph\u00e2n c\u1ee7a $r=\\phi = \\frac{1+\\sqrt{5}}{2}=[1;1,1,\\dots]$ v\u00e0 kho\u1ea3ng c\u00e1ch c\u1ee7a ch\u00fang t\u1edbi $r$.</p> <p>T\u1eeb h\u00ecnh n\u00e0y ch\u00fang ta c\u00f3 th\u1ec3 th\u1ea5y r\u1eb1ng</p> $$|r-r_k| = |r_k - r_{k+1}| - |r-r_{k+1}| \\leq |r_k - r_{k+1}|,$$ <p>do \u0111\u00f3 kho\u1ea3ng c\u00e1ch gi\u1eefa $r$ v\u00e0 $r_k$ kh\u00f4ng bao gi\u1edd l\u1edbn h\u01a1n kho\u1ea3ng c\u00e1ch gi\u1eefa $r_k$ v\u00e0 $r_{k+1}$:</p> $$\\left|r-\\frac{p_k}{q_k}\\right| \\leq \\frac{1}{q_k q_{k+1}} \\leq \\frac{1}{q_k^2}.$$ <p>Euclid m\u1edf r\u1ed9ng?</p> <p>B\u1ea1n \u0111\u01b0\u1ee3c cho $A, B, C \\in \\mathbb Z$. T\u00ecm $x, y \\in \\mathbb Z$ sao cho $Ax + By = C$.</p> L\u1eddi gi\u1ea3i <p>M\u1eb7c d\u00f9 b\u00e0i to\u00e1n n\u00e0y th\u01b0\u1eddng \u0111\u01b0\u1ee3c gi\u1ea3i b\u1eb1ng thu\u1eadt to\u00e1n Euclid m\u1edf r\u1ed9ng, c\u00f3 m\u1ed9t gi\u1ea3i ph\u00e1p \u0111\u01a1n gi\u1ea3n v\u00e0 tr\u1ef1c ti\u1ebfp v\u1edbi li\u00ean ph\u00e2n s\u1ed1.</p> <p>Cho $\\frac{A}{B}=[a_0; a_1, \\dots, a_k]$. \u0110\u00e3 \u0111\u01b0\u1ee3c ch\u1ee9ng minh \u1edf tr\u00ean r\u1eb1ng $p_k q_{k-1} - p_{k-1} q_k = (-1)^{k-1}$. Thay th\u1ebf $p_k$ v\u00e0 $q_k$ b\u1eb1ng $A$ v\u00e0 $B$, ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c</p> $$Aq_{k-1} - Bp_{k-1} = (-1)^{k-1} g,$$ <p>trong \u0111\u00f3 $g = \\gcd(A, B)$. N\u1ebfu $C$ chia h\u1ebft cho $g$, th\u00ec nghi\u1ec7m l\u00e0 $x = (-1)^{k-1}\\frac{C}{g} q_{k-1}$ v\u00e0 $y = (-1)^{k}\\frac{C}{g} p_{k-1}$.</p> Python <pre><code># return (x, y) such that Ax+By=C\n# assumes that such (x, y) exists\ndef dio(A, B, C):\n    p, q = convergents(fraction(A, B))\n    C //= A // p[-1] # divide by gcd(A, B)\n    t = (-1) if len(p) % 2 else 1\n    return t*C*q[-2], -t*C*p[-2]\n</code></pre>","tags":["Original"]},{"location":"algebra/continued-fractions.html#linear-fractional-transformations","title":"Bi\u1ebfn \u0111\u1ed5i ph\u00e2n tuy\u1ebfn t\u00ednh (Linear fractional transformations)","text":"<p>M\u1ed9t kh\u00e1i ni\u1ec7m quan tr\u1ecdng kh\u00e1c \u0111\u1ed1i v\u1edbi li\u00ean ph\u00e2n s\u1ed1 l\u00e0 c\u00e1i g\u1ecdi l\u00e0 bi\u1ebfn \u0111\u1ed5i ph\u00e2n tuy\u1ebfn t\u00ednh.</p> <p>\u0110\u1ecbnh ngh\u0129a</p> <p>M\u1ed9t bi\u1ebfn \u0111\u1ed5i ph\u00e2n tuy\u1ebfn t\u00ednh l\u00e0 m\u1ed9t h\u00e0m $f : \\mathbb R \\to \\mathbb R$ sao cho $f(x) = \\frac{ax+b}{cx+d}$ v\u1edbi m\u1ed9t s\u1ed1 $a,b,c,d \\in \\mathbb R$.</p> <p>M\u1ed9t h\u1ee3p th\u00e0nh $(L_0 \\circ L_1)(x) = L_0(L_1(x))$ c\u1ee7a c\u00e1c bi\u1ebfn \u0111\u1ed5i ph\u00e2n tuy\u1ebfn t\u00ednh $L_0(x)=\\frac{a_0 x + b_0}{c_0 x + d_0}$ v\u00e0 $L_1(x)=\\frac{a_1 x + b_1}{c_1 x + d_1}$ ch\u00ednh n\u00f3 l\u00e0 m\u1ed9t bi\u1ebfn \u0111\u1ed5i ph\u00e2n tuy\u1ebfn t\u00ednh:</p> $$\\frac{a_0\\frac{a_1 x + b_1}{c_1 x + d_1} + b_0}{c_0 \\frac{a_1 x + b_1}{c_1 x + d_1} + d_0} = \\frac{a_0(a_1 x + b_1) + b_0 (c_1 x + d_1)}{c_0 (a_1 x + b_1) + d_0 (c_1 x + d_1)} = \\frac{(a_0 a_1 + b_0 c_1) x + (a_0 b_1 + b_0 d_1)}{(c_0 a_1 + d_0 c_1) x + (c_0 b_1 + d_0 d_1)}.$$ <p>Ngh\u1ecbch \u0111\u1ea3o c\u1ee7a m\u1ed9t bi\u1ebfn \u0111\u1ed5i ph\u00e2n tuy\u1ebfn t\u00ednh, c\u0169ng l\u00e0 m\u1ed9t bi\u1ebfn \u0111\u1ed5i ph\u00e2n tuy\u1ebfn t\u00ednh:</p> $$y = \\frac{ax+b}{cx+d} \\iff y(cx+d) = ax + b \\iff x = -\\frac{dy-b}{cy-a}.$$ <p>DMOPC '19 Contest 7 P4 - Bob and Continued Fractions</p> <p>B\u1ea1n \u0111\u01b0\u1ee3c cho m\u1ed9t m\u1ea3ng c\u00e1c s\u1ed1 nguy\u00ean d\u01b0\u01a1ng $a_1, \\dots, a_n$. B\u1ea1n c\u1ea7n tr\u1ea3 l\u1eddi $m$ truy v\u1ea5n. M\u1ed7i truy v\u1ea5n l\u00e0 \u0111\u1ec3 t\u00ednh $[a_l; a_{l+1}, \\dots, a_r]$.</p> L\u1eddi gi\u1ea3i <p>Ch\u00fang ta c\u00f3 th\u1ec3 gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 n\u00e0y v\u1edbi segment tree n\u1ebfu ch\u00fang ta c\u00f3 th\u1ec3 n\u1ed1i c\u00e1c li\u00ean ph\u00e2n s\u1ed1.</p> <p>M\u1ed9t \u0111i\u1ec1u th\u01b0\u1eddng \u0111\u00fang l\u00e0 $[a_0; a_1, \\dots, a_k, b_0, b_1, \\dots, b_k] = [a_0; a_1, \\dots, a_k, [b_1; b_2, \\dots, b_k]]$.</p> <p>H\u00e3y k\u00fd hi\u1ec7u $L_{k}(x) = [a_k; x] = a_k + \\frac{1}{x} = \\frac{a_k\\cdot x+1}{1\\cdot x + 0}$. L\u01b0u \u00fd r\u1eb1ng $L_k(\\infty) = a_k$. Trong k\u00fd hi\u1ec7u n\u00e0y, \u0111i\u1ec1u sau \u0111\u00fang</p> $$[a_0; a_1, \\dots, a_k, x] = [a_0; [a_1; [\\dots; [a_k; x]]]] = (L_0 \\circ L_1 \\circ \\dots \\circ L_k)(x) = \\frac{p_k x + p_{k-1}}{q_k x + q_{k-1}}.$$ <p>Do \u0111\u00f3, b\u00e0i to\u00e1n quy v\u1ec1 vi\u1ec7c t\u00ednh to\u00e1n</p> $$(L_l \\circ L_{l+1} \\circ \\dots \\circ L_r)(\\infty).$$ <p>H\u1ee3p th\u00e0nh c\u1ee7a c\u00e1c bi\u1ebfn \u0111\u1ed5i c\u00f3 t\u00ednh k\u1ebft h\u1ee3p, v\u00ec v\u1eady c\u00f3 th\u1ec3 t\u00ednh to\u00e1n trong m\u1ed7i n\u00fat c\u1ee7a segment tree h\u1ee3p th\u00e0nh c\u1ee7a c\u00e1c bi\u1ebfn \u0111\u1ed5i trong c\u00e2y con c\u1ee7a n\u00f3.</p> <p>Bi\u1ebfn \u0111\u1ed5i ph\u00e2n tuy\u1ebfn t\u00ednh c\u1ee7a m\u1ed9t li\u00ean ph\u00e2n s\u1ed1</p> <p>Cho $L(x) = \\frac{ax+b}{cx+d}$. T\u00ednh bi\u1ec3u di\u1ec5n li\u00ean ph\u00e2n s\u1ed1 $[b_0; b_1, \\dots, b_m]$ c\u1ee7a $L(A)$ \u0111\u1ed1i v\u1edbi $A=[a_0; a_1, \\dots, a_n]$.</p> <p>\u0110i\u1ec1u n\u00e0y cho ph\u00e9p t\u00ednh $A + \\frac{p}{q} = \\frac{qA + p}{q}$ v\u00e0 $A \\cdot \\frac{p}{q} = \\frac{p A}{q}$ v\u1edbi b\u1ea5t k\u1ef3 $\\frac{p}{q}$.</p> L\u1eddi gi\u1ea3i <p>Nh\u01b0 ch\u00fang ta \u0111\u00e3 l\u01b0u \u00fd \u1edf tr\u00ean, $[a_0; a_1, \\dots, a_k] = (L_{a_0} \\circ L_{a_1} \\circ \\dots \\circ L_{a_k})(\\infty)$, do \u0111\u00f3 $L([a_0; a_1, \\dots, a_k]) = (L \\circ L_{a_0} \\circ L_{a_1} \\circ \\dots L_{a_k})(\\infty)$.</p> <p>V\u00ec v\u1eady, b\u1eb1ng c\u00e1ch th\u00eam $L_{a_0}$, $L_{a_1}$ v\u00e0 v\u00e2n v\u00e2n m\u1ed9t c\u00e1ch tu\u1ea7n t\u1ef1, ch\u00fang ta s\u1ebd c\u00f3 th\u1ec3 t\u00ednh</p> $$(L \\circ L_{a_0} \\circ \\dots \\circ L_{a_k})(x) = L\\left(\\frac{p_k x + p_{k-1}}{q_k x + q_{k-1}}\\right)=\\frac{a_k x + b_k}{c_k x + d_k}.$$ <p>V\u00ec $L(x)$ kh\u1ea3 ngh\u1ecbch, n\u00f3 c\u0169ng \u0111\u01a1n \u0111i\u1ec7u trong $x$. Do \u0111\u00f3, v\u1edbi b\u1ea5t k\u1ef3 $x \\geq 0$ \u0111i\u1ec1u sau \u0111\u00fang $L(\\frac{p_k x + p_{k-1}}{q_k x + q_{k-1}})$ n\u1eb1m gi\u1eefa $L(\\frac{p_k}{q_k}) = \\frac{a_k}{c_k}$ v\u00e0 $L(\\frac{p_{k-1}}{q_{k-1}}) = \\frac{b_k}{d_k}$.</p> <p>H\u01a1n n\u1eefa, \u0111\u1ed1i v\u1edbi $x=[a_{k+1}; \\dots, a_n]$ n\u00f3 b\u1eb1ng v\u1edbi $L(A)$. Do \u0111\u00f3, $b_0 = \\lfloor L(A) \\rfloor$ n\u1eb1m gi\u1eefa $\\lfloor L(\\frac{p_k}{q_k}) \\rfloor$ v\u00e0 $\\lfloor L(\\frac{p_{k-1}}{q_{k-1}}) \\rfloor$. Khi ch\u00fang b\u1eb1ng nhau, ch\u00fang c\u0169ng b\u1eb1ng $b_0$.</p> <p>L\u01b0u \u00fd r\u1eb1ng $L(A) = (L_{b_0} \\circ L_{b_1} \\circ \\dots \\circ L_{b_m})(\\infty)$. Bi\u1ebft $b_0$, ch\u00fang ta c\u00f3 th\u1ec3 h\u1ee3p th\u00e0nh $L_{b_0}^{-1}$ v\u1edbi bi\u1ebfn \u0111\u1ed5i hi\u1ec7n t\u1ea1i v\u00e0 ti\u1ebfp t\u1ee5c th\u00eam $L_{a_{k+1}}$, $L_{a_{k+2}}$ v\u00e0 c\u1ee9 th\u1ebf, t\u00ecm ki\u1ebfm c\u00e1c s\u00e0n (floors) m\u1edbi \u0111\u1ec3 \u0111\u1ed3ng \u00fd, t\u1eeb \u0111\u00f3 ch\u00fang ta s\u1ebd c\u00f3 th\u1ec3 suy ra $b_1$ v\u00e0 c\u1ee9 th\u1ebf cho \u0111\u1ebfn khi ch\u00fang ta kh\u00f4i ph\u1ee5c t\u1ea5t c\u1ea3 c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a $[b_0; b_1, \\dots, b_m]$.</p> <p>S\u1ed1 h\u1ecdc li\u00ean ph\u00e2n s\u1ed1</p> <p>Cho $A=[a_0; a_1, \\dots, a_n]$ v\u00e0 $B=[b_0; b_1, \\dots, b_m]$. T\u00ednh bi\u1ec3u di\u1ec5n li\u00ean ph\u00e2n s\u1ed1 c\u1ee7a $A+B$ v\u00e0 $A \\cdot B$.</p> L\u1eddi gi\u1ea3i <p>\u00dd t\u01b0\u1edfng \u1edf \u0111\u00e2y t\u01b0\u01a1ng t\u1ef1 nh\u01b0 b\u00e0i to\u00e1n tr\u01b0\u1edbc, nh\u01b0ng thay v\u00ec $L(x) = \\frac{ax+b}{cx+d}$ b\u1ea1n n\u00ean xem x\u00e9t bi\u1ebfn \u0111\u1ed5i ph\u00e2n tuy\u1ebfn t\u00ednh song tuy\u1ebfn (bilinear) $L(x, y) = \\frac{axy+bx+cy+d}{exy+fx+gy+h}$.</p> <p>Thay v\u00ec $L(x) \\mapsto L(L_{a_k}(x))$ b\u1ea1n s\u1ebd thay \u0111\u1ed5i bi\u1ebfn \u0111\u1ed5i hi\u1ec7n t\u1ea1i c\u1ee7a m\u00ecnh th\u00e0nh $L(x, y) \\mapsto L(L_{a_k}(x), y)$ ho\u1eb7c $L(x, y) \\mapsto L(x, L_{b_k}(y))$.</p> <p>Sau \u0111\u00f3, b\u1ea1n ki\u1ec3m tra xem n\u1ebfu $\\lfloor \\frac{a}{e} \\rfloor = \\lfloor \\frac{b}{f} \\rfloor = \\lfloor \\frac{c}{g} \\rfloor = \\lfloor \\frac{d}{h} \\rfloor$ v\u00e0 n\u1ebfu t\u1ea5t c\u1ea3 ch\u00fang \u0111\u1ec1u \u0111\u1ed3ng \u00fd, b\u1ea1n s\u1eed d\u1ee5ng gi\u00e1 tr\u1ecb n\u00e0y l\u00e0m $c_k$ trong ph\u00e2n s\u1ed1 k\u1ebft qu\u1ea3 v\u00e0 thay \u0111\u1ed5i bi\u1ebfn \u0111\u1ed5i th\u00e0nh</p> $$L(x, y) \\mapsto \\frac{1}{L(x, y) - c_k}.$$ <p>\u0110\u1ecbnh ngh\u0129a</p> <p>M\u1ed9t li\u00ean ph\u00e2n s\u1ed1 $x = [a_0; a_1, \\dots]$ \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 tu\u1ea7n ho\u00e0n n\u1ebfu $x = [a_0; a_1, \\dots, a_k, x]$ v\u1edbi m\u1ed9t s\u1ed1 $k$.</p> <p>M\u1ed9t li\u00ean ph\u00e2n s\u1ed1 $x = [a_0; a_1, \\dots]$ \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 tu\u1ea7n ho\u00e0n cu\u1ed1i c\u00f9ng (eventually periodic) n\u1ebfu $x = [a_0; a_1, \\dots, a_k, y]$, trong \u0111\u00f3 $y$ l\u00e0 tu\u1ea7n ho\u00e0n.</p> <p>\u0110\u1ed1i v\u1edbi $x = [1; 1, 1, \\dots]$ ta c\u00f3 $x = 1 + \\frac{1}{x}$, do \u0111\u00f3 $x^2 = x + 1$. C\u00f3 m\u1ed9t m\u1ed1i li\u00ean h\u1ec7 chung gi\u1eefa c\u00e1c li\u00ean ph\u00e2n s\u1ed1 tu\u1ea7n ho\u00e0n v\u00e0 ph\u01b0\u01a1ng tr\u00ecnh b\u1eadc hai. Xem x\u00e9t ph\u01b0\u01a1ng tr\u00ecnh sau:</p> $$ x = [a_0; a_1, \\dots, a_k, x].$$ <p>M\u1ed9t m\u1eb7t, ph\u01b0\u01a1ng tr\u00ecnh n\u00e0y c\u00f3 ngh\u0129a l\u00e0 bi\u1ec3u di\u1ec5n li\u00ean ph\u00e2n s\u1ed1 c\u1ee7a $x$ l\u00e0 tu\u1ea7n ho\u00e0n v\u1edbi chu k\u1ef3 $k+1$.</p> <p>M\u1eb7t kh\u00e1c, s\u1eed d\u1ee5ng c\u00f4ng th\u1ee9c cho c\u00e1c gi\u1ea3n ph\u00e2n, ph\u01b0\u01a1ng tr\u00ecnh n\u00e0y c\u00f3 ngh\u0129a l\u00e0</p> $$x = \\frac{p_k x + p_{k-1}}{q_k x + q_{k-1}}.$$ <p>Ngh\u0129a l\u00e0, $x$ l\u00e0 m\u1ed9t bi\u1ebfn \u0111\u1ed5i ph\u00e2n tuy\u1ebfn t\u00ednh c\u1ee7a ch\u00ednh n\u00f3. T\u1eeb ph\u01b0\u01a1ng tr\u00ecnh suy ra r\u1eb1ng $x$ l\u00e0 nghi\u1ec7m c\u1ee7a ph\u01b0\u01a1ng tr\u00ecnh b\u1eadc hai:</p> $$q_k x^2 + (q_{k-1}-p_k)x - p_{k-1} = 0.$$ <p>L\u00fd lu\u1eadn t\u01b0\u01a1ng t\u1ef1 c\u0169ng \u0111\u00fang cho c\u00e1c li\u00ean ph\u00e2n s\u1ed1 tu\u1ea7n ho\u00e0n cu\u1ed1i c\u00f9ng, ngh\u0129a l\u00e0 $x = [a_0; a_1, \\dots, a_k, y]$ \u0111\u1ed1i v\u1edbi $y=[b_0; b_1, \\dots, b_k, y]$. Th\u1eadt v\u1eady, t\u1eeb ph\u01b0\u01a1ng tr\u00ecnh \u0111\u1ea7u ti\u00ean ta suy ra r\u1eb1ng $x = L_0(y)$ v\u00e0 t\u1eeb ph\u01b0\u01a1ng tr\u00ecnh th\u1ee9 hai l\u00e0 $y = L_1(y)$, trong \u0111\u00f3 $L_0$ v\u00e0 $L_1$ l\u00e0 c\u00e1c bi\u1ebfn \u0111\u1ed5i ph\u00e2n tuy\u1ebfn t\u00ednh. Do \u0111\u00f3,</p> $$x = (L_0 \\circ L_1)(y) = (L_0 \\circ L_1 \\circ L_0^{-1})(x).$$ <p>Ng\u01b0\u1eddi ta c\u00f3 th\u1ec3 ch\u1ee9ng minh th\u00eam (v\u00e0 \u0111i\u1ec1u \u0111\u00f3 l\u1ea7n \u0111\u1ea7u ti\u00ean \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n b\u1edfi Lagrange) r\u1eb1ng \u0111\u1ed1i v\u1edbi b\u1ea5t k\u1ef3 ph\u01b0\u01a1ng tr\u00ecnh b\u1eadc hai $ax^2+bx+c=0$ n\u00e0o v\u1edbi c\u00e1c h\u1ec7 s\u1ed1 nguy\u00ean, nghi\u1ec7m $x$ c\u1ee7a n\u00f3 l\u00e0 m\u1ed9t li\u00ean ph\u00e2n s\u1ed1 tu\u1ea7n ho\u00e0n cu\u1ed1i c\u00f9ng.</p> <p>S\u1ed1 v\u00f4 t\u1ef7 b\u1eadc hai</p> <p>T\u00ecm li\u00ean ph\u00e2n s\u1ed1 c\u1ee7a $\\alpha = \\frac{x+y\\sqrt{n}}{z}$ trong \u0111\u00f3 $x, y, z, n \\in \\mathbb Z$ v\u00e0 $n &gt; 0$ kh\u00f4ng ph\u1ea3i l\u00e0 m\u1ed9t s\u1ed1 ch\u00ednh ph\u01b0\u01a1ng.</p> L\u1eddi gi\u1ea3i <p>\u0110\u1ed1i v\u1edbi th\u01b0\u01a1ng \u0111\u1ea7y \u0111\u1ee7 th\u1ee9 $k$ l\u00e0 $s_k$ c\u1ee7a s\u1ed1 \u0111\u00f3, \u0111i\u1ec1u chung sau \u0111\u00e2y \u0111\u00fang</p> $$\\alpha = [a_0; a_1, \\dots, a_{k-1}, s_k] = \\frac{s_k p_{k-1} + p_{k-2}}{s_k q_{k-1} + q_{k-2}}.$$ <p>Do \u0111\u00f3, </p> $$s_k = -\\frac{\\alpha q_{k-1} - p_{k-1}}{\\alpha q_k - p_k} = -\\frac{q_{k-1} y \\sqrt n + (x q_{k-1} - z p_{k-1})}{q_k y \\sqrt n + (xq_k-zp_k)}.$$ <p>Nh\u00e2n t\u1eed s\u1ed1 v\u00e0 m\u1eabu s\u1ed1 v\u1edbi $(xq_k - zp_k) - q_k y \\sqrt n$, ch\u00fang ta s\u1ebd lo\u1ea1i b\u1ecf $\\sqrt n$ \u1edf m\u1eabu s\u1ed1, do \u0111\u00f3 c\u00e1c th\u01b0\u01a1ng \u0111\u1ea7y \u0111\u1ee7 c\u00f3 d\u1ea1ng</p> $$s_k = \\frac{x_k + y_k \\sqrt n}{z_k}.$$ <p>H\u00e3y t\u00ecm $s_{k+1}$, gi\u1ea3 s\u1eed r\u1eb1ng $s_k$ \u0111\u00e3 bi\u1ebft.</p> <p>\u0110\u1ea7u ti\u00ean, $a_k = \\lfloor s_k \\rfloor = \\left\\lfloor \\frac{x_k + y_k \\lfloor \\sqrt n \\rfloor}{z_k} \\right\\rfloor$. Sau \u0111\u00f3,</p> $$s_{k+1} = \\frac{1}{s_k-a_k} = \\frac{z_k}{(x_k - z_k a_k) + y_k \\sqrt n} = \\frac{z_k (x_k - y_k a_k) - y_k z_k \\sqrt n}{(x_k - y_k a_k)^2 - y_k^2 n}.$$ <p>Do \u0111\u00f3, n\u1ebfu ch\u00fang ta k\u00fd hi\u1ec7u $t_k = x_k - y_k a_k$, \u0111i\u1ec1u sau s\u1ebd \u0111\u00fang</p> $$\\begin{align}x_{k+1} &amp;=&amp; z_k t_k, \\\\ y_{k+1} &amp;=&amp; -y_k z_k, \\\\ z_{k+1} &amp;=&amp; t_k^2 - y_k^2 n.\\end{align}$$ <p>\u0110i\u1ec1u tuy\u1ec7t v\u1eddi v\u1ec1 bi\u1ec3u di\u1ec5n nh\u01b0 v\u1eady l\u00e0 n\u1ebfu ch\u00fang ta r\u00fat g\u1ecdn $x_{k+1}, y_{k+1}, z_{k+1}$ b\u1eb1ng \u01b0\u1edbc chung l\u1edbn nh\u1ea5t c\u1ee7a ch\u00fang, k\u1ebft qu\u1ea3 s\u1ebd l\u00e0 duy nh\u1ea5t. Do \u0111\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng n\u00f3 \u0111\u1ec3 ki\u1ec3m tra xem tr\u1ea1ng th\u00e1i hi\u1ec7n t\u1ea1i \u0111\u00e3 \u0111\u01b0\u1ee3c l\u1eb7p l\u1ea1i ch\u01b0a v\u00e0 c\u0169ng \u0111\u1ec3 ki\u1ec3m tra ch\u1ec9 s\u1ed1 tr\u01b0\u1edbc \u0111\u00f3 c\u00f3 tr\u1ea1ng th\u00e1i n\u00e0y \u1edf \u0111\u00e2u.</p> <p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u00e3 \u0111\u1ec3 t\u00ednh to\u00e1n bi\u1ec3u di\u1ec5n li\u00ean ph\u00e2n s\u1ed1 cho $\\alpha = \\sqrt n$:</p> Python <pre><code># compute the continued fraction of sqrt(n)\ndef sqrt(n):\n    n0 = math.floor(math.sqrt(n))\n    x, y, z = 1, 0, 1\n    a = []\n    def step(x, y, z):\n        a.append((x * n0 + y) // z)\n        t = y - a[-1]*z\n        x, y, z = -z*x, z*t, t**2 - n*x**2\n        g = math.gcd(x, math.gcd(y, z))\n        return x // g, y // g, z // g\n\n    used = dict()\n    for i in range(n):\n        used[x, y, z] = i\n        x, y, z = step(x, y, z)\n        if (x, y, z) in used:\n            return a\n</code></pre> <p>S\u1eed d\u1ee5ng c\u00f9ng h\u00e0m <code>step</code> nh\u01b0ng kh\u00e1c $x$, $y$ v\u00e0 $z$ ban \u0111\u1ea7u, c\u00f3 th\u1ec3 t\u00ednh to\u00e1n n\u00f3 cho $\\frac{x+y \\sqrt{n}}{z}$ b\u1ea5t k\u1ef3.</p> <p>Tavrida NU Akai Contest - Continued Fraction</p> <p>B\u1ea1n \u0111\u01b0\u1ee3c cho $x$ v\u00e0 $k$, $x$ kh\u00f4ng ph\u1ea3i l\u00e0 s\u1ed1 ch\u00ednh ph\u01b0\u01a1ng. G\u1ecdi $\\sqrt x = [a_0; a_1, \\dots]$, t\u00ecm $\\frac{p_k}{q_k}=[a_0; a_1, \\dots, a_k]$ v\u1edbi $0 \\leq k \\leq 10^9$.</p> L\u1eddi gi\u1ea3i <p>Sau khi t\u00ednh chu k\u1ef3 c\u1ee7a $\\sqrt x$, c\u00f3 th\u1ec3 t\u00ednh $a_k$ b\u1eb1ng l\u0169y th\u1eeba nh\u1ecb ph\u00e2n tr\u00ean bi\u1ebfn \u0111\u1ed5i ph\u00e2n tuy\u1ebfn t\u00ednh \u0111\u01b0\u1ee3c t\u1ea1o ra b\u1edfi bi\u1ec3u di\u1ec5n li\u00ean ph\u00e2n s\u1ed1. \u0110\u1ec3 t\u00ecm bi\u1ebfn \u0111\u1ed5i k\u1ebft qu\u1ea3, b\u1ea1n n\u00e9n chu k\u1ef3 c\u00f3 k\u00edch th\u01b0\u1edbc $T$ th\u00e0nh m\u1ed9t bi\u1ebfn \u0111\u1ed5i duy nh\u1ea5t v\u00e0 l\u1eb7p l\u1ea1i n\u00f3 $\\lfloor \\frac{k-1}{T}\\rfloor$ l\u1ea7n, sau \u0111\u00f3 b\u1ea1n k\u1ebft h\u1ee3p n\u00f3 th\u1ee7 c\u00f4ng v\u1edbi c\u00e1c bi\u1ebfn \u0111\u1ed5i c\u00f2n l\u1ea1i.</p> Python <pre><code>x, k = map(int, input().split())\n\nmod = 10**9+7\n\n# compose (A[0]*x + A[1]) / (A[2]*x + A[3]) and (B[0]*x + B[1]) / (B[2]*x + B[3])\ndef combine(A, B):\n    return [t % mod for t in [A[0]*B[0]+A[1]*B[2], A[0]*B[1]+A[1]*B[3], A[2]*B[0]+A[3]*B[2], A[2]*B[1]+A[3]*B[3]]]\n\nA = [1, 0, 0, 1] # (x + 0) / (0*x + 1) = x\n\na = sqrt(x)\n\nT = len(a) - 1 # period of a\n\n# apply ak + 1/x = (ak*x+1)/(1x+0) to (Ax + B) / (Cx + D)\nfor i in reversed(range(1, len(a))):\n    A = combine([a[i], 1, 1, 0], A)\n\ndef bpow(A, n):\n    return [1, 0, 0, 1] if not n else combine(A, bpow(A, n-1)) if n % 2 else bpow(combine(A, A), n // 2)\n\n\nC = (0, 1, 0, 0) # = 1 / 0\nwhile k % T:\n    i = k % T\n    C = combine([a[i], 1, 1, 0], C)\n    k -= 1\n\nC = combine(bpow(A, k // T), C)\nC = combine([a[0], 1, 1, 0], C)\nprint(str(C[1]) + '/' + str(C[3]))\n</code></pre>","tags":["Original"]},{"location":"algebra/continued-fractions.html#geometric-interpretation","title":"\u00dd ngh\u0129a h\u00ecnh h\u1ecdc (Geometric interpretation)","text":"<p>G\u1ecdi $\\vec r_k = (q_k;p_k)$ \u0111\u1ed1i v\u1edbi gi\u1ea3n ph\u00e2n $r_k = \\frac{p_k}{q_k}$. Khi \u0111\u00f3, c\u00f4ng th\u1ee9c truy h\u1ed3i sau \u0111\u01b0\u1ee3c \u00e1p d\u1ee5ng:</p> $$\\vec r_k = a_k \\vec r_{k-1} + \\vec r_{k-2}.$$ <p>G\u1ecdi $\\vec r = (1;r)$. Khi \u0111\u00f3, m\u1ed7i vect\u01a1 $(x;y)$ t\u01b0\u01a1ng \u1ee9ng v\u1edbi s\u1ed1 b\u1eb1ng h\u1ec7 s\u1ed1 g\u00f3c c\u1ee7a n\u00f3 $\\frac{y}{x}$.</p> <p>V\u1edbi kh\u00e1i ni\u1ec7m t\u00edch gi\u1ea3 v\u00f4 h\u01b0\u1edbng (pseudoscalar product) $(x_1;y_1) \\times (x_2;y_2) = x_1 y_2 - x_2 y_1$, c\u00f3 th\u1ec3 ch\u1ee9ng minh (xem gi\u1ea3i th\u00edch b\u00ean d\u01b0\u1edbi) r\u1eb1ng</p> $$s_k = -\\frac{\\vec r_{k-2} \\times \\vec r}{\\vec r_{k-1} \\times \\vec r} = \\left|\\frac{\\vec r_{k-2} \\times \\vec r}{\\vec r_{k-1} \\times \\vec r}\\right|.$$ <p>Ph\u01b0\u01a1ng tr\u00ecnh cu\u1ed1i c\u00f9ng l\u00e0 do th\u1ef1c t\u1ebf r\u1eb1ng $r_{k-1}$ v\u00e0 $r_{k-2}$ n\u1eb1m \u1edf c\u00e1c ph\u00eda kh\u00e1c nhau c\u1ee7a $r$, do \u0111\u00f3 c\u00e1c t\u00edch gi\u1ea3 v\u00f4 h\u01b0\u1edbng c\u1ee7a $\\vec r_{k-1}$ v\u00e0 $\\vec r_{k-2}$ v\u1edbi $\\vec r$ c\u00f3 d\u1ea5u ph\u00e2n bi\u1ec7t. V\u1edbi $a_k = \\lfloor s_k \\rfloor$ trong t\u00e2m tr\u00ed, c\u00f4ng th\u1ee9c cho $\\vec r_k$ b\u00e2y gi\u1edd tr\u00f4ng nh\u01b0</p> $$\\vec r_k = \\vec r_{k-2} + \\left\\lfloor \\left| \\frac{\\vec r \\times \\vec r_{k-2}}{\\vec r \\times \\vec r_{k-1}}\\right|\\right\\rfloor \\vec r_{k-1}.$$ <p>L\u01b0u \u00fd r\u1eb1ng $\\vec r_k \\times r = (q;p) \\times (1;r) = qr - p$, do \u0111\u00f3</p> $$a_k = \\left\\lfloor \\left| \\frac{q_{k-1}r-p_{k-1}}{q_{k-2}r-p_{k-2}} \\right| \\right\\rfloor.$$ Gi\u1ea3i th\u00edch <p>Nh\u01b0 ch\u00fang ta \u0111\u00e3 l\u01b0u \u00fd, $a_k = \\lfloor s_k \\rfloor$, trong \u0111\u00f3 $s_k = [a_k; a_{k+1}, a_{k+2}, \\dots]$. M\u1eb7t kh\u00e1c, t\u1eeb truy h\u1ed3i gi\u1ea3n ph\u00e2n ch\u00fang ta suy ra r\u1eb1ng</p> $$r = [a_0; a_1, \\dots, a_{k-1}, s_k] = \\frac{s_k p_{k-1} + p_{k-2}}{s_k q_{k-1} + q_{k-2}}.$$ <p>\u1ede d\u1ea1ng vect\u01a1, n\u00f3 vi\u1ebft l\u1ea1i th\u00e0nh</p> $$\\vec r \\parallel s_k \\vec r_{k-1} + \\vec r_{k-2},$$ <p>c\u00f3 ngh\u0129a l\u00e0 $\\vec r$ v\u00e0 $s_k \\vec r_{k-1} + \\vec r_{k-2}$ c\u00f9ng ph\u01b0\u01a1ng (t\u1ee9c l\u00e0, c\u00f3 c\u00f9ng h\u1ec7 s\u1ed1 g\u00f3c). L\u1ea5y t\u00edch gi\u1ea3 v\u00f4 h\u01b0\u1edbng c\u1ee7a c\u1ea3 hai ph\u1ea7n v\u1edbi $\\vec r$, ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c</p> $$0 = s_k (\\vec r_{k-1} \\times \\vec r) + (\\vec r_{k-2} \\times \\vec r),$$ <p>mang l\u1ea1i c\u00f4ng th\u1ee9c cu\u1ed1i c\u00f9ng</p> $$s_k = -\\frac{\\vec r_{k-2} \\times \\vec r}{\\vec r_{k-1} \\times \\vec r}.$$ <p>Thu\u1eadt to\u00e1n k\u00e9o m\u0169i (Nose stretching algorithm)</p> <p>M\u1ed7i l\u1ea7n b\u1ea1n th\u00eam $\\vec r_{k-1}$ v\u00e0o vect\u01a1 $\\vec p$, gi\u00e1 tr\u1ecb c\u1ee7a $\\vec p \\times \\vec r$ t\u0103ng th\u00eam $\\vec r_{k-1} \\times \\vec r$.</p> <p>Do \u0111\u00f3, $a_k=\\lfloor s_k \\rfloor$ l\u00e0 s\u1ed1 nguy\u00ean t\u1ed1i \u0111a c\u00e1c vect\u01a1 $\\vec r_{k-1}$ c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u00eam v\u00e0o $\\vec r_{k-2}$ m\u00e0 kh\u00f4ng thay \u0111\u1ed5i d\u1ea5u c\u1ee7a t\u00edch ch\u00e9o v\u1edbi $\\vec r$.</p> <p>N\u00f3i c\u00e1ch kh\u00e1c, $a_k$ l\u00e0 s\u1ed1 l\u1ea7n nguy\u00ean t\u1ed1i \u0111a b\u1ea1n c\u00f3 th\u1ec3 th\u00eam $\\vec r_{k-1}$ v\u00e0o $\\vec r_{k-2}$ m\u00e0 kh\u00f4ng c\u1eaft qua \u0111\u01b0\u1eddng th\u1eb3ng \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh b\u1edfi $\\vec r$:</p> <p> C\u00e1c gi\u1ea3n ph\u00e2n c\u1ee7a $r=\\frac{7}{9}=[0;1,3,2]$. C\u00e1c b\u00e1n gi\u1ea3n ph\u00e2n t\u01b0\u01a1ng \u1ee9ng v\u1edbi c\u00e1c \u0111i\u1ec3m trung gian gi\u1eefa c\u00e1c m\u0169i t\u00ean m\u00e0u x\u00e1m.</p> <p>Trong h\u00ecnh tr\u00ean, $\\vec r_2 = (4;3)$ thu \u0111\u01b0\u1ee3c b\u1eb1ng c\u00e1ch l\u1eb7p l\u1ea1i vi\u1ec7c th\u00eam $\\vec r_1 = (1;1)$ v\u00e0o $\\vec r_0 = (1;0)$.</p> <p>Khi kh\u00f4ng th\u1ec3 th\u00eam $\\vec r_1$ v\u00e0o $\\vec r_0$ n\u1eefa m\u00e0 kh\u00f4ng c\u1eaft qua \u0111\u01b0\u1eddng th\u1eb3ng $y=rx$, ch\u00fang ta \u0111i sang ph\u00eda b\u00ean kia v\u00e0 l\u1eb7p l\u1ea1i vi\u1ec7c th\u00eam $\\vec r_2$ v\u00e0o $\\vec r_1$ \u0111\u1ec3 thu \u0111\u01b0\u1ee3c $\\vec r_3 = (9;7)$.</p> <p>Quy tr\u00ecnh n\u00e0y t\u1ea1o ra c\u00e1c vect\u01a1 d\u00e0i h\u01a1n theo c\u1ea5p s\u1ed1 nh\u00e2n, ti\u1ebfp c\u1eadn \u0111\u01b0\u1eddng th\u1eb3ng.</p> <p>V\u00ec t\u00ednh ch\u1ea5t n\u00e0y, quy tr\u00ecnh t\u1ea1o ra c\u00e1c vect\u01a1 gi\u1ea3n ph\u00e2n ti\u1ebfp theo \u0111\u01b0\u1ee3c Boris Delaunay \u0111\u1eb7t t\u00ean l\u00e0 thu\u1eadt to\u00e1n k\u00e9o m\u0169i (nose stretching algorithm).</p> <p>N\u1ebfu ch\u00fang ta nh\u00ecn v\u00e0o tam gi\u00e1c \u0111\u01b0\u1ee3c v\u1ebd tr\u00ean c\u00e1c \u0111i\u1ec3m $\\vec r_{k-2}$, $\\vec r_{k}$ v\u00e0 $\\vec 0$ ch\u00fang ta s\u1ebd nh\u1eadn th\u1ea5y r\u1eb1ng di\u1ec7n t\u00edch g\u1ea5p \u0111\u00f4i c\u1ee7a n\u00f3 l\u00e0</p> $$|\\vec r_{k-2} \\times \\vec r_k| = |\\vec r_{k-2} \\times (\\vec r_{k-2} + a_k \\vec r_{k-1})| = a_k |\\vec r_{k-2} \\times \\vec r_{k-1}| = a_k.$$ <p>K\u1ebft h\u1ee3p v\u1edbi \u0110\u1ecbnh l\u00fd Pick, \u0111i\u1ec1u \u0111\u00f3 c\u00f3 ngh\u0129a l\u00e0 kh\u00f4ng c\u00f3 \u0111i\u1ec3m l\u01b0\u1edbi n\u00e0o n\u1eb1m ho\u00e0n to\u00e0n b\u00ean trong tam gi\u00e1c v\u00e0 c\u00e1c \u0111i\u1ec3m l\u01b0\u1edbi duy nh\u1ea5t tr\u00ean bi\u00ean c\u1ee7a n\u00f3 l\u00e0 $\\vec 0$ v\u00e0 $\\vec r_{k-2} + t \\cdot \\vec r_{k-1}$ cho t\u1ea5t c\u1ea3 s\u1ed1 nguy\u00ean $t$ sao cho $0 \\leq t \\leq a_k$. Khi \u0111\u01b0\u1ee3c n\u1ed1i l\u1ea1i cho t\u1ea5t c\u1ea3 c\u00e1c $k$ c\u00f3 th\u1ec3, \u0111i\u1ec1u \u0111\u00f3 c\u00f3 ngh\u0129a l\u00e0 kh\u00f4ng c\u00f3 \u0111i\u1ec3m nguy\u00ean n\u00e0o trong kh\u00f4ng gian gi\u1eefa c\u00e1c \u0111a gi\u00e1c \u0111\u01b0\u1ee3c t\u1ea1o b\u1edfi c\u00e1c vect\u01a1 gi\u1ea3n ph\u00e2n c\u00f3 ch\u1ec9 s\u1ed1 ch\u1eb5n v\u00e0 l\u1ebb.</p>","tags":["Original"]},{"location":"algebra/continued-fractions.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 1115</li> <li>Translated lines: 1115</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Original"]},{"location":"algebra/discrete-log.html","title":"Logarit r\u1eddi r\u1ea1c (Discrete Logarithm)","text":"<p>Logarit r\u1eddi r\u1ea1c l\u00e0 m\u1ed9t s\u1ed1 nguy\u00ean $x$ th\u1ecfa m\u00e3n ph\u01b0\u01a1ng tr\u00ecnh</p> $$a^x \\equiv b \\pmod m$$ <p>v\u1edbi c\u00e1c s\u1ed1 nguy\u00ean $a$, $b$ v\u00e0 $m$ \u0111\u00e3 cho.</p> <p>Logarit r\u1eddi r\u1ea1c kh\u00f4ng ph\u1ea3i l\u00fac n\u00e0o c\u0169ng t\u1ed3n t\u1ea1i, v\u00ed d\u1ee5 kh\u00f4ng c\u00f3 nghi\u1ec7m cho $2^x \\equiv 3 \\pmod 7$. Kh\u00f4ng c\u00f3 \u0111i\u1ec1u ki\u1ec7n \u0111\u01a1n gi\u1ea3n n\u00e0o \u0111\u1ec3 x\u00e1c \u0111\u1ecbnh xem logarit r\u1eddi r\u1ea1c c\u00f3 t\u1ed3n t\u1ea1i hay kh\u00f4ng.</p> <p>Trong b\u00e0i vi\u1ebft n\u00e0y, ch\u00fang t\u00f4i m\u00f4 t\u1ea3 thu\u1eadt to\u00e1n Baby-step giant-step, m\u1ed9t thu\u1eadt to\u00e1n \u0111\u1ec3 t\u00ednh logarit r\u1eddi r\u1ea1c \u0111\u01b0\u1ee3c \u0111\u1ec1 xu\u1ea5t b\u1edfi Shanks v\u00e0o n\u0103m 1971, c\u00f3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian $O(\\sqrt{m})$. \u0110\u00e2y l\u00e0 m\u1ed9t thu\u1eadt to\u00e1n meet-in-the-middle v\u00ec n\u00f3 s\u1eed d\u1ee5ng k\u1ef9 thu\u1eadt chia nh\u1ecf c\u00f4ng vi\u1ec7c th\u00e0nh hai n\u1eeda.</p>","tags":["Translated"]},{"location":"algebra/discrete-log.html#algorithm","title":"Thu\u1eadt to\u00e1n (Algorithm)","text":"<p>X\u00e9t ph\u01b0\u01a1ng tr\u00ecnh:</p> $$a^x \\equiv b \\pmod m,$$ <p>trong \u0111\u00f3 $a$ v\u00e0 $m$ nguy\u00ean t\u1ed1 c\u00f9ng nhau.</p> <p>\u0110\u1eb7t $x = np - q$, trong \u0111\u00f3 $n$ l\u00e0 m\u1ed9t h\u1eb1ng s\u1ed1 \u0111\u01b0\u1ee3c ch\u1ecdn tr\u01b0\u1edbc (ch\u00fang t\u00f4i s\u1ebd m\u00f4 t\u1ea3 c\u00e1ch ch\u1ecdn $n$ sau). $p$ \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 b\u01b0\u1edbc kh\u1ed5ng l\u1ed3 (giant step), v\u00ec t\u0103ng n\u00f3 l\u00ean m\u1ed9t s\u1ebd t\u0103ng $x$ th\u00eam $n$. T\u01b0\u01a1ng t\u1ef1, $q$ \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 b\u01b0\u1edbc nh\u1ecf (baby step).</p> <p>R\u00f5 r\u00e0ng, b\u1ea5t k\u1ef3 s\u1ed1 $x$ n\u00e0o trong kho\u1ea3ng $[0; m)$ \u0111\u1ec1u c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n d\u01b0\u1edbi d\u1ea1ng n\u00e0y, v\u1edbi $p \\in [1; \\lceil \\frac{m}{n} \\rceil ]$ v\u00e0 $q \\in [0; n]$.</p> <p>Khi \u0111\u00f3, ph\u01b0\u01a1ng tr\u00ecnh tr\u1edf th\u00e0nh:</p> $$a^{np - q} \\equiv b \\pmod m.$$ <p>S\u1eed d\u1ee5ng th\u1ef1c t\u1ebf l\u00e0 $a$ v\u00e0 $m$ nguy\u00ean t\u1ed1 c\u00f9ng nhau, ch\u00fang ta thu \u0111\u01b0\u1ee3c:</p> $$a^{np} \\equiv ba^q \\pmod m$$ <p>Ph\u01b0\u01a1ng tr\u00ecnh m\u1edbi n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c vi\u1ebft l\u1ea1i d\u01b0\u1edbi d\u1ea1ng \u0111\u01a1n gi\u1ea3n h\u01a1n:</p> $$f_1(p) = f_2(q).$$ <p>B\u00e0i to\u00e1n n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i b\u1eb1ng ph\u01b0\u01a1ng ph\u00e1p meet-in-the-middle nh\u01b0 sau:</p> <ul> <li>T\u00ednh $f_1$ cho t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ed1i s\u1ed1 $p$ c\u00f3 th\u1ec3. S\u1eafp x\u1ebfp m\u1ea3ng c\u00e1c c\u1eb7p gi\u00e1 tr\u1ecb-\u0111\u1ed1i s\u1ed1.</li> <li>V\u1edbi t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ed1i s\u1ed1 $q$ c\u00f3 th\u1ec3, t\u00ednh $f_2$ v\u00e0 t\u00ecm $p$ t\u01b0\u01a1ng \u1ee9ng trong m\u1ea3ng \u0111\u00e3 s\u1eafp x\u1ebfp b\u1eb1ng t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n.</li> </ul>","tags":["Translated"]},{"location":"algebra/discrete-log.html#complexity","title":"\u0110\u1ed9 ph\u1ee9c t\u1ea1p (Complexity)","text":"<p>Ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh $f_1(p)$ trong $O(\\log m)$ b\u1eb1ng thu\u1eadt to\u00e1n l\u0169y th\u1eeba nh\u1ecb ph\u00e2n. T\u01b0\u01a1ng t\u1ef1 cho $f_2(q)$.</p> <p>Trong b\u01b0\u1edbc \u0111\u1ea7u ti\u00ean c\u1ee7a thu\u1eadt to\u00e1n, ch\u00fang ta c\u1ea7n t\u00ednh $f_1$ cho m\u1ecdi \u0111\u1ed1i s\u1ed1 $p$ c\u00f3 th\u1ec3 v\u00e0 sau \u0111\u00f3 s\u1eafp x\u1ebfp c\u00e1c gi\u00e1 tr\u1ecb. Do \u0111\u00f3, b\u01b0\u1edbc n\u00e0y c\u00f3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p:</p> $$O\\left(\\left\\lceil \\frac{m}{n} \\right\\rceil \\left(\\log m + \\log \\left\\lceil \\frac{m}{n} \\right\\rceil \\right)\\right) = O\\left( \\left\\lceil \\frac {m}{n} \\right\\rceil \\log m\\right)$$ <p>Trong b\u01b0\u1edbc th\u1ee9 hai c\u1ee7a thu\u1eadt to\u00e1n, ch\u00fang ta c\u1ea7n t\u00ednh $f_2(q)$ cho m\u1ecdi \u0111\u1ed1i s\u1ed1 $q$ c\u00f3 th\u1ec3 v\u00e0 sau \u0111\u00f3 th\u1ef1c hi\u1ec7n t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n tr\u00ean m\u1ea3ng c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a $f_1$, do \u0111\u00f3 b\u01b0\u1edbc n\u00e0y c\u00f3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p:</p> $$O\\left(n \\left(\\log m + \\log \\frac{m}{n} \\right) \\right) = O\\left(n \\log m\\right).$$ <p>B\u00e2y gi\u1edd, khi ch\u00fang ta c\u1ed9ng hai \u0111\u1ed9 ph\u1ee9c t\u1ea1p n\u00e0y, ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c $\\log m$ nh\u00e2n v\u1edbi t\u1ed5ng c\u1ee7a $n$ v\u00e0 $m/n$, t\u1ed5ng n\u00e0y l\u00e0 nh\u1ecf nh\u1ea5t khi $n = m/n$, ngh\u0129a l\u00e0, \u0111\u1ec3 \u0111\u1ea1t \u0111\u01b0\u1ee3c hi\u1ec7u su\u1ea5t t\u1ed1i \u01b0u, $n$ n\u00ean \u0111\u01b0\u1ee3c ch\u1ecdn sao cho:</p> $$n = \\sqrt{m}.$$ <p>Khi \u0111\u00f3, \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a thu\u1eadt to\u00e1n tr\u1edf th\u00e0nh:</p> $$O(\\sqrt {m} \\log m).$$","tags":["Translated"]},{"location":"algebra/discrete-log.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"","tags":["Translated"]},{"location":"algebra/discrete-log.html#the-simplest-implementation","title":"C\u00e0i \u0111\u1eb7t \u0111\u01a1n gi\u1ea3n nh\u1ea5t","text":"<p>Trong \u0111o\u1ea1n m\u00e3 sau, h\u00e0m <code>powmod</code> t\u00ednh $a^b \\pmod m$ v\u00e0 h\u00e0m <code>solve</code> \u0111\u01b0a ra m\u1ed9t nghi\u1ec7m th\u00edch h\u1ee3p cho b\u00e0i to\u00e1n. N\u00f3 tr\u1ea3 v\u1ec1 $-1$ n\u1ebfu kh\u00f4ng c\u00f3 nghi\u1ec7m v\u00e0 tr\u1ea3 v\u1ec1 m\u1ed9t trong c\u00e1c nghi\u1ec7m c\u00f3 th\u1ec3 n\u1ebfu ng\u01b0\u1ee3c l\u1ea1i.</p> <pre><code>int powmod(int a, int b, int m) {\n    int res = 1;\n    while (b &gt; 0) {\n        if (b &amp; 1) {\n            res = (res * 1ll * a) % m;\n        }\n        a = (a * 1ll * a) % m;\n        b &gt;&gt;= 1;\n    }\n    return res;\n}\n\nint solve(int a, int b, int m) {\n    a %= m, b %= m;\n    int n = sqrt(m) + 1;\n    map&lt;int, int&gt; vals;\n    for (int p = 1; p &lt;= n; ++p)\n        vals[powmod(a, p * n, m)] = p;\n    for (int q = 0; q &lt;= n; ++q) {\n        int cur = (powmod(a, q, m) * 1ll * b) % m;\n        if (vals.count(cur)) {\n            int ans = vals[cur] * n - q;\n            return ans;\n        }\n    }\n    return -1;\n}\n</code></pre> <p>Trong \u0111o\u1ea1n m\u00e3 n\u00e0y, ch\u00fang t\u00f4i \u0111\u00e3 s\u1eed d\u1ee5ng <code>map</code> t\u1eeb th\u01b0 vi\u1ec7n chu\u1ea9n C++ \u0111\u1ec3 l\u01b0u tr\u1eef c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a $f_1$. B\u00ean trong, <code>map</code> s\u1eed d\u1ee5ng c\u00e2y \u0111\u1ecf-\u0111en \u0111\u1ec3 l\u01b0u tr\u1eef c\u00e1c gi\u00e1 tr\u1ecb. Do \u0111\u00f3, \u0111o\u1ea1n m\u00e3 n\u00e0y ch\u1eadm h\u01a1n m\u1ed9t ch\u00fat so v\u1edbi vi\u1ec7c ch\u00fang ta s\u1eed d\u1ee5ng m\u1ea3ng v\u00e0 t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n, nh\u01b0ng d\u1ec5 vi\u1ebft h\u01a1n nhi\u1ec1u.</p> <p>L\u01b0u \u00fd r\u1eb1ng m\u00e3 c\u1ee7a ch\u00fang t\u00f4i gi\u1ea3 \u0111\u1ecbnh $0^0 = 1$, t\u1ee9c l\u00e0 m\u00e3 s\u1ebd t\u00ednh $0$ l\u00e0 nghi\u1ec7m cho ph\u01b0\u01a1ng tr\u00ecnh $0^x \\equiv 1 \\pmod m$ v\u00e0 c\u0169ng l\u00e0 nghi\u1ec7m cho $0^x \\equiv 0 \\pmod 1$. \u0110\u00e2y l\u00e0 m\u1ed9t quy \u01b0\u1edbc th\u01b0\u1eddng \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng trong \u0111\u1ea1i s\u1ed1, nh\u01b0ng n\u00f3 c\u0169ng kh\u00f4ng \u0111\u01b0\u1ee3c ch\u1ea5p nh\u1eadn r\u1ed9ng r\u00e3i trong t\u1ea5t c\u1ea3 c\u00e1c l\u0129nh v\u1ef1c. \u0110\u00f4i khi $0^0$ \u0111\u01a1n gi\u1ea3n l\u00e0 kh\u00f4ng x\u00e1c \u0111\u1ecbnh. N\u1ebfu b\u1ea1n kh\u00f4ng th\u00edch quy \u01b0\u1edbc c\u1ee7a ch\u00fang t\u00f4i, th\u00ec b\u1ea1n c\u1ea7n x\u1eed l\u00fd tr\u01b0\u1eddng h\u1ee3p $a=0$ ri\u00eang bi\u1ec7t:</p> <pre><code>    if (a == 0)\n        return b == 0 ? 1 : -1;\n</code></pre> <p>M\u1ed9t \u0111i\u1ec1u c\u1ea7n l\u01b0u \u00fd n\u1eefa l\u00e0, n\u1ebfu c\u00f3 nhi\u1ec1u \u0111\u1ed1i s\u1ed1 $p$ \u00e1nh x\u1ea1 \u0111\u1ebfn c\u00f9ng m\u1ed9t gi\u00e1 tr\u1ecb c\u1ee7a $f_1$, ch\u00fang t\u00f4i ch\u1ec9 l\u01b0u tr\u1eef m\u1ed9t \u0111\u1ed1i s\u1ed1 nh\u01b0 v\u1eady. \u0110i\u1ec1u n\u00e0y ho\u1ea1t \u0111\u1ed9ng trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y v\u00ec ch\u00fang t\u00f4i ch\u1ec9 mu\u1ed1n tr\u1ea3 v\u1ec1 m\u1ed9t nghi\u1ec7m c\u00f3 th\u1ec3. N\u1ebfu ch\u00fang t\u00f4i c\u1ea7n tr\u1ea3 v\u1ec1 t\u1ea5t c\u1ea3 c\u00e1c nghi\u1ec7m c\u00f3 th\u1ec3, ch\u00fang t\u00f4i c\u1ea7n thay \u0111\u1ed5i <code>map&lt;int, int&gt;</code> th\u00e0nh, gi\u1ea3 s\u1eed, <code>map&lt;int, vector&lt;int&gt;&gt;</code>. Ch\u00fang t\u00f4i c\u0169ng c\u1ea7n thay \u0111\u1ed5i b\u01b0\u1edbc th\u1ee9 hai cho ph\u00f9 h\u1ee3p.</p>","tags":["Translated"]},{"location":"algebra/discrete-log.html#improved-implementation","title":"C\u00e0i \u0111\u1eb7t c\u1ea3i ti\u1ebfn","text":"<p>M\u1ed9t c\u1ea3i ti\u1ebfn kh\u1ea3 thi l\u00e0 lo\u1ea1i b\u1ecf l\u0169y th\u1eeba nh\u1ecb ph\u00e2n. \u0110i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n b\u1eb1ng c\u00e1ch gi\u1eef m\u1ed9t bi\u1ebfn \u0111\u01b0\u1ee3c nh\u00e2n v\u1edbi $a$ m\u1ed7i khi ch\u00fang ta t\u0103ng $q$ v\u00e0 m\u1ed9t bi\u1ebfn \u0111\u01b0\u1ee3c nh\u00e2n v\u1edbi $a^n$ m\u1ed7i khi ch\u00fang ta t\u0103ng $p$. V\u1edbi s\u1ef1 thay \u0111\u1ed5i n\u00e0y, \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a thu\u1eadt to\u00e1n v\u1eabn nh\u01b0 c\u0169, nh\u01b0ng b\u00e2y gi\u1edd h\u1ec7 s\u1ed1 $\\log$ ch\u1ec9 d\u00e0nh cho <code>map</code>. Thay v\u00ec <code>map</code>, ch\u00fang ta c\u0169ng c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng b\u1ea3ng b\u0103m (<code>unordered_map</code> trong C++) c\u00f3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian trung b\u00ecnh $O(1)$ cho vi\u1ec7c ch\u00e8n v\u00e0 t\u00ecm ki\u1ebfm.</p> <p>C\u00e1c b\u00e0i to\u00e1n th\u01b0\u1eddng y\u00eau c\u1ea7u t\u00ecm $x$ nh\u1ecf nh\u1ea5t th\u1ecfa m\u00e3n nghi\u1ec7m. C\u00f3 th\u1ec3 l\u1ea5y t\u1ea5t c\u1ea3 c\u00e1c c\u00e2u tr\u1ea3 l\u1eddi v\u00e0 l\u1ea5y gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t, ho\u1eb7c gi\u1ea3m c\u00e2u tr\u1ea3 l\u1eddi \u0111\u1ea7u ti\u00ean t\u00ecm \u0111\u01b0\u1ee3c b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng \u0110\u1ecbnh l\u00fd Euler, nh\u01b0ng ch\u00fang ta c\u00f3 th\u1ec3 th\u00f4ng minh v\u1ec1 th\u1ee9 t\u1ef1 t\u00ednh to\u00e1n c\u00e1c gi\u00e1 tr\u1ecb v\u00e0 \u0111\u1ea3m b\u1ea3o c\u00e2u tr\u1ea3 l\u1eddi \u0111\u1ea7u ti\u00ean ch\u00fang ta t\u00ecm th\u1ea5y l\u00e0 nh\u1ecf nh\u1ea5t.</p> <pre><code>// Returns minimum x for which a ^ x % m = b % m, a and m are coprime.\nint solve(int a, int b, int m) {\n    a %= m, b %= m;\n    int n = sqrt(m) + 1;\n\n    int an = 1;\n    for (int i = 0; i &lt; n; ++i)\n        an = (an * 1ll * a) % m;\n\n    unordered_map&lt;int, int&gt; vals;\n    for (int q = 0, cur = b; q &lt;= n; ++q) {\n        vals[cur] = q;\n        cur = (cur * 1ll * a) % m;\n    }\n\n    for (int p = 1, cur = 1; p &lt;= n; ++p) {\n        cur = (cur * 1ll * an) % m;\n        if (vals.count(cur)) {\n            int ans = n * p - vals[cur];\n            return ans;\n        }\n    }\n    return -1;\n}\n</code></pre> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p l\u00e0 $O(\\sqrt{m})$ s\u1eed d\u1ee5ng <code>unordered_map</code>.</p>","tags":["Translated"]},{"location":"algebra/discrete-log.html#when-a-and-m-are-not-coprime","title":"Khi $a$ v\u00e0 $m$ kh\u00f4ng nguy\u00ean t\u1ed1 c\u00f9ng nhau","text":"<p>G\u1ecdi $g = \\gcd(a, m)$, v\u00e0 $g &gt; 1$. R\u00f5 r\u00e0ng $a^x \\bmod m$ v\u1edbi m\u1ecdi $x \\ge 1$ s\u1ebd chia h\u1ebft cho $g$.</p> <p>N\u1ebfu $g \\nmid b$, kh\u00f4ng c\u00f3 nghi\u1ec7m cho $x$.</p> <p>N\u1ebfu $g \\mid b$, \u0111\u1eb7t $a = g \\alpha, b = g \\beta, m = g \\nu$.</p> $$ \\begin{aligned} a^x &amp; \\equiv b \\mod m \\\\\\ (g \\alpha) a^{x - 1} &amp; \\equiv g \\beta \\mod g \\nu \\\\\\ \\alpha a^{x-1} &amp; \\equiv \\beta \\mod \\nu \\end{aligned} $$ <p>Thu\u1eadt to\u00e1n baby-step giant-step c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng \u0111\u01b0\u1ee3c m\u1edf r\u1ed9ng \u0111\u1ec3 gi\u1ea3i $ka^{x} \\equiv b \\pmod m$ cho $x$.</p> <pre><code>// Returns minimum x for which a ^ x % m = b % m.\nint solve(int a, int b, int m) {\n    a %= m, b %= m;\n    int k = 1, add = 0, g;\n    while ((g = gcd(a, m)) &gt; 1) {\n        if (b == k)\n            return add;\n        if (b % g)\n            return -1;\n        b /= g, m /= g, ++add;\n        k = (k * 1ll * a / g) % m;\n    }\n\n    int n = sqrt(m) + 1;\n    int an = 1;\n    for (int i = 0; i &lt; n; ++i)\n        an = (an * 1ll * a) % m;\n\n    unordered_map&lt;int, int&gt; vals;\n    for (int q = 0, cur = b; q &lt;= n; ++q) {\n        vals[cur] = q;\n        cur = (cur * 1ll * a) % m;\n    }\n\n    for (int p = 1, cur = k; p &lt;= n; ++p) {\n        cur = (cur * 1ll * an) % m;\n        if (vals.count(cur)) {\n            int ans = n * p - vals[cur] + add;\n            return ans;\n        }\n    }\n    return -1;\n}\n</code></pre> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian v\u1eabn l\u00e0 $O(\\sqrt{m})$ nh\u01b0 tr\u01b0\u1edbc v\u00ec b\u01b0\u1edbc gi\u1ea3m ban \u0111\u1ea7u th\u00e0nh $a$ v\u00e0 $m$ nguy\u00ean t\u1ed1 c\u00f9ng nhau \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong $O(\\log^2 m)$.</p>","tags":["Translated"]},{"location":"algebra/discrete-log.html#practice-problems","title":"B\u00e0i t\u1eadp luy\u1ec7n t\u1eadp","text":"<ul> <li>Spoj - Power Modulo Inverted</li> <li>Topcoder - SplittingFoxes3</li> <li>CodeChef - Inverse of a Function</li> <li>Hard Equation (gi\u1ea3 s\u1eed r\u1eb1ng $0^0$ l\u00e0 kh\u00f4ng x\u00e1c \u0111\u1ecbnh)</li> <li>CodeChef - Chef and Modular Sequence</li> </ul>","tags":["Translated"]},{"location":"algebra/discrete-log.html#references","title":"Tham kh\u1ea3o","text":"<ul> <li>Wikipedia - Baby-step giant-step</li> <li>Answer by Zander on Mathematics StackExchange</li> </ul>","tags":["Translated"]},{"location":"algebra/discrete-log.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 228</li> <li>Translated lines: 228</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Translated"]},{"location":"algebra/discrete-root.html","title":"C\u0103n r\u1eddi r\u1ea1c (Discrete Root)","text":"<p>B\u00e0i to\u00e1n t\u00ecm c\u0103n r\u1eddi r\u1ea1c \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a nh\u01b0 sau. Cho s\u1ed1 nguy\u00ean t\u1ed1 $n$ v\u00e0 hai s\u1ed1 nguy\u00ean $a$ v\u00e0 $k$, t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c $x$ sao cho:</p> <p>$x^k \\equiv a \\pmod n$</p>","tags":["Translated"]},{"location":"algebra/discrete-root.html#the-algorithm","title":"Thu\u1eadt to\u00e1n (The algorithm)","text":"<p>Ch\u00fang ta s\u1ebd gi\u1ea3i b\u00e0i to\u00e1n n\u00e0y b\u1eb1ng c\u00e1ch \u0111\u01b0a n\u00f3 v\u1ec1 b\u00e0i to\u00e1n logarit r\u1eddi r\u1ea1c.</p> <p>H\u00e3y \u00e1p d\u1ee5ng kh\u00e1i ni\u1ec7m c\u0103n nguy\u00ean th\u1ee7y modulo $n$. G\u1ecdi $g$ l\u00e0 m\u1ed9t c\u0103n nguy\u00ean th\u1ee7y modulo $n$. L\u01b0u \u00fd r\u1eb1ng v\u00ec $n$ l\u00e0 s\u1ed1 nguy\u00ean t\u1ed1, n\u00f3 ph\u1ea3i t\u1ed3n t\u1ea1i, v\u00e0 n\u00f3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y trong $O(Ans \\cdot \\log \\phi (n) \\cdot \\log n) = O(Ans \\cdot \\log^2 n)$ c\u1ed9ng v\u1edbi th\u1eddi gian ph\u00e2n t\u00edch th\u1eeba s\u1ed1 $\\phi (n)$.</p> <p>Ch\u00fang ta c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng lo\u1ea1i b\u1ecf tr\u01b0\u1eddng h\u1ee3p $a = 0$. Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, r\u00f5 r\u00e0ng ch\u1ec9 c\u00f3 m\u1ed9t c\u00e2u tr\u1ea3 l\u1eddi: $x = 0$.</p> <p>V\u00ec ch\u00fang ta bi\u1ebft r\u1eb1ng $n$ l\u00e0 s\u1ed1 nguy\u00ean t\u1ed1 v\u00e0 b\u1ea5t k\u1ef3 s\u1ed1 n\u00e0o gi\u1eefa 1 v\u00e0 $n-1$ \u0111\u1ec1u c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n d\u01b0\u1edbi d\u1ea1ng l\u0169y th\u1eeba c\u1ee7a c\u0103n nguy\u00ean th\u1ee7y, ch\u00fang ta c\u00f3 th\u1ec3 bi\u1ec3u di\u1ec5n b\u00e0i to\u00e1n c\u0103n r\u1eddi r\u1ea1c nh\u01b0 sau:</p> <p>$(g^y)^k \\equiv a \\pmod n$</p> <p>trong \u0111\u00f3</p> <p>$x \\equiv g^y \\pmod n$</p> <p>\u0110i\u1ec1u n\u00e0y, \u0111\u1ebfn l\u01b0\u1ee3t n\u00f3, c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c vi\u1ebft l\u1ea1i th\u00e0nh</p> <p>$(g^k)^y \\equiv a \\pmod n$</p> <p>B\u00e2y gi\u1edd ch\u00fang ta c\u00f3 m\u1ed9t \u1ea9n $y$, \u0111\u00e2y l\u00e0 b\u00e0i to\u00e1n logarit r\u1eddi r\u1ea1c. Nghi\u1ec7m c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng thu\u1eadt to\u00e1n baby-step giant-step c\u1ee7a Shanks trong $O(\\sqrt {n} \\log n)$ (ho\u1eb7c ch\u00fang ta c\u00f3 th\u1ec3 x\u00e1c minh r\u1eb1ng kh\u00f4ng c\u00f3 nghi\u1ec7m n\u00e0o).</p> <p>Sau khi t\u00ecm th\u1ea5y m\u1ed9t nghi\u1ec7m $y_0$, m\u1ed9t trong c\u00e1c nghi\u1ec7m c\u1ee7a b\u00e0i to\u00e1n c\u0103n r\u1eddi r\u1ea1c s\u1ebd l\u00e0 $x_0 = g^{y_0} \\pmod n$.</p>","tags":["Translated"]},{"location":"algebra/discrete-root.html#finding-all-solutions-from-one-known-solution","title":"T\u00ecm t\u1ea5t c\u1ea3 nghi\u1ec7m t\u1eeb m\u1ed9t nghi\u1ec7m \u0111\u00e3 bi\u1ebft","text":"<p>\u0110\u1ec3 gi\u1ea3i b\u00e0i to\u00e1n \u0111\u00e3 cho m\u1ed9t c\u00e1ch \u0111\u1ea7y \u0111\u1ee7, ch\u00fang ta c\u1ea7n t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c nghi\u1ec7m khi bi\u1ebft m\u1ed9t trong s\u1ed1 ch\u00fang: $x_0 = g^{y_0} \\pmod n$.</p> <p>H\u00e3y nh\u1edb l\u1ea1i th\u1ef1c t\u1ebf r\u1eb1ng m\u1ed9t c\u0103n nguy\u00ean th\u1ee7y lu\u00f4n c\u00f3 c\u1ea5p l\u00e0 $\\phi (n)$, t\u1ee9c l\u00e0 l\u0169y th\u1eeba nh\u1ecf nh\u1ea5t c\u1ee7a $g$ cho k\u1ebft qu\u1ea3 1 l\u00e0 $\\phi (n)$. Do \u0111\u00f3, n\u1ebfu ch\u00fang ta th\u00eam s\u1ed1 h\u1ea1ng $\\phi (n)$ v\u00e0o s\u1ed1 m\u0169, ch\u00fang ta v\u1eabn nh\u1eadn \u0111\u01b0\u1ee3c c\u00f9ng m\u1ed9t gi\u00e1 tr\u1ecb:</p> <p>$x^k \\equiv g^{ y_0 \\cdot k + l \\cdot \\phi (n)} \\equiv a \\pmod n \\forall l \\in Z$</p> <p>Do \u0111\u00f3, t\u1ea5t c\u1ea3 c\u00e1c nghi\u1ec7m \u0111\u1ec1u c\u00f3 d\u1ea1ng:</p> <p>$x = g^{y_0 + \\frac {l \\cdot \\phi (n)}{k}} \\pmod n \\forall l \\in Z$.</p> <p>trong \u0111\u00f3 $l$ \u0111\u01b0\u1ee3c ch\u1ecdn sao cho ph\u00e2n s\u1ed1 ph\u1ea3i l\u00e0 m\u1ed9t s\u1ed1 nguy\u00ean. \u0110\u1ec3 \u0111i\u1ec1u n\u00e0y \u0111\u00fang, t\u1eed s\u1ed1 ph\u1ea3i chia h\u1ebft cho b\u1ed9i chung nh\u1ecf nh\u1ea5t c\u1ee7a $\\phi (n)$ v\u00e0 $k$. H\u00e3y nh\u1edb r\u1eb1ng b\u1ed9i chung nh\u1ecf nh\u1ea5t c\u1ee7a hai s\u1ed1 $lcm(a, b) = \\frac{a \\cdot b}{gcd(a, b)}$; ch\u00fang ta s\u1ebd nh\u1eadn \u0111\u01b0\u1ee3c</p> <p>$x = g^{y_0 + i \\frac {\\phi (n)}{gcd(k, \\phi (n))}} \\pmod n \\forall i \\in Z$.</p> <p>\u0110\u00e2y l\u00e0 c\u00f4ng th\u1ee9c cu\u1ed1i c\u00f9ng cho t\u1ea5t c\u1ea3 c\u00e1c nghi\u1ec7m c\u1ee7a b\u00e0i to\u00e1n c\u0103n r\u1eddi r\u1ea1c.</p>","tags":["Translated"]},{"location":"algebra/discrete-root.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u1ed9t c\u00e0i \u0111\u1eb7t \u0111\u1ea7y \u0111\u1ee7, bao g\u1ed3m c\u00e1c th\u1ee7 t\u1ee5c t\u00ecm c\u0103n nguy\u00ean th\u1ee7y, logarit r\u1eddi r\u1ea1c v\u00e0 t\u00ecm v\u00e0 in t\u1ea5t c\u1ea3 c\u00e1c nghi\u1ec7m.</p> <pre><code>int gcd(int a, int b) {\n    return a ? gcd(b % a, a) : b;\n}\n\nint powmod(int a, int b, int p) {\n    int res = 1;\n    while (b &gt; 0) {\n        if (b &amp; 1) {\n            res = res * a % p;\n        }\n        a = a * a % p;\n        b &gt;&gt;= 1;\n    }\n    return res;\n}\n\n// Finds the primitive root modulo p\nint generator(int p) {\n    vector&lt;int&gt; fact;\n    int phi = p-1, n = phi;\n    for (int i = 2; i * i &lt;= n; ++i) {\n        if (n % i == 0) {\n            fact.push_back(i);\n            while (n % i == 0)\n                n /= i;\n        }\n    }\n    if (n &gt; 1)\n        fact.push_back(n);\n\n    for (int res = 2; res &lt;= p; ++res) {\n        bool ok = true;\n        for (int factor : fact) {\n            if (powmod(res, phi / factor, p) == 1) {\n                ok = false;\n                break;\n            }\n        }\n        if (ok) return res;\n    }\n    return -1;\n}\n\n// This program finds all numbers x such that x^k = a (mod n)\nint main() {\n    int n, k, a;\n    scanf(\"%d %d %d\", &amp;n, &amp;k, &amp;a);\n    if (a == 0) {\n        puts(\"1\\n0\");\n        return 0;\n    }\n\n    int g = generator(n);\n\n    // Baby-step giant-step discrete logarithm algorithm\n    int sq = (int) sqrt (n + .0) + 1;\n    vector&lt;pair&lt;int, int&gt;&gt; dec(sq);\n    for (int i = 1; i &lt;= sq; ++i)\n        dec[i-1] = {powmod(g, i * sq * k % (n - 1), n), i};\n    sort(dec.begin(), dec.end());\n    int any_ans = -1;\n    for (int i = 0; i &lt; sq; ++i) {\n        int my = powmod(g, i * k % (n - 1), n) * a % n;\n        auto it = lower_bound(dec.begin(), dec.end(), make_pair(my, 0));\n        if (it != dec.end() &amp;&amp; it-&gt;first == my) {\n            any_ans = it-&gt;second * sq - i;\n            break;\n        }\n    }\n    if (any_ans == -1) {\n        puts(\"0\");\n        return 0;\n    }\n\n    // Print all possible answers\n    int delta = (n-1) / gcd(k, n-1);\n    vector&lt;int&gt; ans;\n    for (int cur = any_ans % delta; cur &lt; n-1; cur += delta)\n        ans.push_back(powmod(g, cur, n));\n    sort(ans.begin(), ans.end());\n    printf(\"%d\\n\", ans.size());\n    for (int answer : ans)\n        printf(\"%d \", answer);\n}\n</code></pre>","tags":["Translated"]},{"location":"algebra/discrete-root.html#practice-problems","title":"B\u00e0i t\u1eadp luy\u1ec7n t\u1eadp","text":"<ul> <li>Codeforces - Lunar New Year and a Recursive Sequence</li> </ul>","tags":["Translated"]},{"location":"algebra/discrete-root.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 149</li> <li>Translated lines: 149</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Translated"]},{"location":"algebra/divisors.html","title":"S\u1ed1 l\u01b0\u1ee3ng \u01b0\u1edbc / T\u1ed5ng c\u00e1c \u01b0\u1edbc (Number of divisors / sum of divisors)","text":"<p>Trong b\u00e0i vi\u1ebft n\u00e0y, ch\u00fang ta th\u1ea3o lu\u1eadn v\u1ec1 c\u00e1ch t\u00ednh s\u1ed1 l\u01b0\u1ee3ng \u01b0\u1edbc $d(n)$ v\u00e0 t\u1ed5ng c\u00e1c \u01b0\u1edbc $\\sigma(n)$ c\u1ee7a m\u1ed9t s\u1ed1 $n$ \u0111\u00e3 cho.</p>","tags":["Original"]},{"location":"algebra/divisors.html#number-of-divisors","title":"S\u1ed1 l\u01b0\u1ee3ng \u01b0\u1edbc (Number of divisors)","text":"<p>R\u00f5 r\u00e0ng r\u1eb1ng ph\u00e2n t\u00edch th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1 c\u1ee7a m\u1ed9t \u01b0\u1edbc $d$ ph\u1ea3i l\u00e0 m\u1ed9t t\u1eadp con c\u1ee7a ph\u00e2n t\u00edch th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1 c\u1ee7a $n$, v.d. $6 = 2 \\cdot 3$ l\u00e0 m\u1ed9t \u01b0\u1edbc c\u1ee7a $60 = 2^2 \\cdot 3 \\cdot 5$. V\u00ec v\u1eady, ch\u00fang ta ch\u1ec9 c\u1ea7n t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c t\u1eadp con kh\u00e1c nhau c\u1ee7a ph\u00e2n t\u00edch th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1 c\u1ee7a $n$.</p> <p>Th\u00f4ng th\u01b0\u1eddng, s\u1ed1 l\u01b0\u1ee3ng t\u1eadp con l\u00e0 $2^x$ cho m\u1ed9t t\u1eadp h\u1ee3p c\u00f3 $x$ ph\u1ea7n t\u1eed. Tuy nhi\u00ean, \u0111i\u1ec1u n\u00e0y kh\u00f4ng c\u00f2n \u0111\u00fang n\u1eefa n\u1ebfu c\u00f3 c\u00e1c ph\u1ea7n t\u1eed l\u1eb7p l\u1ea1i trong t\u1eadp h\u1ee3p. Trong tr\u01b0\u1eddng h\u1ee3p c\u1ee7a ch\u00fang ta, m\u1ed9t s\u1ed1 th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1 c\u00f3 th\u1ec3 xu\u1ea5t hi\u1ec7n nhi\u1ec1u l\u1ea7n trong ph\u00e2n t\u00edch th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1 c\u1ee7a $n$.</p> <p>N\u1ebfu m\u1ed9t th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1 $p$ xu\u1ea5t hi\u1ec7n $e$ l\u1ea7n trong ph\u00e2n t\u00edch th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1 c\u1ee7a $n$, th\u00ec ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng th\u1eeba s\u1ed1 $p$ t\u1ed1i \u0111a $e$ l\u1ea7n trong t\u1eadp con. \u0110i\u1ec1u \u0111\u00f3 c\u00f3 ngh\u0129a l\u00e0 ch\u00fang ta c\u00f3 $e+1$ l\u1ef1a ch\u1ecdn.</p> <p>Do \u0111\u00f3, n\u1ebfu ph\u00e2n t\u00edch th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1 c\u1ee7a $n$ l\u00e0 $p_1^{e_1} \\cdot p_2^{e_2} \\cdots p_k^{e_k}$, trong \u0111\u00f3 $p_i$ l\u00e0 c\u00e1c s\u1ed1 nguy\u00ean t\u1ed1 ph\u00e2n bi\u1ec7t, th\u00ec s\u1ed1 l\u01b0\u1ee3ng \u01b0\u1edbc l\u00e0:</p> $$d(n) = (e_1 + 1) \\cdot (e_2 + 1) \\cdots (e_k + 1)$$ <p>M\u1ed9t c\u00e1ch suy ngh\u0129 v\u1ec1 n\u00f3 l\u00e0 nh\u01b0 sau:</p> <ul> <li> <p>N\u1ebfu ch\u1ec9 c\u00f3 m\u1ed9t \u01b0\u1edbc nguy\u00ean t\u1ed1 ph\u00e2n bi\u1ec7t $n = p_1^{e_1}$, th\u00ec r\u00f5 r\u00e0ng c\u00f3 $e_1 + 1$ \u01b0\u1edbc ($1, p_1, p_1^2, \\dots, p_1^{e_1}$).</p> </li> <li> <p>N\u1ebfu c\u00f3 hai \u01b0\u1edbc nguy\u00ean t\u1ed1 ph\u00e2n bi\u1ec7t $n = p_1^{e_1} \\cdot p_2^{e_2}$, th\u00ec b\u1ea1n c\u00f3 th\u1ec3 s\u1eafp x\u1ebfp t\u1ea5t c\u1ea3 c\u00e1c \u01b0\u1edbc d\u01b0\u1edbi d\u1ea1ng b\u1ea3ng.</p> </li> </ul> $$\\begin{array}{c|ccccc} &amp; 1 &amp; p_2 &amp; p_2^2 &amp; \\dots &amp; p_2^{e_2} \\\\\\\\\\hline 1 &amp; 1 &amp; p_2 &amp; p_2^2 &amp; \\dots &amp; p_2^{e_2} \\\\\\\\ p_1 &amp; p_1 &amp; p_1 \\cdot p_2 &amp; p_1 \\cdot p_2^2 &amp; \\dots &amp; p_1 \\cdot p_2^{e_2} \\\\\\\\ p_1^2 &amp; p_1^2 &amp; p_1^2 \\cdot p_2 &amp; p_1^2 \\cdot p_2^2 &amp; \\dots &amp; p_1^2 \\cdot p_2^{e_2} \\\\\\\\ \\vdots &amp; \\vdots &amp; \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\\\\\ p_1^{e_1} &amp; p_1^{e_1} &amp; p_1^{e_1} \\cdot p_2 &amp; p_1^{e_1} \\cdot p_2^2 &amp; \\dots &amp; p_1^{e_1} \\cdot p_2^{e_2} \\\\\\\\ \\end{array}$$ <p>V\u00ec v\u1eady, s\u1ed1 l\u01b0\u1ee3ng \u01b0\u1edbc l\u00e0 t\u1ea7m th\u01b0\u1eddng $(e_1 + 1) \\cdot (e_2 + 1)$.</p> <ul> <li>M\u1ed9t l\u1eadp lu\u1eadn t\u01b0\u01a1ng t\u1ef1 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c \u0111\u01b0a ra n\u1ebfu c\u00f3 nhi\u1ec1u h\u01a1n hai th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1 ph\u00e2n bi\u1ec7t.</li> </ul> <pre><code>long long numberOfDivisors(long long num) {\n    long long total = 1;\n    for (int i = 2; (long long)i * i &lt;= num; i++) {\n        if (num % i == 0) {\n            int e = 0;\n            do {\n                e++;\n                num /= i;\n            } while (num % i == 0);\n            total *= e + 1;\n        }\n    }\n    if (num &gt; 1) {\n        total *= 2;\n    }\n    return total;\n}\n</code></pre>","tags":["Original"]},{"location":"algebra/divisors.html#sum-of-divisors","title":"T\u1ed5ng c\u00e1c \u01b0\u1edbc (Sum of divisors)","text":"<p>Ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng c\u00f9ng m\u1ed9t l\u1eadp lu\u1eadn c\u1ee7a ph\u1ea7n tr\u01b0\u1edbc.</p> <ul> <li>N\u1ebfu ch\u1ec9 c\u00f3 m\u1ed9t \u01b0\u1edbc nguy\u00ean t\u1ed1 ph\u00e2n bi\u1ec7t $n = p_1^{e_1}$, th\u00ec t\u1ed5ng l\u00e0:</li> </ul> $$1 + p_1 + p_1^2 + \\dots + p_1^{e_1} = \\frac{p_1^{e_1 + 1} - 1}{p_1 - 1}$$ <ul> <li>N\u1ebfu c\u00f3 hai \u01b0\u1edbc nguy\u00ean t\u1ed1 ph\u00e2n bi\u1ec7t $n = p_1^{e_1} \\cdot p_2^{e_2}$, th\u00ec ch\u00fang ta c\u00f3 th\u1ec3 t\u1ea1o c\u00f9ng m\u1ed9t b\u1ea3ng nh\u01b0 tr\u01b0\u1edbc.   S\u1ef1 kh\u00e1c bi\u1ec7t duy nh\u1ea5t l\u00e0 b\u00e2y gi\u1edd ch\u00fang ta mu\u1ed1n t\u00ednh t\u1ed5ng thay v\u00ec \u0111\u1ebfm c\u00e1c ph\u1ea7n t\u1eed.   D\u1ec5 th\u1ea5y r\u1eb1ng, t\u1ed5ng c\u1ee7a m\u1ed7i t\u1ed5 h\u1ee3p c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n nh\u01b0 sau:</li> </ul> $$\\left(1 + p_1 + p_1^2 + \\dots + p_1^{e_1}\\right) \\cdot \\left(1 + p_2 + p_2^2 + \\dots + p_2^{e_2}\\right)$$ $$ = \\frac{p_1^{e_1 + 1} - 1}{p_1 - 1} \\cdot \\frac{p_2^{e_2 + 1} - 1}{p_2 - 1}$$ <ul> <li>T\u1ed5ng qu\u00e1t, v\u1edbi $n = p_1^{e_1} \\cdot p_2^{e_2} \\cdots p_k^{e_k}$ ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c c\u00f4ng th\u1ee9c:</li> </ul> $$\\sigma(n) = \\frac{p_1^{e_1 + 1} - 1}{p_1 - 1} \\cdot \\frac{p_2^{e_2 + 1} - 1}{p_2 - 1} \\cdots \\frac{p_k^{e_k + 1} - 1}{p_k - 1}$$ <pre><code>long long SumOfDivisors(long long num) {\n    long long total = 1;\n\n    for (int i = 2; (long long)i * i &lt;= num; i++) {\n        if (num % i == 0) {\n            int e = 0;\n            do {\n                e++;\n                num /= i;\n            } while (num % i == 0);\n\n            long long sum = 0, pow = 1;\n            do {\n                sum += pow;\n                pow *= i;\n            } while (e-- &gt; 0);\n            total *= sum;\n        }\n    }\n    if (num &gt; 1) {\n        total *= (1 + num);\n    }\n    return total;\n}\n</code></pre>","tags":["Original"]},{"location":"algebra/divisors.html#multiplicative-functions","title":"H\u00e0m nh\u00e2n t\u00ednh (Multiplicative functions)","text":"<p>M\u1ed9t h\u00e0m nh\u00e2n t\u00ednh l\u00e0 m\u1ed9t h\u00e0m $f(x)$ th\u1ecfa m\u00e3n</p> $$f(a \\cdot b) = f(a) \\cdot f(b)$$ <p>n\u1ebfu $a$ v\u00e0 $b$ nguy\u00ean t\u1ed1 c\u00f9ng nhau.</p> <p>C\u1ea3 $d(n)$ v\u00e0 $\\sigma(n)$ \u0111\u1ec1u l\u00e0 c\u00e1c h\u00e0m nh\u00e2n t\u00ednh.</p> <p>C\u00e1c h\u00e0m nh\u00e2n t\u00ednh c\u00f3 r\u1ea5t nhi\u1ec1u t\u00ednh ch\u1ea5t th\u00fa v\u1ecb, c\u00f3 th\u1ec3 r\u1ea5t h\u1eefu \u00edch trong c\u00e1c b\u00e0i to\u00e1n l\u00fd thuy\u1ebft s\u1ed1. V\u00ed d\u1ee5, t\u00edch ch\u1eadp Dirichlet c\u1ee7a hai h\u00e0m nh\u00e2n t\u00ednh c\u0169ng l\u00e0 m\u1ed9t h\u00e0m nh\u00e2n t\u00ednh.</p>","tags":["Original"]},{"location":"algebra/divisors.html#practice-problems","title":"B\u00e0i t\u1eadp luy\u1ec7n t\u1eadp","text":"<ul> <li>SPOJ - COMDIV</li> <li>SPOJ - DIVSUM</li> <li>SPOJ - DIVSUM2</li> </ul>","tags":["Original"]},{"location":"algebra/divisors.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 130</li> <li>Translated lines: 130</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Original"]},{"location":"algebra/euclid-algorithm.html","title":"Thu\u1eadt to\u00e1n Euclid \u0111\u1ec3 t\u00ednh \u01b0\u1edbc chung l\u1edbn nh\u1ea5t (Euclidean algorithm for computing the greatest common divisor)","text":"<p>Cho hai s\u1ed1 nguy\u00ean kh\u00f4ng \u00e2m $a$ v\u00e0 $b$, ch\u00fang ta ph\u1ea3i t\u00ecm GCD (\u01b0\u1edbc chung l\u1edbn nh\u1ea5t) c\u1ee7a ch\u00fang, t\u1ee9c l\u00e0 s\u1ed1 l\u1edbn nh\u1ea5t l\u00e0 \u01b0\u1edbc c\u1ee7a c\u1ea3 $a$ v\u00e0 $b$. N\u00f3 th\u01b0\u1eddng \u0111\u01b0\u1ee3c k\u00fd hi\u1ec7u l\u00e0 $\\gcd(a, b)$. V\u1ec1 m\u1eb7t to\u00e1n h\u1ecdc n\u00f3 \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a l\u00e0:</p> $$\\gcd(a, b) = \\max \\{k &gt; 0 : (k \\mid a) \\text{ v\u00e0 } (k \\mid b) \\}$$ <p>(\u1edf \u0111\u00e2y k\u00fd hi\u1ec7u \"$\\mid$\" bi\u1ec3u th\u1ecb t\u00ednh chia h\u1ebft, t\u1ee9c l\u00e0 \"$k \\mid a$\" c\u00f3 ngh\u0129a l\u00e0 \"$k$ chia h\u1ebft cho $a$\")</p> <p>Khi m\u1ed9t trong c\u00e1c s\u1ed1 b\u1eb1ng kh\u00f4ng, trong khi s\u1ed1 kia kh\u00e1c kh\u00f4ng, \u01b0\u1edbc chung l\u1edbn nh\u1ea5t c\u1ee7a ch\u00fang, theo \u0111\u1ecbnh ngh\u0129a, l\u00e0 s\u1ed1 th\u1ee9 hai. Khi c\u1ea3 hai s\u1ed1 \u0111\u1ec1u b\u1eb1ng kh\u00f4ng, \u01b0\u1edbc chung l\u1edbn nh\u1ea5t c\u1ee7a ch\u00fang kh\u00f4ng x\u00e1c \u0111\u1ecbnh (n\u00f3 c\u00f3 th\u1ec3 l\u00e0 b\u1ea5t k\u1ef3 s\u1ed1 n\u00e0o l\u1edbn t\u00f9y \u00fd), nh\u01b0ng thu\u1eadn ti\u1ec7n khi \u0111\u1ecbnh ngh\u0129a n\u00f3 c\u0169ng b\u1eb1ng kh\u00f4ng \u0111\u1ec3 b\u1ea3o to\u00e0n t\u00ednh k\u1ebft h\u1ee3p c\u1ee7a $\\gcd$. \u0110i\u1ec1u n\u00e0y mang l\u1ea1i cho ch\u00fang ta m\u1ed9t quy t\u1eafc \u0111\u01a1n gi\u1ea3n: n\u1ebfu m\u1ed9t trong c\u00e1c s\u1ed1 b\u1eb1ng kh\u00f4ng, \u01b0\u1edbc chung l\u1edbn nh\u1ea5t l\u00e0 s\u1ed1 kia.</p> <p>Thu\u1eadt to\u00e1n Euclid, \u0111\u01b0\u1ee3c th\u1ea3o lu\u1eadn d\u01b0\u1edbi \u0111\u00e2y, cho ph\u00e9p t\u00ecm \u01b0\u1edbc chung l\u1edbn nh\u1ea5t c\u1ee7a hai s\u1ed1 $a$ v\u00e0 $b$ trong $O(\\log \\min(a, b))$. V\u00ec h\u00e0m n\u00e0y c\u00f3 t\u00ednh k\u1ebft h\u1ee3p, \u0111\u1ec3 t\u00ecm GCD c\u1ee7a nhi\u1ec1u h\u01a1n hai s\u1ed1, ch\u00fang ta c\u00f3 th\u1ec3 l\u00e0m $\\gcd(a, b, c) = \\gcd(a, \\gcd(b, c))$ v\u00e0 c\u1ee9 th\u1ebf.</p> <p>Thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 l\u1ea7n \u0111\u1ea7u ti\u00ean trong \"C\u01a1 s\u1edf\" c\u1ee7a Euclid (kho\u1ea3ng 300 tr\u01b0\u1edbc C\u00f4ng nguy\u00ean), nh\u01b0ng c\u00f3 th\u1ec3 thu\u1eadt to\u00e1n c\u00f3 ngu\u1ed3n g\u1ed1c s\u1edbm h\u01a1n n\u1eefa.</p>","tags":["Translated"]},{"location":"algebra/euclid-algorithm.html#algorithm","title":"Thu\u1eadt to\u00e1n (Algorithm)","text":"<p>Ban \u0111\u1ea7u, thu\u1eadt to\u00e1n Euclid \u0111\u01b0\u1ee3c ph\u00e1t bi\u1ec3u nh\u01b0 sau: tr\u1eeb s\u1ed1 nh\u1ecf h\u01a1n kh\u1ecfi s\u1ed1 l\u1edbn h\u01a1n cho \u0111\u1ebfn khi m\u1ed9t trong c\u00e1c s\u1ed1 b\u1eb1ng kh\u00f4ng. Th\u1eadt v\u1eady, n\u1ebfu $g$ chia h\u1ebft cho $a$ v\u00e0 $b$, n\u00f3 c\u0169ng chia h\u1ebft cho $a-b$. M\u1eb7t kh\u00e1c, n\u1ebfu $g$ chia h\u1ebft cho $a-b$ v\u00e0 $b$, th\u00ec n\u00f3 c\u0169ng chia h\u1ebft cho $a = b + (a-b)$, \u0111i\u1ec1u \u0111\u00f3 c\u00f3 ngh\u0129a l\u00e0 t\u1eadp h\u1ee3p c\u00e1c \u01b0\u1edbc chung c\u1ee7a $\\{a, b\\}$ v\u00e0 $\\{b,a-b\\}$ tr\u00f9ng nhau.</p> <p>L\u01b0u \u00fd r\u1eb1ng $a$ v\u1eabn l\u00e0 s\u1ed1 l\u1edbn h\u01a1n cho \u0111\u1ebfn khi $b$ \u0111\u01b0\u1ee3c tr\u1eeb kh\u1ecfi n\u00f3 \u00edt nh\u1ea5t $\\left\\lfloor\\frac{a}{b}\\right\\rfloor$ l\u1ea7n. Do \u0111\u00f3, \u0111\u1ec3 t\u0103ng t\u1ed1c m\u1ecdi th\u1ee9, $a-b$ \u0111\u01b0\u1ee3c thay th\u1ebf b\u1eb1ng $a-\\left\\lfloor\\frac{a}{b}\\right\\rfloor b = a \\bmod b$. Khi \u0111\u00f3 thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c ph\u00e1t bi\u1ec3u theo c\u00e1ch c\u1ef1c k\u1ef3 \u0111\u01a1n gi\u1ea3n:</p> $$\\gcd(a, b) = \\begin{cases}a,&amp;\\text{n\u1ebfu }b = 0 \\\\ \\gcd(b, a \\bmod b),&amp;\\text{ng\u01b0\u1ee3c l\u1ea1i.}\\end{cases}$$","tags":["Translated"]},{"location":"algebra/euclid-algorithm.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<pre><code>int gcd (int a, int b) {\n    if (b == 0)\n        return a;\n    else\n        return gcd (b, a % b);\n}\n</code></pre> <p>S\u1eed d\u1ee5ng to\u00e1n t\u1eed tam ph\u00e2n trong C++, ch\u00fang ta c\u00f3 th\u1ec3 vi\u1ebft n\u00f3 d\u01b0\u1edbi d\u1ea1ng m\u1ed9t d\u00f2ng.</p> <pre><code>int gcd (int a, int b) {\n    return b ? gcd (b, a % b) : a;\n}\n</code></pre> <p>V\u00e0 cu\u1ed1i c\u00f9ng, \u0111\u00e2y l\u00e0 m\u1ed9t c\u00e0i \u0111\u1eb7t kh\u00f4ng \u0111\u1ec7 quy:</p> <pre><code>int gcd (int a, int b) {\n    while (b) {\n        a %= b;\n        swap(a, b);\n    }\n    return a;\n}\n</code></pre> <p>L\u01b0u \u00fd r\u1eb1ng k\u1ec3 t\u1eeb C++17, <code>gcd</code> \u0111\u01b0\u1ee3c c\u00e0i \u0111\u1eb7t nh\u01b0 m\u1ed9t h\u00e0m chu\u1ea9n trong C++.</p>","tags":["Translated"]},{"location":"algebra/euclid-algorithm.html#time-complexity","title":"\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian (Time Complexity)","text":"<p>Th\u1eddi gian ch\u1ea1y c\u1ee7a thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c \u01b0\u1edbc t\u00ednh b\u1edfi \u0111\u1ecbnh l\u00fd Lam\u00e9, \u0111\u1ecbnh l\u00fd n\u00e0y thi\u1ebft l\u1eadp m\u1ed9t m\u1ed1i li\u00ean h\u1ec7 \u0111\u00e1ng ng\u1ea1c nhi\u00ean gi\u1eefa thu\u1eadt to\u00e1n Euclid v\u00e0 d\u00e3y Fibonacci:</p> <p>N\u1ebfu $a &gt; b \\geq 1$ v\u00e0 $b &lt; F_n$ v\u1edbi m\u1ed9t s\u1ed1 $n$, thu\u1eadt to\u00e1n Euclid th\u1ef1c hi\u1ec7n t\u1ed1i \u0111a $n-2$ l\u1eddi g\u1ecdi \u0111\u1ec7 quy.</p> <p>H\u01a1n n\u1eefa, c\u00f3 th\u1ec3 ch\u1ec9 ra r\u1eb1ng c\u1eadn tr\u00ean c\u1ee7a \u0111\u1ecbnh l\u00fd n\u00e0y l\u00e0 t\u1ed1i \u01b0u. Khi $a = F_n$ v\u00e0 $b = F_{n-1}$, $gcd(a, b)$ s\u1ebd th\u1ef1c hi\u1ec7n ch\u00ednh x\u00e1c $n-2$ l\u1eddi g\u1ecdi \u0111\u1ec7 quy. N\u00f3i c\u00e1ch kh\u00e1c, c\u00e1c s\u1ed1 Fibonacci li\u00ean ti\u1ebfp l\u00e0 \u0111\u1ea7u v\u00e0o tr\u01b0\u1eddng h\u1ee3p x\u1ea5u nh\u1ea5t cho thu\u1eadt to\u00e1n Euclid.</p> <p>Cho r\u1eb1ng c\u00e1c s\u1ed1 Fibonacci t\u0103ng theo c\u1ea5p s\u1ed1 nh\u00e2n, ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c r\u1eb1ng thu\u1eadt to\u00e1n Euclid ho\u1ea1t \u0111\u1ed9ng trong $O(\\log \\min(a, b))$.</p> <p>M\u1ed9t c\u00e1ch kh\u00e1c \u0111\u1ec3 \u01b0\u1edbc t\u00ednh \u0111\u1ed9 ph\u1ee9c t\u1ea1p l\u00e0 nh\u1eadn th\u1ea5y r\u1eb1ng $a \\bmod b$ cho tr\u01b0\u1eddng h\u1ee3p $a \\geq b$ nh\u1ecf h\u01a1n \u00edt nh\u1ea5t $2$ l\u1ea7n so v\u1edbi $a$, v\u00ec v\u1eady s\u1ed1 l\u1edbn h\u01a1n gi\u1ea3m \u00edt nh\u1ea5t m\u1ed9t n\u1eeda sau m\u1ed7i l\u1ea7n l\u1eb7p c\u1ee7a thu\u1eadt to\u00e1n. \u00c1p d\u1ee5ng l\u00fd lu\u1eadn n\u00e0y cho tr\u01b0\u1eddng h\u1ee3p khi ch\u00fang ta t\u00ednh GCD c\u1ee7a t\u1eadp h\u1ee3p c\u00e1c s\u1ed1 $a_1,\\dots,a_n \\leq C$, \u0111i\u1ec1u n\u00e0y c\u0169ng cho ph\u00e9p ch\u00fang ta \u01b0\u1edbc t\u00ednh t\u1ed5ng th\u1eddi gian ch\u1ea1y l\u00e0 $O(n + \\log C)$, thay v\u00ec $O(n \\log C)$, v\u00ec m\u1ed7i l\u1ea7n l\u1eb7p kh\u00f4ng t\u1ea7m th\u01b0\u1eddng c\u1ee7a thu\u1eadt to\u00e1n gi\u1ea3m \u1ee9ng c\u1eed vi\u00ean GCD hi\u1ec7n t\u1ea1i \u0111i \u00edt nh\u1ea5t m\u1ed9t h\u1ec7 s\u1ed1 $2$.</p>","tags":["Translated"]},{"location":"algebra/euclid-algorithm.html#least-common-multiple","title":"B\u1ed9i chung nh\u1ecf nh\u1ea5t (Least common multiple)","text":"<p>Vi\u1ec7c t\u00ednh to\u00e1n b\u1ed9i chung nh\u1ecf nh\u1ea5t (th\u01b0\u1eddng \u0111\u01b0\u1ee3c k\u00fd hi\u1ec7u l\u00e0 LCM) c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c quy v\u1ec1 vi\u1ec7c t\u00ednh to\u00e1n GCD v\u1edbi c\u00f4ng th\u1ee9c \u0111\u01a1n gi\u1ea3n sau:</p> $$\\text{lcm}(a, b) = \\frac{a \\cdot b}{\\gcd(a, b)}$$ <p>Do \u0111\u00f3, LCM c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n b\u1eb1ng thu\u1eadt to\u00e1n Euclid v\u1edbi c\u00f9ng \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian:</p> <p>M\u1ed9t c\u00e0i \u0111\u1eb7t kh\u1ea3 thi, tr\u00e1nh tr\u00e0n s\u1ed1 nguy\u00ean m\u1ed9t c\u00e1ch kh\u00e9o l\u00e9o b\u1eb1ng c\u00e1ch chia $a$ cho GCD tr\u01b0\u1edbc, \u0111\u01b0\u1ee3c \u0111\u01b0a ra d\u01b0\u1edbi \u0111\u00e2y:</p> <pre><code>int lcm (int a, int b) {\n    return a / gcd(a, b) * b;\n}\n</code></pre>","tags":["Translated"]},{"location":"algebra/euclid-algorithm.html#binary-gcd","title":"GCD nh\u1ecb ph\u00e2n (Binary GCD)","text":"<p>Thu\u1eadt to\u00e1n GCD nh\u1ecb ph\u00e2n l\u00e0 m\u1ed9t t\u1ed1i \u01b0u h\u00f3a cho thu\u1eadt to\u00e1n Euclid th\u00f4ng th\u01b0\u1eddng.</p> <p>Ph\u1ea7n ch\u1eadm c\u1ee7a thu\u1eadt to\u00e1n th\u00f4ng th\u01b0\u1eddng l\u00e0 c\u00e1c ph\u00e9p to\u00e1n modulo. C\u00e1c ph\u00e9p to\u00e1n modulo, m\u1eb7c d\u00f9 ch\u00fang ta xem ch\u00fang l\u00e0 $O(1)$, ch\u1eadm h\u01a1n nhi\u1ec1u so v\u1edbi c\u00e1c ph\u00e9p to\u00e1n \u0111\u01a1n gi\u1ea3n h\u01a1n nh\u01b0 c\u1ed9ng, tr\u1eeb ho\u1eb7c c\u00e1c ph\u00e9p to\u00e1n bit. V\u00ec v\u1eady s\u1ebd t\u1ed1t h\u01a1n n\u1ebfu tr\u00e1nh ch\u00fang.</p> <p>H\u00f3a ra, b\u1ea1n c\u00f3 th\u1ec3 thi\u1ebft k\u1ebf m\u1ed9t thu\u1eadt to\u00e1n GCD nhanh tr\u00e1nh c\u00e1c ph\u00e9p to\u00e1n modulo. N\u00f3 d\u1ef1a tr\u00ean m\u1ed9t v\u00e0i t\u00ednh ch\u1ea5t:</p> <ul> <li>N\u1ebfu c\u1ea3 hai s\u1ed1 \u0111\u1ec1u ch\u1eb5n, th\u00ec ch\u00fang ta c\u00f3 th\u1ec3 \u0111\u01b0a th\u1eeba s\u1ed1 hai ra ngo\u00e0i v\u00e0 t\u00ednh GCD c\u1ee7a c\u00e1c s\u1ed1 c\u00f2n l\u1ea1i: $\\gcd(2a, 2b) = 2 \\gcd(a, b)$.</li> <li>N\u1ebfu m\u1ed9t trong c\u00e1c s\u1ed1 l\u00e0 ch\u1eb5n v\u00e0 s\u1ed1 kia l\u00e0 l\u1ebb, th\u00ec ch\u00fang ta c\u00f3 th\u1ec3 lo\u1ea1i b\u1ecf th\u1eeba s\u1ed1 2 kh\u1ecfi s\u1ed1 ch\u1eb5n: $\\gcd(2a, b) = \\gcd(a, b)$ n\u1ebfu $b$ l\u00e0 l\u1ebb.</li> <li>N\u1ebfu c\u1ea3 hai s\u1ed1 \u0111\u1ec1u l\u1ebb, th\u00ec tr\u1eeb m\u1ed9t s\u1ed1 kh\u1ecfi s\u1ed1 kia s\u1ebd kh\u00f4ng l\u00e0m thay \u0111\u1ed5i GCD: $\\gcd(a, b) = \\gcd(b, a-b)$</li> </ul> <p>Ch\u1ec9 s\u1eed d\u1ee5ng c\u00e1c t\u00ednh ch\u1ea5t n\u00e0y, v\u00e0 m\u1ed9t s\u1ed1 h\u00e0m bit nhanh t\u1eeb GCC, ch\u00fang ta c\u00f3 th\u1ec3 c\u00e0i \u0111\u1eb7t m\u1ed9t phi\u00ean b\u1ea3n nhanh:</p> <pre><code>int gcd(int a, int b) {\n    if (!a || !b)\n        return a | b;\n    unsigned shift = __builtin_ctz(a | b);\n    a &gt;&gt;= __builtin_ctz(a);\n    do {\n        b &gt;&gt;= __builtin_ctz(b);\n        if (a &gt; b)\n            swap(a, b);\n        b -= a;\n    } while (b);\n    return a &lt;&lt; shift;\n}\n</code></pre> <p>L\u01b0u \u00fd r\u1eb1ng s\u1ef1 t\u1ed1i \u01b0u h\u00f3a nh\u01b0 v\u1eady th\u01b0\u1eddng kh\u00f4ng c\u1ea7n thi\u1ebft, v\u00e0 h\u1ea7u h\u1ebft c\u00e1c ng\u00f4n ng\u1eef l\u1eadp tr\u00ecnh \u0111\u00e3 c\u00f3 h\u00e0m GCD trong th\u01b0 vi\u1ec7n chu\u1ea9n c\u1ee7a ch\u00fang. V.d. C++17 c\u00f3 h\u00e0m <code>std::gcd</code> trong header <code>numeric</code>.</p>","tags":["Translated"]},{"location":"algebra/euclid-algorithm.html#practice-problems","title":"B\u00e0i t\u1eadp luy\u1ec7n t\u1eadp","text":"<ul> <li>CSAcademy - Greatest Common Divisor</li> <li>Codeforces 1916B - Two Divisors</li> </ul>","tags":["Translated"]},{"location":"algebra/euclid-algorithm.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 130</li> <li>Translated lines: 130</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Translated"]},{"location":"algebra/extended-euclid-algorithm.html","title":"Thu\u1eadt to\u00e1n Euclid m\u1edf r\u1ed9ng (Extended Euclidean Algorithm)","text":"<p>Trong khi thu\u1eadt to\u00e1n Euclid ch\u1ec9 t\u00ednh \u01b0\u1edbc chung l\u1edbn nh\u1ea5t (GCD) c\u1ee7a hai s\u1ed1 nguy\u00ean $a$ v\u00e0 $b$, phi\u00ean b\u1ea3n m\u1edf r\u1ed9ng c\u00f2n t\u00ecm c\u00e1ch bi\u1ec3u di\u1ec5n GCD theo $a$ v\u00e0 $b$, t\u1ee9c l\u00e0 c\u00e1c h\u1ec7 s\u1ed1 $x$ v\u00e0 $y$ sao cho:</p> $$a \\cdot x + b \\cdot y = \\gcd(a, b)$$ <p>Quan tr\u1ecdng c\u1ea7n l\u01b0u \u00fd l\u00e0 theo \u0110\u1eb3ng th\u1ee9c B\u00e9zout, ch\u00fang ta lu\u00f4n c\u00f3 th\u1ec3 t\u00ecm th\u1ea5y m\u1ed9t bi\u1ec3u di\u1ec5n nh\u01b0 v\u1eady. V\u00ed d\u1ee5, $\\gcd(55, 80) = 5$, do \u0111\u00f3 ch\u00fang ta c\u00f3 th\u1ec3 bi\u1ec3u di\u1ec5n $5$ d\u01b0\u1edbi d\u1ea1ng t\u1ed5 h\u1ee3p tuy\u1ebfn t\u00ednh v\u1edbi c\u00e1c s\u1ed1 h\u1ea1ng $55$ v\u00e0 $80$: $55 \\cdot 3 + 80 \\cdot (-2) = 5$ </p> <p>M\u1ed9t d\u1ea1ng t\u1ed5ng qu\u00e1t h\u01a1n c\u1ee7a b\u00e0i to\u00e1n \u0111\u00f3 \u0111\u01b0\u1ee3c th\u1ea3o lu\u1eadn trong b\u00e0i vi\u1ebft v\u1ec1 Ph\u01b0\u01a1ng tr\u00ecnh Diophantine tuy\u1ebfn t\u00ednh. N\u00f3 s\u1ebd d\u1ef1a tr\u00ean thu\u1eadt to\u00e1n n\u00e0y.</p>","tags":["Translated"]},{"location":"algebra/extended-euclid-algorithm.html#algorithm","title":"Thu\u1eadt to\u00e1n (Algorithm)","text":"<p>Ch\u00fang ta s\u1ebd k\u00fd hi\u1ec7u GCD c\u1ee7a $a$ v\u00e0 $b$ l\u00e0 $g$ trong ph\u1ea7n n\u00e0y.</p> <p>Nh\u1eefng thay \u0111\u1ed5i so v\u1edbi thu\u1eadt to\u00e1n g\u1ed1c r\u1ea5t \u0111\u01a1n gi\u1ea3n. N\u1ebfu ch\u00fang ta nh\u1edb l\u1ea1i thu\u1eadt to\u00e1n, ch\u00fang ta c\u00f3 th\u1ec3 th\u1ea5y r\u1eb1ng thu\u1eadt to\u00e1n k\u1ebft th\u00fac v\u1edbi $b = 0$ v\u00e0 $a = g$. \u0110\u1ed1i v\u1edbi c\u00e1c tham s\u1ed1 n\u00e0y, ch\u00fang ta c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng t\u00ecm th\u1ea5y c\u00e1c h\u1ec7 s\u1ed1, c\u1ee5 th\u1ec3 l\u00e0 $g \\cdot 1 + 0 \\cdot 0 = g$.</p> <p>B\u1eaft \u0111\u1ea7u t\u1eeb c\u00e1c h\u1ec7 s\u1ed1 n\u00e0y $(x, y) = (1, 0)$, ch\u00fang ta c\u00f3 th\u1ec3 \u0111i ng\u01b0\u1ee3c l\u00ean c\u00e1c l\u1eddi g\u1ecdi \u0111\u1ec7 quy. T\u1ea5t c\u1ea3 nh\u1eefng g\u00ec ch\u00fang ta c\u1ea7n l\u00e0m l\u00e0 t\u00ecm ra c\u00e1ch c\u00e1c h\u1ec7 s\u1ed1 $x$ v\u00e0 $y$ thay \u0111\u1ed5i trong qu\u00e1 tr\u00ecnh chuy\u1ec3n \u0111\u1ed5i t\u1eeb $(a, b)$ sang $(b, a \\bmod b)$.</p> <p>Gi\u1ea3 s\u1eed ch\u00fang ta t\u00ecm th\u1ea5y c\u00e1c h\u1ec7 s\u1ed1 $(x_1, y_1)$ cho $(b, a \\bmod b)$:</p> $$b \\cdot x_1 + (a \\bmod b) \\cdot y_1 = g$$ <p>v\u00e0 ch\u00fang ta mu\u1ed1n t\u00ecm c\u1eb7p $(x, y)$ cho $(a, b)$:</p> $$ a \\cdot x + b \\cdot y = g$$ <p>Ch\u00fang ta c\u00f3 th\u1ec3 bi\u1ec3u di\u1ec5n $a \\bmod b$ nh\u01b0 sau:</p> $$ a \\bmod b = a - \\left\\lfloor \\frac{a}{b} \\right\\rfloor \\cdot b$$ <p>Thay th\u1ebf bi\u1ec3u th\u1ee9c n\u00e0y v\u00e0o ph\u01b0\u01a1ng tr\u00ecnh h\u1ec7 s\u1ed1 c\u1ee7a $(x_1, y_1)$ ta \u0111\u01b0\u1ee3c:</p> $$ g = b \\cdot x_1 + (a \\bmod b) \\cdot y_1 = b \\cdot x_1 + \\left(a - \\left\\lfloor \\frac{a}{b} \\right\\rfloor \\cdot b \\right) \\cdot y_1$$ <p>v\u00e0 sau khi s\u1eafp x\u1ebfp l\u1ea1i c\u00e1c s\u1ed1 h\u1ea1ng:</p> $$g = a \\cdot y_1 + b \\cdot \\left( x_1 - y_1 \\cdot \\left\\lfloor \\frac{a}{b} \\right\\rfloor \\right)$$ <p>Ch\u00fang ta \u0111\u00e3 t\u00ecm th\u1ea5y c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a $x$ v\u00e0 $y$:</p> $$\\begin{cases} x = y_1 \\\\ y = x_1 - y_1 \\cdot \\left\\lfloor \\frac{a}{b} \\right\\rfloor \\end{cases} $$","tags":["Translated"]},{"location":"algebra/extended-euclid-algorithm.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<pre><code>int gcd(int a, int b, int&amp; x, int&amp; y) {\n    if (b == 0) {\n        x = 1;\n        y = 0;\n        return a;\n    }\n    int x1, y1;\n    int d = gcd(b, a % b, x1, y1);\n    x = y1;\n    y = x1 - y1 * (a / b);\n    return d;\n}\n</code></pre> <p>H\u00e0m \u0111\u1ec7 quy \u1edf tr\u00ean tr\u1ea3 v\u1ec1 GCD v\u00e0 c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a h\u1ec7 s\u1ed1 cho <code>x</code> v\u00e0 <code>y</code> (\u0111\u01b0\u1ee3c truy\u1ec1n tham chi\u1ebfu v\u00e0o h\u00e0m).</p> <p>C\u00e0i \u0111\u1eb7t n\u00e0y c\u1ee7a thu\u1eadt to\u00e1n Euclid m\u1edf r\u1ed9ng t\u1ea1o ra k\u1ebft qu\u1ea3 ch\u00ednh x\u00e1c cho c\u1ea3 c\u00e1c s\u1ed1 nguy\u00ean \u00e2m.</p>","tags":["Translated"]},{"location":"algebra/extended-euclid-algorithm.html#iterative-version","title":"Phi\u00ean b\u1ea3n l\u1eb7p (Iterative version)","text":"<p>C\u0169ng c\u00f3 th\u1ec3 vi\u1ebft thu\u1eadt to\u00e1n Euclid m\u1edf r\u1ed9ng theo c\u00e1ch l\u1eb7p. V\u00ec n\u00f3 tr\u00e1nh \u0111\u1ec7 quy, m\u00e3 s\u1ebd ch\u1ea1y nhanh h\u01a1n m\u1ed9t ch\u00fat so v\u1edbi m\u00e3 \u0111\u1ec7 quy.</p> <pre><code>int gcd(int a, int b, int&amp; x, int&amp; y) {\n    x = 1, y = 0;\n    int x1 = 0, y1 = 1, a1 = a, b1 = b;\n    while (b1) {\n        int q = a1 / b1;\n        tie(x, x1) = make_tuple(x1, x - q * x1);\n        tie(y, y1) = make_tuple(y1, y - q * y1);\n        tie(a1, b1) = make_tuple(b1, a1 - q * b1);\n    }\n    return a1;\n}\n</code></pre> <p>N\u1ebfu b\u1ea1n nh\u00ecn k\u1ef9 v\u00e0o c\u00e1c bi\u1ebfn <code>a1</code> v\u00e0 <code>b1</code>, b\u1ea1n c\u00f3 th\u1ec3 nh\u1eadn th\u1ea5y r\u1eb1ng ch\u00fang nh\u1eadn ch\u00ednh x\u00e1c c\u00e1c gi\u00e1 tr\u1ecb gi\u1ed1ng nh\u01b0 trong phi\u00ean b\u1ea3n l\u1eb7p c\u1ee7a thu\u1eadt to\u00e1n Euclid th\u00f4ng th\u01b0\u1eddng. V\u00ec v\u1eady, thu\u1eadt to\u00e1n \u00edt nh\u1ea5t s\u1ebd t\u00ednh \u0111\u00fang GCD.</p> <p>\u0110\u1ec3 bi\u1ebft t\u1ea1i sao thu\u1eadt to\u00e1n t\u00ednh \u0111\u00fang c\u00e1c h\u1ec7 s\u1ed1, h\u00e3y xem x\u00e9t r\u1eb1ng c\u00e1c b\u1ea5t bi\u1ebfn sau \u0111\u00e2y gi\u1eef nguy\u00ean t\u1ea1i b\u1ea5t k\u1ef3 th\u1eddi \u0111i\u1ec3m n\u00e0o (tr\u01b0\u1edbc khi v\u00f2ng l\u1eb7p while b\u1eaft \u0111\u1ea7u v\u00e0 \u1edf cu\u1ed1i m\u1ed7i l\u1ea7n l\u1eb7p):</p> $$x \\cdot a + y \\cdot b = a_1$$ $$x_1 \\cdot a + y_1 \\cdot b = b_1$$ <p>G\u1ecdi c\u00e1c gi\u00e1 tr\u1ecb \u1edf cu\u1ed1i m\u1ed9t l\u1ea7n l\u1eb7p \u0111\u01b0\u1ee3c k\u00fd hi\u1ec7u b\u1eb1ng d\u1ea5u ph\u1ea9y ($'$), v\u00e0 gi\u1ea3 s\u1eed $q = \\frac{a_1}{b_1}$. T\u1eeb thu\u1eadt to\u00e1n Euclid, ch\u00fang ta c\u00f3:</p> $$a_1' = b_1$$ $$b_1' = a_1 - q \\cdot b_1$$ <p>\u0110\u1ec3 b\u1ea5t bi\u1ebfn \u0111\u1ea7u ti\u00ean gi\u1eef nguy\u00ean, \u0111i\u1ec1u sau ph\u1ea3i \u0111\u00fang:</p> $$x' \\cdot a + y' \\cdot b = a_1' = b_1$$ $$x' \\cdot a + y' \\cdot b = x_1 \\cdot a + y_1 \\cdot b$$ <p>T\u01b0\u01a1ng t\u1ef1 \u0111\u1ed1i v\u1edbi b\u1ea5t bi\u1ebfn th\u1ee9 hai, \u0111i\u1ec1u sau ph\u1ea3i gi\u1eef nguy\u00ean:</p> $$x_1' \\cdot a + y_1' \\cdot b = a_1 - q \\cdot b_1$$ $$x_1' \\cdot a + y_1' \\cdot b = (x - q \\cdot x_1) \\cdot a + (y - q \\cdot y_1) \\cdot b$$ <p>B\u1eb1ng c\u00e1ch so s\u00e1nh c\u00e1c h\u1ec7 s\u1ed1 c\u1ee7a $a$ v\u00e0 $b$, c\u00e1c ph\u01b0\u01a1ng tr\u00ecnh c\u1eadp nh\u1eadt cho m\u1ed7i bi\u1ebfn c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c suy ra, \u0111\u1ea3m b\u1ea3o r\u1eb1ng c\u00e1c b\u1ea5t bi\u1ebfn \u0111\u01b0\u1ee3c duy tr\u00ec trong su\u1ed1t thu\u1eadt to\u00e1n.</p> <p>\u1ede cu\u1ed1i ch\u00fang ta bi\u1ebft r\u1eb1ng $a_1$ ch\u1ee9a GCD, v\u00ec v\u1eady $x \\cdot a + y \\cdot b = g$. \u0110i\u1ec1u \u0111\u00f3 c\u00f3 ngh\u0129a l\u00e0 ch\u00fang ta \u0111\u00e3 t\u00ecm th\u1ea5y c\u00e1c h\u1ec7 s\u1ed1 c\u1ea7n thi\u1ebft.</p> <p>B\u1ea1n th\u1eadm ch\u00ed c\u00f3 th\u1ec3 t\u1ed1i \u01b0u h\u00f3a m\u00e3 h\u01a1n n\u1eefa, v\u00e0 lo\u1ea1i b\u1ecf bi\u1ebfn $a_1$ v\u00e0 $b_1$ kh\u1ecfi m\u00e3, v\u00e0 ch\u1ec9 s\u1eed d\u1ee5ng l\u1ea1i $a$ v\u00e0 $b$. Tuy nhi\u00ean n\u1ebfu b\u1ea1n l\u00e0m v\u1eady, b\u1ea1n s\u1ebd m\u1ea5t kh\u1ea3 n\u0103ng l\u1eadp lu\u1eadn v\u1ec1 c\u00e1c b\u1ea5t bi\u1ebfn.</p>","tags":["Translated"]},{"location":"algebra/extended-euclid-algorithm.html#practice-problems","title":"B\u00e0i t\u1eadp luy\u1ec7n t\u1eadp","text":"<ul> <li>UVA - 10104 - Euclid Problem</li> <li>GYM - (J) Once Upon A Time</li> <li>UVA - 12775 - Gift Dilemma</li> </ul>","tags":["Translated"]},{"location":"algebra/extended-euclid-algorithm.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 136</li> <li>Translated lines: 136</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Translated"]},{"location":"algebra/factorial-divisors.html","title":"T\u00ecm l\u0169y th\u1eeba c\u1ee7a \u01b0\u1edbc giai th\u1eeba (Finding Power of Factorial Divisor)","text":"<p>B\u1ea1n \u0111\u01b0\u1ee3c cho hai s\u1ed1 $n$ v\u00e0 $k$. T\u00ecm s\u1ed1 nguy\u00ean $x$ l\u1edbn nh\u1ea5t sao cho $k^x$ chia h\u1ebft $n!$.</p>","tags":["Translated"]},{"location":"algebra/factorial-divisors.html#prime-k","title":"$k$ nguy\u00ean t\u1ed1 (Prime $k$)","text":"<p>\u0110\u1ea7u ti\u00ean h\u00e3y xem x\u00e9t tr\u01b0\u1eddng h\u1ee3p $k$ nguy\u00ean t\u1ed1. Bi\u1ec3u th\u1ee9c t\u01b0\u1eddng minh cho giai th\u1eeba</p> $$n! = 1 \\cdot 2 \\cdot 3 \\ldots (n-1) \\cdot n$$ <p>L\u01b0u \u00fd r\u1eb1ng m\u1ed7i ph\u1ea7n t\u1eed th\u1ee9 $k$ c\u1ee7a t\u00edch chia h\u1ebft cho $k$, t\u1ee9c l\u00e0 th\u00eam $+1$ v\u00e0o c\u00e2u tr\u1ea3 l\u1eddi; s\u1ed1 l\u01b0\u1ee3ng c\u00e1c ph\u1ea7n t\u1eed nh\u01b0 v\u1eady l\u00e0 $\\Bigl\\lfloor\\dfrac{n}{k}\\Bigr\\rfloor$.</p> <p>Ti\u1ebfp theo, m\u1ed7i ph\u1ea7n t\u1eed th\u1ee9 $k^2$ chia h\u1ebft cho $k^2$, t\u1ee9c l\u00e0 th\u00eam $+1$ n\u1eefa v\u00e0o c\u00e2u tr\u1ea3 l\u1eddi (l\u0169y th\u1eeba \u0111\u1ea7u ti\u00ean c\u1ee7a $k$ \u0111\u00e3 \u0111\u01b0\u1ee3c t\u00ednh trong \u0111o\u1ea1n tr\u01b0\u1edbc). S\u1ed1 l\u01b0\u1ee3ng c\u00e1c ph\u1ea7n t\u1eed nh\u01b0 v\u1eady l\u00e0 $\\Bigl\\lfloor\\dfrac{n}{k^2}\\Bigr\\rfloor$.</p> <p>V\u00e0 c\u1ee9 th\u1ebf, \u0111\u1ed1i v\u1edbi m\u1ed7i $i$, m\u1ed7i ph\u1ea7n t\u1eed th\u1ee9 $k^i$ th\u00eam $+1$ n\u1eefa v\u00e0o c\u00e2u tr\u1ea3 l\u1eddi, v\u00e0 c\u00f3 $\\Bigl\\lfloor\\dfrac{n}{k^i}\\Bigr\\rfloor$ ph\u1ea7n t\u1eed nh\u01b0 v\u1eady.</p> <p>C\u00e2u tr\u1ea3 l\u1eddi cu\u1ed1i c\u00f9ng l\u00e0</p> $$\\Bigl\\lfloor\\dfrac{n}{k}\\Bigr\\rfloor + \\Bigl\\lfloor\\dfrac{n}{k^2}\\Bigr\\rfloor + \\ldots + \\Bigl\\lfloor\\dfrac{n}{k^i}\\Bigr\\rfloor + \\ldots$$ <p>K\u1ebft qu\u1ea3 n\u00e0y c\u00f2n \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 C\u00f4ng th\u1ee9c Legendre. T\u1ed5ng t\u1ea5t nhi\u00ean l\u00e0 h\u1eefu h\u1ea1n, v\u00ec ch\u1ec9 kho\u1ea3ng $\\log_k n$ ph\u1ea7n t\u1eed \u0111\u1ea7u ti\u00ean l\u00e0 kh\u00e1c kh\u00f4ng. Do \u0111\u00f3, th\u1eddi gian ch\u1ea1y c\u1ee7a thu\u1eadt to\u00e1n n\u00e0y l\u00e0 $O(\\log_k n)$.</p>","tags":["Translated"]},{"location":"algebra/factorial-divisors.html#implementation","title":"C\u00e0i \u0111\u1eb7t","text":"<pre><code>int fact_pow (int n, int k) {\n    int res = 0;\n    while (n) {\n        n /= k;\n        res += n;\n    }\n    return res;\n}\n</code></pre>","tags":["Translated"]},{"location":"algebra/factorial-divisors.html#composite-k","title":"$k$ h\u1ee3p s\u1ed1 (Composite $k$)","text":"<p>\u00dd t\u01b0\u1edfng t\u01b0\u01a1ng t\u1ef1 kh\u00f4ng th\u1ec3 \u0111\u01b0\u1ee3c \u00e1p d\u1ee5ng tr\u1ef1c ti\u1ebfp. Thay v\u00e0o \u0111\u00f3 ch\u00fang ta c\u00f3 th\u1ec3 ph\u00e2n t\u00edch th\u1eeba s\u1ed1 $k$, bi\u1ec3u di\u1ec5n n\u00f3 d\u01b0\u1edbi d\u1ea1ng $k = k_1^{p_1} \\cdot \\ldots \\cdot k_m^{p_m}$. V\u1edbi m\u1ed7i $k_i$, ch\u00fang ta t\u00ecm s\u1ed1 l\u1ea7n n\u00f3 xu\u1ea5t hi\u1ec7n trong $n!$ b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 \u1edf tr\u00ean - g\u1ecdi gi\u00e1 tr\u1ecb n\u00e0y l\u00e0 $a_i$. C\u00e2u tr\u1ea3 l\u1eddi cho $k$ h\u1ee3p s\u1ed1 s\u1ebd l\u00e0</p> $$\\min_ {i=1 \\ldots m} \\dfrac{a_i}{p_i}$$","tags":["Translated"]},{"location":"algebra/factorial-divisors.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 50</li> <li>Translated lines: 50</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Translated"]},{"location":"algebra/factorial-modulo.html","title":"Giai th\u1eeba modulo $p$ (Factorial modulo $p$)","text":"<p>Trong m\u1ed9t s\u1ed1 tr\u01b0\u1eddng h\u1ee3p, c\u1ea7n ph\u1ea3i xem x\u00e9t c\u00e1c c\u00f4ng th\u1ee9c ph\u1ee9c t\u1ea1p modulo m\u1ed9t s\u1ed1 nguy\u00ean t\u1ed1 $p$, ch\u1ee9a giai th\u1eeba \u1edf c\u1ea3 t\u1eed s\u1ed1 v\u00e0 m\u1eabu s\u1ed1, gi\u1ed1ng nh\u01b0 c\u00f4ng th\u1ee9c b\u1ea1n g\u1eb7p trong c\u00f4ng th\u1ee9c cho H\u1ec7 s\u1ed1 nh\u1ecb th\u1ee9c. Ch\u00fang ta xem x\u00e9t tr\u01b0\u1eddng h\u1ee3p khi $p$ t\u01b0\u01a1ng \u0111\u1ed1i nh\u1ecf. B\u00e0i to\u00e1n n\u00e0y ch\u1ec9 c\u00f3 \u00fd ngh\u0129a khi c\u00e1c giai th\u1eeba xu\u1ea5t hi\u1ec7n \u1edf c\u1ea3 t\u1eed s\u1ed1 v\u00e0 m\u1eabu s\u1ed1 c\u1ee7a ph\u00e2n s\u1ed1. Ng\u01b0\u1ee3c l\u1ea1i $p!$ v\u00e0 c\u00e1c s\u1ed1 h\u1ea1ng ti\u1ebfp theo s\u1ebd gi\u1ea3m xu\u1ed1ng 0. Nh\u01b0ng trong ph\u00e2n s\u1ed1, c\u00e1c th\u1eeba s\u1ed1 c\u1ee7a $p$ c\u00f3 th\u1ec3 tri\u1ec7t ti\u00eau, v\u00e0 bi\u1ec3u th\u1ee9c k\u1ebft qu\u1ea3 s\u1ebd kh\u00e1c kh\u00f4ng modulo $p$.</p> <p>Do \u0111\u00f3, m\u1ed9t c\u00e1ch h\u00ecnh th\u1ee9c nhi\u1ec7m v\u1ee5 l\u00e0: B\u1ea1n mu\u1ed1n t\u00ednh $n! \\bmod p$, m\u00e0 kh\u00f4ng t\u00ednh \u0111\u1ebfn t\u1ea5t c\u1ea3 c\u00e1c th\u1eeba s\u1ed1 b\u1ed9i c\u1ee7a $p$ xu\u1ea5t hi\u1ec7n trong giai th\u1eeba. H\u00e3y t\u01b0\u1edfng t\u01b0\u1ee3ng b\u1ea1n vi\u1ebft ra ph\u00e2n t\u00edch th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1 c\u1ee7a $n!$, lo\u1ea1i b\u1ecf t\u1ea5t c\u1ea3 c\u00e1c th\u1eeba s\u1ed1 $p$, v\u00e0 t\u00ednh t\u00edch modulo $p$. Ch\u00fang ta s\u1ebd k\u00fd hi\u1ec7u giai th\u1eeba \u0111\u00e3 s\u1eeda \u0111\u1ed5i n\u00e0y l\u00e0 $n!_{\\%p}$. V\u00ed d\u1ee5 $7!_{\\%p} \\equiv 1 \\cdot 2 \\cdot \\underbrace{1}_{3} \\cdot 4 \\cdot 5 \\underbrace{2}_{6} \\cdot 7 \\equiv 2 \\bmod 3$.</p> <p>H\u1ecdc c\u00e1ch t\u00ednh to\u00e1n hi\u1ec7u qu\u1ea3 giai th\u1eeba \u0111\u00e3 s\u1eeda \u0111\u1ed5i n\u00e0y cho ph\u00e9p ch\u00fang ta t\u00ednh to\u00e1n nhanh ch\u00f3ng gi\u00e1 tr\u1ecb c\u1ee7a c\u00e1c c\u00f4ng th\u1ee9c t\u1ed5 h\u1ee3p kh\u00e1c nhau (v\u00ed d\u1ee5, H\u1ec7 s\u1ed1 nh\u1ecb th\u1ee9c).</p>","tags":["Translated"]},{"location":"algebra/factorial-modulo.html#algorithm","title":"Thu\u1eadt to\u00e1n (Algorithm)","text":"<p>H\u00e3y vi\u1ebft giai th\u1eeba \u0111\u00e3 s\u1eeda \u0111\u1ed5i n\u00e0y m\u1ed9t c\u00e1ch t\u01b0\u1eddng minh.</p> $$\\begin{eqnarray} n!_{\\%p} &amp;=&amp; 1 \\cdot 2 \\cdot 3 \\cdot \\ldots \\cdot (p-2) \\cdot (p-1) \\cdot \\underbrace{1}_{p} \\cdot (p+1) \\cdot (p+2) \\cdot \\ldots \\cdot (2p-1) \\cdot \\underbrace{2}_{2p} \\\\\\  &amp; &amp;\\quad \\cdot (2p+1) \\cdot \\ldots \\cdot (p^2-1) \\cdot \\underbrace{1}_{p^2} \\cdot (p^2 +1) \\cdot \\ldots \\cdot n \\pmod{p} \\\\\\\\ &amp;=&amp; 1 \\cdot 2 \\cdot 3 \\cdot \\ldots \\cdot (p-2) \\cdot (p-1) \\cdot \\underbrace{1}_{p} \\cdot 1 \\cdot 2 \\cdot \\ldots \\cdot (p-1) \\cdot \\underbrace{2}_{2p} \\cdot 1 \\cdot 2 \\\\\\ &amp; &amp;\\quad \\cdot \\ldots \\cdot (p-1) \\cdot \\underbrace{1}_{p^2} \\cdot 1 \\cdot 2 \\cdot \\ldots \\cdot (n \\bmod p) \\pmod{p} \\end{eqnarray}$$ <p>C\u00f3 th\u1ec3 th\u1ea5y r\u00f5 r\u00e0ng r\u1eb1ng giai th\u1eeba \u0111\u01b0\u1ee3c chia th\u00e0nh nhi\u1ec1u kh\u1ed1i c\u00f3 c\u00f9ng \u0111\u1ed9 d\u00e0i ngo\u1ea1i tr\u1eeb kh\u1ed1i cu\u1ed1i c\u00f9ng.</p> $$\\begin{eqnarray} n!_{\\%p}&amp;=&amp; \\underbrace{1 \\cdot 2 \\cdot 3 \\cdot \\ldots \\cdot (p-2) \\cdot (p-1) \\cdot 1}_{1\\text{st}} \\cdot \\underbrace{1 \\cdot 2 \\cdot 3 \\cdot \\ldots \\cdot (p-2) \\cdot (p-1) \\cdot 2}_{2\\text{nd}} \\cdot \\ldots \\\\\\\\ &amp; &amp; \\cdot \\underbrace{1 \\cdot 2 \\cdot 3 \\cdot \\ldots \\cdot (p-2) \\cdot (p-1) \\cdot 1}_{p\\text{th}} \\cdot \\ldots \\cdot \\quad \\underbrace{1 \\cdot 2 \\cdot \\cdot \\ldots \\cdot (n \\bmod p)}_{\\text{\u0111u\u00f4i}} \\pmod{p}. \\end{eqnarray}$$ <p>Ph\u1ea7n ch\u00ednh c\u1ee7a c\u00e1c kh\u1ed1i r\u1ea5t d\u1ec5 \u0111\u1ebfm \u2014 n\u00f3 ch\u1ec9 l\u00e0 $(p-1)!\\ \\mathrm{mod}\\ p$. Ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh to\u00e1n \u0111i\u1ec1u \u0111\u00f3 b\u1eb1ng l\u1eadp tr\u00ecnh ho\u1eb7c ch\u1ec9 c\u1ea7n \u00e1p d\u1ee5ng \u0111\u1ecbnh l\u00fd Wilson ph\u00e1t bi\u1ec3u r\u1eb1ng $(p-1)! \\bmod p = -1$ v\u1edbi b\u1ea5t k\u1ef3 s\u1ed1 nguy\u00ean t\u1ed1 $p$ n\u00e0o.</p> <p>Ch\u00fang ta c\u00f3 ch\u00ednh x\u00e1c $\\lfloor \\frac{n}{p} \\rfloor$ kh\u1ed1i nh\u01b0 v\u1eady, do \u0111\u00f3 ch\u00fang ta c\u1ea7n n\u00e2ng $-1$ l\u00ean l\u0169y th\u1eeba $\\lfloor \\frac{n}{p} \\rfloor$. \u0110i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong th\u1eddi gian logarit b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng L\u0169y th\u1eeba nh\u1ecb ph\u00e2n; tuy nhi\u00ean b\u1ea1n c\u0169ng c\u00f3 th\u1ec3 nh\u1eadn th\u1ea5y r\u1eb1ng k\u1ebft qu\u1ea3 s\u1ebd chuy\u1ec3n \u0111\u1ed5i gi\u1eefa $-1$ v\u00e0 $1$, v\u00ec v\u1eady ch\u00fang ta ch\u1ec9 c\u1ea7n xem t\u00ednh ch\u1eb5n l\u1ebb c\u1ee7a s\u1ed1 m\u0169 v\u00e0 nh\u00e2n v\u1edbi $-1$ n\u1ebfu t\u00ednh ch\u1eb5n l\u1ebb l\u00e0 l\u1ebb. V\u00e0 thay v\u00ec nh\u00e2n, ch\u00fang ta c\u0169ng c\u00f3 th\u1ec3 ch\u1ec9 c\u1ea7n tr\u1eeb k\u1ebft qu\u1ea3 hi\u1ec7n t\u1ea1i kh\u1ecfi $p$.</p> <p>Gi\u00e1 tr\u1ecb c\u1ee7a kh\u1ed1i m\u1ed9t ph\u1ea7n cu\u1ed1i c\u00f9ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ednh ri\u00eang trong $O(p)$.</p> <p>\u0110i\u1ec1u n\u00e0y ch\u1ec9 \u0111\u1ec3 l\u1ea1i ph\u1ea7n t\u1eed cu\u1ed1i c\u00f9ng c\u1ee7a m\u1ed7i kh\u1ed1i. N\u1ebfu ch\u00fang ta \u1ea9n c\u00e1c ph\u1ea7n t\u1eed \u0111\u00e3 x\u1eed l\u00fd, ch\u00fang ta c\u00f3 th\u1ec3 th\u1ea5y m\u1eabu sau:</p> $$n!_{\\%p} = \\underbrace{ \\ldots \\cdot 1 } \\cdot \\underbrace{ \\ldots \\cdot 2} \\cdot \\ldots \\cdot \\underbrace{ \\ldots \\cdot (p-1)} \\cdot \\underbrace{ \\ldots \\cdot 1 } \\cdot \\underbrace{ \\ldots \\cdot 1} \\cdot \\underbrace{ \\ldots \\cdot 2} \\cdots$$ <p>\u0110\u00e2y l\u1ea1i l\u00e0 m\u1ed9t giai th\u1eeba \u0111\u00e3 s\u1eeda \u0111\u1ed5i, ch\u1ec9 v\u1edbi k\u00edch th\u01b0\u1edbc nh\u1ecf h\u01a1n nhi\u1ec1u. \u0110\u00f3 l\u00e0 $\\lfloor n / p \\rfloor !_{\\%p}$.</p> <p>Do \u0111\u00f3, trong qu\u00e1 tr\u00ecnh t\u00ednh to\u00e1n giai th\u1eeba \u0111\u00e3 s\u1eeda \u0111\u1ed5i $n\\!_{\\%p}$ ch\u00fang ta \u0111\u00e3 th\u1ef1c hi\u1ec7n $O(p)$ ph\u00e9p to\u00e1n v\u00e0 c\u00f2n l\u1ea1i v\u1edbi vi\u1ec7c t\u00ednh to\u00e1n $\\lfloor n / p \\rfloor !_{\\%p}$. Ch\u00fang ta c\u00f3 m\u1ed9t c\u00f4ng th\u1ee9c \u0111\u1ec7 quy. \u0110\u1ed9 s\u00e2u \u0111\u1ec7 quy l\u00e0 $O(\\log_p n)$, v\u00e0 do \u0111\u00f3 h\u00e0nh vi ti\u1ec7m c\u1eadn ho\u00e0n ch\u1ec9nh c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 $O(p \\log_p n)$.</p> <p>L\u01b0u \u00fd, n\u1ebfu b\u1ea1n t\u00ednh tr\u01b0\u1edbc c\u00e1c giai th\u1eeba $0!,~ 1!,~ 2!,~ \\dots,~ (p-1)!$ modulo $p$, th\u00ec \u0111\u1ed9 ph\u1ee9c t\u1ea1p s\u1ebd ch\u1ec9 l\u00e0 $O(\\log_p n)$.</p>","tags":["Translated"]},{"location":"algebra/factorial-modulo.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>Ch\u00fang ta kh\u00f4ng c\u1ea7n \u0111\u1ec7 quy v\u00ec \u0111\u00e2y l\u00e0 tr\u01b0\u1eddng h\u1ee3p c\u1ee7a \u0111\u1ec7 quy \u0111u\u00f4i v\u00e0 do \u0111\u00f3 c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng \u0111\u01b0\u1ee3c c\u00e0i \u0111\u1eb7t b\u1eb1ng c\u00e1ch l\u1eb7p. Trong c\u00e0i \u0111\u1eb7t sau, ch\u00fang t\u00f4i t\u00ednh tr\u01b0\u1edbc c\u00e1c giai th\u1eeba $0!,~ 1!,~ \\dots,~ (p-1)!$, v\u00e0 do \u0111\u00f3 c\u00f3 th\u1eddi gian ch\u1ea1y $O(p + \\log_p n)$. N\u1ebfu b\u1ea1n c\u1ea7n g\u1ecdi h\u00e0m nhi\u1ec1u l\u1ea7n, th\u00ec b\u1ea1n c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n vi\u1ec7c t\u00ednh tr\u01b0\u1edbc b\u00ean ngo\u00e0i h\u00e0m v\u00e0 th\u1ef1c hi\u1ec7n t\u00ednh to\u00e1n $n!_{\\%p}$ trong th\u1eddi gian $O(\\log_p n)$.</p> <pre><code>int factmod(int n, int p) {\n    vector&lt;int&gt; f(p);\n    f[0] = 1;\n    for (int i = 1; i &lt; p; i++)\n        f[i] = f[i-1] * i % p;\n\n    int res = 1;\n    while (n &gt; 1) {\n        if ((n/p) % 2)\n            res = p - res;\n        res = res * f[n%p] % p;\n        n /= p;\n    }\n    return res;\n}\n</code></pre> <p>Thay th\u1ebf, n\u1ebfu b\u1ea1n ch\u1ec9 c\u00f3 b\u1ed9 nh\u1edb gi\u1edbi h\u1ea1n v\u00e0 kh\u00f4ng th\u1ec3 l\u01b0u tr\u1eef t\u1ea5t c\u1ea3 c\u00e1c giai th\u1eeba, b\u1ea1n c\u0169ng c\u00f3 th\u1ec3 ch\u1ec9 c\u1ea7n nh\u1edb c\u00e1c giai th\u1eeba m\u00e0 b\u1ea1n c\u1ea7n, s\u1eafp x\u1ebfp ch\u00fang, v\u00e0 sau \u0111\u00f3 t\u00ednh to\u00e1n ch\u00fang trong m\u1ed9t l\u1ea7n qu\u00e9t b\u1eb1ng c\u00e1ch t\u00ednh c\u00e1c giai th\u1eeba $0!,~ 1!,~ 2!,~ \\dots,~ (p-1)!$ trong m\u1ed9t v\u00f2ng l\u1eb7p m\u00e0 kh\u00f4ng l\u01b0u tr\u1eef ch\u00fang m\u1ed9t c\u00e1ch r\u00f5 r\u00e0ng.</p>","tags":["Translated"]},{"location":"algebra/factorial-modulo.html#multiplicity-of-p","title":"S\u1ed1 m\u0169 c\u1ee7a $p$ (Multiplicity of $p$)","text":"<p>N\u1ebfu ch\u00fang ta mu\u1ed1n t\u00ednh H\u1ec7 s\u1ed1 nh\u1ecb th\u1ee9c modulo $p$, th\u00ec ch\u00fang ta c\u1ea7n th\u00eam s\u1ed1 m\u0169 c\u1ee7a $p$ trong $n$, t\u1ee9c l\u00e0 s\u1ed1 l\u1ea7n $p$ xu\u1ea5t hi\u1ec7n trong ph\u00e2n t\u00edch th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1 c\u1ee7a $n$, ho\u1eb7c s\u1ed1 l\u1ea7n ch\u00fang ta \u0111\u00e3 x\u00f3a $p$ trong qu\u00e1 tr\u00ecnh t\u00ednh to\u00e1n giai th\u1eeba \u0111\u00e3 s\u1eeda \u0111\u1ed5i.</p> <p>C\u00f4ng th\u1ee9c Legendre cho ch\u00fang ta m\u1ed9t c\u00e1ch \u0111\u1ec3 t\u00ednh \u0111i\u1ec1u n\u00e0y trong th\u1eddi gian $O(\\log_p n)$. C\u00f4ng th\u1ee9c cho s\u1ed1 m\u0169 $\\nu_p$ nh\u01b0 sau:</p> $$\\nu_p(n!) = \\sum_{i=1}^{\\infty} \\left\\lfloor \\frac{n}{p^i} \\right\\rfloor$$ <p>Do \u0111\u00f3 ch\u00fang ta c\u00f3 c\u00e0i \u0111\u1eb7t:</p> <pre><code>int multiplicity_factorial(int n, int p) {\n    int count = 0;\n    do {\n        n /= p;\n        count += n;\n    } while (n);\n    return count;\n}\n</code></pre> <p>C\u00f4ng th\u1ee9c n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c ch\u1ee9ng minh r\u1ea5t d\u1ec5 d\u00e0ng b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng c\u00e1c \u00fd t\u01b0\u1edfng t\u01b0\u01a1ng t\u1ef1 m\u00e0 ch\u00fang ta \u0111\u00e3 l\u00e0m trong c\u00e1c ph\u1ea7n tr\u01b0\u1edbc. Lo\u1ea1i b\u1ecf t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed kh\u00f4ng ch\u1ee9a th\u1eeba s\u1ed1 $p$. \u0110i\u1ec1u n\u00e0y \u0111\u1ec3 l\u1ea1i $\\lfloor n/p \\rfloor$ ph\u1ea7n t\u1eed c\u00f2n l\u1ea1i. N\u1ebfu ch\u00fang ta lo\u1ea1i b\u1ecf th\u1eeba s\u1ed1 $p$ kh\u1ecfi m\u1ed7i ch\u00fang, ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c t\u00edch $1 \\cdot 2 \\cdots \\lfloor n/p \\rfloor = \\lfloor n/p \\rfloor !$, v\u00e0 m\u1ed9t l\u1ea7n n\u1eefa ch\u00fang ta c\u00f3 m\u1ed9t \u0111\u1ec7 quy.</p>","tags":["Translated"]},{"location":"algebra/factorial-modulo.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 117</li> <li>Translated lines: 117</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Translated"]},{"location":"algebra/factoring-exp.html","title":"L\u0169y th\u1eeba nh\u1ecb ph\u00e2n b\u1eb1ng ph\u00e2n t\u00edch th\u1eeba s\u1ed1 (Binary Exponentiation by Factoring)","text":"<p>X\u00e9t b\u00e0i to\u00e1n t\u00ednh $ax^y \\pmod{2^d}$, cho c\u00e1c s\u1ed1 nguy\u00ean $a$, $x$, $y$ v\u00e0 $d \\geq 3$, trong \u0111\u00f3 $x$ l\u00e0 s\u1ed1 l\u1ebb.</p> <p>Thu\u1eadt to\u00e1n d\u01b0\u1edbi \u0111\u00e2y cho ph\u00e9p gi\u1ea3i quy\u1ebft b\u00e0i to\u00e1n n\u00e0y v\u1edbi $O(d)$ ph\u00e9p c\u1ed9ng v\u00e0 ph\u00e9p to\u00e1n bit v\u00e0 m\u1ed9t ph\u00e9p nh\u00e2n duy nh\u1ea5t v\u1edbi $y$.</p> <p>Do c\u1ea5u tr\u00fac c\u1ee7a nh\u00f3m nh\u00e2n modulo $2^d$, b\u1ea5t k\u1ef3 s\u1ed1 $x$ n\u00e0o sao cho $x \\equiv 1 \\pmod 4$ \u0111\u1ec1u c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n d\u01b0\u1edbi d\u1ea1ng</p> $$ x \\equiv b^{L(x)} \\pmod{2^d}, $$ <p>trong \u0111\u00f3 $b \\equiv 5 \\pmod 8$. Kh\u00f4ng m\u1ea5t t\u00ednh t\u1ed5ng qu\u00e1t, ch\u00fang t\u00f4i gi\u1ea3 s\u1eed r\u1eb1ng $x \\equiv 1 \\pmod 4$, v\u00ec ch\u00fang ta c\u00f3 th\u1ec3 quy $x \\equiv 3 \\pmod 4$ th\u00e0nh $x \\equiv 1 \\pmod 4$ b\u1eb1ng c\u00e1ch thay th\u1ebf $x \\mapsto -x$ v\u00e0 $a \\mapsto (-1)^{y} a$. Trong k\u00fd hi\u1ec7u n\u00e0y, $ax^y$ \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n d\u01b0\u1edbi d\u1ea1ng</p> $$ a x^y \\equiv a b^{yL(x)} \\pmod{2^d}. $$ <p>\u00dd t\u01b0\u1edfng c\u1ed1t l\u00f5i c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \u0111\u01a1n gi\u1ea3n h\u00f3a vi\u1ec7c t\u00ednh to\u00e1n $L(x)$ v\u00e0 $b^{y L(x)}$ b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng th\u1ef1c t\u1ebf r\u1eb1ng ch\u00fang ta \u0111ang l\u00e0m vi\u1ec7c modulo $2^d$. V\u00ec nh\u1eefng l\u00fd do s\u1ebd r\u00f5 r\u00e0ng sau n\u00e0y, ch\u00fang ta s\u1ebd l\u00e0m vi\u1ec7c v\u1edbi $4L(x)$ thay v\u00ec $L(x)$, nh\u01b0ng l\u1ea5y modulo $2^d$ thay v\u00ec $2^{d-2}$.</p> <p>Trong b\u00e0i vi\u1ebft n\u00e0y, ch\u00fang t\u00f4i s\u1ebd \u0111\u1ec1 c\u1eadp \u0111\u1ebfn vi\u1ec7c c\u00e0i \u0111\u1eb7t cho c\u00e1c s\u1ed1 nguy\u00ean $32$-bit. G\u1ecdi</p> <ul> <li><code>mbin_log_32(r, x)</code> l\u00e0 h\u00e0m t\u00ednh $r+4L(x) \\pmod{2^d}$;</li> <li><code>mbin_exp_32(r, x)</code> l\u00e0 h\u00e0m t\u00ednh $r b^{\\frac{x}{4}} \\pmod{2^d}$;</li> <li><code>mbin_power_odd_32(a, x, y)</code> l\u00e0 h\u00e0m t\u00ednh $ax^y \\pmod{2^d}$.</li> </ul> <p>Khi \u0111\u00f3 <code>mbin_power_odd_32</code> \u0111\u01b0\u1ee3c c\u00e0i \u0111\u1eb7t nh\u01b0 sau:</p> <pre><code>uint32_t mbin_power_odd_32(uint32_t rem, uint32_t base, uint32_t exp) {\n    if (base &amp; 2) {\n        /* divider is considered negative */\n        base = -base;\n        /* check if result should be negative */\n        if (exp &amp; 1) {\n            rem = -rem;\n        }\n    }\n    return (mbin_exp_32(rem, mbin_log_32(0, base) * exp));\n}\n</code></pre>","tags":["Original"]},{"location":"algebra/factoring-exp.html#computing-4l-x-from-x","title":"T\u00ednh 4L(x) t\u1eeb x (Computing 4L(x) from x)","text":"<p>Cho $x$ l\u00e0 m\u1ed9t s\u1ed1 l\u1ebb sao cho $x \\equiv 1 \\pmod 4$. N\u00f3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n d\u01b0\u1edbi d\u1ea1ng </p> $$ x \\equiv (2^{a_1}+1)\\dots(2^{a_k}+1) \\pmod{2^d}, $$ <p>trong \u0111\u00f3 $1 &lt; a_1 &lt; \\dots &lt; a_k &lt; d$. \u1ede \u0111\u00e2y $L(\\cdot)$ \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh r\u00f5 cho t\u1eebng nh\u00e2n t\u1eed, v\u00ec ch\u00fang b\u1eb1ng $1$ modulo $4$. Do \u0111\u00f3,</p> $$ 4L(x) \\equiv 4L(2^{a_1}+1)+\\dots+4L(2^{a_k}+1) \\pmod{2^{d}}. $$ <p>V\u00ec v\u1eady, n\u1ebfu ch\u00fang ta t\u00ednh tr\u01b0\u1edbc $t_k = 4L(2^n+1)$ cho t\u1ea5t c\u1ea3 $1 &lt; k &lt; d$, ch\u00fang ta s\u1ebd c\u00f3 th\u1ec3 t\u00ednh $4L(x)$ cho b\u1ea5t k\u1ef3 s\u1ed1 $x$ n\u00e0o.</p> <p>\u0110\u1ed1i v\u1edbi s\u1ed1 nguy\u00ean 32-bit, ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng b\u1ea3ng sau:</p> <pre><code>const uint32_t mbin_log_32_table[32] = {\n    0x00000000, 0x00000000, 0xd3cfd984, 0x9ee62e18,\n    0xe83d9070, 0xb59e81e0, 0xa17407c0, 0xce601f80,\n    0xf4807f00, 0xe701fe00, 0xbe07fc00, 0xfc1ff800,\n    0xf87ff000, 0xf1ffe000, 0xe7ffc000, 0xdfff8000,\n    0xffff0000, 0xfffe0000, 0xfffc0000, 0xfff80000,\n    0xfff00000, 0xffe00000, 0xffc00000, 0xff800000,\n    0xff000000, 0xfe000000, 0xfc000000, 0xf8000000,\n    0xf0000000, 0xe0000000, 0xc0000000, 0x80000000,\n};\n</code></pre> <p>Trong th\u1ef1c t\u1ebf, m\u1ed9t c\u00e1ch ti\u1ebfp c\u1eadn h\u01a1i kh\u00e1c \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng so v\u1edbi m\u00f4 t\u1ea3 \u1edf tr\u00ean. Thay v\u00ec t\u00ecm ph\u00e2n t\u00edch th\u1eeba s\u1ed1 cho $x$, ch\u00fang ta s\u1ebd nh\u00e2n $x$ v\u1edbi $2^n+1$ cho \u0111\u1ebfn khi ch\u00fang ta bi\u1ebfn \u0111\u1ed5i n\u00f3 th\u00e0nh $1$ modulo $2^d$. B\u1eb1ng c\u00e1ch n\u00e0y, ch\u00fang ta s\u1ebd t\u00ecm th\u1ea5y bi\u1ec3u di\u1ec5n c\u1ee7a $x^{-1}$, \u0111\u00f3 l\u00e0</p> $$ x (2^{a_1}+1)\\dots(2^{a_k}+1) \\equiv 1 \\pmod {2^d}. $$ <p>\u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y, ch\u00fang ta l\u1eb7p qua $n$ sao cho $1 &lt; n &lt; d$. N\u1ebfu $x$ hi\u1ec7n t\u1ea1i c\u00f3 bit th\u1ee9 $n$ \u0111\u01b0\u1ee3c b\u1eadt, ch\u00fang ta nh\u00e2n $x$ v\u1edbi $2^n+1$, \u0111i\u1ec1u n\u00e0y \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n thu\u1eadn ti\u1ec7n trong C++ l\u00e0 <code>x = x + (x &lt;&lt; n)</code>. \u0110i\u1ec1u n\u00e0y s\u1ebd kh\u00f4ng thay \u0111\u1ed5i c\u00e1c bit th\u1ea5p h\u01a1n $n$, nh\u01b0ng s\u1ebd chuy\u1ec3n bit th\u1ee9 $n$ th\u00e0nh kh\u00f4ng, v\u00ec $x$ l\u00e0 s\u1ed1 l\u1ebb.</p> <p>V\u1edbi t\u1ea5t c\u1ea3 nh\u1eefng \u0111i\u1ec1u n\u00e0y, h\u00e0m <code>mbin_log_32(r, x)</code> \u0111\u01b0\u1ee3c c\u00e0i \u0111\u1eb7t nh\u01b0 sau:</p> <pre><code>uint32_t mbin_log_32(uint32_t r, uint32_t x) {\n    uint8_t n;\n\n    for (n = 2; n &lt; 32; n++) {\n        if (x &amp; (1 &lt;&lt; n)) {\n            x = x + (x &lt;&lt; n);\n            r -= mbin_log_32_table[n];\n        }\n    }\n\n    return r;\n}\n</code></pre> <p>L\u01b0u \u00fd r\u1eb1ng $4L(x) = -4L(x^{-1})$, v\u00ec v\u1eady thay v\u00ec c\u1ed9ng $4L(2^n+1)$, ch\u00fang ta tr\u1eeb n\u00f3 kh\u1ecfi $r$, m\u00e0 ban \u0111\u1ea7u b\u1eb1ng $0$.</p>","tags":["Original"]},{"location":"algebra/factoring-exp.html#computing-x-from-4l-x","title":"T\u00ednh x t\u1eeb 4L(x) (Computing x from 4L(x))","text":"<p>L\u01b0u \u00fd r\u1eb1ng v\u1edbi $k \\geq 1$ th\u00ec \u0111i\u1ec1u sau \u0111\u00fang</p> $$ (a 2^{k}+1)^2 = a^2 2^{2k} +a 2^{k+1}+1 = b2^{k+1}+1, $$ <p>t\u1eeb \u0111\u00f3 (b\u1eb1ng c\u00e1ch b\u00ecnh ph\u01b0\u01a1ng l\u1eb7p l\u1ea1i) ch\u00fang ta c\u00f3 th\u1ec3 suy ra r\u1eb1ng</p> $$ (2^a+1)^{2^b} \\equiv 1 \\pmod{2^{a+b}}. $$ <p>\u00c1p d\u1ee5ng k\u1ebft qu\u1ea3 n\u00e0y cho $a=2^n+1$ v\u00e0 $b=d-k$ ch\u00fang ta suy ra r\u1eb1ng c\u1ea5p s\u1ed1 nh\u00e2n c\u1ee7a $2^n+1$ l\u00e0 m\u1ed9t \u01b0\u1edbc c\u1ee7a $2^{d-n}$.</p> <p>\u0110i\u1ec1u n\u00e0y, l\u1ea7n l\u01b0\u1ee3t, c\u00f3 ngh\u0129a l\u00e0 $L(2^n+1)$ ph\u1ea3i chia h\u1ebft cho $2^{n}$, v\u00ec c\u1ea5p c\u1ee7a $b$ l\u00e0 $2^{d-2}$ v\u00e0 c\u1ea5p c\u1ee7a $b^y$ l\u00e0 $2^{d-2-v}$, trong \u0111\u00f3 $2^v$ l\u00e0 l\u0169y th\u1eeba cao nh\u1ea5t c\u1ee7a $2$ chia h\u1ebft $y$, v\u00ec v\u1eady ch\u00fang ta c\u1ea7n</p> $$ 2^{d-k} \\equiv 0 \\pmod{2^{d-2-v}}, $$ <p>do \u0111\u00f3 $v$ ph\u1ea3i l\u1edbn h\u01a1n ho\u1eb7c b\u1eb1ng $k-2$. \u0110i\u1ec1u n\u00e0y h\u01a1i x\u1ea5u v\u00e0 \u0111\u1ec3 gi\u1ea3m thi\u1ec3u \u0111i\u1ec1u n\u00e0y, ch\u00fang ta \u0111\u00e3 n\u00f3i ban \u0111\u1ea7u r\u1eb1ng ch\u00fang ta nh\u00e2n $L(x)$ v\u1edbi $4$. B\u00e2y gi\u1edd n\u1ebfu ch\u00fang ta bi\u1ebft $4L(x)$, ch\u00fang ta c\u00f3 th\u1ec3 ph\u00e2n t\u00edch duy nh\u1ea5t n\u00f3 th\u00e0nh t\u1ed5ng c\u1ee7a $4L(2^n+1)$ b\u1eb1ng c\u00e1ch ki\u1ec3m tra c\u00e1c bit trong $4L(x)$. N\u1ebfu bit th\u1ee9 $n$ \u0111\u01b0\u1ee3c \u0111\u1eb7t th\u00e0nh $1$, ch\u00fang ta s\u1ebd nh\u00e2n k\u1ebft qu\u1ea3 v\u1edbi $2^n+1$ v\u00e0 gi\u1ea3m $4L(x)$ hi\u1ec7n t\u1ea1i \u0111i $4L(2^n+1)$.</p> <p>Do \u0111\u00f3, <code>mbin_exp_32</code> \u0111\u01b0\u1ee3c c\u00e0i \u0111\u1eb7t nh\u01b0 sau:</p> <pre><code>uint32_t mbin_exp_32(uint32_t r, uint32_t x) {\n    uint8_t n;\n\n    for (n = 2; n &lt; 32; n++) {\n        if (x &amp; (1 &lt;&lt; n)) {\n            r = r + (r &lt;&lt; n);\n            x -= mbin_log_32_table[n];\n        }\n    }\n\n    return r;\n}\n</code></pre>","tags":["Original"]},{"location":"algebra/factoring-exp.html#further-optimizations","title":"C\u00e1c t\u1ed1i \u01b0u h\u00f3a kh\u00e1c (Further optimizations)","text":"<p>C\u00f3 th\u1ec3 gi\u1ea3m m\u1ed9t n\u1eeda s\u1ed1 v\u00f2ng l\u1eb7p n\u1ebfu b\u1ea1n l\u01b0u \u00fd r\u1eb1ng $4L(2^{d-1}+1)=2^{d-1}$ v\u00e0 r\u1eb1ng v\u1edbi $2k \\geq d$ th\u00ec \u0111i\u1ec1u sau \u0111\u00fang</p> $$ (2^n+1)^2 \\equiv 2^{2n} + 2^{n+1}+1 \\equiv 2^{n+1}+1 \\pmod{2^d}, $$ <p>cho ph\u00e9p suy ra r\u1eb1ng $4L(2^n+1)=2^n$ v\u1edbi $2n \\geq d$. V\u00ec v\u1eady, b\u1ea1n c\u00f3 th\u1ec3 \u0111\u01a1n gi\u1ea3n h\u00f3a thu\u1eadt to\u00e1n b\u1eb1ng c\u00e1ch ch\u1ec9 \u0111i \u0111\u1ebfn $\\frac{d}{2}$ v\u00e0 sau \u0111\u00f3 s\u1eed d\u1ee5ng th\u1ef1c t\u1ebf \u1edf tr\u00ean \u0111\u1ec3 t\u00ednh ph\u1ea7n c\u00f2n l\u1ea1i b\u1eb1ng c\u00e1c ph\u00e9p to\u00e1n bit:</p> <pre><code>uint32_t mbin_log_32(uint32_t r, uint32_t x) {\n    uint8_t n;\n\n    for (n = 2; n != 16; n++) {\n        if (x &amp; (1 &lt;&lt; n)) {\n            x = x + (x &lt;&lt; n);\n            r -= mbin_log_32_table[n];\n        }\n    }\n\n    r -= (x &amp; 0xFFFF0000);\n\n    return r;\n}\n\nuint32_t mbin_exp_32(uint32_t r, uint32_t x) {\n    uint8_t n;\n\n    for (n = 2; n != 16; n++) {\n        if (x &amp; (1 &lt;&lt; n)) {\n            r = r + (r &lt;&lt; n);\n            x -= mbin_log_32_table[n];\n        }\n    }\n\n    r *= 1 - (x &amp; 0xFFFF0000);\n\n    return r;\n}\n</code></pre>","tags":["Original"]},{"location":"algebra/factoring-exp.html#computing-logarithm-table","title":"T\u00ednh b\u1ea3ng logarit (Computing logarithm table)","text":"<p>\u0110\u1ec3 t\u00ednh b\u1ea3ng log, ng\u01b0\u1eddi ta c\u00f3 th\u1ec3 s\u1eeda \u0111\u1ed5i thu\u1eadt to\u00e1n Pohlig\u2013Hellman cho tr\u01b0\u1eddng h\u1ee3p khi modulo l\u00e0 l\u0169y th\u1eeba c\u1ee7a $2$.</p> <p>Nhi\u1ec7m v\u1ee5 ch\u00ednh c\u1ee7a ch\u00fang ta \u1edf \u0111\u00e2y l\u00e0 t\u00ednh $x$ sao cho $g^x \\equiv y \\pmod{2^d}$, trong \u0111\u00f3 $g=5$ v\u00e0 $y$ l\u00e0 m\u1ed9t s\u1ed1 lo\u1ea1i $2^n+1$. </p> <p>B\u00ecnh ph\u01b0\u01a1ng c\u1ea3 hai ph\u1ea7n $k$ l\u1ea7n ch\u00fang ta \u0111i \u0111\u1ebfn</p> $$ g^{2^k x} \\equiv y^{2^k} \\pmod{2^d}. $$ <p>L\u01b0u \u00fd r\u1eb1ng c\u1ea5p c\u1ee7a $g$ kh\u00f4ng l\u1edbn h\u01a1n $2^{d}$ (th\u1ef1c t\u1ebf, l\u00e0 $2^{d-2}$, nh\u01b0ng ch\u00fang ta s\u1ebd gi\u1eef $2^d$ cho thu\u1eadn ti\u1ec7n), do \u0111\u00f3 s\u1eed d\u1ee5ng $k=d-1$ ch\u00fang ta s\u1ebd c\u00f3 ho\u1eb7c $g^1$ ho\u1eb7c $g^0$ \u1edf ph\u00eda b\u00ean tr\u00e1i cho ph\u00e9p ch\u00fang ta x\u00e1c \u0111\u1ecbnh bit nh\u1ecf nh\u1ea5t c\u1ee7a $x$ b\u1eb1ng c\u00e1ch so s\u00e1nh $y^{2^k}$ v\u1edbi $g$. B\u00e2y gi\u1edd gi\u1ea3 s\u1eed r\u1eb1ng $x=x_0 + 2^k x_1$, trong \u0111\u00f3 $x_0$ l\u00e0 ph\u1ea7n \u0111\u00e3 bi\u1ebft v\u00e0 $x_1$ ch\u01b0a bi\u1ebft. Khi \u0111\u00f3</p> $$ g^{x_0+2^k x_1} \\equiv y \\pmod{2^d}. $$ <p>Nh\u00e2n c\u1ea3 hai ph\u1ea7n v\u1edbi $g^{-x_0}$, ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c</p> $$ g^{2^k x_1} \\equiv (g^{-x_0} y) \\pmod{2^d}. $$ <p>B\u00e2y gi\u1edd, b\u00ecnh ph\u01b0\u01a1ng c\u1ea3 hai v\u1ebf $d-k-1$ l\u1ea7n ch\u00fang ta c\u00f3 th\u1ec3 thu \u0111\u01b0\u1ee3c bit ti\u1ebfp theo c\u1ee7a $x$, cu\u1ed1i c\u00f9ng kh\u00f4i ph\u1ee5c t\u1ea5t c\u1ea3 c\u00e1c bit c\u1ee7a n\u00f3.</p>","tags":["Original"]},{"location":"algebra/factoring-exp.html#references","title":"Tham kh\u1ea3o","text":"<ul> <li>M30, Hans Petter Selasky, 2009</li> </ul>","tags":["Original"]},{"location":"algebra/factoring-exp.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 218</li> <li>Translated lines: 218</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Original"]},{"location":"algebra/factorization.html","title":"Ph\u00e2n t\u00edch ra th\u1eeba s\u1ed1 nguy\u00ean (Integer factorization)","text":"<p>Trong b\u00e0i vi\u1ebft n\u00e0y, ch\u00fang t\u00f4i li\u1ec7t k\u00ea m\u1ed9t s\u1ed1 thu\u1eadt to\u00e1n \u0111\u1ec3 ph\u00e2n t\u00edch c\u00e1c s\u1ed1 nguy\u00ean ra th\u1eeba s\u1ed1, m\u1ed7i thu\u1eadt to\u00e1n c\u00f3 th\u1ec3 nhanh ho\u1eb7c ch\u1eadm t\u00f9y thu\u1ed9c v\u00e0o \u0111\u1ea7u v\u00e0o c\u1ee7a ch\u00fang.</p> <p>L\u01b0u \u00fd, n\u1ebfu s\u1ed1 m\u00e0 b\u1ea1n mu\u1ed1n ph\u00e2n t\u00edch th\u1ef1c s\u1ef1 l\u00e0 m\u1ed9t s\u1ed1 nguy\u00ean t\u1ed1, h\u1ea7u h\u1ebft c\u00e1c thu\u1eadt to\u00e1n s\u1ebd ch\u1ea1y r\u1ea5t ch\u1eadm. \u0110i\u1ec1u n\u00e0y \u0111\u1eb7c bi\u1ec7t \u0111\u00fang \u0111\u1ed1i v\u1edbi c\u00e1c thu\u1eadt to\u00e1n ph\u00e2n t\u00edch th\u1eeba s\u1ed1 Fermat, Pollard's p-1 v\u00e0 Pollard's rho. Do \u0111\u00f3, vi\u1ec7c th\u1ef1c hi\u1ec7n m\u1ed9t ki\u1ec3m tra s\u1ed1 nguy\u00ean t\u1ed1 x\u00e1c su\u1ea5t (ho\u1eb7c t\u1ea5t \u0111\u1ecbnh nhanh) tr\u01b0\u1edbc khi c\u1ed1 g\u1eafng ph\u00e2n t\u00edch s\u1ed1 \u0111\u00f3 l\u00e0 h\u1ee3p l\u00fd nh\u1ea5t.</p>","tags":["Original"]},{"location":"algebra/factorization.html#trial-division","title":"Chia th\u1eed (Trial division)","text":"<p>\u0110\u00e2y l\u00e0 thu\u1eadt to\u00e1n c\u01a1 b\u1ea3n nh\u1ea5t \u0111\u1ec3 t\u00ecm ph\u00e2n t\u00edch th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1.</p> <p>Ch\u00fang ta chia cho t\u1eebng \u01b0\u1edbc s\u1ed1 c\u00f3 th\u1ec3 $d$. C\u00f3 th\u1ec3 nh\u1eadn th\u1ea5y r\u1eb1ng kh\u00f4ng th\u1ec3 c\u00f3 t\u1ea5t c\u1ea3 c\u00e1c th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1 c\u1ee7a m\u1ed9t h\u1ee3p s\u1ed1 $n$ l\u1edbn h\u01a1n $\\sqrt{n}$. Do \u0111\u00f3, ch\u00fang ta ch\u1ec9 c\u1ea7n ki\u1ec3m tra c\u00e1c \u01b0\u1edbc s\u1ed1 $2 \\le d \\le \\sqrt{n}$, \u0111i\u1ec1u n\u00e0y cho ch\u00fang ta ph\u00e2n t\u00edch th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1 trong $O(\\sqrt{n})$. (\u0110\u00e2y l\u00e0 th\u1eddi gian gi\u1ea3 \u0111a th\u1ee9c, t\u1ee9c l\u00e0 \u0111a th\u1ee9c theo gi\u00e1 tr\u1ecb c\u1ee7a \u0111\u1ea7u v\u00e0o nh\u01b0ng m\u0169 theo s\u1ed1 l\u01b0\u1ee3ng bit c\u1ee7a \u0111\u1ea7u v\u00e0o.)</p> <p>\u01af\u1edbc s\u1ed1 nh\u1ecf nh\u1ea5t ph\u1ea3i l\u00e0 m\u1ed9t s\u1ed1 nguy\u00ean t\u1ed1. Ch\u00fang ta lo\u1ea1i b\u1ecf s\u1ed1 \u0111\u00e3 ph\u00e2n t\u00edch, v\u00e0 ti\u1ebfp t\u1ee5c qu\u00e1 tr\u00ecnh. N\u1ebfu ch\u00fang ta kh\u00f4ng th\u1ec3 t\u00ecm th\u1ea5y b\u1ea5t k\u1ef3 \u01b0\u1edbc s\u1ed1 n\u00e0o trong kho\u1ea3ng $[2; \\sqrt{n}]$, th\u00ec ch\u00ednh s\u1ed1 \u0111\u00f3 ph\u1ea3i l\u00e0 s\u1ed1 nguy\u00ean t\u1ed1.</p> <pre><code>vector&lt;long long&gt; trial_division1(long long n) {\n    vector&lt;long long&gt; factorization;\n    for (long long d = 2; d * d &lt;= n; d++) {\n        while (n % d == 0) {\n            factorization.push_back(d);\n            n /= d;\n        }\n    }\n    if (n &gt; 1)\n        factorization.push_back(n);\n    return factorization;\n}\n</code></pre>","tags":["Original"]},{"location":"algebra/factorization.html#wheel-factorization","title":"Ph\u00e2n t\u00edch th\u1eeba s\u1ed1 b\u1eb1ng b\u00e1nh xe (Wheel factorization)","text":"<p>\u0110\u00e2y l\u00e0 m\u1ed9t s\u1ef1 t\u1ed1i \u01b0u h\u00f3a c\u1ee7a chia th\u1eed. Khi ch\u00fang ta bi\u1ebft r\u1eb1ng s\u1ed1 kh\u00f4ng chia h\u1ebft cho 2, ch\u00fang ta kh\u00f4ng c\u1ea7n ki\u1ec3m tra c\u00e1c s\u1ed1 ch\u1eb5n kh\u00e1c. \u0110i\u1ec1u n\u00e0y \u0111\u1ec3 l\u1ea1i cho ch\u00fang ta ch\u1ec9 $50\\%$ s\u1ed1 l\u01b0\u1ee3ng s\u1ed1 c\u1ea7n ki\u1ec3m tra. Sau khi lo\u1ea1i b\u1ecf th\u1eeba s\u1ed1 2, v\u00e0 nh\u1eadn \u0111\u01b0\u1ee3c m\u1ed9t s\u1ed1 l\u1ebb, ch\u00fang ta c\u00f3 th\u1ec3 ch\u1ec9 c\u1ea7n b\u1eaft \u0111\u1ea7u v\u1edbi 3 v\u00e0 ch\u1ec9 \u0111\u1ebfm c\u00e1c s\u1ed1 l\u1ebb kh\u00e1c.</p> <pre><code>vector&lt;long long&gt; trial_division2(long long n) {\n    vector&lt;long long&gt; factorization;\n    while (n % 2 == 0) {\n        factorization.push_back(2);\n        n /= 2;\n    }\n    for (long long d = 3; d * d &lt;= n; d += 2) {\n        while (n % d == 0) {\n            factorization.push_back(d);\n            n /= d;\n        }\n    }\n    if (n &gt; 1)\n        factorization.push_back(n);\n    return factorization;\n}\n</code></pre> <p>Ph\u01b0\u01a1ng ph\u00e1p n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c m\u1edf r\u1ed9ng h\u01a1n n\u1eefa. N\u1ebfu s\u1ed1 kh\u00f4ng chia h\u1ebft cho 3, ch\u00fang ta c\u0169ng c\u00f3 th\u1ec3 b\u1ecf qua t\u1ea5t c\u1ea3 c\u00e1c b\u1ed9i s\u1ed1 kh\u00e1c c\u1ee7a 3 trong c\u00e1c t\u00ednh to\u00e1n trong t\u01b0\u01a1ng lai. V\u00ec v\u1eady ch\u00fang ta ch\u1ec9 c\u1ea7n ki\u1ec3m tra c\u00e1c s\u1ed1 $5, 7, 11, 13, 17, 19, 23, \\dots$. Ch\u00fang ta c\u00f3 th\u1ec3 quan s\u00e1t m\u1ed9t m\u1eabu c\u1ee7a c\u00e1c s\u1ed1 c\u00f2n l\u1ea1i n\u00e0y. Ch\u00fang ta c\u1ea7n ki\u1ec3m tra t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 c\u00f3 $d \\bmod 6 = 1$ v\u00e0 $d \\bmod 6 = 5$. V\u00ec v\u1eady \u0111i\u1ec1u n\u00e0y \u0111\u1ec3 l\u1ea1i cho ch\u00fang ta ch\u1ec9 $33.3\\%$ ph\u1ea7n tr\u0103m s\u1ed1 l\u01b0\u1ee3ng s\u1ed1 c\u1ea7n ki\u1ec3m tra. Ch\u00fang ta c\u00f3 th\u1ec3 c\u00e0i \u0111\u1eb7t \u0111i\u1ec1u n\u00e0y b\u1eb1ng c\u00e1ch lo\u1ea1i b\u1ecf c\u00e1c th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1 2 v\u00e0 3 tr\u01b0\u1edbc, sau \u0111\u00f3 ch\u00fang ta b\u1eaft \u0111\u1ea7u v\u1edbi 5 v\u00e0 ch\u1ec9 \u0111\u1ebfm c\u00e1c s\u1ed1 d\u01b0 $1$ v\u00e0 $5$ modulo $6$.</p> <p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u1ed9t c\u00e0i \u0111\u1eb7t cho c\u00e1c s\u1ed1 nguy\u00ean t\u1ed1 2, 3 v\u00e0 5. Thu\u1eadn ti\u1ec7n khi l\u01b0u tr\u1eef c\u00e1c b\u01b0\u1edbc nh\u1ea3y trong m\u1ed9t m\u1ea3ng.</p> <pre><code>vector&lt;long long&gt; trial_division3(long long n) {\n    vector&lt;long long&gt; factorization;\n    for (int d : {2, 3, 5}) {\n        while (n % d == 0) {\n            factorization.push_back(d);\n            n /= d;\n        }\n    }\n    static array&lt;int, 8&gt; increments = {4, 2, 4, 2, 4, 6, 2, 6};\n    int i = 0;\n    for (long long d = 7; d * d &lt;= n; d += increments[i++]) {\n        while (n % d == 0) {\n            factorization.push_back(d);\n            n /= d;\n        }\n        if (i == 8)\n            i = 0;\n    }\n    if (n &gt; 1)\n        factorization.push_back(n);\n    return factorization;\n}\n</code></pre> <p>N\u1ebfu ch\u00fang ta ti\u1ebfp t\u1ee5c m\u1edf r\u1ed9ng ph\u01b0\u01a1ng ph\u00e1p n\u00e0y \u0111\u1ec3 bao g\u1ed3m nhi\u1ec1u s\u1ed1 nguy\u00ean t\u1ed1 h\u01a1n n\u1eefa, t\u1ef7 l\u1ec7 ph\u1ea7n tr\u0103m t\u1ed1t h\u01a1n c\u00f3 th\u1ec3 \u0111\u1ea1t \u0111\u01b0\u1ee3c, nh\u01b0ng danh s\u00e1ch b\u1ecf qua s\u1ebd tr\u1edf n\u00ean l\u1edbn h\u01a1n.</p>","tags":["Original"]},{"location":"algebra/factorization.html#precomputed-primes","title":"C\u00e1c s\u1ed1 nguy\u00ean t\u1ed1 t\u00ednh tr\u01b0\u1edbc (Precomputed primes)","text":"<p>M\u1edf r\u1ed9ng ph\u01b0\u01a1ng ph\u00e1p ph\u00e2n t\u00edch th\u1eeba s\u1ed1 b\u1eb1ng b\u00e1nh xe v\u00f4 th\u1eddi h\u1ea1n, ch\u00fang ta s\u1ebd ch\u1ec9 c\u00f2n l\u1ea1i c\u00e1c s\u1ed1 nguy\u00ean t\u1ed1 c\u1ea7n ki\u1ec3m tra.  M\u1ed9t c\u00e1ch t\u1ed1t \u0111\u1ec3 ki\u1ec3m tra \u0111i\u1ec1u n\u00e0y l\u00e0 t\u00ednh tr\u01b0\u1edbc t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 nguy\u00ean t\u1ed1 b\u1eb1ng S\u00e0ng Eratosthenes cho \u0111\u1ebfn $\\sqrt{n}$, v\u00e0 ki\u1ec3m tra ch\u00fang m\u1ed9t c\u00e1ch ri\u00eang l\u1ebb.</p> <pre><code>vector&lt;long long&gt; primes;\n\nvector&lt;long long&gt; trial_division4(long long n) {\n    vector&lt;long long&gt; factorization;\n    for (long long d : primes) {\n        if (d * d &gt; n)\n            break;\n        while (n % d == 0) {\n            factorization.push_back(d);\n            n /= d;\n        }\n    }\n    if (n &gt; 1)\n        factorization.push_back(n);\n    return factorization;\n}\n</code></pre>","tags":["Original"]},{"location":"algebra/factorization.html#fermats-factorization-method","title":"Ph\u01b0\u01a1ng ph\u00e1p ph\u00e2n t\u00edch th\u1eeba s\u1ed1 Fermat (Fermat's factorization method)","text":"<p>Ch\u00fang ta c\u00f3 th\u1ec3 vi\u1ebft m\u1ed9t h\u1ee3p s\u1ed1 l\u1ebb $n = p \\cdot q$ d\u01b0\u1edbi d\u1ea1ng hi\u1ec7u c\u1ee7a hai b\u00ecnh ph\u01b0\u01a1ng $n = a^2 - b^2$:</p> $$n = \\left(\\frac{p + q}{2}\\right)^2 - \\left(\\frac{p - q}{2}\\right)^2$$ <p>Ph\u01b0\u01a1ng ph\u00e1p ph\u00e2n t\u00edch th\u1eeba s\u1ed1 Fermat c\u1ed1 g\u1eafng khai th\u00e1c th\u1ef1c t\u1ebf n\u00e0y b\u1eb1ng c\u00e1ch \u0111o\u00e1n b\u00ecnh ph\u01b0\u01a1ng \u0111\u1ea7u ti\u00ean $a^2$, v\u00e0 ki\u1ec3m tra xem ph\u1ea7n c\u00f2n l\u1ea1i, $b^2 = a^2 - n$, c\u00f3 ph\u1ea3i l\u00e0 m\u1ed9t s\u1ed1 ch\u00ednh ph\u01b0\u01a1ng hay kh\u00f4ng. N\u1ebfu \u0111\u00fang, th\u00ec ch\u00fang ta \u0111\u00e3 t\u00ecm th\u1ea5y c\u00e1c th\u1eeba s\u1ed1 $a - b$ v\u00e0 $a + b$ c\u1ee7a $n$.</p> <pre><code>int fermat(int n) {\n    int a = ceil(sqrt(n));\n    int b2 = a*a - n;\n    int b = round(sqrt(b2));\n    while (b * b != b2) {\n        a = a + 1;\n        b2 = a*a - n;\n        b = round(sqrt(b2));\n    }\n    return a - b;\n}\n</code></pre> <p>Ph\u01b0\u01a1ng ph\u00e1p ph\u00e2n t\u00edch th\u1eeba s\u1ed1 n\u00e0y c\u00f3 th\u1ec3 r\u1ea5t nhanh n\u1ebfu s\u1ef1 kh\u00e1c bi\u1ec7t gi\u1eefa hai th\u1eeba s\u1ed1 $p$ v\u00e0 $q$ nh\u1ecf. Thu\u1eadt to\u00e1n ch\u1ea1y trong th\u1eddi gian $O(|p - q|)$. Tuy nhi\u00ean trong th\u1ef1c t\u1ebf, ph\u01b0\u01a1ng ph\u00e1p n\u00e0y hi\u1ebfm khi \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng. M\u1ed9t khi c\u00e1c th\u1eeba s\u1ed1 tr\u1edf n\u00ean xa nhau h\u01a1n, n\u00f3 c\u1ef1c k\u1ef3 ch\u1eadm.</p> <p>Tuy nhi\u00ean, v\u1eabn c\u00f3 m\u1ed9t s\u1ed1 l\u01b0\u1ee3ng l\u1edbn c\u00e1c t\u00f9y ch\u1ecdn t\u1ed1i \u01b0u h\u00f3a li\u00ean quan \u0111\u1ebfn ph\u01b0\u01a1ng ph\u00e1p n\u00e0y. B\u1eb1ng c\u00e1ch xem x\u00e9t c\u00e1c b\u00ecnh ph\u01b0\u01a1ng $a^2$ modulo m\u1ed9t s\u1ed1 nh\u1ecf c\u1ed1 \u0111\u1ecbnh, c\u00f3 th\u1ec3 quan s\u00e1t th\u1ea5y r\u1eb1ng m\u1ed9t s\u1ed1 gi\u00e1 tr\u1ecb $a$ nh\u1ea5t \u0111\u1ecbnh kh\u00f4ng c\u1ea7n ph\u1ea3i xem, v\u00ec ch\u00fang kh\u00f4ng th\u1ec3 t\u1ea1o ra m\u1ed9t s\u1ed1 ch\u00ednh ph\u01b0\u01a1ng $a^2 - n$.</p>","tags":["Original"]},{"location":"algebra/factorization.html#pollards-p-1-method","title":"Ph\u01b0\u01a1ng ph\u00e1p Pollard's $p - 1$ (Pollard's $p - 1$ method)","text":"<p>R\u1ea5t c\u00f3 kh\u1ea3 n\u0103ng m\u1ed9t s\u1ed1 $n$ c\u00f3 \u00edt nh\u1ea5t m\u1ed9t th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1 $p$ sao cho $p - 1$ l\u00e0 $\\mathrm{B}$-l\u0169y th\u1eeba tr\u01a1n (powersmooth) v\u1edbi $\\mathrm{B}$ nh\u1ecf. M\u1ed9t s\u1ed1 nguy\u00ean $m$ \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 $\\mathrm{B}$-l\u0169y th\u1eeba tr\u01a1n n\u1ebfu m\u1ecdi l\u0169y th\u1eeba nguy\u00ean t\u1ed1 chia h\u1ebft $m$ \u0111\u1ec1u t\u1ed1i \u0111a l\u00e0 $\\mathrm{B}$. M\u1ed9t c\u00e1ch h\u00ecnh th\u1ee9c, cho $\\mathrm{B} \\geqslant 1$ v\u00e0 cho $m$ l\u00e0 b\u1ea5t k\u1ef3 s\u1ed1 nguy\u00ean d\u01b0\u01a1ng n\u00e0o. Gi\u1ea3 s\u1eed ph\u00e2n t\u00edch th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1 c\u1ee7a $m$ l\u00e0 $m = \\prod {q_i}^{e_i}$, trong \u0111\u00f3 m\u1ed7i $q_i$ l\u00e0 m\u1ed9t s\u1ed1 nguy\u00ean t\u1ed1 v\u00e0 $e_i \\geqslant 1$. Khi \u0111\u00f3 $m$ l\u00e0 $\\mathrm{B}$-l\u0169y th\u1eeba tr\u01a1n n\u1ebfu, v\u1edbi m\u1ecdi $i$, ${q_i}^{e_i} \\leqslant \\mathrm{B}$.  V.d. ph\u00e2n t\u00edch th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1 c\u1ee7a $4817191$ l\u00e0 $1303 \\cdot 3697$. V\u00e0 c\u00e1c gi\u00e1 tr\u1ecb, $1303 - 1$ v\u00e0 $3697 - 1$, l\u1ea7n l\u01b0\u1ee3t l\u00e0 $31$-l\u0169y th\u1eeba tr\u01a1n v\u00e0 $16$-l\u0169y th\u1eeba tr\u01a1n, v\u00ec $1303 - 1 = 2 \\cdot 3 \\cdot 7 \\cdot 31$ v\u00e0 $3697 - 1 = 2^4 \\cdot 3 \\cdot 7 \\cdot 11$. N\u0103m 1974 John Pollard \u0111\u00e3 ph\u00e1t minh ra m\u1ed9t ph\u01b0\u01a1ng ph\u00e1p \u0111\u1ec3 tr\u00edch xu\u1ea5t c\u00e1c th\u1eeba s\u1ed1 $p$, sao cho $p-1$ l\u00e0 $\\mathrm{B}$-l\u0169y th\u1eeba tr\u01a1n, t\u1eeb m\u1ed9t h\u1ee3p s\u1ed1.</p> <p>\u00dd t\u01b0\u1edfng \u0111\u1ebfn t\u1eeb \u0110\u1ecbnh l\u00fd Fermat nh\u1ecf. Cho ph\u00e2n t\u00edch th\u1eeba s\u1ed1 c\u1ee7a $n$ l\u00e0 $n = p \\cdot q$. N\u00f3 n\u00f3i r\u1eb1ng n\u1ebfu $a$ nguy\u00ean t\u1ed1 c\u00f9ng nhau v\u1edbi $p$, th\u00ec m\u1ec7nh \u0111\u1ec1 sau \u0111\u00fang:</p> $$a^{p - 1} \\equiv 1 \\pmod{p}$$ <p>\u0110i\u1ec1u n\u00e0y c\u0169ng c\u00f3 ngh\u0129a l\u00e0</p> $${\\left(a^{(p - 1)}\\right)}^k \\equiv a^{k \\cdot (p - 1)} \\equiv 1 \\pmod{p}.$$ <p>V\u00ec v\u1eady v\u1edbi b\u1ea5t k\u1ef3 $M$ n\u00e0o c\u00f3 $p - 1 ~|~ M$ ch\u00fang ta bi\u1ebft r\u1eb1ng $a^M \\equiv 1$. \u0110i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 $a^M - 1 = p \\cdot r$, v\u00e0 do \u0111\u00f3 c\u0169ng c\u00f3 $p ~|~ \\gcd(a^M - 1, n)$.</p> <p>Do \u0111\u00f3, n\u1ebfu $p - 1$ \u0111\u1ed1i v\u1edbi m\u1ed9t th\u1eeba s\u1ed1 $p$ c\u1ee7a $n$ chia h\u1ebft $M$, ch\u00fang ta c\u00f3 th\u1ec3 tr\u00edch xu\u1ea5t m\u1ed9t th\u1eeba s\u1ed1 b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng thu\u1eadt to\u00e1n Euclid.</p> <p>R\u00f5 r\u00e0ng l\u00e0 $M$ nh\u1ecf nh\u1ea5t l\u00e0 b\u1ed9i s\u1ed1 c\u1ee7a m\u1ecdi s\u1ed1 $\\mathrm{B}$-l\u0169y th\u1eeba tr\u01a1n l\u00e0 $\\text{lcm}(1,~2~,3~,4~,~\\dots,~B)$. Ho\u1eb7c c\u00e1ch kh\u00e1c:</p> $$M = \\prod_{\\text{s\u1ed1 nguy\u00ean t\u1ed1 } q \\le B} q^{\\lfloor \\log_q B \\rfloor}$$ <p>L\u01b0u \u00fd, n\u1ebfu $p-1$ chia h\u1ebft $M$ \u0111\u1ed1i v\u1edbi t\u1ea5t c\u1ea3 c\u00e1c th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1 $p$ c\u1ee7a $n$, th\u00ec $\\gcd(a^M - 1, n)$ s\u1ebd ch\u1ec9 l\u00e0 $n$. Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y ch\u00fang ta kh\u00f4ng nh\u1eadn \u0111\u01b0\u1ee3c m\u1ed9t th\u1eeba s\u1ed1. Do \u0111\u00f3, ch\u00fang ta s\u1ebd c\u1ed1 g\u1eafng th\u1ef1c hi\u1ec7n $\\gcd$ nhi\u1ec1u l\u1ea7n, trong khi ch\u00fang ta t\u00ednh to\u00e1n $M$.</p> <p>M\u1ed9t s\u1ed1 h\u1ee3p s\u1ed1 kh\u00f4ng c\u00f3 c\u00e1c th\u1eeba s\u1ed1 $p$ sao cho $p-1$ l\u00e1 $\\mathrm{B}$-l\u0169y th\u1eeba tr\u01a1n v\u1edbi $\\mathrm{B}$ nh\u1ecf. V\u00ed d\u1ee5, \u0111\u1ed1i v\u1edbi h\u1ee3p s\u1ed1 $100~000~000~000~000~493 = 763~013 \\cdot 131~059~365~961$, c\u00e1c gi\u00e1 tr\u1ecb $p-1$ t\u01b0\u01a1ng \u1ee9ng l\u00e0 $190~753$-l\u0169y th\u1eeba tr\u01a1n v\u00e0 $1~092~161~383$-l\u0169y th\u1eeba tr\u01a1n. Ch\u00fang ta s\u1ebd ph\u1ea3i ch\u1ecdn $B \\geq 190~753$ \u0111\u1ec3 ph\u00e2n t\u00edch th\u1eeba s\u1ed1 c\u1ee7a s\u1ed1 n\u00e0y.</p> <p>Trong c\u00e0i \u0111\u1eb7t sau, ch\u00fang t\u00f4i b\u1eaft \u0111\u1ea7u v\u1edbi $\\mathrm{B} = 10$ v\u00e0 t\u0103ng $\\mathrm{B}$ sau m\u1ed7i l\u1ea7n l\u1eb7p.</p> <pre><code>long long pollards_p_minus_1(long long n) {\n    int B = 10;\n    long long g = 1;\n    while (B &lt;= 1000000 &amp;&amp; g &lt; n) {\n        long long a = 2 + rand() %  (n - 3);\n        g = gcd(a, n);\n        if (g &gt; 1)\n            return g;\n\n        // t\u00ednh a^M\n        for (int p : primes) {\n            if (p &gt;= B)\n                continue;\n            long long p_power = 1;\n            while (p_power * p &lt;= B)\n                p_power *= p;\n            a = power(a, p_power, n);\n\n            g = gcd(a - 1, n);\n            if (g &gt; 1 &amp;&amp; g &lt; n)\n                return g;\n        }\n        B *= 2;\n    }\n    return 1;\n}\n</code></pre> <p>Quan s\u00e1t th\u1ea5y r\u1eb1ng \u0111\u00e2y l\u00e0 m\u1ed9t thu\u1eadt to\u00e1n x\u00e1c su\u1ea5t. H\u1ec7 qu\u1ea3 c\u1ee7a \u0111i\u1ec1u n\u00e0y l\u00e0 c\u00f3 kh\u1ea3 n\u0103ng thu\u1eadt to\u00e1n ho\u00e0n to\u00e0n kh\u00f4ng th\u1ec3 t\u00ecm th\u1ea5y m\u1ed9t th\u1eeba s\u1ed1.</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p l\u00e0 $O(B \\log B \\log^2 n)$ m\u1ed7i l\u1ea7n l\u1eb7p.</p>","tags":["Original"]},{"location":"algebra/factorization.html#pollards-rho-algorithm","title":"Thu\u1eadt to\u00e1n Pollard's rho (Pollard's rho algorithm)","text":"<p>Thu\u1eadt to\u00e1n Pollard's Rho l\u00e0 m\u1ed9t thu\u1eadt to\u00e1n ph\u00e2n t\u00edch th\u1eeba s\u1ed1 kh\u00e1c c\u1ee7a John Pollard.</p> <p>Cho ph\u00e2n t\u00edch th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1 c\u1ee7a m\u1ed9t s\u1ed1 l\u00e0 $n = p q$. Thu\u1eadt to\u00e1n xem x\u00e9t m\u1ed9t d\u00e3y gi\u1ea3 ng\u1eabu nhi\u00ean $\\{x_i\\} = \\{x_0,~f(x_0),~f(f(x_0)),~\\dots\\}$ trong \u0111\u00f3 $f$ l\u00e0 m\u1ed9t h\u00e0m \u0111a th\u1ee9c, th\u01b0\u1eddng $f(x) = (x^2 + c) \\bmod n$ \u0111\u01b0\u1ee3c ch\u1ecdn v\u1edbi $c = 1$.</p> <p>Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, ch\u00fang ta kh\u00f4ng quan t\u00e2m \u0111\u1ebfn d\u00e3y $\\{x_i\\}$.  Ch\u00fang ta quan t\u00e2m nhi\u1ec1u h\u01a1n \u0111\u1ebfn d\u00e3y $\\{x_i \\bmod p\\}$. V\u00ec $f$ l\u00e0 m\u1ed9t h\u00e0m \u0111a th\u1ee9c, v\u00e0 t\u1ea5t c\u1ea3 c\u00e1c gi\u00e1 tr\u1ecb \u0111\u1ec1u n\u1eb1m trong kho\u1ea3ng $[0;~p)$, d\u00e3y n\u00e0y cu\u1ed1i c\u00f9ng s\u1ebd h\u1ed9i t\u1ee5 th\u00e0nh m\u1ed9t v\u00f2ng l\u1eb7p. Ngh\u1ecbch l\u00fd ng\u00e0y sinh th\u1ef1c s\u1ef1 g\u1ee3i \u00fd r\u1eb1ng s\u1ed1 l\u01b0\u1ee3ng ph\u1ea7n t\u1eed k\u1ef3 v\u1ecdng l\u00e0 $O(\\sqrt{p})$ cho \u0111\u1ebfn khi s\u1ef1 l\u1eb7p l\u1ea1i b\u1eaft \u0111\u1ea7u. N\u1ebfu $p$ nh\u1ecf h\u01a1n $\\sqrt{n}$, s\u1ef1 l\u1eb7p l\u1ea1i c\u00f3 kh\u1ea3 n\u0103ng s\u1ebd b\u1eaft \u0111\u1ea7u trong $O(\\sqrt[4]{n})$.</p> <p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 h\u00ecnh \u1ea3nh tr\u1ef1c quan c\u1ee7a m\u1ed9t d\u00e3y nh\u01b0 v\u1eady $\\{x_i \\bmod p\\}$ v\u1edbi $n = 2206637$, $p = 317$, $x_0 = 2$ v\u00e0 $f(x) = x^2 + 1$. T\u1eeb d\u1ea1ng c\u1ee7a d\u00e3y, b\u1ea1n c\u00f3 th\u1ec3 th\u1ea5y r\u1ea5t r\u00f5 t\u1ea1i sao thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 thu\u1eadt to\u00e1n Pollard's $\\rho$.</p> <p>Tuy nhi\u00ean, v\u1eabn c\u00f2n m\u1ed9t c\u00e2u h\u1ecfi m\u1edf. L\u00e0m th\u1ebf n\u00e0o ch\u00fang ta c\u00f3 th\u1ec3 khai th\u00e1c c\u00e1c t\u00ednh ch\u1ea5t c\u1ee7a d\u00e3y $\\{x_i \\bmod p\\}$ \u0111\u1ec3 c\u00f3 l\u1ee3i cho ch\u00fang ta m\u00e0 kh\u00f4ng c\u1ea7n bi\u1ebft ch\u00ednh s\u1ed1 $p$?</p> <p>N\u00f3 th\u1ef1c s\u1ef1 kh\u00e1 d\u1ec5 d\u00e0ng. C\u00f3 m\u1ed9t chu tr\u00ecnh trong d\u00e3y $\\{x_i \\bmod p\\}_{i \\le j}$ khi v\u00e0 ch\u1ec9 khi c\u00f3 hai ch\u1ec9 s\u1ed1 $s, t \\le j$ sao cho $x_s \\equiv x_t \\bmod p$. Ph\u01b0\u01a1ng tr\u00ecnh n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c vi\u1ebft l\u1ea1i th\u00e0nh $x_s - x_t \\equiv 0 \\bmod p$ hay t\u01b0\u01a1ng t\u1ef1 l\u00e0 $p ~|~ \\gcd(x_s - x_t, n)$.</p> <p>Do \u0111\u00f3, n\u1ebfu ch\u00fang ta t\u00ecm th\u1ea5y hai ch\u1ec9 s\u1ed1 $s$ v\u00e0 $t$ v\u1edbi $g = \\gcd(x_s - x_t, n) &gt; 1$, ch\u00fang ta \u0111\u00e3 t\u00ecm th\u1ea5y m\u1ed9t chu tr\u00ecnh v\u00e0 c\u0169ng l\u00e0 m\u1ed9t th\u1eeba s\u1ed1 $g$ c\u1ee7a $n$. C\u00f3 th\u1ec3 x\u1ea3y ra tr\u01b0\u1eddng h\u1ee3p $g = n$. Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, ch\u00fang ta ch\u01b0a t\u00ecm th\u1ea5y m\u1ed9t th\u1eeba s\u1ed1 th\u00edch h\u1ee3p, v\u00ec v\u1eady ch\u00fang ta ph\u1ea3i l\u1eb7p l\u1ea1i thu\u1eadt to\u00e1n v\u1edbi m\u1ed9t tham s\u1ed1 kh\u00e1c (gi\u00e1 tr\u1ecb b\u1eaft \u0111\u1ea7u $x_0$ kh\u00e1c, h\u1eb1ng s\u1ed1 $c$ kh\u00e1c trong h\u00e0m \u0111a th\u1ee9c $f$).</p> <p>\u0110\u1ec3 t\u00ecm chu tr\u00ecnh, ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng b\u1ea5t k\u1ef3 thu\u1eadt to\u00e1n ph\u00e1t hi\u1ec7n chu tr\u00ecnh ph\u1ed5 bi\u1ebfn n\u00e0o.</p>","tags":["Original"]},{"location":"algebra/factorization.html#floyds-cycle-finding-algorithm","title":"Thu\u1eadt to\u00e1n t\u00ecm chu tr\u00ecnh c\u1ee7a Floyd (Floyd's cycle-finding algorithm)","text":"<p>Thu\u1eadt to\u00e1n n\u00e0y t\u00ecm m\u1ed9t chu tr\u00ecnh b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng hai con tr\u1ecf di chuy\u1ec3n tr\u00ean d\u00e3y v\u1edbi t\u1ed1c \u0111\u1ed9 kh\u00e1c nhau. Trong m\u1ed7i l\u1ea7n l\u1eb7p, con tr\u1ecf \u0111\u1ea7u ti\u00ean s\u1ebd ti\u1ebfn m\u1ed9t ph\u1ea7n t\u1eed, trong khi con tr\u1ecf th\u1ee9 hai ti\u1ebfn \u0111\u1ebfn m\u1ed7i ph\u1ea7n t\u1eed kh\u00e1c. S\u1eed d\u1ee5ng \u00fd t\u01b0\u1edfng n\u00e0y, d\u1ec5 d\u00e0ng quan s\u00e1t th\u1ea5y r\u1eb1ng n\u1ebfu c\u00f3 m\u1ed9t chu tr\u00ecnh, t\u1ea1i m\u1ed9t th\u1eddi \u0111i\u1ec3m n\u00e0o \u0111\u00f3, con tr\u1ecf th\u1ee9 hai s\u1ebd quay l\u1ea1i g\u1eb7p con tr\u1ecf \u0111\u1ea7u ti\u00ean trong c\u00e1c v\u00f2ng l\u1eb7p. N\u1ebfu \u0111\u1ed9 d\u00e0i chu tr\u00ecnh l\u00e0 $\\lambda$ v\u00e0 $\\mu$ l\u00e0 ch\u1ec9 s\u1ed1 \u0111\u1ea7u ti\u00ean m\u00e0 chu tr\u00ecnh b\u1eaft \u0111\u1ea7u, th\u00ec thu\u1eadt to\u00e1n s\u1ebd ch\u1ea1y trong th\u1eddi gian $O(\\lambda + \\mu)$.</p> <p>Thu\u1eadt to\u00e1n n\u00e0y c\u00f2n \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 Thu\u1eadt to\u00e1n R\u00f9a v\u00e0 Th\u1ecf, d\u1ef1a tr\u00ean c\u00e2u chuy\u1ec7n ng\u1ee5 ng\u00f4n trong \u0111\u00f3 m\u1ed9t con r\u00f9a (con tr\u1ecf ch\u1eadm) v\u00e0 m\u1ed9t con th\u1ecf (con tr\u1ecf nhanh h\u01a1n) ch\u1ea1y \u0111ua.</p> <p>Th\u1ef1c s\u1ef1 c\u00f3 th\u1ec3 x\u00e1c \u0111\u1ecbnh tham s\u1ed1 $\\lambda$ v\u00e0 $\\mu$ b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng thu\u1eadt to\u00e1n n\u00e0y (c\u0169ng trong th\u1eddi gian $O(\\lambda + \\mu)$ v\u00e0 kh\u00f4ng gian $O(1)$). Khi ph\u00e1t hi\u1ec7n th\u1ea5y chu tr\u00ecnh, thu\u1eadt to\u00e1n s\u1ebd tr\u1ea3 v\u1ec1 'True'.  N\u1ebfu d\u00e3y kh\u00f4ng c\u00f3 chu tr\u00ecnh, th\u00ec h\u00e0m s\u1ebd l\u1eb7p v\u00f4 h\u1ea1n. Tuy nhi\u00ean, s\u1eed d\u1ee5ng thu\u1eadt to\u00e1n Pollard's Rho, \u0111i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 ph\u00f2ng tr\u00e1nh \u0111\u01b0\u1ee3c. </p> <pre><code>function floyd(f, x0):\n    tortoise = x0\n    hare = f(x0)\n    while tortoise != hare:\n        tortoise = f(tortoise)\n        hare = f(f(hare))\n    return true\n</code></pre>","tags":["Original"]},{"location":"algebra/factorization.html#implementation","title":"C\u00e0i \u0111\u1eb7t","text":"<p>\u0110\u1ea7u ti\u00ean, \u0111\u00e2y l\u00e0 m\u1ed9t c\u00e0i \u0111\u1eb7t s\u1eed d\u1ee5ng thu\u1eadt to\u00e1n t\u00ecm chu tr\u00ecnh c\u1ee7a Floyd. Thu\u1eadt to\u00e1n th\u01b0\u1eddng ch\u1ea1y trong th\u1eddi gian $O(\\sqrt[4]{n} \\log(n))$.</p> <pre><code>long long mult(long long a, long long b, long long mod) {\n    return (__int128)a * b % mod;\n}\n\nlong long f(long long x, long long c, long long mod) {\n    return (mult(x, x, mod) + c) % mod;\n}\n\nlong long rho(long long n, long long x0=2, long long c=1) {\n    long long x = x0;\n    long long y = x0;\n    long long g = 1;\n    while (g == 1) {\n        x = f(x, c, n);\n        y = f(y, c, n);\n        y = f(y, c, n);\n        g = gcd(abs(x - y), n);\n    }\n    return g;\n}\n</code></pre> <p>B\u1ea3ng sau \u0111\u00e2y hi\u1ec3n th\u1ecb c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a $x$ v\u00e0 $y$ trong qu\u00e1 tr\u00ecnh th\u1ef1c hi\u1ec7n thu\u1eadt to\u00e1n cho $n = 2206637$, $x_0 = 2$ v\u00e0 $c = 1$.</p> $$ \\newcommand\\T{\\Rule{0pt}{1em}{.3em}} \\begin{array}{|l|l|l|l|l|l|} \\hline i &amp; x_i \\bmod n &amp; x_{2i} \\bmod n &amp; x_i \\bmod 317 &amp; x_{2i} \\bmod 317 &amp; \\gcd(x_i - x_{2i}, n) \\\\ \\hline 0   &amp; 2       &amp; 2       &amp; 2       &amp; 2       &amp; -   \\\\ 1   &amp; 5       &amp; 26      &amp; 5       &amp; 26      &amp; 1   \\\\ 2   &amp; 26      &amp; 458330  &amp; 26      &amp; 265     &amp; 1   \\\\ 3   &amp; 677     &amp; 1671573 &amp; 43      &amp; 32      &amp; 1   \\\\ 4   &amp; 458330  &amp; 641379  &amp; 265     &amp; 88      &amp; 1   \\\\ 5   &amp; 1166412 &amp; 351937  &amp; 169     &amp; 67      &amp; 1   \\\\ 6   &amp; 1671573 &amp; 1264682 &amp; 32      &amp; 169     &amp; 1   \\\\ 7   &amp; 2193080 &amp; 2088470 &amp; 74      &amp; 74      &amp; 317 \\\\ \\hline \\end{array}$$ <p>C\u00e0i \u0111\u1eb7t s\u1eed d\u1ee5ng h\u00e0m <code>mult</code>, nh\u00e2n hai s\u1ed1 nguy\u00ean $\\le 10^{18}$ m\u00e0 kh\u00f4ng b\u1ecb tr\u00e0n b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng ki\u1ec3u <code>__int128</code> c\u1ee7a GCC cho s\u1ed1 nguy\u00ean 128-bit. N\u1ebfu kh\u00f4ng c\u00f3 s\u1eb5n GCC, b\u1ea1n c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng \u00fd t\u01b0\u1edfng t\u01b0\u01a1ng t\u1ef1 nh\u01b0 l\u0169y th\u1eeba nh\u1ecb ph\u00e2n.</p> <pre><code>long long mult(long long a, long long b, long long mod) {\n    long long result = 0;\n    while (b) {\n        if (b &amp; 1)\n            result = (result + a) % mod;\n        a = (a + a) % mod;\n        b &gt;&gt;= 1;\n    }\n    return result;\n}\n</code></pre> <p>Ngo\u00e0i ra b\u1ea1n c\u0169ng c\u00f3 th\u1ec3 c\u00e0i \u0111\u1eb7t Ph\u00e9p nh\u00e2n Montgomery.</p> <p>Nh\u01b0 \u0111\u00e3 n\u00eau tr\u01b0\u1edbc \u0111\u00f3, n\u1ebfu $n$ l\u00e0 h\u1ee3p s\u1ed1 v\u00e0 thu\u1eadt to\u00e1n tr\u1ea3 v\u1ec1 $n$ l\u00e0 th\u1eeba s\u1ed1, b\u1ea1n ph\u1ea3i l\u1eb7p l\u1ea1i quy tr\u00ecnh v\u1edbi c\u00e1c tham s\u1ed1 kh\u00e1c nhau $x_0$ v\u00e0 $c$. V.d. l\u1ef1a ch\u1ecdn $x_0 = c = 1$ s\u1ebd kh\u00f4ng ph\u00e2n t\u00edch \u0111\u01b0\u1ee3c $25 = 5 \\cdot 5$. Thu\u1eadt to\u00e1n s\u1ebd tr\u1ea3 v\u1ec1 $25$. Tuy nhi\u00ean, l\u1ef1a ch\u1ecdn $x_0 = 1$, $c = 2$ s\u1ebd ph\u00e2n t\u00edch \u0111\u01b0\u1ee3c n\u00f3.</p>","tags":["Original"]},{"location":"algebra/factorization.html#brents-algorithm","title":"Thu\u1eadt to\u00e1n Brent (Brent's algorithm)","text":"<p>Brent c\u00e0i \u0111\u1eb7t m\u1ed9t ph\u01b0\u01a1ng ph\u00e1p t\u01b0\u01a1ng t\u1ef1 nh\u01b0 Floyd, s\u1eed d\u1ee5ng hai con tr\u1ecf. S\u1ef1 kh\u00e1c bi\u1ec7t l\u00e0 thay v\u00ec ti\u1ebfn c\u00e1c con tr\u1ecf m\u1ed9t v\u00e0 hai v\u1ecb tr\u00ed t\u01b0\u01a1ng \u1ee9ng, ch\u00fang \u0111\u01b0\u1ee3c ti\u1ebfn theo l\u0169y th\u1eeba c\u1ee7a hai.  Ngay khi $2^i$ l\u1edbn h\u01a1n $\\lambda$ v\u00e0 $\\mu$, ch\u00fang ta s\u1ebd t\u00ecm th\u1ea5y chu tr\u00ecnh.</p> <pre><code>function floyd(f, x0):\n    tortoise = x0\n    hare = f(x0)\n    l = 1\n    while tortoise != hare:\n        tortoise = hare\n        repeat l times:\n            hare = f(hare)\n            if tortoise == hare:\n                return true\n        l *= 2\n    return true\n</code></pre> <p>Thu\u1eadt to\u00e1n Brent c\u0169ng ch\u1ea1y trong th\u1eddi gian tuy\u1ebfn t\u00ednh, nh\u01b0ng th\u01b0\u1eddng nhanh h\u01a1n Floyd, v\u00ec n\u00f3 s\u1eed d\u1ee5ng \u00edt l\u1ea7n \u0111\u00e1nh gi\u00e1 h\u00e0m $f$ h\u01a1n.</p>","tags":["Original"]},{"location":"algebra/factorization.html#implementation-1","title":"C\u00e0i \u0111\u1eb7t","text":"<p>C\u00e0i \u0111\u1eb7t \u0111\u01a1n gi\u1ea3n c\u1ee7a thu\u1eadt to\u00e1n Brent c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u0103ng t\u1ed1c b\u1eb1ng c\u00e1ch b\u1ecf qua c\u00e1c s\u1ed1 h\u1ea1ng $x_l - x_k$ n\u1ebfu $k &lt; \\frac{3 \\cdot l}{2}$. Ngo\u00e0i ra, thay v\u00ec th\u1ef1c hi\u1ec7n t\u00ednh to\u00e1n $\\gcd$ \u1edf m\u1ed7i b\u01b0\u1edbc, ch\u00fang ta nh\u00e2n c\u00e1c s\u1ed1 h\u1ea1ng v\u00e0 ch\u1ec9 th\u1ef1c s\u1ef1 ki\u1ec3m tra $\\gcd$ sau m\u1ed7i v\u00e0i b\u01b0\u1edbc v\u00e0 quay lui n\u1ebfu v\u01b0\u1ee3t qu\u00e1.</p> <pre><code>long long brent(long long n, long long x0=2, long long c=1) {\n    long long x = x0;\n    long long g = 1;\n    long long q = 1;\n    long long xs, y;\n\n    int m = 128;\n    int l = 1;\n    while (g == 1) {\n        y = x;\n        for (int i = 1; i &lt; l; i++)\n            x = f(x, c, n);\n        int k = 0;\n        while (k &lt; l &amp;&amp; g == 1) {\n            xs = x;\n            for (int i = 0; i &lt; m &amp;&amp; i &lt; l - k; i++) {\n                x = f(x, c, n);\n                q = mult(q, abs(y - x), n);\n            }\n            g = gcd(q, n);\n            k += m;\n        }\n        l *= 2;\n    }\n    if (g == n) {\n        do {\n            xs = f(xs, c, n);\n            g = gcd(abs(xs - y), n);\n        } while (g == 1);\n    }\n    return g;\n}\n</code></pre> <p>S\u1ef1 k\u1ebft h\u1ee3p c\u1ee7a ph\u00e9p chia th\u1eed cho c\u00e1c s\u1ed1 nguy\u00ean t\u1ed1 nh\u1ecf c\u00f9ng v\u1edbi phi\u00ean b\u1ea3n thu\u1eadt to\u00e1n Pollard's rho c\u1ee7a Brent t\u1ea1o n\u00ean m\u1ed9t thu\u1eadt to\u00e1n ph\u00e2n t\u00edch th\u1eeba s\u1ed1 r\u1ea5t m\u1ea1nh m\u1ebd.</p>","tags":["Original"]},{"location":"algebra/factorization.html#practice-problems","title":"B\u00e0i t\u1eadp luy\u1ec7n t\u1eadp","text":"<ul> <li>SPOJ - FACT0</li> <li>SPOJ - FACT1</li> <li>SPOJ - FACT2</li> <li>GCPC 15 - Divisions</li> </ul>","tags":["Original"]},{"location":"algebra/factorization.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 430</li> <li>Translated lines: 430</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Original"]},{"location":"algebra/fft.html","title":"Bi\u1ebfn \u0111\u1ed5i Fourier nhanh (Fast Fourier transform)","text":"<p>Trong b\u00e0i vi\u1ebft n\u00e0y, ch\u00fang t\u00f4i s\u1ebd th\u1ea3o lu\u1eadn v\u1ec1 m\u1ed9t thu\u1eadt to\u00e1n cho ph\u00e9p ch\u00fang ta nh\u00e2n hai \u0111a th\u1ee9c c\u00f3 \u0111\u1ed9 d\u00e0i $n$ trong th\u1eddi gian $O(n \\log n)$, t\u1ed1t h\u01a1n ph\u00e9p nh\u00e2n t\u1ea7m th\u01b0\u1eddng th\u00f4ng th\u01b0\u1eddng m\u1ea5t th\u1eddi gian $O(n^2)$. R\u00f5 r\u00e0ng vi\u1ec7c nh\u00e2n hai s\u1ed1 l\u1edbn c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c \u0111\u01b0a v\u1ec1 vi\u1ec7c nh\u00e2n c\u00e1c \u0111a th\u1ee9c, v\u00ec v\u1eady hai s\u1ed1 l\u1edbn c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c nh\u00e2n trong th\u1eddi gian $O(n \\log n)$ (trong \u0111\u00f3 $n$ l\u00e0 s\u1ed1 ch\u1eef s\u1ed1 trong c\u00e1c s\u1ed1).</p> <p>Vi\u1ec7c kh\u00e1m ph\u00e1 ra bi\u1ebfn \u0111\u1ed5i Fourier nhanh (Fast Fourier transformation - FFT) \u0111\u01b0\u1ee3c cho l\u00e0 c\u1ee7a Cooley v\u00e0 Tukey, nh\u1eefng ng\u01b0\u1eddi \u0111\u00e3 c\u00f4ng b\u1ed1 m\u1ed9t thu\u1eadt to\u00e1n v\u00e0o n\u0103m 1965. Nh\u01b0ng th\u1ef1c t\u1ebf FFT \u0111\u00e3 \u0111\u01b0\u1ee3c ph\u00e1t hi\u1ec7n l\u1eb7p \u0111i l\u1eb7p l\u1ea1i tr\u01b0\u1edbc \u0111\u00f3, nh\u01b0ng t\u1ea7m quan tr\u1ecdng c\u1ee7a n\u00f3 \u0111\u00e3 kh\u00f4ng \u0111\u01b0\u1ee3c hi\u1ec3u tr\u01b0\u1edbc khi c\u00f3 c\u00e1c ph\u00e1t minh c\u1ee7a m\u00e1y t\u00ednh hi\u1ec7n \u0111\u1ea1i. M\u1ed9t s\u1ed1 nh\u00e0 nghi\u00ean c\u1ee9u cho r\u1eb1ng vi\u1ec7c kh\u00e1m ph\u00e1 ra FFT l\u00e0 c\u1ee7a Runge v\u00e0 K\u00f6nig v\u00e0o n\u0103m 1924. Nh\u01b0ng th\u1ef1c s\u1ef1 Gauss \u0111\u00e3 ph\u00e1t tri\u1ec3n m\u1ed9t ph\u01b0\u01a1ng ph\u00e1p nh\u01b0 v\u1eady v\u00e0o n\u0103m 1805, nh\u01b0ng ch\u01b0a bao gi\u1edd c\u00f4ng b\u1ed1 n\u00f3.</p> <p>L\u01b0u \u00fd r\u1eb1ng thu\u1eadt to\u00e1n FFT \u0111\u01b0\u1ee3c tr\u00ecnh b\u00e0y \u1edf \u0111\u00e2y ch\u1ea1y trong th\u1eddi gian $O(n \\log n)$, nh\u01b0ng n\u00f3 kh\u00f4ng ho\u1ea1t \u0111\u1ed9ng \u0111\u1ec3 nh\u00e2n c\u00e1c \u0111a th\u1ee9c l\u1edbn t\u00f9y \u00fd v\u1edbi c\u00e1c h\u1ec7 s\u1ed1 l\u1edbn t\u00f9y \u00fd ho\u1eb7c \u0111\u1ec3 nh\u00e2n c\u00e1c s\u1ed1 nguy\u00ean l\u1edbn t\u00f9y \u00fd. N\u00f3 c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng x\u1eed l\u00fd c\u00e1c \u0111a th\u1ee9c c\u00f3 k\u00edch th\u01b0\u1edbc $10^5$ v\u1edbi c\u00e1c h\u1ec7 s\u1ed1 nh\u1ecf, ho\u1eb7c nh\u00e2n hai s\u1ed1 c\u00f3 k\u00edch th\u01b0\u1edbc $10^6$, th\u01b0\u1eddng l\u00e0 \u0111\u1ee7 \u0111\u1ec3 gi\u1ea3i quy\u1ebft c\u00e1c b\u00e0i to\u00e1n l\u1eadp tr\u00ecnh thi \u0111\u1ea5u. Ngo\u00e0i quy m\u00f4 nh\u00e2n c\u00e1c s\u1ed1 c\u00f3 $10^6$ bit, ph\u1ea1m vi v\u00e0 \u0111\u1ed9 ch\u00ednh x\u00e1c c\u1ee7a c\u00e1c s\u1ed1 d\u1ea5u ph\u1ea9y \u0111\u1ed9ng \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng trong qu\u00e1 tr\u00ecnh t\u00ednh to\u00e1n s\u1ebd kh\u00f4ng \u0111\u1ee7 \u0111\u1ec3 \u0111\u01b0a ra k\u1ebft qu\u1ea3 cu\u1ed1i c\u00f9ng ch\u00ednh x\u00e1c, m\u1eb7c d\u00f9 c\u00f3 nh\u1eefng bi\u1ebfn th\u1ec3 ph\u1ee9c t\u1ea1p h\u01a1n c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n ph\u00e9p nh\u00e2n \u0111a th\u1ee9c/s\u1ed1 nguy\u00ean l\u1edbn t\u00f9y \u00fd. V\u00ed d\u1ee5: v\u00e0o n\u0103m 1971 Sch\u00f6nhage v\u00e0 Strasser \u0111\u00e3 ph\u00e1t tri\u1ec3n m\u1ed9t bi\u1ebfn th\u1ec3 \u0111\u1ec3 nh\u00e2n c\u00e1c s\u1ed1 l\u1edbn t\u00f9y \u00fd \u00e1p d\u1ee5ng FFT \u0111\u1ec7 quy trong c\u00e1c c\u1ea5u tr\u00fac v\u00e0nh ch\u1ea1y trong $O(n \\log n \\log \\log n)$. V\u00e0 g\u1ea7n \u0111\u00e2y (v\u00e0o n\u0103m 2019) Harvey v\u00e0 van der Hoeven \u0111\u00e3 c\u00f4ng b\u1ed1 m\u1ed9t thu\u1eadt to\u00e1n ch\u1ea1y trong \u0111\u00fang $O(n \\log n)$.</p>","tags":["Translated"]},{"location":"algebra/fft.html#discrete-fourier-transform","title":"Bi\u1ebfn \u0111\u1ed5i Fourier r\u1eddi r\u1ea1c (Discrete Fourier transform)","text":"<p>Gi\u1ea3 s\u1eed c\u00f3 m\u1ed9t \u0111a th\u1ee9c b\u1eadc $n - 1$:</p> $$A(x) = a_0 x^0 + a_1 x^1 + \\dots + a_{n-1} x^{n-1}$$ <p>Kh\u00f4ng m\u1ea5t t\u00ednh t\u1ed5ng qu\u00e1t, ch\u00fang ta gi\u1ea3 s\u1eed r\u1eb1ng $n$ - s\u1ed1 l\u01b0\u1ee3ng h\u1ec7 s\u1ed1 - l\u00e0 l\u0169y th\u1eeba c\u1ee7a $2$. N\u1ebfu $n$ kh\u00f4ng ph\u1ea3i l\u00e0 l\u0169y th\u1eeba c\u1ee7a $2$, th\u00ec ch\u00fang ta ch\u1ec9 c\u1ea7n th\u00eam c\u00e1c s\u1ed1 h\u1ea1ng c\u00f2n thi\u1ebfu $a_i x^i$ v\u00e0 \u0111\u1eb7t c\u00e1c h\u1ec7 s\u1ed1 $a_i$ th\u00e0nh $0$.</p> <p>L\u00fd thuy\u1ebft s\u1ed1 ph\u1ee9c cho ch\u00fang ta bi\u1ebft r\u1eb1ng ph\u01b0\u01a1ng tr\u00ecnh $x^n = 1$ c\u00f3 $n$ nghi\u1ec7m ph\u1ee9c (\u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 c\u0103n b\u1eadc $n$ c\u1ee7a \u0111\u01a1n v\u1ecb), v\u00e0 c\u00e1c nghi\u1ec7m c\u00f3 d\u1ea1ng $w_{n, k} = e^{\\frac{2 k \\pi i}{n}}$ v\u1edbi $k = 0 \\dots n-1$. Ngo\u00e0i ra, c\u00e1c s\u1ed1 ph\u1ee9c n\u00e0y c\u00f3 m\u1ed9t s\u1ed1 t\u00ednh ch\u1ea5t r\u1ea5t th\u00fa v\u1ecb: v\u00ed d\u1ee5: c\u0103n b\u1eadc $n$ ch\u00ednh $w_n = w_{n, 1} = e^{\\frac{2 \\pi i}{n}}$ c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 m\u00f4 t\u1ea3 t\u1ea5t c\u1ea3 c\u00e1c c\u0103n b\u1eadc $n$ kh\u00e1c: $w_{n, k} = (w_n)^k$.</p> <p>Bi\u1ebfn \u0111\u1ed5i Fourier r\u1eddi r\u1ea1c (DFT) c\u1ee7a \u0111a th\u1ee9c $A(x)$ (ho\u1eb7c t\u01b0\u01a1ng \u0111\u01b0\u01a1ng l\u00e0 vect\u01a1 c\u00e1c h\u1ec7 s\u1ed1 $(a_0, a_1, \\dots, a_{n-1})$) \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a l\u00e0 c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a \u0111a th\u1ee9c t\u1ea1i c\u00e1c \u0111i\u1ec3m $x = w_{n, k}$, t\u1ee9c l\u00e0 n\u00f3 l\u00e0 vect\u01a1:</p> $$\\begin{align} \\text{DFT}(a_0, a_1, \\dots, a_{n-1}) &amp;= (y_0, y_1, \\dots, y_{n-1}) \\\\ &amp;= (A(w_{n, 0}), A(w_{n, 1}), \\dots, A(w_{n, n-1})) \\\\ &amp;= (A(w_n^0), A(w_n^1), \\dots, A(w_n^{n-1})) \\end{align}$$ <p>T\u01b0\u01a1ng t\u1ef1, bi\u1ebfn \u0111\u1ed5i Fourier r\u1eddi r\u1ea1c ng\u01b0\u1ee3c (inverse discrete Fourier transform) \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a: Bi\u1ebfn \u0111\u1ed5i DFT ng\u01b0\u1ee3c c\u1ee7a c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a \u0111a th\u1ee9c $(y_0, y_1, \\dots, y_{n-1})$ l\u00e0 c\u00e1c h\u1ec7 s\u1ed1 c\u1ee7a \u0111a th\u1ee9c $(a_0, a_1, \\dots, a_{n-1})$.</p> $$\\text{InverseDFT}(y_0, y_1, \\dots, y_{n-1}) = (a_0, a_1, \\dots, a_{n-1})$$ <p>Do \u0111\u00f3, n\u1ebfu m\u1ed9t DFT tr\u1ef1c ti\u1ebfp t\u00ednh to\u00e1n c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a \u0111a th\u1ee9c t\u1ea1i c\u00e1c \u0111i\u1ec3m \u1edf c\u0103n b\u1eadc $n$, th\u00ec DFT ng\u01b0\u1ee3c c\u00f3 th\u1ec3 kh\u00f4i ph\u1ee5c c\u00e1c h\u1ec7 s\u1ed1 c\u1ee7a \u0111a th\u1ee9c s\u1eed d\u1ee5ng c\u00e1c gi\u00e1 tr\u1ecb \u0111\u00f3.</p>","tags":["Translated"]},{"location":"algebra/fft.html#application-of-the-dft-fast-multiplication-of-polynomials","title":"\u1ee8ng d\u1ee5ng c\u1ee7a DFT: nh\u00e2n nhanh \u0111a th\u1ee9c (Application of the DFT: fast multiplication of polynomials)","text":"<p>Gi\u1ea3 s\u1eed c\u00f3 hai \u0111a th\u1ee9c $A$ v\u00e0 $B$. Ch\u00fang ta t\u00ednh DFT cho m\u1ed7i \u0111a th\u1ee9c: $\\text{DFT}(A)$ v\u00e0 $\\text{DFT}(B)$.</p> <p>\u0110i\u1ec1u g\u00ec x\u1ea3y ra n\u1ebfu ch\u00fang ta nh\u00e2n c\u00e1c \u0111a th\u1ee9c n\u00e0y? R\u00f5 r\u00e0ng t\u1ea1i m\u1ed7i \u0111i\u1ec3m, c\u00e1c gi\u00e1 tr\u1ecb ch\u1ec9 \u0111\u01a1n gi\u1ea3n l\u00e0 nh\u00e2n v\u1edbi nhau, t\u1ee9c l\u00e0</p> $$(A \\cdot B)(x) = A(x) \\cdot B(x).$$ <p>\u0110i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 n\u1ebfu ch\u00fang ta nh\u00e2n c\u00e1c vect\u01a1 $\\text{DFT}(A)$ v\u00e0 $\\text{DFT}(B)$ - b\u1eb1ng c\u00e1ch nh\u00e2n t\u1eebng ph\u1ea7n t\u1eed c\u1ee7a m\u1ed9t vect\u01a1 v\u1edbi ph\u1ea7n t\u1eed t\u01b0\u01a1ng \u1ee9ng c\u1ee7a vect\u01a1 kia - th\u00ec ch\u00fang ta kh\u00f4ng nh\u1eadn \u0111\u01b0\u1ee3c g\u00ec kh\u00e1c ngo\u00e0i DFT c\u1ee7a \u0111a th\u1ee9c $\\text{DFT}(A \\cdot B)$:</p> $$\\text{DFT}(A \\cdot B) = \\text{DFT}(A) \\cdot \\text{DFT}(B)$$ <p>Cu\u1ed1i c\u00f9ng, \u00e1p d\u1ee5ng DFT ng\u01b0\u1ee3c, ch\u00fang ta thu \u0111\u01b0\u1ee3c:</p> $$A \\cdot B = \\text{InverseDFT}(\\text{DFT}(A) \\cdot \\text{DFT}(B))$$ <p>\u1ede b\u00ean ph\u1ea3i t\u00edch c\u1ee7a hai DFT, ch\u00fang t\u00f4i c\u00f3 ngh\u0129a l\u00e0 t\u00edch t\u1eebng \u0111\u00f4i m\u1ed9t c\u1ee7a c\u00e1c ph\u1ea7n t\u1eed vect\u01a1. \u0110i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n trong th\u1eddi gian $O(n)$. N\u1ebfu ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh DFT v\u00e0 DFT ng\u01b0\u1ee3c trong $O(n \\log n)$, th\u00ec ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh t\u00edch c\u1ee7a hai \u0111a th\u1ee9c (v\u00e0 do \u0111\u00f3 c\u0169ng l\u00e0 hai s\u1ed1 l\u1edbn) v\u1edbi c\u00f9ng \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian.</p> <p>C\u1ea7n l\u01b0u \u00fd r\u1eb1ng hai \u0111a th\u1ee9c ph\u1ea3i c\u00f3 c\u00f9ng b\u1eadc. N\u1ebfu kh\u00f4ng, hai vect\u01a1 k\u1ebft qu\u1ea3 c\u1ee7a DFT c\u00f3 \u0111\u1ed9 d\u00e0i kh\u00e1c nhau. Ch\u00fang ta c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n \u0111i\u1ec1u n\u00e0y b\u1eb1ng c\u00e1ch th\u00eam c\u00e1c h\u1ec7 s\u1ed1 c\u00f3 gi\u00e1 tr\u1ecb $0$.</p> <p>V\u00e0 c\u0169ng v\u1eady, v\u00ec k\u1ebft qu\u1ea3 c\u1ee7a t\u00edch c\u1ee7a hai \u0111a th\u1ee9c l\u00e0 m\u1ed9t \u0111a th\u1ee9c b\u1eadc $2 (n - 1)$, ch\u00fang ta ph\u1ea3i nh\u00e2n \u0111\u00f4i b\u1eadc c\u1ee7a m\u1ed7i \u0111a th\u1ee9c (m\u1ed9t l\u1ea7n n\u1eefa b\u1eb1ng c\u00e1ch \u0111\u1ec7m c\u00e1c s\u1ed1 $0$). T\u1eeb m\u1ed9t vect\u01a1 c\u00f3 $n$ gi\u00e1 tr\u1ecb, ch\u00fang ta kh\u00f4ng th\u1ec3 t\u00e1i t\u1ea1o \u0111a th\u1ee9c mong mu\u1ed1n v\u1edbi $2n - 1$ h\u1ec7 s\u1ed1.</p>","tags":["Translated"]},{"location":"algebra/fft.html#fast-fourier-transform-1","title":"Bi\u1ebfn \u0111\u1ed5i Fourier Nhanh (Fast Fourier Transform)","text":"<p>Bi\u1ebfn \u0111\u1ed5i Fourier nhanh l\u00e0 m\u1ed9t ph\u01b0\u01a1ng ph\u00e1p cho ph\u00e9p t\u00ednh DFT trong th\u1eddi gian $O(n \\log n)$. \u00dd t\u01b0\u1edfng c\u01a1 b\u1ea3n c\u1ee7a FFT l\u00e0 \u00e1p d\u1ee5ng chia \u0111\u1ec3 tr\u1ecb. Ch\u00fang ta chia vect\u01a1 h\u1ec7 s\u1ed1 c\u1ee7a \u0111a th\u1ee9c th\u00e0nh hai vect\u01a1, t\u00ednh to\u00e1n \u0111\u1ec7 quy DFT cho m\u1ed7i vect\u01a1 \u0111\u00f3 v\u00e0 k\u1ebft h\u1ee3p c\u00e1c k\u1ebft qu\u1ea3 \u0111\u1ec3 t\u00ednh DFT c\u1ee7a \u0111a th\u1ee9c ho\u00e0n ch\u1ec9nh.</p> <p>V\u00ec v\u1eady gi\u1ea3 s\u1eed c\u00f3 m\u1ed9t \u0111a th\u1ee9c $A(x)$ v\u1edbi b\u1eadc $n - 1$, trong \u0111\u00f3 $n$ l\u00e0 l\u0169y th\u1eeba c\u1ee7a $2$, v\u00e0 $n &gt; 1$:</p> $$A(x) = a_0 x^0 + a_1 x^1 + \\dots + a_{n-1} x^{n-1}$$ <p>Ch\u00fang ta chia n\u00f3 th\u00e0nh hai \u0111a th\u1ee9c nh\u1ecf h\u01a1n, m\u1ed9t ch\u1ee9a c\u00e1c h\u1ec7 s\u1ed1 c\u1ee7a c\u00e1c v\u1ecb tr\u00ed ch\u1eb5n, v\u00e0 m\u1ed9t ch\u1ee9a c\u00e1c h\u1ec7 s\u1ed1 c\u1ee7a c\u00e1c v\u1ecb tr\u00ed l\u1ebb:</p> $$\\begin{align} A_0(x) &amp;= a_0 x^0 + a_2 x^1 + \\dots + a_{n-2} x^{\\frac{n}{2}-1} \\\\ A_1(x) &amp;= a_1 x^0 + a_3 x^1 + \\dots + a_{n-1} x^{\\frac{n}{2}-1} \\end{align}$$ <p>D\u1ec5 d\u00e0ng nh\u1eadn th\u1ea5y r\u1eb1ng</p> $$A(x) = A_0(x^2) + x A_1(x^2).$$ <p>C\u00e1c \u0111a th\u1ee9c $A_0$ v\u00e0 $A_1$ ch\u1ec9 c\u00f3 m\u1ed9t n\u1eeda s\u1ed1 l\u01b0\u1ee3ng h\u1ec7 s\u1ed1 so v\u1edbi \u0111a th\u1ee9c $A$. N\u1ebfu ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh $\\text{DFT}(A)$ trong th\u1eddi gian tuy\u1ebfn t\u00ednh b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng $\\text{DFT}(A_0)$ v\u00e0 $\\text{DFT}(A_1)$, th\u00ec ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c c\u00f4ng th\u1ee9c truy h\u1ed3i $T_{\\text{DFT}}(n) = 2 T_{\\text{DFT}}\\left(\\frac{n}{2}\\right) + O(n)$ cho \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian, d\u1eabn \u0111\u1ebfn $T_{\\text{DFT}}(n) = O(n \\log n)$ theo \u0111\u1ecbnh l\u00fd th\u1ee3 (master theorem).</p> <p>H\u00e3y t\u00ecm hi\u1ec3u c\u00e1ch ch\u00fang ta c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n \u0111i\u1ec1u \u0111\u00f3.</p> <p>Gi\u1ea3 s\u1eed ch\u00fang ta \u0111\u00e3 t\u00ednh to\u00e1n c\u00e1c vect\u01a1 $\\left(y_k^0\\right)_{k=0}^{n/2-1} = \\text{DFT}(A_0)$ v\u00e0 $\\left(y_k^1\\right)_{k=0}^{n/2-1} = \\text{DFT}(A_1)$. H\u00e3y t\u00ecm m\u1ed9t bi\u1ec3u th\u1ee9c cho $\\left(y_k\\right)_{k=0}^{n-1} = \\text{DFT}(A)$.</p> <p>\u0110\u1ed1i v\u1edbi $\\frac{n}{2}$ gi\u00e1 tr\u1ecb \u0111\u1ea7u ti\u00ean, ch\u00fang ta ch\u1ec9 c\u1ea7n s\u1eed d\u1ee5ng ph\u01b0\u01a1ng tr\u00ecnh \u0111\u00e3 l\u01b0u \u00fd tr\u01b0\u1edbc \u0111\u00f3 $A(x) = A_0(x^2) + x A_1(x^2)$:</p> $$y_k = y_k^0 + w_n^k y_k^1, \\quad k = 0 \\dots \\frac{n}{2} - 1.$$ <p>Tuy nhi\u00ean \u0111\u1ed1i v\u1edbi $\\frac{n}{2}$ gi\u00e1 tr\u1ecb th\u1ee9 hai, ch\u00fang ta c\u1ea7n t\u00ecm m\u1ed9t bi\u1ec3u th\u1ee9c h\u01a1i kh\u00e1c:</p> $$\\begin{align} y_{k+n/2} &amp;= A\\left(w_n^{k+n/2}\\right) \\\\ &amp;= A_0\\left(w_n^{2k+n}\\right) + w_n^{k + n/2} A_1\\left(w_n^{2k+n}\\right) \\\\ &amp;= A_0\\left(w_n^{2k} w_n^n\\right) + w_n^k w_n^{n/2} A_1\\left(w_n^{2k} w_n^n\\right) \\\\ &amp;= A_0\\left(w_n^{2k}\\right) - w_n^k A_1\\left(w_n^{2k}\\right) \\\\ &amp;= y_k^0 - w_n^k y_k^1 \\end{align}$$ <p>\u1ede \u0111\u00e2y ch\u00fang ta \u0111\u00e3 s\u1eed d\u1ee5ng l\u1ea1i $A(x) = A_0(x^2) + x A_1(x^2)$ v\u00e0 hai \u0111\u1eb3ng th\u1ee9c $w_n^n = 1$ v\u00e0 $w_n^{n/2} = -1$.</p> <p>Do \u0111\u00f3, ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c c\u00e1c c\u00f4ng th\u1ee9c mong mu\u1ed1n \u0111\u1ec3 t\u00ednh to\u00e1n to\u00e0n b\u1ed9 vect\u01a1 $(y_k)$:</p> $$\\begin{align} y_k &amp;= y_k^0 + w_n^k y_k^1, &amp;\\quad k = 0 \\dots \\frac{n}{2} - 1, \\\\ y_{k+n/2} &amp;= y_k^0 - w_n^k y_k^1, &amp;\\quad k = 0 \\dots \\frac{n}{2} - 1. \\end{align}$$ <p>(M\u1eabu n\u00e0y $a + b$ v\u00e0 $a - b$ \u0111\u00f4i khi \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 b\u01b0\u1edbm (butterfly).)</p> <p>Nh\u01b0 v\u1eady ch\u00fang ta \u0111\u00e3 h\u1ecdc \u0111\u01b0\u1ee3c c\u00e1ch t\u00ednh DFT trong th\u1eddi gian $O(n \\log n)$.</p>","tags":["Translated"]},{"location":"algebra/fft.html#inverse-fft","title":"FFT ng\u01b0\u1ee3c (Inverse FFT)","text":"<p>Gi\u1ea3 s\u1eed vect\u01a1 $(y_0, y_1, \\dots y_{n-1})$ - c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a \u0111a th\u1ee9c $A$ b\u1eadc $n - 1$ t\u1ea1i c\u00e1c \u0111i\u1ec3m $x = w_n^k$ - \u0111\u01b0\u1ee3c cho. Ch\u00fang ta mu\u1ed1n kh\u00f4i ph\u1ee5c c\u00e1c h\u1ec7 s\u1ed1 $(a_0, a_1, \\dots, a_{n-1})$ c\u1ee7a \u0111a th\u1ee9c. B\u00e0i to\u00e1n \u0111\u00e3 bi\u1ebft n\u00e0y \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 n\u1ed9i suy, v\u00e0 c\u00f3 c\u00e1c thu\u1eadt to\u00e1n t\u1ed5ng qu\u00e1t \u0111\u1ec3 gi\u1ea3i quy\u1ebft n\u00f3. Nh\u01b0ng trong tr\u01b0\u1eddng h\u1ee3p \u0111\u1eb7c bi\u1ec7t n\u00e0y (v\u00ec ch\u00fang ta bi\u1ebft gi\u00e1 tr\u1ecb c\u1ee7a c\u00e1c \u0111i\u1ec3m t\u1ea1i c\u00e1c c\u0103n \u0111\u01a1n v\u1ecb), ch\u00fang ta c\u00f3 th\u1ec3 thu \u0111\u01b0\u1ee3c m\u1ed9t thu\u1eadt to\u00e1n \u0111\u01a1n gi\u1ea3n h\u01a1n nhi\u1ec1u (th\u1ef1c t\u1ebf gi\u1ed1ng v\u1edbi FFT tr\u1ef1c ti\u1ebfp).</p> <p>Ch\u00fang ta c\u00f3 th\u1ec3 vi\u1ebft DFT, theo \u0111\u1ecbnh ngh\u0129a c\u1ee7a n\u00f3, d\u01b0\u1edbi d\u1ea1ng ma tr\u1eadn:</p> $$ \\begin{pmatrix} w_n^0 &amp; w_n^0 &amp; w_n^0 &amp; w_n^0 &amp; \\cdots &amp; w_n^0 \\\\ w_n^0 &amp; w_n^1 &amp; w_n^2 &amp; w_n^3 &amp; \\cdots &amp; w_n^{n-1} \\\\ w_n^0 &amp; w_n^2 &amp; w_n^4 &amp; w_n^6 &amp; \\cdots &amp; w_n^{2(n-1)} \\\\ w_n^0 &amp; w_n^3 &amp; w_n^6 &amp; w_n^9 &amp; \\cdots &amp; w_n^{3(n-1)} \\\\ \\vdots &amp; \\vdots &amp; \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\ w_n^0 &amp; w_n^{n-1} &amp; w_n^{2(n-1)} &amp; w_n^{3(n-1)} &amp; \\cdots &amp; w_n^{(n-1)(n-1)} \\end{pmatrix} \\begin{pmatrix} a_0 \\\\ a_1 \\\\ a_2 \\\\ a_3 \\\\ \\vdots \\\\ a_{n-1} \\end{pmatrix} = \\begin{pmatrix} y_0 \\\\ y_1 \\\\ y_2 \\\\ y_3 \\\\ \\vdots \\\\ y_{n-1} \\end{pmatrix} $$ <p>Ma tr\u1eadn n\u00e0y \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 ma tr\u1eadn Vandermonde.</p> <p>Do \u0111\u00f3 ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh to\u00e1n vect\u01a1 $(a_0, a_1, \\dots, a_{n-1})$ b\u1eb1ng c\u00e1ch nh\u00e2n vect\u01a1 $(y_0, y_1, \\dots y_{n-1})$ t\u1eeb b\u00ean tr\u00e1i v\u1edbi ngh\u1ecbch \u0111\u1ea3o c\u1ee7a ma tr\u1eadn:</p> $$ \\begin{pmatrix} a_0 \\\\ a_1 \\\\ a_2 \\\\ a_3 \\\\ \\vdots \\\\ a_{n-1} \\end{pmatrix} = \\begin{pmatrix} w_n^0 &amp; w_n^0 &amp; w_n^0 &amp; w_n^0 &amp; \\cdots &amp; w_n^0 \\\\ w_n^0 &amp; w_n^1 &amp; w_n^2 &amp; w_n^3 &amp; \\cdots &amp; w_n^{n-1} \\\\ w_n^0 &amp; w_n^2 &amp; w_n^4 &amp; w_n^6 &amp; \\cdots &amp; w_n^{2(n-1)} \\\\ w_n^0 &amp; w_n^3 &amp; w_n^6 &amp; w_n^9 &amp; \\cdots &amp; w_n^{3(n-1)} \\\\ \\vdots &amp; \\vdots &amp; \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\ w_n^0 &amp; w_n^{n-1} &amp; w_n^{2(n-1)} &amp; w_n^{3(n-1)} &amp; \\cdots &amp; w_n^{(n-1)(n-1)} \\end{pmatrix}^{-1} \\begin{pmatrix} y_0 \\\\ y_1 \\\\ y_2 \\\\ y_3 \\\\ \\vdots \\\\ y_{n-1} \\end{pmatrix} $$ <p>M\u1ed9t ki\u1ec3m tra nhanh c\u00f3 th\u1ec3 x\u00e1c minh r\u1eb1ng ngh\u1ecbch \u0111\u1ea3o c\u1ee7a ma tr\u1eadn c\u00f3 d\u1ea1ng sau:</p> $$ \\frac{1}{n} \\begin{pmatrix} w_n^0 &amp; w_n^0 &amp; w_n^0 &amp; w_n^0 &amp; \\cdots &amp; w_n^0 \\\\ w_n^0 &amp; w_n^{-1} &amp; w_n^{-2} &amp; w_n^{-3} &amp; \\cdots &amp; w_n^{-(n-1)} \\\\ w_n^0 &amp; w_n^{-2} &amp; w_n^{-4} &amp; w_n^{-6} &amp; \\cdots &amp; w_n^{-2(n-1)} \\\\ w_n^0 &amp; w_n^{-3} &amp; w_n^{-6} &amp; w_n^{-9} &amp; \\cdots &amp; w_n^{-3(n-1)} \\\\ \\vdots &amp; \\vdots &amp; \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\ w_n^0 &amp; w_n^{-(n-1)} &amp; w_n^{-2(n-1)} &amp; w_n^{-3(n-1)} &amp; \\cdots &amp; w_n^{-(n-1)(n-1)} \\end{pmatrix} $$ <p>Do \u0111\u00f3 ch\u00fang ta thu \u0111\u01b0\u1ee3c c\u00f4ng th\u1ee9c:</p> $$a_k = \\frac{1}{n} \\sum_{j=0}^{n-1} y_j w_n^{-k j}$$ <p>So s\u00e1nh \u0111i\u1ec1u n\u00e0y v\u1edbi c\u00f4ng th\u1ee9c cho $y_k$</p> $$y_k = \\sum_{j=0}^{n-1} a_j w_n^{k j},$$ <p>ch\u00fang t\u00f4i nh\u1eadn th\u1ea5y r\u1eb1ng c\u00e1c b\u00e0i to\u00e1n n\u00e0y g\u1ea7n nh\u01b0 gi\u1ed1ng nhau, v\u00ec v\u1eady c\u00e1c h\u1ec7 s\u1ed1 $a_k$ c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y b\u1eb1ng c\u00f9ng m\u1ed9t thu\u1eadt to\u00e1n chia \u0111\u1ec3 tr\u1ecb, c\u0169ng nh\u01b0 FFT tr\u1ef1c ti\u1ebfp, ch\u1ec9 thay v\u00ec $w_n^k$ ch\u00fang t\u00f4i ph\u1ea3i s\u1eed d\u1ee5ng $w_n^{-k}$, v\u00e0 cu\u1ed1i c\u00f9ng ch\u00fang t\u00f4i c\u1ea7n chia c\u00e1c h\u1ec7 s\u1ed1 k\u1ebft qu\u1ea3 cho $n$.</p> <p>Do \u0111\u00f3, vi\u1ec7c t\u00ednh to\u00e1n DFT ng\u01b0\u1ee3c g\u1ea7n gi\u1ed1ng nh\u01b0 vi\u1ec7c t\u00ednh to\u00e1n DFT tr\u1ef1c ti\u1ebfp, v\u00e0 n\u00f3 c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong th\u1eddi gian $O(n \\log n)$.</p>","tags":["Translated"]},{"location":"algebra/fft.html#implementation","title":"C\u00e0i \u0111\u1eb7t","text":"<p>\u1ede \u0111\u00e2y ch\u00fang t\u00f4i tr\u00ecnh b\u00e0y m\u1ed9t c\u00e0i \u0111\u1eb7t \u0111\u1ec7 quy \u0111\u01a1n gi\u1ea3n c\u1ee7a FFT v\u00e0 FFT ng\u01b0\u1ee3c, c\u1ea3 hai trong m\u1ed9t h\u00e0m, v\u00ec s\u1ef1 kh\u00e1c bi\u1ec7t gi\u1eefa FFT thu\u1eadn v\u00e0 FFT ng\u01b0\u1ee3c l\u00e0 r\u1ea5t nh\u1ecf. \u0110\u1ec3 l\u01b0u tr\u1eef c\u00e1c s\u1ed1 ph\u1ee9c, ch\u00fang t\u00f4i s\u1eed d\u1ee5ng ki\u1ec3u complex trong th\u01b0 vi\u1ec7n STL c\u1ee7a C++.</p> <pre><code>using cd = complex&lt;double&gt;;\nconst double PI = acos(-1);\n\nvoid fft(vector&lt;cd&gt; &amp; a, bool invert) {\n    int n = a.size();\n    if (n == 1)\n        return;\n\n    vector&lt;cd&gt; a0(n / 2), a1(n / 2);\n    for (int i = 0; 2 * i &lt; n; i++) {\n        a0[i] = a[2*i];\n        a1[i] = a[2*i+1];\n    }\n    fft(a0, invert);\n    fft(a1, invert);\n\n    double ang = 2 * PI / n * (invert ? -1 : 1);\n    cd w(1), wn(cos(ang), sin(ang));\n    for (int i = 0; 2 * i &lt; n; i++) {\n        a[i] = a0[i] + w * a1[i];\n        a[i + n/2] = a0[i] - w * a1[i];\n        if (invert) {\n            a[i] /= 2;\n            a[i + n/2] /= 2;\n        }\n        w *= wn;\n    }\n}\n</code></pre> <p>H\u00e0m \u0111\u01b0\u1ee3c truy\u1ec1n m\u1ed9t vect\u01a1 c\u00e1c h\u1ec7 s\u1ed1, v\u00e0 h\u00e0m s\u1ebd t\u00ednh to\u00e1n DFT ho\u1eb7c DFT ng\u01b0\u1ee3c v\u00e0 l\u01b0u tr\u1eef l\u1ea1i k\u1ebft qu\u1ea3 v\u00e0o vect\u01a1 n\u00e0y. Tham s\u1ed1 $\\text{invert}$ cho bi\u1ebft li\u1ec7u DFT tr\u1ef1c ti\u1ebfp hay DFT ng\u01b0\u1ee3c s\u1ebd \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n. B\u00ean trong h\u00e0m, tr\u01b0\u1edbc ti\u00ean ch\u00fang t\u00f4i ki\u1ec3m tra xem \u0111\u1ed9 d\u00e0i c\u1ee7a vect\u01a1 c\u00f3 b\u1eb1ng m\u1ed9t hay kh\u00f4ng, n\u1ebfu c\u00f3 th\u00ec ch\u00fang t\u00f4i kh\u00f4ng ph\u1ea3i l\u00e0m g\u00ec c\u1ea3. N\u1ebfu kh\u00f4ng, ch\u00fang t\u00f4i chia vect\u01a1 $a$ th\u00e0nh hai vect\u01a1 $a0$ v\u00e0 $a1$ v\u00e0 t\u00ednh to\u00e1n DFT cho c\u1ea3 hai \u0111\u1ec7 quy. Sau \u0111\u00f3, ch\u00fang t\u00f4i kh\u1edfi t\u1ea1o gi\u00e1 tr\u1ecb $wn$ v\u00e0 m\u1ed9t bi\u1ebfn $w$, bi\u1ebfn n\u00e0y s\u1ebd ch\u1ee9a l\u0169y th\u1eeba hi\u1ec7n t\u1ea1i c\u1ee7a $wn$. Sau \u0111\u00f3, c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a DFT k\u1ebft qu\u1ea3 \u0111\u01b0\u1ee3c t\u00ednh b\u1eb1ng c\u00e1c c\u00f4ng th\u1ee9c tr\u00ean.</p> <p>N\u1ebfu c\u1edd $\\text{invert}$ \u0111\u01b0\u1ee3c \u0111\u1eb7t, th\u00ec ch\u00fang t\u00f4i thay th\u1ebf $wn$ b\u1eb1ng $wn^{-1}$, v\u00e0 m\u1ed7i gi\u00e1 tr\u1ecb c\u1ee7a k\u1ebft qu\u1ea3 \u0111\u01b0\u1ee3c chia cho $2$ (v\u00ec \u0111i\u1ec1u n\u00e0y s\u1ebd \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n \u1edf m\u1ed7i c\u1ea5p \u0111\u1ed9 c\u1ee7a \u0111\u1ec7 quy, cu\u1ed1i c\u00f9ng s\u1ebd chia c\u00e1c gi\u00e1 tr\u1ecb cu\u1ed1i c\u00f9ng cho $n$).</p> <p>S\u1eed d\u1ee5ng h\u00e0m n\u00e0y, ch\u00fang ta c\u00f3 th\u1ec3 t\u1ea1o m\u1ed9t h\u00e0m \u0111\u1ec3 nh\u00e2n hai \u0111a th\u1ee9c:</p> <pre><code>vector&lt;int&gt; multiply(vector&lt;int&gt; const&amp; a, vector&lt;int&gt; const&amp; b) {\n    vector&lt;cd&gt; fa(a.begin(), a.end()), fb(b.begin(), b.end());\n    int n = 1;\n    while (n &lt; a.size() + b.size()) \n        n &lt;&lt;= 1;\n    fa.resize(n);\n    fb.resize(n);\n\n    fft(fa, false);\n    fft(fb, false);\n    for (int i = 0; i &lt; n; i++)\n        fa[i] *= fb[i];\n    fft(fa, true);\n\n    vector&lt;int&gt; result(n);\n    for (int i = 0; i &lt; n; i++)\n        result[i] = round(fa[i].real());\n    return result;\n}\n</code></pre> <p>H\u00e0m n\u00e0y ho\u1ea1t \u0111\u1ed9ng v\u1edbi c\u00e1c \u0111a th\u1ee9c c\u00f3 h\u1ec7 s\u1ed1 nguy\u00ean, tuy nhi\u00ean b\u1ea1n c\u0169ng c\u00f3 th\u1ec3 \u0111i\u1ec1u ch\u1ec9nh n\u00f3 \u0111\u1ec3 l\u00e0m vi\u1ec7c v\u1edbi c\u00e1c h\u1ec7 s\u1ed1 kh\u00e1c. V\u00ec c\u00f3 m\u1ed9t s\u1ed1 sai s\u1ed1 khi l\u00e0m vi\u1ec7c v\u1edbi s\u1ed1 ph\u1ee9c, ch\u00fang ta c\u1ea7n l\u00e0m tr\u00f2n c\u00e1c h\u1ec7 s\u1ed1 k\u1ebft qu\u1ea3 \u1edf cu\u1ed1i.</p> <p>Cu\u1ed1i c\u00f9ng, h\u00e0m \u0111\u1ec3 nh\u00e2n hai s\u1ed1 l\u1edbn th\u1ef1c t\u1ebf kh\u00f4ng kh\u00e1c bi\u1ec7t so v\u1edbi h\u00e0m nh\u00e2n \u0111a th\u1ee9c. \u0110i\u1ec1u duy nh\u1ea5t ch\u00fang ta ph\u1ea3i l\u00e0m sau \u0111\u00f3, l\u00e0 chu\u1ea9n h\u00f3a s\u1ed1:</p> <pre><code>    int carry = 0;\n    for (int i = 0; i &lt; n; i++)\n        result[i] += carry;\n        carry = result[i] / 10;\n        result[i] %= 10;\n    }\n</code></pre> <p>V\u00ec chi\u1ec1u d\u00e0i c\u1ee7a t\u00edch c\u1ee7a hai s\u1ed1 kh\u00f4ng bao gi\u1edd v\u01b0\u1ee3t qu\u00e1 t\u1ed5ng chi\u1ec1u d\u00e0i c\u1ee7a c\u1ea3 hai s\u1ed1, k\u00edch th\u01b0\u1edbc c\u1ee7a vect\u01a1 l\u00e0 \u0111\u1ee7 \u0111\u1ec3 th\u1ef1c hi\u1ec7n t\u1ea5t c\u1ea3 c\u00e1c ph\u00e9p to\u00e1n nh\u1edb (carry).</p>","tags":["Translated"]},{"location":"algebra/fft.html#improved-implementation-in-place-computation","title":"C\u00e0i \u0111\u1eb7t c\u1ea3i ti\u1ebfn: t\u00ednh to\u00e1n t\u1ea1i ch\u1ed7 (Improved implementation: in-place computation)","text":"<p>\u0110\u1ec3 t\u0103ng hi\u1ec7u qu\u1ea3, ch\u00fang t\u00f4i s\u1ebd chuy\u1ec3n t\u1eeb c\u00e0i \u0111\u1eb7t \u0111\u1ec7 quy sang c\u00e0i \u0111\u1eb7t l\u1eb7p. Trong c\u00e0i \u0111\u1eb7t \u0111\u1ec7 quy \u1edf tr\u00ean, ch\u00fang t\u00f4i \u0111\u00e3 t\u00e1ch vect\u01a1 $a$ m\u1ed9t c\u00e1ch r\u00f5 r\u00e0ng th\u00e0nh hai vect\u01a1 - ph\u1ea7n t\u1eed \u1edf c\u00e1c v\u1ecb tr\u00ed ch\u1eb5n \u0111\u01b0\u1ee3c g\u00e1n cho m\u1ed9t vect\u01a1 t\u1ea1m th\u1eddi v\u00e0 c\u00e1c ph\u1ea7n t\u1eed \u1edf c\u00e1c v\u1ecb tr\u00ed l\u1ebb cho m\u1ed9t vect\u01a1 kh\u00e1c. Tuy nhi\u00ean, n\u1ebfu ch\u00fang ta s\u1eafp x\u1ebfp l\u1ea1i c\u00e1c ph\u1ea7n t\u1eed theo m\u1ed9t c\u00e1ch nh\u1ea5t \u0111\u1ecbnh, ch\u00fang ta kh\u00f4ng c\u1ea7n t\u1ea1o c\u00e1c vect\u01a1 t\u1ea1m th\u1eddi n\u00e0y (t\u1ee9c l\u00e0 t\u1ea5t c\u1ea3 c\u00e1c ph\u00e9p t\u00ednh c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n \"t\u1ea1i ch\u1ed7\", ngay trong vect\u01a1 $A$ ch\u00ednh n\u00f3).</p> <p>L\u01b0u \u00fd r\u1eb1ng \u1edf m\u1ee9c \u0111\u1ec7 quy \u0111\u1ea7u ti\u00ean, c\u00e1c ph\u1ea7n t\u1eed c\u00f3 bit th\u1ea5p nh\u1ea5t c\u1ee7a v\u1ecb tr\u00ed l\u00e0 0 \u0111\u01b0\u1ee3c g\u00e1n cho vect\u01a1 $a_0$, v\u00e0 c\u00e1c ph\u1ea7n t\u1eed c\u00f3 s\u1ed1 1 l\u00e0 bit th\u1ea5p nh\u1ea5t c\u1ee7a v\u1ecb tr\u00ed \u0111\u01b0\u1ee3c g\u00e1n cho $a_1$. \u1ede m\u1ee9c \u0111\u1ec7 quy th\u1ee9 hai, \u0111i\u1ec1u t\u01b0\u01a1ng t\u1ef1 c\u0169ng x\u1ea3y ra, nh\u01b0ng thay v\u00e0o \u0111\u00f3 l\u00e0 bit th\u1ea5p th\u1ee9 hai, v.v. Do \u0111\u00f3, n\u1ebfu ch\u00fang ta \u0111\u1ea3o ng\u01b0\u1ee3c c\u00e1c bit c\u1ee7a v\u1ecb tr\u00ed c\u1ee7a m\u1ed7i h\u1ec7 s\u1ed1 v\u00e0 s\u1eafp x\u1ebfp ch\u00fang theo c\u00e1c gi\u00e1 tr\u1ecb b\u1ecb \u0111\u1ea3o ng\u01b0\u1ee3c n\u00e0y, ch\u00fang ta s\u1ebd nh\u1eadn \u0111\u01b0\u1ee3c th\u1ee9 t\u1ef1 mong mu\u1ed1n (n\u00f3 \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 ho\u00e1n v\u1ecb \u0111\u1ea3o ng\u01b0\u1ee3c bit - bit-reversal permutation).</p> <p>V\u00ed d\u1ee5 th\u1ee9 t\u1ef1 mong mu\u1ed1n cho $n = 8$ c\u00f3 d\u1ea1ng:</p> $$a = \\bigg\\{ \\Big[ (a_0, a_4), (a_2, a_6) \\Big], \\Big[ (a_1, a_5), (a_3, a_7) \\Big] \\bigg\\}$$ <p>Th\u1eadt v\u1eady, trong m\u1ee9c \u0111\u1ec7 quy \u0111\u1ea7u ti\u00ean (\u0111\u01b0\u1ee3c bao quanh b\u1edfi d\u1ea5u ngo\u1eb7c nh\u1ecdn), vect\u01a1 \u0111\u01b0\u1ee3c chia th\u00e0nh hai ph\u1ea7n $[a_0, a_2, a_4, a_6]$ v\u00e0 $[a_1, a_3, a_5, a_7]$. Nh\u01b0 ch\u00fang ta th\u1ea5y, trong ho\u00e1n v\u1ecb \u0111\u1ea3o ng\u01b0\u1ee3c bit, \u0111i\u1ec1u n\u00e0y t\u01b0\u01a1ng \u1ee9ng v\u1edbi vi\u1ec7c \u0111\u01a1n gi\u1ea3n chia vect\u01a1 th\u00e0nh hai n\u1eeda: $\\frac{n}{2}$ ph\u1ea7n t\u1eed \u0111\u1ea7u ti\u00ean v\u00e0 $\\frac{n}{2}$ ph\u1ea7n t\u1eed cu\u1ed1i c\u00f9ng. Sau \u0111\u00f3, c\u00f3 m\u1ed9t l\u1eddi g\u1ecdi \u0111\u1ec7 quy cho m\u1ed7i n\u1eeda. Gi\u1ea3 s\u1eed DFT k\u1ebft qu\u1ea3 cho m\u1ed7i n\u1eeda \u0111\u00f3 \u0111\u01b0\u1ee3c tr\u1ea3 v\u1ec1 t\u1ea1i v\u1ecb tr\u00ed c\u1ee7a ch\u00ednh c\u00e1c ph\u1ea7n t\u1eed \u0111\u00f3 (t\u1ee9c l\u00e0 n\u1eeda \u0111\u1ea7u v\u00e0 n\u1eeda sau c\u1ee7a vect\u01a1 $a$ t\u01b0\u01a1ng \u1ee9ng).</p> $$a = \\bigg\\{ \\Big[y_0^0, y_1^0, y_2^0, y_3^0\\Big], \\Big[y_0^1, y_1^1, y_2^1, y_3^1 \\Big] \\bigg\\}$$ <p>B\u00e2y gi\u1edd ch\u00fang ta mu\u1ed1n k\u1ebft h\u1ee3p hai DFT th\u00e0nh m\u1ed9t cho vect\u01a1 ho\u00e0n ch\u1ec9nh. Th\u1ee9 t\u1ef1 c\u1ee7a c\u00e1c ph\u1ea7n t\u1eed l\u00e0 l\u00fd t\u01b0\u1edfng, v\u00e0 ch\u00fang ta c\u0169ng c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n ph\u00e9p h\u1ee3p tr\u1ef1c ti\u1ebfp trong vect\u01a1 n\u00e0y. Ch\u00fang ta c\u00f3 th\u1ec3 l\u1ea5y c\u00e1c ph\u1ea7n t\u1eed $y_0^0$ v\u00e0 $y_0^1$ v\u00e0 th\u1ef1c hi\u1ec7n bi\u1ebfn \u0111\u1ed5i b\u01b0\u1edbm. V\u1ecb tr\u00ed c\u1ee7a hai gi\u00e1 tr\u1ecb k\u1ebft qu\u1ea3 gi\u1ed1ng v\u1edbi v\u1ecb tr\u00ed c\u1ee7a hai gi\u00e1 tr\u1ecb ban \u0111\u1ea7u, v\u00ec v\u1eady ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c:</p> $$a = \\bigg\\{ \\Big[y_0^0 + w_n^0 y_0^1, y_1^0, y_2^0, y_3^0\\Big], \\Big[y_0^0 - w_n^0 y_0^1, y_1^1, y_2^1, y_3^1\\Big] \\bigg\\}$$ <p>T\u01b0\u01a1ng t\u1ef1 ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh to\u00e1n bi\u1ebfn \u0111\u1ed5i b\u01b0\u1edbm c\u1ee7a $y_1^0$ v\u00e0 $y_1^1$ v\u00e0 \u0111\u1eb7t k\u1ebft qu\u1ea3 v\u00e0o v\u1ecb tr\u00ed c\u1ee7a ch\u00fang, v.v. K\u1ebft qu\u1ea3 ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c:</p> $$a = \\bigg\\{ \\Big[y_0^0 + w_n^0 y_0^1, y_1^0 + w_n^1 y_1^1, y_2^0 + w_n^2 y_2^1, y_3^0 + w_n^3 y_3^1\\Big], \\Big[y_0^0 - w_n^0 y_0^1, y_1^0 - w_n^1 y_1^1, y_2^0 - w_n^2 y_2^1, y_3^0 - w_n^3 y_3^1\\Big] \\bigg\\}$$ <p>Nh\u01b0 v\u1eady ch\u00fang ta \u0111\u00e3 t\u00ednh to\u00e1n DFT c\u1ea7n thi\u1ebft t\u1eeb vect\u01a1 $a$.</p> <p>\u1ede \u0111\u00e2y ch\u00fang t\u00f4i \u0111\u00e3 m\u00f4 t\u1ea3 qu\u00e1 tr\u00ecnh t\u00ednh to\u00e1n DFT ch\u1ec9 \u1edf m\u1ee9c \u0111\u1ec7 quy \u0111\u1ea7u ti\u00ean, nh\u01b0ng \u0111i\u1ec1u t\u01b0\u01a1ng t\u1ef1 r\u00f5 r\u00e0ng c\u0169ng ho\u1ea1t \u0111\u1ed9ng cho t\u1ea5t c\u1ea3 c\u00e1c m\u1ee9c kh\u00e1c. Do \u0111\u00f3, sau khi \u00e1p d\u1ee5ng ho\u00e1n v\u1ecb \u0111\u1ea3o ng\u01b0\u1ee3c bit, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh to\u00e1n DFT t\u1ea1i ch\u1ed7, m\u00e0 kh\u00f4ng c\u1ea7n th\u00eam b\u1ed9 nh\u1edb.</p> <p>\u0110i\u1ec1u n\u00e0y b\u1ed5 sung cho ph\u00e9p ch\u00fang ta lo\u1ea1i b\u1ecf \u0111\u1ec7 quy. Ch\u00fang ta ch\u1ec9 c\u1ea7n b\u1eaft \u0111\u1ea7u \u1edf m\u1ee9c th\u1ea5p nh\u1ea5t, t\u1ee9c l\u00e0 ch\u00fang ta chia vect\u01a1 th\u00e0nh c\u00e1c c\u1eb7p v\u00e0 \u00e1p d\u1ee5ng bi\u1ebfn \u0111\u1ed5i b\u01b0\u1edbm cho ch\u00fang. K\u1ebft qu\u1ea3 l\u00e0 vect\u01a1 $a$ v\u1edbi c\u00f4ng vi\u1ec7c c\u1ee7a m\u1ee9c cu\u1ed1i c\u00f9ng \u0111\u00e3 \u0111\u01b0\u1ee3c \u00e1p d\u1ee5ng. Trong b\u01b0\u1edbc ti\u1ebfp theo, ch\u00fang ta chia vect\u01a1 th\u00e0nh c\u00e1c vect\u01a1 c\u00f3 k\u00edch th\u01b0\u1edbc $4$, v\u00e0 l\u1ea1i \u00e1p d\u1ee5ng bi\u1ebfn \u0111\u1ed5i b\u01b0\u1edbm, cho ch\u00fang ta DFT cho m\u1ed7i kh\u1ed1i c\u00f3 k\u00edch th\u01b0\u1edbc $4$. V\u00e0 c\u1ee9 th\u1ebf ti\u1ebfp t\u1ee5c. Cu\u1ed1i c\u00f9ng \u1edf b\u01b0\u1edbc cu\u1ed1i c\u00f9ng, ch\u00fang ta thu \u0111\u01b0\u1ee3c k\u1ebft qu\u1ea3 c\u1ee7a c\u00e1c DFT c\u1ee7a c\u1ea3 hai n\u1eeda c\u1ee7a $a$, v\u00e0 b\u1eb1ng c\u00e1ch \u00e1p d\u1ee5ng bi\u1ebfn \u0111\u1ed5i b\u01b0\u1edbm, ch\u00fang ta thu \u0111\u01b0\u1ee3c DFT cho vect\u01a1 $a$ ho\u00e0n ch\u1ec9nh.</p> <pre><code>using cd = complex&lt;double&gt;;\nconst double PI = acos(-1);\n\nint reverse(int num, int lg_n) {\n    int res = 0;\n    for (int i = 0; i &lt; lg_n; i++) {\n        if (num &amp; (1 &lt;&lt; i))\n            res |= 1 &lt;&lt; (lg_n - 1 - i);\n    }\n    return res;\n}\n\nvoid fft(vector&lt;cd&gt; &amp; a, bool invert) {\n    int n = a.size();\n    int lg_n = 0;\n    while ((1 &lt;&lt; lg_n) &lt; n)\n        lg_n++;\n\n    for (int i = 0; i &lt; n; i++) {\n        if (i &lt; reverse(i, lg_n))\n            swap(a[i], a[reverse(i, lg_n)]);\n    }\n\n    for (int len = 2; len &lt;= n; len &lt;&lt;= 1) {\n        double ang = 2 * PI / len * (invert ? -1 : 1);\n        cd wlen(cos(ang), sin(ang));\n        for (int i = 0; i &lt; n; i += len) {\n            cd w(1);\n            for (int j = 0; j &lt; len / 2; j++) {\n                cd u = a[i+j], v = a[i+j+len/2] * w;\n                a[i+j] = u + v;\n                a[i+j+len/2] = u - v;\n                w *= wlen;\n            }\n        }\n    }\n\n    if (invert) {\n        for (cd &amp; x : a)\n            x /= n;\n    }\n}\n</code></pre> <p>\u0110\u1ea7u ti\u00ean ch\u00fang t\u00f4i \u00e1p d\u1ee5ng ho\u00e1n v\u1ecb \u0111\u1ea3o ng\u01b0\u1ee3c bit b\u1eb1ng c\u00e1ch tr\u00e1o \u0111\u1ed5i t\u1eebng ph\u1ea7n t\u1eed v\u1edbi ph\u1ea7n t\u1eed c\u1ee7a v\u1ecb tr\u00ed b\u1ecb \u0111\u1ea3o ng\u01b0\u1ee3c. Sau \u0111\u00f3, $\\log n - 1$ tr\u1ea1ng th\u00e1i c\u1ee7a thu\u1eadt to\u00e1n ch\u00fang t\u00f4i t\u00ednh to\u00e1n DFT cho m\u1ed7i kh\u1ed1i c\u00f3 k\u00edch th\u01b0\u1edbc t\u01b0\u01a1ng \u1ee9ng $\\text{len}$. \u0110\u1ed1i v\u1edbi t\u1ea5t c\u1ea3 c\u00e1c kh\u1ed1i \u0111\u00f3, ch\u00fang ta c\u00f3 c\u00f9ng m\u1ed9t c\u0103n c\u1ee7a \u0111\u01a1n v\u1ecb $\\text{wlen}$. Ch\u00fang t\u00f4i l\u1eb7p l\u1ea1i t\u1ea5t c\u1ea3 c\u00e1c kh\u1ed1i v\u00e0 th\u1ef1c hi\u1ec7n bi\u1ebfn \u0111\u1ed5i b\u01b0\u1edbm tr\u00ean m\u1ed7i kh\u1ed1i \u0111\u00f3.</p> <p>Ch\u00fang ta c\u00f3 th\u1ec3 t\u1ed1i \u01b0u h\u00f3a h\u01a1n n\u1eefa vi\u1ec7c \u0111\u1ea3o ng\u01b0\u1ee3c c\u00e1c bit. Trong c\u00e0i \u0111\u1eb7t tr\u01b0\u1edbc, ch\u00fang t\u00f4i l\u1eb7p l\u1ea1i t\u1ea5t c\u1ea3 c\u00e1c bit c\u1ee7a ch\u1ec9 s\u1ed1 v\u00e0 t\u1ea1o ch\u1ec9 s\u1ed1 b\u1ecb \u0111\u1ea3o ng\u01b0\u1ee3c bit. Tuy nhi\u00ean, ch\u00fang ta c\u00f3 th\u1ec3 \u0111\u1ea3o ng\u01b0\u1ee3c c\u00e1c bit theo m\u1ed9t c\u00e1ch kh\u00e1c.</p> <p>Gi\u1ea3 s\u1eed r\u1eb1ng $j$ \u0111\u00e3 ch\u1ee9a \u0111\u1ea3o ng\u01b0\u1ee3c c\u1ee7a $i$. Sau \u0111\u00f3 \u0111\u1ec3 \u0111i \u0111\u1ebfn $i + 1$, ch\u00fang ta ph\u1ea3i t\u0103ng $i$, v\u00e0 ch\u00fang ta c\u0169ng ph\u1ea3i t\u0103ng $j$, nh\u01b0ng trong m\u1ed9t h\u1ec7 th\u1ed1ng s\u1ed1 \"\u0111\u1ea3o ng\u01b0\u1ee3c\". C\u1ed9ng m\u1ed9t trong h\u1ec7 nh\u1ecb ph\u00e2n th\u00f4ng th\u01b0\u1eddng t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi vi\u1ec7c l\u1eadt t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 m\u1ed9t \u1edf \u0111u\u00f4i th\u00e0nh s\u1ed1 kh\u00f4ng v\u00e0 l\u1eadt s\u1ed1 kh\u00f4ng ngay tr\u01b0\u1edbc ch\u00fang th\u00e0nh s\u1ed1 m\u1ed9t. T\u01b0\u01a1ng \u0111\u01b0\u01a1ng trong h\u1ec7 th\u1ed1ng s\u1ed1 \"\u0111\u1ea3o ng\u01b0\u1ee3c\", ch\u00fang ta l\u1eadt t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 m\u1ed9t d\u1eabn \u0111\u1ea7u, v\u00e0 c\u0169ng l\u00e0 s\u1ed1 kh\u00f4ng ti\u1ebfp theo.</p> <p>Do \u0111\u00f3 ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c c\u00e0i \u0111\u1eb7t sau:</p> <pre><code>using cd = complex&lt;double&gt;;\nconst double PI = acos(-1);\n\nvoid fft(vector&lt;cd&gt; &amp; a, bool invert) {\n    int n = a.size();\n\n    for (int i = 1, j = 0; i &lt; n; i++) {\n        int bit = n &gt;&gt; 1;\n        for (; j &amp; bit; bit &gt;&gt;= 1)\n            j ^= bit;\n        j ^= bit;\n\n        if (i &lt; j)\n            swap(a[i], a[j]);\n    }\n\n    for (int len = 2; len &lt;= n; len &lt;&lt;= 1) {\n        double ang = 2 * PI / len * (invert ? -1 : 1);\n        cd wlen(cos(ang), sin(ang));\n        for (int i = 0; i &lt; n; i += len) {\n            cd w(1);\n            for (int j = 0; j &lt; len / 2; j++) {\n                cd u = a[i+j], v = a[i+j+len/2] * w;\n                a[i+j] = u + v;\n                a[i+j+len/2] = u - v;\n                w *= wlen;\n            }\n        }\n    }\n\n    if (invert) {\n        for (cd &amp; x : a)\n            x /= n;\n    }\n}\n</code></pre> <p>Ngo\u00e0i ra ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh tr\u01b0\u1edbc ho\u00e1n v\u1ecb \u0111\u1ea3o ng\u01b0\u1ee3c bit t\u1eeb tr\u01b0\u1edbc. \u0110i\u1ec1u n\u00e0y \u0111\u1eb7c bi\u1ec7t h\u1eefu \u00edch khi k\u00edch th\u01b0\u1edbc $n$ gi\u1ed1ng nhau cho t\u1ea5t c\u1ea3 c\u00e1c cu\u1ed9c g\u1ecdi. Nh\u01b0ng ngay c\u1ea3 khi ch\u00fang ta ch\u1ec9 c\u00f3 ba cu\u1ed9c g\u1ecdi (c\u1ea7n thi\u1ebft \u0111\u1ec3 nh\u00e2n hai \u0111a th\u1ee9c), hi\u1ec7u qu\u1ea3 l\u00e0 \u0111\u00e1ng ch\u00fa \u00fd. Ngo\u00e0i ra, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh tr\u01b0\u1edbc t\u1ea5t c\u1ea3 c\u00e1c c\u0103n c\u1ee7a \u0111\u01a1n v\u1ecb v\u00e0 l\u0169y th\u1eeba c\u1ee7a ch\u00fang.</p>","tags":["Translated"]},{"location":"algebra/fft.html#number-theoretic-transform","title":"Bi\u1ebfn \u0111\u1ed5i l\u00fd thuy\u1ebft s\u1ed1 (Number theoretic transform)","text":"<p>B\u00e2y gi\u1edd ch\u00fang ta chuy\u1ec3n m\u1ee5c ti\u00eau m\u1ed9t ch\u00fat. Ch\u00fang ta v\u1eabn mu\u1ed1n nh\u00e2n hai \u0111a th\u1ee9c trong th\u1eddi gian $O(n \\log n)$, nh\u01b0ng l\u1ea7n n\u00e0y ch\u00fang ta mu\u1ed1n t\u00ednh to\u00e1n c\u00e1c h\u1ec7 s\u1ed1 modulo m\u1ed9t s\u1ed1 nguy\u00ean t\u1ed1 $p$. T\u1ea5t nhi\u00ean \u0111\u1ed1i v\u1edbi nhi\u1ec7m v\u1ee5 n\u00e0y, ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng DFT th\u00f4ng th\u01b0\u1eddng v\u00e0 \u00e1p d\u1ee5ng to\u00e1n t\u1eed modulo cho k\u1ebft qu\u1ea3. Tuy nhi\u00ean, l\u00e0m nh\u01b0 v\u1eady c\u00f3 th\u1ec3 d\u1eabn \u0111\u1ebfn sai s\u1ed1 l\u00e0m tr\u00f2n, \u0111\u1eb7c bi\u1ec7t khi x\u1eed l\u00fd c\u00e1c s\u1ed1 l\u1edbn. Bi\u1ebfn \u0111\u1ed5i l\u00fd thuy\u1ebft s\u1ed1 (number theoretic transform - NTT) c\u00f3 l\u1ee3i th\u1ebf l\u00e0 n\u00f3 ch\u1ec9 ho\u1ea1t \u0111\u1ed9ng v\u1edbi s\u1ed1 nguy\u00ean, v\u00e0 do \u0111\u00f3 k\u1ebft qu\u1ea3 \u0111\u01b0\u1ee3c \u0111\u1ea3m b\u1ea3o l\u00e0 ch\u00ednh x\u00e1c.</p> <p>Bi\u1ebfn \u0111\u1ed5i Fourier r\u1eddi r\u1ea1c d\u1ef1a tr\u00ean c\u00e1c s\u1ed1 ph\u1ee9c, v\u00e0 c\u00e1c c\u0103n b\u1eadc $n$ c\u1ee7a \u0111\u01a1n v\u1ecb. \u0110\u1ec3 t\u00ednh to\u00e1n hi\u1ec7u qu\u1ea3 n\u00f3, ch\u00fang ta s\u1eed d\u1ee5ng r\u1ed9ng r\u00e3i c\u00e1c t\u00ednh ch\u1ea5t c\u1ee7a c\u00e1c c\u0103n (v\u00ed d\u1ee5: c\u00f3 m\u1ed9t c\u0103n t\u1ea1o ra t\u1ea5t c\u1ea3 c\u00e1c c\u0103n kh\u00e1c b\u1eb1ng ph\u00e9p l\u0169y th\u1eeba).</p> <p>Nh\u01b0ng c\u00e1c t\u00ednh ch\u1ea5t t\u01b0\u01a1ng t\u1ef1 c\u0169ng gi\u1eef cho c\u00e1c c\u0103n b\u1eadc $n$ c\u1ee7a \u0111\u01a1n v\u1ecb trong s\u1ed1 h\u1ecdc modulo. M\u1ed9t c\u0103n b\u1eadc $n$ c\u1ee7a \u0111\u01a1n v\u1ecb d\u01b0\u1edbi m\u1ed9t tr\u01b0\u1eddng nguy\u00ean th\u1ee7y l\u00e0 m\u1ed9t s\u1ed1 $w_n$ th\u1ecfa m\u00e3n:</p> $$\\begin{align} (w_n)^n &amp;= 1 \\pmod{p}, \\\\ (w_n)^k &amp;\\ne 1 \\pmod{p}, \\quad 1 \\le k &lt; n. \\end{align}$$ <p>$n-1$ c\u0103n kh\u00e1c c\u00f3 th\u1ec3 thu \u0111\u01b0\u1ee3c d\u01b0\u1edbi d\u1ea1ng l\u0169y th\u1eeba c\u1ee7a c\u0103n $w_n$.</p> <p>\u0110\u1ec3 \u00e1p d\u1ee5ng n\u00f3 trong thu\u1eadt to\u00e1n bi\u1ebfn \u0111\u1ed5i Fourier nhanh, ch\u00fang ta c\u1ea7n m\u1ed9t c\u0103n t\u1ed3n t\u1ea1i cho m\u1ed9t s\u1ed1 $n$, l\u00e0 l\u0169y th\u1eeba c\u1ee7a $2$, v\u00e0 c\u0169ng cho t\u1ea5t c\u1ea3 c\u00e1c l\u0169y th\u1eeba nh\u1ecf h\u01a1n. Ch\u00fang ta c\u00f3 th\u1ec3 nh\u1eadn th\u1ea5y t\u00ednh ch\u1ea5t th\u00fa v\u1ecb sau:</p> $$\\begin{align} (w_n^2)^m = w_n^n &amp;= 1 \\pmod{p}, \\quad \\text{v\u1edbi } m = \\frac{n}{2}\\\\ (w_n^2)^k = w_n^{2k} &amp;\\ne 1 \\pmod{p}, \\quad 1 \\le k &lt; m. \\end{align}$$ <p>Do \u0111\u00f3 n\u1ebfu $w_n$ l\u00e0 c\u0103n b\u1eadc $n$ c\u1ee7a \u0111\u01a1n v\u1ecb, th\u00ec $w_n^2$ l\u00e0 c\u0103n b\u1eadc $\\frac{n}{2}$ c\u1ee7a \u0111\u01a1n v\u1ecb. V\u00e0 k\u1ebft qu\u1ea3 l\u00e0 \u0111\u1ed1i v\u1edbi t\u1ea5t c\u1ea3 c\u00e1c l\u0169y th\u1eeba nh\u1ecf h\u01a1n c\u1ee7a hai \u0111\u1ec1u t\u1ed3n t\u1ea1i c\u00e1c c\u0103n c\u00f3 b\u1eadc y\u00eau c\u1ea7u, v\u00e0 ch\u00fang c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng $w_n$.</p> <p>\u0110\u1ec3 t\u00ednh to\u00e1n DFT ng\u01b0\u1ee3c, ch\u00fang ta c\u1ea7n ngh\u1ecbch \u0111\u1ea3o $w_n^{-1}$ c\u1ee7a $w_n$. Nh\u01b0ng \u0111\u1ed1i v\u1edbi modulo s\u1ed1 nguy\u00ean t\u1ed1, ngh\u1ecbch \u0111\u1ea3o lu\u00f4n t\u1ed3n t\u1ea1i.</p> <p>Do \u0111\u00f3, t\u1ea5t c\u1ea3 c\u00e1c t\u00ednh ch\u1ea5t m\u00e0 ch\u00fang ta c\u1ea7n t\u1eeb c\u00e1c c\u0103n ph\u1ee9c c\u0169ng c\u00f3 s\u1eb5n trong s\u1ed1 h\u1ecdc modulo, mi\u1ec5n l\u00e0 ch\u00fang ta c\u00f3 m\u1ed9t modulo $p$ \u0111\u1ee7 l\u1edbn m\u00e0 c\u0103n b\u1eadc $n$ c\u1ee7a \u0111\u01a1n v\u1ecb t\u1ed3n t\u1ea1i.</p> <p>V\u00ed d\u1ee5, ch\u00fang ta c\u00f3 th\u1ec3 l\u1ea5y c\u00e1c gi\u00e1 tr\u1ecb sau: modulo $p = 7340033$, $w_{2^{20}} = 5$. N\u1ebfu modulo n\u00e0y kh\u00f4ng \u0111\u1ee7, ch\u00fang ta c\u1ea7n t\u00ecm m\u1ed9t c\u1eb7p kh\u00e1c. Ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng th\u1ef1c t\u1ebf r\u1eb1ng \u0111\u1ed1i v\u1edbi c\u00e1c modulo c\u00f3 d\u1ea1ng $p = c 2^k + 1$ (v\u00e0 $p$ l\u00e0 s\u1ed1 nguy\u00ean t\u1ed1), lu\u00f4n t\u1ed3n t\u1ea1i c\u0103n b\u1eadc $2^k$ c\u1ee7a \u0111\u01a1n v\u1ecb. C\u00f3 th\u1ec3 ch\u1ee9ng minh r\u1eb1ng $g^c$ l\u00e0 m\u1ed9t c\u0103n b\u1eadc $2^k$ c\u1ee7a \u0111\u01a1n v\u1ecb nh\u01b0 v\u1eady, trong \u0111\u00f3 $g$ l\u00e0 m\u1ed9t c\u0103n nguy\u00ean th\u1ee7y c\u1ee7a $p$.</p> <pre><code>const int mod = 7340033;\nconst int root = 5;\nconst int root_1 = 4404020;\nconst int root_pw = 1 &lt;&lt; 20;\n\nvoid fft(vector&lt;int&gt; &amp; a, bool invert) {\n    int n = a.size();\n\n    for (int i = 1, j = 0; i &lt; n; i++) {\n        int bit = n &gt;&gt; 1;\n        for (; j &amp; bit; bit &gt;&gt;= 1)\n            j ^= bit;\n        j ^= bit;\n\n        if (i &lt; j)\n            swap(a[i], a[j]);\n    }\n\n    for (int len = 2; len &lt;= n; len &lt;&lt;= 1) {\n        int wlen = invert ? root_1 : root;\n        for (int i = len; i &lt; root_pw; i &lt;&lt;= 1)\n            wlen = (int)(1LL * wlen * wlen % mod);\n\n        for (int i = 0; i &lt; n; i += len) {\n            int w = 1;\n            for (int j = 0; j &lt; len / 2; j++) {\n                int u = a[i+j], v = (int)(1LL * a[i+j+len/2] * w % mod);\n                a[i+j] = u + v &lt; mod ? u + v : u + v - mod;\n                a[i+j+len/2] = u - v &gt;= 0 ? u - v : u - v + mod;\n                w = (int)(1LL * w * wlen % mod);\n            }\n        }\n    }\n\n    if (invert) {\n        int n_1 = inverse(n, mod);\n        for (int &amp; x : a)\n            x = (int)(1LL * x * n_1 % mod);\n    }\n}\n</code></pre> <p>\u1ede \u0111\u00e2y h\u00e0m <code>inverse</code> t\u00ednh to\u00e1n ngh\u1ecbch \u0111\u1ea3o modulo (xem Ngh\u1ecbch \u0111\u1ea3o nh\u00e2n Modulo). C\u00e1c h\u1eb1ng s\u1ed1 <code>mod</code>, <code>root</code>, <code>root_pw</code> x\u00e1c \u0111\u1ecbnh modulo v\u00e0 c\u0103n, v\u00e0 <code>root_1</code> l\u00e0 ngh\u1ecbch \u0111\u1ea3o c\u1ee7a <code>root</code> modulo <code>mod</code>.</p> <p>Trong th\u1ef1c t\u1ebf, c\u00e0i \u0111\u1eb7t n\u00e0y ch\u1eadm h\u01a1n so v\u1edbi c\u00e0i \u0111\u1eb7t s\u1eed d\u1ee5ng s\u1ed1 ph\u1ee9c (do s\u1ed1 l\u01b0\u1ee3ng l\u1edbn c\u00e1c ph\u00e9p to\u00e1n modulo), nh\u01b0ng n\u00f3 c\u00f3 m\u1ed9t s\u1ed1 \u01b0u \u0111i\u1ec3m nh\u01b0 s\u1eed d\u1ee5ng \u00edt b\u1ed9 nh\u1edb h\u01a1n v\u00e0 kh\u00f4ng c\u00f3 l\u1ed7i l\u00e0m tr\u00f2n.</p>","tags":["Translated"]},{"location":"algebra/fft.html#multiplication-with-arbitrary-modulus","title":"Ph\u00e9p nh\u00e2n v\u1edbi modulo t\u00f9y \u00fd (Multiplication with arbitrary modulus)","text":"<p>\u1ede \u0111\u00e2y ch\u00fang ta mu\u1ed1n \u0111\u1ea1t \u0111\u01b0\u1ee3c c\u00f9ng m\u1ed9t m\u1ee5c ti\u00eau nh\u01b0 trong ph\u1ea7n tr\u01b0\u1edbc. Nh\u00e2n hai \u0111a th\u1ee9c $A(x)$ v\u00e0 $B(x)$, v\u00e0 t\u00ednh to\u00e1n c\u00e1c h\u1ec7 s\u1ed1 modulo m\u1ed9t s\u1ed1 $M$. Bi\u1ebfn \u0111\u1ed5i l\u00fd thuy\u1ebft s\u1ed1 ch\u1ec9 ho\u1ea1t \u0111\u1ed9ng cho m\u1ed9t s\u1ed1 s\u1ed1 nguy\u00ean t\u1ed1 nh\u1ea5t \u0111\u1ecbnh. C\u00f2n tr\u01b0\u1eddng h\u1ee3p modulo kh\u00f4ng c\u00f3 d\u1ea1ng mong mu\u1ed1n th\u00ec sao?</p> <p>M\u1ed9t t\u00f9y ch\u1ecdn s\u1ebd l\u00e0 th\u1ef1c hi\u1ec7n nhi\u1ec1u bi\u1ebfn \u0111\u1ed5i l\u00fd thuy\u1ebft s\u1ed1 v\u1edbi c\u00e1c s\u1ed1 nguy\u00ean t\u1ed1 kh\u00e1c nhau c\u00f3 d\u1ea1ng $c 2^k + 1$, sau \u0111\u00f3 \u00e1p d\u1ee5ng \u0110\u1ecbnh l\u00fd Th\u1eb7ng d\u01b0 Trung Hoa \u0111\u1ec3 t\u00ednh to\u00e1n c\u00e1c h\u1ec7 s\u1ed1 cu\u1ed1i c\u00f9ng.</p> <p>T\u00f9y ch\u1ecdn kh\u00e1c l\u00e0 ph\u00e2n ph\u1ed1i c\u00e1c \u0111a th\u1ee9c $A(x)$ v\u00e0 $B(x)$ th\u00e0nh hai \u0111a th\u1ee9c nh\u1ecf h\u01a1n m\u1ed7i \u0111a th\u1ee9c</p> $$\\begin{align} A(x) &amp;= A_1(x) + A_2(x) \\cdot C \\\\ B(x) &amp;= B_1(x) + B_2(x) \\cdot C \\end{align}$$ <p>v\u1edbi $C \\approx \\sqrt{M}$.</p> <p>Khi \u0111\u00f3 t\u00edch c\u1ee7a $A(x)$ v\u00e0 $B(x)$ c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n d\u01b0\u1edbi d\u1ea1ng:</p> $$A(x) \\cdot B(x) = A_1(x) \\cdot B_1(x) + \\left(A_1(x) \\cdot B_2(x) + A_2(x) \\cdot B_1(x)\\right)\\cdot C + \\left(A_2(x) \\cdot B_2(x)\\right)\\cdot C^2$$ <p>C\u00e1c \u0111a th\u1ee9c $A_1(x)$, $A_2(x)$, $B_1(x)$ v\u00e0 $B_2(x)$ ch\u1ec9 ch\u1ee9a c\u00e1c h\u1ec7 s\u1ed1 nh\u1ecf h\u01a1n $\\sqrt{M}$, do \u0111\u00f3 c\u00e1c h\u1ec7 s\u1ed1 c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c t\u00edch xu\u1ea5t hi\u1ec7n \u0111\u1ec1u nh\u1ecf h\u01a1n $M \\cdot n$, th\u01b0\u1eddng \u0111\u1ee7 nh\u1ecf \u0111\u1ec3 x\u1eed l\u00fd v\u1edbi c\u00e1c ki\u1ec3u d\u1ea5u ph\u1ea9y \u0111\u1ed9ng \u0111i\u1ec3n h\u00ecnh.</p> <p>Do \u0111\u00f3, c\u00e1ch ti\u1ebfp c\u1eadn n\u00e0y y\u00eau c\u1ea7u t\u00ednh to\u00e1n t\u00edch c\u1ee7a c\u00e1c \u0111a th\u1ee9c v\u1edbi c\u00e1c h\u1ec7 s\u1ed1 nh\u1ecf h\u01a1n (b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng FFT th\u00f4ng th\u01b0\u1eddng v\u00e0 FFT ng\u01b0\u1ee3c), v\u00e0 sau \u0111\u00f3 t\u00edch ban \u0111\u1ea7u c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c kh\u00f4i ph\u1ee5c b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng ph\u00e9p c\u1ed9ng v\u00e0 ph\u00e9p nh\u00e2n modulo trong th\u1eddi gian $O(n)$.</p>","tags":["Translated"]},{"location":"algebra/fft.html#applications","title":"C\u00e1c \u1ee9ng d\u1ee5ng (Applications)","text":"<p>DFT c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng trong r\u1ea5t nhi\u1ec1u b\u00e0i to\u00e1n kh\u00e1c, tho\u1ea1t nh\u00ecn kh\u00f4ng li\u00ean quan g\u00ec \u0111\u1ebfn nh\u00e2n \u0111a th\u1ee9c.</p>","tags":["Translated"]},{"location":"algebra/fft.html#all-possible-sums","title":"T\u1ea5t c\u1ea3 c\u00e1c t\u1ed5ng c\u00f3 th\u1ec3 (All possible sums)","text":"<p>Ch\u00fang ta \u0111\u01b0\u1ee3c cho hai m\u1ea3ng $a[]$ v\u00e0 $b[]$. Ch\u00fang ta ph\u1ea3i t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c t\u1ed5ng c\u00f3 th\u1ec3 $a[i] + b[j]$, v\u00e0 \u0111\u1ed1i v\u1edbi m\u1ed7i t\u1ed5ng \u0111\u1ebfm xem n\u00f3 xu\u1ea5t hi\u1ec7n bao nhi\u00eau l\u1ea7n.</p> <p>V\u00ed d\u1ee5 \u0111\u1ed1i v\u1edbi $a = [1,~ 2,~ 3]$ v\u00e0 $b = [2,~ 4]$ ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c: khi \u0111\u00f3 t\u1ed5ng $3$ c\u00f3 th\u1ec3 thu \u0111\u01b0\u1ee3c theo $1$ c\u00e1ch, t\u1ed5ng $4$ c\u0169ng theo $1$ c\u00e1ch, $5$ theo $2$ c\u00e1ch, $6$ theo $1$ c\u00e1ch, $7$ theo $1$ c\u00e1ch.</p> <p>Ch\u00fang ta x\u00e2y d\u1ef1ng cho c\u00e1c m\u1ea3ng $a$ v\u00e0 $b$ hai \u0111a th\u1ee9c $A$ v\u00e0 $B$. C\u00e1c s\u1ed1 c\u1ee7a m\u1ea3ng s\u1ebd \u0111\u00f3ng vai tr\u00f2 l\u00e0 s\u1ed1 m\u0169 trong \u0111a th\u1ee9c ($a[i] \\Rightarrow x^{a[i]}$); v\u00e0 c\u00e1c h\u1ec7 s\u1ed1 c\u1ee7a s\u1ed1 h\u1ea1ng n\u00e0y s\u1ebd l\u00e0 t\u1ea7n xu\u1ea5t xu\u1ea5t hi\u1ec7n c\u1ee7a s\u1ed1 \u0111\u00f3 trong m\u1ea3ng.</p> <p>Sau \u0111\u00f3, b\u1eb1ng c\u00e1ch nh\u00e2n hai \u0111a th\u1ee9c n\u00e0y trong th\u1eddi gian $O(n \\log n)$, ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c m\u1ed9t \u0111a th\u1ee9c $C$, trong \u0111\u00f3 c\u00e1c s\u1ed1 m\u0169 s\u1ebd cho bi\u1ebft t\u1ed5ng n\u00e0o c\u00f3 th\u1ec3 thu \u0111\u01b0\u1ee3c, v\u00e0 c\u00e1c h\u1ec7 s\u1ed1 cho bi\u1ebft t\u1ea7n su\u1ea5t. \u0110\u1ec3 minh h\u1ecda \u0111i\u1ec1u n\u00e0y tr\u00ean v\u00ed d\u1ee5:</p> $$(1 x^1 + 1 x^2 + 1 x^3) (1 x^2 + 1 x^4) = 1 x^3 + 1 x^4 + 2 x^5 + 1 x^6 + 1 x^7$$","tags":["Translated"]},{"location":"algebra/fft.html#all-possible-scalar-products","title":"T\u1ea5t c\u1ea3 c\u00e1c t\u00edch v\u00f4 h\u01b0\u1edbng c\u00f3 th\u1ec3 (All possible scalar products)","text":"<p>Ch\u00fang ta \u0111\u01b0\u1ee3c cho hai m\u1ea3ng $a[]$ v\u00e0 $b[]$ c\u00f3 \u0111\u1ed9 d\u00e0i $n$. Ch\u00fang ta ph\u1ea3i t\u00ednh to\u00e1n t\u00edch c\u1ee7a $a$ v\u1edbi m\u1ecdi d\u1ecbch chuy\u1ec3n v\u00f2ng c\u1ee7a $b$.</p> <p>Ch\u00fang ta t\u1ea1o ra hai m\u1ea3ng m\u1edbi c\u00f3 k\u00edch th\u01b0\u1edbc $2n$: Ch\u00fang ta \u0111\u1ea3o ng\u01b0\u1ee3c $a$ v\u00e0 th\u00eam $n$ s\u1ed1 kh\u00f4ng v\u00e0o n\u00f3. V\u00e0 ch\u00fang ta ch\u1ec9 c\u1ea7n th\u00eam $b$ v\u00e0o ch\u00ednh n\u00f3. Khi ch\u00fang ta nh\u00e2n hai m\u1ea3ng n\u00e0y nh\u01b0 \u0111a th\u1ee9c, v\u00e0 nh\u00ecn v\u00e0o c\u00e1c h\u1ec7 s\u1ed1 $c[n-1],~ c[n],~ \\dots,~ c[2n-2]$ c\u1ee7a t\u00edch $c$, ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c:</p> $$c[k] = \\sum_{i+j=k} a[i] b[j]$$ <p>V\u00e0 v\u00ec t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed $a[i] = 0$ v\u1edbi $i \\ge n$:</p> $$c[k] = \\sum_{i=0}^{n-1} a[i] b[k-i]$$ <p>D\u1ec5 d\u00e0ng th\u1ea5y r\u1eb1ng t\u1ed5ng n\u00e0y ch\u1ec9 l\u00e0 t\u00edch v\u00f4 h\u01b0\u1edbng c\u1ee7a vect\u01a1 $a$ v\u1edbi d\u1ecbch chuy\u1ec3n v\u00f2ng tr\u00e1i th\u1ee9 $(k - (n - 1))$ c\u1ee7a $b$. Do \u0111\u00f3, c\u00e1c h\u1ec7 s\u1ed1 n\u00e0y l\u00e0 c\u00e2u tr\u1ea3 l\u1eddi cho b\u00e0i to\u00e1n, v\u00e0 ch\u00fang ta v\u1eabn c\u00f3 th\u1ec3 thu \u0111\u01b0\u1ee3c n\u00f3 trong th\u1eddi gian $O(n \\log n)$. L\u01b0u \u00fd \u1edf \u0111\u00e2y r\u1eb1ng $c[2n-1]$ c\u0169ng cung c\u1ea5p cho ch\u00fang ta d\u1ecbch chuy\u1ec3n v\u00f2ng th\u1ee9 $n$ nh\u01b0ng \u0111\u00f3 c\u0169ng gi\u1ed1ng nh\u01b0 d\u1ecbch chuy\u1ec3n v\u00f2ng th\u1ee9 $0$ n\u00ean ch\u00fang ta kh\u00f4ng c\u1ea7n xem x\u00e9t ri\u00eang bi\u1ec7t v\u00e0o c\u00e2u tr\u1ea3 l\u1eddi c\u1ee7a m\u00ecnh.</p>","tags":["Translated"]},{"location":"algebra/fft.html#two-stripes","title":"Hai d\u1ea3i (Two stripes)","text":"<p>Ch\u00fang ta \u0111\u01b0\u1ee3c cho hai d\u1ea3i Boolean (m\u1ea3ng v\u00f2ng c\u00e1c gi\u00e1 tr\u1ecb $0$ v\u00e0 $1$) $a$ v\u00e0 $b$. Ch\u00fang ta mu\u1ed1n t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c c\u00e1ch \u0111\u1ec3 g\u1eafn d\u1ea3i th\u1ee9 nh\u1ea5t v\u00e0o d\u1ea3i th\u1ee9 hai, sao cho t\u1ea1i kh\u00f4ng v\u1ecb tr\u00ed n\u00e0o ch\u00fang ta c\u00f3 s\u1ed1 $1$ c\u1ee7a d\u1ea3i th\u1ee9 nh\u1ea5t b\u00ean c\u1ea1nh s\u1ed1 $1$ c\u1ee7a d\u1ea3i th\u1ee9 hai.</p> <p>B\u00e0i to\u00e1n th\u1ef1c s\u1ef1 kh\u00f4ng kh\u00e1c nhi\u1ec1u so v\u1edbi b\u00e0i to\u00e1n tr\u01b0\u1edbc. G\u1eafn hai d\u1ea3i ch\u1ec9 c\u00f3 ngh\u0129a l\u00e0 ch\u00fang ta th\u1ef1c hi\u1ec7n d\u1ecbch chuy\u1ec3n v\u00f2ng tr\u00ean m\u1ea3ng th\u1ee9 hai, v\u00e0 ch\u00fang ta c\u00f3 th\u1ec3 g\u1eafn hai d\u1ea3i, n\u1ebfu t\u00edch v\u00f4 h\u01b0\u1edbng c\u1ee7a hai m\u1ea3ng l\u00e0 $0$.</p>","tags":["Translated"]},{"location":"algebra/fft.html#string-matching","title":"Kh\u1edbp chu\u1ed7i (String matching)","text":"<p>Ch\u00fang ta \u0111\u01b0\u1ee3c cho hai chu\u1ed7i, m\u1ed9t v\u0103n b\u1ea3n $T$ v\u00e0 m\u1ed9t m\u1eabu $P$, bao g\u1ed3m c\u00e1c ch\u1eef c\u00e1i th\u01b0\u1eddng. Ch\u00fang ta ph\u1ea3i t\u00ednh to\u00e1n t\u1ea5t c\u1ea3 c\u00e1c l\u1ea7n xu\u1ea5t hi\u1ec7n c\u1ee7a m\u1eabu trong v\u0103n b\u1ea3n.</p> <p>Ch\u00fang ta t\u1ea1o m\u1ed9t \u0111a th\u1ee9c cho m\u1ed7i chu\u1ed7i ($T[i]$ v\u00e0 $P[I]$ l\u00e0 c\u00e1c s\u1ed1 t\u1eeb $0$ \u0111\u1ebfn $25$ t\u01b0\u01a1ng \u1ee9ng v\u1edbi $26$ ch\u1eef c\u00e1i c\u1ee7a b\u1ea3ng ch\u1eef c\u00e1i):</p> $$A(x) = a_0 x^0 + a_1 x^1 + \\dots + a_{n-1} x^{n-1}, \\quad n = |T|$$ <p>v\u1edbi</p> $$a_i = \\cos(\\alpha_i) + i \\sin(\\alpha_i), \\quad \\alpha_i = \\frac{2 \\pi T[i]}{26}.$$ <p>V\u00e0</p> $$B(x) = b_0 x^0 + b_1 x^1 + \\dots + b_{m-1} x^{m-1}, \\quad m = |P|$$ <p>v\u1edbi</p> $$b_i = \\cos(\\beta_i) - i \\sin(\\beta_i), \\quad \\beta_i = \\frac{2 \\pi P[m-i-1]}{26}.$$ <p>L\u01b0u \u00fd r\u1eb1ng v\u1edbi bi\u1ec3u th\u1ee9c $P[m-i-1]$ \u0111\u1ea3o ng\u01b0\u1ee3c m\u1eabu m\u1ed9t c\u00e1ch r\u00f5 r\u00e0ng.</p> <p>H\u1ec7 s\u1ed1 th\u1ee9 $(m-1+i)$ c\u1ee7a t\u00edch c\u1ee7a hai \u0111a th\u1ee9c $C(x) = A(x) \\cdot B(x)$ s\u1ebd cho ch\u00fang ta bi\u1ebft, n\u1ebfu m\u1eabu xu\u1ea5t hi\u1ec7n trong v\u0103n b\u1ea3n t\u1ea1i v\u1ecb tr\u00ed $i$.</p> $$c_{m-1+i} = \\sum_{j = 0}^{m-1} a_{i+j} \\cdot b_{m-1-j} = \\sum_{j=0}^{m-1} \\left(\\cos(\\alpha_{i+j}) + i \\sin(\\alpha_{i+j})\\right) \\cdot \\left(\\cos(\\beta_j) - i \\sin(\\beta_j)\\right)$$ <p>v\u1edbi $\\alpha_{i+j} = \\frac{2 \\pi T[i+j]}{26}$ v\u00e0 $\\beta_j = \\frac{2 \\pi P[j]}{26}$</p> <p>N\u1ebfu c\u00f3 m\u1ed9t s\u1ef1 tr\u00f9ng kh\u1edbp, th\u00ec $T[i+j] = P[j]$, v\u00e0 do \u0111\u00f3 $\\alpha_{i+j} = \\beta_j$. \u0110i\u1ec1u n\u00e0y \u0111\u01b0a ra (s\u1eed d\u1ee5ng \u0111\u1eb3ng th\u1ee9c l\u01b0\u1ee3ng gi\u00e1c Pythagore):</p> $$\\begin{align} c_{m-1+i} &amp;= \\sum_{j = 0}^{m-1}  \\left(\\cos(\\alpha_{i+j}) + i \\sin(\\alpha_{i+j})\\right) \\cdot \\left(\\cos(\\alpha_{i+j}) - i \\sin(\\alpha_{i+j})\\right) \\\\ &amp;= \\sum_{j = 0}^{m-1} \\cos(\\alpha_{i+j})^2 + \\sin(\\alpha_{i+j})^2 = \\sum_{j = 0}^{m-1} 1 = m \\end{align}$$ <p>N\u1ebfu kh\u00f4ng c\u00f3 s\u1ef1 tr\u00f9ng kh\u1edbp, th\u00ec \u00edt nh\u1ea5t m\u1ed9t k\u00fd t\u1ef1 l\u00e0 kh\u00e1c nhau, d\u1eabn \u0111\u1ebfn m\u1ed9t trong c\u00e1c t\u00edch $a_{i+1} \\cdot b_{m-1-j}$ kh\u00f4ng b\u1eb1ng $1$, d\u1eabn \u0111\u1ebfn h\u1ec7 s\u1ed1 $c_{m-1+i} \\ne m$.</p>","tags":["Translated"]},{"location":"algebra/fft.html#string-matching-with-wildcards","title":"Kh\u1edbp chu\u1ed7i v\u1edbi k\u00fd t\u1ef1 \u0111\u1ea1i di\u1ec7n (String matching with wildcards)","text":"<p>\u0110\u00e2y l\u00e0 m\u1ed9t ph\u1ea7n m\u1edf r\u1ed9ng c\u1ee7a b\u00e0i to\u00e1n tr\u01b0\u1edbc. L\u1ea7n n\u00e0y ch\u00fang ta cho ph\u00e9p m\u1eabu ch\u1ee9a k\u00fd t\u1ef1 \u0111\u1ea1i di\u1ec7n $\\*$, c\u00f3 th\u1ec3 kh\u1edbp v\u1edbi m\u1ecdi ch\u1eef c\u00e1i c\u00f3 th\u1ec3. V\u00ed d\u1ee5: m\u1eabu $a*c$ xu\u1ea5t hi\u1ec7n trong v\u0103n b\u1ea3n $abccaacc$ t\u1ea1i ch\u00ednh x\u00e1c ba v\u1ecb tr\u00ed, t\u1ea1i ch\u1ec9 s\u1ed1 $0$, ch\u1ec9 s\u1ed1 $4$ v\u00e0 ch\u1ec9 s\u1ed1 $5$.</p> <p>Ch\u00fang ta t\u1ea1o ra c\u00e1c \u0111a th\u1ee9c ho\u00e0n to\u00e0n gi\u1ed1ng nhau, ngo\u1ea1i tr\u1eeb vi\u1ec7c ch\u00fang ta \u0111\u1eb7t $b_i = 0$ n\u1ebfu $P[m-i-1] = *$. N\u1ebfu $x$ l\u00e0 s\u1ed1 l\u01b0\u1ee3ng k\u00fd t\u1ef1 \u0111\u1ea1i di\u1ec7n trong $P$, th\u00ec ch\u00fang ta s\u1ebd c\u00f3 m\u1ed9t s\u1ef1 tr\u00f9ng kh\u1edbp c\u1ee7a $P$ trong $T$ t\u1ea1i ch\u1ec9 s\u1ed1 $i$ n\u1ebfu $c_{m-1+i} = m - x$.</p>","tags":["Translated"]},{"location":"algebra/fft.html#practice-problems","title":"B\u00e0i t\u1eadp luy\u1ec7n t\u1eadp","text":"<ul> <li>SPOJ - POLYMUL</li> <li>SPOJ - MAXMATCH</li> <li>SPOJ - ADAMATCH</li> <li>Codeforces - Yet Another String Matching Problem</li> <li>Codeforces - Lightsabers (hard)</li> <li>Codeforces - Running Competition</li> <li>Kattis - A+B Problem</li> <li>Kattis - K-Inversions</li> <li>Codeforces - Dasha and cyclic table</li> <li>CodeChef - Expected Number of Customers</li> <li>CodeChef - Power Sum</li> <li>Codeforces - Centroid Probabilities</li> </ul>","tags":["Translated"]},{"location":"algebra/fft.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 665</li> <li>Translated lines: 665</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Translated"]},{"location":"algebra/fibonacci-numbers.html","title":"S\u1ed1 Fibonacci (Fibonacci Numbers)","text":"<p>D\u00e3y Fibonacci \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a nh\u01b0 sau:</p> $$F_0 = 0, F_1 = 1, F_n = F_{n-1} + F_{n-2}$$ <p>C\u00e1c ph\u1ea7n t\u1eed \u0111\u1ea7u ti\u00ean c\u1ee7a d\u00e3y (OEIS A000045) l\u00e0:</p> $$0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, ...$$","tags":["Translated"]},{"location":"algebra/fibonacci-numbers.html#properties","title":"C\u00e1c t\u00ednh ch\u1ea5t (Properties)","text":"<p>C\u00e1c s\u1ed1 Fibonacci s\u1edf h\u1eefu r\u1ea5t nhi\u1ec1u t\u00ednh ch\u1ea5t th\u00fa v\u1ecb. D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u1ed9t v\u00e0i trong s\u1ed1 \u0111\u00f3:</p> <ul> <li>\u0110\u1eb3ng th\u1ee9c Cassini:</li> </ul> $$F_{n-1} F_{n+1} - F_n^2 = (-1)^n$$ <p>\u0110i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c ch\u1ee9ng minh b\u1eb1ng quy n\u1ea1p. M\u1ed9t b\u1eb1ng ch\u1ee9ng m\u1ed9t d\u00f2ng c\u1ee7a Knuth \u0111\u1ebfn t\u1eeb vi\u1ec7c l\u1ea5y \u0111\u1ecbnh th\u1ee9c c\u1ee7a d\u1ea1ng ma tr\u1eadn 2x2 b\u00ean d\u01b0\u1edbi.</p> <ul> <li>Quy t\u1eafc \"c\u1ed9ng\":</li> </ul> $$F_{n+k} = F_k F_{n+1} + F_{k-1} F_n$$ <ul> <li>\u00c1p d\u1ee5ng \u0111\u1eb3ng th\u1ee9c tr\u01b0\u1edbc cho tr\u01b0\u1eddng h\u1ee3p $k = n$, ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c:</li> </ul> $$F_{2n} = F_n (F_{n+1} + F_{n-1})$$ <ul> <li> <p>T\u1eeb \u0111\u00f3 ch\u00fang ta c\u00f3 th\u1ec3 ch\u1ee9ng minh b\u1eb1ng quy n\u1ea1p r\u1eb1ng v\u1edbi m\u1ecdi s\u1ed1 nguy\u00ean d\u01b0\u01a1ng $k$,  $F_{nk}$ l\u00e0 b\u1ed9i c\u1ee7a $F_n$.</p> </li> <li> <p>Ngh\u1ecbch \u0111\u1ea3o c\u0169ng \u0111\u00fang: n\u1ebfu $F_m$ l\u00e0 b\u1ed9i c\u1ee7a $F_n$, th\u00ec $m$ l\u00e0 b\u1ed9i c\u1ee7a $n$.</p> </li> <li> <p>\u0110\u1eb3ng th\u1ee9c GCD:</p> </li> </ul> $$GCD(F_m, F_n) = F_{GCD(m, n)}$$ <ul> <li>C\u00e1c s\u1ed1 Fibonacci l\u00e0 \u0111\u1ea7u v\u00e0o t\u1ed3i t\u1ec7 nh\u1ea5t c\u00f3 th\u1ec3 cho thu\u1eadt to\u00e1n Euclid (xem \u0111\u1ecbnh l\u00fd Lame trong Thu\u1eadt to\u00e1n Euclid)</li> </ul>","tags":["Translated"]},{"location":"algebra/fibonacci-numbers.html#fibonacci-coding","title":"M\u00e3 h\u00f3a Fibonacci (Fibonacci Coding)","text":"<p>Ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng d\u00e3y s\u1ed1 n\u00e0y \u0111\u1ec3 m\u00e3 h\u00f3a c\u00e1c s\u1ed1 nguy\u00ean d\u01b0\u01a1ng th\u00e0nh c\u00e1c t\u1eeb m\u00e3 nh\u1ecb ph\u00e2n. Theo \u0111\u1ecbnh l\u00fd Zeckendorf, b\u1ea5t k\u1ef3 s\u1ed1 t\u1ef1 nhi\u00ean $n$ n\u00e0o c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n duy nh\u1ea5t d\u01b0\u1edbi d\u1ea1ng t\u1ed5ng c\u1ee7a c\u00e1c s\u1ed1 Fibonacci:</p> $$N = F_{k_1} + F_{k_2} + \\ldots + F_{k_r}$$ <p>sao cho $k_1 \\ge k_2 + 2,\\ k_2 \\ge k_3 + 2,\\  \\ldots,\\  k_r \\ge 2$ (t\u1ee9c l\u00e0: bi\u1ec3u di\u1ec5n kh\u00f4ng th\u1ec3 s\u1eed d\u1ee5ng hai s\u1ed1 Fibonacci li\u00ean ti\u1ebfp).</p> <p>Suy ra r\u1eb1ng b\u1ea5t k\u1ef3 s\u1ed1 n\u00e0o c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c m\u00e3 h\u00f3a duy nh\u1ea5t trong m\u00e3 h\u00f3a Fibonacci. V\u00e0 ch\u00fang ta c\u00f3 th\u1ec3 m\u00f4 t\u1ea3 bi\u1ec3u di\u1ec5n n\u00e0y b\u1eb1ng c\u00e1c m\u00e3 nh\u1ecb ph\u00e2n $d_0 d_1 d_2 \\dots d_s 1$, trong \u0111\u00f3 $d_i$ l\u00e0 $1$ n\u1ebfu $F_{i+2}$ \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng trong bi\u1ec3u di\u1ec5n. M\u00e3 s\u1ebd \u0111\u01b0\u1ee3c th\u00eam v\u00e0o m\u1ed9t s\u1ed1 $1$ \u0111\u1ec3 ch\u1ec9 ra k\u1ebft th\u00fac c\u1ee7a t\u1eeb m\u00e3. L\u01b0u \u00fd r\u1eb1ng \u0111\u00e2y l\u00e0 l\u1ea7n xu\u1ea5t hi\u1ec7n duy nh\u1ea5t m\u00e0 hai bit 1 li\u00ean ti\u1ebfp xu\u1ea5t hi\u1ec7n.</p> $$\\begin{eqnarray} 1 &amp;=&amp; 1 &amp;=&amp; F_2 &amp;=&amp; (11)_F \\\\ 2 &amp;=&amp; 2 &amp;=&amp; F_3 &amp;=&amp; (011)_F \\\\ 6 &amp;=&amp; 5 + 1 &amp;=&amp; F_5 + F_2 &amp;=&amp; (10011)_F \\\\ 8 &amp;=&amp; 8 &amp;=&amp; F_6 &amp;=&amp; (000011)_F \\\\ 9 &amp;=&amp; 8 + 1 &amp;=&amp; F_6 + F_2 &amp;=&amp; (100011)_F \\\\ 19 &amp;=&amp; 13 + 5 + 1 &amp;=&amp; F_7 + F_5 + F_2 &amp;=&amp; (1001011)_F \\end{eqnarray}$$ <p>Vi\u1ec7c m\u00e3 h\u00f3a m\u1ed9t s\u1ed1 nguy\u00ean $n$ c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n b\u1eb1ng m\u1ed9t thu\u1eadt to\u00e1n tham lam \u0111\u01a1n gi\u1ea3n:</p> <ol> <li> <p>L\u1eb7p qua c\u00e1c s\u1ed1 Fibonacci t\u1eeb l\u1edbn nh\u1ea5t \u0111\u1ebfn nh\u1ecf nh\u1ea5t cho \u0111\u1ebfn khi b\u1ea1n t\u00ecm th\u1ea5y m\u1ed9t s\u1ed1 nh\u1ecf h\u01a1n ho\u1eb7c b\u1eb1ng $n$.</p> </li> <li> <p>Gi\u1ea3 s\u1eed s\u1ed1 n\u00e0y l\u00e0 $F_i$. Tr\u1eeb $F_i$ t\u1eeb $n$ v\u00e0 \u0111\u1eb7t m\u1ed9t s\u1ed1 $1$ \u1edf v\u1ecb tr\u00ed $i-2$ c\u1ee7a t\u1eeb m\u00e3 (\u0111\u00e1nh ch\u1ec9 s\u1ed1 t\u1eeb 0 t\u1eeb bit ngo\u00e0i c\u00f9ng b\u00ean tr\u00e1i sang bit ngo\u00e0i c\u00f9ng b\u00ean ph\u1ea3i).</p> </li> <li> <p>L\u1eb7p l\u1ea1i cho \u0111\u1ebfn khi kh\u00f4ng c\u00f2n s\u1ed1 d\u01b0.</p> </li> <li> <p>Th\u00eam m\u1ed9t s\u1ed1 $1$ cu\u1ed1i c\u00f9ng v\u00e0o t\u1eeb m\u00e3 \u0111\u1ec3 ch\u1ec9 ra s\u1ef1 k\u1ebft th\u00fac c\u1ee7a n\u00f3.</p> </li> </ol> <p>\u0110\u1ec3 gi\u1ea3i m\u00e3 m\u1ed9t t\u1eeb m\u00e3, tr\u01b0\u1edbc ti\u00ean h\u00e3y lo\u1ea1i b\u1ecf s\u1ed1 $1$ cu\u1ed1i c\u00f9ng. Sau \u0111\u00f3, n\u1ebfu bit th\u1ee9 $i$ \u0111\u01b0\u1ee3c b\u1eadt (\u0111\u00e1nh ch\u1ec9 s\u1ed1 t\u1eeb 0 t\u1eeb bit ngo\u00e0i c\u00f9ng b\u00ean tr\u00e1i sang ph\u1ea3i), h\u00e3y c\u1ed9ng $F_{i+2}$ v\u00e0o s\u1ed1.</p>","tags":["Translated"]},{"location":"algebra/fibonacci-numbers.html#formulas-for-the-n-th-fibonacci-number","title":"C\u00e1c c\u00f4ng th\u1ee9c cho s\u1ed1 Fibonacci th\u1ee9 $n$ (Formulas for the $n$-th Fibonacci number)","text":"","tags":["Translated"]},{"location":"algebra/fibonacci-numbers.html#closed-form-expression","title":"Bi\u1ec3u th\u1ee9c d\u1ea1ng \u0111\u00f3ng (Closed-form expression)","text":"<p>C\u00f3 m\u1ed9t c\u00f4ng th\u1ee9c \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 \"c\u00f4ng th\u1ee9c Binet\", m\u1eb7c d\u00f9 n\u00f3 \u0111\u00e3 \u0111\u01b0\u1ee3c Moivre bi\u1ebft \u0111\u1ebfn:</p> $$F_n = \\frac{\\left(\\frac{1 + \\sqrt{5}}{2}\\right)^n - \\left(\\frac{1 - \\sqrt{5}}{2}\\right)^n}{\\sqrt{5}}$$ <p>C\u00f4ng th\u1ee9c n\u00e0y d\u1ec5 d\u00e0ng ch\u1ee9ng minh b\u1eb1ng quy n\u1ea1p, nh\u01b0ng n\u00f3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c suy ra v\u1edbi s\u1ef1 tr\u1ee3 gi\u00fap c\u1ee7a kh\u00e1i ni\u1ec7m h\u00e0m sinh ho\u1eb7c b\u1eb1ng c\u00e1ch gi\u1ea3i ph\u01b0\u01a1ng tr\u00ecnh h\u00e0m.</p> <p>B\u1ea1n c\u00f3 th\u1ec3 nh\u1eadn th\u1ea5y ngay l\u1eadp t\u1ee9c r\u1eb1ng gi\u00e1 tr\u1ecb tuy\u1ec7t \u0111\u1ed1i c\u1ee7a s\u1ed1 h\u1ea1ng th\u1ee9 hai lu\u00f4n nh\u1ecf h\u01a1n $1$, v\u00e0 n\u00f3 c\u0169ng gi\u1ea3m r\u1ea5t nhanh (theo c\u1ea5p s\u1ed1 nh\u00e2n). Do \u0111\u00f3, gi\u00e1 tr\u1ecb c\u1ee7a s\u1ed1 h\u1ea1ng \u0111\u1ea7u ti\u00ean m\u1ed9t m\u00ecnh l\u00e0 \"g\u1ea7n nh\u01b0\" $F_n$. \u0110i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c vi\u1ebft m\u1ed9t c\u00e1ch ch\u1eb7t ch\u1ebd nh\u01b0 sau: </p> $$F_n = \\left[\\frac{\\left(\\frac{1 + \\sqrt{5}}{2}\\right)^n}{\\sqrt{5}}\\right]$$ <p>trong \u0111\u00f3 d\u1ea5u ngo\u1eb7c vu\u00f4ng bi\u1ec3u th\u1ecb vi\u1ec7c l\u00e0m tr\u00f2n \u0111\u1ebfn s\u1ed1 nguy\u00ean g\u1ea7n nh\u1ea5t.</p> <p>V\u00ec hai c\u00f4ng th\u1ee9c n\u00e0y s\u1ebd y\u00eau c\u1ea7u \u0111\u1ed9 ch\u00ednh x\u00e1c r\u1ea5t cao khi l\u00e0m vi\u1ec7c v\u1edbi c\u00e1c s\u1ed1 ph\u00e2n s\u1ed1, ch\u00fang \u00edt c\u00f3 gi\u00e1 tr\u1ecb trong c\u00e1c t\u00ednh to\u00e1n th\u1ef1c t\u1ebf.</p>","tags":["Translated"]},{"location":"algebra/fibonacci-numbers.html#fibonacci-in-linear-time","title":"Fibonacci trong th\u1eddi gian tuy\u1ebfn t\u00ednh (Fibonacci in linear time)","text":"<p>S\u1ed1 Fibonacci th\u1ee9 $n$ c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng t\u00ecm th\u1ea5y trong $O(n)$ b\u1eb1ng c\u00e1ch t\u00ednh to\u00e1n c\u00e1c s\u1ed1 t\u1eebng c\u00e1i m\u1ed9t cho \u0111\u1ebfn $n$. Tuy nhi\u00ean, c\u0169ng c\u00f3 nh\u1eefng c\u00e1ch nhanh h\u01a1n, nh\u01b0 ch\u00fang ta s\u1ebd th\u1ea5y.</p> <p>Ch\u00fang ta c\u00f3 th\u1ec3 b\u1eaft \u0111\u1ea7u t\u1eeb m\u1ed9t c\u00e1ch ti\u1ebfp c\u1eadn l\u1eb7p, \u0111\u1ec3 t\u1eadn d\u1ee5ng vi\u1ec7c s\u1eed d\u1ee5ng c\u00f4ng th\u1ee9c $F_n = F_{n-1} + F_{n-2}$, do \u0111\u00f3, ch\u00fang ta s\u1ebd ch\u1ec9 c\u1ea7n t\u00ednh tr\u01b0\u1edbc c\u00e1c gi\u00e1 tr\u1ecb \u0111\u00f3 trong m\u1ed9t m\u1ea3ng. T\u00ednh \u0111\u1ebfn c\u00e1c tr\u01b0\u1eddng h\u1ee3p c\u01a1 s\u1edf cho $F_0$ v\u00e0 $F_1$.</p> <pre><code>int fib(int n) {\n    int a = 0;\n    int b = 1;\n    for (int i = 0; i &lt; n; i++) {\n        int tmp = a + b;\n        a = b;\n        b = tmp;\n    }\n    return a;\n}\n</code></pre> <p>B\u1eb1ng c\u00e1ch n\u00e0y, ch\u00fang ta thu \u0111\u01b0\u1ee3c m\u1ed9t gi\u1ea3i ph\u00e1p tuy\u1ebfn t\u00ednh, th\u1eddi gian $O(n)$, l\u01b0u t\u1ea5t c\u1ea3 c\u00e1c gi\u00e1 tr\u1ecb tr\u01b0\u1edbc $n$ trong d\u00e3y.</p>","tags":["Translated"]},{"location":"algebra/fibonacci-numbers.html#matrix-form","title":"D\u1ea1ng ma tr\u1eadn (Matrix form)","text":"<p>\u0110\u1ec3 \u0111i t\u1eeb $(F_n, F_{n-1})$ \u0111\u1ebfn $(F_{n+1}, F_n)$, ch\u00fang ta c\u00f3 th\u1ec3 bi\u1ec3u di\u1ec5n c\u00f4ng th\u1ee9c truy h\u1ed3i tuy\u1ebfn t\u00ednh d\u01b0\u1edbi d\u1ea1ng ph\u00e9p nh\u00e2n ma tr\u1eadn 2x2:</p> $$ \\begin{pmatrix} 1 &amp; 1 \\\\ 1 &amp; 0 \\end{pmatrix} \\begin{pmatrix} F_n \\\\ F_{n-1} \\end{pmatrix} = \\begin{pmatrix} F_n + F_{n-1}  \\\\ F_{n} \\end{pmatrix} = \\begin{pmatrix} F_{n+1}  \\\\ F_{n} \\end{pmatrix} $$ <p>\u0110i\u1ec1u n\u00e0y cho ph\u00e9p ch\u00fang ta coi vi\u1ec7c l\u1eb7p l\u1ea1i c\u00f4ng th\u1ee9c truy h\u1ed3i nh\u01b0 l\u00e0 ph\u00e9p nh\u00e2n ma tr\u1eadn l\u1eb7p l\u1ea1i, c\u00f3 c\u00e1c t\u00ednh ch\u1ea5t \u0111\u1eb9p. C\u1ee5 th\u1ec3,</p> $$ \\begin{pmatrix} 1 &amp; 1 \\\\ 1 &amp; 0 \\end{pmatrix}^n \\begin{pmatrix} F_1 \\\\ F_0 \\end{pmatrix} = \\begin{pmatrix} F_{n+1}  \\\\ F_{n} \\end{pmatrix} $$ <p>trong \u0111\u00f3 $F_1 = 1, F_0 = 0$.  Trong th\u1ef1c t\u1ebf, v\u00ec </p> $$ \\begin{pmatrix} 1 &amp; 1 \\\\ 1 &amp; 0 \\end{pmatrix} = \\begin{pmatrix} F_2 &amp; F_1 \\\\ F_1 &amp; F_0 \\end{pmatrix} $$ <p>ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng ma tr\u1eadn tr\u1ef1c ti\u1ebfp:</p> $$ \\begin{pmatrix} 1 &amp; 1 \\\\ 1 &amp; 0 \\end{pmatrix}^n = \\begin{pmatrix} F_{n+1} &amp; F_n \\\\ F_n &amp; F_{n-1} \\end{pmatrix} $$ <p>Do \u0111\u00f3, \u0111\u1ec3 t\u00ecm $F_n$ trong th\u1eddi gian $O(\\log  n)$, ch\u00fang ta ph\u1ea3i n\u00e2ng ma tr\u1eadn l\u00ean l\u0169y th\u1eeba n. (Xem L\u0169y th\u1eeba nh\u1ecb ph\u00e2n)</p> <pre><code>struct matrix {\n    long long mat[2][2];\n    matrix friend operator *(const matrix &amp;a, const matrix &amp;b){\n        matrix c;\n        for (int i = 0; i &lt; 2; i++) {\n          for (int j = 0; j &lt; 2; j++) {\n              c.mat[i][j] = 0;\n              for (int k = 0; k &lt; 2; k++) {\n                  c.mat[i][j] += a.mat[i][k] * b.mat[k][j];\n              }\n          }\n        }\n        return c;\n    }\n};\n\nmatrix matpow(matrix base, long long n) {\n    matrix ans{ {\n      {1, 0},\n      {0, 1}\n    } };\n    while (n) {\n        if(n&amp;1)\n            ans = ans*base;\n        base = base*base;\n        n &gt;&gt;= 1;\n    }\n    return ans;\n}\n\nlong long fib(int n) {\n    matrix base{ {\n      {1, 1},\n      {1, 0}\n    } };\n    return matpow(base, n).mat[0][1];\n}\n</code></pre>","tags":["Translated"]},{"location":"algebra/fibonacci-numbers.html#fast-doubling-method","title":"Ph\u01b0\u01a1ng ph\u00e1p nh\u00e2n \u0111\u00f4i nhanh (Fast Doubling Method)","text":"<p>B\u1eb1ng c\u00e1ch khai tri\u1ec3n bi\u1ec3u th\u1ee9c ma tr\u1eadn \u1edf tr\u00ean cho $n = 2\\cdot k$</p> $$ \\begin{pmatrix} F_{2k+1} &amp; F_{2k}\\\\ F_{2k} &amp; F_{2k-1} \\end{pmatrix} = \\begin{pmatrix} 1 &amp; 1\\\\ 1 &amp; 0 \\end{pmatrix}^{2k} = \\begin{pmatrix} F_{k+1} &amp; F_{k}\\\\ F_{k} &amp; F_{k-1} \\end{pmatrix} ^2 $$ <p>ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm th\u1ea5y c\u00e1c ph\u01b0\u01a1ng tr\u00ecnh \u0111\u01a1n gi\u1ea3n h\u01a1n sau:</p> $$ \\begin{align} F_{2k+1} &amp;= F_{k+1}^2 + F_{k}^2 \\\\ F_{2k} &amp;= F_k(F_{k+1}+F_{k-1}) = F_k (2F_{k+1} - F_{k})\\\\ \\end{align}.$$ <p>Do \u0111\u00f3 s\u1eed d\u1ee5ng hai ph\u01b0\u01a1ng tr\u00ecnh tr\u00ean, s\u1ed1 Fibonacci c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n d\u1ec5 d\u00e0ng b\u1eb1ng \u0111o\u1ea1n m\u00e3 sau:</p> <p><pre><code>pair&lt;int, int&gt; fib (int n) {\n    if (n == 0)\n        return {0, 1};\n\n    auto p = fib(n &gt;&gt; 1);\n    int c = p.first * (2 * p.second - p.first);\n    int d = p.first * p.first + p.second * p.second;\n    if (n &amp; 1)\n        return {d, c + d};\n    else\n        return {c, d};\n}\n</code></pre> M\u00e3 tr\u00ean tr\u1ea3 v\u1ec1 $F_n$ v\u00e0 $F_{n+1}$ d\u01b0\u1edbi d\u1ea1ng m\u1ed9t c\u1eb7p.</p>","tags":["Translated"]},{"location":"algebra/fibonacci-numbers.html#periodicity-modulo-p","title":"T\u00ednh tu\u1ea7n ho\u00e0n modulo p (Periodicity modulo p)","text":"<p>Xem x\u00e9t d\u00e3y Fibonacci modulo $p$. Ch\u00fang t\u00f4i s\u1ebd ch\u1ee9ng minh d\u00e3y n\u00e0y l\u00e0 tu\u1ea7n ho\u00e0n.</p> <p>H\u00e3y ch\u1ee9ng minh \u0111i\u1ec1u n\u00e0y b\u1eb1ng ph\u1ea3n ch\u1ee9ng. Xem x\u00e9t $p^2 + 1$ c\u1eb7p s\u1ed1 Fibonacci \u0111\u1ea7u ti\u00ean l\u1ea5y modulo $p$:</p> $$(F_0,\\ F_1),\\ (F_1,\\ F_2),\\ \\ldots,\\ (F_{p^2},\\ F_{p^2 + 1})$$ <p>Ch\u1ec9 c\u00f3 th\u1ec3 c\u00f3 $p$ s\u1ed1 d\u01b0 kh\u00e1c nhau modulo $p$, v\u00e0 t\u1ed1i \u0111a $p^2$ c\u1eb7p d\u01b0 kh\u00e1c nhau, v\u00ec v\u1eady c\u00f3 \u00edt nh\u1ea5t hai c\u1eb7p gi\u1ed1ng h\u1ec7t nhau trong s\u1ed1 ch\u00fang. \u0110i\u1ec1u n\u00e0y \u0111\u1ee7 \u0111\u1ec3 ch\u1ee9ng minh d\u00e3y l\u00e0 tu\u1ea7n ho\u00e0n, v\u00ec m\u1ed9t s\u1ed1 Fibonacci ch\u1ec9 \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh b\u1edfi hai s\u1ed1 li\u1ec1n tr\u01b0\u1edbc c\u1ee7a n\u00f3. Do \u0111\u00f3 n\u1ebfu hai c\u1eb7p s\u1ed1 li\u00ean ti\u1ebfp l\u1eb7p l\u1ea1i, \u0111i\u1ec1u \u0111\u00f3 c\u0169ng c\u00f3 ngh\u0129a l\u00e0 c\u00e1c s\u1ed1 sau c\u1eb7p \u0111\u00f3 s\u1ebd l\u1eb7p l\u1ea1i theo c\u00f9ng m\u1ed9t c\u00e1ch.</p> <p>B\u00e2y gi\u1edd ch\u00fang ta ch\u1ecdn hai c\u1eb7p s\u1ed1 d\u01b0 gi\u1ed1ng h\u1ec7t nhau v\u1edbi c\u00e1c ch\u1ec9 s\u1ed1 nh\u1ecf nh\u1ea5t trong d\u00e3y. G\u1ecdi c\u00e1c c\u1eb7p l\u00e0 $(F_a,\\ F_{a + 1})$ v\u00e0 $(F_b,\\ F_{b + 1})$. Ch\u00fang ta s\u1ebd ch\u1ee9ng minh r\u1eb1ng $a = 0$. N\u1ebfu \u0111i\u1ec1u n\u00e0y sai, s\u1ebd c\u00f3 hai c\u1eb7p tr\u01b0\u1edbc \u0111\u00f3 $(F_{a-1},\\ F_a)$ v\u00e0 $(F_{b-1},\\ F_b)$, m\u00e0 theo t\u00ednh ch\u1ea5t c\u1ee7a s\u1ed1 Fibonacci, c\u0169ng s\u1ebd b\u1eb1ng nhau. Tuy nhi\u00ean, \u0111i\u1ec1u n\u00e0y m\u00e2u thu\u1eabn v\u1edbi th\u1ef1c t\u1ebf l\u00e0 ch\u00fang ta \u0111\u00e3 ch\u1ecdn c\u00e1c c\u1eb7p c\u00f3 ch\u1ec9 s\u1ed1 nh\u1ecf nh\u1ea5t, ho\u00e0n th\u00e0nh ch\u1ee9ng minh c\u1ee7a ch\u00fang ta r\u1eb1ng kh\u00f4ng c\u00f3 ti\u1ec1n chu k\u1ef3 (t\u1ee9c l\u00e0 c\u00e1c s\u1ed1 tu\u1ea7n ho\u00e0n b\u1eaft \u0111\u1ea7u t\u1eeb $F_0$).</p>","tags":["Translated"]},{"location":"algebra/fibonacci-numbers.html#practice-problems","title":"B\u00e0i t\u1eadp luy\u1ec7n t\u1eadp","text":"<ul> <li>SPOJ - Euclid Algorithm Revisited</li> <li>SPOJ - Fibonacci Sum</li> <li>HackerRank - Is Fibo</li> <li>Project Euler - Even Fibonacci numbers</li> <li>DMOJ - Fibonacci Sequence</li> <li>DMOJ - Fibonacci Sequence (Harder)</li> <li>DMOJ UCLV - Numbered sequence of pencils</li> <li>DMOJ UCLV - Fibonacci 2D</li> <li>DMOJ UCLV - fibonacci calculation</li> <li>LightOJ -  Number Sequence</li> <li>Codeforces - C. Fibonacci</li> <li>Codeforces - A. Hexadecimal's theorem</li> <li>Codeforces - B. Blackboard Fibonacci</li> <li>Codeforces - E. Fibonacci Number</li> </ul>","tags":["Translated"]},{"location":"algebra/fibonacci-numbers.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 294</li> <li>Translated lines: 294</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Translated"]},{"location":"algebra/garners-algorithm.html","title":"Thu\u1eadt to\u00e1n Garner (Garner's algorithm)","text":"<p>M\u1ed9t h\u1ec7 qu\u1ea3 c\u1ee7a \u0110\u1ecbnh l\u00fd Th\u1eb7ng d\u01b0 Trung Hoa (Chinese Remainder Theorem) l\u00e0, ch\u00fang ta c\u00f3 th\u1ec3 bi\u1ec3u di\u1ec5n c\u00e1c s\u1ed1 l\u1edbn b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng m\u1ed9t m\u1ea3ng c\u00e1c s\u1ed1 nguy\u00ean nh\u1ecf. V\u00ed d\u1ee5, g\u1ecdi $p$ l\u00e0 t\u00edch c\u1ee7a $1000$ s\u1ed1 nguy\u00ean t\u1ed1 \u0111\u1ea7u ti\u00ean. $p$ c\u00f3 kho\u1ea3ng $3000$ ch\u1eef s\u1ed1.</p> <p>B\u1ea5t k\u1ef3 s\u1ed1 $a$ n\u00e0o nh\u1ecf h\u01a1n $p$ c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n d\u01b0\u1edbi d\u1ea1ng m\u1ed9t m\u1ea3ng $a_1, \\ldots, a_k$, trong \u0111\u00f3 $a_i \\equiv a \\pmod{p_i}$. Nh\u01b0ng \u0111\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y, ch\u00fang ta r\u00f5 r\u00e0ng c\u1ea7n bi\u1ebft c\u00e1ch l\u1ea5y l\u1ea1i s\u1ed1 $a$ t\u1eeb bi\u1ec3u di\u1ec5n c\u1ee7a n\u00f3. M\u1ed9t c\u00e1ch \u0111\u01b0\u1ee3c th\u1ea3o lu\u1eadn trong b\u00e0i vi\u1ebft v\u1ec1 \u0110\u1ecbnh l\u00fd Th\u1eb7ng d\u01b0 Trung Hoa.</p> <p>Trong b\u00e0i vi\u1ebft n\u00e0y, ch\u00fang t\u00f4i th\u1ea3o lu\u1eadn v\u1ec1 m\u1ed9t gi\u1ea3i ph\u00e1p thay th\u1ebf, Thu\u1eadt to\u00e1n Garner, c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng cho m\u1ee5c \u0111\u00edch n\u00e0y.</p>"},{"location":"algebra/garners-algorithm.html#mixed-radix-representation","title":"Bi\u1ec3u di\u1ec5n c\u01a1 s\u1ed1 h\u1ed7n h\u1ee3p (Mixed Radix Representation)","text":"<p>Ch\u00fang ta c\u00f3 th\u1ec3 bi\u1ec3u di\u1ec5n s\u1ed1 $a$ trong bi\u1ec3u di\u1ec5n c\u01a1 s\u1ed1 h\u1ed7n h\u1ee3p:</p> $$a = x_1 + x_2 p_1 + x_3 p_1 p_2 + \\ldots + x_k p_1 \\cdots p_{k-1} \\text{ v\u1edbi }x_i \\in [0, p_i)$$ <p>M\u1ed9t bi\u1ec3u di\u1ec5n c\u01a1 s\u1ed1 h\u1ed7n h\u1ee3p l\u00e0 m\u1ed9t h\u1ec7 th\u1ed1ng s\u1ed1 theo v\u1ecb tr\u00ed, \u0111\u00f3 l\u00e0 s\u1ef1 t\u1ed5ng qu\u00e1t c\u1ee7a c\u00e1c h\u1ec7 th\u1ed1ng s\u1ed1 \u0111i\u1ec3n h\u00ecnh, nh\u01b0 h\u1ec7 nh\u1ecb ph\u00e2n ho\u1eb7c h\u1ec7 th\u1eadp ph\u00e2n. V\u00ed d\u1ee5, h\u1ec7 th\u1eadp ph\u00e2n l\u00e0 m\u1ed9t h\u1ec7 th\u1ed1ng s\u1ed1 theo v\u1ecb tr\u00ed v\u1edbi c\u01a1 s\u1ed1 (ho\u1eb7c base) 10. M\u1ed7i s\u1ed1 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n d\u01b0\u1edbi d\u1ea1ng m\u1ed9t chu\u1ed7i c\u00e1c ch\u1eef s\u1ed1 $d_1 d_2 d_3 \\dots d_n$ n\u1eb1m gi\u1eefa $0$ v\u00e0 $9$. V\u00ed d\u1ee5, chu\u1ed7i $415$ bi\u1ec3u di\u1ec5n s\u1ed1 $4 \\cdot 10^2 + 1 \\cdot 10^1 + 5 \\cdot 10^0$. Nh\u00ecn chung chu\u1ed7i c\u00e1c ch\u1eef s\u1ed1 $d_1 d_2 d_3 \\dots d_n$ bi\u1ec3u di\u1ec5n s\u1ed1 $d_1 b^{n-1} + d_2 b^{n-2} + \\cdots + d_n b^0$ trong h\u1ec7 th\u1ed1ng s\u1ed1 theo v\u1ecb tr\u00ed v\u1edbi c\u01a1 s\u1ed1 $b$.</p> <p>Trong h\u1ec7 c\u01a1 s\u1ed1 h\u1ed7n h\u1ee3p, ch\u00fang ta kh\u00f4ng c\u00f2n m\u1ed9t c\u01a1 s\u1ed1 n\u1eefa. C\u01a1 s\u1ed1 thay \u0111\u1ed5i t\u1eeb v\u1ecb tr\u00ed n\u00e0y sang v\u1ecb tr\u00ed kh\u00e1c.</p>"},{"location":"algebra/garners-algorithm.html#garners-algorithm-1","title":"Thu\u1eadt to\u00e1n Garner (Garner's algorithm)","text":"<p>Thu\u1eadt to\u00e1n Garner t\u00ednh to\u00e1n c\u00e1c ch\u1eef s\u1ed1 $x_1, \\ldots, x_k$. L\u01b0u \u00fd, r\u1eb1ng c\u00e1c ch\u1eef s\u1ed1 t\u01b0\u01a1ng \u0111\u1ed1i nh\u1ecf. Ch\u1eef s\u1ed1 $x_i$ l\u00e0 m\u1ed9t s\u1ed1 nguy\u00ean t\u1eeb $0$ \u0111\u1ebfn $p_i - 1$.</p> <p>G\u1ecdi $r_{ij}$ bi\u1ec3u th\u1ecb ngh\u1ecbch \u0111\u1ea3o c\u1ee7a $p_i$ modulo $p_j$</p> $$r_{ij} = (p_i)^{-1} \\pmod{p_j}$$ <p>c\u00f3 th\u1ec3 t\u00ecm th\u1ea5y b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 trong Ngh\u1ecbch \u0111\u1ea3o Modulo.</p> <p>Thay th\u1ebf $a$ t\u1eeb bi\u1ec3u di\u1ec5n c\u01a1 s\u1ed1 h\u1ed7n h\u1ee3p v\u00e0o ph\u01b0\u01a1ng tr\u00ecnh \u0111\u1ed3ng d\u01b0 \u0111\u1ea7u ti\u00ean ch\u00fang ta thu \u0111\u01b0\u1ee3c</p> $$a_1 \\equiv x_1 \\pmod{p_1}.$$ <p>Thay th\u1ebf v\u00e0o ph\u01b0\u01a1ng tr\u00ecnh th\u1ee9 hai mang l\u1ea1i</p> $$a_2 \\equiv x_1 + x_2 p_1 \\pmod{p_2},$$ <p>c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c vi\u1ebft l\u1ea1i b\u1eb1ng c\u00e1ch tr\u1eeb $x_1$ v\u00e0 chia cho $p_1$ \u0111\u1ec3 c\u00f3</p> $$\\begin{array}{rclr}     a_2 - x_1 &amp;\\equiv&amp; x_2 p_1 &amp;\\pmod{p_2} \\\\     (a_2 - x_1) r_{12} &amp;\\equiv&amp; x_2 &amp;\\pmod{p_2} \\\\     x_2 &amp;\\equiv&amp; (a_2 - x_1) r_{12} &amp;\\pmod{p_2} \\end{array}$$ <p>T\u01b0\u01a1ng t\u1ef1 ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c r\u1eb1ng</p> $$x_3 \\equiv ((a_3 - x_1) r_{13} - x_2) r_{23} \\pmod{p_3}.$$ <p>B\u00e2y gi\u1edd, ch\u00fang ta c\u00f3 th\u1ec3 th\u1ea5y r\u00f5 m\u1ed9t m\u1eabu \u0111ang n\u1ed5i l\u00ean, c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bi\u1ec3u th\u1ecb b\u1eb1ng m\u00e3 sau:</p> <pre><code>for (int i = 0; i &lt; k; ++i) {\n    x[i] = a[i];\n    for (int j = 0; j &lt; i; ++j) {\n        x[i] = r[j][i] * (x[i] - x[j]);\n\n        x[i] = x[i] % p[i];\n        if (x[i] &lt; 0)\n            x[i] += p[i];\n    }\n}\n</code></pre> <p>V\u00ec v\u1eady, ch\u00fang ta \u0111\u00e3 h\u1ecdc c\u00e1ch t\u00ednh c\u00e1c ch\u1eef s\u1ed1 $x_i$ trong th\u1eddi gian $O(k^2)$. S\u1ed1 $a$ b\u00e2y gi\u1edd c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ednh b\u1eb1ng c\u00f4ng th\u1ee9c \u0111\u00e3 \u0111\u1ec1 c\u1eadp tr\u01b0\u1edbc \u0111\u00f3</p> $$a = x_1 + x_2 \\cdot p_1 + x_3 \\cdot p_1 \\cdot p_2 + \\ldots + x_k \\cdot p_1 \\cdots p_{k-1}$$ <p>\u0110\u00e1ng ch\u00fa \u00fd l\u00e0 trong th\u1ef1c t\u1ebf, ch\u00fang ta h\u1ea7u nh\u01b0 c\u00f3 th\u1ec3 c\u1ea7n t\u00ednh to\u00e1n c\u00e2u tr\u1ea3 l\u1eddi $a$ b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng S\u1ed1 h\u1ecdc \u0111\u1ed9 ch\u00ednh x\u00e1c t\u00f9y \u00fd, nh\u01b0ng c\u00e1c ch\u1eef s\u1ed1 $x_i$ (v\u00ec ch\u00fang nh\u1ecf) th\u01b0\u1eddng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n b\u1eb1ng c\u00e1c ki\u1ec3u t\u00edch h\u1ee3p s\u1eb5n, v\u00e0 do \u0111\u00f3 thu\u1eadt to\u00e1n Garner r\u1ea5t hi\u1ec7u qu\u1ea3.</p>"},{"location":"algebra/garners-algorithm.html#implementation-of-garners-algorithm","title":"C\u00e0i \u0111\u1eb7t thu\u1eadt to\u00e1n Garner (Implementation of Garner's Algorithm)","text":"<p>Thu\u1eadn ti\u1ec7n \u0111\u1ec3 c\u00e0i \u0111\u1eb7t thu\u1eadt to\u00e1n n\u00e0y b\u1eb1ng Java, v\u00ec n\u00f3 c\u00f3 h\u1ed7 tr\u1ee3 t\u00edch h\u1ee3p cho c\u00e1c s\u1ed1 l\u1edbn th\u00f4ng qua class <code>BigInteger</code>.</p> <p>\u1ede \u0111\u00e2y ch\u00fang t\u00f4i hi\u1ec3n th\u1ecb m\u1ed9t c\u00e0i \u0111\u1eb7t c\u00f3 th\u1ec3 l\u01b0u tr\u1eef c\u00e1c s\u1ed1 l\u1edbn d\u01b0\u1edbi d\u1ea1ng m\u1ed9t t\u1eadp h\u1ee3p c\u00e1c ph\u01b0\u01a1ng tr\u00ecnh \u0111\u1ed3ng d\u01b0. N\u00f3 h\u1ed7 tr\u1ee3 c\u1ed9ng, tr\u1eeb v\u00e0 nh\u00e2n. V\u00e0 v\u1edbi thu\u1eadt to\u00e1n Garner ch\u00fang ta c\u00f3 th\u1ec3 chuy\u1ec3n \u0111\u1ed5i t\u1eadp h\u1ee3p c\u00e1c ph\u01b0\u01a1ng tr\u00ecnh th\u00e0nh s\u1ed1 nguy\u00ean duy nh\u1ea5t. Trong m\u00e3 n\u00e0y, ch\u00fang t\u00f4i l\u1ea5y 100 s\u1ed1 nguy\u00ean t\u1ed1 l\u1edbn h\u01a1n $10^9$, cho ph\u00e9p bi\u1ec3u di\u1ec5n c\u00e1c s\u1ed1 l\u1edbn t\u1edbi $10^{900}$.</p> <pre><code>final int SZ = 100;\nint pr[] = new int[SZ];\nint r[][] = new int[SZ][SZ];\n\nvoid init() {\n    for (int x = 1000 * 1000 * 1000, i = 0; i &lt; SZ; ++x)\n        if (BigInteger.valueOf(x).isProbablePrime(100))\n            pr[i++] = x;\n\n    for (int i = 0; i &lt; SZ; ++i)\n        for (int j = i + 1; j &lt; SZ; ++j)\n            r[i][j] =\n                BigInteger.valueOf(pr[i]).modInverse(BigInteger.valueOf(pr[j])).intValue();\n}\n\nclass Number {\n    int a[] = new int[SZ];\n\n    public Number() {\n    }\n\n    public Number(int n) {\n        for (int i = 0; i &lt; SZ; ++i)\n            a[i] = n % pr[i];\n    }\n\n    public Number(BigInteger n) {\n        for (int i = 0; i &lt; SZ; ++i)\n            a[i] = n.mod(BigInteger.valueOf(pr[i])).intValue();\n    }\n\n    public Number add(Number n) {\n        Number result = new Number();\n        for (int i = 0; i &lt; SZ; ++i)\n            result.a[i] = (a[i] + n.a[i]) % pr[i];\n        return result;\n    }\n\n    public Number subtract(Number n) {\n        Number result = new Number();\n        for (int i = 0; i &lt; SZ; ++i)\n            result.a[i] = (a[i] - n.a[i] + pr[i]) % pr[i];\n        return result;\n    }\n\n    public Number multiply(Number n) {\n        Number result = new Number();\n        for (int i = 0; i &lt; SZ; ++i)\n            result.a[i] = (int)((a[i] * 1l * n.a[i]) % pr[i]);\n        return result;\n    }\n\n    public BigInteger bigIntegerValue(boolean can_be_negative) {\n        BigInteger result = BigInteger.ZERO, mult = BigInteger.ONE;\n        int x[] = new int[SZ];\n        for (int i = 0; i &lt; SZ; ++i) {\n            x[i] = a[i];\n            for (int j = 0; j &lt; i; ++j) {\n                long cur = (x[i] - x[j]) * 1l * r[j][i];\n                x[i] = (int)((cur % pr[i] + pr[i]) % pr[i]);\n            }\n            result = result.add(mult.multiply(BigInteger.valueOf(x[i])));\n            mult = mult.multiply(BigInteger.valueOf(pr[i]));\n        }\n\n        if (can_be_negative)\n            if (result.compareTo(mult.shiftRight(1)) &gt;= 0)\n                result = result.subtract(mult);\n\n        return result;\n    }\n}\n</code></pre>"},{"location":"algebra/garners-algorithm.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 161</li> <li>Translated lines: 161</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>"},{"location":"algebra/gray-code.html","title":"M\u00e3 Gray (Gray code)","text":"<p>M\u00e3 Gray l\u00e0 m\u1ed9t h\u1ec7 th\u1ed1ng s\u1ed1 nh\u1ecb ph\u00e2n trong \u0111\u00f3 hai gi\u00e1 tr\u1ecb li\u00ean ti\u1ebfp ch\u1ec9 kh\u00e1c nhau \u1edf m\u1ed9t bit.</p> <p>V\u00ed d\u1ee5, d\u00e3y m\u00e3 Gray cho c\u00e1c s\u1ed1 3-bit l\u00e0: 000, 001, 011, 010, 110, 111, 101, 100, v\u00ec v\u1eady $G(4) = 6$.</p> <p>M\u00e3 n\u00e0y \u0111\u01b0\u1ee3c ph\u00e1t minh b\u1edfi Frank Gray v\u00e0o n\u0103m 1953.</p>","tags":["Translated"]},{"location":"algebra/gray-code.html#finding-gray-code","title":"T\u00ecm m\u00e3 Gray (Finding Gray code)","text":"<p>H\u00e3y xem x\u00e9t c\u00e1c bit c\u1ee7a s\u1ed1 $n$ v\u00e0 c\u00e1c bit c\u1ee7a s\u1ed1 $G(n)$. L\u01b0u \u00fd r\u1eb1ng bit th\u1ee9 $i$ c\u1ee7a $G(n)$ b\u1eb1ng 1 ch\u1ec9 khi bit th\u1ee9 $i$ c\u1ee7a $n$ b\u1eb1ng 1 v\u00e0 bit th\u1ee9 $i + 1$ b\u1eb1ng 0 ho\u1eb7c ng\u01b0\u1ee3c l\u1ea1i (bit th\u1ee9 $i$ b\u1eb1ng 0 v\u00e0 bit th\u1ee9 $i + 1$ b\u1eb1ng 1). Do \u0111\u00f3, $G(n) = n \\oplus (n &gt;&gt; 1)$:  </p> <pre><code>int g (int n) {\n    return n ^ (n &gt;&gt; 1);\n}\n</code></pre>","tags":["Translated"]},{"location":"algebra/gray-code.html#finding-inverse-gray-code","title":"T\u00ecm m\u00e3 Gray ng\u01b0\u1ee3c (Finding inverse Gray code)","text":"<p>Cho m\u00e3 Gray $g$, kh\u00f4i ph\u1ee5c s\u1ed1 ban \u0111\u1ea7u $n$.</p> <p>Ch\u00fang ta s\u1ebd di chuy\u1ec3n t\u1eeb c\u00e1c bit quan tr\u1ecdng nh\u1ea5t (most significant bits) \u0111\u1ebfn c\u00e1c bit \u00edt quan tr\u1ecdng nh\u1ea5t (least significant bits) (bit \u00edt quan tr\u1ecdng nh\u1ea5t c\u00f3 ch\u1ec9 s\u1ed1 1 v\u00e0 bit quan tr\u1ecdng nh\u1ea5t c\u00f3 ch\u1ec9 s\u1ed1 $k$). Quan h\u1ec7 gi\u1eefa c\u00e1c bit $n_i$ c\u1ee7a s\u1ed1 $n$ v\u00e0 c\u00e1c bit $g_i$ c\u1ee7a s\u1ed1 $g$:</p> $$\\begin{align}   n_k &amp;= g_k, \\\\   n_{k-1} &amp;= g_{k-1} \\oplus n_k = g_k \\oplus g_{k-1}, \\\\   n_{k-2} &amp;= g_{k-2} \\oplus n_{k-1} = g_k \\oplus g_{k-1} \\oplus g_{k-2}, \\\\   n_{k-3} &amp;= g_{k-3} \\oplus n_{k-2} = g_k \\oplus g_{k-1} \\oplus g_{k-2} \\oplus g_{k-3},   \\vdots \\end{align}$$ <p>C\u00e1ch d\u1ec5 nh\u1ea5t \u0111\u1ec3 vi\u1ebft n\u00f3 trong m\u00e3 l\u00e0:</p> <pre><code>int rev_g (int g) {\n  int n = 0;\n  for (; g; g &gt;&gt;= 1)\n    n ^= g;\n  return n;\n}\n</code></pre>","tags":["Translated"]},{"location":"algebra/gray-code.html#practical-applications","title":"C\u00e1c \u1ee9ng d\u1ee5ng th\u1ef1c t\u1ebf (Practical applications)","text":"<p>M\u00e3 Gray c\u00f3 m\u1ed9t s\u1ed1 \u1ee9ng d\u1ee5ng h\u1eefu \u00edch, \u0111\u00f4i khi kh\u00e1 b\u1ea5t ng\u1edd:</p> <ul> <li> <p>M\u00e3 Gray c\u1ee7a $n$ bit t\u1ea1o th\u00e0nh m\u1ed9t chu tr\u00ecnh Hamilton tr\u00ean m\u1ed9t si\u00eau l\u1eadp ph\u01b0\u01a1ng (hypercube), trong \u0111\u00f3 m\u1ed7i bit t\u01b0\u01a1ng \u1ee9ng v\u1edbi m\u1ed9t chi\u1ec1u. </p> </li> <li> <p>M\u00e3 Gray \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 gi\u1ea3m thi\u1ec3u l\u1ed7i trong chuy\u1ec3n \u0111\u1ed5i t\u00edn hi\u1ec7u s\u1ed1 sang t\u01b0\u01a1ng t\u1ef1 (v\u00ed d\u1ee5, trong c\u00e1c c\u1ea3m bi\u1ebfn). </p> </li> <li> <p>M\u00e3 Gray c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 gi\u1ea3i b\u00e0i to\u00e1n Th\u00e1p H\u00e0 N\u1ed9i.     G\u1ecdi $n$ l\u00e0 s\u1ed1 l\u01b0\u1ee3ng \u0111\u0129a. B\u1eaft \u0111\u1ea7u v\u1edbi m\u00e3 Gray c\u00f3 \u0111\u1ed9 d\u00e0i $n$ bao g\u1ed3m t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 kh\u00f4ng ($G(0)$) v\u00e0 di chuy\u1ec3n gi\u1eefa c\u00e1c m\u00e3 Gray li\u00ean ti\u1ebfp (t\u1eeb $G(i)$ \u0111\u1ebfn $G(i+1)$).     G\u1ecdi bit th\u1ee9 $i$ c\u1ee7a m\u00e3 Gray hi\u1ec7n t\u1ea1i \u0111\u1ea1i di\u1ec7n cho \u0111\u0129a th\u1ee9 $n$      (bit \u00edt quan tr\u1ecdng nh\u1ea5t t\u01b0\u01a1ng \u1ee9ng v\u1edbi \u0111\u0129a nh\u1ecf nh\u1ea5t v\u00e0 bit quan tr\u1ecdng nh\u1ea5t v\u1edbi \u0111\u0129a l\u1edbn nh\u1ea5t).      V\u00ec ch\u00ednh x\u00e1c m\u1ed9t bit thay \u0111\u1ed5i trong m\u1ed7i b\u01b0\u1edbc, ch\u00fang ta c\u00f3 th\u1ec3 coi vi\u1ec7c thay \u0111\u1ed5i bit th\u1ee9 $i$ l\u00e0 di chuy\u1ec3n \u0111\u0129a th\u1ee9 $i$.     L\u01b0u \u00fd r\u1eb1ng c\u00f3 ch\u00ednh x\u00e1c m\u1ed9t t\u00f9y ch\u1ecdn di chuy\u1ec3n cho m\u1ed7i \u0111\u0129a (ngo\u1ea1i tr\u1eeb \u0111\u0129a nh\u1ecf nh\u1ea5t) trong m\u1ed7i b\u01b0\u1edbc (ngo\u1ea1i tr\u1eeb v\u1ecb tr\u00ed b\u1eaft \u0111\u1ea7u v\u00e0 k\u1ebft th\u00fac).     Lu\u00f4n c\u00f3 hai t\u00f9y ch\u1ecdn di chuy\u1ec3n cho \u0111\u0129a nh\u1ecf nh\u1ea5t nh\u01b0ng c\u00f3 m\u1ed9t chi\u1ebfn l\u01b0\u1ee3c s\u1ebd lu\u00f4n d\u1eabn \u0111\u1ebfn c\u00e2u tr\u1ea3 l\u1eddi:     n\u1ebfu $n$ l\u00e0 l\u1ebb th\u00ec chu\u1ed7i c\u00e1c l\u1ea7n di chuy\u1ec3n \u0111\u0129a nh\u1ecf nh\u1ea5t tr\u00f4ng gi\u1ed1ng nh\u01b0 $f \\to t \\to r \\to f \\to t \\to r \\to ...$     trong \u0111\u00f3 $f$ l\u00e0 c\u1ecdc ban \u0111\u1ea7u, $t$ l\u00e0 c\u1ecdc \u0111\u00edch v\u00e0 $r$ l\u00e0 c\u1ecdc c\u00f2n l\u1ea1i), v\u00e0      n\u1ebfu $n$ l\u00e0 ch\u1eb5n: $f \\to r \\to t \\to f \\to r \\to t \\to ...$.</p> </li> <li> <p>M\u00e3 Gray c\u0169ng \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng trong l\u00fd thuy\u1ebft thu\u1eadt to\u00e1n di truy\u1ec1n.</p> </li> </ul>","tags":["Translated"]},{"location":"algebra/gray-code.html#practice-problems","title":"B\u00e0i t\u1eadp luy\u1ec7n t\u1eadp","text":"<ul> <li>Gray Code \u00a0\u00a0\u00a0\u00a0 [Difficulty: easy]</li> <li>SGU #249 \"Matrix\" \u00a0\u00a0\u00a0\u00a0 [Difficulty: medium]</li> </ul>","tags":["Translated"]},{"location":"algebra/gray-code.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 75</li> <li>Translated lines: 75</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Translated"]},{"location":"algebra/linear-diophantine-equation.html","title":"Ph\u01b0\u01a1ng tr\u00ecnh Diophantine tuy\u1ebfn t\u00ednh (Linear Diophantine Equation)","text":"<p>M\u1ed9t ph\u01b0\u01a1ng tr\u00ecnh Diophantine tuy\u1ebfn t\u00ednh (hai \u1ea9n) l\u00e0 m\u1ed9t ph\u01b0\u01a1ng tr\u00ecnh c\u00f3 d\u1ea1ng t\u1ed5ng qu\u00e1t:</p> $$ax + by = c$$ <p>trong \u0111\u00f3 $a$, $b$, $c$ l\u00e0 c\u00e1c s\u1ed1 nguy\u00ean \u0111\u00e3 cho, v\u00e0 $x$, $y$ l\u00e0 c\u00e1c s\u1ed1 nguy\u00ean ch\u01b0a bi\u1ebft.</p> <p>Trong b\u00e0i vi\u1ebft n\u00e0y, ch\u00fang t\u00f4i xem x\u00e9t m\u1ed9t s\u1ed1 b\u00e0i to\u00e1n c\u1ed5 \u0111i\u1ec3n v\u1ec1 c\u00e1c ph\u01b0\u01a1ng tr\u00ecnh n\u00e0y:</p> <ul> <li>t\u00ecm m\u1ed9t nghi\u1ec7m</li> <li>t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c nghi\u1ec7m</li> <li>t\u00ecm s\u1ed1 l\u01b0\u1ee3ng nghi\u1ec7m v\u00e0 ch\u00ednh c\u00e1c nghi\u1ec7m \u0111\u00f3 trong m\u1ed9t kho\u1ea3ng cho tr\u01b0\u1edbc</li> <li>t\u00ecm m\u1ed9t nghi\u1ec7m c\u00f3 gi\u00e1 tr\u1ecb $x + y$ nh\u1ecf nh\u1ea5t</li> </ul>","tags":["Translated"]},{"location":"algebra/linear-diophantine-equation.html#the-degenerate-case","title":"Tr\u01b0\u1eddng h\u1ee3p suy bi\u1ebfn (The degenerate case)","text":"<p>M\u1ed9t tr\u01b0\u1eddng h\u1ee3p suy bi\u1ebfn c\u1ea7n \u0111\u01b0\u1ee3c quan t\u00e2m l\u00e0 khi $a = b = 0$. D\u1ec5 th\u1ea5y r\u1eb1ng ch\u00fang ta ho\u1eb7c kh\u00f4ng c\u00f3 nghi\u1ec7m ho\u1eb7c c\u00f3 v\u00f4 s\u1ed1 nghi\u1ec7m, t\u00f9y thu\u1ed9c v\u00e0o vi\u1ec7c $c = 0$ hay kh\u00f4ng. Trong ph\u1ea7n c\u00f2n l\u1ea1i c\u1ee7a b\u00e0i vi\u1ebft n\u00e0y, ch\u00fang t\u00f4i s\u1ebd b\u1ecf qua tr\u01b0\u1eddng h\u1ee3p n\u00e0y.</p>","tags":["Translated"]},{"location":"algebra/linear-diophantine-equation.html#analytic-solution","title":"Gi\u1ea3i ph\u00e1p gi\u1ea3i t\u00edch (Analytic solution)","text":"<p>Khi $a \\neq 0$ v\u00e0 $b \\neq 0$, ph\u01b0\u01a1ng tr\u00ecnh $ax+by=c$ c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c x\u1eed l\u00fd t\u01b0\u01a1ng \u0111\u01b0\u01a1ng nh\u01b0 m\u1ed9t trong nh\u1eefng \u0111i\u1ec1u sau:</p> $$\\begin{align} ax &amp;\\equiv c \\pmod b \\\\ by &amp;\\equiv c \\pmod a \\end{align}$$ <p>Kh\u00f4ng m\u1ea5t t\u00ednh t\u1ed5ng qu\u00e1t, gi\u1ea3 s\u1eed r\u1eb1ng $b \\neq 0$ v\u00e0 xem x\u00e9t ph\u01b0\u01a1ng tr\u00ecnh \u0111\u1ea7u ti\u00ean. Khi $a$ v\u00e0 $b$ nguy\u00ean t\u1ed1 c\u00f9ng nhau, nghi\u1ec7m c\u1ee7a n\u00f3 \u0111\u01b0\u1ee3c \u0111\u01b0a ra l\u00e0</p> $$x \\equiv ca^{-1} \\pmod b,$$ <p>trong \u0111\u00f3 $a^{-1}$ l\u00e0 ngh\u1ecbch \u0111\u1ea3o modulo c\u1ee7a $a$ modulo $b$.</p> <p>Khi $a$ v\u00e0 $b$ kh\u00f4ng nguy\u00ean t\u1ed1 c\u00f9ng nhau, gi\u00e1 tr\u1ecb c\u1ee7a $ax$ modulo $b$ cho t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 nguy\u00ean $x$ chia h\u1ebft cho $g=\\gcd(a, b)$, v\u00ec v\u1eady nghi\u1ec7m ch\u1ec9 t\u1ed3n t\u1ea1i khi $c$ chia h\u1ebft cho $g$. Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, m\u1ed9t trong c\u00e1c nghi\u1ec7m c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y b\u1eb1ng c\u00e1ch r\u00fat g\u1ecdn ph\u01b0\u01a1ng tr\u00ecnh cho $g$:</p> $$(a/g) x \\equiv (c/g) \\pmod{b/g}.$$ <p>Theo \u0111\u1ecbnh ngh\u0129a c\u1ee7a $g$, c\u00e1c s\u1ed1 $a/g$ v\u00e0 $b/g$ nguy\u00ean t\u1ed1 c\u00f9ng nhau, v\u00ec v\u1eady nghi\u1ec7m \u0111\u01b0\u1ee3c \u0111\u01b0a ra m\u1ed9t c\u00e1ch r\u00f5 r\u00e0ng l\u00e0</p> $$\\begin{cases} x \\equiv (c/g)(a/g)^{-1}\\pmod{b/g},\\\\ y = \\frac{c-ax}{b}. \\end{cases}$$","tags":["Translated"]},{"location":"algebra/linear-diophantine-equation.html#algorithmic-solution","title":"Gi\u1ea3i ph\u00e1p thu\u1eadt to\u00e1n (Algorithmic solution)","text":"<p>B\u1ed5 \u0111\u1ec1 B\u00e9zout (c\u00f2n g\u1ecdi l\u00e0 \u0111\u1ed3ng nh\u1ea5t th\u1ee9c B\u00e9zout) l\u00e0 m\u1ed9t k\u1ebft qu\u1ea3 h\u1eefu \u00edch c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 hi\u1ec3u gi\u1ea3i ph\u00e1p sau \u0111\u00e2y. </p> <p>G\u1ecdi $g = \\gcd(a,b)$. Khi \u0111\u00f3 t\u1ed3n t\u1ea1i c\u00e1c s\u1ed1 nguy\u00ean $x,y$ sao cho $ax + by = g$.</p> <p>H\u01a1n n\u1eefa, $g$ l\u00e0 s\u1ed1 nguy\u00ean d\u01b0\u01a1ng nh\u1ecf nh\u1ea5t c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c vi\u1ebft d\u01b0\u1edbi d\u1ea1ng $ax + by$; t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 nguy\u00ean c\u00f3 d\u1ea1ng $ax + by$ \u0111\u1ec1u l\u00e0 b\u1ed9i c\u1ee7a $g$. </p> <p>\u0110\u1ec3 t\u00ecm m\u1ed9t nghi\u1ec7m c\u1ee7a ph\u01b0\u01a1ng tr\u00ecnh Diophantine v\u1edbi 2 \u1ea9n, b\u1ea1n c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng Thu\u1eadt to\u00e1n Euclid m\u1edf r\u1ed9ng. \u0110\u1ea7u ti\u00ean, gi\u1ea3 s\u1eed r\u1eb1ng $a$ v\u00e0 $b$ kh\u00f4ng \u00e2m. Khi ch\u00fang ta \u00e1p d\u1ee5ng thu\u1eadt to\u00e1n Euclid m\u1edf r\u1ed9ng cho $a$ v\u00e0 $b$, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm th\u1ea5y \u01b0\u1edbc chung l\u1edbn nh\u1ea5t $g$ c\u1ee7a ch\u00fang v\u00e0 2 s\u1ed1 $x_g$ v\u00e0 $y_g$ sao cho:</p> $$a x_g + b y_g = g$$ <p>N\u1ebfu $c$ chia h\u1ebft cho $g = \\gcd(a, b)$, th\u00ec ph\u01b0\u01a1ng tr\u00ecnh Diophantine \u0111\u00e3 cho c\u00f3 nghi\u1ec7m, n\u1ebfu kh\u00f4ng th\u00ec n\u00f3 kh\u00f4ng c\u00f3 b\u1ea5t k\u1ef3 nghi\u1ec7m n\u00e0o. Ch\u1ee9ng minh r\u1ea5t \u0111\u01a1n gi\u1ea3n: m\u1ed9t t\u1ed5 h\u1ee3p tuy\u1ebfn t\u00ednh c\u1ee7a hai s\u1ed1 lu\u00f4n chia h\u1ebft cho \u01b0\u1edbc chung c\u1ee7a ch\u00fang.</p> <p>B\u00e2y gi\u1edd gi\u1ea3 s\u1eed r\u1eb1ng $c$ chia h\u1ebft cho $g$, th\u00ec ch\u00fang ta c\u00f3:</p> $$a \\cdot x_g \\cdot \\frac{c}{g} + b \\cdot y_g \\cdot \\frac{c}{g} = c$$ <p>Do \u0111\u00f3 m\u1ed9t trong nh\u1eefng nghi\u1ec7m c\u1ee7a ph\u01b0\u01a1ng tr\u00ecnh Diophantine l\u00e0:</p> $$x_0 = x_g \\cdot \\frac{c}{g},$$ $$y_0 = y_g \\cdot \\frac{c}{g}.$$ <p>\u00dd t\u01b0\u1edfng tr\u00ean v\u1eabn ho\u1ea1t \u0111\u1ed9ng khi $a$ ho\u1eb7c $b$ ho\u1eb7c c\u1ea3 hai \u0111\u1ec1u \u00e2m. Ch\u00fang ta ch\u1ec9 c\u1ea7n thay \u0111\u1ed5i d\u1ea5u c\u1ee7a $x_0$ v\u00e0 $y_0$ khi c\u1ea7n thi\u1ebft.</p> <p>Cu\u1ed1i c\u00f9ng, ch\u00fang ta c\u00f3 th\u1ec3 c\u00e0i \u0111\u1eb7t \u00fd t\u01b0\u1edfng n\u00e0y nh\u01b0 sau (l\u01b0u \u00fd r\u1eb1ng m\u00e3 n\u00e0y kh\u00f4ng xem x\u00e9t tr\u01b0\u1eddng h\u1ee3p $a = b = 0$):</p> <pre><code>int gcd(int a, int b, int&amp; x, int&amp; y) {\n    if (b == 0) {\n        x = 1;\n        y = 0;\n        return a;\n    }\n    int x1, y1;\n    int d = gcd(b, a % b, x1, y1);\n    x = y1;\n    y = x1 - y1 * (a / b);\n    return d;\n}\n\nbool find_any_solution(int a, int b, int c, int &amp;x0, int &amp;y0, int &amp;g) {\n    g = gcd(abs(a), abs(b), x0, y0);\n    if (c % g) {\n        return false;\n    }\n\n    x0 *= c / g;\n    y0 *= c / g;\n    if (a &lt; 0) x0 = -x0;\n    if (b &lt; 0) y0 = -y0;\n    return true;\n}\n</code></pre>","tags":["Translated"]},{"location":"algebra/linear-diophantine-equation.html#getting-all-solutions","title":"T\u00ecm t\u1ea5t c\u1ea3 c\u00e1c nghi\u1ec7m (Getting all solutions)","text":"<p>T\u1eeb m\u1ed9t nghi\u1ec7m $(x_0, y_0)$, ch\u00fang ta c\u00f3 th\u1ec3 thu \u0111\u01b0\u1ee3c t\u1ea5t c\u1ea3 c\u00e1c nghi\u1ec7m c\u1ee7a ph\u01b0\u01a1ng tr\u00ecnh \u0111\u00e3 cho.</p> <p>G\u1ecdi $g = \\gcd(a, b)$ v\u00e0 g\u1ecdi $x_0, y_0$ l\u00e0 c\u00e1c s\u1ed1 nguy\u00ean th\u1ecfa m\u00e3n \u0111i\u1ec1u sau:</p> $$a \\cdot x_0 + b \\cdot y_0 = c$$ <p>B\u00e2y gi\u1edd, ch\u00fang ta th\u1ea5y r\u1eb1ng vi\u1ec7c th\u00eam $b / g$ v\u00e0o $x_0$, v\u00e0 \u0111\u1ed3ng th\u1eddi tr\u1eeb $a / g$ kh\u1ecfi $y_0$ s\u1ebd kh\u00f4ng ph\u00e1 v\u1ee1 \u0111\u1eb3ng th\u1ee9c:</p> $$a \\cdot \\left(x_0 + \\frac{b}{g}\\right) + b \\cdot \\left(y_0 - \\frac{a}{g}\\right) = a \\cdot x_0 + b \\cdot y_0 + a \\cdot \\frac{b}{g} - b \\cdot \\frac{a}{g} = c$$ <p>R\u00f5 r\u00e0ng, qu\u00e1 tr\u00ecnh n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c l\u1eb7p l\u1ea1i, v\u00ec v\u1eady t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 c\u00f3 d\u1ea1ng:</p> $$x = x_0 + k \\cdot \\frac{b}{g}$$ $$y = y_0 - k \\cdot \\frac{a}{g}$$ <p>l\u00e0 c\u00e1c nghi\u1ec7m c\u1ee7a ph\u01b0\u01a1ng tr\u00ecnh Diophantine \u0111\u00e3 cho.</p> <p>V\u00ec ph\u01b0\u01a1ng tr\u00ecnh l\u00e0 tuy\u1ebfn t\u00ednh, t\u1ea5t c\u1ea3 c\u00e1c nghi\u1ec7m n\u1eb1m tr\u00ean c\u00f9ng m\u1ed9t \u0111\u01b0\u1eddng th\u1eb3ng, v\u00e0 theo \u0111\u1ecbnh ngh\u0129a c\u1ee7a $g$ \u0111\u00e2y l\u00e0 t\u1eadp h\u1ee3p t\u1ea5t c\u1ea3 c\u00e1c nghi\u1ec7m c\u00f3 th\u1ec3 c\u00f3 c\u1ee7a ph\u01b0\u01a1ng tr\u00ecnh Diophantine \u0111\u00e3 cho.</p>","tags":["Translated"]},{"location":"algebra/linear-diophantine-equation.html#finding-the-number-of-solutions-and-the-solutions-in-a-given-interval","title":"T\u00ecm s\u1ed1 l\u01b0\u1ee3ng nghi\u1ec7m v\u00e0 c\u00e1c nghi\u1ec7m trong m\u1ed9t kho\u1ea3ng cho tr\u01b0\u1edbc (Finding the number of solutions and the solutions in a given interval)","text":"<p>T\u1eeb ph\u1ea7n tr\u01b0\u1edbc, r\u00f5 r\u00e0ng l\u00e0 n\u1ebfu ch\u00fang ta kh\u00f4ng \u00e1p \u0111\u1eb7t b\u1ea5t k\u1ef3 h\u1ea1n ch\u1ebf n\u00e0o \u0111\u1ed1i v\u1edbi c\u00e1c nghi\u1ec7m, s\u1ebd c\u00f3 v\u00f4 s\u1ed1 nghi\u1ec7m. V\u00ec v\u1eady, trong ph\u1ea7n n\u00e0y, ch\u00fang t\u00f4i th\u00eam m\u1ed9t s\u1ed1 h\u1ea1n ch\u1ebf v\u00e0o kho\u1ea3ng c\u1ee7a $x$ v\u00e0 $y$, v\u00e0 ch\u00fang t\u00f4i s\u1ebd c\u1ed1 g\u1eafng \u0111\u1ebfm v\u00e0 li\u1ec7t k\u00ea t\u1ea5t c\u1ea3 c\u00e1c nghi\u1ec7m.</p> <p>Gi\u1ea3 s\u1eed c\u00f3 hai kho\u1ea3ng: $[min_x; max_x]$ v\u00e0 $[min_y; max_y]$ v\u00e0 gi\u1ea3 s\u1eed ch\u00fang ta ch\u1ec9 mu\u1ed1n t\u00ecm c\u00e1c nghi\u1ec7m trong hai kho\u1ea3ng n\u00e0y.</p> <p>L\u01b0u \u00fd r\u1eb1ng n\u1ebfu $a$ ho\u1eb7c $b$ l\u00e0 $0$, th\u00ec b\u00e0i to\u00e1n ch\u1ec9 c\u00f3 m\u1ed9t nghi\u1ec7m. Ch\u00fang ta kh\u00f4ng xem x\u00e9t tr\u01b0\u1eddng h\u1ee3p n\u00e0y \u1edf \u0111\u00e2y.</p> <p>\u0110\u1ea7u ti\u00ean, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm m\u1ed9t nghi\u1ec7m c\u00f3 gi\u00e1 tr\u1ecb $x$ nh\u1ecf nh\u1ea5t, sao cho $x \\ge min_x$. \u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y, tr\u01b0\u1edbc ti\u00ean ch\u00fang t\u00f4i t\u00ecm b\u1ea5t k\u1ef3 nghi\u1ec7m n\u00e0o c\u1ee7a ph\u01b0\u01a1ng tr\u00ecnh Diophantine. Sau \u0111\u00f3, ch\u00fang t\u00f4i d\u1ecbch chuy\u1ec3n nghi\u1ec7m n\u00e0y \u0111\u1ec3 c\u00f3 $x \\ge min_x$ (s\u1eed d\u1ee5ng nh\u1eefng g\u00ec ch\u00fang ta bi\u1ebft v\u1ec1 t\u1eadp h\u1ee3p t\u1ea5t c\u1ea3 c\u00e1c nghi\u1ec7m trong ph\u1ea7n tr\u01b0\u1edbc). \u0110i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong $O(1)$. K\u00fd hi\u1ec7u gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t n\u00e0y c\u1ee7a $x$ l\u00e0 $l_{x1}$.</p> <p>T\u01b0\u01a1ng t\u1ef1, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t c\u1ee7a $x$ th\u1ecfa m\u00e3n $x \\le max_x$. K\u00fd hi\u1ec7u gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t n\u00e0y c\u1ee7a $x$ l\u00e0 $r_{x1}$.</p> <p>T\u01b0\u01a1ng t\u1ef1, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t c\u1ee7a $y$ $(y \\ge min_y)$ v\u00e0 gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t c\u1ee7a $y$ $(y \\le max_y)$. K\u00fd hi\u1ec7u c\u00e1c gi\u00e1 tr\u1ecb t\u01b0\u01a1ng \u1ee9ng c\u1ee7a $x$ b\u1edfi $l_{x2}$ v\u00e0 $r_{x2}$.</p> <p>Nghi\u1ec7m cu\u1ed1i c\u00f9ng l\u00e0 t\u1ea5t c\u1ea3 c\u00e1c nghi\u1ec7m v\u1edbi x n\u1eb1m trong giao c\u1ee7a $[l_{x1}, r_{x1}]$ v\u00e0 $[l_{x2}, r_{x2}]$. H\u00e3y k\u00fd hi\u1ec7u giao n\u00e0y l\u00e0 $[l_x, r_x]$.</p> <p>Sau \u0111\u00e2y l\u00e0 m\u00e3 c\u00e0i \u0111\u1eb7t \u00fd t\u01b0\u1edfng n\u00e0y. L\u01b0u \u00fd r\u1eb1ng ch\u00fang ta chia $a$ v\u00e0 $b$ \u1edf \u0111\u1ea7u cho $g$. V\u00ec ph\u01b0\u01a1ng tr\u00ecnh $a x + b y = c$ t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi ph\u01b0\u01a1ng tr\u00ecnh $\\frac{a}{g} x + \\frac{b}{g} y = \\frac{c}{g}$, ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng ph\u01b0\u01a1ng tr\u00ecnh n\u00e0y thay th\u1ebf v\u00e0 c\u00f3 $\\gcd(\\frac{a}{g}, \\frac{b}{g}) = 1$, gi\u00fap \u0111\u01a1n gi\u1ea3n h\u00f3a c\u00e1c c\u00f4ng th\u1ee9c.</p> <pre><code>void shift_solution(int &amp; x, int &amp; y, int a, int b, int cnt) {\n    x += cnt * b;\n    y -= cnt * a;\n}\n\nint find_all_solutions(int a, int b, int c, int minx, int maxx, int miny, int maxy) {\n    int x, y, g;\n    if (!find_any_solution(a, b, c, x, y, g))\n        return 0;\n    a /= g;\n    b /= g;\n\n    int sign_a = a &gt; 0 ? +1 : -1;\n    int sign_b = b &gt; 0 ? +1 : -1;\n\n    shift_solution(x, y, a, b, (minx - x) / b);\n    if (x &lt; minx)\n        shift_solution(x, y, a, b, sign_b);\n    if (x &gt; maxx)\n        return 0;\n    int lx1 = x;\n\n    shift_solution(x, y, a, b, (maxx - x) / b);\n    if (x &gt; maxx)\n        shift_solution(x, y, a, b, -sign_b);\n    int rx1 = x;\n\n    shift_solution(x, y, a, b, -(miny - y) / a);\n    if (y &lt; miny)\n        shift_solution(x, y, a, b, -sign_a);\n    if (y &gt; maxy)\n        return 0;\n    int lx2 = x;\n\n    shift_solution(x, y, a, b, -(maxy - y) / a);\n    if (y &gt; maxy)\n        shift_solution(x, y, a, b, sign_a);\n    int rx2 = x;\n\n    if (lx2 &gt; rx2)\n        swap(lx2, rx2);\n    int lx = max(lx1, lx2);\n    int rx = min(rx1, rx2);\n\n    if (lx &gt; rx)\n        return 0;\n    return (rx - lx) / abs(b) + 1;\n}\n</code></pre> <p>Khi ch\u00fang ta c\u00f3 $l_x$ v\u00e0 $r_x$, c\u0169ng \u0111\u01a1n gi\u1ea3n \u0111\u1ec3 li\u1ec7t k\u00ea qua t\u1ea5t c\u1ea3 c\u00e1c nghi\u1ec7m. Ch\u1ec9 c\u1ea7n l\u1eb7p qua $x = l_x + k \\cdot \\frac{b}{g}$ cho t\u1ea5t c\u1ea3 $k \\ge 0$ cho \u0111\u1ebfn khi $x = r_x$, v\u00e0 t\u00ecm c\u00e1c gi\u00e1 tr\u1ecb $y$ t\u01b0\u01a1ng \u1ee9ng b\u1eb1ng ph\u01b0\u01a1ng tr\u00ecnh $a x + b y = c$.</p>","tags":["Translated"]},{"location":"algebra/linear-diophantine-equation.html#find-the-solution-with-minimum-value-of-x-y","title":"T\u00ecm nghi\u1ec7m c\u00f3 gi\u00e1 tr\u1ecb $x + y$ nh\u1ecf nh\u1ea5t (Find the solution with minimum value of $x + y$)","text":"<p>\u1ede \u0111\u00e2y, $x$ v\u00e0 $y$ c\u0169ng c\u1ea7n \u0111\u01b0\u1ee3c \u0111\u01b0a ra m\u1ed9t s\u1ed1 h\u1ea1n ch\u1ebf, n\u1ebfu kh\u00f4ng, c\u00e2u tr\u1ea3 l\u1eddi c\u00f3 th\u1ec3 tr\u1edf th\u00e0nh \u00e2m v\u00f4 c\u00f9ng.</p> <p>\u00dd t\u01b0\u1edfng t\u01b0\u01a1ng t\u1ef1 nh\u01b0 ph\u1ea7n tr\u01b0\u1edbc: Ch\u00fang ta t\u00ecm b\u1ea5t k\u1ef3 nghi\u1ec7m n\u00e0o c\u1ee7a ph\u01b0\u01a1ng tr\u00ecnh Diophantine, sau \u0111\u00f3 d\u1ecbch chuy\u1ec3n nghi\u1ec7m \u0111\u1ec3 th\u1ecfa m\u00e3n m\u1ed9t s\u1ed1 \u0111i\u1ec1u ki\u1ec7n.</p> <p>Cu\u1ed1i c\u00f9ng, s\u1eed d\u1ee5ng ki\u1ebfn th\u1ee9c v\u1ec1 t\u1eadp h\u1ee3p t\u1ea5t c\u1ea3 c\u00e1c nghi\u1ec7m \u0111\u1ec3 t\u00ecm c\u1ef1c ti\u1ec3u:</p> $$x' = x + k \\cdot \\frac{b}{g},$$ $$y' = y - k \\cdot \\frac{a}{g}.$$ <p>L\u01b0u \u00fd r\u1eb1ng $x + y$ thay \u0111\u1ed5i nh\u01b0 sau:</p> $$x' + y' = x + y + k \\cdot \\left(\\frac{b}{g} - \\frac{a}{g}\\right) = x + y + k \\cdot \\frac{b-a}{g}$$ <p>N\u1ebfu $a &lt; b$, ch\u00fang ta c\u1ea7n ch\u1ecdn gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t c\u00f3 th\u1ec3 c\u1ee7a $k$. N\u1ebfu $a &gt; b$, ch\u00fang ta c\u1ea7n ch\u1ecdn gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t c\u00f3 th\u1ec3 c\u1ee7a $k$. N\u1ebfu $a = b$, t\u1ea5t c\u1ea3 c\u00e1c nghi\u1ec7m s\u1ebd c\u00f3 c\u00f9ng t\u1ed5ng $x + y$.</p>","tags":["Translated"]},{"location":"algebra/linear-diophantine-equation.html#practice-problems","title":"B\u00e0i t\u1eadp luy\u1ec7n t\u1eadp","text":"<ul> <li>Spoj - Crucial Equation</li> <li>SGU 106</li> <li>Codeforces - Ebony and Ivory</li> <li>Codechef - Get AC in one go</li> <li>LightOj - Solutions to an equation</li> <li>Atcoder - F - S = 1</li> </ul>","tags":["Translated"]},{"location":"algebra/linear-diophantine-equation.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 230</li> <li>Translated lines: 230</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Translated"]},{"location":"algebra/linear_congruence_equation.html","title":"Ph\u01b0\u01a1ng tr\u00ecnh \u0111\u1ed3ng d\u01b0 tuy\u1ebfn t\u00ednh (Linear Congruence Equation)","text":"<p>Ph\u01b0\u01a1ng tr\u00ecnh n\u00e0y c\u00f3 d\u1ea1ng:</p> $$a \\cdot x \\equiv b \\pmod n,$$ <p>trong \u0111\u00f3 $a$, $b$ v\u00e0 $n$ l\u00e0 c\u00e1c s\u1ed1 nguy\u00ean \u0111\u00e3 cho v\u00e0 $x$ l\u00e0 m\u1ed9t s\u1ed1 nguy\u00ean ch\u01b0a bi\u1ebft.</p> <p>Y\u00eau c\u1ea7u l\u00e0 t\u00ecm gi\u00e1 tr\u1ecb $x$ t\u1eeb kho\u1ea3ng $[0, n-1]$ (r\u00f5 r\u00e0ng, tr\u00ean to\u00e0n b\u1ed9 tr\u1ee5c s\u1ed1 c\u00f3 th\u1ec3 c\u00f3 v\u00f4 s\u1ed1 nghi\u1ec7m s\u1ebd kh\u00e1c nhau $n \\cdot k$, trong \u0111\u00f3 $k$ l\u00e0 b\u1ea5t k\u1ef3 s\u1ed1 nguy\u00ean n\u00e0o). N\u1ebfu nghi\u1ec7m kh\u00f4ng duy nh\u1ea5t, th\u00ec ch\u00fang ta s\u1ebd xem x\u00e9t c\u00e1ch l\u1ea5y t\u1ea5t c\u1ea3 c\u00e1c nghi\u1ec7m.</p>","tags":["Translated"]},{"location":"algebra/linear_congruence_equation.html#solution-by-finding-the-inverse-element","title":"Gi\u1ea3i ph\u00e1p b\u1eb1ng c\u00e1ch t\u00ecm ph\u1ea7n t\u1eed ngh\u1ecbch \u0111\u1ea3o (Solution by finding the inverse element)","text":"<p>Tr\u01b0\u1edbc ti\u00ean ch\u00fang ta h\u00e3y xem x\u00e9t m\u1ed9t tr\u01b0\u1eddng h\u1ee3p \u0111\u01a1n gi\u1ea3n h\u01a1n trong \u0111\u00f3 $a$ v\u00e0 $n$ nguy\u00ean t\u1ed1 c\u00f9ng nhau ($\\gcd(a, n) = 1$). Khi \u0111\u00f3 ta c\u00f3 th\u1ec3 t\u00ecm ngh\u1ecbch \u0111\u1ea3o c\u1ee7a $a$, v\u00e0 nh\u00e2n c\u1ea3 hai v\u1ebf c\u1ee7a ph\u01b0\u01a1ng tr\u00ecnh v\u1edbi ngh\u1ecbch \u0111\u1ea3o, v\u00e0 ch\u00fang ta c\u00f3 th\u1ec3 nh\u1eadn \u0111\u01b0\u1ee3c m\u1ed9t nghi\u1ec7m duy nh\u1ea5t.</p> $$x \\equiv b \\cdot a ^ {- 1} \\pmod n$$ <p>B\u00e2y gi\u1edd h\u00e3y xem x\u00e9t tr\u01b0\u1eddng h\u1ee3p $a$ v\u00e0 $n$ kh\u00f4ng nguy\u00ean t\u1ed1 c\u00f9ng nhau ($\\gcd(a, n) \\ne 1$). Khi \u0111\u00f3 nghi\u1ec7m s\u1ebd kh\u00f4ng ph\u1ea3i l\u00fac n\u00e0o c\u0169ng t\u1ed3n t\u1ea1i (v\u00ed d\u1ee5 $2 \\cdot x \\equiv 1 \\pmod 4$ kh\u00f4ng c\u00f3 nghi\u1ec7m).</p> <p>G\u1ecdi $g = \\gcd(a, n)$, t\u1ee9c l\u00e0 \u01b0\u1edbc chung l\u1edbn nh\u1ea5t c\u1ee7a $a$ v\u00e0 $n$ (trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y l\u1edbn h\u01a1n m\u1ed9t).</p> <p>Khi \u0111\u00f3, n\u1ebfu $b$ kh\u00f4ng chia h\u1ebft cho $g$, th\u00ec kh\u00f4ng c\u00f3 nghi\u1ec7m. Th\u1ef1c t\u1ebf, v\u1edbi b\u1ea5t k\u1ef3 $x$ n\u00e0o, v\u1ebf tr\u00e1i c\u1ee7a ph\u01b0\u01a1ng tr\u00ecnh $a \\cdot x \\pmod n$, lu\u00f4n chia h\u1ebft cho $g$, trong khi v\u1ebf ph\u1ea3i kh\u00f4ng chia h\u1ebft cho n\u00f3, do \u0111\u00f3 suy ra r\u1eb1ng kh\u00f4ng c\u00f3 nghi\u1ec7m.</p> <p>N\u1ebfu $g$ chia h\u1ebft $b$, th\u00ec b\u1eb1ng c\u00e1ch chia c\u1ea3 hai v\u1ebf c\u1ee7a ph\u01b0\u01a1ng tr\u00ecnh cho $g$ (t\u1ee9c l\u00e0 chia $a$, $b$ v\u00e0 $n$ cho $g$), ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c m\u1ed9t ph\u01b0\u01a1ng tr\u00ecnh m\u1edbi:</p> $$a^\\prime \\cdot x \\equiv b^\\prime \\pmod{n^\\prime}$$ <p>trong \u0111\u00f3 $a^\\prime$ v\u00e0 $n^\\prime$ \u0111\u00e3 nguy\u00ean t\u1ed1 c\u00f9ng nhau, v\u00e0 ch\u00fang ta \u0111\u00e3 h\u1ecdc c\u00e1ch x\u1eed l\u00fd m\u1ed9t ph\u01b0\u01a1ng tr\u00ecnh nh\u01b0 v\u1eady. Ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c $x^\\prime$ l\u00e0 nghi\u1ec7m cho $x$.</p> <p>R\u00f5 r\u00e0ng l\u00e0 $x^\\prime$ n\u00e0y c\u0169ng s\u1ebd l\u00e0 m\u1ed9t nghi\u1ec7m c\u1ee7a ph\u01b0\u01a1ng tr\u00ecnh ban \u0111\u1ea7u. Tuy nhi\u00ean n\u00f3 s\u1ebd kh\u00f4ng ph\u1ea3i l\u00e0 nghi\u1ec7m duy nh\u1ea5t. C\u00f3 th\u1ec3 ch\u1ec9 ra r\u1eb1ng ph\u01b0\u01a1ng tr\u00ecnh ban \u0111\u1ea7u c\u00f3 ch\u00ednh x\u00e1c $g$ nghi\u1ec7m, v\u00e0 ch\u00fang s\u1ebd tr\u00f4ng nh\u01b0 th\u1ebf n\u00e0y:</p> $$x_i \\equiv (x^\\prime + i\\cdot n^\\prime) \\pmod n \\quad \\text{v\u1edbi } i = 0 \\ldots g-1$$ <p>T\u00f3m l\u1ea1i, ch\u00fang ta c\u00f3 th\u1ec3 n\u00f3i r\u1eb1ng s\u1ed1 l\u01b0\u1ee3ng nghi\u1ec7m c\u1ee7a ph\u01b0\u01a1ng tr\u00ecnh \u0111\u1ed3ng d\u01b0 tuy\u1ebfn t\u00ednh b\u1eb1ng $g = \\gcd(a, n)$ ho\u1eb7c b\u1eb1ng kh\u00f4ng.</p>","tags":["Translated"]},{"location":"algebra/linear_congruence_equation.html#solution-with-the-extended-euclidean-algorithm","title":"Gi\u1ea3i ph\u00e1p v\u1edbi Thu\u1eadt to\u00e1n Euclid m\u1edf r\u1ed9ng (Solution with the Extended Euclidean Algorithm)","text":"<p>Ch\u00fang ta c\u00f3 th\u1ec3 vi\u1ebft l\u1ea1i ph\u01b0\u01a1ng tr\u00ecnh \u0111\u1ed3ng d\u01b0 tuy\u1ebfn t\u00ednh th\u00e0nh ph\u01b0\u01a1ng tr\u00ecnh Diophantine sau:</p> $$a \\cdot x + n \\cdot k = b,$$ <p>trong \u0111\u00f3 $x$ v\u00e0 $k$ l\u00e0 c\u00e1c s\u1ed1 nguy\u00ean ch\u01b0a bi\u1ebft.</p> <p>Ph\u01b0\u01a1ng ph\u00e1p gi\u1ea3i ph\u01b0\u01a1ng tr\u00ecnh n\u00e0y \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 trong b\u00e0i vi\u1ebft t\u01b0\u01a1ng \u1ee9ng Ph\u01b0\u01a1ng tr\u00ecnh Diophantine tuy\u1ebfn t\u00ednh v\u00e0 n\u00f3 bao g\u1ed3m vi\u1ec7c \u00e1p d\u1ee5ng Thu\u1eadt to\u00e1n Euclid m\u1edf r\u1ed9ng.</p> <p>N\u00f3 c\u0169ng m\u00f4 t\u1ea3 ph\u01b0\u01a1ng ph\u00e1p thu \u0111\u01b0\u1ee3c t\u1ea5t c\u1ea3 c\u00e1c nghi\u1ec7m c\u1ee7a ph\u01b0\u01a1ng tr\u00ecnh n\u00e0y t\u1eeb m\u1ed9t nghi\u1ec7m t\u00ecm th\u1ea5y, v\u00e0 t\u00ecnh c\u1edd ph\u01b0\u01a1ng ph\u00e1p n\u00e0y, khi \u0111\u01b0\u1ee3c xem x\u00e9t c\u1ea9n th\u1eadn, ho\u00e0n to\u00e0n t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi ph\u01b0\u01a1ng ph\u00e1p \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 trong ph\u1ea7n tr\u01b0\u1edbc.</p>","tags":["Translated"]},{"location":"algebra/linear_congruence_equation.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 57</li> <li>Translated lines: 57</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Translated"]},{"location":"algebra/module-inverse.html","title":"Ngh\u1ecbch \u0111\u1ea3o nh\u00e2n Modulo (Modular Multiplicative Inverse)","text":"","tags":["Translated"]},{"location":"algebra/module-inverse.html#definition","title":"\u0110\u1ecbnh ngh\u0129a (Definition)","text":"<p>M\u1ed9t ngh\u1ecbch \u0111\u1ea3o nh\u00e2n modulo c\u1ee7a m\u1ed9t s\u1ed1 nguy\u00ean $a$ l\u00e0 m\u1ed9t s\u1ed1 nguy\u00ean $x$ sao cho $a \\cdot x$ \u0111\u1ed3ng d\u01b0 v\u1edbi $1$ modulo m\u1ed9t s\u1ed1 $m$ n\u00e0o \u0111\u00f3. \u0110\u1ec3 vi\u1ebft n\u00f3 m\u1ed9t c\u00e1ch h\u00ecnh th\u1ee9c: ch\u00fang ta mu\u1ed1n t\u00ecm m\u1ed9t s\u1ed1 nguy\u00ean $x$ sao cho </p> $$a \\cdot x \\equiv 1 \\mod m.$$ <p>Ch\u00fang ta c\u0169ng s\u1ebd k\u00fd hi\u1ec7u $x$ \u0111\u01a1n gi\u1ea3n l\u00e0 $a^{-1}$.</p> <p>Ch\u00fang ta n\u00ean l\u01b0u \u00fd r\u1eb1ng ngh\u1ecbch \u0111\u1ea3o modulo kh\u00f4ng ph\u1ea3i l\u00fac n\u00e0o c\u0169ng t\u1ed3n t\u1ea1i. V\u00ed d\u1ee5, cho $m = 4$, $a = 2$.  B\u1eb1ng c\u00e1ch ki\u1ec3m tra t\u1ea5t c\u1ea3 c\u00e1c gi\u00e1 tr\u1ecb c\u00f3 th\u1ec3 modulo $m$, c\u00f3 th\u1ec3 th\u1ea5y r\u00f5 r\u1eb1ng ch\u00fang ta kh\u00f4ng th\u1ec3 t\u00ecm th\u1ea5y $a^{-1}$ th\u1ecfa m\u00e3n ph\u01b0\u01a1ng tr\u00ecnh tr\u00ean.  C\u00f3 th\u1ec3 ch\u1ee9ng minh r\u1eb1ng ngh\u1ecbch \u0111\u1ea3o modulo t\u1ed3n t\u1ea1i khi v\u00e0 ch\u1ec9 khi $a$ v\u00e0 $m$ l\u00e0 nguy\u00ean t\u1ed1 c\u00f9ng nhau (t\u1ee9c l\u00e0 $\\gcd(a, m) = 1$).</p> <p>Trong b\u00e0i vi\u1ebft n\u00e0y, ch\u00fang t\u00f4i tr\u00ecnh b\u00e0y hai ph\u01b0\u01a1ng ph\u00e1p \u0111\u1ec3 t\u00ecm ngh\u1ecbch \u0111\u1ea3o modulo trong tr\u01b0\u1eddng h\u1ee3p n\u00f3 t\u1ed3n t\u1ea1i, v\u00e0 m\u1ed9t ph\u01b0\u01a1ng ph\u00e1p \u0111\u1ec3 t\u00ecm ngh\u1ecbch \u0111\u1ea3o modulo cho t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 trong th\u1eddi gian tuy\u1ebfn t\u00ednh.</p>","tags":["Translated"]},{"location":"algebra/module-inverse.html#finding-the-modular-inverse-using-extended-euclidean-algorithm","title":"T\u00ecm ngh\u1ecbch \u0111\u1ea3o Modulo b\u1eb1ng thu\u1eadt to\u00e1n Euclid m\u1edf r\u1ed9ng (Finding the Modular Inverse using Extended Euclidean algorithm)","text":"<p>X\u00e9t ph\u01b0\u01a1ng tr\u00ecnh sau (v\u1edbi \u1ea9n $x$ v\u00e0 $y$):</p> $$a \\cdot x + m \\cdot y = 1$$ <p>\u0110\u00e2y l\u00e0 m\u1ed9t Ph\u01b0\u01a1ng tr\u00ecnh Diophantine tuy\u1ebfn t\u00ednh hai \u1ea9n. Nh\u01b0 \u0111\u01b0\u1ee3c tr\u00ecnh b\u00e0y trong b\u00e0i vi\u1ebft \u0111\u01b0\u1ee3c li\u00ean k\u1ebft, khi $\\gcd(a, m) = 1$, ph\u01b0\u01a1ng tr\u00ecnh c\u00f3 m\u1ed9t nghi\u1ec7m c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng thu\u1eadt to\u00e1n Euclid m\u1edf r\u1ed9ng. L\u01b0u \u00fd r\u1eb1ng $\\gcd(a, m) = 1$ c\u0169ng l\u00e0 \u0111i\u1ec1u ki\u1ec7n \u0111\u1ec3 ngh\u1ecbch \u0111\u1ea3o modulo t\u1ed3n t\u1ea1i.</p> <p>B\u00e2y gi\u1edd, n\u1ebfu ch\u00fang ta l\u1ea5y modulo $m$ c\u1ee7a c\u1ea3 hai v\u1ebf, ch\u00fang ta c\u00f3 th\u1ec3 lo\u1ea1i b\u1ecf $m \\cdot y$, v\u00e0 ph\u01b0\u01a1ng tr\u00ecnh tr\u1edf th\u00e0nh:</p> $$a \\cdot x \\equiv 1 \\mod m$$ <p>Do \u0111\u00f3, ngh\u1ecbch \u0111\u1ea3o modulo c\u1ee7a $a$ l\u00e0 $x$.</p> <p>C\u00e0i \u0111\u1eb7t nh\u01b0 sau:</p> <pre><code>int x, y;\nint g = extended_euclidean(a, m, x, y);\nif (g != 1) {\n    cout &lt;&lt; \"No solution!\";\n}\nelse {\n    x = (x % m + m) % m;\n    cout &lt;&lt; x &lt;&lt; endl;\n}\n</code></pre> <p>L\u01b0u \u00fd c\u00e1ch ch\u00fang t\u00f4i s\u1eeda \u0111\u1ed5i <code>x</code>. K\u1ebft qu\u1ea3 <code>x</code> t\u1eeb thu\u1eadt to\u00e1n Euclid m\u1edf r\u1ed9ng c\u00f3 th\u1ec3 \u00e2m, v\u00ec v\u1eady <code>x % m</code> c\u0169ng c\u00f3 th\u1ec3 \u00e2m, v\u00e0 ch\u00fang ta ph\u1ea3i c\u1ed9ng <code>m</code> tr\u01b0\u1edbc \u0111\u1ec3 l\u00e0m cho n\u00f3 d\u01b0\u01a1ng.</p>","tags":["Translated"]},{"location":"algebra/module-inverse.html#finding-the-modular-inverse-using-binary-exponentiation","title":"T\u00ecm ngh\u1ecbch \u0111\u1ea3o Modulo b\u1eb1ng l\u0169y th\u1eeba nh\u1ecb ph\u00e2n (Finding the Modular Inverse using Binary Exponentiation)","text":"<p>M\u1ed9t ph\u01b0\u01a1ng ph\u00e1p kh\u00e1c \u0111\u1ec3 t\u00ecm ngh\u1ecbch \u0111\u1ea3o modulo l\u00e0 s\u1eed d\u1ee5ng \u0111\u1ecbnh l\u00fd Euler, trong \u0111\u00f3 n\u00eau r\u1eb1ng s\u1ef1 \u0111\u1ed3ng d\u01b0 sau l\u00e0 \u0111\u00fang n\u1ebfu $a$ v\u00e0 $m$ l\u00e0 nguy\u00ean t\u1ed1 c\u00f9ng nhau:</p> $$a^{\\phi (m)} \\equiv 1 \\mod m$$ <p>$\\phi$ l\u00e0 H\u00e0m phi Euler. M\u1ed9t l\u1ea7n n\u1eefa, l\u01b0u \u00fd r\u1eb1ng $a$ v\u00e0 $m$ l\u00e0 nguy\u00ean t\u1ed1 c\u00f9ng nhau c\u0169ng l\u00e0 \u0111i\u1ec1u ki\u1ec7n \u0111\u1ec3 ngh\u1ecbch \u0111\u1ea3o modulo t\u1ed3n t\u1ea1i.</p> <p>N\u1ebfu $m$ l\u00e0 m\u1ed9t s\u1ed1 nguy\u00ean t\u1ed1, \u0111i\u1ec1u n\u00e0y \u0111\u01a1n gi\u1ea3n h\u00f3a th\u00e0nh \u0110\u1ecbnh l\u00fd Fermat nh\u1ecf:</p> $$a^{m - 1} \\equiv 1 \\mod m$$ <p>Nh\u00e2n c\u1ea3 hai v\u1ebf c\u1ee7a c\u00e1c ph\u01b0\u01a1ng tr\u00ecnh tr\u00ean v\u1edbi $a^{-1}$, v\u00e0 ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c:</p> <ul> <li>\u0110\u1ed1i v\u1edbi m\u1ed9t modulo $m$ b\u1ea5t k\u1ef3 (nh\u01b0ng nguy\u00ean t\u1ed1 c\u00f9ng nhau): $a ^ {\\phi (m) - 1} \\equiv a ^{-1} \\mod m$</li> <li>\u0110\u1ed1i v\u1edbi m\u1ed9t modulo $m$ l\u00e0 s\u1ed1 nguy\u00ean t\u1ed1: $a ^ {m - 2} \\equiv a ^ {-1} \\mod m$</li> </ul> <p>T\u1eeb nh\u1eefng k\u1ebft qu\u1ea3 n\u00e0y, ch\u00fang ta c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng t\u00ecm th\u1ea5y ngh\u1ecbch \u0111\u1ea3o modulo b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng thu\u1eadt to\u00e1n l\u0169y th\u1eeba nh\u1ecb ph\u00e2n, ho\u1ea1t \u0111\u1ed9ng trong th\u1eddi gian $O(\\log m)$.</p> <p>M\u1eb7c d\u00f9 ph\u01b0\u01a1ng ph\u00e1p n\u00e0y d\u1ec5 hi\u1ec3u h\u01a1n ph\u01b0\u01a1ng ph\u00e1p \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 trong \u0111o\u1ea1n tr\u01b0\u1edbc, nh\u01b0ng trong tr\u01b0\u1eddng h\u1ee3p $m$ kh\u00f4ng ph\u1ea3i l\u00e0 s\u1ed1 nguy\u00ean t\u1ed1, ch\u00fang ta c\u1ea7n t\u00ednh h\u00e0m phi Euler, li\u00ean quan \u0111\u1ebfn vi\u1ec7c ph\u00e2n t\u00edch th\u1eeba s\u1ed1 c\u1ee7a $m$, \u0111i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 r\u1ea5t kh\u00f3. N\u1ebfu ph\u00e2n t\u00edch th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1 c\u1ee7a $m$ \u0111\u01b0\u1ee3c bi\u1ebft, th\u00ec \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a ph\u01b0\u01a1ng ph\u00e1p n\u00e0y l\u00e0 $O(\\log m)$.</p>","tags":["Translated"]},{"location":"algebra/module-inverse.html#finding-the-modular-inverse-for-prime-moduli-using-euclidean-division","title":"T\u00ecm ngh\u1ecbch \u0111\u1ea3o modulo cho modulo nguy\u00ean t\u1ed1 b\u1eb1ng ph\u00e9p chia Euclid (Finding the modular inverse for prime moduli using Euclidean Division)","text":"<p>Cho m\u1ed9t s\u1ed1 nguy\u00ean t\u1ed1 modulo $m &gt; a$ (ho\u1eb7c ch\u00fang ta c\u00f3 th\u1ec3 \u00e1p d\u1ee5ng modulo \u0111\u1ec3 l\u00e0m cho n\u00f3 nh\u1ecf h\u01a1n trong 1 b\u01b0\u1edbc), theo Ph\u00e9p chia Euclid</p> $$m = k \\cdot a + r$$ <p>trong \u0111\u00f3 $k = \\left\\lfloor \\frac{m}{a} \\right\\rfloor$ v\u00e0 $r = m \\bmod a$, th\u00ec</p> $$ \\begin{align*} &amp; \\implies &amp; 0          &amp; \\equiv k \\cdot a + r   &amp; \\mod m \\\\ &amp; \\iff &amp; r              &amp; \\equiv -k \\cdot a      &amp; \\mod m \\\\ &amp; \\iff &amp; r \\cdot a^{-1} &amp; \\equiv -k              &amp; \\mod m \\\\ &amp; \\iff &amp; a^{-1}         &amp; \\equiv -k \\cdot r^{-1} &amp; \\mod m \\end{align*} $$ <p>L\u01b0u \u00fd r\u1eb1ng l\u1eadp lu\u1eadn n\u00e0y kh\u00f4ng \u0111\u00fang n\u1ebfu $m$ kh\u00f4ng ph\u1ea3i l\u00e0 s\u1ed1 nguy\u00ean t\u1ed1, v\u00ec s\u1ef1 t\u1ed3n t\u1ea1i c\u1ee7a $a^{-1}$ kh\u00f4ng ng\u1ee5 \u00fd s\u1ef1 t\u1ed3n t\u1ea1i c\u1ee7a $r^{-1}$ trong tr\u01b0\u1eddng h\u1ee3p t\u1ed5ng qu\u00e1t. \u0110\u1ec3 th\u1ea5y \u0111i\u1ec1u n\u00e0y, h\u00e3y th\u1eed t\u00ednh $5^{-1}$ modulo $12$ v\u1edbi c\u00f4ng th\u1ee9c tr\u00ean. Ch\u00fang ta mu\u1ed1n \u0111i \u0111\u1ebfn $5$, v\u00ec $5 \\cdot 5 \\equiv 1 \\bmod 12$. Tuy nhi\u00ean, $12 = 2 \\cdot 5 + 2$, v\u00e0 ch\u00fang ta c\u00f3 $k=2$ v\u00e0 $r=2$, v\u1edbi $2$ kh\u00f4ng kh\u1ea3 ngh\u1ecbch modulo $12$.</p> <p>Tuy nhi\u00ean, n\u1ebfu modulo l\u00e0 s\u1ed1 nguy\u00ean t\u1ed1, t\u1ea5t c\u1ea3 $a$ v\u1edbi $0 &lt; a &lt; m$ \u0111\u1ec1u kh\u1ea3 ngh\u1ecbch modulo $m$, v\u00e0 ch\u00fang ta c\u00f3 h\u00e0m \u0111\u1ec7 quy sau (trong C++) \u0111\u1ec3 t\u00ednh ngh\u1ecbch \u0111\u1ea3o modulo cho s\u1ed1 $a$ \u0111\u1ed1i v\u1edbi $m$</p> <pre><code>int inv(int a) {\n  return a &lt;= 1 ? a : m - (long long)(m/a) * inv(m % a) % m;\n}\n</code></pre> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian ch\u00ednh x\u00e1c c\u1ee7a \u0111\u1ec7 quy n\u00e0y ch\u01b0a \u0111\u01b0\u1ee3c bi\u1ebft. N\u00f3 n\u1eb1m \u0111\u00e2u \u0111\u00f3 gi\u1eefa $O(\\frac{\\log m}{\\log\\log m})$ v\u00e0 $O(m^{\\frac{1}{3} - \\frac{2}{177} + \\epsilon})$. Xem V\u1ec1 \u0111\u1ed9 d\u00e0i c\u1ee7a khai tri\u1ec3n Pierce. Trong th\u1ef1c t\u1ebf, c\u00e0i \u0111\u1eb7t n\u00e0y nhanh, v.d. \u0111\u1ed1i v\u1edbi modulo $10^9 + 7$ n\u00f3 s\u1ebd lu\u00f4n k\u1ebft th\u00fac trong \u00edt h\u01a1n 50 l\u1ea7n l\u1eb7p.</p> <p>\u00c1p d\u1ee5ng c\u00f4ng th\u1ee9c n\u00e0y, ch\u00fang ta c\u0169ng c\u00f3 th\u1ec3 t\u00ednh tr\u01b0\u1edbc ngh\u1ecbch \u0111\u1ea3o modulo cho m\u1ecdi s\u1ed1 trong kho\u1ea3ng $[1, m-1]$ trong $O(m)$.</p> <pre><code>inv[1] = 1;\nfor(int a = 2; a &lt; m; ++a)\n    inv[a] = m - (long long)(m/a) * inv[m%a] % m;\n</code></pre>","tags":["Translated"]},{"location":"algebra/module-inverse.html#finding-the-modular-inverse-for-array-of-numbers-modulo-m","title":"T\u00ecm ngh\u1ecbch \u0111\u1ea3o modulo cho m\u1ea3ng s\u1ed1 modulo $m$ (Finding the modular inverse for array of numbers modulo $m$)","text":"<p>Gi\u1ea3 s\u1eed ch\u00fang ta \u0111\u01b0\u1ee3c cho m\u1ed9t m\u1ea3ng v\u00e0 ch\u00fang ta mu\u1ed1n t\u00ecm ngh\u1ecbch \u0111\u1ea3o modulo cho t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 trong \u0111\u00f3 (t\u1ea5t c\u1ea3 ch\u00fang \u0111\u1ec1u kh\u1ea3 ngh\u1ecbch). Thay v\u00ec t\u00ednh to\u00e1n ngh\u1ecbch \u0111\u1ea3o cho m\u1ecdi s\u1ed1, ch\u00fang ta c\u00f3 th\u1ec3 m\u1edf r\u1ed9ng ph\u00e2n s\u1ed1 b\u1eb1ng t\u00edch ti\u1ec1n t\u1ed1 (kh\u00f4ng bao g\u1ed3m ch\u00ednh n\u00f3) v\u00e0 t\u00edch h\u1eadu t\u1ed1 (kh\u00f4ng bao g\u1ed3m ch\u00ednh n\u00f3), v\u00e0 k\u1ebft th\u00fac ch\u1ec9 t\u00ednh to\u00e1n m\u1ed9t ngh\u1ecbch \u0111\u1ea3o duy nh\u1ea5t thay th\u1ebf.</p> $$ \\begin{align} x_i^{-1} &amp;= \\frac{1}{x_i} = \\frac{\\overbrace{x_1 \\cdot x_2 \\cdots x_{i-1}}^{\\text{prefix}_{i-1}} \\cdot ~1~ \\cdot \\overbrace{x_{i+1} \\cdot x_{i+2} \\cdots x_n}^{\\text{suffix}_{i+1}}}{x_1 \\cdot x_2 \\cdots x_{i-1} \\cdot x_i \\cdot x_{i+1} \\cdot x_{i+2} \\cdots x_n} \\\\ &amp;= \\text{prefix}_{i-1} \\cdot \\text{suffix}_{i+1} \\cdot \\left(x_1 \\cdot x_2 \\cdots x_n\\right)^{-1} \\end{align} $$ <p>Trong m\u00e3, ch\u00fang ta ch\u1ec9 c\u1ea7n t\u1ea1o m\u1ed9t m\u1ea3ng t\u00edch ti\u1ec1n t\u1ed1 (lo\u1ea1i tr\u1eeb ch\u00ednh n\u00f3, b\u1eaft \u0111\u1ea7u t\u1eeb ph\u1ea7n t\u1eed \u0111\u01a1n v\u1ecb), t\u00ednh ngh\u1ecbch \u0111\u1ea3o modulo cho t\u00edch c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 v\u00e0 sau \u0111\u00f3 nh\u00e2n n\u00f3 v\u1edbi t\u00edch ti\u1ec1n t\u1ed1 v\u00e0 t\u00edch h\u1eadu t\u1ed1 (lo\u1ea1i tr\u1eeb ch\u00ednh n\u00f3). T\u00edch h\u1eadu t\u1ed1 \u0111\u01b0\u1ee3c t\u00ednh b\u1eb1ng c\u00e1ch l\u1eb7p t\u1eeb sau ra tr\u01b0\u1edbc.</p> <pre><code>std::vector&lt;int&gt; invs(const std::vector&lt;int&gt; &amp;a, int m) {\n    int n = a.size();\n    if (n == 0) return {};\n    std::vector&lt;int&gt; b(n);\n    int v = 1;\n    for (int i = 0; i != n; ++i) {\n        b[i] = v;\n        v = static_cast&lt;long long&gt;(v) * a[i] % m;\n    }\n    int x, y;\n    extended_euclidean(v, m, x, y);\n    x = (x % m + m) % m;\n    for (int i = n - 1; i &gt;= 0; --i) {\n        b[i] = static_cast&lt;long long&gt;(x) * b[i] % m;\n        x = static_cast&lt;long long&gt;(x) * a[i] % m;\n    }\n    return b;\n}\n</code></pre>","tags":["Translated"]},{"location":"algebra/module-inverse.html#practice-problems","title":"B\u00e0i t\u1eadp luy\u1ec7n t\u1eadp","text":"<ul> <li>UVa 11904 - One Unit Machine</li> <li>Hackerrank - Longest Increasing Subsequence Arrays</li> <li>Codeforces 300C - Beautiful Numbers</li> <li>Codeforces 622F - The Sum of the k-th Powers</li> <li>Codeforces 717A - Festival Organization</li> <li>Codeforces 896D - Nephren Runs a Cinema</li> </ul>","tags":["Translated"]},{"location":"algebra/module-inverse.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 167</li> <li>Translated lines: 167</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Translated"]},{"location":"algebra/montgomery_multiplication.html","title":"Ph\u00e9p nh\u00e2n Montgomery (Montgomery Multiplication)","text":"<p>Nhi\u1ec1u thu\u1eadt to\u00e1n trong l\u00fd thuy\u1ebft s\u1ed1, nh\u01b0 ki\u1ec3m tra s\u1ed1 nguy\u00ean t\u1ed1 ho\u1eb7c ph\u00e2n t\u00edch th\u1eeba s\u1ed1 nguy\u00ean, v\u00e0 trong m\u1eadt m\u00e3, nh\u01b0 RSA, y\u00eau c\u1ea7u r\u1ea5t nhi\u1ec1u ph\u00e9p to\u00e1n modulo v\u1edbi m\u1ed9t s\u1ed1 l\u1edbn. M\u1ed9t ph\u00e9p nh\u00e2n nh\u01b0 $x y \\bmod{n}$ kh\u00e1 ch\u1eadm \u0111\u1ec3 t\u00ednh to\u00e1n v\u1edbi c\u00e1c thu\u1eadt to\u00e1n \u0111i\u1ec3n h\u00ecnh, v\u00ec n\u00f3 y\u00eau c\u1ea7u m\u1ed9t ph\u00e9p chia \u0111\u1ec3 bi\u1ebft $n$ ph\u1ea3i \u0111\u01b0\u1ee3c tr\u1eeb bao nhi\u00eau l\u1ea7n t\u1eeb t\u00edch. V\u00e0 ph\u00e9p chia l\u00e0 m\u1ed9t ph\u00e9p to\u00e1n th\u1ef1c s\u1ef1 \u0111\u1eaft \u0111\u1ecf, \u0111\u1eb7c bi\u1ec7t l\u00e0 v\u1edbi c\u00e1c s\u1ed1 l\u1edbn.</p> <p>Ph\u00e9p nh\u00e2n Montgomery (modular) l\u00e0 m\u1ed9t ph\u01b0\u01a1ng ph\u00e1p cho ph\u00e9p t\u00ednh to\u00e1n c\u00e1c ph\u00e9p nh\u00e2n nh\u01b0 v\u1eady nhanh h\u01a1n. Thay v\u00ec chia t\u00edch v\u00e0 tr\u1eeb $n$ nhi\u1ec1u l\u1ea7n, n\u00f3 c\u1ed9ng c\u00e1c b\u1ed9i s\u1ed1 c\u1ee7a $n$ \u0111\u1ec3 tri\u1ec7t ti\u00eau c\u00e1c bit th\u1ea5p h\u01a1n v\u00e0 sau \u0111\u00f3 ch\u1ec9 lo\u1ea1i b\u1ecf c\u00e1c bit th\u1ea5p h\u01a1n.</p>","tags":["Original"]},{"location":"algebra/montgomery_multiplication.html#montgomery-representation","title":"Bi\u1ec3u di\u1ec5n Montgomery (Montgomery representation)","text":"<p>Tuy nhi\u00ean, ph\u00e9p nh\u00e2n Montgomery kh\u00f4ng mi\u1ec5n ph\u00ed. Thu\u1eadt to\u00e1n ch\u1ec9 ho\u1ea1t \u0111\u1ed9ng trong kh\u00f4ng gian Montgomery. V\u00e0 ch\u00fang ta c\u1ea7n chuy\u1ec3n \u0111\u1ed5i c\u00e1c s\u1ed1 c\u1ee7a m\u00ecnh v\u00e0o kh\u00f4ng gian \u0111\u00f3, tr\u01b0\u1edbc khi ch\u00fang ta c\u00f3 th\u1ec3 b\u1eaft \u0111\u1ea7u nh\u00e2n.</p> <p>\u0110\u1ed1i v\u1edbi kh\u00f4ng gian, ch\u00fang ta c\u1ea7n m\u1ed9t s\u1ed1 nguy\u00ean d\u01b0\u01a1ng $r \\ge n$ nguy\u00ean t\u1ed1 c\u00f9ng nhau v\u1edbi $n$, t\u1ee9c l\u00e0 $\\gcd(n, r) = 1$. Trong th\u1ef1c t\u1ebf, ch\u00fang ta lu\u00f4n ch\u1ecdn $r$ l\u00e0 $2^m$ cho m\u1ed9t s\u1ed1 nguy\u00ean d\u01b0\u01a1ng $m$, v\u00ec c\u00e1c ph\u00e9p nh\u00e2n, ph\u00e9p chia v\u00e0 ph\u00e9p to\u00e1n modulo $r$ sau \u0111\u00f3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c c\u00e0i \u0111\u1eb7t hi\u1ec7u qu\u1ea3 b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng ph\u00e9p d\u1ecbch v\u00e0 c\u00e1c ph\u00e9p to\u00e1n bit kh\u00e1c. $n$ s\u1ebd l\u00e0 m\u1ed9t s\u1ed1 l\u1ebb trong h\u1ea7u h\u1ebft c\u00e1c \u1ee9ng d\u1ee5ng, v\u00ec kh\u00f4ng kh\u00f3 \u0111\u1ec3 ph\u00e2n t\u00edch th\u1eeba s\u1ed1 m\u1ed9t s\u1ed1 ch\u1eb5n. V\u00ec v\u1eady, m\u1ed7i l\u0169y th\u1eeba c\u1ee7a $2$ s\u1ebd l\u00e0 nguy\u00ean t\u1ed1 c\u00f9ng nhau v\u1edbi $n$.</p> <p>\u0110\u1ea1i di\u1ec7n $\\bar{x}$ c\u1ee7a m\u1ed9t s\u1ed1 $x$ trong kh\u00f4ng gian Montgomery \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a l\u00e0: </p> $$\\bar{x} := x \\cdot r \\bmod n$$ <p>L\u01b0u \u00fd, ph\u00e9p chuy\u1ec3n \u0111\u1ed5i th\u1ef1c s\u1ef1 l\u00e0 m\u1ed9t ph\u00e9p nh\u00e2n nh\u01b0 v\u1eady m\u00e0 ch\u00fang ta mu\u1ed1n t\u1ed1i \u01b0u h\u00f3a. V\u00ec v\u1eady, \u0111\u00e2y v\u1eabn l\u00e0 m\u1ed9t ho\u1ea1t \u0111\u1ed9ng \u0111\u1eaft \u0111\u1ecf. Tuy nhi\u00ean, b\u1ea1n ch\u1ec9 c\u1ea7n chuy\u1ec3n \u0111\u1ed5i m\u1ed9t s\u1ed1 m\u1ed9t l\u1ea7n v\u00e0o kh\u00f4ng gian. Ngay khi b\u1ea1n \u1edf trong kh\u00f4ng gian Montgomery, b\u1ea1n c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n bao nhi\u00eau ph\u00e9p to\u00e1n t\u00f9y \u00fd m\u1ed9t c\u00e1ch hi\u1ec7u qu\u1ea3. V\u00e0 cu\u1ed1i c\u00f9ng b\u1ea1n chuy\u1ec3n \u0111\u1ed5i k\u1ebft qu\u1ea3 cu\u1ed1i c\u00f9ng tr\u1edf l\u1ea1i. V\u00ec v\u1eady, mi\u1ec5n l\u00e0 b\u1ea1n \u0111ang th\u1ef1c hi\u1ec7n nhi\u1ec1u ph\u00e9p to\u00e1n modulo $n$, \u0111i\u1ec1u n\u00e0y s\u1ebd kh\u00f4ng th\u00e0nh v\u1ea5n \u0111\u1ec1.</p> <p>B\u00ean trong kh\u00f4ng gian Montgomery, b\u1ea1n v\u1eabn c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n h\u1ea7u h\u1ebft c\u00e1c ph\u00e9p to\u00e1n nh\u01b0 b\u00ecnh th\u01b0\u1eddng. B\u1ea1n c\u00f3 th\u1ec3 c\u1ed9ng hai ph\u1ea7n t\u1eed ($x \\cdot r + y \\cdot r \\equiv (x + y) \\cdot r \\bmod n$), tr\u1eeb, ki\u1ec3m tra s\u1ef1 b\u1eb1ng nhau, v\u00e0 th\u1eadm ch\u00ed t\u00ednh \u01b0\u1edbc chung l\u1edbn nh\u1ea5t c\u1ee7a m\u1ed9t s\u1ed1 v\u1edbi $n$ (v\u00ec $\\gcd(n, r) = 1$). T\u1ea5t c\u1ea3 v\u1edbi c\u00e1c thu\u1eadt to\u00e1n th\u00f4ng th\u01b0\u1eddng.</p> <p>Tuy nhi\u00ean \u0111i\u1ec1u n\u00e0y kh\u00f4ng \u0111\u00fang \u0111\u1ed1i v\u1edbi ph\u00e9p nh\u00e2n.</p> <p>Ch\u00fang ta mong \u0111\u1ee3i k\u1ebft qu\u1ea3 l\u00e0:</p> $$\\bar{x} * \\bar{y} = \\overline{x \\cdot y} = (x \\cdot y) \\cdot r \\bmod n.$$ <p>Nh\u01b0ng ph\u00e9p nh\u00e2n th\u00f4ng th\u01b0\u1eddng s\u1ebd cho ch\u00fang ta:</p> $$\\bar{x} \\cdot \\bar{y} = (x \\cdot y) \\cdot r \\cdot r \\bmod n.$$ <p>Do \u0111\u00f3 ph\u00e9p nh\u00e2n trong kh\u00f4ng gian Montgomery \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a l\u00e0:</p> $$\\bar{x} * \\bar{y} := \\bar{x} \\cdot \\bar{y} \\cdot r^{-1} \\bmod n.$$","tags":["Original"]},{"location":"algebra/montgomery_multiplication.html#montgomery-reduction","title":"R\u00fat g\u1ecdn Montgomery (Montgomery reduction)","text":"<p>Ph\u00e9p nh\u00e2n c\u1ee7a hai s\u1ed1 trong kh\u00f4ng gian Montgomery y\u00eau c\u1ea7u t\u00ednh to\u00e1n hi\u1ec7u qu\u1ea3 $x \\cdot r^{-1} \\bmod n$. Ph\u00e9p to\u00e1n n\u00e0y \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 R\u00fat g\u1ecdn Montgomery, v\u00e0 c\u00f2n \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 thu\u1eadt to\u00e1n REDC.</p> <p>B\u1edfi v\u00ec $\\gcd(n, r) = 1$, ch\u00fang ta bi\u1ebft r\u1eb1ng c\u00f3 hai s\u1ed1 $r^{-1}$ v\u00e0 $n^{\\prime}$ v\u1edbi $0 &lt; r^{-1}, n^{\\prime} &lt; n$ v\u1edbi</p> $$r \\cdot r^{-1} + n \\cdot n^{\\prime} = 1.$$ <p>C\u1ea3 $r^{-1}$ v\u00e0 $n^{\\prime}$ \u0111\u1ec1u c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ednh b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng Thu\u1eadt to\u00e1n Euclid m\u1edf r\u1ed9ng.</p> <p>S\u1eed d\u1ee5ng \u0111\u1ed3ng nh\u1ea5t th\u1ee9c n\u00e0y, ch\u00fang ta c\u00f3 th\u1ec3 vi\u1ebft $x \\cdot r^{-1}$ d\u01b0\u1edbi d\u1ea1ng:</p> $$\\begin{aligned} x \\cdot r^{-1} &amp;= x \\cdot r \\cdot r^{-1} / r = x \\cdot (-n \\cdot n^{\\prime} + 1) / r \\\\ &amp;= (-x \\cdot n \\cdot n^{\\prime} + x) / r \\equiv (-x \\cdot n \\cdot n^{\\prime} + l \\cdot r \\cdot n + x) / r \\bmod n\\\\ &amp;\\equiv ((-x \\cdot n^{\\prime} + l \\cdot r) \\cdot n + x) / r \\bmod n \\end{aligned}$$ <p>S\u1ef1 t\u01b0\u01a1ng \u0111\u01b0\u01a1ng gi\u1eef cho b\u1ea5t k\u1ef3 s\u1ed1 nguy\u00ean t\u00f9y \u00fd $l$. \u0110i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0, ch\u00fang ta c\u00f3 th\u1ec3 c\u1ed9ng ho\u1eb7c tr\u1eeb m\u1ed9t b\u1ed9i s\u1ed1 t\u00f9y \u00fd c\u1ee7a $r$ v\u00e0o $x \\cdot n^{\\prime}$, ho\u1eb7c n\u00f3i c\u00e1ch kh\u00e1c, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh $q := x \\cdot n^{\\prime}$ modulo $r$.</p> <p>\u0110i\u1ec1u n\u00e0y cho ch\u00fang ta thu\u1eadt to\u00e1n sau \u0111\u1ec3 t\u00ednh $x \\cdot r^{-1} \\bmod n$:</p> <pre><code>function reduce(x):\n    q = (x mod r) * n' mod r\n    a = (x - q * n) / r\n    if a &lt; 0:\n        a += n\n    return a\n</code></pre> <p>V\u00ec $x &lt; n \\cdot n &lt; r \\cdot n$ (ngay c\u1ea3 khi $x$ l\u00e0 t\u00edch c\u1ee7a m\u1ed9t ph\u00e9p nh\u00e2n) v\u00e0 $q \\cdot n &lt; r \\cdot n$ ch\u00fang ta bi\u1ebft r\u1eb1ng $-n &lt; (x - q \\cdot n) / r &lt; n$. Do \u0111\u00f3 ph\u00e9p to\u00e1n modulo cu\u1ed1i c\u00f9ng \u0111\u01b0\u1ee3c c\u00e0i \u0111\u1eb7t b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng m\u1ed9t l\u1ea7n ki\u1ec3m tra v\u00e0 m\u1ed9t ph\u00e9p c\u1ed9ng.</p> <p>Nh\u01b0 ch\u00fang ta th\u1ea5y, ch\u00fang ta c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n r\u00fat g\u1ecdn Montgomery m\u00e0 kh\u00f4ng c\u1ea7n b\u1ea5t k\u1ef3 ph\u00e9p to\u00e1n modulo n\u1eb7ng n\u1ec1 n\u00e0o. N\u1ebfu ch\u00fang ta ch\u1ecdn $r$ l\u00e0 l\u0169y th\u1eeba c\u1ee7a $2$, c\u00e1c ph\u00e9p to\u00e1n modulo v\u00e0 chia trong thu\u1eadt to\u00e1n c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng bitmask v\u00e0 d\u1ecbch.</p> <p>M\u1ed9t \u1ee9ng d\u1ee5ng th\u1ee9 hai c\u1ee7a r\u00fat g\u1ecdn Montgomery l\u00e0 chuy\u1ec3n m\u1ed9t s\u1ed1 tr\u1edf l\u1ea1i t\u1eeb kh\u00f4ng gian Montgomery v\u00e0o kh\u00f4ng gian b\u00ecnh th\u01b0\u1eddng.</p>","tags":["Original"]},{"location":"algebra/montgomery_multiplication.html#fast-inverse-trick","title":"M\u1eb9o ngh\u1ecbch \u0111\u1ea3o nhanh (Fast inverse trick)","text":"<p>\u0110\u1ec3 t\u00ednh to\u00e1n ngh\u1ecbch \u0111\u1ea3o $n^{\\prime} := n^{-1} \\bmod r$ m\u1ed9t c\u00e1ch hi\u1ec7u qu\u1ea3, ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng m\u1eb9o sau (\u0111\u01b0\u1ee3c l\u1ea5y c\u1ea3m h\u1ee9ng t\u1eeb ph\u01b0\u01a1ng ph\u00e1p Newton):</p> $$a \\cdot x \\equiv 1 \\bmod 2^k \\Longrightarrow a \\cdot x \\cdot (2 - a \\cdot x) \\equiv 1 \\bmod 2^{2k}$$ <p>\u0110i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng \u0111\u01b0\u1ee3c ch\u1ee9ng minh. N\u1ebfu ch\u00fang ta c\u00f3 $a \\cdot x = 1 + m \\cdot 2^k$, th\u00ec ch\u00fang ta c\u00f3:</p> $$\\begin{aligned} a \\cdot x \\cdot (2 - a \\cdot x) &amp;= 2 \\cdot a \\cdot x - (a \\cdot x)^2 \\\\ &amp;= 2 \\cdot (1 + m \\cdot 2^k) - (1 + m \\cdot 2^k)^2 \\\\ &amp;= 2 + 2 \\cdot m \\cdot 2^k - 1 - 2 \\cdot m \\cdot 2^k - m^2 \\cdot 2^{2k} \\\\ &amp;= 1 - m^2 \\cdot 2^{2k} \\\\ &amp;\\equiv 1 \\bmod 2^{2k}. \\end{aligned}$$ <p>\u0110i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 ch\u00fang ta c\u00f3 th\u1ec3 b\u1eaft \u0111\u1ea7u v\u1edbi $x = 1$ l\u00e0 ngh\u1ecbch \u0111\u1ea3o c\u1ee7a $a$ modulo $2^1$, \u00e1p d\u1ee5ng m\u1eb9o m\u1ed9t v\u00e0i l\u1ea7n v\u00e0 trong m\u1ed7i l\u1ea7n l\u1eb7p, ch\u00fang ta nh\u00e2n \u0111\u00f4i s\u1ed1 bit ch\u00ednh x\u00e1c c\u1ee7a $x$.</p>","tags":["Original"]},{"location":"algebra/montgomery_multiplication.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>S\u1eed d\u1ee5ng tr\u00ecnh bi\u00ean d\u1ecbch GCC, ch\u00fang ta v\u1eabn c\u00f3 th\u1ec3 t\u00ednh $x \\cdot y \\bmod n$ m\u1ed9t c\u00e1ch hi\u1ec7u qu\u1ea3, khi c\u1ea3 ba s\u1ed1 \u0111\u1ec1u l\u00e0 s\u1ed1 nguy\u00ean 64 bit, v\u00ec tr\u00ecnh bi\u00ean d\u1ecbch h\u1ed7 tr\u1ee3 s\u1ed1 nguy\u00ean 128 bit v\u1edbi c\u00e1c ki\u1ec3u <code>__int128</code> v\u00e0 <code>__uint128</code>.</p> <pre><code>long long result = (__int128)x * y % n;\n</code></pre> <p>Tuy nhi\u00ean kh\u00f4ng c\u00f3 ki\u1ec3u n\u00e0o cho s\u1ed1 nguy\u00ean 256 bit. Do \u0111\u00f3, \u1edf \u0111\u00e2y ch\u00fang t\u00f4i s\u1ebd tr\u00ecnh b\u00e0y m\u1ed9t c\u00e0i \u0111\u1eb7t cho ph\u00e9p nh\u00e2n 128 bit.</p> <pre><code>using u64 = uint64_t;\nusing u128 = __uint128_t;\nusing i128 = __int128_t;\n\nstruct u256 {\n    u128 high, low;\n\n    static u256 mult(u128 x, u128 y) {\n        u64 a = x &gt;&gt; 64, b = x;\n        u64 c = y &gt;&gt; 64, d = y;\n        // (a*2^64 + b) * (c*2^64 + d) =\n        // (a*c) * 2^128 + (a*d + b*c)*2^64 + (b*d)\n        u128 ac = (u128)a * c;\n        u128 ad = (u128)a * d;\n        u128 bc = (u128)b * c;\n        u128 bd = (u128)b * d;\n        u128 carry = (u128)(u64)ad + (u128)(u64)bc + (bd &gt;&gt; 64u);\n        u128 high = ac + (ad &gt;&gt; 64u) + (bc &gt;&gt; 64u) + (carry &gt;&gt; 64u);\n        u128 low = (ad &lt;&lt; 64u) + (bc &lt;&lt; 64u) + bd;\n        return {high, low};\n    }\n};\n\nstruct Montgomery {\n    Montgomery(u128 n) : mod(n), inv(1) {\n        for (int i = 0; i &lt; 7; i++)\n            inv *= 2 - n * inv;\n    }\n\n    u128 init(u128 x) {\n        x %= mod;\n        for (int i = 0; i &lt; 128; i++) {\n            x &lt;&lt;= 1;\n            if (x &gt;= mod)\n                x -= mod;\n        }\n        return x;\n    }\n\n    u128 reduce(u256 x) {\n        u128 q = x.low * inv;\n        i128 a = x.high - u256::mult(q, mod).high;\n        if (a &lt; 0)\n            a += mod;\n        return a;\n    }\n\n    u128 mult(u128 a, u128 b) {\n        return reduce(u256::mult(a, b));\n    }\n\n    u128 mod, inv;\n};\n</code></pre>","tags":["Original"]},{"location":"algebra/montgomery_multiplication.html#fast-transformation","title":"Bi\u1ebfn \u0111\u1ed5i nhanh (Fast transformation)","text":"<p>Ph\u01b0\u01a1ng ph\u00e1p hi\u1ec7n t\u1ea1i \u0111\u1ec3 chuy\u1ec3n \u0111\u1ed5i m\u1ed9t s\u1ed1 v\u00e0o kh\u00f4ng gian Montgomery kh\u00e1 ch\u1eadm. C\u00f3 nh\u1eefng c\u00e1ch nhanh h\u01a1n.</p> <p>B\u1ea1n c\u00f3 th\u1ec3 nh\u1eadn th\u1ea5y m\u1ed1i quan h\u1ec7 sau:</p> $$\\bar{x} := x \\cdot r \\bmod n = x \\cdot r^2 / r = x * r^2$$ <p>Chuy\u1ec3n \u0111\u1ed5i m\u1ed9t s\u1ed1 v\u00e0o kh\u00f4ng gian ch\u1ec9 l\u00e0 m\u1ed9t ph\u00e9p nh\u00e2n b\u00ean trong kh\u00f4ng gian c\u1ee7a s\u1ed1 \u0111\u00f3 v\u1edbi $r^2$. Do \u0111\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh tr\u01b0\u1edbc $r^2 \\bmod n$ v\u00e0 ch\u1ec9 c\u1ea7n th\u1ef1c hi\u1ec7n ph\u00e9p nh\u00e2n thay v\u00ec d\u1ecbch s\u1ed1 128 l\u1ea7n.</p> <p>Trong m\u00e3 sau, ch\u00fang ta kh\u1edfi t\u1ea1o <code>r2</code> v\u1edbi <code>-n % n</code>, t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi $r - n \\equiv r \\bmod n$, d\u1ecbch n\u00f3 4 l\u1ea7n \u0111\u1ec3 nh\u1eadn \u0111\u01b0\u1ee3c $r \\cdot 2^4 \\bmod n$. S\u1ed1 n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c hi\u1ec3u l\u00e0 $2^4$ trong kh\u00f4ng gian Montgomery. N\u1ebfu ch\u00fang ta b\u00ecnh ph\u01b0\u01a1ng n\u00f3 $5$ l\u1ea7n, ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c $(2^4)^{2^5} = (2^4)^{32} = 2^{128} = r$ trong kh\u00f4ng gian Montgomery, ch\u00ednh x\u00e1c l\u00e0 $r^2 \\bmod n$.</p> <pre><code>struct Montgomery {\n    Montgomery(u128 n) : mod(n), inv(1), r2(-n % n) {\n        for (int i = 0; i &lt; 7; i++)\n            inv *= 2 - n * inv;\n\n        for (int i = 0; i &lt; 4; i++) {\n            r2 &lt;&lt;= 1;\n            if (r2 &gt;= mod)\n                r2 -= mod;\n        }\n        for (int i = 0; i &lt; 5; i++)\n            r2 = mul(r2, r2);\n    }\n\n    u128 init(u128 x) {\n        return mult(x, r2);\n    }\n\n    u128 mod, inv, r2;\n};\n</code></pre>","tags":["Original"]},{"location":"algebra/montgomery_multiplication.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 220</li> <li>Translated lines: 220</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Original"]},{"location":"algebra/phi-function.html","title":"H\u00e0m phi Euler (Euler's totient function)","text":"<p>H\u00e0m phi Euler, c\u00f2n \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 phi-function $\\phi (n)$, \u0111\u1ebfm s\u1ed1 l\u01b0\u1ee3ng c\u00e1c s\u1ed1 nguy\u00ean n\u1eb1m gi\u1eefa 1 v\u00e0 $n$, m\u00e0 nguy\u00ean t\u1ed1 c\u00f9ng nhau v\u1edbi $n$. Hai s\u1ed1 \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 nguy\u00ean t\u1ed1 c\u00f9ng nhau n\u1ebfu \u01b0\u1edbc chung l\u1edbn nh\u1ea5t c\u1ee7a ch\u00fang b\u1eb1ng $1$ ($1$ \u0111\u01b0\u1ee3c coi l\u00e0 nguy\u00ean t\u1ed1 c\u00f9ng nhau v\u1edbi b\u1ea5t k\u1ef3 s\u1ed1 n\u00e0o).</p> <p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a $\\phi(n)$ cho m\u1ed9t v\u00e0i s\u1ed1 nguy\u00ean d\u01b0\u01a1ng \u0111\u1ea7u ti\u00ean:</p> $$\\begin{array}{|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|} \\hline n &amp; 1 &amp; 2 &amp; 3 &amp; 4 &amp; 5 &amp; 6 &amp; 7 &amp; 8 &amp; 9 &amp; 10 &amp; 11 &amp; 12 &amp; 13 &amp; 14 &amp; 15 &amp; 16 &amp; 17 &amp; 18 &amp; 19 &amp; 20 &amp; 21 \\\\\\\\ \\hline \\phi(n) &amp; 1 &amp; 1 &amp; 2 &amp; 2 &amp; 4 &amp; 2 &amp; 6 &amp; 4 &amp; 6 &amp; 4 &amp; 10 &amp; 4 &amp; 12 &amp; 6 &amp; 8 &amp; 8 &amp; 16 &amp; 6 &amp; 18 &amp; 8 &amp; 12 \\\\\\\\ \\hline \\end{array}$$","tags":["Translated"]},{"location":"algebra/phi-function.html#properties","title":"C\u00e1c t\u00ednh ch\u1ea5t (Properties)","text":"<p>C\u00e1c t\u00ednh ch\u1ea5t sau \u0111\u00e2y c\u1ee7a h\u00e0m phi Euler \u0111\u1ee7 \u0111\u1ec3 t\u00ednh to\u00e1n n\u00f3 cho b\u1ea5t k\u1ef3 s\u1ed1 n\u00e0o:</p> <ul> <li>N\u1ebfu $p$ l\u00e0 m\u1ed9t s\u1ed1 nguy\u00ean t\u1ed1, th\u00ec $\\gcd(p, q) = 1$ v\u1edbi m\u1ecdi $1 \\le q &lt; p$. Do \u0111\u00f3 ch\u00fang ta c\u00f3:</li> </ul> $$\\phi (p) = p - 1.$$ <ul> <li>N\u1ebfu $p$ l\u00e0 m\u1ed9t s\u1ed1 nguy\u00ean t\u1ed1 v\u00e0 $k \\ge 1$, th\u00ec c\u00f3 ch\u00ednh x\u00e1c $p^k / p$ s\u1ed1 gi\u1eefa $1$ v\u00e0 $p^k$ chia h\u1ebft cho $p$.     \u0110i\u1ec1u n\u00e0y cho ch\u00fang ta:</li> </ul> $$\\phi(p^k) = p^k - p^{k-1}.$$ <ul> <li> <p>N\u1ebfu $a$ v\u00e0 $b$ l\u00e0 nguy\u00ean t\u1ed1 c\u00f9ng nhau, th\u00ec:</p> $$\\phi(a b) = \\phi(a) \\cdot \\phi(b).$$ <p>Quan h\u1ec7 n\u00e0y kh\u00f4ng d\u1ec5 th\u1ea5y. N\u00f3 xu\u1ea5t ph\u00e1t t\u1eeb \u0110\u1ecbnh l\u00fd th\u1eb7ng d\u01b0 Trung Hoa. \u0110\u1ecbnh l\u00fd th\u1eb7ng d\u01b0 Trung Hoa \u0111\u1ea3m b\u1ea3o r\u1eb1ng, v\u1edbi m\u1ed7i $0 \\le x &lt; a$ v\u00e0 m\u1ed7i $0 \\le y &lt; b$, t\u1ed3n t\u1ea1i duy nh\u1ea5t m\u1ed9t $0 \\le z &lt; a b$ v\u1edbi $z \\equiv x \\pmod{a}$ v\u00e0 $z \\equiv y \\pmod{b}$. Kh\u00f4ng kh\u00f3 \u0111\u1ec3 ch\u1ec9 ra r\u1eb1ng $z$ nguy\u00ean t\u1ed1 c\u00f9ng nhau v\u1edbi $a b$ khi v\u00e0 ch\u1ec9 khi $x$ nguy\u00ean t\u1ed1 c\u00f9ng nhau v\u1edbi $a$ v\u00e0 $y$ nguy\u00ean t\u1ed1 c\u00f9ng nhau v\u1edbi $b$. Do \u0111\u00f3 l\u01b0\u1ee3ng s\u1ed1 nguy\u00ean nguy\u00ean t\u1ed1 c\u00f9ng nhau v\u1edbi $a b$ b\u1eb1ng t\u00edch c\u1ee7a l\u01b0\u1ee3ng s\u1ed1 c\u1ee7a $a$ v\u00e0 $b$.</p> </li> <li> <p>T\u1ed5ng qu\u00e1t, v\u1edbi $a$ v\u00e0 $b$ kh\u00f4ng nguy\u00ean t\u1ed1 c\u00f9ng nhau, ph\u01b0\u01a1ng tr\u00ecnh</p> $$\\phi(ab) = \\phi(a) \\cdot \\phi(b) \\cdot \\dfrac{d}{\\phi(d)}$$ <p>v\u1edbi $d = \\gcd(a, b)$ gi\u1eef \u0111\u00fang.</p> </li> </ul> <p>Nh\u01b0 v\u1eady, s\u1eed d\u1ee5ng ba t\u00ednh ch\u1ea5t \u0111\u1ea7u ti\u00ean, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh $\\phi(n)$ th\u00f4ng qua ph\u00e2n t\u00edch th\u1eeba s\u1ed1 c\u1ee7a $n$ (ph\u00e2n r\u00e3 $n$ th\u00e0nh t\u00edch c\u00e1c th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1 c\u1ee7a n\u00f3). N\u1ebfu $n = {p_1}^{a_1} \\cdot {p_2}^{a_2} \\cdots {p_k}^{a_k}$, trong \u0111\u00f3 $p_i$ l\u00e0 c\u00e1c th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1 c\u1ee7a $n$,</p> $$\\begin{align} \\phi (n) &amp;= \\phi ({p_1}^{a_1}) \\cdot \\phi ({p_2}^{a_2}) \\cdots  \\phi ({p_k}^{a_k}) \\\\\\\\ &amp;= \\left({p_1}^{a_1} - {p_1}^{a_1 - 1}\\right) \\cdot \\left({p_2}^{a_2} - {p_2}^{a_2 - 1}\\right) \\cdots \\left({p_k}^{a_k} - {p_k}^{a_k - 1}\\right) \\\\\\\\ &amp;= p_1^{a_1} \\cdot \\left(1 - \\frac{1}{p_1}\\right) \\cdot p_2^{a_2} \\cdot \\left(1 - \\frac{1}{p_2}\\right) \\cdots p_k^{a_k} \\cdot \\left(1 - \\frac{1}{p_k}\\right) \\\\\\\\ &amp;= n \\cdot \\left(1 - \\frac{1}{p_1}\\right) \\cdot \\left(1 - \\frac{1}{p_2}\\right) \\cdots \\left(1 - \\frac{1}{p_k}\\right) \\end{align}$$","tags":["Translated"]},{"location":"algebra/phi-function.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u1ed9t c\u00e0i \u0111\u1eb7t s\u1eed d\u1ee5ng ph\u00e2n t\u00edch th\u1eeba s\u1ed1 trong $O(\\sqrt{n})$:</p> <pre><code>int phi(int n) {\n    int result = n;\n    for (int i = 2; i * i &lt;= n; i++) {\n        if (n % i == 0) {\n            while (n % i == 0)\n                n /= i;\n            result -= result / i;\n        }\n    }\n    if (n &gt; 1)\n        result -= result / n;\n    return result;\n}\n</code></pre>","tags":["Translated"]},{"location":"algebra/phi-function.html#etf_1_to_n","title":"H\u00e0m phi Euler t\u1eeb $1$ \u0111\u1ebfn $n$ trong $O(n \\log\\log{n})$ (Euler totient function from $1$ to $n$ in $O(n \\log\\log{n})$)","text":"<p>N\u1ebfu ch\u00fang ta c\u1ea7n h\u00e0m phi c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 gi\u1eefa $1$ v\u00e0 $n$, th\u00ec vi\u1ec7c ph\u00e2n t\u00edch th\u1eeba s\u1ed1 t\u1ea5t c\u1ea3 $n$ s\u1ed1 l\u00e0 kh\u00f4ng hi\u1ec7u qu\u1ea3. Ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng c\u00f9ng \u00fd t\u01b0\u1edfng nh\u01b0 S\u00e0ng Eratosthenes. N\u00f3 v\u1eabn d\u1ef1a tr\u00ean t\u00ednh ch\u1ea5t \u0111\u01b0\u1ee3c tr\u00ecnh b\u00e0y \u1edf tr\u00ean, nh\u01b0ng thay v\u00ec c\u1eadp nh\u1eadt k\u1ebft qu\u1ea3 t\u1ea1m th\u1eddi cho t\u1eebng th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1 cho t\u1eebng s\u1ed1, ch\u00fang ta t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 nguy\u00ean t\u1ed1 v\u00e0 v\u1edbi m\u1ed7i s\u1ed1 nguy\u00ean t\u1ed1 c\u1eadp nh\u1eadt k\u1ebft qu\u1ea3 t\u1ea1m th\u1eddi c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 chia h\u1ebft cho s\u1ed1 nguy\u00ean t\u1ed1 \u0111\u00f3.</p> <p>V\u00ec c\u00e1ch ti\u1ebfp c\u1eadn n\u00e0y v\u1ec1 c\u01a1 b\u1ea3n gi\u1ed1ng v\u1edbi S\u00e0ng Eratosthenes, \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u0169ng s\u1ebd gi\u1ed1ng nhau: $O(n \\log \\log n)$</p> <pre><code>void phi_1_to_n(int n) {\n    vector&lt;int&gt; phi(n + 1);\n    for (int i = 0; i &lt;= n; i++)\n        phi[i] = i;\n\n    for (int i = 2; i &lt;= n; i++) {\n        if (phi[i] == i) {\n            for (int j = i; j &lt;= n; j += i)\n                phi[j] -= phi[j] / i;\n        }\n    }\n}\n</code></pre>","tags":["Translated"]},{"location":"algebra/phi-function.html#finding-the-totient-from-l-to-r-using-the-segmented-sieve","title":"T\u00ecm h\u00e0m phi t\u1eeb $L$ \u0111\u1ebfn $R$ b\u1eb1ng s\u00e0ng ph\u00e2n \u0111o\u1ea1n (Finding the totient from $L$ to $R$ using the segmented sieve)","text":"<p>N\u1ebfu ch\u00fang ta c\u1ea7n h\u00e0m phi c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 gi\u1eefa $L$ v\u00e0 $R$, ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng c\u00e1ch ti\u1ebfp c\u1eadn s\u00e0ng ph\u00e2n \u0111o\u1ea1n.</p> <p>Thu\u1eadt to\u00e1n \u0111\u1ea7u ti\u00ean t\u00ednh tr\u01b0\u1edbc t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 nguy\u00ean t\u1ed1 l\u00ean \u0111\u1ebfn $\\sqrt{R}$ b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng s\u00e0ng tuy\u1ebfn t\u00ednh trong th\u1eddi gian v\u00e0 kh\u00f4ng gian $O(\\sqrt{R})$. \u0110\u1ed1i v\u1edbi m\u1ed7i s\u1ed1 trong kho\u1ea3ng $[L, R]$, sau \u0111\u00f3 n\u00f3 \u00e1p d\u1ee5ng c\u00f4ng th\u1ee9c $\\phi$ d\u1ef1a tr\u00ean ph\u00e2n t\u00edch th\u1eeba s\u1ed1 b\u1eb1ng c\u00e1ch l\u1eb7p qua c\u00e1c s\u1ed1 nguy\u00ean t\u1ed1 n\u00e0y. Ch\u00fang ta duy tr\u00ec m\u1ed9t m\u1ea3ng d\u01b0 \u0111\u1ec3 theo d\u00f5i ph\u1ea7n ch\u01b0a ph\u00e2n t\u00edch c\u1ee7a m\u1ed7i s\u1ed1. N\u1ebfu ph\u1ea7n d\u01b0 v\u1eabn l\u1edbn h\u01a1n 1 sau khi x\u1eed l\u00fd t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 nguy\u00ean t\u1ed1 nh\u1ecf, n\u00f3 ch\u1ec9 ra m\u1ed9t th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1 l\u1edbn h\u01a1n $\\sqrt{R}$, \u0111\u01b0\u1ee3c x\u1eed l\u00fd trong b\u01b0\u1edbc cu\u1ed1i c\u00f9ng. \u0110\u1ed9 ph\u1ee9c t\u1ea1p t\u1ed5ng th\u1ec3 cho vi\u1ec7c t\u00ednh to\u00e1n ph\u1ea1m vi l\u00e0 $O((R - L + 1) \\log \\log R) + \\sqrt{R}$.</p> <pre><code>const long long MAX_RANGE = 1e6 + 6;\nvector&lt;long long&gt; primes;\nlong long phi[MAX_RANGE], rem[MAX_RANGE];\n\nvector&lt;int&gt; linear_sieve(int n) { \n    vector&lt;bool&gt; composite(n + 1, 0);\n    vector&lt;int&gt; prime;\n\n    // 0 and 1 are not composite (nor prime)\n    composite[0] = composite[1] = 1;\n\n    for(int i = 2; i &lt;= n; i++) {\n        if(!composite[i]) prime.push_back(i);\n        for(int j = 0; j &lt; prime.size() &amp;&amp; i * prime[j] &lt;= n; j++) {\n            composite[i * prime[j]] = true;\n            if(i % prime[j] == 0) break;\n        }\n    }\n    return prime;\n}\n\n// To get the value of phi(x) for L &lt;= x &lt;= R, use phi[x - L].\nvoid segmented_phi(long long L, long long R) { \n    for(long long i = L; i &lt;= R; i++) {\n        rem[i - L] = i;\n        phi[i - L] = i;\n    }\n\n    for(long long i : primes) {\n        for(long long j = max(i * i, (L + i - 1) / i * i); j &lt;= R; j += i) {\n            phi[j - L] -= phi[j - L] / i;\n            while(rem[j - L] % i == 0) rem[j - L] /= i;\n        }\n    }\n\n    for(long long i = 0; i &lt; R - L + 1; i++) {\n        if(rem[i] &gt; 1) phi[i] -= phi[i] / rem[i];\n    }\n}\n</code></pre>","tags":["Translated"]},{"location":"algebra/phi-function.html#divsum","title":"T\u00ednh ch\u1ea5t t\u1ed5ng \u01b0\u1edbc s\u1ed1 (Divisor sum property)","text":"<p>T\u00ednh ch\u1ea5t th\u00fa v\u1ecb n\u00e0y \u0111\u01b0\u1ee3c thi\u1ebft l\u1eadp b\u1edfi Gauss:</p> $$ \\sum_{d|n} \\phi{(d)} = n$$ <p>\u1ede \u0111\u00e2y t\u1ed5ng l\u00e0 tr\u00ean t\u1ea5t c\u1ea3 c\u00e1c \u01b0\u1edbc s\u1ed1 d\u01b0\u01a1ng $d$ c\u1ee7a $n$.</p> <p>V\u00ed d\u1ee5 c\u00e1c \u01b0\u1edbc s\u1ed1 c\u1ee7a 10 l\u00e0 1, 2, 5 v\u00e0 10. Do \u0111\u00f3 $\\phi{(1)} + \\phi{(2)} + \\phi{(5)} + \\phi{(10)} = 1 + 1 + 4 + 4 = 10$.</p>","tags":["Translated"]},{"location":"algebra/phi-function.html#finding-the-totient-from-1-to-n-using-the-divisor-sum-property","title":"T\u00ecm h\u00e0m phi t\u1eeb 1 \u0111\u1ebfn $n$ b\u1eb1ng t\u00ednh ch\u1ea5t t\u1ed5ng \u01b0\u1edbc s\u1ed1 (Finding the totient from 1 to $n$ using the divisor sum property)","text":"<p>T\u00ednh ch\u1ea5t t\u1ed5ng \u01b0\u1edbc s\u1ed1 c\u0169ng cho ph\u00e9p ch\u00fang ta t\u00ednh h\u00e0m phi c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 gi\u1eefa 1 v\u00e0 $n$. C\u00e0i \u0111\u1eb7t n\u00e0y \u0111\u01a1n gi\u1ea3n h\u01a1n m\u1ed9t ch\u00fat so v\u1edbi c\u00e0i \u0111\u1eb7t tr\u01b0\u1edbc \u0111\u00f3 d\u1ef1a tr\u00ean S\u00e0ng Eratosthenes, tuy nhi\u00ean c\u0169ng c\u00f3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p t\u1ec7 h\u01a1n m\u1ed9t ch\u00fat: $O(n \\log n)$</p> <pre><code>void phi_1_to_n(int n) {\n    vector&lt;int&gt; phi(n + 1);\n    phi[0] = 0;\n    phi[1] = 1;\n    for (int i = 2; i &lt;= n; i++)\n        phi[i] = i - 1;\n\n    for (int i = 2; i &lt;= n; i++)\n        for (int j = 2 * i; j &lt;= n; j += i)\n              phi[j] -= phi[i];\n}\n</code></pre>","tags":["Translated"]},{"location":"algebra/phi-function.html#application","title":"\u1ee8ng d\u1ee5ng trong \u0111\u1ecbnh l\u00fd Euler (Application in Euler's theorem)","text":"<p>T\u00ednh ch\u1ea5t n\u1ed5i ti\u1ebfng v\u00e0 quan tr\u1ecdng nh\u1ea5t c\u1ee7a h\u00e0m phi Euler \u0111\u01b0\u1ee3c th\u1ec3 hi\u1ec7n trong \u0111\u1ecbnh l\u00fd Euler: </p> $$a^{\\phi(m)} \\equiv 1 \\pmod m \\quad \\text{n\u1ebfu } a \\text{ v\u00e0 } m \\text{ l\u00e0 nguy\u00ean t\u1ed1 c\u00f9ng nhau.}$$ <p>Trong tr\u01b0\u1eddng h\u1ee3p c\u1ee5 th\u1ec3 khi $m$ l\u00e0 s\u1ed1 nguy\u00ean t\u1ed1, \u0111\u1ecbnh l\u00fd Euler tr\u1edf th\u00e0nh \u0111\u1ecbnh l\u00fd Fermat nh\u1ecf:</p> $$a^{m - 1} \\equiv 1 \\pmod m$$ <p>\u0110\u1ecbnh l\u00fd Euler v\u00e0 h\u00e0m phi Euler xu\u1ea5t hi\u1ec7n kh\u00e1 th\u01b0\u1eddng xuy\u00ean trong c\u00e1c \u1ee9ng d\u1ee5ng th\u1ef1c t\u1ebf, v\u00ed d\u1ee5 c\u1ea3 hai \u0111\u1ec1u \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 t\u00ednh ngh\u1ecbch \u0111\u1ea3o nh\u00e2n modulo.</p> <p>Nh\u01b0 l\u00e0 h\u1ec7 qu\u1ea3 tr\u1ef1c ti\u1ebfp ch\u00fang ta c\u0169ng nh\u1eadn \u0111\u01b0\u1ee3c s\u1ef1 t\u01b0\u01a1ng \u0111\u01b0\u01a1ng:</p> $$a^n \\equiv a^{n \\bmod \\phi(m)} \\pmod m$$ <p>\u0110i\u1ec1u n\u00e0y cho ph\u00e9p t\u00ednh $x^n \\bmod m$ cho $n$ r\u1ea5t l\u1edbn, \u0111\u1eb7c bi\u1ec7t n\u1ebfu $n$ l\u00e0 k\u1ebft qu\u1ea3 c\u1ee7a m\u1ed9t t\u00ednh to\u00e1n kh\u00e1c, v\u00ec n\u00f3 cho ph\u00e9p t\u00ednh $n$ d\u01b0\u1edbi m\u1ed9t modulo.</p>","tags":["Translated"]},{"location":"algebra/phi-function.html#group-theory","title":"L\u00fd thuy\u1ebft nh\u00f3m (Group Theory)","text":"<p>$\\phi(n)$ l\u00e0 c\u1ea5p c\u1ee7a nh\u00f3m nh\u00e2n modulo n $(\\mathbb Z / n\\mathbb Z)^\\times$, \u0111\u00f3 l\u00e0 nh\u00f3m c\u00e1c \u0111\u01a1n v\u1ecb (c\u00e1c ph\u1ea7n t\u1eed c\u00f3 ngh\u1ecbch \u0111\u1ea3o nh\u00e2n). C\u00e1c ph\u1ea7n t\u1eed c\u00f3 ngh\u1ecbch \u0111\u1ea3o nh\u00e2n ch\u00ednh x\u00e1c l\u00e0 nh\u1eefng s\u1ed1 nguy\u00ean t\u1ed1 c\u00f9ng nhau v\u1edbi $n$.</p> <p>C\u1ea5p nh\u00e2n c\u1ee7a m\u1ed9t ph\u1ea7n t\u1eed $a$ mod $n$, k\u00fd hi\u1ec7u $\\operatorname{ord}_n(a)$, l\u00e0 $k&gt;0$ nh\u1ecf nh\u1ea5t sao cho $a^k \\equiv 1 \\pmod m$. $\\operatorname{ord}_n(a)$ l\u00e0 k\u00edch th\u01b0\u1edbc c\u1ee7a nh\u00f3m con \u0111\u01b0\u1ee3c sinh b\u1edfi $a$, v\u00ec v\u1eady theo \u0110\u1ecbnh l\u00fd Lagrange, c\u1ea5p nh\u00e2n c\u1ee7a b\u1ea5t k\u1ef3 $a$ n\u00e0o c\u0169ng ph\u1ea3i chia h\u1ebft $\\phi(n)$. N\u1ebfu c\u1ea5p nh\u00e2n c\u1ee7a $a$ l\u00e0 $\\phi(n)$, m\u1ee9c l\u1edbn nh\u1ea5t c\u00f3 th\u1ec3, th\u00ec $a$ l\u00e0 m\u1ed9t c\u0103n nguy\u00ean th\u1ee7y v\u00e0 nh\u00f3m l\u00e0 cyclic theo \u0111\u1ecbnh ngh\u0129a. </p>","tags":["Translated"]},{"location":"algebra/phi-function.html#generalization","title":"T\u1ed5ng qu\u00e1t h\u00f3a (Generalization)","text":"<p>C\u00f3 m\u1ed9t phi\u00ean b\u1ea3n \u00edt \u0111\u01b0\u1ee3c bi\u1ebft \u0111\u1ebfn h\u01a1n c\u1ee7a s\u1ef1 t\u01b0\u01a1ng \u0111\u01b0\u01a1ng cu\u1ed1i c\u00f9ng, cho ph\u00e9p t\u00ednh $x^n \\bmod m$ hi\u1ec7u qu\u1ea3 cho $x$ v\u00e0 $m$ kh\u00f4ng nguy\u00ean t\u1ed1 c\u00f9ng nhau. V\u1edbi $x, m$ b\u1ea5t k\u1ef3 v\u00e0 $n \\geq \\log_2 m$:</p> $$x^{n}\\equiv x^{\\phi(m)+[n \\bmod \\phi(m)]} \\mod m$$ <p>Ch\u1ee9ng minh:</p> <p>G\u1ecdi $p_1, \\dots, p_t$ l\u00e0 c\u00e1c \u01b0\u1edbc s\u1ed1 nguy\u00ean t\u1ed1 chung c\u1ee7a $x$ v\u00e0 $m$, v\u00e0 $k_i$ l\u00e0 s\u1ed1 m\u0169 c\u1ee7a ch\u00fang trong $m$. V\u1edbi ch\u00fang ta \u0111\u1ecbnh ngh\u0129a $a = p_1^{k_1} \\dots p_t^{k_t}$, l\u00e0m cho $\\frac{m}{a}$ nguy\u00ean t\u1ed1 c\u00f9ng nhau v\u1edbi $x$. V\u00e0 g\u1ecdi $k$ l\u00e0 s\u1ed1 nh\u1ecf nh\u1ea5t sao cho $a$ chia h\u1ebft $x^k$. Gi\u1ea3 s\u1eed $n \\ge k$, ch\u00fang ta c\u00f3 th\u1ec3 vi\u1ebft:</p> $$\\begin{align}x^n \\bmod m &amp;= \\frac{x^k}{a}ax^{n-k}\\bmod m \\\\ &amp;= \\frac{x^k}{a}\\left(ax^{n-k}\\bmod m\\right) \\bmod m \\\\ &amp;= \\frac{x^k}{a}\\left(ax^{n-k}\\bmod a \\frac{m}{a}\\right) \\bmod m \\\\ &amp;=\\frac{x^k}{a} a \\left(x^{n-k} \\bmod \\frac{m}{a}\\right)\\bmod m \\\\ &amp;= x^k\\left(x^{n-k} \\bmod \\frac{m}{a}\\right)\\bmod m \\end{align}$$ <p>S\u1ef1 t\u01b0\u01a1ng \u0111\u01b0\u01a1ng gi\u1eefa d\u00f2ng th\u1ee9 ba v\u00e0 th\u1ee9 t\u01b0 xu\u1ea5t ph\u00e1t t\u1eeb th\u1ef1c t\u1ebf l\u00e0 $ab \\bmod ac = a(b \\bmod c)$. Th\u1eadt v\u1eady n\u1ebfu $b = cd + r$ v\u1edbi $r &lt; c$, th\u00ec $ab = acd + ar$ v\u1edbi $ar &lt; ac$.</p> <p>V\u00ec $x$ v\u00e0 $\\frac{m}{a}$ nguy\u00ean t\u1ed1 c\u00f9ng nhau, ch\u00fang ta c\u00f3 th\u1ec3 \u00e1p d\u1ee5ng \u0111\u1ecbnh l\u00fd Euler v\u00e0 nh\u1eadn \u0111\u01b0\u1ee3c c\u00f4ng th\u1ee9c hi\u1ec7u qu\u1ea3 (v\u00ec $k$ r\u1ea5t nh\u1ecf; th\u1ef1c t\u1ebf $k \\le \\log_2 m$):</p> $$x^n \\bmod m = x^k\\left(x^{n-k \\bmod \\phi(\\frac{m}{a})} \\bmod \\frac{m}{a}\\right)\\bmod m.$$ <p>C\u00f4ng th\u1ee9c n\u00e0y kh\u00f3 \u00e1p d\u1ee5ng, nh\u01b0ng ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng n\u00f3 \u0111\u1ec3 ph\u00e2n t\u00edch h\u00e0nh vi c\u1ee7a $x^n \\bmod m$. Ch\u00fang ta c\u00f3 th\u1ec3 th\u1ea5y r\u1eb1ng d\u00e3y c\u00e1c l\u0169y th\u1eeba $(x^1 \\bmod m, x^2 \\bmod m, x^3 \\bmod m, \\dots)$ \u0111i v\u00e0o m\u1ed9t chu tr\u00ecnh c\u00f3 \u0111\u1ed9 d\u00e0i $\\phi\\left(\\frac{m}{a}\\right)$ sau $k$ (ho\u1eb7c \u00edt h\u01a1n) ph\u1ea7n t\u1eed \u0111\u1ea7u ti\u00ean.  $\\phi\\left(\\frac{m}{a}\\right)$ chia h\u1ebft $\\phi(m)$ (v\u00ec $a$ v\u00e0 $\\frac{m}{a}$ nguy\u00ean t\u1ed1 c\u00f9ng nhau ch\u00fang ta c\u00f3 $\\phi(a) \\cdot \\phi\\left(\\frac{m}{a}\\right) = \\phi(m)$), do \u0111\u00f3 ch\u00fang ta c\u0169ng c\u00f3 th\u1ec3 n\u00f3i r\u1eb1ng chu k\u1ef3 c\u00f3 \u0111\u1ed9 d\u00e0i $\\phi(m)$. V\u00e0 v\u00ec $\\phi(m) \\ge \\log_2 m \\ge k$, ch\u00fang ta c\u00f3 th\u1ec3 k\u1ebft lu\u1eadn c\u00f4ng th\u1ee9c mong mu\u1ed1n, \u0111\u01a1n gi\u1ea3n h\u01a1n nhi\u1ec1u:</p> $$ x^n \\equiv x^{\\phi(m)} x^{(n - \\phi(m)) \\bmod \\phi(m)} \\bmod m \\equiv x^{\\phi(m)+[n \\bmod \\phi(m)]} \\mod m.$$","tags":["Translated"]},{"location":"algebra/phi-function.html#practice-problems","title":"B\u00e0i t\u1eadp luy\u1ec7n t\u1eadp","text":"<ul> <li>SPOJ #4141 \"Euler Totient Function\" [Difficulty: CakeWalk]</li> <li>UVA #10179 \"Irreducible Basic Fractions\" [Difficulty: Easy]</li> <li>UVA #10299 \"Relatives\" [Difficulty: Easy]</li> <li>UVA #11327 \"Enumerating Rational Numbers\" [Difficulty: Medium]</li> <li>TIMUS #1673 \"Admission to Exam\" [Difficulty: High]</li> <li>UVA 10990 - Another New Function</li> <li>Codechef - Golu and Sweetness</li> <li>SPOJ - LCM Sum</li> <li>GYM - Simple Calculations  (F)</li> <li>UVA 13132 - Laser Mirrors</li> <li>SPOJ - GCDEX</li> <li>UVA 12995 - Farey Sequence</li> <li>SPOJ - Totient in Permutation (easy)</li> <li>LOJ - Mathematically Hard</li> <li>SPOJ - Totient Extreme</li> <li>SPOJ - Playing with GCD</li> <li>SPOJ - G Force</li> <li>SPOJ - Smallest Inverse Euler Totient Function</li> <li>Codeforces - Power Tower</li> <li>Kattis - Exponial</li> <li>LeetCode - 372. Super Pow</li> <li>Codeforces - The Holmes Children</li> <li>Codeforces - Small GCD</li> </ul>","tags":["Translated"]},{"location":"algebra/phi-function.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 258</li> <li>Translated lines: 258</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Translated"]},{"location":"algebra/polynomial.html","title":"C\u00e1c ph\u00e9p to\u00e1n tr\u00ean \u0111a th\u1ee9c v\u00e0 chu\u1ed7i (Operations on polynomials and series)","text":"<p>C\u00e1c b\u00e0i to\u00e1n trong l\u1eadp tr\u00ecnh thi \u0111\u1ea5u, \u0111\u1eb7c bi\u1ec7t l\u00e0 c\u00e1c b\u00e0i to\u00e1n li\u00ean quan \u0111\u1ebfn li\u1ec7t k\u00ea m\u1ed9t lo\u1ea1i n\u00e0o \u0111\u00f3, th\u01b0\u1eddng \u0111\u01b0\u1ee3c gi\u1ea3i quy\u1ebft b\u1eb1ng c\u00e1ch \u0111\u01b0a b\u00e0i to\u00e1n v\u1ec1 t\u00ednh to\u00e1n tr\u00ean \u0111a th\u1ee9c v\u00e0 chu\u1ed7i l\u0169y th\u1eeba h\u00ecnh th\u1ee9c.</p> <p>\u0110i\u1ec1u n\u00e0y bao g\u1ed3m c\u00e1c kh\u00e1i ni\u1ec7m nh\u01b0 nh\u00e2n \u0111a th\u1ee9c, n\u1ed9i suy, v\u00e0 nh\u1eefng c\u00e1i ph\u1ee9c t\u1ea1p h\u01a1n, nh\u01b0 logarit v\u00e0 h\u00e0m m\u0169 c\u1ee7a \u0111a th\u1ee9c. Trong b\u00e0i vi\u1ebft n\u00e0y, m\u1ed9t c\u00e1i nh\u00ecn t\u1ed5ng quan ng\u1eafn g\u1ecdn v\u1ec1 c\u00e1c ph\u00e9p to\u00e1n nh\u01b0 v\u1eady v\u00e0 c\u00e1c c\u00e1ch ti\u1ebfp c\u1eadn ph\u1ed5 bi\u1ebfn cho ch\u00fang \u0111\u01b0\u1ee3c tr\u00ecnh b\u00e0y.</p>","tags":["Original"]},{"location":"algebra/polynomial.html#basic-notion-and-facts","title":"Kh\u00e1i ni\u1ec7m c\u01a1 b\u1ea3n v\u00e0 s\u1ef1 th\u1eadt (Basic Notion and facts)","text":"<p>Trong ph\u1ea7n n\u00e0y, ch\u00fang t\u00f4i t\u1eadp trung nhi\u1ec1u h\u01a1n v\u00e0o c\u00e1c \u0111\u1ecbnh ngh\u0129a v\u00e0 t\u00ednh ch\u1ea5t \"tr\u1ef1c quan\" c\u1ee7a c\u00e1c ph\u00e9p to\u00e1n \u0111a th\u1ee9c kh\u00e1c nhau. C\u00e1c chi ti\u1ebft k\u1ef9 thu\u1eadt v\u1ec1 vi\u1ec7c c\u00e0i \u0111\u1eb7t v\u00e0 \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a ch\u00fang s\u1ebd \u0111\u01b0\u1ee3c \u0111\u1ec1 c\u1eadp trong c\u00e1c ph\u1ea7n sau.</p>","tags":["Original"]},{"location":"algebra/polynomial.html#polynomial-multiplication","title":"Nh\u00e2n \u0111a th\u1ee9c (Polynomial multiplication)","text":"<p>\u0110\u1ecbnh ngh\u0129a</p> <p>\u0110a th\u1ee9c m\u1ed9t bi\u1ebfn (Univariate polynomial) l\u00e0 m\u1ed9t bi\u1ec3u th\u1ee9c c\u00f3 d\u1ea1ng $A(x) = a_0 + a_1 x + \\dots + a_n x^n$.</p> <p>C\u00e1c gi\u00e1 tr\u1ecb $a_0, \\dots, a_n$ l\u00e0 c\u00e1c h\u1ec7 s\u1ed1 \u0111a th\u1ee9c, th\u01b0\u1eddng \u0111\u01b0\u1ee3c l\u1ea5y t\u1eeb m\u1ed9t t\u1eadp h\u1ee3p s\u1ed1 ho\u1eb7c c\u1ea5u tr\u00fac gi\u1ed1ng s\u1ed1 n\u00e0o \u0111\u00f3. Trong b\u00e0i vi\u1ebft n\u00e0y, ch\u00fang t\u00f4i gi\u1ea3 s\u1eed r\u1eb1ng c\u00e1c h\u1ec7 s\u1ed1 \u0111\u01b0\u1ee3c l\u1ea5y t\u1eeb m\u1ed9t tr\u01b0\u1eddng (field) n\u00e0o \u0111\u00f3, ngh\u0129a l\u00e0 c\u00e1c ph\u00e9p to\u00e1n c\u1ed9ng, tr\u1eeb, nh\u00e2n v\u00e0 chia \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh r\u00f5 r\u00e0ng cho ch\u00fang (ngo\u1ea1i tr\u1eeb ph\u00e9p chia cho $0$) v\u00e0 ch\u00fang th\u01b0\u1eddng c\u01b0 x\u1eed theo c\u00e1ch t\u01b0\u01a1ng t\u1ef1 nh\u01b0 s\u1ed1 th\u1ef1c.</p> <p>V\u00ed d\u1ee5 \u0111i\u1ec3n h\u00ecnh c\u1ee7a tr\u01b0\u1eddng nh\u01b0 v\u1eady l\u00e0 tr\u01b0\u1eddng c\u00e1c s\u1ed1 d\u01b0 modulo s\u1ed1 nguy\u00ean t\u1ed1 $p$.</p> <p>\u0110\u1ec3 \u0111\u01a1n gi\u1ea3n, ch\u00fang t\u00f4i s\u1ebd b\u1ecf thu\u1eadt ng\u1eef m\u1ed9t bi\u1ebfn, v\u00ec \u0111\u00e2y l\u00e0 lo\u1ea1i \u0111a th\u1ee9c duy nh\u1ea5t ch\u00fang t\u00f4i xem x\u00e9t trong b\u00e0i vi\u1ebft n\u00e0y. Ch\u00fang t\u00f4i c\u0169ng s\u1ebd vi\u1ebft $A$ thay v\u00ec $A(x)$ b\u1ea5t c\u1ee9 khi n\u00e0o c\u00f3 th\u1ec3, \u0111i\u1ec1u n\u00e0y s\u1ebd d\u1ec5 hi\u1ec3u t\u1eeb ng\u1eef c\u1ea3nh. Gi\u1ea3 s\u1eed r\u1eb1ng ho\u1eb7c $a_n \\neq 0$ ho\u1eb7c $A(x)=0$.</p> <p>\u0110\u1ecbnh ngh\u0129a</p> <p>T\u00edch c\u1ee7a hai \u0111a th\u1ee9c \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a b\u1eb1ng c\u00e1ch khai tri\u1ec3n n\u00f3 nh\u01b0 m\u1ed9t bi\u1ec3u th\u1ee9c s\u1ed1 h\u1ecdc:</p> $$ A(x) B(x) = \\left(\\sum\\limits_{i=0}^n a_i x^i \\right)\\left(\\sum\\limits_{j=0}^m b_j x^j\\right) = \\sum\\limits_{i,j} a_i b_j x^{i+j} = \\sum\\limits_{k=0}^{n+m} c_k x^k = C(x). $$ <p>D\u00e3y $c_0, c_1, \\dots, c_{n+m}$ c\u1ee7a c\u00e1c h\u1ec7 s\u1ed1 c\u1ee7a $C(x)$ \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 t\u00edch ch\u1eadp (convolution) c\u1ee7a $a_0, \\dots, a_n$ v\u00e0 $b_0, \\dots, b_m$.</p> <p>\u0110\u1ecbnh ngh\u0129a</p> <p>B\u1eadc c\u1ee7a m\u1ed9t \u0111a th\u1ee9c $A$ v\u1edbi $a_n \\neq 0$ \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a l\u00e0 $\\deg A = n$.</p> <p>\u0110\u1ec3 nh\u1ea5t qu\u00e1n, b\u1eadc c\u1ee7a $A(x) = 0$ \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a l\u00e0 $\\deg A = -\\infty$.</p> <p>Theo kh\u00e1i ni\u1ec7m n\u00e0y, $\\deg AB = \\deg A + \\deg B$ cho b\u1ea5t k\u1ef3 \u0111a th\u1ee9c $A$ v\u00e0 $B$ n\u00e0o.</p> <p>T\u00edch ch\u1eadp l\u00e0 c\u01a1 s\u1edf \u0111\u1ec3 gi\u1ea3i quy\u1ebft nhi\u1ec1u b\u00e0i to\u00e1n li\u1ec7t k\u00ea.</p> <p>V\u00ed d\u1ee5</p> <p>B\u1ea1n c\u00f3 $n$ v\u1eadt th\u1ec3 lo\u1ea1i th\u1ee9 nh\u1ea5t v\u00e0 $m$ v\u1eadt th\u1ec3 lo\u1ea1i th\u1ee9 hai.</p> <p>C\u00e1c v\u1eadt th\u1ec3 lo\u1ea1i th\u1ee9 nh\u1ea5t c\u00f3 gi\u00e1 tr\u1ecb $a_1, \\dots, a_n$, v\u00e0 c\u00e1c v\u1eadt th\u1ec3 lo\u1ea1i th\u1ee9 hai c\u00f3 gi\u00e1 tr\u1ecb $b_1, \\dots, b_m$.</p> <p>B\u1ea1n ch\u1ecdn m\u1ed9t v\u1eadt th\u1ec3 lo\u1ea1i th\u1ee9 nh\u1ea5t v\u00e0 m\u1ed9t v\u1eadt th\u1ec3 lo\u1ea1i th\u1ee9 hai. C\u00f3 bao nhi\u00eau c\u00e1ch \u0111\u1ec3 c\u00f3 \u0111\u01b0\u1ee3c t\u1ed5ng gi\u00e1 tr\u1ecb l\u00e0 $k$?</p> L\u1eddi gi\u1ea3i <p>Xem x\u00e9t t\u00edch $(x^{a_1} + \\dots + x^{a_n})(x^{b_1} + \\dots + x^{b_m})$. N\u1ebfu b\u1ea1n khai tri\u1ec3n n\u00f3, m\u1ed7i \u0111\u01a1n th\u1ee9c s\u1ebd t\u01b0\u01a1ng \u1ee9ng v\u1edbi c\u1eadp $(a_i, b_j)$ v\u00e0 \u0111\u00f3ng g\u00f3p v\u00e0o h\u1ec7 s\u1ed1 g\u1ea7n $x^{a_i+b_j}$. N\u00f3i c\u00e1ch kh\u00e1c, c\u00e2u tr\u1ea3 l\u1eddi l\u00e0 h\u1ec7 s\u1ed1 g\u1ea7n $x^k$ trong t\u00edch.</p> <p>V\u00ed d\u1ee5</p> <p>B\u1ea1n gieo m\u1ed9t x\u00fac x\u1eafc $6$ m\u1eb7t $n$ l\u1ea7n v\u00e0 t\u00ednh t\u1ed5ng k\u1ebft qu\u1ea3 t\u1eeb t\u1ea5t c\u1ea3 c\u00e1c l\u1ea7n gieo. X\u00e1c su\u1ea5t \u0111\u1ec3 nh\u1eadn \u0111\u01b0\u1ee3c t\u1ed5ng $k$ l\u00e0 bao nhi\u00eau?</p> L\u1eddi gi\u1ea3i <p>C\u00e2u tr\u1ea3 l\u1eddi l\u00e0 s\u1ed1 l\u01b0\u1ee3ng k\u1ebft qu\u1ea3 c\u00f3 t\u1ed5ng $k$, chia cho t\u1ed5ng s\u1ed1 k\u1ebft qu\u1ea3, \u0111\u00f3 l\u00e0 $6^n$.</p> <p>S\u1ed1 l\u01b0\u1ee3ng k\u1ebft qu\u1ea3 c\u00f3 t\u1ed5ng $k$ l\u00e0 bao nhi\u00eau? V\u1edbi $n=1$, n\u00f3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n b\u1edfi m\u1ed9t \u0111a th\u1ee9c $A(x) = x^1+x^2+\\dots+x^6$.</p> <p>V\u1edbi $n=2$, s\u1eed d\u1ee5ng c\u00f9ng c\u00e1ch ti\u1ebfp c\u1eadn nh\u01b0 v\u00ed d\u1ee5 tr\u00ean, ch\u00fang t\u00f4i k\u1ebft lu\u1eadn r\u1eb1ng n\u00f3 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n b\u1edfi \u0111a th\u1ee9c $(x^1+x^2+\\dots+x^6)^2$.</p> <p>Nh\u01b0 v\u1eady, c\u00e2u tr\u1ea3 l\u1eddi cho b\u00e0i to\u00e1n l\u00e0 h\u1ec7 s\u1ed1 th\u1ee9 $k$ c\u1ee7a $(x^1+x^2+\\dots+x^6)^n$, chia cho $6^n$.</p> <p>H\u1ec7 s\u1ed1 g\u1ea7n $x^k$ trong \u0111a th\u1ee9c $A(x)$ \u0111\u01b0\u1ee3c k\u00fd hi\u1ec7u ng\u1eafn g\u1ecdn l\u00e0 $[x^k]A$.</p>","tags":["Original"]},{"location":"algebra/polynomial.html#formal-power-series","title":"Chu\u1ed7i l\u0169y th\u1eeba h\u00ecnh th\u1ee9c (Formal power series)","text":"<p>\u0110\u1ecbnh ngh\u0129a</p> <p>M\u1ed9t chu\u1ed7i l\u0169y th\u1eeba h\u00ecnh th\u1ee9c l\u00e0 m\u1ed9t t\u1ed5ng v\u00f4 h\u1ea1n $A(x) = a_0 + a_1 x + a_2 x^2 + \\dots$, \u0111\u01b0\u1ee3c xem x\u00e9t b\u1ea5t k\u1ec3 t\u00ednh ch\u1ea5t h\u1ed9i t\u1ee5 c\u1ee7a n\u00f3.</p> <p>N\u00f3i c\u00e1ch kh\u00e1c, khi ch\u00fang ta xem x\u00e9t v\u00ed d\u1ee5 m\u1ed9t t\u1ed5ng $1+\\frac{1}{2}+\\frac{1}{4}+\\frac{1}{8}+\\dots=2$, ch\u00fang ta ng\u1ee5 \u00fd r\u1eb1ng n\u00f3 h\u1ed9i t\u1ee5 v\u1ec1 $2$ khi s\u1ed1 l\u01b0\u1ee3ng s\u1ed1 h\u1ea1ng ti\u1ebfn t\u1edbi v\u00f4 c\u00f9ng. Tuy nhi\u00ean, chu\u1ed7i h\u00ecnh th\u1ee9c ch\u1ec9 \u0111\u01b0\u1ee3c xem x\u00e9t d\u01b0\u1edbi d\u1ea1ng c\u00e1c d\u00e3y t\u1ea1o n\u00ean ch\u00fang.</p> <p>\u0110\u1ecbnh ngh\u0129a</p> <p>T\u00edch c\u1ee7a chu\u1ed7i l\u0169y th\u1eeba h\u00ecnh th\u1ee9c $A(x)$ v\u00e0 $B(x)$, c\u0169ng \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a b\u1eb1ng c\u00e1ch khai tri\u1ec3n n\u00f3 nh\u01b0 m\u1ed9t bi\u1ec3u th\u1ee9c s\u1ed1 h\u1ecdc:</p> $$ A(x) B(x) = \\left(\\sum\\limits_{i=0}^\\infty a_i x^i \\right)\\left(\\sum\\limits_{j=0}^\\infty b_j x^j\\right) = \\sum\\limits_{i,j} a_i b_j x^{i+j} = \\sum\\limits_{k=0}^{\\infty} c_k x^k = C(x), $$ <p>trong \u0111\u00f3 c\u00e1c h\u1ec7 s\u1ed1 $c_0, c_1, \\dots$ \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a l\u00e0 c\u00e1c t\u1ed5ng h\u1eefu h\u1ea1n</p> $$ c_k = \\sum\\limits_{i=0}^k a_i b_{k-i}. $$ <p>D\u00e3y $c_0, c_1, \\dots$ c\u0169ng \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 m\u1ed9t t\u00edch ch\u1eadp (convolution) c\u1ee7a $a_0, a_1, \\dots$ v\u00e0 $b_0, b_1, \\dots$, kh\u00e1i qu\u00e1t h\u00f3a kh\u00e1i ni\u1ec7m cho c\u00e1c d\u00e3y v\u00f4 h\u1ea1n.</p> <p>Do \u0111\u00f3, c\u00e1c \u0111a th\u1ee9c c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c coi l\u00e0 chu\u1ed7i l\u0169y th\u1eeba h\u00ecnh th\u1ee9c, nh\u01b0ng v\u1edbi s\u1ed1 l\u01b0\u1ee3ng h\u1eefu h\u1ea1n c\u00e1c h\u1ec7 s\u1ed1.</p> <p>Chu\u1ed7i l\u0169y th\u1eeba h\u00ecnh th\u1ee9c \u0111\u00f3ng m\u1ed9t vai tr\u00f2 quan tr\u1ecdng trong t\u1ed5 h\u1ee3p li\u1ec7t k\u00ea, n\u01a1i ch\u00fang \u0111\u01b0\u1ee3c nghi\u00ean c\u1ee9u nh\u01b0 l\u00e0 h\u00e0m sinh cho c\u00e1c d\u00e3y kh\u00e1c nhau. Th\u1eadt kh\u00f4ng may, gi\u1ea3i th\u00edch chi ti\u1ebft v\u1ec1 h\u00e0m sinh v\u00e0 tr\u1ef1c gi\u00e1c \u0111\u1eb1ng sau ch\u00fang s\u1ebd n\u1eb1m ngo\u00e0i ph\u1ea1m vi c\u1ee7a b\u00e0i vi\u1ebft n\u00e0y, do \u0111\u00f3 \u0111\u1ed9c gi\u1ea3 t\u00f2 m\u00f2 \u0111\u01b0\u1ee3c tham kh\u1ea3o v\u00ed d\u1ee5 t\u1ea1i \u0111\u00e2y \u0111\u1ec3 bi\u1ebft chi ti\u1ebft v\u1ec1 \u00fd ngh\u0129a t\u1ed5 h\u1ee3p c\u1ee7a ch\u00fang.</p> <p>Tuy nhi\u00ean, ch\u00fang t\u00f4i s\u1ebd \u0111\u1ec1 c\u1eadp r\u1ea5t ng\u1eafn g\u1ecdn r\u1eb1ng n\u1ebfu $A(x)$ v\u00e0 $B(x)$ l\u00e0 c\u00e1c h\u00e0m sinh cho c\u00e1c d\u00e3y li\u1ec7t k\u00ea m\u1ed9t s\u1ed1 v\u1eadt th\u1ec3 theo s\u1ed1 l\u01b0\u1ee3ng \"nguy\u00ean t\u1eed\" trong ch\u00fang (v\u00ed d\u1ee5: c\u00e2y theo s\u1ed1 l\u01b0\u1ee3ng \u0111\u1ec9nh), th\u00ec t\u00edch $A(x) B(x)$ li\u1ec7t k\u00ea c\u00e1c v\u1eadt th\u1ec3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 nh\u01b0 l\u00e0 c\u00e1c c\u1eb7p v\u1eadt th\u1ec3 c\u1ee7a lo\u1ea1i $A$ v\u00e0 $B$, li\u1ec7t k\u00ea theo t\u1ed5ng s\u1ed1 l\u01b0\u1ee3ng \"nguy\u00ean t\u1eed\" trong c\u1eb7p.</p> <p>V\u00ed d\u1ee5</p> <p>G\u1ecdi $A(x) = \\sum\\limits_{i=0}^\\infty 2^i x^i$ li\u1ec7t k\u00ea c\u00e1c g\u00f3i \u0111\u00e1, m\u1ed7i vi\u00ean \u0111\u00e1 \u0111\u01b0\u1ee3c t\u00f4 b\u1eb1ng m\u1ed9t trong $2$ m\u00e0u (v\u00ec v\u1eady, c\u00f3 $2^i$ g\u00f3i nh\u01b0 v\u1eady k\u00edch th\u01b0\u1edbc $i$) v\u00e0 $B(x) = \\sum\\limits_{j=0}^{\\infty} 3^j x^j$ li\u1ec7t k\u00ea c\u00e1c g\u00f3i \u0111\u00e1, m\u1ed7i vi\u00ean \u0111\u00e1 \u0111\u01b0\u1ee3c t\u00f4 b\u1eb1ng m\u1ed9t trong $3$ m\u00e0u. Khi \u0111\u00f3 $C(x) = A(x) B(x) = \\sum\\limits_{k=0}^\\infty c_k x^k$ s\u1ebd li\u1ec7t k\u00ea c\u00e1c v\u1eadt th\u1ec3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 l\u00e0 \"hai g\u00f3i \u0111\u00e1, g\u00f3i th\u1ee9 nh\u1ea5t ch\u1ec9 g\u1ed3m c\u00e1c vi\u00ean \u0111\u00e1 lo\u1ea1i $A$, g\u00f3i th\u1ee9 hai ch\u1ec9 g\u1ed3m c\u00e1c vi\u00ean \u0111\u00e1 lo\u1ea1i $B$, v\u1edbi t\u1ed5ng s\u1ed1 vi\u00ean \u0111\u00e1 l\u00e0 $k$\" cho $c_k$.</p> <p>T\u01b0\u01a1ng t\u1ef1, c\u00f3 m\u1ed9t \u00fd ngh\u0129a tr\u1ef1c quan \u0111\u1ed1i v\u1edbi m\u1ed9t s\u1ed1 h\u00e0m kh\u00e1c tr\u00ean chu\u1ed7i l\u0169y th\u1eeba h\u00ecnh th\u1ee9c.</p>","tags":["Original"]},{"location":"algebra/polynomial.html#long-polynomial-division","title":"Chia \u0111a th\u1ee9c (Long polynomial division)","text":"<p>T\u01b0\u01a1ng t\u1ef1 nh\u01b0 s\u1ed1 nguy\u00ean, c\u00f3 th\u1ec3 \u0111\u1ecbnh ngh\u0129a ph\u00e9p chia d\u00e0i tr\u00ean \u0111a th\u1ee9c.</p> <p>\u0110\u1ecbnh ngh\u0129a</p> <p>\u0110\u1ed1i v\u1edbi b\u1ea5t k\u1ef3 \u0111a th\u1ee9c $A$ v\u00e0 $B \\neq 0$ n\u00e0o, ng\u01b0\u1eddi ta c\u00f3 th\u1ec3 bi\u1ec3u di\u1ec5n $A$ d\u01b0\u1edbi d\u1ea1ng</p> $$ A = D \\cdot B + R,~ \\deg R &lt; \\deg B, $$ <p>trong \u0111\u00f3 $R$ \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 ph\u1ea7n d\u01b0 (remainder) c\u1ee7a $A$ modulo $B$ v\u00e0 $D$ \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 th\u01b0\u01a1ng (quotient).</p> <p>G\u1ecdi $\\deg A = n$ v\u00e0 $\\deg B = m$, c\u00e1ch ng\u00e2y th\u01a1 \u0111\u1ec3 l\u00e0m \u0111i\u1ec1u \u0111\u00f3 l\u00e0 s\u1eed d\u1ee5ng ph\u00e9p chia d\u00e0i, trong \u0111\u00f3 b\u1ea1n nh\u00e2n $B$ v\u1edbi \u0111\u01a1n th\u1ee9c $\\frac{a_n}{b_m} x^{n - m}$ v\u00e0 tr\u1eeb n\u00f3 kh\u1ecfi $A$, cho \u0111\u1ebfn khi b\u1eadc c\u1ee7a $A$ nh\u1ecf h\u01a1n b\u1eadc c\u1ee7a $B$. Nh\u1eefng g\u00ec c\u00f2n l\u1ea1i c\u1ee7a $A$ cu\u1ed1i c\u00f9ng s\u1ebd l\u00e0 ph\u1ea7n d\u01b0 (do \u0111\u00f3 c\u00f3 t\u00ean g\u1ecdi nh\u01b0 v\u1eady), v\u00e0 c\u00e1c \u0111a th\u1ee9c m\u00e0 b\u1ea1n \u0111\u00e3 nh\u00e2n $B$ trong qu\u00e1 tr\u00ecnh \u0111\u00f3, c\u1ed9ng l\u1ea1i v\u1edbi nhau, t\u1ea1o th\u00e0nh th\u01b0\u01a1ng.</p> <p>\u0110\u1ecbnh ngh\u0129a</p> <p>N\u1ebfu $A$ v\u00e0 $B$ c\u00f3 c\u00f9ng ph\u1ea7n d\u01b0 modulo $C$, ch\u00fang \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 t\u01b0\u01a1ng \u0111\u01b0\u01a1ng modulo $C$, \u0111\u01b0\u1ee3c k\u00fd hi\u1ec7u l\u00e0</p> $$ A \\equiv B \\pmod{C}. $$ <p>Ph\u00e9p chia \u0111a th\u1ee9c d\u00e0i h\u1eefu \u00edch v\u00ec nhi\u1ec1u t\u00ednh ch\u1ea5t quan tr\u1ecdng c\u1ee7a n\u00f3:</p> <ul> <li> <p>$A$ l\u00e0 b\u1ed9i c\u1ee7a $B$ khi v\u00e0 ch\u1ec9 khi $A \\equiv 0 \\pmod B$.</p> </li> <li> <p>N\u00f3 ng\u1ee5 \u00fd r\u1eb1ng $A \\equiv B \\pmod C$ khi v\u00e0 ch\u1ec9 khi $A-B$ l\u00e0 b\u1ed9i c\u1ee7a $C$.</p> </li> <li> <p>C\u1ee5 th\u1ec3, $A \\equiv B \\pmod{C \\cdot D}$ ng\u1ee5 \u00fd $A \\equiv B \\pmod{C}$.</p> </li> <li> <p>\u0110\u1ed1i v\u1edbi b\u1ea5t k\u1ef3 \u0111a th\u1ee9c tuy\u1ebfn t\u00ednh $x-r$ n\u00e0o, \u0111i\u1ec1u n\u00e0y gi\u1eef \u0111\u00fang $A(x) \\equiv A(r) \\pmod{x-r}$.</p> </li> <li> <p>N\u00f3 ng\u1ee5 \u00fd r\u1eb1ng $A$ l\u00e0 b\u1ed9i c\u1ee7a $x-r$ khi v\u00e0 ch\u1ec9 khi $A(r)=0$.</p> </li> <li> <p>\u0110\u1ed1i v\u1edbi modulo l\u00e0 $x^k$, \u0111i\u1ec1u n\u00e0y gi\u1eef \u0111\u00fang $A \\equiv a_0 + a_1 x + \\dots + a_{k-1} x^{k-1} \\pmod{x^k}$.</p> </li> </ul> <p>L\u01b0u \u00fd r\u1eb1ng ph\u00e9p chia d\u00e0i kh\u00f4ng th\u1ec3 \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a \u0111\u00fang cho chu\u1ed7i l\u0169y th\u1eeba h\u00ecnh th\u1ee9c. Thay v\u00e0o \u0111\u00f3, \u0111\u1ed1i v\u1edbi b\u1ea5t k\u1ef3 $A(x)$ n\u00e0o sao cho $a_0 \\neq 0$, c\u00f3 th\u1ec3 \u0111\u1ecbnh ngh\u0129a m\u1ed9t chu\u1ed7i l\u0169y th\u1eeba h\u00ecnh th\u1ee9c ngh\u1ecbch \u0111\u1ea3o $A^{-1}(x)$, sao cho $A(x) A^{-1}(x) = 1$. Th\u1ef1c t\u1ebf n\u00e0y, \u0111\u1ebfn l\u01b0\u1ee3t n\u00f3, c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 t\u00ednh k\u1ebft qu\u1ea3 c\u1ee7a ph\u00e9p chia d\u00e0i cho c\u00e1c \u0111a th\u1ee9c.</p>","tags":["Original"]},{"location":"algebra/polynomial.html#basic-implementation","title":"C\u00e0i \u0111\u1eb7t c\u01a1 b\u1ea3n (Basic implementation)","text":"<p>T\u1ea1i \u0111\u00e2y b\u1ea1n c\u00f3 th\u1ec3 t\u00ecm th\u1ea5y c\u00e0i \u0111\u1eb7t c\u01a1 b\u1ea3n c\u1ee7a \u0111\u1ea1i s\u1ed1 \u0111a th\u1ee9c.</p> <p>N\u00f3 h\u1ed7 tr\u1ee3 t\u1ea5t c\u1ea3 c\u00e1c ph\u00e9p to\u00e1n t\u1ea7m th\u01b0\u1eddng v\u00e0 m\u1ed9t s\u1ed1 ph\u01b0\u01a1ng th\u1ee9c h\u1eefu \u00edch kh\u00e1c. Class ch\u00ednh l\u00e0 <code>poly&lt;T&gt;</code> cho c\u00e1c \u0111a th\u1ee9c v\u1edbi c\u00e1c h\u1ec7 s\u1ed1 ki\u1ec3u <code>T</code>.</p> <p>T\u1ea5t c\u1ea3 c\u00e1c ph\u00e9p to\u00e1n s\u1ed1 h\u1ecdc <code>+</code>, <code>-</code>, <code>*</code>, <code>%</code> v\u00e0 <code>/</code> \u0111\u1ec1u \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3, <code>%</code> v\u00e0 <code>/</code> \u0111\u1ea1i di\u1ec7n cho ph\u1ea7n d\u01b0 v\u00e0 th\u01b0\u01a1ng trong ph\u00e9p chia Euclid.</p> <p>Ngo\u00e0i ra c\u00f2n c\u00f3 class <code>modular&lt;m&gt;</code> \u0111\u1ec3 th\u1ef1c hi\u1ec7n c\u00e1c ph\u00e9p to\u00e1n s\u1ed1 h\u1ecdc tr\u00ean c\u00e1c ph\u1ea7n d\u01b0 modulo m\u1ed9t s\u1ed1 nguy\u00ean t\u1ed1 <code>m</code>.</p> <p>C\u00e1c h\u00e0m h\u1eefu \u00edch kh\u00e1c:</p> <ul> <li><code>deriv()</code>: t\u00ednh \u0111\u1ea1o h\u00e0m $P'(x)$ c\u1ee7a $P(x)$.</li> <li><code>integr()</code>: t\u00ednh t\u00edch ph\u00e2n b\u1ea5t \u0111\u1ecbnh $Q(x) = \\int P(x)$ c\u1ee7a $P(x)$ sao cho $Q(0)=0$.</li> <li><code>inv(size_t n)</code>: t\u00ednh $n$ h\u1ec7 s\u1ed1 \u0111\u1ea7u ti\u00ean c\u1ee7a $P^{-1}(x)$ trong $O(n \\log n)$.</li> <li><code>log(size_t n)</code>: t\u00ednh $n$ h\u1ec7 s\u1ed1 \u0111\u1ea7u ti\u00ean c\u1ee7a $\\ln P(x)$ trong $O(n \\log n)$.</li> <li><code>exp(size_t n)</code>: t\u00ednh $n$ h\u1ec7 s\u1ed1 \u0111\u1ea7u ti\u00ean c\u1ee7a $\\exp P(x)$ trong $O(n \\log n)$.</li> <li><code>pow(size_t k, size_t n)</code>: t\u00ednh $n$ h\u1ec7 s\u1ed1 \u0111\u1ea7u ti\u00ean cho $P^{k}(x)$ trong $O(n \\log nk)$.</li> <li><code>deg()</code>: tr\u1ea3 v\u1ec1 b\u1eadc c\u1ee7a $P(x)$.</li> <li><code>lead()</code>: tr\u1ea3 v\u1ec1 h\u1ec7 s\u1ed1 c\u1ee7a $x^{\\deg P(x)}$.</li> <li><code>resultant(poly&lt;T&gt; a, poly&lt;T&gt; b)</code>: t\u00ednh k\u1ebft th\u1ee9c c\u1ee7a $a$ v\u00e0 $b$ trong $O(|a| \\cdot |b|)$.</li> <li><code>bpow(T x, size_t n)</code>: t\u00ednh $x^n$.</li> <li><code>bpow(T x, size_t n, T m)</code>: t\u00ednh $x^n \\pmod{m}$.</li> <li><code>chirpz(T z, size_t n)</code>: t\u00ednh $P(1), P(z), P(z^2), \\dots, P(z^{n-1})$ trong $O(n \\log n)$.</li> <li><code>vector&lt;T&gt; eval(vector&lt;T&gt; x)</code>: \u0111\u00e1nh gi\u00e1 $P(x_1), \\dots, P(x_n)$ trong $O(n \\log^2 n)$.</li> <li><code>poly&lt;T&gt; inter(vector&lt;T&gt; x, vector&lt;T&gt; y)</code>: n\u1ed9i suy m\u1ed9t \u0111a th\u1ee9c b\u1edfi m\u1ed9t t\u1eadp h\u1ee3p c\u00e1c c\u1eb7p $P(x_i) = y_i$ trong $O(n \\log^2 n)$.</li> <li>V\u00e0 nhi\u1ec1u h\u01a1n n\u1eefa, h\u00e3y tho\u1ea3i m\u00e1i kh\u00e1m ph\u00e1 m\u00e3!</li> </ul>","tags":["Original"]},{"location":"algebra/polynomial.html#arithmetic","title":"S\u1ed1 h\u1ecdc (Arithmetic)","text":"","tags":["Original"]},{"location":"algebra/polynomial.html#multiplication","title":"Ph\u00e9p nh\u00e2n (Multiplication)","text":"<p>Ph\u00e9p to\u00e1n c\u1ed1t l\u00f5i l\u00e0 ph\u00e9p nh\u00e2n c\u1ee7a hai \u0111a th\u1ee9c. Ngh\u0129a l\u00e0, cho c\u00e1c \u0111a th\u1ee9c $A$ v\u00e0 $B$:</p> $$A = a_0 + a_1 x + \\dots + a_n x^n$$ $$B = b_0 + b_1 x + \\dots + b_m x^m$$ <p>B\u1ea1n ph\u1ea3i t\u00ednh \u0111a th\u1ee9c $C = A \\cdot B$, \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a l\u00e0</p> $$\\boxed{C = \\sum\\limits_{i=0}^n \\sum\\limits_{j=0}^m a_i b_j x^{i+j}}  = c_0 + c_1 x + \\dots + c_{n+m} x^{n+m}.$$ <p>N\u00f3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ednh trong $O(n \\log n)$ th\u00f4ng qua Bi\u1ebfn \u0111\u1ed5i Fourier nhanh v\u00e0 h\u1ea7u nh\u01b0 t\u1ea5t c\u1ea3 c\u00e1c ph\u01b0\u01a1ng ph\u00e1p \u1edf \u0111\u00e2y s\u1ebd s\u1eed d\u1ee5ng n\u00f3 nh\u01b0 ch\u01b0\u01a1ng tr\u00ecnh con.</p>","tags":["Original"]},{"location":"algebra/polynomial.html#inverse-series","title":"Chu\u1ed7i ngh\u1ecbch \u0111\u1ea3o (Inverse series)","text":"<p>N\u1ebfu $A(0) \\neq 0$ lu\u00f4n t\u1ed3n t\u1ea1i m\u1ed9t chu\u1ed7i l\u0169y th\u1eeba h\u00ecnh th\u1ee9c v\u00f4 h\u1ea1n $A^{-1}(x) = q_0+q_1 x + q_2 x^2 + \\dots$ sao cho $A^{-1} A = 1$. Th\u01b0\u1eddng h\u1eefu \u00edch khi t\u00ednh $k$ h\u1ec7 s\u1ed1 \u0111\u1ea7u ti\u00ean c\u1ee7a $A^{-1}$ (ngh\u0129a l\u00e0, t\u00ednh n\u00f3 modulo $x^k$). C\u00f3 hai c\u00e1ch ch\u00ednh \u0111\u1ec3 t\u00ednh n\u00f3.</p>","tags":["Original"]},{"location":"algebra/polynomial.html#divide-and-conquer","title":"Chia \u0111\u1ec3 tr\u1ecb (Divide and conquer)","text":"<p>Thu\u1eadt to\u00e1n n\u00e0y \u0111\u00e3 \u0111\u01b0\u1ee3c \u0111\u1ec1 c\u1eadp trong b\u00e0i vi\u1ebft c\u1ee7a Sch\u00f6nhage v\u00e0 \u0111\u01b0\u1ee3c l\u1ea5y c\u1ea3m h\u1ee9ng t\u1eeb ph\u01b0\u01a1ng ph\u00e1p Graeffe. \u0110\u01b0\u1ee3c bi\u1ebft r\u1eb1ng \u0111\u1ed1i v\u1edbi $B(x)=A(x)A(-x)$ \u0111i\u1ec1u n\u00e0y gi\u1eef \u0111\u00fang $B(x)=B(-x)$, ngh\u0129a l\u00e0, $B(x)$ l\u00e0 m\u1ed9t \u0111a th\u1ee9c ch\u1eb5n. N\u00f3 c\u00f3 ngh\u0129a l\u00e0 n\u00f3 ch\u1ec9 c\u00f3 c\u00e1c h\u1ec7 s\u1ed1 kh\u00e1c kh\u00f4ng v\u1edbi s\u1ed1 m\u0169 ch\u1eb5n v\u00e0 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n d\u01b0\u1edbi d\u1ea1ng $B(x)=T(x^2)$. Do \u0111\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n chuy\u1ec3n \u0111\u1ed5i sau:</p> $$A^{-1}(x) \\equiv \\frac{1}{A(x)} \\equiv \\frac{A(-x)}{A(x)A(-x)} \\equiv \\frac{A(-x)}{T(x^2)} \\pmod{x^k}$$ <p>L\u01b0u \u00fd r\u1eb1ng $T(x)$ c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ednh b\u1eb1ng m\u1ed9t ph\u00e9p nh\u00e2n duy nh\u1ea5t, sau \u0111\u00f3 ch\u00fang ta ch\u1ec9 quan t\u00e2m \u0111\u1ebfn n\u1eeda \u0111\u1ea7u c\u1ee7a c\u00e1c h\u1ec7 s\u1ed1 c\u1ee7a chu\u1ed7i ngh\u1ecbch \u0111\u1ea3o c\u1ee7a n\u00f3. \u0110i\u1ec1u n\u00e0y l\u00e0m gi\u1ea3m hi\u1ec7u qu\u1ea3 b\u00e0i to\u00e1n ban \u0111\u1ea7u v\u1ec1 vi\u1ec7c t\u00ednh $A^{-1} \\pmod{x^k}$ th\u00e0nh t\u00ednh $T^{-1} \\pmod{x^{\\lceil k / 2 \\rceil}}$.</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a ph\u01b0\u01a1ng ph\u00e1p n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c \u01b0\u1edbc t\u00ednh l\u00e0</p> $$T(n) = T(n/2) + O(n \\log n) = O(n \\log n).$$","tags":["Original"]},{"location":"algebra/polynomial.html#sieveking-kung-algorithm","title":"Thu\u1eadt to\u00e1n Sieveking\u2013Kung (Sieveking\u2013Kung algorithm)","text":"<p>Quy tr\u00ecnh chung \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 \u1edf \u0111\u00e2y \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 n\u00e2ng Hensel (Hensel lifting), v\u00ec n\u00f3 tu\u00e2n theo b\u1ed5 \u0111\u1ec1 Hensel. Ch\u00fang t\u00f4i s\u1ebd \u0111\u1ec1 c\u1eadp chi ti\u1ebft h\u01a1n \u1edf ph\u1ea7n d\u01b0\u1edbi, nh\u01b0ng b\u00e2y gi\u1edd h\u00e3y t\u1eadp trung v\u00e0o gi\u1ea3i ph\u00e1p ad hoc. Ph\u1ea7n \"n\u00e2ng\" \u1edf \u0111\u00e2y c\u00f3 ngh\u0129a l\u00e0 ch\u00fang ta b\u1eaft \u0111\u1ea7u v\u1edbi x\u1ea5p x\u1ec9 $B_0=q_0=a_0^{-1}$, \u0111\u00f3 l\u00e0 $A^{-1} \\pmod x$ v\u00e0 sau \u0111\u00f3 l\u1eb7p \u0111i l\u1eb7p l\u1ea1i n\u00e2ng t\u1eeb $\\bmod x^a$ l\u00ean $\\bmod x^{2a}$.</p> <p>G\u1ecdi $B_k \\equiv A^{-1} \\pmod{x^a}$. X\u1ea5p x\u1ec9 ti\u1ebfp theo c\u1ea7n tu\u00e2n theo ph\u01b0\u01a1ng tr\u00ecnh $A B_{k+1} \\equiv 1 \\pmod{x^{2a}}$ v\u00e0 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n d\u01b0\u1edbi d\u1ea1ng $B_{k+1} = B_k + x^a C$. T\u1eeb \u0111\u00e2y suy ra ph\u01b0\u01a1ng tr\u00ecnh</p> $$A(B_k + x^{a}C) \\equiv 1 \\pmod{x^{2a}}.$$ <p>G\u1ecdi $A B_k \\equiv 1 + x^a D \\pmod{x^{2a}}$, th\u00ec ph\u01b0\u01a1ng tr\u00ecnh tr\u00ean ng\u1ee5 \u00fd</p> $$x^a(D+AC) \\equiv 0 \\pmod{x^{2a}} \\implies D \\equiv -AC \\pmod{x^a} \\implies C \\equiv -B_k D \\pmod{x^a}.$$ <p>T\u1eeb \u0111\u00e2y, ng\u01b0\u1eddi ta c\u00f3 th\u1ec3 thu \u0111\u01b0\u1ee3c c\u00f4ng th\u1ee9c cu\u1ed1i c\u00f9ng, \u0111\u00f3 l\u00e0</p> $$x^a C \\equiv -B_k x^a D  \\equiv B_k(1-AB_k) \\pmod{x^{2a}} \\implies \\boxed{B_{k+1} \\equiv B_k(2-AB_k) \\pmod{x^{2a}}}$$ <p>Do \u0111\u00f3 b\u1eaft \u0111\u1ea7u v\u1edbi $B_0 \\equiv a_0^{-1} \\pmod x$ ch\u00fang ta s\u1ebd t\u00ednh to\u00e1n d\u00e3y $B_k$ sao cho $AB_k \\equiv 1 \\pmod{x^{2^k}}$ v\u1edbi \u0111\u1ed9 ph\u1ee9c t\u1ea1p</p> $$T(n) = T(n/2) + O(n \\log n) = O(n \\log n).$$ <p>Thu\u1eadt to\u00e1n \u1edf \u0111\u00e2y c\u00f3 v\u1ebb ph\u1ee9c t\u1ea1p h\u01a1n m\u1ed9t ch\u00fat so v\u1edbi thu\u1eadt to\u00e1n \u0111\u1ea7u ti\u00ean, nh\u01b0ng n\u00f3 c\u00f3 m\u1ed9t l\u00fd lu\u1eadn r\u1ea5t v\u1eefng ch\u1eafc v\u00e0 th\u1ef1c t\u1ebf \u0111\u1eb1ng sau n\u00f3, c\u0169ng nh\u01b0 ti\u1ec1m n\u0103ng t\u1ed5ng qu\u00e1t h\u00f3a l\u1edbn n\u1ebfu nh\u00ecn t\u1eeb m\u1ed9t g\u00f3c \u0111\u1ed9 kh\u00e1c, s\u1ebd \u0111\u01b0\u1ee3c gi\u1ea3i th\u00edch th\u00eam \u1edf ph\u1ea7n d\u01b0\u1edbi.</p>","tags":["Original"]},{"location":"algebra/polynomial.html#euclidean-division","title":"Ph\u00e9p chia Euclid (Euclidean division)","text":"<p>X\u00e9t hai \u0111a th\u1ee9c $A(x)$ v\u00e0 $B(x)$ c\u00f3 b\u1eadc $n$ v\u00e0 $m$. Nh\u01b0 \u0111\u00e3 n\u00f3i tr\u01b0\u1edbc \u0111\u00f3, b\u1ea1n c\u00f3 th\u1ec3 vi\u1ebft l\u1ea1i $A(x)$ th\u00e0nh</p> $$A(x) = B(x) D(x) + R(x), \\deg R &lt; \\deg B.$$ <p>G\u1ecdi $n \\geq m$, n\u00f3 s\u1ebd ng\u1ee5 \u00fd r\u1eb1ng $\\deg D = n - m$ v\u00e0 $n-m+1$ h\u1ec7 s\u1ed1 d\u1eabn \u0111\u1ea7u c\u1ee7a $A$ kh\u00f4ng \u1ea3nh h\u01b0\u1edfng \u0111\u1ebfn $R$. N\u00f3 c\u00f3 ngh\u0129a l\u00e0 b\u1ea1n c\u00f3 th\u1ec3 kh\u00f4i ph\u1ee5c $D(x)$ t\u1eeb $n-m+1$ h\u1ec7 s\u1ed1 l\u1edbn nh\u1ea5t c\u1ee7a $A(x)$ v\u00e0 $B(x)$ n\u1ebfu b\u1ea1n coi n\u00f3 nh\u01b0 m\u1ed9t h\u1ec7 ph\u01b0\u01a1ng tr\u00ecnh.</p> <p>H\u1ec7 ph\u01b0\u01a1ng tr\u00ecnh tuy\u1ebfn t\u00ednh ch\u00fang ta \u0111ang n\u00f3i \u0111\u1ebfn c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c vi\u1ebft d\u01b0\u1edbi d\u1ea1ng sau:</p> $$\\begin{bmatrix} a_n \\\\ \\vdots \\\\ a_{m+1} \\\\ a_{m} \\end{bmatrix} = \\begin{bmatrix} b_m &amp; \\dots &amp; 0 &amp; 0 \\\\ \\vdots &amp; \\ddots &amp; \\vdots &amp; \\vdots \\\\ \\dots &amp; \\dots &amp; b_m &amp; 0 \\\\ \\dots &amp; \\dots &amp; b_{m-1} &amp; b_m \\end{bmatrix} \\begin{bmatrix}d_{n-m} \\\\ \\vdots \\\\ d_1 \\\\ d_0\\end{bmatrix}$$ <p>T\u1eeb v\u1ebb ngo\u00e0i c\u1ee7a n\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 k\u1ebft lu\u1eadn r\u1eb1ng v\u1edbi s\u1ef1 ra \u0111\u1eddi c\u1ee7a c\u00e1c \u0111a th\u1ee9c \u0111\u1ea3o ng\u01b0\u1ee3c</p> $$A^R(x) = x^nA(x^{-1})= a_n + a_{n-1} x + \\dots + a_0 x^n$$ $$B^R(x) = x^m B(x^{-1}) = b_m + b_{m-1} x + \\dots + b_0 x^m$$ $$D^R(x) = x^{n-m}D(x^{-1}) = d_{n-m} + d_{n-m-1} x + \\dots + d_0 x^{n-m}$$ <p>h\u1ec7 th\u1ed1ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c vi\u1ebft l\u1ea1i th\u00e0nh</p> $$A^R(x) \\equiv B^R(x) D^R(x) \\pmod{x^{n-m+1}}.$$ <p>T\u1eeb \u0111\u00e2y b\u1ea1n c\u00f3 th\u1ec3 kh\u00f4i ph\u1ee5c t\u1ea5t c\u1ea3 c\u00e1c h\u1ec7 s\u1ed1 c\u1ee7a $D(x)$ m\u1ed9t c\u00e1ch r\u00f5 r\u00e0ng:</p> $$\\boxed{D^R(x) \\equiv A^R(x) (B^R(x))^{-1} \\pmod{x^{n-m+1}}}$$ <p>V\u00e0 t\u1eeb \u0111\u00e2y, \u0111\u1ebfn l\u01b0\u1ee3t n\u00f3, b\u1ea1n c\u00f3 th\u1ec3 kh\u00f4i ph\u1ee5c $R(x)$ d\u01b0\u1edbi d\u1ea1ng $R(x) = A(x) - B(x)D(x)$.</p> <p>L\u01b0u \u00fd r\u1eb1ng ma tr\u1eadn \u1edf tr\u00ean \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 ma tr\u1eadn Toeplitz tam gi\u00e1c v\u00e0, nh\u01b0 ch\u00fang ta th\u1ea5y \u1edf \u0111\u00e2y, vi\u1ec7c gi\u1ea3i h\u1ec7 ph\u01b0\u01a1ng tr\u00ecnh tuy\u1ebfn t\u00ednh v\u1edbi ma tr\u1eadn Toeplitz t\u00f9y \u00fd, th\u1ef1c t\u1ebf, t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi ph\u00e9p \u0111\u1ea3o ng\u01b0\u1ee3c \u0111a th\u1ee9c. H\u01a1n n\u1eefa, ma tr\u1eadn ngh\u1ecbch \u0111\u1ea3o c\u1ee7a n\u00f3 c\u0169ng s\u1ebd l\u00e0 ma tr\u1eadn Toeplitz tam gi\u00e1c v\u00e0 c\u00e1c m\u1ee5c c\u1ee7a n\u00f3, theo thu\u1eadt ng\u1eef \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u1edf tr\u00ean, l\u00e0 c\u00e1c h\u1ec7 s\u1ed1 c\u1ee7a $(B^R(x))^{-1} \\pmod{x^{n-m+1}}$.</p>","tags":["Original"]},{"location":"algebra/polynomial.html#calculating-functions-of-polynomial","title":"T\u00ednh to\u00e1n c\u00e1c h\u00e0m c\u1ee7a \u0111a th\u1ee9c (Calculating functions of polynomial)","text":"","tags":["Original"]},{"location":"algebra/polynomial.html#newtons-method","title":"Ph\u01b0\u01a1ng ph\u00e1p Newton (Newton's method)","text":"<p>H\u00e3y t\u1ed5ng qu\u00e1t h\u00f3a thu\u1eadt to\u00e1n Sieveking\u2013Kung. X\u00e9t ph\u01b0\u01a1ng tr\u00ecnh $F(P) = 0$ trong \u0111\u00f3 $P(x)$ ph\u1ea3i l\u00e0 m\u1ed9t \u0111a th\u1ee9c v\u00e0 $F(x)$ l\u00e0 m\u1ed9t h\u00e0m gi\u00e1 tr\u1ecb \u0111a th\u1ee9c n\u00e0o \u0111\u00f3 \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a l\u00e0</p> $$F(x) = \\sum\\limits_{i=0}^\\infty \\alpha_i (x-\\beta)^i,$$ <p>trong \u0111\u00f3 $\\beta$ l\u00e0 m\u1ed9t h\u1eb1ng s\u1ed1 n\u00e0o \u0111\u00f3. C\u00f3 th\u1ec3 ch\u1ee9ng minh r\u1eb1ng n\u1ebfu ch\u00fang ta gi\u1edbi thi\u1ec7u m\u1ed9t bi\u1ebfn h\u00ecnh th\u1ee9c m\u1edbi $y$, ch\u00fang ta c\u00f3 th\u1ec3 bi\u1ec3u di\u1ec5n $F(x)$ d\u01b0\u1edbi d\u1ea1ng</p> $$F(x) = F(y) + (x-y)F'(y) + (x-y)^2 G(x,y),$$ <p>trong \u0111\u00f3 $F'(x)$ l\u00e0 chu\u1ed7i l\u0169y th\u1eeba h\u00ecnh th\u1ee9c \u0111\u1ea1o h\u00e0m \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a l\u00e0</p> $$F'(x) = \\sum\\limits_{i=0}^\\infty (i+1)\\alpha_{i+1}(x-\\beta)^i,$$ <p>v\u00e0 $G(x, y)$ l\u00e0 m\u1ed9t chu\u1ed7i l\u0169y th\u1eeba h\u00ecnh th\u1ee9c n\u00e0o \u0111\u00f3 c\u1ee7a $x$ v\u00e0 $y$. V\u1edbi k\u1ebft qu\u1ea3 n\u00e0y, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm nghi\u1ec7m l\u1eb7p \u0111i l\u1eb7p l\u1ea1i.</p> <p>G\u1ecdi $F(Q_k) \\equiv 0 \\pmod{x^{a}}$. Ch\u00fang ta c\u1ea7n t\u00ecm $Q_{k+1} \\equiv Q_k + x^a C \\pmod{x^{2a}}$ sao cho $F(Q_{k+1}) \\equiv 0 \\pmod{x^{2a}}$.</p> <p>Thay th\u1ebf $x = Q_{k+1}$ v\u00e0 $y=Q_k$ trong c\u00f4ng th\u1ee9c tr\u00ean, ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c</p> $$F(Q_{k+1}) \\equiv F(Q_k) + (Q_{k+1} - Q_k) F'(Q_k) + (Q_{k+1} - Q_k)^2 G(x, y) \\pmod x^{2a}.$$ <p>V\u00ec $Q_{k+1} - Q_k \\equiv 0 \\pmod{x^a}$, \u0111i\u1ec1u \u0111\u00f3 c\u0169ng gi\u1eef \u0111\u00fang r\u1eb1ng $(Q_{k+1} - Q_k)^2 \\equiv 0 \\pmod{x^{2a}}$, do \u0111\u00f3</p> $$0 \\equiv F(Q_{k+1}) \\equiv F(Q_k) + (Q_{k+1} - Q_k) F'(Q_k) \\pmod{x^{2a}}.$$ <p>C\u00f4ng th\u1ee9c cu\u1ed1i c\u00f9ng cho ch\u00fang ta gi\u00e1 tr\u1ecb c\u1ee7a $Q_{k+1}$:</p> $$\\boxed{Q_{k+1} = Q_k - \\dfrac{F(Q_k)}{F'(Q_k)} \\pmod{x^{2a}}}$$ <p>Do \u0111\u00f3, bi\u1ebft c\u00e1ch \u0111\u1ea3o ng\u01b0\u1ee3c \u0111a th\u1ee9c v\u00e0 c\u00e1ch t\u00ednh $F(Q_k)$, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm $n$ h\u1ec7 s\u1ed1 c\u1ee7a $P$ v\u1edbi \u0111\u1ed9 ph\u1ee9c t\u1ea1p</p> $$T(n) = T(n/2) + f(n),$$ <p>trong \u0111\u00f3 $f(n)$ l\u00e0 th\u1eddi gian c\u1ea7n thi\u1ebft \u0111\u1ec3 t\u00ednh $F(Q_k)$ v\u00e0 $F'(Q_k)^{-1}$ th\u01b0\u1eddng l\u00e0 $O(n \\log n)$.</p> <p>Quy t\u1eafc l\u1eb7p tr\u00ean \u0111\u01b0\u1ee3c g\u1ecdi trong ph\u00e2n t\u00edch s\u1ed1 l\u00e0 Ph\u01b0\u01a1ng ph\u00e1p Newton.</p>","tags":["Original"]},{"location":"algebra/polynomial.html#hensels-lemma","title":"B\u1ed5 \u0111\u1ec1 Hensel (Hensel's lemma)","text":"<p>Nh\u01b0 \u0111\u00e3 \u0111\u1ec1 c\u1eadp tr\u01b0\u1edbc \u0111\u00f3, v\u1ec1 m\u1eb7t h\u00ecnh th\u1ee9c v\u00e0 t\u1ed5ng qu\u00e1t k\u1ebft qu\u1ea3 n\u00e0y \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 B\u1ed5 \u0111\u1ec1 Hensel v\u00e0 n\u00f3 th\u1ef1c t\u1ebf c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng theo ngh\u0129a r\u1ed9ng h\u01a1n n\u1eefa khi ch\u00fang ta l\u00e0m vi\u1ec7c v\u1edbi m\u1ed9t chu\u1ed7i c\u00e1c v\u00e0nh l\u1ed3ng nhau. Trong tr\u01b0\u1eddng h\u1ee3p c\u1ee5 th\u1ec3 n\u00e0y, ch\u00fang ta \u0111\u00e3 l\u00e0m vi\u1ec7c v\u1edbi m\u1ed9t chu\u1ed7i c\u00e1c ph\u1ea7n d\u01b0 \u0111a th\u1ee9c modulo $x$, $x^2$, $x^3$, v.v.</p> <p>M\u1ed9t v\u00ed d\u1ee5 kh\u00e1c m\u00e0 vi\u1ec7c n\u00e2ng Hensel c\u00f3 th\u1ec3 h\u1eefu \u00edch l\u00e0 c\u00e1i g\u1ecdi l\u00e0 s\u1ed1 p-adic n\u01a1i ch\u00fang ta, th\u1ef1c t\u1ebf, l\u00e0m vi\u1ec7c v\u1edbi d\u00e3y c\u00e1c ph\u1ea7n d\u01b0 s\u1ed1 nguy\u00ean modulo $p$, $p^2$, $p^3$, v.v. V\u00ed d\u1ee5, ph\u01b0\u01a1ng ph\u00e1p Newton c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 t\u1ef1 \u0111\u1ed3ng c\u1ea5u (automorphic numbers) (c\u00e1c s\u1ed1 c\u00f3 t\u1eadn c\u00f9ng l\u00e0 ch\u00ednh n\u00f3 khi b\u00ecnh ph\u01b0\u01a1ng) v\u1edbi m\u1ed9t c\u01a1 s\u1ed1 \u0111\u00e3 cho. B\u00e0i to\u00e1n \u0111\u01b0\u1ee3c \u0111\u1ec3 l\u1ea1i nh\u01b0 m\u1ed9t b\u00e0i t\u1eadp cho ng\u01b0\u1eddi \u0111\u1ecdc. B\u1ea1n c\u00f3 th\u1ec3 xem x\u00e9t b\u00e0i to\u00e1n n\u00e0y \u0111\u1ec3 ki\u1ec3m tra xem gi\u1ea3i ph\u00e1p c\u1ee7a b\u1ea1n c\u00f3 ho\u1ea1t \u0111\u1ed9ng cho c\u00e1c s\u1ed1 c\u01a1 s\u1ed1 $10$ hay kh\u00f4ng.</p>","tags":["Original"]},{"location":"algebra/polynomial.html#logarithm","title":"Logarit (Logarithm)","text":"<p>\u0110\u1ed1i v\u1edbi h\u00e0m $\\ln P(x)$ \u0111\u01b0\u1ee3c bi\u1ebft r\u1eb1ng: </p> $$ \\boxed{(\\ln P(x))' = \\dfrac{P'(x)}{P(x)}} $$ <p>Do \u0111\u00f3 ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh $n$ h\u1ec7 s\u1ed1 c\u1ee7a $\\ln P(x)$ trong $O(n \\log n)$.</p>","tags":["Original"]},{"location":"algebra/polynomial.html#inverse-series-1","title":"Chu\u1ed7i ngh\u1ecbch \u0111\u1ea3o (Inverse series)","text":"<p>Turns out, ch\u00fang ta c\u00f3 th\u1ec3 nh\u1eadn \u0111\u01b0\u1ee3c c\u00f4ng th\u1ee9c cho $A^{-1}$ b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng ph\u01b0\u01a1ng ph\u00e1p Newton. \u0110\u1ed1i v\u1edbi \u0111i\u1ec1u n\u00e0y ch\u00fang ta l\u1ea5y ph\u01b0\u01a1ng tr\u00ecnh $A=Q^{-1}$, do \u0111\u00f3:</p> $$F(Q) = Q^{-1} - A$$ $$F'(Q) = -Q^{-2}$$ $$\\boxed{Q_{k+1} \\equiv Q_k(2-AQ_k) \\pmod{x^{2^{k+1}}}}$$","tags":["Original"]},{"location":"algebra/polynomial.html#exponent","title":"H\u00e0m m\u0169 (Exponent)","text":"<p>H\u00e3y t\u00ecm hi\u1ec3u c\u00e1ch t\u00ednh $e^{P(x)}=Q(x)$. \u0110i\u1ec1u \u0111\u00f3 ph\u1ea3i gi\u1eef \u0111\u00fang r\u1eb1ng $\\ln Q = P$, do \u0111\u00f3:</p> $$F(Q) = \\ln Q - P$$ $$F'(Q) = Q^{-1}$$ $$\\boxed{Q_{k+1} \\equiv Q_k(1 + P - \\ln Q_k) \\pmod{x^{2^{k+1}}}}$$","tags":["Original"]},{"location":"algebra/polynomial.html#k-th-power","title":"L\u0169y th\u1eeba th\u1ee9 $k$ ($k$-th power)","text":"<p>B\u00e2y gi\u1edd ch\u00fang ta c\u1ea7n t\u00ednh $P^k(x)=Q$. \u0110i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n th\u00f4ng qua c\u00f4ng th\u1ee9c sau:</p> $$Q = \\exp\\left[k \\ln P(x)\\right]$$ <p>Tuy nhi\u00ean h\u00e3y l\u01b0u \u00fd r\u1eb1ng, b\u1ea1n c\u00f3 th\u1ec3 t\u00ednh logarit v\u00e0 h\u00e0m m\u0169 m\u1ed9t c\u00e1ch ch\u00ednh x\u00e1c ch\u1ec9 khi b\u1ea1n c\u00f3 th\u1ec3 t\u00ecm th\u1ea5y m\u1ed9t s\u1ed1 $Q_0$ ban \u0111\u1ea7u.</p> <p>\u0110\u1ec3 t\u00ecm n\u00f3, b\u1ea1n n\u00ean t\u00ednh logarit ho\u1eb7c h\u00e0m m\u0169 c\u1ee7a h\u1ec7 s\u1ed1 h\u1eb1ng s\u1ed1 c\u1ee7a \u0111a th\u1ee9c.</p> <p>Nh\u01b0ng c\u00e1ch h\u1ee3p l\u00fd duy nh\u1ea5t \u0111\u1ec3 l\u00e0m \u0111i\u1ec1u \u0111\u00f3 l\u00e0 n\u1ebfu $P(0)=1$ cho $Q = \\ln P$ \u0111\u1ec3 $Q(0)=0$ v\u00e0 n\u1ebfu $P(0)=0$ cho $Q = e^P$ \u0111\u1ec3 $Q(0)=1$.</p> <p>Do \u0111\u00f3 b\u1ea1n c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng c\u00f4ng th\u1ee9c tr\u00ean ch\u1ec9 n\u1ebfu $P(0) = 1$. N\u1ebfu kh\u00f4ng, n\u1ebfu $P(x) = \\alpha x^t T(x)$ trong \u0111\u00f3 $T(0)=1$ b\u1ea1n c\u00f3 th\u1ec3 vi\u1ebft r\u1eb1ng:</p> $$\\boxed{P^k(x) = \\alpha^kx^{kt} \\exp[k \\ln T(x)]}$$ <p>L\u01b0u \u00fd r\u1eb1ng b\u1ea1n c\u0169ng c\u00f3 th\u1ec3 t\u00ednh m\u1ed9t s\u1ed1 c\u0103n b\u1eadc $k$ c\u1ee7a m\u1ed9t \u0111a th\u1ee9c n\u1ebfu b\u1ea1n c\u00f3 th\u1ec3 t\u00ednh $\\sqrt[k]{\\alpha}$, v\u00ed d\u1ee5 cho $\\alpha=1$.</p>","tags":["Original"]},{"location":"algebra/polynomial.html#evaluation-and-interpolation","title":"\u0110\u00e1nh gi\u00e1 v\u00e0 N\u1ed9i suy (Evaluation and Interpolation)","text":"","tags":["Original"]},{"location":"algebra/polynomial.html#chirp-z-transform","title":"Bi\u1ebfn \u0111\u1ed5i Chirp-z (Chirp-z Transform)","text":"<p>\u0110\u1ed1i v\u1edbi tr\u01b0\u1eddng h\u1ee3p c\u1ee5 th\u1ec3 khi b\u1ea1n c\u1ea7n \u0111\u00e1nh gi\u00e1 m\u1ed9t \u0111a th\u1ee9c t\u1ea1i c\u00e1c \u0111i\u1ec3m $x_r = z^{2r}$ b\u1ea1n c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n nh\u1eefng \u0111i\u1ec1u sau:</p> $$A(z^{2r}) = \\sum\\limits_{k=0}^n a_k z^{2kr}$$ <p>H\u00e3y thay th\u1ebf $2kr = r^2+k^2-(r-k)^2$. Khi \u0111\u00f3 t\u1ed5ng n\u00e0y vi\u1ebft l\u1ea1i th\u00e0nh:</p> $$\\boxed{A(z^{2r}) = z^{r^2}\\sum\\limits_{k=0}^n (a_k z^{k^2}) z^{-(r-k)^2}}$$ <p>\u0110i\u1ec1u n\u00e0y l\u00ean \u0111\u1ebfn h\u1ec7 s\u1ed1 $z^{r^2}$ b\u1eb1ng v\u1edbi t\u00edch ch\u1eadp c\u1ee7a c\u00e1c d\u00e3y $u_k = a_k z^{k^2}$ v\u00e0 $v_k = z^{-k^2}$.</p> <p>L\u01b0u \u00fd r\u1eb1ng $u_k$ c\u00f3 ch\u1ec9 s\u1ed1 t\u1eeb $0$ \u0111\u1ebfn $n$ \u1edf \u0111\u00e2y v\u00e0 $v_k$ c\u00f3 ch\u1ec9 s\u1ed1 t\u1eeb $-n$ \u0111\u1ebfn $m$ trong \u0111\u00f3 $m$ l\u00e0 l\u0169y th\u1eeba t\u1ed1i \u0111a c\u1ee7a $z$ m\u00e0 b\u1ea1n c\u1ea7n.</p> <p>B\u00e2y gi\u1edd n\u1ebfu b\u1ea1n c\u1ea7n \u0111\u00e1nh gi\u00e1 m\u1ed9t \u0111a th\u1ee9c t\u1ea1i c\u00e1c \u0111i\u1ec3m $x_r = z^{2r+1}$ b\u1ea1n c\u00f3 th\u1ec3 gi\u1ea3m n\u00f3 v\u1ec1 nhi\u1ec7m v\u1ee5 tr\u01b0\u1edbc \u0111\u00f3 b\u1eb1ng bi\u1ebfn \u0111\u1ed5i $a_k \\to a_k z^k$.</p> <p>N\u00f3 cung c\u1ea5p cho ch\u00fang ta m\u1ed9t thu\u1eadt to\u00e1n $O(n \\log n)$ khi b\u1ea1n c\u1ea7n t\u00ednh to\u00e1n c\u00e1c gi\u00e1 tr\u1ecb trong l\u0169y th\u1eeba c\u1ee7a $z$, do \u0111\u00f3 b\u1ea1n c\u00f3 th\u1ec3 t\u00ednh DFT cho c\u00e1c l\u0169y th\u1eeba kh\u00f4ng ph\u1ea3i l\u00e0 hai.</p> <p>M\u1ed9t quan s\u00e1t kh\u00e1c l\u00e0 $kr = \\binom{k+r}{2} - \\binom{k}{2} - \\binom{r}{2}$. Khi \u0111\u00f3 ch\u00fang ta c\u00f3</p> $$\\boxed{A(z^r) = z^{-\\binom{r}{2}}\\sum\\limits_{k=0}^n \\left(a_k z^{-\\binom{k}{2}}\\right)z^{\\binom{k+r}{2}}}$$ <p>H\u1ec7 s\u1ed1 c\u1ee7a $x^{n+r}$ c\u1ee7a t\u00edch c\u1ee7a c\u00e1c \u0111a th\u1ee9c $A_0(x) = \\sum\\limits_{k=0}^n a_{n-k}z^{-\\binom{n-k}{2}}x^k$ v\u00e0 $A_1(x) = \\sum\\limits_{k\\geq 0}z^{\\binom{k}{2}}x^k$ b\u1eb1ng $z^{\\binom{r}{2}}A(z^r)$. B\u1ea1n c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng c\u00f4ng th\u1ee9c $z^{\\binom{k+1}{2}}=z^{\\binom{k}{2}+k}$ \u0111\u1ec3 t\u00ednh c\u00e1c h\u1ec7 s\u1ed1 c\u1ee7a $A_0(x)$ v\u00e0 $A_1(x)$.</p>","tags":["Original"]},{"location":"algebra/polynomial.html#multi-point-evaluation","title":"\u0110\u00e1nh gi\u00e1 \u0111a \u0111i\u1ec3m (Multi-point Evaluation)","text":"<p>Gi\u1ea3 s\u1eed b\u1ea1n c\u1ea7n t\u00ednh $A(x_1), \\dots, A(x_n)$. Nh\u01b0 \u0111\u00e3 \u0111\u1ec1 c\u1eadp tr\u01b0\u1edbc \u0111\u00f3, $A(x) \\equiv A(x_i) \\pmod{x-x_i}$. Do \u0111\u00f3 b\u1ea1n c\u00f3 th\u1ec3 l\u00e0m nh\u01b0 sau:</p> <ol> <li>T\u00ednh m\u1ed9t c\u00e2y ph\u00e2n \u0111o\u1ea1n sao cho trong \u0111o\u1ea1n $[l,r)$ ch\u1ee9a t\u00edch $P_{l, r}(x) = (x-x_l)(x-x_{l+1})\\dots(x-x_{r-1})$.</li> <li>B\u1eaft \u0111\u1ea7u v\u1edbi $l=1$ v\u00e0 $r=n+1$ t\u1ea1i n\u00fat g\u1ed1c. G\u1ecdi $m=\\lfloor(l+r)/2\\rfloor$. H\u00e3y di chuy\u1ec3n xu\u1ed1ng $[l,m)$ v\u1edbi \u0111a th\u1ee9c $A(x) \\pmod{P_{l,m}(x)}$.</li> <li>\u0110i\u1ec1u n\u00e0y s\u1ebd t\u00ednh to\u00e1n \u0111\u1ec7 quy $A(x_l), \\dots, A(x_{m-1})$, b\u00e2y gi\u1edd l\u00e0m t\u01b0\u01a1ng t\u1ef1 cho $[m,r)$ v\u1edbi $A(x) \\pmod{P_{m,r}(x)}$.</li> <li>N\u1ed1i c\u00e1c k\u1ebft qu\u1ea3 t\u1eeb cu\u1ed9c g\u1ecdi \u0111\u1ec7 quy th\u1ee9 nh\u1ea5t v\u00e0 th\u1ee9 hai v\u00e0 tr\u1ea3 v\u1ec1 ch\u00fang.</li> </ol> <p>To\u00e0n b\u1ed9 quy tr\u00ecnh s\u1ebd ch\u1ea1y trong $O(n \\log^2 n)$.</p>","tags":["Original"]},{"location":"algebra/polynomial.html#interpolation","title":"N\u1ed9i suy (Interpolation)","text":"<p>C\u00f3 m\u1ed9t c\u00f4ng th\u1ee9c tr\u1ef1c ti\u1ebfp c\u1ee7a Lagrange \u0111\u1ec3 n\u1ed9i suy m\u1ed9t \u0111a th\u1ee9c, cho t\u1eadp h\u1ee3p c\u00e1c c\u1eb7p $(x_i, y_i)$:</p> $$\\boxed{A(x) = \\sum\\limits_{i=1}^n y_i \\prod\\limits_{j \\neq i}\\dfrac{x-x_j}{x_i - x_j}}$$ <p>T\u00ednh to\u00e1n tr\u1ef1c ti\u1ebfp n\u00f3 l\u00e0 m\u1ed9t \u0111i\u1ec1u kh\u00f3 nh\u01b0ng h\u00f3a ra, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh n\u00f3 trong $O(n \\log^2 n)$ v\u1edbi c\u00e1ch ti\u1ebfp c\u1eadn chia \u0111\u1ec3 tr\u1ecb:</p> <p>X\u00e9t $P(x) = (x-x_1)\\dots(x-x_n)$. \u0110\u1ec3 bi\u1ebft c\u00e1c h\u1ec7 s\u1ed1 c\u1ee7a c\u00e1c m\u1eabu s\u1ed1 trong $A(x)$ ch\u00fang ta n\u00ean t\u00ednh c\u00e1c t\u00edch nh\u01b0: </p> $$ P_i = \\prod\\limits_{j \\neq i} (x_i-x_j) $$ <p>Nh\u01b0ng n\u1ebfu b\u1ea1n xem x\u00e9t \u0111\u1ea1o h\u00e0m $P'(x)$ b\u1ea1n s\u1ebd th\u1ea5y r\u1eb1ng $P'(x_i) = P_i$. Do \u0111\u00f3 b\u1ea1n c\u00f3 th\u1ec3 t\u00ednh $P_i$ th\u00f4ng qua \u0111\u00e1nh gi\u00e1 trong $O(n \\log^2 n)$.</p> <p>B\u00e2y gi\u1edd h\u00e3y xem x\u00e9t thu\u1eadt to\u00e1n \u0111\u1ec7 quy \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n tr\u00ean c\u00f9ng m\u1ed9t c\u00e2y ph\u00e2n \u0111o\u1ea1n nh\u01b0 trong \u0111\u00e1nh gi\u00e1 \u0111a \u0111i\u1ec3m. N\u00f3 b\u1eaft \u0111\u1ea7u \u1edf c\u00e1c l\u00e1 v\u1edbi gi\u00e1 tr\u1ecb $\\dfrac{y_i}{P_i}$ trong m\u1ed7i l\u00e1.</p> <p>Khi ch\u00fang ta quay tr\u1edf l\u1ea1i t\u1eeb \u0111\u1ec7 quy, ch\u00fang ta n\u00ean h\u1ee3p nh\u1ea5t c\u00e1c k\u1ebft qu\u1ea3 t\u1eeb c\u00e1c \u0111\u1ec9nh b\u00ean tr\u00e1i v\u00e0 b\u00ean ph\u1ea3i d\u01b0\u1edbi d\u1ea1ng $A_{l,r} = A_{l,m}P_{m,r} + P_{l,m} A_{m,r}$.</p> <p>Theo c\u00e1ch n\u00e0y khi b\u1ea1n quay l\u1ea1i g\u1ed1c, b\u1ea1n s\u1ebd c\u00f3 ch\u00ednh x\u00e1c $A(x)$ trong \u0111\u00f3. To\u00e0n b\u1ed9 quy tr\u00ecnh c\u0169ng ho\u1ea1t \u0111\u1ed9ng trong $O(n \\log^2 n)$.</p>","tags":["Original"]},{"location":"algebra/polynomial.html#gcd-and-resultants","title":"GCD v\u00e0 K\u1ebft th\u1ee9c (GCD and Resultants)","text":"<p>Gi\u1ea3 s\u1eed b\u1ea1n \u0111\u01b0\u1ee3c cho c\u00e1c \u0111a th\u1ee9c $A(x) = a_0 + a_1 x + \\dots + a_n x^n$ v\u00e0 $B(x) = b_0 + b_1 x + \\dots + b_m x^m$.</p> <p>G\u1ecdi $\\lambda_0, \\dots, \\lambda_n$ l\u00e0 c\u00e1c nghi\u1ec7m c\u1ee7a $A(x)$ v\u00e0 g\u1ecdi $\\mu_0, \\dots, \\mu_m$ l\u00e0 c\u00e1c nghi\u1ec7m c\u1ee7a $B(x)$ \u0111\u01b0\u1ee3c t\u00ednh v\u1edbi s\u1ed1 b\u1ed9i c\u1ee7a ch\u00fang.</p> <p>B\u1ea1n mu\u1ed1n bi\u1ebft li\u1ec7u $A(x)$ v\u00e0 $B(x)$ c\u00f3 b\u1ea5t k\u1ef3 nghi\u1ec7m n\u00e0o chung hay kh\u00f4ng. C\u00f3 hai c\u00e1ch li\u00ean k\u1ebft v\u1edbi nhau \u0111\u1ec3 l\u00e0m \u0111i\u1ec1u \u0111\u00f3.</p>","tags":["Original"]},{"location":"algebra/polynomial.html#euclidean-algorithm","title":"Thu\u1eadt to\u00e1n Euclid (Euclidean algorithm)","text":"<p>Ch\u00e0, ch\u00fang t\u00f4i \u0111\u00e3 c\u00f3 m\u1ed9t b\u00e0i vi\u1ebft v\u1ec1 n\u00f3. \u0110\u1ed1i v\u1edbi m\u1ed9t mi\u1ec1n t\u00f9y \u00fd, b\u1ea1n c\u00f3 th\u1ec3 vi\u1ebft thu\u1eadt to\u00e1n Euclid d\u1ec5 d\u00e0ng nh\u01b0:</p> <pre><code>template&lt;typename T&gt;\nT gcd(const T &amp;a, const T &amp;b) {\n    return b == T(0) ? a : gcd(b, a % b);\n}\n</code></pre> <p>C\u00f3 th\u1ec3 ch\u1ee9ng minh r\u1eb1ng \u0111\u1ed1i v\u1edbi c\u00e1c \u0111a th\u1ee9c $A(x)$ v\u00e0 $B(x)$, n\u00f3 s\u1ebd ho\u1ea1t \u0111\u1ed9ng trong $O(nm)$.</p>","tags":["Original"]},{"location":"algebra/polynomial.html#resultant","title":"K\u1ebft th\u1ee9c (Resultant)","text":"<p>H\u00e3y t\u00ednh t\u00edch $A(\\mu_0)\\cdots A(\\mu_m)$. N\u00f3 s\u1ebd b\u1eb1ng kh\u00f4ng khi v\u00e0 ch\u1ec9 khi m\u1ed9t s\u1ed1 $\\mu_i$ l\u00e0 nghi\u1ec7m c\u1ee7a $A(x)$.</p> <p>\u0110\u1ec3 \u0111\u1ed1i x\u1ee9ng, ch\u00fang ta c\u0169ng c\u00f3 th\u1ec3 nh\u00e2n n\u00f3 v\u1edbi $b_m^n$ v\u00e0 vi\u1ebft l\u1ea1i to\u00e0n b\u1ed9 t\u00edch d\u01b0\u1edbi d\u1ea1ng sau:</p> $$\\boxed{\\mathcal{R}(A, B) = b_m^n\\prod\\limits_{j=0}^m A(\\mu_j) = b_m^n a_m^n \\prod\\limits_{i=0}^n \\prod\\limits_{j=0}^m (\\mu_j - \\lambda_i)= (-1)^{mn}a_n^m \\prod\\limits_{i=0}^n B(\\lambda_i)}$$ <p>Gi\u00e1 tr\u1ecb \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a \u1edf tr\u00ean \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 k\u1ebft th\u1ee9c c\u1ee7a c\u00e1c \u0111a th\u1ee9c $A(x)$ v\u00e0 $B(x)$. T\u1eeb \u0111\u1ecbnh ngh\u0129a, b\u1ea1n c\u00f3 th\u1ec3 t\u00ecm th\u1ea5y c\u00e1c t\u00ednh ch\u1ea5t sau:</p> <ol> <li>$\\mathcal R(A, B) = (-1)^{nm} \\mathcal R(B, A)$.</li> <li>$\\mathcal R(A, B)= a_n^m b_m^n$ khi $n=0$ ho\u1eb7c $m=0$.</li> <li>N\u1ebfu $b_m=1$ th\u00ec $\\mathcal R(A - CB, B) = \\mathcal R(A, B)$ cho m\u1ed9t \u0111a th\u1ee9c t\u00f9y \u00fd $C(x)$ v\u00e0 $n,m \\geq 1$.</li> <li>T\u1eeb \u0111i\u1ec1u n\u00e0y suy ra $\\mathcal R(A, B) = b_m^{\\deg(A) - \\deg(A-CB)}\\mathcal R(A - CB, B)$ cho $A(x)$, $B(x)$, $C(x)$ t\u00f9y \u00fd.</li> </ol> <p>K\u1ef3 di\u1ec7u thay, n\u00f3 c\u00f3 ngh\u0129a l\u00e0 k\u1ebft th\u1ee9c c\u1ee7a hai \u0111a th\u1ee9c th\u1ef1c s\u1ef1 lu\u00f4n n\u1eb1m trong c\u00f9ng m\u1ed9t v\u00e0nh v\u1edbi c\u00e1c h\u1ec7 s\u1ed1 c\u1ee7a ch\u00fang!</p> <p>Ngo\u00e0i ra, c\u00e1c t\u00ednh ch\u1ea5t n\u00e0y cho ph\u00e9p ch\u00fang ta t\u00ednh k\u1ebft th\u1ee9c c\u00f9ng v\u1edbi thu\u1eadt to\u00e1n Euclid, ho\u1ea1t \u0111\u1ed9ng trong $O(nm)$.</p> <pre><code>template&lt;typename T&gt;\nT resultant(poly&lt;T&gt; a, poly&lt;T&gt; b) {\n    if(b.is_zero()) {\n        return 0;\n    } else if(b.deg() == 0) {\n        return bpow(b.lead(), a.deg());\n    } else {\n        int pw = a.deg();\n        a %= b;\n        pw -= a.deg();\n        base mul = bpow(b.lead(), pw) * base((b.deg() &amp; a.deg() &amp; 1) ? -1 : 1);\n        base ans = resultant(b, a);\n        return ans * mul;\n    }\n}\n</code></pre>","tags":["Original"]},{"location":"algebra/polynomial.html#half-gcd-algorithm","title":"Thu\u1eadt to\u00e1n Half-GCD (Half-GCD algorithm)","text":"<p>C\u00f3 m\u1ed9t c\u00e1ch \u0111\u1ec3 t\u00ednh GCD v\u00e0 k\u1ebft th\u1ee9c trong $O(n \\log^2 n)$.</p> <p>Quy tr\u00ecnh \u0111\u1ec3 l\u00e0m \u0111i\u1ec1u \u0111\u00f3 th\u1ef1c hi\u1ec7n m\u1ed9t bi\u1ebfn \u0111\u1ed5i tuy\u1ebfn t\u00ednh $2 \\times 2$ \u00e1nh x\u1ea1 m\u1ed9t c\u1eb7p \u0111a th\u1ee9c $a(x)$, $b(x)$ th\u00e0nh c\u1eb7p kh\u00e1c $c(x), d(x)$ sao cho $\\deg d(x) \\leq \\frac{\\deg a(x)}{2}$. N\u1ebfu b\u1ea1n \u0111\u1ee7 c\u1ea9n th\u1eadn, b\u1ea1n c\u00f3 th\u1ec3 t\u00ednh half-GCD c\u1ee7a b\u1ea5t k\u1ef3 c\u1eb7p \u0111a th\u1ee9c n\u00e0o v\u1edbi t\u1ed1i \u0111a $2$ cu\u1ed9c g\u1ecdi \u0111\u1ec7 quy \u0111\u1ebfn c\u00e1c \u0111a th\u1ee9c nh\u1ecf h\u01a1n \u00edt nh\u1ea5t $2$ l\u1ea7n.</p> <p>C\u00e1c chi ti\u1ebft c\u1ee5 th\u1ec3 c\u1ee7a thu\u1eadt to\u00e1n h\u01a1i t\u1ebb nh\u1ea1t \u0111\u1ec3 gi\u1ea3i th\u00edch, tuy nhi\u00ean b\u1ea1n c\u00f3 th\u1ec3 t\u00ecm th\u1ea5y c\u00e0i \u0111\u1eb7t c\u1ee7a n\u00f3 trong th\u01b0 vi\u1ec7n, d\u01b0\u1edbi d\u1ea1ng h\u00e0m <code>half_gcd</code>.</p> <p>Sau khi half-GCD \u0111\u01b0\u1ee3c c\u00e0i \u0111\u1eb7t, b\u1ea1n c\u00f3 th\u1ec3 \u00e1p d\u1ee5ng l\u1eb7p \u0111i l\u1eb7p l\u1ea1i n\u00f3 cho c\u00e1c \u0111a th\u1ee9c cho \u0111\u1ebfn khi b\u1ea1n gi\u1ea3m xu\u1ed1ng c\u00f2n c\u1eb7p $\\gcd(a, b)$ v\u00e0 $0$.</p>","tags":["Original"]},{"location":"algebra/polynomial.html#problems","title":"B\u00e0i t\u1eadp","text":"<ul> <li>CodeChef - RNG</li> <li>CodeForces - Basis Change</li> <li>CodeForces - Permutant</li> <li>CodeForces - Medium Hadron Collider</li> </ul>","tags":["Original"]},{"location":"algebra/polynomial.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 492</li> <li>Translated lines: 492</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Original"]},{"location":"algebra/primality_tests.html","title":"Ki\u1ec3m tra s\u1ed1 nguy\u00ean t\u1ed1 (Primality tests)","text":"<p>B\u00e0i vi\u1ebft n\u00e0y m\u00f4 t\u1ea3 nhi\u1ec1u thu\u1eadt to\u00e1n \u0111\u1ec3 x\u00e1c \u0111\u1ecbnh xem m\u1ed9t s\u1ed1 c\u00f3 ph\u1ea3i l\u00e0 s\u1ed1 nguy\u00ean t\u1ed1 hay kh\u00f4ng.</p>","tags":["Original"]},{"location":"algebra/primality_tests.html#trial-division","title":"Ph\u00e9p chia th\u1eed (Trial division)","text":"<p>Theo \u0111\u1ecbnh ngh\u0129a, m\u1ed9t s\u1ed1 nguy\u00ean t\u1ed1 kh\u00f4ng c\u00f3 b\u1ea5t k\u1ef3 \u01b0\u1edbc s\u1ed1 n\u00e0o kh\u00e1c ngo\u00e0i $1$ v\u00e0 ch\u00ednh n\u00f3. M\u1ed9t h\u1ee3p s\u1ed1 c\u00f3 \u00edt nh\u1ea5t m\u1ed9t \u01b0\u1edbc s\u1ed1 b\u1ed5 sung, h\u00e3y g\u1ecdi n\u00f3 l\u00e0 $d$. \u0110\u01b0\u01a1ng nhi\u00ean $\\frac{n}{d}$ c\u0169ng l\u00e0 m\u1ed9t \u01b0\u1edbc s\u1ed1 c\u1ee7a $n$. D\u1ec5 th\u1ea5y r\u1eb1ng, ho\u1eb7c $d \\le \\sqrt{n}$ ho\u1eb7c $\\frac{n}{d} \\le \\sqrt{n}$, do \u0111\u00f3 m\u1ed9t trong c\u00e1c \u01b0\u1edbc s\u1ed1 $d$ v\u00e0 $\\frac{n}{d}$ l\u00e0 $\\le \\sqrt{n}$. Ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng th\u00f4ng tin n\u00e0y \u0111\u1ec3 ki\u1ec3m tra t\u00ednh nguy\u00ean t\u1ed1.</p> <p>Ch\u00fang t\u00f4i c\u1ed1 g\u1eafng t\u00ecm m\u1ed9t \u01b0\u1edbc s\u1ed1 kh\u00f4ng t\u1ea7m th\u01b0\u1eddng, b\u1eb1ng c\u00e1ch ki\u1ec3m tra xem c\u00f3 b\u1ea5t k\u1ef3 s\u1ed1 n\u00e0o gi\u1eefa $2$ v\u00e0 $\\sqrt{n}$ l\u00e0 \u01b0\u1edbc s\u1ed1 c\u1ee7a $n$ hay kh\u00f4ng. N\u1ebfu n\u00f3 l\u00e0 m\u1ed9t \u01b0\u1edbc s\u1ed1, th\u00ec $n$ ch\u1eafc ch\u1eafn kh\u00f4ng ph\u1ea3i l\u00e0 s\u1ed1 nguy\u00ean t\u1ed1, n\u1ebfu kh\u00f4ng th\u00ec n\u00f3 l\u00e0 s\u1ed1 nguy\u00ean t\u1ed1.</p> <pre><code>bool isPrime(int x) {\n    for (int d = 2; d * d &lt;= x; d++) {\n        if (x % d == 0)\n            return false;\n    }\n    return x &gt;= 2;\n}\n</code></pre> <p>\u0110\u00e2y l\u00e0 d\u1ea1ng \u0111\u01a1n gi\u1ea3n nh\u1ea5t c\u1ee7a ki\u1ec3m tra s\u1ed1 nguy\u00ean t\u1ed1. B\u1ea1n c\u00f3 th\u1ec3 t\u1ed1i \u01b0u h\u00f3a h\u00e0m n\u00e0y kh\u00e1 nhi\u1ec1u, v\u00ed d\u1ee5 b\u1eb1ng c\u00e1ch ch\u1ec9 ki\u1ec3m tra t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 l\u1ebb trong v\u00f2ng l\u1eb7p, v\u00ec s\u1ed1 nguy\u00ean t\u1ed1 ch\u1eb5n duy nh\u1ea5t l\u00e0 2. Nhi\u1ec1u t\u1ed1i \u01b0u h\u00f3a nh\u01b0 v\u1eady \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 trong b\u00e0i vi\u1ebft v\u1ec1 ph\u00e2n t\u00edch th\u1eeba s\u1ed1 nguy\u00ean.</p>","tags":["Original"]},{"location":"algebra/primality_tests.html#fermat-primality-test","title":"Ki\u1ec3m tra t\u00ednh nguy\u00ean t\u1ed1 Fermat (Fermat primality test)","text":"<p>\u0110\u00e2y l\u00e0 m\u1ed9t ki\u1ec3m tra x\u00e1c su\u1ea5t.</p> <p>\u0110\u1ecbnh l\u00fd Fermat nh\u1ecf (xem th\u00eam H\u00e0m phi Euler) n\u00eau r\u1eb1ng, \u0111\u1ed1i v\u1edbi m\u1ed9t s\u1ed1 nguy\u00ean t\u1ed1 $p$ v\u00e0 m\u1ed9t s\u1ed1 nguy\u00ean $a$ nguy\u00ean t\u1ed1 c\u00f9ng nhau, ph\u01b0\u01a1ng tr\u00ecnh sau gi\u1eef \u0111\u00fang:</p> $$a^{p-1} \\equiv 1 \\bmod p$$ <p>N\u00f3i chung \u0111\u1ecbnh l\u00fd n\u00e0y kh\u00f4ng gi\u1eef \u0111\u00fang cho c\u00e1c h\u1ee3p s\u1ed1.</p> <p>\u0110i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 t\u1ea1o ra m\u1ed9t ki\u1ec3m tra t\u00ednh nguy\u00ean t\u1ed1. Ch\u00fang ta ch\u1ecdn m\u1ed9t s\u1ed1 nguy\u00ean $2 \\le a \\le p - 2$, v\u00e0 ki\u1ec3m tra xem ph\u01b0\u01a1ng tr\u00ecnh c\u00f3 gi\u1eef \u0111\u00fang hay kh\u00f4ng. N\u1ebfu n\u00f3 kh\u00f4ng gi\u1eef \u0111\u00fang, v\u00ed d\u1ee5 $a^{p-1} \\not\\equiv 1 \\bmod p$, ch\u00fang ta bi\u1ebft r\u1eb1ng $p$ kh\u00f4ng th\u1ec3 l\u00e0 m\u1ed9t s\u1ed1 nguy\u00ean t\u1ed1. Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, ch\u00fang ta g\u1ecdi c\u01a1 s\u1ed1 $a$ l\u00e0 m\u1ed9t nh\u00e2n ch\u1ee9ng Fermat (Fermat witness) cho t\u00ednh h\u1ee3p s\u1ed1 c\u1ee7a $p$.</p> <p>Tuy nhi\u00ean, c\u0169ng c\u00f3 th\u1ec3 ph\u01b0\u01a1ng tr\u00ecnh gi\u1eef \u0111\u00fang cho m\u1ed9t h\u1ee3p s\u1ed1. V\u00ec v\u1eady, n\u1ebfu ph\u01b0\u01a1ng tr\u00ecnh gi\u1eef \u0111\u00fang, ch\u00fang ta kh\u00f4ng c\u00f3 b\u1eb1ng ch\u1ee9ng cho t\u00ednh nguy\u00ean t\u1ed1. Ch\u00fang ta ch\u1ec9 c\u00f3 th\u1ec3 n\u00f3i r\u1eb1ng $p$ l\u00e0 c\u00f3 th\u1ec3 l\u00e0 s\u1ed1 nguy\u00ean t\u1ed1 (probably prime). N\u1ebfu h\u00f3a ra con s\u1ed1 th\u1ef1c s\u1ef1 l\u00e0 h\u1ee3p s\u1ed1, ch\u00fang ta g\u1ecdi c\u01a1 s\u1ed1 $a$ l\u00e0 m\u1ed9t k\u1ebb n\u00f3i d\u1ed1i Fermat (Fermat liar).</p> <p>B\u1eb1ng c\u00e1ch ch\u1ea1y th\u1eed nghi\u1ec7m cho t\u1ea5t c\u1ea3 c\u00e1c c\u01a1 s\u1ed1 $a$ c\u00f3 th\u1ec3, ch\u00fang ta th\u1ef1c s\u1ef1 c\u00f3 th\u1ec3 ch\u1ee9ng minh r\u1eb1ng m\u1ed9t s\u1ed1 l\u00e0 s\u1ed1 nguy\u00ean t\u1ed1. Tuy nhi\u00ean, \u0111i\u1ec1u n\u00e0y kh\u00f4ng \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong th\u1ef1c t\u1ebf, v\u00ec \u0111\u00e2y l\u00e0 n\u1ed7 l\u1ef1c nhi\u1ec1u h\u01a1n nhi\u1ec1u so v\u1edbi vi\u1ec7c ch\u1ec9 th\u1ef1c hi\u1ec7n ph\u00e9p chia th\u1eed. Thay v\u00e0o \u0111\u00f3, ki\u1ec3m tra s\u1ebd \u0111\u01b0\u1ee3c l\u1eb7p l\u1ea1i nhi\u1ec1u l\u1ea7n v\u1edbi c\u00e1c l\u1ef1a ch\u1ecdn ng\u1eabu nhi\u00ean cho $a$. N\u1ebfu ch\u00fang ta kh\u00f4ng t\u00ecm th\u1ea5y nh\u00e2n ch\u1ee9ng n\u00e0o cho t\u00ednh h\u1ee3p s\u1ed1, r\u1ea5t c\u00f3 th\u1ec3 con s\u1ed1 th\u1ef1c s\u1ef1 l\u00e0 s\u1ed1 nguy\u00ean t\u1ed1.</p> <pre><code>bool probablyPrimeFermat(int n, int iter=5) {\n    if (n &lt; 4)\n        return n == 2 || n == 3;\n\n    for (int i = 0; i &lt; iter; i++) {\n        int a = 2 + rand() % (n - 3);\n        if (binpower(a, n - 1, n) != 1)\n            return false;\n    }\n    return true;\n}\n</code></pre> <p>Ch\u00fang t\u00f4i s\u1eed d\u1ee5ng L\u0169y th\u1eeba nh\u1ecb ph\u00e2n \u0111\u1ec3 t\u00ednh to\u00e1n hi\u1ec7u qu\u1ea3 l\u0169y th\u1eeba $a^{p-1}$.</p> <p>Tuy nhi\u00ean c\u00f3 m\u1ed9t tin x\u1ea5u: t\u1ed3n t\u1ea1i m\u1ed9t s\u1ed1 h\u1ee3p s\u1ed1 trong \u0111\u00f3 $a^{n-1} \\equiv 1 \\bmod n$ gi\u1eef \u0111\u00fang cho t\u1ea5t c\u1ea3 $a$ nguy\u00ean t\u1ed1 c\u00f9ng nhau v\u1edbi $n$, v\u00ed d\u1ee5 \u0111\u1ed1i v\u1edbi s\u1ed1 $561 = 3 \\cdot 11 \\cdot 17$. Nh\u1eefng s\u1ed1 nh\u01b0 v\u1eady \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 s\u1ed1 Carmichael. Ki\u1ec3m tra t\u00ednh nguy\u00ean t\u1ed1 Fermat ch\u1ec9 c\u00f3 th\u1ec3 x\u00e1c \u0111\u1ecbnh c\u00e1c s\u1ed1 n\u00e0y, n\u1ebfu ch\u00fang ta v\u00f4 c\u00f9ng may m\u1eafn v\u00e0 ch\u1ecdn m\u1ed9t c\u01a1 s\u1ed1 $a$ v\u1edbi $\\gcd(a, n) \\ne 1$.</p> <p>Ki\u1ec3m tra Fermat v\u1eabn \u0111ang \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng trong th\u1ef1c t\u1ebf, v\u00ec n\u00f3 r\u1ea5t nhanh v\u00e0 s\u1ed1 Carmichael r\u1ea5t hi\u1ebfm. V\u00ed d\u1ee5 ch\u1ec9 t\u1ed3n t\u1ea1i 646 s\u1ed1 nh\u01b0 v\u1eady d\u01b0\u1edbi $10^9$.</p>","tags":["Original"]},{"location":"algebra/primality_tests.html#miller-rabin-primality-test","title":"Ki\u1ec3m tra t\u00ednh nguy\u00ean t\u1ed1 Miller-Rabin (Miller-Rabin primality test)","text":"<p>Ki\u1ec3m tra Miller-Rabin m\u1edf r\u1ed9ng c\u00e1c \u00fd t\u01b0\u1edfng t\u1eeb ki\u1ec3m tra Fermat.</p> <p>\u0110\u1ed1i v\u1edbi m\u1ed9t s\u1ed1 l\u1ebb $n$, $n-1$ l\u00e0 ch\u1eb5n v\u00e0 ch\u00fang ta c\u00f3 th\u1ec3 t\u00e1ch t\u1ea5t c\u1ea3 c\u00e1c l\u0169y th\u1eeba c\u1ee7a 2 ra. Ch\u00fang ta c\u00f3 th\u1ec3 vi\u1ebft:</p> $$n - 1 = 2^s \\cdot d,~\\text{v\u1edbi}~d~\\text{l\u1ebb}.$$ <p>\u0110i\u1ec1u n\u00e0y cho ph\u00e9p ch\u00fang ta ph\u00e2n t\u00edch ph\u01b0\u01a1ng tr\u00ecnh c\u1ee7a \u0111\u1ecbnh l\u00fd Fermat nh\u1ecf:</p> $$\\begin{array}{rl} a^{n-1} \\equiv 1 \\bmod n &amp;\\Longleftrightarrow a^{2^s d} - 1 \\equiv 0 \\bmod n \\\\\\\\ &amp;\\Longleftrightarrow (a^{2^{s-1} d} + 1) (a^{2^{s-1} d} - 1) \\equiv 0 \\bmod n \\\\\\\\ &amp;\\Longleftrightarrow (a^{2^{s-1} d} + 1) (a^{2^{s-2} d} + 1) (a^{2^{s-2} d} - 1) \\equiv 0 \\bmod n \\\\\\\\ &amp;\\quad\\vdots \\\\\\\\ &amp;\\Longleftrightarrow (a^{2^{s-1} d} + 1) (a^{2^{s-2} d} + 1) \\cdots (a^{d} + 1) (a^{d} - 1) \\equiv 0 \\bmod n \\\\\\\\ \\end{array}$$ <p>N\u1ebfu $n$ l\u00e0 s\u1ed1 nguy\u00ean t\u1ed1, th\u00ec $n$ ph\u1ea3i chia h\u1ebft m\u1ed9t trong nh\u1eefng th\u1eeba s\u1ed1 n\u00e0y. V\u00e0 trong ki\u1ec3m tra t\u00ednh nguy\u00ean t\u1ed1 Miller-Rabin, ch\u00fang t\u00f4i ki\u1ec3m tra ch\u00ednh x\u00e1c tuy\u00ean b\u1ed1 \u0111\u00f3, \u0111\u00e2y l\u00e0 m\u1ed9t phi\u00ean b\u1ea3n ch\u1eb7t ch\u1ebd h\u01a1n c\u1ee7a tuy\u00ean b\u1ed1 ki\u1ec3m tra Fermat. \u0110\u1ed1i v\u1edbi m\u1ed9t c\u01a1 s\u1ed1 $2 \\le a \\le n-2$ ch\u00fang t\u00f4i ki\u1ec3m tra xem li\u1ec7u</p> $$a^d \\equiv 1 \\bmod n$$ <p>gi\u1eef \u0111\u00fang ho\u1eb7c</p> $$a^{2^r d} \\equiv -1 \\bmod n$$ <p>gi\u1eef \u0111\u00fang cho m\u1ed9t s\u1ed1 $0 \\le r \\le s - 1$.</p> <p>N\u1ebfu ch\u00fang ta t\u00ecm th\u1ea5y m\u1ed9t c\u01a1 s\u1ed1 $a$ kh\u00f4ng th\u1ecfa m\u00e3n b\u1ea5t k\u1ef3 \u0111\u1eb3ng th\u1ee9c n\u00e0o \u1edf tr\u00ean, th\u00ec ch\u00fang ta \u0111\u00e3 t\u00ecm th\u1ea5y m\u1ed9t nh\u00e2n ch\u1ee9ng cho t\u00ednh h\u1ee3p s\u1ed1 c\u1ee7a $n$. Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, ch\u00fang t\u00f4i \u0111\u00e3 ch\u1ee9ng minh r\u1eb1ng $n$ kh\u00f4ng ph\u1ea3i l\u00e0 m\u1ed9t s\u1ed1 nguy\u00ean t\u1ed1.</p> <p>T\u01b0\u01a1ng t\u1ef1 nh\u01b0 ki\u1ec3m tra Fermat, c\u0169ng c\u00f3 th\u1ec3 t\u1eadp h\u1ee3p c\u00e1c ph\u01b0\u01a1ng tr\u00ecnh \u0111\u01b0\u1ee3c th\u1ecfa m\u00e3n cho m\u1ed9t h\u1ee3p s\u1ed1. Trong tr\u01b0\u1eddng h\u1ee3p \u0111\u00f3, c\u01a1 s\u1ed1 $a$ \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 k\u1ebb n\u00f3i d\u1ed1i m\u1ea1nh (strong liar). N\u1ebfu m\u1ed9t c\u01a1 s\u1ed1 $a$ th\u1ecfa m\u00e3n c\u00e1c ph\u01b0\u01a1ng tr\u00ecnh (m\u1ed9t trong s\u1ed1 ch\u00fang), $n$ ch\u1ec9 l\u00e0 s\u1ed1 nguy\u00ean t\u1ed1 c\u00f3 kh\u1ea3 n\u0103ng m\u1ea1nh (strong probable prime). Tuy nhi\u00ean, kh\u00f4ng c\u00f3 s\u1ed1 n\u00e0o gi\u1ed1ng nh\u01b0 s\u1ed1 Carmichael, n\u01a1i t\u1ea5t c\u1ea3 c\u00e1c c\u01a1 s\u1ed1 kh\u00f4ng t\u1ea7m th\u01b0\u1eddng \u0111\u1ec1u n\u00f3i d\u1ed1i. Th\u1ef1c t\u1ebf c\u00f3 th\u1ec3 ch\u1ec9 ra r\u1eb1ng, t\u1ed1i \u0111a $\\frac{1}{4}$ c\u00e1c c\u01a1 s\u1ed1 c\u00f3 th\u1ec3 l\u00e0 k\u1ebb n\u00f3i d\u1ed1i m\u1ea1nh. N\u1ebfu $n$ l\u00e0 h\u1ee3p s\u1ed1, ch\u00fang ta c\u00f3 x\u00e1c su\u1ea5t $\\ge 75\\%$ r\u1eb1ng m\u1ed9t c\u01a1 s\u1ed1 ng\u1eabu nhi\u00ean s\u1ebd cho ch\u00fang ta bi\u1ebft r\u1eb1ng n\u00f3 l\u00e0 h\u1ee3p s\u1ed1. B\u1eb1ng c\u00e1ch th\u1ef1c hi\u1ec7n nhi\u1ec1u l\u1ea7n l\u1eb7p, ch\u1ecdn c\u00e1c c\u01a1 s\u1ed1 ng\u1eabu nhi\u00ean kh\u00e1c nhau, ch\u00fang ta c\u00f3 th\u1ec3 bi\u1ebft v\u1edbi x\u00e1c su\u1ea5t r\u1ea5t cao li\u1ec7u con s\u1ed1 c\u00f3 th\u1ef1c s\u1ef1 l\u00e0 s\u1ed1 nguy\u00ean t\u1ed1 hay n\u1ebfu n\u00f3 l\u00e0 h\u1ee3p s\u1ed1.</p> <p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u1ed9t c\u00e0i \u0111\u1eb7t cho s\u1ed1 nguy\u00ean 64 bit.</p> <pre><code>using u64 = uint64_t;\nusing u128 = __uint128_t;\n\nu64 binpower(u64 base, u64 e, u64 mod) {\n    u64 result = 1;\n    base %= mod;\n    while (e) {\n        if (e &amp; 1)\n            result = (u128)result * base % mod;\n        base = (u128)base * base % mod;\n        e &gt;&gt;= 1;\n    }\n    return result;\n}\n\nbool check_composite(u64 n, u64 a, u64 d, int s) {\n    u64 x = binpower(a, d, n);\n    if (x == 1 || x == n - 1)\n        return false;\n    for (int r = 1; r &lt; s; r++) {\n        x = (u128)x * x % n;\n        if (x == n - 1)\n            return false;\n    }\n    return true;\n};\n\nbool MillerRabin(u64 n, int iter=5) { // returns true if n is probably prime, else returns false.\n    if (n &lt; 4)\n        return n == 2 || n == 3;\n\n    int s = 0;\n    u64 d = n - 1;\n    while ((d &amp; 1) == 0) {\n        d &gt;&gt;= 1;\n        s++;\n    }\n\n    for (int i = 0; i &lt; iter; i++) {\n        int a = 2 + rand() % (n - 3);\n        if (check_composite(n, a, d, s))\n            return false;\n    }\n    return true;\n}\n</code></pre> <p>Tr\u01b0\u1edbc khi ki\u1ec3m tra Miller-Rabin, b\u1ea1n c\u00f3 th\u1ec3 ki\u1ec3m tra th\u00eam xem m\u1ed9t trong v\u00e0i s\u1ed1 nguy\u00ean t\u1ed1 \u0111\u1ea7u ti\u00ean c\u00f3 ph\u1ea3i l\u00e0 \u01b0\u1edbc s\u1ed1 hay kh\u00f4ng. \u0110i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 t\u0103ng t\u1ed1c \u0111\u1ed9 ki\u1ec3m tra l\u00ean r\u1ea5t nhi\u1ec1u, v\u00ec h\u1ea7u h\u1ebft c\u00e1c h\u1ee3p s\u1ed1 c\u00f3 c\u00e1c \u01b0\u1edbc s\u1ed1 nguy\u00ean t\u1ed1 r\u1ea5t nh\u1ecf. V\u00ed d\u1ee5 $88\\%$ c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 c\u00f3 m\u1ed9t th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1 nh\u1ecf h\u01a1n $100$.</p>","tags":["Original"]},{"location":"algebra/primality_tests.html#deterministic-version","title":"Phi\u00ean b\u1ea3n \u0111\u01a1n \u0111\u1ecbnh (Deterministic version)","text":"<p>Miller \u0111\u00e3 ch\u1ec9 ra r\u1eb1ng c\u00f3 th\u1ec3 l\u00e0m cho thu\u1eadt to\u00e1n tr\u1edf n\u00ean \u0111\u01a1n \u0111\u1ecbnh b\u1eb1ng c\u00e1ch ch\u1ec9 ki\u1ec3m tra t\u1ea5t c\u1ea3 c\u00e1c c\u01a1 s\u1ed1 $\\le O((\\ln n)^2)$. Bach sau \u0111\u00f3 \u0111\u00e3 \u0111\u01b0a ra m\u1ed9t gi\u1edbi h\u1ea1n c\u1ee5 th\u1ec3, ch\u1ec9 c\u1ea7n ki\u1ec3m tra t\u1ea5t c\u1ea3 c\u00e1c c\u01a1 s\u1ed1 $a \\le 2 \\ln(n)^2$.</p> <p>\u0110\u00e2y v\u1eabn l\u00e0 m\u1ed9t s\u1ed1 l\u01b0\u1ee3ng c\u01a1 s\u1ed1 kh\u00e1 l\u1edbn. V\u00ec v\u1eady, m\u1ecdi ng\u01b0\u1eddi \u0111\u00e3 \u0111\u1ea7u t\u01b0 kh\u00e1 nhi\u1ec1u s\u1ee9c m\u1ea1nh t\u00ednh to\u00e1n v\u00e0o vi\u1ec7c t\u00ecm ki\u1ebfm c\u00e1c gi\u1edbi h\u1ea1n d\u01b0\u1edbi. H\u00f3a ra, \u0111\u1ec3 ki\u1ec3m tra m\u1ed9t s\u1ed1 nguy\u00ean 32 bit, ch\u1ec9 c\u1ea7n ki\u1ec3m tra 4 c\u01a1 s\u1ed1 nguy\u00ean t\u1ed1 \u0111\u1ea7u ti\u00ean: 2, 3, 5 v\u00e0 7. H\u1ee3p s\u1ed1 nh\u1ecf nh\u1ea5t th\u1ea5t b\u1ea1i trong ki\u1ec3m tra n\u00e0y l\u00e0 $3,215,031,751 = 151 \\cdot 751 \\cdot 28351$. V\u00e0 \u0111\u1ec3 ki\u1ec3m tra s\u1ed1 nguy\u00ean 64 bit, l\u00e0 \u0111\u1ee7 \u0111\u1ec3 ki\u1ec3m tra 12 c\u01a1 s\u1ed1 nguy\u00ean t\u1ed1 \u0111\u1ea7u ti\u00ean: 2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, v\u00e0 37.</p> <p>K\u1ebft qu\u1ea3 l\u00e0 c\u00e0i \u0111\u1eb7t \u0111\u01a1n \u0111\u1ecbnh sau:</p> <pre><code>bool MillerRabin(u64 n) { // returns true if n is prime, else returns false.\n    if (n &lt; 2)\n        return false;\n\n    int r = 0;\n    u64 d = n - 1;\n    while ((d &amp; 1) == 0) {\n        d &gt;&gt;= 1;\n        r++;\n    }\n\n    for (int a : {2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37}) {\n        if (n == a)\n            return true;\n        if (check_composite(n, a, d, r))\n            return false;\n    }\n    return true;\n}\n</code></pre> <p>C\u0169ng c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n ki\u1ec3m tra v\u1edbi ch\u1ec9 7 c\u01a1 s\u1ed1: 2, 325, 9375, 28178, 450775, 9780504 v\u00e0 1795265022. Tuy nhi\u00ean, v\u00ec nh\u1eefng con s\u1ed1 n\u00e0y (tr\u1eeb 2) kh\u00f4ng ph\u1ea3i l\u00e0 s\u1ed1 nguy\u00ean t\u1ed1, b\u1ea1n c\u1ea7n ki\u1ec3m tra th\u00eam xem s\u1ed1 b\u1ea1n \u0111ang ki\u1ec3m tra c\u00f3 b\u1eb1ng b\u1ea5t k\u1ef3 \u01b0\u1edbc s\u1ed1 nguy\u00ean t\u1ed1 n\u00e0o c\u1ee7a c\u00e1c c\u01a1 s\u1ed1 \u0111\u00f3 kh\u00f4ng: 2, 3, 5, 13, 19, 73, 193, 407521, 299210837.</p>","tags":["Original"]},{"location":"algebra/primality_tests.html#practice-problems","title":"B\u00e0i t\u1eadp luy\u1ec7n t\u1eadp","text":"<ul> <li>SPOJ - Prime or Not</li> <li>Project euler - Investigating a Prime Pattern</li> </ul>","tags":["Original"]},{"location":"algebra/primality_tests.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 222</li> <li>Translated lines: 222</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Original"]},{"location":"algebra/prime-sieve-linear.html","title":"S\u00e0ng tuy\u1ebfn t\u00ednh (Linear Sieve)","text":"<p>Cho m\u1ed9t s\u1ed1 $n$, t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 nguy\u00ean t\u1ed1 trong \u0111o\u1ea1n $[2;n]$.</p> <p>C\u00e1ch gi\u1ea3i quy\u1ebft ti\u00eau chu\u1ea9n cho nhi\u1ec7m v\u1ee5 n\u00e0y l\u00e0 s\u1eed d\u1ee5ng s\u00e0ng Eratosthenes. Thu\u1eadt to\u00e1n n\u00e0y r\u1ea5t \u0111\u01a1n gi\u1ea3n, nh\u01b0ng n\u00f3 c\u00f3 th\u1eddi gian ch\u1ea1y $O(n \\log \\log n)$.</p> <p>M\u1eb7c d\u00f9 c\u00f3 r\u1ea5t nhi\u1ec1u thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c bi\u1ebft \u0111\u1ebfn v\u1edbi th\u1eddi gian ch\u1ea1y d\u01b0\u1edbi tuy\u1ebfn t\u00ednh (t\u1ee9c l\u00e0 $o(n)$), thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 d\u01b0\u1edbi \u0111\u00e2y r\u1ea5t th\u00fa v\u1ecb b\u1edfi s\u1ef1 \u0111\u01a1n gi\u1ea3n c\u1ee7a n\u00f3: n\u00f3 kh\u00f4ng ph\u1ee9c t\u1ea1p h\u01a1n s\u00e0ng Eratosthenes c\u1ed5 \u0111i\u1ec3n.</p> <p>Ngo\u00e0i ra, thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c \u0111\u01b0a ra \u1edf \u0111\u00e2y t\u00ednh to\u00e1n ph\u00e2n t\u00edch th\u1eeba s\u1ed1 c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 trong \u0111o\u1ea1n $[2; n]$ nh\u01b0 m\u1ed9t hi\u1ec7u \u1ee9ng ph\u1ee5, v\u00e0 \u0111i\u1ec1u \u0111\u00f3 c\u00f3 th\u1ec3 h\u1eefu \u00edch trong nhi\u1ec1u \u1ee9ng d\u1ee5ng th\u1ef1c t\u1ebf.</p> <p>\u0110i\u1ec3m y\u1ebfu c\u1ee7a thu\u1eadt to\u00e1n \u0111\u00e3 cho l\u00e0 s\u1eed d\u1ee5ng nhi\u1ec1u b\u1ed9 nh\u1edb h\u01a1n so v\u1edbi s\u00e0ng Eratosthenes c\u1ed5 \u0111i\u1ec3n: n\u00f3 \u0111\u00f2i h\u1ecfi m\u1ed9t m\u1ea3ng $n$ s\u1ed1, trong khi \u0111\u1ed1i v\u1edbi s\u00e0ng Eratosthenes c\u1ed5 \u0111i\u1ec3n l\u00e0 \u0111\u1ee7 \u0111\u1ec3 c\u00f3 $n$ bit b\u1ed9 nh\u1edb (\u00edt h\u01a1n 32 l\u1ea7n).</p> <p>Do \u0111\u00f3, ch\u1ec9 n\u00ean s\u1eed d\u1ee5ng thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 cho c\u00e1c s\u1ed1 theo th\u1ee9 t\u1ef1 $10^7$ v\u00e0 kh\u00f4ng l\u1edbn h\u01a1n.</p> <p>Thu\u1eadt to\u00e1n l\u00e0 do Paul Pritchard. N\u00f3 l\u00e0 m\u1ed9t bi\u1ebfn th\u1ec3 c\u1ee7a Thu\u1eadt to\u00e1n 3.3 trong (Pritchard, 1987: xem t\u00e0i li\u1ec7u tham kh\u1ea3o \u1edf cu\u1ed1i b\u00e0i vi\u1ebft).</p>","tags":["Translated"]},{"location":"algebra/prime-sieve-linear.html#algorithm","title":"Thu\u1eadt to\u00e1n (Algorithm)","text":"<p>M\u1ee5c ti\u00eau c\u1ee7a ch\u00fang t\u00f4i l\u00e0 t\u00ednh to\u00e1n th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1 nh\u1ecf nh\u1ea5t $lp [i]$ cho m\u1ed7i s\u1ed1 $i$ trong \u0111o\u1ea1n $[2; n]$.</p> <p>Ngo\u00e0i ra, ch\u00fang ta c\u1ea7n l\u01b0u tr\u1eef danh s\u00e1ch t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 nguy\u00ean t\u1ed1 t\u00ecm \u0111\u01b0\u1ee3c - h\u00e3y g\u1ecdi n\u00f3 l\u00e0 $pr []$.</p> <p>Ch\u00fang t\u00f4i s\u1ebd kh\u1edfi t\u1ea1o c\u00e1c gi\u00e1 tr\u1ecb $lp [i]$ v\u1edbi s\u1ed1 kh\u00f4ng, \u0111i\u1ec1u \u0111\u00f3 c\u00f3 ngh\u0129a l\u00e0 ch\u00fang t\u00f4i gi\u1ea3 s\u1eed t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 l\u00e0 s\u1ed1 nguy\u00ean t\u1ed1. Trong qu\u00e1 tr\u00ecnh th\u1ef1c hi\u1ec7n thu\u1eadt to\u00e1n, m\u1ea3ng n\u00e0y s\u1ebd \u0111\u01b0\u1ee3c \u0111i\u1ec1n d\u1ea7n.</p> <p>B\u00e2y gi\u1edd ch\u00fang ta s\u1ebd \u0111i qua c\u00e1c s\u1ed1 t\u1eeb 2 \u0111\u1ebfn $n$. Ch\u00fang ta c\u00f3 hai tr\u01b0\u1eddng h\u1ee3p cho s\u1ed1 hi\u1ec7n t\u1ea1i $i$:</p> <ul> <li> <p>$lp[i] = 0$ - \u0111i\u1ec1u \u0111\u00f3 c\u00f3 ngh\u0129a l\u00e0 $i$ l\u00e0 s\u1ed1 nguy\u00ean t\u1ed1, ngh\u0129a l\u00e0 ch\u00fang ta ch\u01b0a t\u00ecm th\u1ea5y b\u1ea5t k\u1ef3 th\u1eeba s\u1ed1 n\u00e0o nh\u1ecf h\u01a1n cho n\u00f3.   Do \u0111\u00f3, ch\u00fang ta g\u00e1n $lp [i] = i$ v\u00e0 th\u00eam $i$ v\u00e0o cu\u1ed1i danh s\u00e1ch $pr[]$.</p> </li> <li> <p>$lp[i] \\neq 0$ - \u0111i\u1ec1u \u0111\u00f3 c\u00f3 ngh\u0129a l\u00e0 $i$ l\u00e0 h\u1ee3p s\u1ed1, v\u00e0 th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1 nh\u1ecf nh\u1ea5t c\u1ee7a n\u00f3 l\u00e0 $lp [i]$.</p> </li> </ul> <p>Trong c\u1ea3 hai tr\u01b0\u1eddng h\u1ee3p, ch\u00fang t\u00f4i c\u1eadp nh\u1eadt c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a $lp []$ cho c\u00e1c s\u1ed1 chia h\u1ebft cho $i$. Tuy nhi\u00ean, m\u1ee5c ti\u00eau c\u1ee7a ch\u00fang t\u00f4i l\u00e0 t\u00ecm c\u00e1ch \u0111\u1ec3 \u0111\u1eb7t gi\u00e1 tr\u1ecb $lp []$ nhi\u1ec1u nh\u1ea5t m\u1ed9t l\u1ea7n cho m\u1ed7i s\u1ed1. Ch\u00fang ta c\u00f3 th\u1ec3 l\u00e0m \u0111i\u1ec1u \u0111\u00f3 nh\u01b0 sau:</p> <p>H\u00e3y xem x\u00e9t c\u00e1c s\u1ed1 $x_j = i \\cdot p_j$, trong \u0111\u00f3 $p_j$ l\u00e0 t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 nguy\u00ean t\u1ed1 nh\u1ecf h\u01a1n ho\u1eb7c b\u1eb1ng $lp [i]$ (\u0111\u00e2y l\u00e0 l\u00fd do t\u1ea1i sao ch\u00fang ta c\u1ea7n l\u01b0u tr\u1eef danh s\u00e1ch t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 nguy\u00ean t\u1ed1).</p> <p>Ch\u00fang t\u00f4i s\u1ebd \u0111\u1eb7t m\u1ed9t gi\u00e1 tr\u1ecb m\u1edbi $lp [x_j] = p_j$ cho t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 c\u00f3 d\u1ea1ng n\u00e0y.</p> <p>B\u1eb1ng ch\u1ee9ng v\u1ec1 t\u00ednh \u0111\u00fang \u0111\u1eafn c\u1ee7a thu\u1eadt to\u00e1n n\u00e0y v\u00e0 th\u1eddi gian ch\u1ea1y c\u1ee7a n\u00f3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y sau khi c\u00e0i \u0111\u1eb7t.</p>","tags":["Translated"]},{"location":"algebra/prime-sieve-linear.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<pre><code>const int N = 10000000;\nvector&lt;int&gt; lp(N+1);\nvector&lt;int&gt; pr;\n\nfor (int i=2; i &lt;= N; ++i) {\n    if (lp[i] == 0) {\n        lp[i] = i;\n        pr.push_back(i);\n    }\n    for (int j = 0; i * pr[j] &lt;= N; ++j) {\n        lp[i * pr[j]] = pr[j];\n        if (pr[j] == lp[i]) {\n            break;\n        }\n    }\n}\n</code></pre>","tags":["Translated"]},{"location":"algebra/prime-sieve-linear.html#correctness-proof","title":"Ch\u1ee9ng minh t\u00ednh \u0111\u00fang \u0111\u1eafn (Correctness Proof)","text":"<p>Ch\u00fang ta c\u1ea7n ch\u1ee9ng minh r\u1eb1ng thu\u1eadt to\u00e1n \u0111\u1eb7t t\u1ea5t c\u1ea3 c\u00e1c gi\u00e1 tr\u1ecb $lp []$ m\u1ed9t c\u00e1ch ch\u00ednh x\u00e1c, v\u00e0 m\u1ed7i gi\u00e1 tr\u1ecb s\u1ebd \u0111\u01b0\u1ee3c \u0111\u1eb7t ch\u00ednh x\u00e1c m\u1ed9t l\u1ea7n. Do \u0111\u00f3, thu\u1eadt to\u00e1n s\u1ebd c\u00f3 th\u1eddi gian ch\u1ea1y tuy\u1ebfn t\u00ednh, v\u00ec t\u1ea5t c\u1ea3 c\u00e1c h\u00e0nh \u0111\u1ed9ng c\u00f2n l\u1ea1i c\u1ee7a thu\u1eadt to\u00e1n, r\u00f5 r\u00e0ng, ho\u1ea1t \u0111\u1ed9ng trong $O (n)$.</p> <p>L\u01b0u \u00fd r\u1eb1ng m\u1ed7i s\u1ed1 $i$ c\u00f3 ch\u00ednh x\u00e1c m\u1ed9t bi\u1ec3u di\u1ec5n \u1edf d\u1ea1ng:</p> $$i = lp [i] \\cdot x,$$ <p>trong \u0111\u00f3 $lp [i]$ l\u00e0 th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1 nh\u1ecf nh\u1ea5t c\u1ee7a $i$, v\u00e0 s\u1ed1 $x$ kh\u00f4ng c\u00f3 b\u1ea5t k\u1ef3 th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1 n\u00e0o nh\u1ecf h\u01a1n $lp [i]$, t\u1ee9 l\u00e0</p> $$lp [i] \\le lp [x].$$ <p>B\u00e2y gi\u1edd, h\u00e3y so s\u00e1nh \u0111i\u1ec1u n\u00e0y v\u1edbi c\u00e1c h\u00e0nh \u0111\u1ed9ng c\u1ee7a thu\u1eadt to\u00e1n c\u1ee7a ch\u00fang t\u00f4i: th\u1ef1c t\u1ebf, \u0111\u1ed1i v\u1edbi m\u1ecdi $x$ n\u00f3 \u0111i qua t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 nguy\u00ean t\u1ed1 m\u00e0 n\u00f3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c nh\u00e2n v\u1edbi, t\u1ee9c l\u00e0 t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 nguy\u00ean t\u1ed1 l\u00ean \u0111\u1ebfn $lp [x]$ bao g\u1ed3m c\u1ea3 n\u00f3, \u0111\u1ec3 c\u00f3 \u0111\u01b0\u1ee3c c\u00e1c s\u1ed1 \u1edf d\u1ea1ng \u0111\u00e3 cho \u1edf tr\u00ean.</p> <p>Do \u0111\u00f3, thu\u1eadt to\u00e1n s\u1ebd \u0111i qua m\u1ecdi h\u1ee3p s\u1ed1 ch\u00ednh x\u00e1c m\u1ed9t l\u1ea7n, \u0111\u1eb7t c\u00e1c gi\u00e1 tr\u1ecb ch\u00ednh x\u00e1c $lp []$ \u1edf \u0111\u00f3. Q.E.D.</p>","tags":["Translated"]},{"location":"algebra/prime-sieve-linear.html#runtime-and-memory","title":"Th\u1eddi gian ch\u1ea1y v\u00e0 b\u1ed9 nh\u1edb (Runtime and Memory)","text":"<p>M\u1eb7c d\u00f9 th\u1eddi gian ch\u1ea1y c\u1ee7a $O(n)$ t\u1ed1t h\u01a1n $O(n \\log \\log n)$ c\u1ee7a s\u00e0ng Eratosthenes c\u1ed5 \u0111i\u1ec3n, s\u1ef1 kh\u00e1c bi\u1ec7t gi\u1eefa ch\u00fang kh\u00f4ng qu\u00e1 l\u1edbn. Trong th\u1ef1c t\u1ebf, s\u00e0ng tuy\u1ebfn t\u00ednh ch\u1ea1y nhanh g\u1ea7n b\u1eb1ng m\u1ed9t c\u00e0i \u0111\u1eb7t \u0111i\u1ec3n h\u00ecnh c\u1ee7a s\u00e0ng Eratosthenes.</p> <p>So v\u1edbi c\u00e1c phi\u00ean b\u1ea3n t\u1ed1i \u01b0u h\u00f3a c\u1ee7a s\u00e0ng Erathosthenes, v\u00ed d\u1ee5 s\u00e0ng ph\u00e2n \u0111o\u1ea1n, n\u00f3 ch\u1eadm h\u01a1n nhi\u1ec1u.</p> <p>Xem x\u00e9t c\u00e1c y\u00eau c\u1ea7u b\u1ed9 nh\u1edb c\u1ee7a thu\u1eadt to\u00e1n n\u00e0y - m\u1ed9t m\u1ea3ng $lp []$ c\u00f3 \u0111\u1ed9 d\u00e0i $n$, v\u00e0 m\u1ed9t m\u1ea3ng c\u1ee7a $pr []$ c\u00f3 \u0111\u1ed9 d\u00e0i $\\frac n {\\ln n}$, thu\u1eadt to\u00e1n n\u00e0y d\u01b0\u1eddng nh\u01b0 t\u1ed3i t\u1ec7 h\u01a1n so v\u1edbi s\u00e0ng c\u1ed5 \u0111i\u1ec3n v\u1ec1 m\u1ecdi m\u1eb7t.</p> <p>Tuy nhi\u00ean, ch\u1ea5t l\u01b0\u1ee3ng c\u1ee9u v\u00e3n c\u1ee7a n\u00f3 l\u00e0 thu\u1eadt to\u00e1n n\u00e0y t\u00ednh to\u00e1n m\u1ed9t m\u1ea3ng $lp []$, cho ph\u00e9p ch\u00fang ta t\u00ecm ph\u00e2n t\u00edch th\u1eeba s\u1ed1 c\u1ee7a b\u1ea5t k\u1ef3 s\u1ed1 n\u00e0o trong \u0111o\u1ea1n $[2; n]$ trong th\u1eddi gian theo th\u1ee9 t\u1ef1 k\u00edch th\u01b0\u1edbc c\u1ee7a ph\u00e2n t\u00edch th\u1eeba s\u1ed1 n\u00e0y. H\u01a1n n\u1eefa, s\u1eed d\u1ee5ng ch\u1ec9 m\u1ed9t m\u1ea3ng b\u1ed5 sung s\u1ebd cho ph\u00e9p ch\u00fang ta tr\u00e1nh c\u00e1c ph\u00e9p chia khi t\u00ecm ki\u1ebfm ph\u00e2n t\u00edch th\u1eeba s\u1ed1.</p> <p>Bi\u1ebft c\u00e1c ph\u00e2n t\u00edch th\u1eeba s\u1ed1 c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 r\u1ea5t h\u1eefu \u00edch cho m\u1ed9t s\u1ed1 nhi\u1ec7m v\u1ee5, v\u00e0 thu\u1eadt to\u00e1n n\u00e0y l\u00e0 m\u1ed9t trong s\u1ed1 \u00edt thu\u1eadt to\u00e1n cho ph\u00e9p t\u00ecm ch\u00fang trong th\u1eddi gian tuy\u1ebfn t\u00ednh.</p>","tags":["Translated"]},{"location":"algebra/prime-sieve-linear.html#references","title":"T\u00e0i li\u1ec7u tham kh\u1ea3o (References)","text":"<ul> <li>Paul Pritchard, Linear Prime-Number Sieves: a Family Tree, Science of Computer Programming, vol. 9 (1987), pp.17-35.</li> </ul>","tags":["Translated"]},{"location":"algebra/prime-sieve-linear.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 99</li> <li>Translated lines: 99</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Translated"]},{"location":"algebra/primitive-root.html","title":"C\u0103n nguy\u00ean th\u1ee7y (Primitive Root)","text":"","tags":["Translated"]},{"location":"algebra/primitive-root.html#definition","title":"\u0110\u1ecbnh ngh\u0129a (Definition)","text":"<p>Trong s\u1ed1 h\u1ecdc modulo, m\u1ed9t s\u1ed1 $g$ \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 m\u1ed9t <code>c\u0103n nguy\u00ean th\u1ee7y modulo n</code> n\u1ebfu m\u1ecdi s\u1ed1 nguy\u00ean t\u1ed1 c\u00f9ng nhau v\u1edbi $n$ \u0111\u1ec1u \u0111\u1ed3ng d\u01b0 v\u1edbi m\u1ed9t l\u0169y th\u1eeba c\u1ee7a $g$ modulo $n$. V\u1ec1 m\u1eb7t to\u00e1n h\u1ecdc, $g$ l\u00e0 m\u1ed9t <code>c\u0103n nguy\u00ean th\u1ee7y modulo n</code> khi v\u00e0 ch\u1ec9 khi \u0111\u1ed1i v\u1edbi b\u1ea5t k\u1ef3 s\u1ed1 nguy\u00ean $a$ n\u00e0o sao cho $\\gcd(a, n) = 1$, t\u1ed3n t\u1ea1i m\u1ed9t s\u1ed1 nguy\u00ean $k$ sao cho:</p> <p>$g^k \\equiv a \\pmod n$.</p> <p>$k$ sau \u0111\u00f3 \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 <code>ch\u1ec9 s\u1ed1</code> ho\u1eb7c <code>logarit r\u1eddi r\u1ea1c</code> c\u1ee7a $a$ theo c\u01a1 s\u1ed1 $g$ modulo $n$. $g$ c\u0169ng \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 <code>ph\u1ea7n t\u1eed sinh</code> c\u1ee7a nh\u00f3m nh\u00e2n c\u00e1c s\u1ed1 nguy\u00ean modulo $n$.</p> <p>C\u1ee5 th\u1ec3, \u0111\u1ed1i v\u1edbi tr\u01b0\u1eddng h\u1ee3p $n$ l\u00e0 m\u1ed9t s\u1ed1 nguy\u00ean t\u1ed1, c\u00e1c l\u0169y th\u1eeba c\u1ee7a c\u0103n nguy\u00ean th\u1ee7y ch\u1ea1y qua t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 t\u1eeb $1$ \u0111\u1ebfn $n-1$.</p>","tags":["Translated"]},{"location":"algebra/primitive-root.html#existence","title":"S\u1ef1 t\u1ed3n t\u1ea1i (Existence)","text":"<p>C\u0103n nguy\u00ean th\u1ee7y modulo $n$ t\u1ed3n t\u1ea1i khi v\u00e0 ch\u1ec9 khi:</p> <ul> <li>$n$ l\u00e0 1, 2, 4, ho\u1eb7c</li> <li>$n$ l\u00e0 l\u0169y th\u1eeba c\u1ee7a m\u1ed9t s\u1ed1 nguy\u00ean t\u1ed1 l\u1ebb $(n = p^k)$, ho\u1eb7c</li> <li>$n$ l\u00e0 hai l\u1ea7n l\u0169y th\u1eeba c\u1ee7a m\u1ed9t s\u1ed1 nguy\u00ean t\u1ed1 l\u1ebb $(n = 2 \\cdot p^k)$.</li> </ul> <p>\u0110\u1ecbnh l\u00fd n\u00e0y \u0111\u01b0\u1ee3c ch\u1ee9ng minh b\u1edfi Gauss v\u00e0o n\u0103m 1801.</p>","tags":["Translated"]},{"location":"algebra/primitive-root.html#relation-with-the-euler-function","title":"Quan h\u1ec7 v\u1edbi h\u00e0m Euler (Relation with the Euler function)","text":"<p>G\u1ecdi $g$ l\u00e0 m\u1ed9t c\u0103n nguy\u00ean th\u1ee7y modulo $n$. Khi \u0111\u00f3 ch\u00fang ta c\u00f3 th\u1ec3 ch\u1ec9 ra r\u1eb1ng s\u1ed1 nh\u1ecf nh\u1ea5t $k$ m\u00e0 $g^k \\equiv 1 \\pmod n$ b\u1eb1ng $\\phi (n)$. H\u01a1n n\u1eefa, \u0111i\u1ec1u ng\u01b0\u1ee3c l\u1ea1i c\u0169ng \u0111\u00fang, v\u00e0 th\u1ef1c t\u1ebf n\u00e0y s\u1ebd \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng trong b\u00e0i vi\u1ebft n\u00e0y \u0111\u1ec3 t\u00ecm m\u1ed9t c\u0103n nguy\u00ean th\u1ee7y.</p> <p>H\u01a1n n\u1eefa, s\u1ed1 l\u01b0\u1ee3ng c\u0103n nguy\u00ean th\u1ee7y modulo $n$, n\u1ebfu c\u00f3, b\u1eb1ng $\\phi (\\phi (n) )$.</p>","tags":["Translated"]},{"location":"algebra/primitive-root.html#algorithm-for-finding-a-primitive-root","title":"Thu\u1eadt to\u00e1n t\u00ecm c\u0103n nguy\u00ean th\u1ee7y (Algorithm for finding a primitive root)","text":"<p>M\u1ed9t thu\u1eadt to\u00e1n ng\u00e2y th\u01a1 l\u00e0 xem x\u00e9t t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 trong ph\u1ea1m vi $[1, n-1]$. V\u00e0 sau \u0111\u00f3 ki\u1ec3m tra xem m\u1ed7i s\u1ed1 c\u00f3 ph\u1ea3i l\u00e0 m\u1ed9t c\u0103n nguy\u00ean th\u1ee7y hay kh\u00f4ng, b\u1eb1ng c\u00e1ch t\u00ednh t\u1ea5t c\u1ea3 l\u0169y th\u1eeba c\u1ee7a n\u00f3 \u0111\u1ec3 xem li\u1ec7u ch\u00fang c\u00f3 kh\u00e1c nhau hay kh\u00f4ng. Thu\u1eadt to\u00e1n n\u00e0y c\u00f3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p $O(g \\cdot n)$, s\u1ebd qu\u00e1 ch\u1eadm. Trong ph\u1ea7n n\u00e0y, ch\u00fang t\u00f4i \u0111\u1ec1 xu\u1ea5t m\u1ed9t thu\u1eadt to\u00e1n nhanh h\u01a1n s\u1eed d\u1ee5ng m\u1ed9t s\u1ed1 \u0111\u1ecbnh l\u00fd n\u1ed5i ti\u1ebfng.</p> <p>T\u1eeb ph\u1ea7n tr\u01b0\u1edbc, ch\u00fang ta bi\u1ebft r\u1eb1ng n\u1ebfu s\u1ed1 nh\u1ecf nh\u1ea5t $k$ m\u00e0 $g^k \\equiv 1 \\pmod n$ l\u00e0 $\\phi (n)$, th\u00ec $g$ l\u00e0 m\u1ed9t c\u0103n nguy\u00ean th\u1ee7y. V\u00ec \u0111\u1ed1i v\u1edbi b\u1ea5t k\u1ef3 s\u1ed1 $a$ n\u00e0o nguy\u00ean t\u1ed1 c\u00f9ng nhau v\u1edbi $n$, ch\u00fang ta bi\u1ebft t\u1eeb \u0111\u1ecbnh l\u00fd Euler r\u1eb1ng $a ^ { \\phi (n) } \\equiv 1 \\pmod n$, n\u00ean \u0111\u1ec3 ki\u1ec3m tra xem $g$ c\u00f3 ph\u1ea3i l\u00e0 c\u0103n nguy\u00ean th\u1ee7y hay kh\u00f4ng, ch\u1ec9 c\u1ea7n ki\u1ec3m tra xem v\u1edbi m\u1ecdi $d$ nh\u1ecf h\u01a1n $\\phi (n)$, $g^d \\not \\equiv 1 \\pmod n$. Tuy nhi\u00ean, thu\u1eadt to\u00e1n n\u00e0y v\u1eabn qu\u00e1 ch\u1eadm.</p> <p>T\u1eeb \u0111\u1ecbnh l\u00fd Lagrange, ch\u00fang ta bi\u1ebft r\u1eb1ng ch\u1ec9 s\u1ed1 c\u1ee7a 1 c\u1ee7a b\u1ea5t k\u1ef3 s\u1ed1 n\u00e0o modulo $n$ ph\u1ea3i l\u00e0 m\u1ed9t \u01b0\u1edbc s\u1ed1 c\u1ee7a $\\phi (n)$. Do \u0111\u00f3, l\u00e0 \u0111\u1ee7 \u0111\u1ec3 x\u00e1c minh cho t\u1ea5t c\u1ea3 c\u00e1c \u01b0\u1edbc s\u1ed1 th\u1ef1c s\u1ef1 $d \\mid \\phi (n)$ r\u1eb1ng $g^d \\not \\equiv 1 \\pmod n$. \u0110\u00e2y \u0111\u00e3 l\u00e0 m\u1ed9t thu\u1eadt to\u00e1n nhanh h\u01a1n nhi\u1ec1u, nh\u01b0ng ch\u00fang ta v\u1eabn c\u00f3 th\u1ec3 l\u00e0m t\u1ed1t h\u01a1n.</p> <p>Ph\u00e2n t\u00edch th\u1eeba s\u1ed1 $\\phi (n) = p_1 ^ {a_1} \\cdots p_s ^ {a_s}$. Ch\u00fang t\u00f4i ch\u1ee9ng minh r\u1eb1ng trong thu\u1eadt to\u00e1n tr\u01b0\u1edbc \u0111\u00f3, ch\u1ec9 c\u1ea7n xem x\u00e9t c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a $d$ c\u00f3 d\u1ea1ng $\\frac { \\phi (n) } {p_j}$. Th\u1eadt v\u1eady, gi\u1ea3 s\u1eed $d$ l\u00e0 b\u1ea5t k\u1ef3 \u01b0\u1edbc s\u1ed1 th\u1ef1c s\u1ef1 n\u00e0o c\u1ee7a $\\phi (n)$. Khi \u0111\u00f3, r\u00f5 r\u00e0ng, t\u1ed3n t\u1ea1i $j$ sao cho $d \\mid \\frac { \\phi (n) } {p_j}$, t\u1ee9c l\u00e0 $d \\cdot k = \\frac { \\phi (n) } {p_j}$. Tuy nhi\u00ean, n\u1ebfu $g^d \\equiv 1 \\pmod n$, ch\u00fang ta s\u1ebd nh\u1eadn \u0111\u01b0\u1ee3c:</p> <p>$g ^ { \\frac { \\phi (n)} {p_j} } \\equiv g ^ {d \\cdot k} \\equiv (g^d) ^k \\equiv 1^k \\equiv 1 \\pmod n$.</p> <p>t\u1ee9c l\u00e0 trong s\u1ed1 c\u00e1c s\u1ed1 c\u00f3 d\u1ea1ng $\\frac {\\phi (n)} {p_i}$, s\u1ebd c\u00f3 \u00edt nh\u1ea5t m\u1ed9t s\u1ed1 sao cho c\u00e1c \u0111i\u1ec1u ki\u1ec7n kh\u00f4ng \u0111\u01b0\u1ee3c \u0111\u00e1p \u1ee9ng.</p> <p>B\u00e2y gi\u1edd ch\u00fang ta c\u00f3 m\u1ed9t thu\u1eadt to\u00e1n ho\u00e0n ch\u1ec9nh \u0111\u1ec3 t\u00ecm c\u0103n nguy\u00ean th\u1ee7y:</p> <ul> <li>\u0110\u1ea7u ti\u00ean, t\u00ecm $\\phi (n)$ v\u00e0 ph\u00e2n t\u00edch th\u1eeba s\u1ed1 n\u00f3.</li> <li> <p>Sau \u0111\u00f3 l\u1eb7p qua t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 $g \\in [1, n]$, v\u00e0 \u0111\u1ed1i v\u1edbi m\u1ed7i s\u1ed1, \u0111\u1ec3 ki\u1ec3m tra xem n\u00f3 c\u00f3 ph\u1ea3i l\u00e0 c\u0103n nguy\u00ean th\u1ee7y hay kh\u00f4ng, ch\u00fang ta th\u1ef1c hi\u1ec7n nh\u01b0 sau:</p> <ul> <li>T\u00ednh t\u1ea5t c\u1ea3 $g ^ { \\frac {\\phi (n)} {p_i}} \\pmod n$.</li> <li>N\u1ebfu t\u1ea5t c\u1ea3 c\u00e1c gi\u00e1 tr\u1ecb \u0111\u01b0\u1ee3c t\u00ednh kh\u00e1c v\u1edbi $1$, th\u00ec $g$ l\u00e0 m\u1ed9t c\u0103n nguy\u00ean th\u1ee7y.</li> </ul> <p>Th\u1eddi gian ch\u1ea1y c\u1ee7a thu\u1eadt to\u00e1n n\u00e0y l\u00e0 $O(Ans \\cdot \\log \\phi (n) \\cdot \\log n)$ (gi\u1ea3 s\u1eed r\u1eb1ng $\\phi (n)$ c\u00f3 $\\log \\phi (n)$ \u01b0\u1edbc s\u1ed1).</p> </li> </ul> <p>Shoup (1990, 1992) \u0111\u00e3 ch\u1ee9ng minh, gi\u1ea3 s\u1eed gi\u1ea3 thuy\u1ebft Riemann t\u1ed5ng qu\u00e1t, r\u1eb1ng $g$ l\u00e0 $O(\\log^6 p)$.</p>","tags":["Translated"]},{"location":"algebra/primitive-root.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>M\u00e3 sau \u0111\u00e2y gi\u1ea3 \u0111\u1ecbnh r\u1eb1ng modulo <code>p</code> l\u00e0 m\u1ed9t s\u1ed1 nguy\u00ean t\u1ed1. \u0110\u1ec3 l\u00e0m cho n\u00f3 ho\u1ea1t \u0111\u1ed9ng cho b\u1ea5t k\u1ef3 gi\u00e1 tr\u1ecb n\u00e0o c\u1ee7a <code>p</code>, ch\u00fang ta ph\u1ea3i th\u00eam t\u00ednh to\u00e1n c\u1ee7a $\\phi (p)$.</p> <pre><code>int powmod (int a, int b, int p) {\n    int res = 1;\n    while (b)\n        if (b &amp; 1)\n            res = int (res * 1ll * a % p),  --b;\n        else\n            a = int (a * 1ll * a % p),  b &gt;&gt;= 1;\n    return res;\n}\n\nint generator (int p) {\n    vector&lt;int&gt; fact;\n    int phi = p-1,  n = phi;\n    for (int i=2; i*i&lt;=n; ++i)\n        if (n % i == 0) {\n            fact.push_back (i);\n            while (n % i == 0)\n                n /= i;\n        }\n    if (n &gt; 1)\n        fact.push_back (n);\n\n    for (int res=2; res&lt;=p; ++res) {\n        bool ok = true;\n        for (size_t i=0; i&lt;fact.size() &amp;&amp; ok; ++i)\n            ok &amp;= powmod (res, phi / fact[i], p) != 1;\n        if (ok)  return res;\n    }\n    return -1;\n}\n</code></pre>","tags":["Translated"]},{"location":"algebra/primitive-root.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 97</li> <li>Translated lines: 97</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Translated"]},{"location":"algebra/sieve-of-eratosthenes.html","title":"S\u00e0ng Eratosthenes (Sieve of Eratosthenes)","text":"<p>S\u00e0ng Eratosthenes l\u00e0 m\u1ed9t thu\u1eadt to\u00e1n \u0111\u1ec3 t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 nguy\u00ean t\u1ed1 trong m\u1ed9t \u0111o\u1ea1n $[1;n]$ s\u1eed d\u1ee5ng $O(n \\log \\log n)$ ph\u00e9p to\u00e1n.</p> <p>Thu\u1eadt to\u00e1n r\u1ea5t \u0111\u01a1n gi\u1ea3n: l\u00fac \u0111\u1ea7u ch\u00fang ta vi\u1ebft ra t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 gi\u1eefa 2 v\u00e0 $n$. Ch\u00fang ta \u0111\u00e1nh d\u1ea5u t\u1ea5t c\u1ea3 c\u00e1c b\u1ed9i s\u1ed1 th\u1ef1c s\u1ef1 c\u1ee7a 2 (v\u00ec 2 l\u00e0 s\u1ed1 nguy\u00ean t\u1ed1 nh\u1ecf nh\u1ea5t) l\u00e0 h\u1ee3p s\u1ed1. M\u1ed9t b\u1ed9i s\u1ed1 th\u1ef1c s\u1ef1 c\u1ee7a m\u1ed9t s\u1ed1 $x$, l\u00e0 m\u1ed9t s\u1ed1 l\u1edbn h\u01a1n $x$ v\u00e0 chia h\u1ebft cho $x$. Sau \u0111\u00f3 ch\u00fang ta t\u00ecm s\u1ed1 ti\u1ebfp theo ch\u01b0a \u0111\u01b0\u1ee3c \u0111\u00e1nh d\u1ea5u l\u00e0 h\u1ee3p s\u1ed1, trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y l\u00e0 3. \u0110i\u1ec1u \u0111\u00f3 c\u00f3 ngh\u0129a l\u00e0 3 l\u00e0 s\u1ed1 nguy\u00ean t\u1ed1, v\u00e0 ch\u00fang ta \u0111\u00e1nh d\u1ea5u t\u1ea5t c\u1ea3 c\u00e1c b\u1ed9i s\u1ed1 th\u1ef1c s\u1ef1 c\u1ee7a 3 l\u00e0 h\u1ee3p s\u1ed1. S\u1ed1 ch\u01b0a \u0111\u01b0\u1ee3c \u0111\u00e1nh d\u1ea5u ti\u1ebfp theo l\u00e0 5, l\u00e0 s\u1ed1 nguy\u00ean t\u1ed1 ti\u1ebfp theo, v\u00e0 ch\u00fang ta \u0111\u00e1nh d\u1ea5u t\u1ea5t c\u1ea3 c\u00e1c b\u1ed9i s\u1ed1 th\u1ef1c s\u1ef1 c\u1ee7a n\u00f3. V\u00e0 ch\u00fang ta ti\u1ebfp t\u1ee5c quy tr\u00ecnh n\u00e0y cho \u0111\u1ebfn khi ch\u00fang ta \u0111\u00e3 x\u1eed l\u00fd t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 trong h\u00e0ng.</p> <p>Trong h\u00ecnh \u1ea3nh sau, b\u1ea1n c\u00f3 th\u1ec3 th\u1ea5y m\u1ed9t h\u00ecnh \u1ea3nh tr\u1ef1c quan c\u1ee7a thu\u1eadt to\u00e1n \u0111\u1ec3 t\u00ednh to\u00e1n t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 nguy\u00ean t\u1ed1 trong ph\u1ea1m vi $[1; 16]$. C\u00f3 th\u1ec3 th\u1ea5y r\u1eb1ng kh\u00e1 th\u01b0\u1eddng xuy\u00ean ch\u00fang ta \u0111\u00e1nh d\u1ea5u c\u00e1c s\u1ed1 l\u00e0 h\u1ee3p s\u1ed1 nhi\u1ec1u l\u1ea7n.</p> <p>\u00dd t\u01b0\u1edfng \u0111\u1eb1ng sau l\u00e0 th\u1ebf n\u00e0y: M\u1ed9t s\u1ed1 l\u00e0 s\u1ed1 nguy\u00ean t\u1ed1, n\u1ebfu kh\u00f4ng c\u00f3 s\u1ed1 nguy\u00ean t\u1ed1 nh\u1ecf h\u01a1n n\u00e0o chia h\u1ebft n\u00f3. V\u00ec ch\u00fang ta l\u1eb7p qua c\u00e1c s\u1ed1 nguy\u00ean t\u1ed1 theo th\u1ee9 t\u1ef1, ch\u00fang ta \u0111\u00e3 \u0111\u00e1nh d\u1ea5u t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1, chia h\u1ebft cho \u00edt nh\u1ea5t m\u1ed9t trong c\u00e1c s\u1ed1 nguy\u00ean t\u1ed1, l\u00e0 chia h\u1ebft. Do \u0111\u00f3, n\u1ebfu ch\u00fang ta \u0111\u1ebfn m\u1ed9t \u00f4 v\u00e0 n\u00f3 ch\u01b0a \u0111\u01b0\u1ee3c \u0111\u00e1nh d\u1ea5u, th\u00ec n\u00f3 kh\u00f4ng chia h\u1ebft cho b\u1ea5t k\u1ef3 s\u1ed1 nguy\u00ean t\u1ed1 nh\u1ecf h\u01a1n n\u00e0o v\u00e0 do \u0111\u00f3 ph\u1ea3i l\u00e0 s\u1ed1 nguy\u00ean t\u1ed1.</p>","tags":["Translated"]},{"location":"algebra/sieve-of-eratosthenes.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<pre><code>int n;\nvector&lt;bool&gt; is_prime(n+1, true);\nis_prime[0] = is_prime[1] = false;\nfor (int i = 2; i &lt;= n; i++) {\n    if (is_prime[i] &amp;&amp; (long long)i * i &lt;= n) {\n        for (int j = i * i; j &lt;= n; j += i)\n            is_prime[j] = false;\n    }\n}\n</code></pre> <p>M\u00e3 n\u00e0y \u0111\u1ea7u ti\u00ean \u0111\u00e1nh d\u1ea5u t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 ngo\u1ea1i tr\u1eeb kh\u00f4ng v\u00e0 m\u1ed9t l\u00e0 c\u00e1c s\u1ed1 nguy\u00ean t\u1ed1 ti\u1ec1m n\u0103ng, sau \u0111\u00f3 n\u00f3 b\u1eaft \u0111\u1ea7u qu\u00e1 tr\u00ecnh s\u00e0ng l\u1ecdc c\u00e1c h\u1ee3p s\u1ed1. \u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y n\u00f3 l\u1eb7p qua t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 t\u1eeb $2$ \u0111\u1ebfn $n$. N\u1ebfu s\u1ed1 hi\u1ec7n t\u1ea1i $i$ l\u00e0 m\u1ed9t s\u1ed1 nguy\u00ean t\u1ed1, n\u00f3 \u0111\u00e1nh d\u1ea5u t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 l\u00e0 b\u1ed9i c\u1ee7a $i$ l\u00e0 h\u1ee3p s\u1ed1, b\u1eaft \u0111\u1ea7u t\u1eeb $i^2$. \u0110\u00e2y \u0111\u00e3 l\u00e0 m\u1ed9t s\u1ef1 t\u1ed1i \u01b0u h\u00f3a so v\u1edbi c\u00e1ch ng\u00e2y th\u01a1 khi c\u00e0i \u0111\u1eb7t n\u00f3, v\u00e0 \u0111\u01b0\u1ee3c cho ph\u00e9p v\u00ec t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 nh\u1ecf h\u01a1n l\u00e0 b\u1ed9i c\u1ee7a $i$ nh\u1ea5t thi\u1ebft c\u0169ng c\u00f3 m\u1ed9t th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1 nh\u1ecf h\u01a1n $i$, v\u00ec v\u1eady t\u1ea5t c\u1ea3 ch\u00fang \u0111\u00e3 \u0111\u01b0\u1ee3c s\u00e0ng l\u1ecdc tr\u01b0\u1edbc \u0111\u00f3. V\u00ec $i^2$ c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng tr\u00e0n ki\u1ec3u <code>int</code>, vi\u1ec7c x\u00e1c minh b\u1ed5 sung \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng ki\u1ec3u <code>long long</code> tr\u01b0\u1edbc v\u00f2ng l\u1eb7p l\u1ed3ng nhau th\u1ee9 hai.</p> <p>S\u1eed d\u1ee5ng c\u00e0i \u0111\u1eb7t nh\u01b0 v\u1eady thu\u1eadt to\u00e1n ti\u00eau th\u1ee5 $O(n)$ b\u1ed9 nh\u1edb (r\u00f5 r\u00e0ng) v\u00e0 th\u1ef1c hi\u1ec7n $O(n \\log \\log n)$ (xem ph\u1ea7n ti\u1ebfp theo).</p>","tags":["Translated"]},{"location":"algebra/sieve-of-eratosthenes.html#asymptotic-analysis","title":"Ph\u00e2n t\u00edch ti\u1ec7m c\u1eadn (Asymptotic analysis)","text":"<p>R\u1ea5t \u0111\u01a1n gi\u1ea3n \u0111\u1ec3 ch\u1ee9ng minh th\u1eddi gian ch\u1ea1y l\u00e0 $O(n \\log n)$ m\u00e0 kh\u00f4ng c\u1ea7n bi\u1ebft b\u1ea5t c\u1ee9 \u0111i\u1ec1u g\u00ec v\u1ec1 ph\u00e2n b\u1ed1 c\u1ee7a c\u00e1c s\u1ed1 nguy\u00ean t\u1ed1 - b\u1ecf qua ki\u1ec3m tra <code>is_prime</code>, v\u00f2ng l\u1eb7p b\u00ean trong ch\u1ea1y (nhi\u1ec1u nh\u1ea5t) $n/i$ l\u1ea7n cho $i = 2, 3, 4, \\dots$, d\u1eabn \u0111\u1ebfn t\u1ed5ng s\u1ed1 ph\u00e9p to\u00e1n trong v\u00f2ng l\u1eb7p b\u00ean trong l\u00e0 m\u1ed9t t\u1ed5ng \u0111i\u1ec1u h\u00f2a nh\u01b0 $n(1/2 + 1/3 + 1/4 + \\cdots)$, b\u1ecb gi\u1edbi h\u1ea1n b\u1edfi $O(n \\log n)$.</p> <p>H\u00e3y ch\u1ee9ng minh r\u1eb1ng th\u1eddi gian ch\u1ea1y c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 $O(n \\log \\log n)$. Thu\u1eadt to\u00e1n s\u1ebd th\u1ef1c hi\u1ec7n $\\frac{n}{p}$ c\u00e1c ph\u00e9p to\u00e1n cho m\u1ed7i s\u1ed1 nguy\u00ean t\u1ed1 $p \\le n$ trong v\u00f2ng l\u1eb7p b\u00ean trong. Do \u0111\u00f3, ch\u00fang ta c\u1ea7n \u0111\u00e1nh gi\u00e1 bi\u1ec3u th\u1ee9c ti\u1ebfp theo:</p> $$\\sum_{\\substack{p \\le n, \\\\\\ p \\text{ prime}}} \\frac n p = n \\cdot \\sum_{\\substack{p \\le n, \\\\\\ p \\text{ prime}}} \\frac 1 p.$$ <p>H\u00e3y nh\u1edb l\u1ea1i hai s\u1ef1 th\u1eadt \u0111\u00e3 bi\u1ebft.</p> <ul> <li>S\u1ed1 l\u01b0\u1ee3ng c\u00e1c s\u1ed1 nguy\u00ean t\u1ed1 nh\u1ecf h\u01a1n ho\u1eb7c b\u1eb1ng $n$ x\u1ea5p x\u1ec9 $\\frac n {\\ln n}$.</li> <li>S\u1ed1 nguy\u00ean t\u1ed1 th\u1ee9 $k$ x\u1ea5p x\u1ec9 b\u1eb1ng $k \\ln k$ (\u0111i\u1ec1u n\u00e0y theo sau t\u1eeb s\u1ef1 th\u1eadt tr\u01b0\u1edbc \u0111\u00f3).</li> </ul> <p>Do \u0111\u00f3 ch\u00fang ta c\u00f3 th\u1ec3 vi\u1ebft t\u1ed5ng theo c\u00e1ch sau:</p> $$\\sum_{\\substack{p \\le n, \\\\\\ p \\text{ prime}}} \\frac 1 p \\approx \\frac 1 2 + \\sum_{k = 2}^{\\frac n {\\ln n}} \\frac 1 {k \\ln k}.$$ <p>\u1ede \u0111\u00e2y ch\u00fang ta \u0111\u00e3 tr\u00edch xu\u1ea5t s\u1ed1 nguy\u00ean t\u1ed1 \u0111\u1ea7u ti\u00ean 2 t\u1eeb t\u1ed5ng, b\u1edfi v\u00ec $k = 1$ trong x\u1ea5p x\u1ec9 $k \\ln k$ l\u00e0 $0$ v\u00e0 g\u00e2y ra ph\u00e9p chia cho s\u1ed1 kh\u00f4ng.</p> <p>B\u00e2y gi\u1edd, h\u00e3y \u0111\u00e1nh gi\u00e1 t\u1ed5ng n\u00e0y b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng t\u00edch ph\u00e2n c\u1ee7a c\u00f9ng m\u1ed9t h\u00e0m tr\u00ean $k$ t\u1eeb $2$ \u0111\u1ebfn $\\frac n {\\ln n}$ (ch\u00fang ta c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n x\u1ea5p x\u1ec9 nh\u01b0 v\u1eady b\u1edfi v\u00ec, th\u1ef1c t\u1ebf, t\u1ed5ng li\u00ean quan \u0111\u1ebfn t\u00edch ph\u00e2n nh\u01b0 l\u00e0 x\u1ea5p x\u1ec9 c\u1ee7a n\u00f3 b\u1eb1ng ph\u01b0\u01a1ng ph\u00e1p h\u00ecnh ch\u1eef nh\u1eadt):</p> $$\\sum_{k = 2}^{\\frac n {\\ln n}} \\frac 1 {k \\ln k} \\approx \\int_2^{\\frac n {\\ln n}} \\frac 1 {k \\ln k} dk.$$ <p>Nguy\u00ean h\u00e0m cho h\u00e0m d\u01b0\u1edbi d\u1ea5u t\u00edch ph\u00e2n l\u00e0 $\\ln \\ln k$. S\u1eed d\u1ee5ng ph\u00e9p thay th\u1ebf v\u00e0 lo\u1ea1i b\u1ecf c\u00e1c s\u1ed1 h\u1ea1ng b\u1eadc th\u1ea5p h\u01a1n, ch\u00fang ta s\u1ebd nh\u1eadn \u0111\u01b0\u1ee3c k\u1ebft qu\u1ea3:</p> $$\\int_2^{\\frac n {\\ln n}} \\frac 1 {k \\ln k} dk = \\ln \\ln \\frac n {\\ln n} - \\ln \\ln 2 = \\ln(\\ln n - \\ln \\ln n) - \\ln \\ln 2 \\approx \\ln \\ln n.$$ <p>B\u00e2y gi\u1edd, quay l\u1ea1i t\u1ed5ng ban \u0111\u1ea7u, ch\u00fang ta s\u1ebd nh\u1eadn \u0111\u01b0\u1ee3c \u0111\u00e1nh gi\u00e1 x\u1ea5p x\u1ec9 c\u1ee7a n\u00f3:</p> $$\\sum_{\\substack{p \\le n, \\\\\\ p\\ is\\ prime}} \\frac n p \\approx n \\ln \\ln n + o(n).$$ <p>B\u1ea1n c\u00f3 th\u1ec3 t\u00ecm th\u1ea5y m\u1ed9t ch\u1ee9ng minh ch\u1eb7t ch\u1ebd h\u01a1n (mang l\u1ea1i \u0111\u00e1nh gi\u00e1 ch\u00ednh x\u00e1c h\u01a1n trong ph\u1ea1m vi c\u00e1c h\u1ec7 s\u1ed1 h\u1eb1ng) trong cu\u1ed1n s\u00e1ch \u0111\u01b0\u1ee3c vi\u1ebft b\u1edfi Hardy &amp; Wright \"An Introduction to the Theory of Numbers\" (tr. 349).</p>","tags":["Translated"]},{"location":"algebra/sieve-of-eratosthenes.html#different-optimizations-of-the-sieve-of-eratosthenes","title":"C\u00e1c t\u1ed1i \u01b0u h\u00f3a kh\u00e1c nhau c\u1ee7a S\u00e0ng Eratosthenes (Different optimizations of the Sieve of Eratosthenes)","text":"<p>\u0110i\u1ec3m y\u1ebfu l\u1edbn nh\u1ea5t c\u1ee7a thu\u1eadt to\u00e1n l\u00e0, n\u00f3 \"\u0111i b\u1ed9\" d\u1ecdc theo b\u1ed9 nh\u1edb nhi\u1ec1u l\u1ea7n, ch\u1ec9 thao t\u00e1c c\u00e1c ph\u1ea7n t\u1eed \u0111\u01a1n l\u1ebb. \u0110i\u1ec1u n\u00e0y kh\u00f4ng th\u00e2n thi\u1ec7n v\u1edbi b\u1ed9 nh\u1edb cache. V\u00e0 v\u00ec \u0111i\u1ec1u \u0111\u00f3, h\u1eb1ng s\u1ed1 \u1ea9n trong $O(n \\log \\log n)$ l\u00e0 kh\u00e1 l\u1edbn.</p> <p>Ngo\u00e0i ra, b\u1ed9 nh\u1edb ti\u00eau th\u1ee5 l\u00e0 m\u1ed9t n\u00fat th\u1eaft c\u1ed5 chai cho $n$ l\u1edbn.</p> <p>C\u00e1c ph\u01b0\u01a1ng ph\u00e1p \u0111\u01b0\u1ee3c tr\u00ecnh b\u00e0y d\u01b0\u1edbi \u0111\u00e2y cho ph\u00e9p ch\u00fang ta gi\u1ea3m s\u1ed1 l\u01b0\u1ee3ng c\u00e1c ph\u00e9p to\u00e1n \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n, c\u0169ng nh\u01b0 r\u00fat ng\u1eafn b\u1ed9 nh\u1edb ti\u00eau th\u1ee5 \u0111\u00e1ng k\u1ec3.</p>","tags":["Translated"]},{"location":"algebra/sieve-of-eratosthenes.html#sieving-till-root","title":"S\u00e0ng \u0111\u1ebfn c\u0103n b\u1eadc hai (Sieving till root)","text":"<p>R\u00f5 r\u00e0ng, \u0111\u1ec3 t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 nguy\u00ean t\u1ed1 cho \u0111\u1ebfn $n$, s\u1ebd l\u00e0 \u0111\u1ee7 \u0111\u1ec3 ch\u1ec9 th\u1ef1c hi\u1ec7n vi\u1ec7c s\u00e0ng l\u1ecdc ch\u1ec9 b\u1eb1ng c\u00e1c s\u1ed1 nguy\u00ean t\u1ed1, kh\u00f4ng v\u01b0\u1ee3t qu\u00e1 c\u0103n b\u1eadc hai c\u1ee7a $n$.</p> <pre><code>int n;\nvector&lt;bool&gt; is_prime(n+1, true);\nis_prime[0] = is_prime[1] = false;\nfor (int i = 2; i * i &lt;= n; i++) {\n    if (is_prime[i]) {\n        for (int j = i * i; j &lt;= n; j += i)\n            is_prime[j] = false;\n    }\n}\n</code></pre> <p>T\u1ed1i \u01b0u h\u00f3a nh\u01b0 v\u1eady kh\u00f4ng \u1ea3nh h\u01b0\u1edfng \u0111\u1ebfn \u0111\u1ed9 ph\u1ee9c t\u1ea1p (th\u1eadt v\u1eady, b\u1eb1ng c\u00e1ch l\u1eb7p l\u1ea1i ch\u1ee9ng minh \u0111\u01b0\u1ee3c tr\u00ecnh b\u00e0y \u1edf tr\u00ean ch\u00fang ta s\u1ebd nh\u1eadn \u0111\u01b0\u1ee3c \u0111\u00e1nh gi\u00e1 $n \\ln \\ln \\sqrt n + o(n)$, l\u00e0 ti\u1ec7m c\u1eadn gi\u1ed1ng nhau theo c\u00e1c t\u00ednh ch\u1ea5t c\u1ee7a logarit), m\u1eb7c d\u00f9 s\u1ed1 l\u01b0\u1ee3ng c\u00e1c ph\u00e9p to\u00e1n s\u1ebd gi\u1ea3m \u0111\u00e1ng k\u1ec3.</p>","tags":["Translated"]},{"location":"algebra/sieve-of-eratosthenes.html#sieving-by-the-odd-numbers-only","title":"Ch\u1ec9 s\u00e0ng c\u00e1c s\u1ed1 l\u1ebb (Sieving by the odd numbers only)","text":"<p>V\u00ec t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 ch\u1eb5n (ngo\u1ea1i tr\u1eeb $2$) l\u00e0 h\u1ee3p s\u1ed1, ch\u00fang ta c\u00f3 th\u1ec3 ng\u1eebng ki\u1ec3m tra c\u00e1c s\u1ed1 ch\u1eb5n ho\u00e0n to\u00e0n. Thay v\u00e0o \u0111\u00f3, ch\u00fang ta c\u1ea7n ho\u1ea1t \u0111\u1ed9ng v\u1edbi c\u00e1c s\u1ed1 l\u1ebb th\u00f4i.</p> <p>Th\u1ee9 nh\u1ea5t, n\u00f3 s\u1ebd cho ph\u00e9p ch\u00fang ta gi\u1ea3m m\u1ed9t n\u1eeda b\u1ed9 nh\u1edb c\u1ea7n thi\u1ebft. Th\u1ee9 hai, n\u00f3 s\u1ebd gi\u1ea3m s\u1ed1 l\u01b0\u1ee3ng c\u00e1c ph\u00e9p to\u00e1n \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n b\u1edfi thu\u1eadt to\u00e1n x\u1ea5p x\u1ec9 m\u1ed9t n\u1eeda.</p>","tags":["Translated"]},{"location":"algebra/sieve-of-eratosthenes.html#memory-consumption-and-speed-of-operations","title":"Ti\u00eau th\u1ee5 b\u1ed9 nh\u1edb v\u00e0 t\u1ed1c \u0111\u1ed9 (Memory consumption and speed of operations)","text":"<p>Ch\u00fang ta n\u00ean nh\u1eadn th\u1ea5y, r\u1eb1ng hai c\u00e0i \u0111\u1eb7t n\u00e0y c\u1ee7a S\u00e0ng Eratosthenes s\u1eed d\u1ee5ng $n$ bit b\u1ed9 nh\u1edb b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng c\u1ea5u tr\u00fac d\u1eef li\u1ec7u <code>vector&lt;bool&gt;</code>. <code>vector&lt;bool&gt;</code> kh\u00f4ng ph\u1ea3i l\u00e0 m\u1ed9t container th\u00f4ng th\u01b0\u1eddng l\u01b0u tr\u1eef m\u1ed9t lo\u1ea1t c\u00e1c <code>bool</code> (nh\u01b0 trong h\u1ea7u h\u1ebft c\u00e1c ki\u1ebfn tr\u00fac m\u00e1y t\u00ednh m\u1ed9t <code>bool</code> chi\u1ebfm m\u1ed9t byte b\u1ed9 nh\u1edb). N\u00f3 l\u00e0 m\u1ed9t chuy\u00ean m\u00f4n h\u00f3a t\u1ed1i \u01b0u h\u00f3a b\u1ed9 nh\u1edb c\u1ee7a <code>vector&lt;T&gt;</code>, ch\u1ec9 ti\u00eau th\u1ee5 $\\frac{N}{8}$ byte b\u1ed9 nh\u1edb.</p> <p>C\u00e1c ki\u1ebfn tr\u00fac b\u1ed9 x\u1eed l\u00fd hi\u1ec7n \u0111\u1ea1i l\u00e0m vi\u1ec7c hi\u1ec7u qu\u1ea3 h\u01a1n nhi\u1ec1u v\u1edbi byte so v\u1edbi bit v\u00ec ch\u00fang th\u01b0\u1eddng kh\u00f4ng th\u1ec3 truy c\u1eadp bit tr\u1ef1c ti\u1ebfp. V\u00ec v\u1eady b\u00ean d\u01b0\u1edbi <code>vector&lt;bool&gt;</code> l\u01b0u tr\u1eef c\u00e1c bit trong m\u1ed9t b\u1ed9 nh\u1edb li\u00ean t\u1ee5c l\u1edbn, truy c\u1eadp b\u1ed9 nh\u1edb trong c\u00e1c kh\u1ed1i v\u00e0i byte, v\u00e0 tr\u00edch xu\u1ea5t/\u0111\u1eb7t c\u00e1c bit b\u1eb1ng c\u00e1c ph\u00e9p to\u00e1n bit nh\u01b0 m\u1eb7t n\u1ea1 bit v\u00e0 d\u1ecbch bit.</p> <p>V\u00ec \u0111i\u1ec1u \u0111\u00f3 c\u00f3 m\u1ed9t chi ph\u00ed nh\u1ea5t \u0111\u1ecbnh khi b\u1ea1n \u0111\u1ecdc ho\u1eb7c ghi c\u00e1c bit v\u1edbi m\u1ed9t <code>vector&lt;bool&gt;</code>, v\u00e0 kh\u00e1 th\u01b0\u1eddng xuy\u00ean s\u1eed d\u1ee5ng m\u1ed9t <code>vector&lt;char&gt;</code> (s\u1eed d\u1ee5ng 1 byte cho m\u1ed7i m\u1ee5c, v\u00ec v\u1eady g\u1ea5p 8 l\u1ea7n l\u01b0\u1ee3ng b\u1ed9 nh\u1edb) l\u00e0 nhanh h\u01a1n.</p> <p>Tuy nhi\u00ean, \u0111\u1ed1i v\u1edbi c\u00e1c c\u00e0i \u0111\u1eb7t \u0111\u01a1n gi\u1ea3n c\u1ee7a S\u00e0ng Eratosthenes s\u1eed d\u1ee5ng m\u1ed9t <code>vector&lt;bool&gt;</code> l\u00e0 nhanh h\u01a1n. B\u1ea1n b\u1ecb gi\u1edbi h\u1ea1n b\u1edfi t\u1ed1c \u0111\u1ed9 b\u1ea1n c\u00f3 th\u1ec3 t\u1ea3i d\u1eef li\u1ec7u v\u00e0o b\u1ed9 nh\u1edb cache, v\u00e0 do \u0111\u00f3 s\u1eed d\u1ee5ng \u00edt b\u1ed9 nh\u1edb h\u01a1n mang l\u1ea1i l\u1ee3i th\u1ebf l\u1edbn. M\u1ed9t b\u00e0i ki\u1ec3m tra \u0111i\u1ec3m chu\u1ea9n (li\u00ean k\u1ebft) cho th\u1ea5y, r\u1eb1ng s\u1eed d\u1ee5ng m\u1ed9t <code>vector&lt;bool&gt;</code> l\u00e0 nhanh h\u01a1n t\u1eeb 1.4 l\u1ea7n \u0111\u1ebfn 1.7 l\u1ea7n so v\u1edbi s\u1eed d\u1ee5ng m\u1ed9t <code>vector&lt;char&gt;</code>.</p> <p>C\u00e1c c\u00e2n nh\u1eafc t\u01b0\u01a1ng t\u1ef1 c\u0169ng \u00e1p d\u1ee5ng cho <code>bitset</code>. N\u00f3 c\u0169ng l\u00e0 m\u1ed9t c\u00e1ch hi\u1ec7u qu\u1ea3 \u0111\u1ec3 l\u01b0u tr\u1eef c\u00e1c bit, t\u01b0\u01a1ng t\u1ef1 nh\u01b0 <code>vector&lt;bool&gt;</code>, v\u00ec v\u1eady n\u00f3 ch\u1ec9 m\u1ea5t $\\frac{N}{8}$ byte b\u1ed9 nh\u1edb, nh\u01b0ng ch\u1eadm h\u01a1n m\u1ed9t ch\u00fat trong vi\u1ec7c truy c\u1eadp c\u00e1c ph\u1ea7n t\u1eed. Trong b\u00e0i ki\u1ec3m tra \u0111i\u1ec3m chu\u1ea9n \u1edf tr\u00ean <code>bitset</code> ho\u1ea1t \u0111\u1ed9ng k\u00e9m h\u01a1n m\u1ed9t ch\u00fat so v\u1edbi <code>vector&lt;bool&gt;</code>. M\u1ed9t nh\u01b0\u1ee3c \u0111i\u1ec3m kh\u00e1c t\u1eeb <code>bitset</code> l\u00e0 b\u1ea1n c\u1ea7n bi\u1ebft k\u00edch th\u01b0\u1edbc t\u1ea1i th\u1eddi \u0111i\u1ec3m bi\u00ean d\u1ecbch.</p>","tags":["Translated"]},{"location":"algebra/sieve-of-eratosthenes.html#segmented-sieve","title":"S\u00e0ng ph\u00e2n \u0111o\u1ea1n (Segmented Sieve)","text":"<p>T\u1eeb t\u1ed1i \u01b0u h\u00f3a \"s\u00e0ng \u0111\u1ebfn c\u0103n b\u1eadc hai\", suy ra r\u1eb1ng kh\u00f4ng c\u1ea7n thi\u1ebft ph\u1ea3i gi\u1eef to\u00e0n b\u1ed9 m\u1ea3ng <code>is_prime[1...n]</code> m\u1ecdi l\u00fac. \u0110\u1ed1i v\u1edbi vi\u1ec7c s\u00e0ng l\u1ecdc l\u00e0 \u0111\u1ee7 \u0111\u1ec3 ch\u1ec9 gi\u1eef c\u00e1c s\u1ed1 nguy\u00ean t\u1ed1 cho \u0111\u1ebfn c\u0103n b\u1eadc hai c\u1ee7a $n$, t\u1ee9 l\u00e0 <code>prime[1... sqrt(n)]</code>, chia ph\u1ea1m vi ho\u00e0n ch\u1ec9nh th\u00e0nh c\u00e1c kh\u1ed1i, v\u00e0 s\u00e0ng t\u1eebng kh\u1ed1i ri\u00eang bi\u1ec7t.</p> <p>G\u1ecdi $s$ l\u00e0 m\u1ed9t h\u1eb1ng s\u1ed1 x\u00e1c \u0111\u1ecbnh k\u00edch th\u01b0\u1edbc c\u1ee7a kh\u1ed1i, sau \u0111\u00f3 ch\u00fang ta c\u00f3 $\\lceil {\\frac n s} \\rceil$ kh\u1ed1i t\u1ea5t c\u1ea3, v\u00e0 kh\u1ed1i $k$ ($k = 0 ... \\lfloor {\\frac n s} \\rfloor$) ch\u1ee9a c\u00e1c s\u1ed1 trong m\u1ed9t \u0111o\u1ea1n $[ks; ks + s - 1]$. Ch\u00fang ta c\u00f3 th\u1ec3 l\u00e0m vi\u1ec7c tr\u00ean c\u00e1c kh\u1ed1i l\u1ea7n l\u01b0\u1ee3t, t\u1ee9c l\u00e0 \u0111\u1ed1i v\u1edbi m\u1ed7i kh\u1ed1i $k$ ch\u00fang ta s\u1ebd \u0111i qua t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 nguy\u00ean t\u1ed1 (t\u1eeb $1$ \u0111\u1ebfn $\\sqrt n$) v\u00e0 th\u1ef1c hi\u1ec7n s\u00e0ng l\u1ecdc s\u1eed d\u1ee5ng ch\u00fang. \u0110\u00e1ng ch\u00fa \u00fd l\u00e0, ch\u00fang ta ph\u1ea3i s\u1eeda \u0111\u1ed5i chi\u1ebfn l\u01b0\u1ee3c m\u1ed9t ch\u00fat khi x\u1eed l\u00fd c\u00e1c s\u1ed1 \u0111\u1ea7u ti\u00ean: th\u1ee9 nh\u1ea5t, t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 nguy\u00ean t\u1ed1 t\u1eeb $[1; \\sqrt n]$ kh\u00f4ng n\u00ean lo\u1ea1i b\u1ecf ch\u00ednh n\u00f3; v\u00e0 th\u1ee9 hai, c\u00e1c s\u1ed1 $0$ v\u00e0 $1$ n\u00ean \u0111\u01b0\u1ee3c \u0111\u00e1nh d\u1ea5u l\u00e0 s\u1ed1 kh\u00f4ng ph\u1ea3i nguy\u00ean t\u1ed1. Trong khi l\u00e0m vi\u1ec7c tr\u00ean kh\u1ed1i cu\u1ed1i c\u00f9ng kh\u00f4ng n\u00ean qu\u00ean r\u1eb1ng s\u1ed1 c\u1ea7n thi\u1ebft cu\u1ed1i c\u00f9ng $n$ kh\u00f4ng nh\u1ea5t thi\u1ebft n\u1eb1m \u1edf cu\u1ed1i kh\u1ed1i.</p> <p>Nh\u01b0 \u0111\u00e3 th\u1ea3o lu\u1eadn tr\u01b0\u1edbc \u0111\u00e2y, vi\u1ec7c c\u00e0i \u0111\u1eb7t \u0111i\u1ec3n h\u00ecnh c\u1ee7a S\u00e0ng Eratosthenes b\u1ecb gi\u1edbi h\u1ea1n b\u1edfi t\u1ed1c \u0111\u1ed9 t\u1ea3i d\u1eef li\u1ec7u v\u00e0o b\u1ed9 \u0111\u1ec7m CPU nhanh nh\u01b0 th\u1ebf n\u00e0o. B\u1eb1ng c\u00e1ch chia ph\u1ea1m vi c\u00e1c s\u1ed1 nguy\u00ean t\u1ed1 ti\u1ec1m n\u0103ng $[1; n]$ th\u00e0nh c\u00e1c kh\u1ed1i nh\u1ecf h\u01a1n, ch\u00fang ta kh\u00f4ng bao gi\u1edd ph\u1ea3i gi\u1eef nhi\u1ec1u kh\u1ed1i trong b\u1ed9 nh\u1edb c\u00f9ng m\u1ed9t l\u00fac, v\u00e0 t\u1ea5t c\u1ea3 c\u00e1c ph\u00e9p to\u00e1n th\u00e2n thi\u1ec7n v\u1edbi b\u1ed9 nh\u1edb cache h\u01a1n nhi\u1ec1u. Khi ch\u00fang ta kh\u00f4ng c\u00f2n b\u1ecb gi\u1edbi h\u1ea1n b\u1edfi t\u1ed1c \u0111\u1ed9 b\u1ed9 nh\u1edb cache, ch\u00fang ta c\u00f3 th\u1ec3 thay th\u1ebf <code>vector&lt;bool&gt;</code> b\u1eb1ng <code>vector&lt;char&gt;</code>, v\u00e0 \u0111\u1ea1t \u0111\u01b0\u1ee3c m\u1ed9t s\u1ed1 hi\u1ec7u su\u1ea5t b\u1ed5 sung v\u00ec c\u00e1c b\u1ed9 x\u1eed l\u00fd c\u00f3 th\u1ec3 x\u1eed l\u00fd \u0111\u1ecdc v\u00e0 ghi v\u1edbi byte tr\u1ef1c ti\u1ebfp v\u00e0 kh\u00f4ng c\u1ea7n d\u1ef1a v\u00e0o c\u00e1c ph\u00e9p to\u00e1n bit \u0111\u1ec3 tr\u00edch xu\u1ea5t c\u00e1c bit ri\u00eang l\u1ebb. B\u00e0i ki\u1ec3m tra \u0111i\u1ec3m chu\u1ea9n (li\u00ean k\u1ebft) cho th\u1ea5y, r\u1eb1ng s\u1eed d\u1ee5ng m\u1ed9t <code>vector&lt;char&gt;</code> nhanh h\u01a1n kho\u1ea3ng 3 l\u1ea7n trong t\u00ecnh hu\u1ed1ng n\u00e0y so v\u1edbi s\u1eed d\u1ee5ng m\u1ed9t <code>vector&lt;bool&gt;</code>. M\u1ed9t l\u1eddi c\u1ea3nh b\u00e1o: nh\u1eefng con s\u1ed1 \u0111\u00f3 c\u00f3 th\u1ec3 kh\u00e1c nhau t\u00f9y thu\u1ed9c v\u00e0o ki\u1ebfn tr\u00fac, tr\u00ecnh bi\u00ean d\u1ecbch v\u00e0 m\u1ee9c \u0111\u1ed9 t\u1ed1i \u01b0u h\u00f3a.</p> <p>\u1ede \u0111\u00e2y ch\u00fang t\u00f4i c\u00f3 m\u1ed9t c\u00e0i \u0111\u1eb7t \u0111\u1ebfm s\u1ed1 l\u01b0\u1ee3ng c\u00e1c s\u1ed1 nguy\u00ean t\u1ed1 nh\u1ecf h\u01a1n ho\u1eb7c b\u1eb1ng $n$ s\u1eed d\u1ee5ng s\u00e0ng kh\u1ed1i.</p> <pre><code>int count_primes(int n) {\n    const int S = 10000;\n\n    vector&lt;int&gt; primes;\n    int nsqrt = sqrt(n);\n    vector&lt;char&gt; is_prime(nsqrt + 2, true);\n    for (int i = 2; i &lt;= nsqrt; i++) {\n        if (is_prime[i]) {\n            primes.push_back(i);\n            for (int j = i * i; j &lt;= nsqrt; j += i)\n                is_prime[j] = false;\n        }\n    }\n\n    int result = 0;\n    vector&lt;char&gt; block(S);\n    for (int k = 0; k * S &lt;= n; k++) {\n        fill(block.begin(), block.end(), true);\n        int start = k * S;\n        for (int p : primes) {\n            int start_idx = (start + p - 1) / p;\n            int j = max(start_idx, p) * p - start;\n            for (; j &lt; S; j += p)\n                block[j] = false;\n        }\n        if (k == 0)\n            block[0] = block[1] = false;\n        for (int i = 0; i &lt; S &amp;&amp; start + i &lt;= n; i++) {\n            if (block[i])\n                result++;\n        }\n    }\n    return result;\n}\n</code></pre> <p>Th\u1eddi gian ch\u1ea1y c\u1ee7a s\u00e0ng kh\u1ed1i gi\u1ed1ng nh\u01b0 \u0111\u1ed1i v\u1edbi s\u00e0ng Eratosthenes th\u00f4ng th\u01b0\u1eddng (tr\u1eeb khi k\u00edch th\u01b0\u1edbc c\u1ee7a c\u00e1c kh\u1ed1i r\u1ea5t nh\u1ecf), nh\u01b0ng b\u1ed9 nh\u1edb c\u1ea7n thi\u1ebft s\u1ebd r\u00fat ng\u1eafn c\u00f2n $O(\\sqrt{n} + S)$ v\u00e0 ch\u00fang ta c\u00f3 k\u1ebft qu\u1ea3 l\u01b0u tr\u1eef \u0111\u1ec7m t\u1ed1t h\u01a1n. M\u1eb7t kh\u00e1c, s\u1ebd c\u00f3 m\u1ed9t ph\u00e9p chia cho m\u1ed7i c\u1eb7p kh\u1ed1i v\u00e0 s\u1ed1 nguy\u00ean t\u1ed1 t\u1eeb $[1; \\sqrt{n}]$, v\u00e0 \u0111i\u1ec1u \u0111\u00f3 s\u1ebd t\u1ed3i t\u1ec7 h\u01a1n nhi\u1ec1u \u0111\u1ed1i v\u1edbi k\u00edch th\u01b0\u1edbc kh\u1ed1i nh\u1ecf h\u01a1n. Do \u0111\u00f3, c\u1ea7n ph\u1ea3i gi\u1eef c\u00e2n b\u1eb1ng khi ch\u1ecdn h\u1eb1ng s\u1ed1 $S$. Ch\u00fang t\u00f4i \u0111\u1ea1t \u0111\u01b0\u1ee3c k\u1ebft qu\u1ea3 t\u1ed1t nh\u1ea5t cho k\u00edch th\u01b0\u1edbc kh\u1ed1i gi\u1eefa $10^4$ v\u00e0 $10^5$.</p>","tags":["Translated"]},{"location":"algebra/sieve-of-eratosthenes.html#find-primes-in-range","title":"T\u00ecm s\u1ed1 nguy\u00ean t\u1ed1 trong ph\u1ea1m vi (Find primes in range)","text":"<p>\u0110\u00f4i khi ch\u00fang ta c\u1ea7n t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 nguy\u00ean t\u1ed1 trong m\u1ed9t ph\u1ea1m vi $[L,R]$ k\u00edch th\u01b0\u1edbc nh\u1ecf (v\u00ed d\u1ee5 $R - L + 1 \\approx 1e7$), trong \u0111\u00f3 $R$ c\u00f3 th\u1ec3 r\u1ea5t l\u1edbn (v\u00ed d\u1ee5 $1e12$).</p> <p>\u0110\u1ec3 gi\u1ea3i quy\u1ebft m\u1ed9t v\u1ea5n \u0111\u1ec1 nh\u01b0 v\u1eady, ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng \u00fd t\u01b0\u1edfng c\u1ee7a S\u00e0ng ph\u00e2n \u0111o\u1ea1n. Ch\u00fang t\u00f4i t\u1ea1o tr\u01b0\u1edbc t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 nguy\u00ean t\u1ed1 l\u00ean \u0111\u1ebfn $\\sqrt R$, v\u00e0 s\u1eed d\u1ee5ng c\u00e1c s\u1ed1 nguy\u00ean t\u1ed1 \u0111\u00f3 \u0111\u1ec3 \u0111\u00e1nh d\u1ea5u t\u1ea5t c\u1ea3 c\u00e1c h\u1ee3p s\u1ed1 trong \u0111o\u1ea1n $[L, R]$.</p> <p><pre><code>vector&lt;char&gt; segmentedSieve(long long L, long long R) {\n    // generate all primes up to sqrt(R)\n    long long lim = sqrt(R);\n    vector&lt;char&gt; mark(lim + 1, false);\n    vector&lt;long long&gt; primes;\n    for (long long i = 2; i &lt;= lim; ++i) {\n        if (!mark[i]) {\n            primes.emplace_back(i);\n            for (long long j = i * i; j &lt;= lim; j += i)\n                mark[j] = true;\n        }\n    }\n\n    vector&lt;char&gt; isPrime(R - L + 1, true);\n    for (long long i : primes)\n        for (long long j = max(i * i, (L + i - 1) / i * i); j &lt;= R; j += i)\n            isPrime[j - L] = false;\n    if (L == 1)\n        isPrime[0] = false;\n    return isPrime;\n}\n</code></pre> \u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian c\u1ee7a c\u00e1ch ti\u1ebfp c\u1eadn n\u00e0y l\u00e0 $O((R - L + 1) \\log \\log (R) + \\sqrt R \\log \\log \\sqrt R)$.</p> <p>C\u0169ng c\u00f3 th\u1ec3 r\u1eb1ng ch\u00fang ta kh\u00f4ng t\u1ea1o tr\u01b0\u1edbc t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 nguy\u00ean t\u1ed1:</p> <pre><code>vector&lt;char&gt; segmentedSieveNoPreGen(long long L, long long R) {\n    vector&lt;char&gt; isPrime(R - L + 1, true);\n    long long lim = sqrt(R);\n    for (long long i = 2; i &lt;= lim; ++i)\n        for (long long j = max(i * i, (L + i - 1) / i * i); j &lt;= R; j += i)\n            isPrime[j - L] = false;\n    if (L == 1)\n        isPrime[0] = false;\n    return isPrime;\n}\n</code></pre> <p>R\u00f5 r\u00e0ng, \u0111\u1ed9 ph\u1ee9c t\u1ea1p t\u1ed3i t\u1ec7 h\u01a1n, \u0111\u00f3 l\u00e0 $O((R - L + 1) \\log (R) + \\sqrt R)$. Tuy nhi\u00ean, n\u00f3 v\u1eabn ch\u1ea1y r\u1ea5t nhanh trong th\u1ef1c t\u1ebf.</p>","tags":["Translated"]},{"location":"algebra/sieve-of-eratosthenes.html#linear-time-modification","title":"Thay \u0111\u1ed5i th\u1eddi gian tuy\u1ebfn t\u00ednh (Linear time modification)","text":"<p>Ch\u00fang ta c\u00f3 th\u1ec3 s\u1eeda \u0111\u1ed5i thu\u1eadt to\u00e1n theo c\u00e1ch nh\u01b0 v\u1eady, sao cho n\u00f3 ch\u1ec9 c\u00f3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian tuy\u1ebfn t\u00ednh. C\u00e1ch ti\u1ebfp c\u1eadn n\u00e0y \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 trong b\u00e0i vi\u1ebft S\u00e0ng tuy\u1ebfn t\u00ednh. Tuy nhi\u00ean, thu\u1eadt to\u00e1n n\u00e0y c\u0169ng c\u00f3 \u0111i\u1ec3m y\u1ebfu ri\u00eang c\u1ee7a n\u00f3.</p>","tags":["Translated"]},{"location":"algebra/sieve-of-eratosthenes.html#practice-problems","title":"B\u00e0i t\u1eadp luy\u1ec7n t\u1eadp","text":"<ul> <li>Leetcode - Four Divisors</li> <li>Leetcode - Count Primes</li> <li>SPOJ - Printing Some Primes</li> <li>SPOJ - A Conjecture of Paul Erdos</li> <li>SPOJ - Primal Fear</li> <li>SPOJ - Primes Triangle (I)</li> <li>Codeforces - Almost Prime</li> <li>Codeforces - Sherlock And His Girlfriend</li> <li>SPOJ - Namit in Trouble</li> <li>SPOJ - Bazinga!</li> <li>Project Euler - Prime pair connection</li> <li>SPOJ - N-Factorful</li> <li>SPOJ - Binary Sequence of Prime Numbers</li> <li>UVA 11353 - A Different Kind of Sorting</li> <li>SPOJ - Prime Generator</li> <li>SPOJ - Printing some primes (hard)</li> <li>Codeforces - Nodbach Problem</li> <li>Codeforces - Colliders</li> </ul>","tags":["Translated"]},{"location":"algebra/sieve-of-eratosthenes.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 277</li> <li>Translated lines: 277</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Translated"]},{"location":"combinatorics/binomial-coefficients.html","title":"H\u1ec7 s\u1ed1 nh\u1ecb th\u1ee9c (Binomial Coefficients)","text":"<p>H\u1ec7 s\u1ed1 nh\u1ecb th\u1ee9c $\\binom n k$ l\u00e0 s\u1ed1 c\u00e1ch \u0111\u1ec3 ch\u1ecdn m\u1ed9t t\u1eadp h\u1ee3p $k$ ph\u1ea7n t\u1eed t\u1eeb $n$ ph\u1ea7n t\u1eed kh\u00e1c nhau m\u00e0 kh\u00f4ng t\u00ednh \u0111\u1ebfn th\u1ee9 t\u1ef1 s\u1eafp x\u1ebfp c\u1ee7a c\u00e1c ph\u1ea7n t\u1eed n\u00e0y (t\u1ee9c l\u00e0, s\u1ed1 l\u01b0\u1ee3ng t\u1eadp h\u1ee3p kh\u00f4ng c\u00f3 th\u1ee9 t\u1ef1).</p> <p>H\u1ec7 s\u1ed1 nh\u1ecb th\u1ee9c c\u0169ng l\u00e0 c\u00e1c h\u1ec7 s\u1ed1 trong khai tri\u1ec3n c\u1ee7a $(a + b) ^ n$ (c\u00f2n g\u1ecdi l\u00e0 \u0111\u1ecbnh l\u00fd nh\u1ecb th\u1ee9c):</p> $$ (a+b)^n = \\binom n 0 a^n + \\binom n 1 a^{n-1} b + \\binom n 2 a^{n-2} b^2 + \\cdots + \\binom n k a^{n-k} b^k + \\cdots + \\binom n n b^n $$ <p>Ng\u01b0\u1eddi ta tin r\u1eb1ng c\u00f4ng th\u1ee9c n\u00e0y, c\u0169ng nh\u01b0 tam gi\u00e1c cho ph\u00e9p t\u00ednh to\u00e1n hi\u1ec7u qu\u1ea3 c\u00e1c h\u1ec7 s\u1ed1, \u0111\u01b0\u1ee3c ph\u00e1t hi\u1ec7n b\u1edfi Blaise Pascal v\u00e0o th\u1ebf k\u1ef7 17. Tuy nhi\u00ean, n\u00f3 \u0111\u00e3 \u0111\u01b0\u1ee3c nh\u00e0 to\u00e1n h\u1ecdc Trung Qu\u1ed1c Yang Hui, s\u1ed1ng v\u00e0o th\u1ebf k\u1ef7 13, bi\u1ebft \u0111\u1ebfn. C\u00f3 l\u1ebd n\u00f3 \u0111\u01b0\u1ee3c ph\u00e1t hi\u1ec7n b\u1edfi m\u1ed9t h\u1ecdc gi\u1ea3 Ba T\u01b0 Omar Khayyam. H\u01a1n n\u1eefa, nh\u00e0 to\u00e1n h\u1ecdc \u1ea4n \u0110\u1ed9 Pingala, s\u1ed1ng s\u1edbm h\u01a1n v\u00e0o th\u1ebf k\u1ef7 th\u1ee9 3 tr\u01b0\u1edbc C\u00f4ng nguy\u00ean, \u0111\u00e3 c\u00f3 k\u1ebft qu\u1ea3 t\u01b0\u01a1ng t\u1ef1. C\u00f4ng lao c\u1ee7a Newton l\u00e0 \u00f4ng \u0111\u00e3 t\u1ed5ng qu\u00e1t h\u00f3a c\u00f4ng th\u1ee9c n\u00e0y cho c\u00e1c s\u1ed1 m\u0169 kh\u00f4ng ph\u1ea3i l\u00e0 s\u1ed1 t\u1ef1 nhi\u00ean.</p>","tags":["Translated"]},{"location":"combinatorics/binomial-coefficients.html#calculation","title":"T\u00ednh to\u00e1n (Calculation)","text":"<p>C\u00f4ng th\u1ee9c gi\u1ea3i t\u00edch \u0111\u1ec3 t\u00ednh to\u00e1n:</p> $$ \\binom n k = \\frac {n!} {k!(n-k)!} $$ <p>C\u00f4ng th\u1ee9c n\u00e0y c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng suy ra t\u1eeb b\u00e0i to\u00e1n s\u1eafp x\u1ebfp c\u00f3 th\u1ee9 t\u1ef1 (s\u1ed1 c\u00e1ch ch\u1ecdn $k$ ph\u1ea7n t\u1eed kh\u00e1c nhau t\u1eeb $n$ ph\u1ea7n t\u1eed kh\u00e1c nhau). \u0110\u1ea7u ti\u00ean, h\u00e3y \u0111\u1ebfm s\u1ed1 l\u01b0\u1ee3ng l\u1ef1a ch\u1ecdn c\u00f3 th\u1ee9 t\u1ef1 c\u1ee7a $k$ ph\u1ea7n t\u1eed. C\u00f3 $n$ c\u00e1ch ch\u1ecdn ph\u1ea7n t\u1eed \u0111\u1ea7u ti\u00ean, $n-1$ c\u00e1ch ch\u1ecdn ph\u1ea7n t\u1eed th\u1ee9 hai, $n-2$ c\u00e1ch ch\u1ecdn ph\u1ea7n t\u1eed th\u1ee9 ba, v.v. K\u1ebft qu\u1ea3 l\u00e0, ch\u00fang ta c\u00f3 c\u00f4ng th\u1ee9c s\u1ed1 l\u01b0\u1ee3ng s\u1eafp x\u1ebfp c\u00f3 th\u1ee9 t\u1ef1: $n (n-1) (n-2) \\cdots (n - k + 1) = \\frac {n!} {(n-k)!}$. Ch\u00fang ta c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng chuy\u1ec3n sang s\u1eafp x\u1ebfp kh\u00f4ng th\u1ee9 t\u1ef1, l\u01b0u \u00fd r\u1eb1ng m\u1ed7i s\u1eafp x\u1ebfp kh\u00f4ng th\u1ee9 t\u1ef1 t\u01b0\u01a1ng \u1ee9ng v\u1edbi ch\u00ednh x\u00e1c $k!$ s\u1eafp x\u1ebfp c\u00f3 th\u1ee9 t\u1ef1 ($k!$ l\u00e0 s\u1ed1 l\u01b0\u1ee3ng ho\u00e1n v\u1ecb c\u00f3 th\u1ec3 c\u00f3 c\u1ee7a $k$ ph\u1ea7n t\u1eed). Ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c c\u00f4ng th\u1ee9c cu\u1ed1i c\u00f9ng b\u1eb1ng c\u00e1ch chia $\\frac {n!} {(n-k)!}$ cho $k!$.</p> <p>C\u00f4ng th\u1ee9c truy h\u1ed3i (li\u00ean quan \u0111\u1ebfn \"Tam gi\u00e1c Pascal\" n\u1ed5i ti\u1ebfng):</p> $$ \\binom n k = \\binom {n-1} {k-1} + \\binom {n-1} k $$ <p>R\u1ea5t d\u1ec5 \u0111\u1ec3 suy ra \u0111i\u1ec1u n\u00e0y b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng c\u00f4ng th\u1ee9c gi\u1ea3i t\u00edch.</p> <p>L\u01b0u \u00fd r\u1eb1ng \u0111\u1ed1i v\u1edbi $n \\lt k$ gi\u00e1 tr\u1ecb c\u1ee7a $\\binom n k$ \u0111\u01b0\u1ee3c gi\u1ea3 \u0111\u1ecbnh l\u00e0 b\u1eb1ng kh\u00f4ng.</p>","tags":["Translated"]},{"location":"combinatorics/binomial-coefficients.html#properties","title":"C\u00e1c t\u00ednh ch\u1ea5t (Properties)","text":"<p>H\u1ec7 s\u1ed1 nh\u1ecb th\u1ee9c c\u00f3 nhi\u1ec1u t\u00ednh ch\u1ea5t kh\u00e1c nhau. D\u01b0\u1edbi \u0111\u00e2y l\u00e0 nh\u1eefng t\u00ednh ch\u1ea5t \u0111\u01a1n gi\u1ea3n nh\u1ea5t:</p> <ul> <li> <p>Quy t\u1eafc \u0111\u1ed1i x\u1ee9ng:</p> $$ \\binom n k = \\binom n {n-k} $$ </li> <li> <p>\u0110\u01b0a ra ngo\u00e0i (Factoring in):</p> $$ \\binom n k = \\frac n k \\binom {n-1} {k-1} $$ </li> <li> <p>T\u1ed5ng theo $k$:</p> $$ \\sum_{k = 0}^n \\binom n k = 2 ^ n $$ </li> <li> <p>T\u1ed5ng theo $n$:</p> $$ \\sum_{m = 0}^n \\binom m k = \\binom {n + 1} {k + 1} $$ </li> <li> <p>T\u1ed5ng theo $n$ v\u00e0 $k$:</p> $$ \\sum_{k = 0}^m  \\binom {n + k} k = \\binom {n + m + 1} m $$ </li> <li> <p>T\u1ed5ng b\u00ecnh ph\u01b0\u01a1ng:</p> $$ {\\binom n 0}^2 + {\\binom n 1}^2 + \\cdots + {\\binom n n}^2 = \\binom {2n} n $$ </li> <li> <p>T\u1ed5ng c\u00f3 tr\u1ecdng s\u1ed1:</p> $$ 1 \\binom n 1 + 2 \\binom n 2 + \\cdots + n \\binom n n = n 2^{n-1} $$ </li> <li> <p>Li\u00ean h\u1ec7 v\u1edbi s\u1ed1 Fibonacci:</p> $$ \\binom n 0 + \\binom {n-1} 1 + \\cdots + \\binom {n-k} k + \\cdots + \\binom 0 n = F_{n+1} $$ </li> </ul>","tags":["Translated"]},{"location":"combinatorics/binomial-coefficients.html#calculation-1","title":"T\u00ednh to\u00e1n (Calculation)","text":"","tags":["Translated"]},{"location":"combinatorics/binomial-coefficients.html#straightforward-calculation-using-analytical-formula","title":"T\u00ednh to\u00e1n tr\u1ef1c ti\u1ebfp b\u1eb1ng c\u00f4ng th\u1ee9c gi\u1ea3i t\u00edch (Straightforward calculation using analytical formula)","text":"<p>C\u00f4ng th\u1ee9c \u0111\u1ea7u ti\u00ean, tr\u1ef1c ti\u1ebfp r\u1ea5t d\u1ec5 vi\u1ebft m\u00e3, nh\u01b0ng ph\u01b0\u01a1ng ph\u00e1p n\u00e0y c\u00f3 kh\u1ea3 n\u0103ng b\u1ecb tr\u00e0n s\u1ed1 ngay c\u1ea3 \u0111\u1ed1i v\u1edbi c\u00e1c gi\u00e1 tr\u1ecb t\u01b0\u01a1ng \u0111\u1ed1i nh\u1ecf c\u1ee7a $n$ v\u00e0 $k$ (ngay c\u1ea3 khi k\u1ebft qu\u1ea3 ho\u00e0n to\u00e0n ph\u00f9 h\u1ee3p v\u1edbi m\u1ed9t ki\u1ec3u d\u1eef li\u1ec7u n\u00e0o \u0111\u00f3, vi\u1ec7c t\u00ednh to\u00e1n c\u00e1c giai th\u1eeba trung gian c\u00f3 th\u1ec3 d\u1eabn \u0111\u1ebfn tr\u00e0n s\u1ed1). Do \u0111\u00f3, ph\u01b0\u01a1ng ph\u00e1p n\u00e0y th\u01b0\u1eddng ch\u1ec9 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng v\u1edbi s\u1ed1 h\u1ecdc l\u1edbn:</p> <pre><code>int C(int n, int k) {\n    int res = 1;\n    for (int i = n - k + 1; i &lt;= n; ++i)\n        res *= i;\n    for (int i = 2; i &lt;= k; ++i)\n        res /= i;\n    return res;\n}\n</code></pre>","tags":["Translated"]},{"location":"combinatorics/binomial-coefficients.html#improved-implementation","title":"C\u00e0i \u0111\u1eb7t c\u1ea3i ti\u1ebfn (Improved implementation)","text":"<p>L\u01b0u \u00fd r\u1eb1ng trong c\u00e0i \u0111\u1eb7t tr\u00ean t\u1eed s\u1ed1 v\u00e0 m\u1eabu s\u1ed1 c\u00f3 c\u00f9ng s\u1ed1 l\u01b0\u1ee3ng th\u1eeba s\u1ed1 ($k$), m\u1ed7i th\u1eeba s\u1ed1 l\u1edbn h\u01a1n ho\u1eb7c b\u1eb1ng 1. Do \u0111\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 thay th\u1ebf ph\u00e2n s\u1ed1 c\u1ee7a m\u00ecnh b\u1eb1ng t\u00edch $k$ ph\u00e2n s\u1ed1, m\u1ed7i ph\u00e2n s\u1ed1 c\u00f3 gi\u00e1 tr\u1ecb th\u1ef1c. Tuy nhi\u00ean, \u1edf m\u1ed7i b\u01b0\u1edbc sau khi nh\u00e2n c\u00e2u tr\u1ea3 l\u1eddi hi\u1ec7n t\u1ea1i v\u1edbi m\u1ed7i ph\u00e2n s\u1ed1 ti\u1ebfp theo, c\u00e2u tr\u1ea3 l\u1eddi v\u1eabn s\u1ebd l\u00e0 s\u1ed1 nguy\u00ean (\u0111i\u1ec1u n\u00e0y theo sau t\u1eeb t\u00ednh ch\u1ea5t \u0111\u01b0a ra ngo\u00e0i).</p> <p>C\u00e0i \u0111\u1eb7t C++:</p> <pre><code>int C(int n, int k) {\n    double res = 1;\n    for (int i = 1; i &lt;= k; ++i)\n        res = res * (n - k + i) / i;\n    return (int)(res + 0.01);\n}\n</code></pre> <p>\u1ede \u0111\u00e2y ch\u00fang t\u00f4i c\u1ea9n th\u1eadn \u00e9p ki\u1ec3u s\u1ed1 d\u1ea5u ph\u1ea9y \u0111\u1ed9ng th\u00e0nh s\u1ed1 nguy\u00ean, c\u00f3 t\u00ednh \u0111\u1ebfn vi\u1ec7c do sai s\u1ed1 t\u00edch l\u0169y, n\u00f3 c\u00f3 th\u1ec3 nh\u1ecf h\u01a1n m\u1ed9t ch\u00fat so v\u1edbi gi\u00e1 tr\u1ecb th\u1ef1c (v\u00ed d\u1ee5: $2.99999$ thay v\u00ec $3$).</p>","tags":["Translated"]},{"location":"combinatorics/binomial-coefficients.html#pascals-triangle","title":"Tam gi\u00e1c Pascal (Pascal's Triangle)","text":"<p>B\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng h\u1ec7 th\u1ee9c truy h\u1ed3i, ch\u00fang ta c\u00f3 th\u1ec3 x\u00e2y d\u1ef1ng b\u1ea3ng c\u00e1c h\u1ec7 s\u1ed1 nh\u1ecb th\u1ee9c (tam gi\u00e1c Pascal) v\u00e0 l\u1ea5y k\u1ebft qu\u1ea3 t\u1eeb \u0111\u00f3. \u01afu \u0111i\u1ec3m c\u1ee7a ph\u01b0\u01a1ng ph\u00e1p n\u00e0y l\u00e0 k\u1ebft qu\u1ea3 trung gian kh\u00f4ng bao gi\u1edd v\u01b0\u1ee3t qu\u00e1 c\u00e2u tr\u1ea3 l\u1eddi v\u00e0 t\u00ednh to\u00e1n m\u1ed7i ph\u1ea7n t\u1eed b\u1ea3ng m\u1edbi ch\u1ec9 y\u00eau c\u1ea7u m\u1ed9t ph\u00e9p c\u1ed9ng. Nh\u01b0\u1ee3c \u0111i\u1ec3m l\u00e0 th\u1ef1c thi ch\u1eadm \u0111\u1ed1i v\u1edbi $n$ v\u00e0 $k$ l\u1edbn n\u1ebfu b\u1ea1n ch\u1ec9 c\u1ea7n m\u1ed9t gi\u00e1 tr\u1ecb duy nh\u1ea5t ch\u1ee9 kh\u00f4ng ph\u1ea3i to\u00e0n b\u1ed9 b\u1ea3ng (b\u1edfi v\u00ec \u0111\u1ec3 t\u00ednh $\\binom n k$ b\u1ea1n s\u1ebd c\u1ea7n x\u00e2y d\u1ef1ng b\u1ea3ng c\u1ee7a t\u1ea5t c\u1ea3 $\\binom i j, 1 \\le i \\le n, 1 \\le j \\le n$, ho\u1eb7c \u00edt nh\u1ea5t l\u00e0 \u0111\u1ebfn $1 \\le j \\le \\min (i, 2k)$). \u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c coi l\u00e0 $\\mathcal{O}(n^2)$.</p> <p>C\u00e0i \u0111\u1eb7t C++:</p> <pre><code>const int maxn = ...;\nint C[maxn + 1][maxn + 1];\nC[0][0] = 1;\nfor (int n = 1; n &lt;= maxn; ++n) {\n    C[n][0] = C[n][n] = 1;\n    for (int k = 1; k &lt; n; ++k)\n        C[n][k] = C[n - 1][k - 1] + C[n - 1][k];\n}\n</code></pre> <p>N\u1ebfu to\u00e0n b\u1ed9 b\u1ea3ng gi\u00e1 tr\u1ecb kh\u00f4ng c\u1ea7n thi\u1ebft, ch\u1ec9 l\u01b0u tr\u1eef hai h\u00e0ng cu\u1ed1i c\u00f9ng c\u1ee7a n\u00f3 l\u00e0 \u0111\u1ee7 (h\u00e0ng th\u1ee9 $n$ hi\u1ec7n t\u1ea1i v\u00e0 h\u00e0ng th\u1ee9 $n-1$ tr\u01b0\u1edbc \u0111\u00f3).</p>","tags":["Translated"]},{"location":"combinatorics/binomial-coefficients.html#calculation-in-o1","title":"T\u00ednh to\u00e1n trong $O(1)$ (Calculation in $O(1)$)","text":"<p>Cu\u1ed1i c\u00f9ng, trong m\u1ed9t s\u1ed1 t\u00ecnh hu\u1ed1ng, c\u00f3 l\u1ee3i khi t\u00ednh tr\u01b0\u1edbc t\u1ea5t c\u1ea3 c\u00e1c giai th\u1eeba \u0111\u1ec3 t\u1ea1o ra b\u1ea5t k\u1ef3 h\u1ec7 s\u1ed1 nh\u1ecb th\u1ee9c c\u1ea7n thi\u1ebft n\u00e0o ch\u1ec9 v\u1edbi hai ph\u00e9p chia sau \u0111\u00f3. \u0110i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 c\u00f3 l\u1ee3i khi s\u1eed d\u1ee5ng s\u1ed1 h\u1ecdc l\u1edbn, khi b\u1ed9 nh\u1edb kh\u00f4ng cho ph\u00e9p t\u00ednh tr\u01b0\u1edbc to\u00e0n b\u1ed9 tam gi\u00e1c Pascal.</p>","tags":["Translated"]},{"location":"combinatorics/binomial-coefficients.html#computing-binomial-coefficients-modulo-m","title":"T\u00ednh h\u1ec7 s\u1ed1 nh\u1ecb th\u1ee9c modulo $m$ (Computing binomial coefficients modulo $m$)","text":"<p>Kh\u00e1 th\u01b0\u1eddng xuy\u00ean b\u1ea1n g\u1eb7p b\u00e0i to\u00e1n t\u00ednh h\u1ec7 s\u1ed1 nh\u1ecb th\u1ee9c modulo m\u1ed9t s\u1ed1 $m$ n\u00e0o \u0111\u00f3.</p>","tags":["Translated"]},{"location":"combinatorics/binomial-coefficients.html#binomial-coefficient-for-small-n","title":"H\u1ec7 s\u1ed1 nh\u1ecb th\u1ee9c cho $n$ nh\u1ecf (Binomial coefficient for small $n$)","text":"<p>C\u00e1ch ti\u1ebfp c\u1eadn tam gi\u00e1c Pascal \u0111\u00e3 th\u1ea3o lu\u1eadn tr\u01b0\u1edbc \u0111\u00f3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 t\u00ednh t\u1ea5t c\u1ea3 c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a $\\binom{n}{k} \\bmod m$ cho $n$ kh\u00e1 nh\u1ecf, v\u00ec n\u00f3 y\u00eau c\u1ea7u \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian $\\mathcal{O}(n^2)$. C\u00e1ch ti\u1ebfp c\u1eadn n\u00e0y c\u00f3 th\u1ec3 x\u1eed l\u00fd b\u1ea5t k\u1ef3 modulo n\u00e0o, v\u00ec ch\u1ec9 c\u00e1c ph\u00e9p to\u00e1n c\u1ed9ng \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng.</p>","tags":["Translated"]},{"location":"combinatorics/binomial-coefficients.html#binomial-coefficient-modulo-large-prime","title":"H\u1ec7 s\u1ed1 nh\u1ecb th\u1ee9c modulo s\u1ed1 nguy\u00ean t\u1ed1 l\u1edbn (Binomial coefficient modulo large prime)","text":"<p>C\u00f4ng th\u1ee9c cho c\u00e1c h\u1ec7 s\u1ed1 nh\u1ecb th\u1ee9c l\u00e0</p> $$\\binom n k = \\frac {n!} {k!(n-k)!},$$ <p>v\u00ec v\u1eady n\u1ebfu ch\u00fang ta mu\u1ed1n t\u00ednh n\u00f3 modulo m\u1ed9t s\u1ed1 nguy\u00ean t\u1ed1 $m &gt; n$ n\u00e0o \u0111\u00f3, ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c</p> $$\\binom n k \\equiv n! \\cdot (k!)^{-1} \\cdot ((n-k)!)^{-1} \\mod m.$$ <p>\u0110\u1ea7u ti\u00ean ch\u00fang ta t\u00ednh tr\u01b0\u1edbc t\u1ea5t c\u1ea3 c\u00e1c giai th\u1eeba modulo $m$ l\u00ean \u0111\u1ebfn $\\text{MAXN}!$ trong th\u1eddi gian $O(\\text{MAXN})$.</p> <pre><code>factorial[0] = 1;\nfor (int i = 1; i &lt;= MAXN; i++) {\n    factorial[i] = factorial[i - 1] * i % m;\n}\n</code></pre> <p>V\u00e0 sau \u0111\u00f3 ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh h\u1ec7 s\u1ed1 nh\u1ecb th\u1ee9c trong th\u1eddi gian $O(\\log m)$.</p> <pre><code>long long binomial_coefficient(int n, int k) {\n    return factorial[n] * inverse(factorial[k] * factorial[n - k] % m) % m;\n}\n</code></pre> <p>Ch\u00fang ta th\u1eadm ch\u00ed c\u00f3 th\u1ec3 t\u00ednh h\u1ec7 s\u1ed1 nh\u1ecb th\u1ee9c trong th\u1eddi gian $O(1)$ n\u1ebfu ch\u00fang ta t\u00ednh tr\u01b0\u1edbc ngh\u1ecbch \u0111\u1ea3o c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c giai th\u1eeba trong $O(\\text{MAXN} \\log m)$ b\u1eb1ng ph\u01b0\u01a1ng ph\u00e1p th\u00f4ng th\u01b0\u1eddng \u0111\u1ec3 t\u00ednh ngh\u1ecbch \u0111\u1ea3o, ho\u1eb7c th\u1eadm ch\u00ed trong th\u1eddi gian $O(\\text{MAXN})$ b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng \u0111\u1ed3ng d\u01b0 $(x!)^{-1} \\equiv ((x-1)!)^{-1} \\cdot x^{-1}$ v\u00e0 ph\u01b0\u01a1ng ph\u00e1p \u0111\u1ec3 t\u00ednh t\u1ea5t c\u1ea3 ngh\u1ecbch \u0111\u1ea3o trong $O(n)$.</p> <pre><code>long long binomial_coefficient(int n, int k) {\n    return factorial[n] * inverse_factorial[k] % m * inverse_factorial[n - k] % m;\n}\n</code></pre>","tags":["Translated"]},{"location":"combinatorics/binomial-coefficients.html#mod-prime-pow","title":"H\u1ec7 s\u1ed1 nh\u1ecb th\u1ee9c modulo l\u0169y th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1 (Binomial coefficient modulo prime power)","text":"<p>\u1ede \u0111\u00e2y ch\u00fang ta mu\u1ed1n t\u00ednh h\u1ec7 s\u1ed1 nh\u1ecb th\u1ee9c modulo m\u1ed9t l\u0169y th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1 n\u00e0o \u0111\u00f3, t\u1ee9c l\u00e0 $m = p^b$ cho m\u1ed9t s\u1ed1 nguy\u00ean t\u1ed1 $p$ n\u00e0o \u0111\u00f3. N\u1ebfu $p &gt; \\max(k, n-k)$, th\u00ec ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng c\u00f9ng m\u1ed9t ph\u01b0\u01a1ng ph\u00e1p nh\u01b0 \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 trong ph\u1ea7n tr\u01b0\u1edbc. Nh\u01b0ng n\u1ebfu $p \\le \\max(k, n-k)$, th\u00ec \u00edt nh\u1ea5t m\u1ed9t trong $k!$ v\u00e0 $(n-k)!$ kh\u00f4ng nguy\u00ean t\u1ed1 c\u00f9ng nhau v\u1edbi $m$, v\u00e0 do \u0111\u00f3 ch\u00fang ta kh\u00f4ng th\u1ec3 t\u00ednh ngh\u1ecbch \u0111\u1ea3o - ch\u00fang kh\u00f4ng t\u1ed3n t\u1ea1i. Tuy nhi\u00ean ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh h\u1ec7 s\u1ed1 nh\u1ecb th\u1ee9c.</p> <p>\u00dd t\u01b0\u1edfng l\u00e0 nh\u01b0 sau: Ch\u00fang ta t\u00ednh cho m\u1ed7i $x!$ s\u1ed1 m\u0169 l\u1edbn nh\u1ea5t $c$ sao cho $p^c$ chia h\u1ebft $x!$, t\u1ee9c l\u00e0 $p^c ~|~ x!$. G\u1ecdi $c(x)$ l\u00e0 s\u1ed1 \u0111\u00f3. V\u00e0 g\u1ecdi $g(x) := \\frac{x!}{p^{c(x)}}$. Khi \u0111\u00f3 ch\u00fang ta c\u00f3 th\u1ec3 vi\u1ebft h\u1ec7 s\u1ed1 nh\u1ecb th\u1ee9c nh\u01b0 sau:</p> $$\\binom n k = \\frac {g(n) p^{c(n)}} {g(k) p^{c(k)} g(n-k) p^{c(n-k)}} = \\frac {g(n)} {g(k) g(n-k)}p^{c(n) - c(k) - c(n-k)}$$ <p>\u0110i\u1ec1u th\u00fa v\u1ecb l\u00e0, $g(x)$ b\u00e2y gi\u1edd kh\u00f4ng c\u00f2n ch\u1ee9a \u01b0\u1edbc s\u1ed1 nguy\u00ean t\u1ed1 $p$. Do \u0111\u00f3 $g(x)$ nguy\u00ean t\u1ed1 c\u00f9ng nhau v\u1edbi m, v\u00e0 ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh ngh\u1ecbch \u0111\u1ea3o modulo c\u1ee7a $g(k)$ v\u00e0 $g(n-k)$.</p> <p>Sau khi t\u00ednh tr\u01b0\u1edbc t\u1ea5t c\u1ea3 c\u00e1c gi\u00e1 tr\u1ecb cho $g$ v\u00e0 $c$, c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n hi\u1ec7u qu\u1ea3 b\u1eb1ng quy ho\u1ea1ch \u0111\u1ed9ng trong $\\mathcal{O}(n)$, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh h\u1ec7 s\u1ed1 nh\u1ecb th\u1ee9c trong th\u1eddi gian $O(\\log m)$. Ho\u1eb7c t\u00ednh tr\u01b0\u1edbc t\u1ea5t c\u1ea3 ngh\u1ecbch \u0111\u1ea3o v\u00e0 t\u1ea5t c\u1ea3 c\u00e1c l\u0169y th\u1eeba c\u1ee7a $p$, v\u00e0 sau \u0111\u00f3 t\u00ednh h\u1ec7 s\u1ed1 nh\u1ecb th\u1ee9c trong $O(1)$.</p> <p>L\u01b0u \u00fd, n\u1ebfu $c(n) - c(k) - c(n-k) \\ge b$, th\u00ec $p^b ~|~ p^{c(n) - c(k) - c(n-k)}$, v\u00e0 h\u1ec7 s\u1ed1 nh\u1ecb th\u1ee9c l\u00e0 $0$.</p>","tags":["Translated"]},{"location":"combinatorics/binomial-coefficients.html#binomial-coefficient-modulo-an-arbitrary-number","title":"H\u1ec7 s\u1ed1 nh\u1ecb th\u1ee9c modulo m\u1ed9t s\u1ed1 t\u00f9y \u00fd (Binomial coefficient modulo an arbitrary number)","text":"<p>B\u00e2y gi\u1edd ch\u00fang ta t\u00ednh h\u1ec7 s\u1ed1 nh\u1ecb th\u1ee9c modulo m\u1ed9t s\u1ed1 t\u00f9y \u00fd $m$.</p> <p>G\u1ecdi ph\u00e2n t\u00edch th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1 c\u1ee7a $m$ l\u00e0 $m = p_1^{e_1} p_2^{e_2} \\cdots p_h^{e_h}$. Ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh h\u1ec7 s\u1ed1 nh\u1ecb th\u1ee9c modulo $p_i^{e_i}$ cho m\u1ed7i $i$. \u0110i\u1ec1u n\u00e0y cho ch\u00fang ta $h$ \u0111\u1ed3ng d\u01b0 kh\u00e1c nhau. V\u00ec t\u1ea5t c\u1ea3 c\u00e1c modulo $p_i^{e_i}$ l\u00e0 nguy\u00ean t\u1ed1 c\u00f9ng nhau, ch\u00fang ta c\u00f3 th\u1ec3 \u00e1p d\u1ee5ng \u0110\u1ecbnh l\u00fd th\u1eb7ng d\u01b0 Trung Hoa \u0111\u1ec3 t\u00ednh h\u1ec7 s\u1ed1 nh\u1ecb th\u1ee9c modulo t\u00edch c\u1ee7a c\u00e1c modulo, \u0111\u00f3 l\u00e0 h\u1ec7 s\u1ed1 nh\u1ecb th\u1ee9c mong mu\u1ed1n modulo $m$.</p>","tags":["Translated"]},{"location":"combinatorics/binomial-coefficients.html#binomial-coefficient-for-large-n-and-small-modulo","title":"H\u1ec7 s\u1ed1 nh\u1ecb th\u1ee9c cho $n$ l\u1edbn v\u00e0 modulo nh\u1ecf (Binomial coefficient for large $n$ and small modulo)","text":"<p>Khi $n$ qu\u00e1 l\u1edbn, c\u00e1c thu\u1eadt to\u00e1n $\\mathcal{O}(n)$ \u0111\u01b0\u1ee3c th\u1ea3o lu\u1eadn \u1edf tr\u00ean tr\u1edf n\u00ean kh\u00f4ng th\u1ef1c t\u1ebf. Tuy nhi\u00ean, n\u1ebfu modulo $m$ nh\u1ecf v\u1eabn c\u00f3 nh\u1eefng c\u00e1ch \u0111\u1ec3 t\u00ednh $\\binom{n}{k} \\bmod m$.</p> <p>Khi modulo $m$ l\u00e0 s\u1ed1 nguy\u00ean t\u1ed1, c\u00f3 2 t\u00f9y ch\u1ecdn:</p> <ul> <li>\u0110\u1ecbnh l\u00fd Lucas c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c \u00e1p d\u1ee5ng \u0111\u1ec3 chia b\u00e0i to\u00e1n t\u00ednh $\\binom{n}{k} \\bmod m$ th\u00e0nh $\\log_m n$ b\u00e0i to\u00e1n c\u00f3 d\u1ea1ng $\\binom{x_i}{y_i} \\bmod m$ trong \u0111\u00f3 $x_i, y_i &lt; m$. N\u1ebfu m\u1ed7i h\u1ec7 s\u1ed1 r\u00fat g\u1ecdn \u0111\u01b0\u1ee3c t\u00ednh b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng giai th\u1eeba v\u00e0 ngh\u1ecbch \u0111\u1ea3o giai th\u1eeba t\u00ednh tr\u01b0\u1edbc, \u0111\u1ed9 ph\u1ee9c t\u1ea1p l\u00e0 $\\mathcal{O}(m + \\log_m n)$.</li> <li>Ph\u01b0\u01a1ng ph\u00e1p t\u00ednh giai th\u1eeba modulo P c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 l\u1ea5y c\u00e1c gi\u00e1 tr\u1ecb $g$ v\u00e0 $c$ c\u1ea7n thi\u1ebft v\u00e0 s\u1eed d\u1ee5ng ch\u00fang nh\u01b0 \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 trong ph\u1ea7n modulo l\u0169y th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1. \u0110i\u1ec1u n\u00e0y m\u1ea5t $\\mathcal{O}(m \\log_m n)$.</li> </ul> <p>Khi $m$ kh\u00f4ng ph\u1ea3i l\u00e0 s\u1ed1 nguy\u00ean t\u1ed1 nh\u01b0ng kh\u00f4ng ch\u1ee9a th\u1eeba s\u1ed1 ch\u00ednh ph\u01b0\u01a1ng (square-free), c\u00e1c th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1 c\u1ee7a $m$ c\u00f3 th\u1ec3 thu \u0111\u01b0\u1ee3c v\u00e0 h\u1ec7 s\u1ed1 modulo m\u1ed7i th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ednh b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng m\u1ed9t trong c\u00e1c ph\u01b0\u01a1ng ph\u00e1p tr\u00ean, v\u00e0 c\u00e2u tr\u1ea3 l\u1eddi t\u1ed5ng th\u1ec3 c\u00f3 th\u1ec3 thu \u0111\u01b0\u1ee3c b\u1eb1ng \u0110\u1ecbnh l\u00fd th\u1eb7ng d\u01b0 Trung Hoa.</p> <p>Khi $m$ kh\u00f4ng ph\u1ea3i l\u00e0 square-free, m\u1ed9t t\u1ed5ng qu\u00e1t h\u00f3a c\u1ee7a \u0111\u1ecbnh l\u00fd Lucas cho l\u0169y th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c \u00e1p d\u1ee5ng thay v\u00ec \u0111\u1ecbnh l\u00fd Lucas.</p>","tags":["Translated"]},{"location":"combinatorics/binomial-coefficients.html#practice-problems","title":"B\u00e0i t\u1eadp luy\u1ec7n t\u1eadp","text":"<ul> <li>Codechef - Number of ways</li> <li>Codeforces - Curious Array</li> <li>LightOj - Necklaces</li> <li>HACKEREARTH: Binomial Coefficient</li> <li>SPOJ - Ada and Teams</li> <li>SPOJ - Greedy Walking</li> <li>UVa 13214 - The Robot's Grid</li> <li>SPOJ - Good Predictions</li> <li>SPOJ - Card Game</li> <li>SPOJ - Topper Rama Rao</li> <li>UVa 13184 - Counting Edges and Graphs</li> <li>Codeforces - Anton and School 2</li> <li>Codeforces - Bacterial Melee</li> <li>Codeforces - Points, Lines and Ready-made Titles</li> <li>SPOJ - The Ultimate Riddle</li> <li>CodeChef - Long Sandwich</li> <li>Codeforces - Placing Jinas</li> </ul>","tags":["Translated"]},{"location":"combinatorics/binomial-coefficients.html#references","title":"T\u00e0i li\u1ec7u tham kh\u1ea3o","text":"<ul> <li>Blog fishi.devtail.io</li> <li>C\u00e2u h\u1ecfi tr\u00ean Mathematics StackExchange</li> <li>C\u00e2u h\u1ecfi tr\u00ean CodeChef Discuss</li> </ul>","tags":["Translated"]},{"location":"combinatorics/binomial-coefficients.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 240</li> <li>Translated lines: 240</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Translated"]},{"location":"combinatorics/bishops-on-chessboard.html","title":"\u0110\u1eb7t c\u00e1c qu\u00e2n t\u01b0\u1ee3ng tr\u00ean b\u00e0n c\u1edd (Placing Bishops on a Chessboard)","text":"<p>T\u00ecm s\u1ed1 c\u00e1ch \u0111\u1eb7t $K$ qu\u00e2n t\u01b0\u1ee3ng tr\u00ean b\u00e0n c\u1edd $N \\times N$ sao cho kh\u00f4ng c\u00f3 hai qu\u00e2n t\u01b0\u1ee3ng n\u00e0o t\u1ea5n c\u00f4ng l\u1eabn nhau.</p>","tags":["Translated"]},{"location":"combinatorics/bishops-on-chessboard.html#algorithm","title":"Thu\u1eadt to\u00e1n (Algorithm)","text":"<p>B\u00e0i to\u00e1n n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i b\u1eb1ng quy ho\u1ea1ch \u0111\u1ed9ng.</p> <p>H\u00e3y li\u1ec7t k\u00ea c\u00e1c \u0111\u01b0\u1eddng ch\u00e9o c\u1ee7a b\u00e0n c\u1edd nh\u01b0 sau: c\u00e1c \u0111\u01b0\u1eddng ch\u00e9o \u0111en c\u00f3 ch\u1ec9 s\u1ed1 l\u1ebb, c\u00e1c \u0111\u01b0\u1eddng ch\u00e9o tr\u1eafng c\u00f3 ch\u1ec9 s\u1ed1 ch\u1eb5n, v\u00e0 c\u00e1c \u0111\u01b0\u1eddng ch\u00e9o \u0111\u01b0\u1ee3c \u0111\u00e1nh s\u1ed1 theo th\u1ee9 t\u1ef1 kh\u00f4ng gi\u1ea3m c\u1ee7a s\u1ed1 l\u01b0\u1ee3ng \u00f4 vu\u00f4ng trong ch\u00fang. \u0110\u00e2y l\u00e0 m\u1ed9t v\u00ed d\u1ee5 cho b\u00e0n c\u1edd $5 \\times 5$.</p> $$\\begin{matrix} \\bf{1} &amp; 2 &amp; \\bf{5} &amp; 6 &amp; \\bf{9} \\\\\\ 2 &amp; \\bf{5} &amp; 6 &amp; \\bf{9} &amp; 8 \\\\\\ \\bf{5} &amp; 6 &amp; \\bf{9} &amp; 8 &amp; \\bf{7} \\\\\\ 6 &amp; \\bf{9} &amp; 8 &amp; \\bf{7} &amp; 4 \\\\\\ \\bf{9} &amp; 8 &amp; \\bf{7} &amp; 4 &amp; \\bf{3} \\\\\\ \\end{matrix}$$ <p>G\u1ecdi <code>D[i][j]</code> bi\u1ec3u th\u1ecb s\u1ed1 c\u00e1ch \u0111\u1eb7t <code>j</code> qu\u00e2n t\u01b0\u1ee3ng tr\u00ean c\u00e1c \u0111\u01b0\u1eddng ch\u00e9o c\u00f3 ch\u1ec9 s\u1ed1 l\u00ean \u0111\u1ebfn <code>i</code> c\u00f3 c\u00f9ng m\u00e0u v\u1edbi \u0111\u01b0\u1eddng ch\u00e9o <code>i</code>. Khi \u0111\u00f3 <code>i = 1...2N-1</code> v\u00e0 <code>j = 0...K</code>.</p> <p>Ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh <code>D[i][j]</code> ch\u1ec9 b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a <code>D[i-2]</code> (ch\u00fang ta tr\u1eeb 2 v\u00ec ch\u00fang ta ch\u1ec9 xem x\u00e9t c\u00e1c \u0111\u01b0\u1eddng ch\u00e9o c\u00f9ng m\u00e0u v\u1edbi $i$). C\u00f3 hai c\u00e1ch \u0111\u1ec3 c\u00f3 \u0111\u01b0\u1ee3c <code>D[i][j]</code>. Ho\u1eb7c ch\u00fang ta \u0111\u1eb7t t\u1ea5t c\u1ea3 <code>j</code> qu\u00e2n t\u01b0\u1ee3ng tr\u00ean c\u00e1c \u0111\u01b0\u1eddng ch\u00e9o tr\u01b0\u1edbc \u0111\u00f3: khi \u0111\u00f3 c\u00f3 <code>D[i-2][j]</code> c\u00e1ch \u0111\u1ec3 \u0111\u1ea1t \u0111\u01b0\u1ee3c \u0111i\u1ec1u n\u00e0y. Ho\u1eb7c ch\u00fang ta \u0111\u1eb7t m\u1ed9t qu\u00e2n t\u01b0\u1ee3ng tr\u00ean \u0111\u01b0\u1eddng ch\u00e9o <code>i</code> v\u00e0 <code>j-1</code> qu\u00e2n t\u01b0\u1ee3ng tr\u00ean c\u00e1c \u0111\u01b0\u1eddng ch\u00e9o tr\u01b0\u1edbc \u0111\u00f3. S\u1ed1 c\u00e1ch \u0111\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y b\u1eb1ng s\u1ed1 l\u01b0\u1ee3ng \u00f4 tr\u00ean \u0111\u01b0\u1eddng ch\u00e9o <code>i</code> tr\u1eeb \u0111i <code>j-1</code>, v\u00ec m\u1ed7i <code>j-1</code> qu\u00e2n t\u01b0\u1ee3ng \u0111\u01b0\u1ee3c \u0111\u1eb7t tr\u00ean c\u00e1c \u0111\u01b0\u1eddng ch\u00e9o tr\u01b0\u1edbc \u0111\u00f3 s\u1ebd ch\u1eb7n m\u1ed9t \u00f4 tr\u00ean \u0111\u01b0\u1eddng ch\u00e9o hi\u1ec7n t\u1ea1i. S\u1ed1 l\u01b0\u1ee3ng \u00f4 tr\u00ean \u0111\u01b0\u1eddng ch\u00e9o <code>i</code> c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ednh nh\u01b0 sau:</p> <pre><code>int squares (int i) {\n    if (i &amp; 1)\n        return i / 4 * 2 + 1;\n    else\n        return (i - 1) / 4 * 2 + 2;\n}\n</code></pre> <p>Tr\u01b0\u1eddng h\u1ee3p c\u01a1 s\u1edf r\u1ea5t \u0111\u01a1n gi\u1ea3n: <code>D[i][0] = 1</code>, <code>D[1][1] = 1</code>.</p> <p>M\u1ed9t khi ch\u00fang ta \u0111\u00e3 t\u00ednh t\u1ea5t c\u1ea3 c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a <code>D[i][j]</code>, c\u00e2u tr\u1ea3 l\u1eddi c\u00f3 th\u1ec3 thu \u0111\u01b0\u1ee3c nh\u01b0 sau: xem x\u00e9t t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 l\u01b0\u1ee3ng qu\u00e2n t\u01b0\u1ee3ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c \u0111\u1eb7t tr\u00ean c\u00e1c \u0111\u01b0\u1eddng ch\u00e9o \u0111en <code>i=0...K</code>, v\u1edbi s\u1ed1 l\u01b0\u1ee3ng qu\u00e2n t\u01b0\u1ee3ng t\u01b0\u01a1ng \u1ee9ng tr\u00ean c\u00e1c \u0111\u01b0\u1eddng ch\u00e9o tr\u1eafng <code>K-i</code>. C\u00e1c qu\u00e2n t\u01b0\u1ee3ng \u0111\u01b0\u1ee3c \u0111\u1eb7t tr\u00ean c\u00e1c \u0111\u01b0\u1eddng ch\u00e9o \u0111en v\u00e0 tr\u1eafng kh\u00f4ng bao gi\u1edd t\u1ea5n c\u00f4ng l\u1eabn nhau, v\u00ec v\u1eady vi\u1ec7c \u0111\u1eb7t c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n \u0111\u1ed9c l\u1eadp. Ch\u1ec9 s\u1ed1 c\u1ee7a \u0111\u01b0\u1eddng ch\u00e9o \u0111en cu\u1ed1i c\u00f9ng l\u00e0 <code>2N-1</code>, ch\u1ec9 s\u1ed1 c\u1ee7a \u0111\u01b0\u1eddng ch\u00e9o tr\u1eafng cu\u1ed1i c\u00f9ng l\u00e0 <code>2N-2</code>. \u0110\u1ed1i v\u1edbi m\u1ed7i <code>i</code> ch\u00fang ta th\u00eam <code>D[2N-1][i] * D[2N-2][K-i]</code> v\u00e0o c\u00e2u tr\u1ea3 l\u1eddi.</p>","tags":["Translated"]},{"location":"combinatorics/bishops-on-chessboard.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<pre><code>int bishop_placements(int N, int K)\n{\n    if (K &gt; 2 * N - 1)\n        return 0;\n\n    vector&lt;vector&lt;int&gt;&gt; D(N * 2, vector&lt;int&gt;(K + 1));\n    for (int i = 0; i &lt; N * 2; ++i)\n        D[i][0] = 1;\n    D[1][1] = 1;\n    for (int i = 2; i &lt; N * 2; ++i)\n        for (int j = 1; j &lt;= K; ++j)\n            D[i][j] = D[i-2][j] + D[i-2][j-1] * (squares(i) - j + 1);\n\n    int ans = 0;\n    for (int i = 0; i &lt;= K; ++i)\n        ans += D[N*2-1][i] * D[N*2-2][K-i];\n    return ans;\n}\n</code></pre>","tags":["Translated"]},{"location":"combinatorics/bishops-on-chessboard.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 74</li> <li>Translated lines: 74</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Translated"]},{"location":"combinatorics/bracket_sequences.html","title":"D\u00e3y ngo\u1eb7c c\u00e2n b\u1eb1ng (Balanced bracket sequences)","text":"<p>M\u1ed9t d\u00e3y ngo\u1eb7c c\u00e2n b\u1eb1ng l\u00e0 m\u1ed9t chu\u1ed7i ch\u1ec9 bao g\u1ed3m c\u00e1c d\u1ea5u ngo\u1eb7c, sao cho chu\u1ed7i n\u00e0y, khi ch\u00e8n m\u1ed9t s\u1ed1 s\u1ed1 v\u00e0 ph\u00e9p to\u00e1n to\u00e1n h\u1ecdc nh\u1ea5t \u0111\u1ecbnh, t\u1ea1o ra m\u1ed9t bi\u1ec3u th\u1ee9c to\u00e1n h\u1ecdc h\u1ee3p l\u1ec7. V\u1ec1 m\u1eb7t h\u00ecnh th\u1ee9c, b\u1ea1n c\u00f3 th\u1ec3 \u0111\u1ecbnh ngh\u0129a d\u00e3y ngo\u1eb7c c\u00e2n b\u1eb1ng v\u1edbi:</p> <ul> <li>$e$ (chu\u1ed7i r\u1ed7ng) l\u00e0 m\u1ed9t d\u00e3y ngo\u1eb7c c\u00e2n b\u1eb1ng.</li> <li>n\u1ebfu $s$ l\u00e0 m\u1ed9t d\u00e3y ngo\u1eb7c c\u00e2n b\u1eb1ng, th\u00ec $(s)$ c\u0169ng v\u1eady.</li> <li>n\u1ebfu $s$ v\u00e0 $t$ l\u00e0 c\u00e1c d\u00e3y ngo\u1eb7c c\u00e2n b\u1eb1ng, th\u00ec $s t$ c\u0169ng v\u1eady.</li> </ul> <p>V\u00ed d\u1ee5 $(())()$ l\u00e0 m\u1ed9t d\u00e3y ngo\u1eb7c c\u00e2n b\u1eb1ng, nh\u01b0ng $())($ th\u00ec kh\u00f4ng.</p> <p>T\u1ea5t nhi\u00ean b\u1ea1n c\u0169ng c\u00f3 th\u1ec3 \u0111\u1ecbnh ngh\u0129a c\u00e1c d\u00e3y ngo\u1eb7c kh\u00e1c v\u1edbi nhi\u1ec1u lo\u1ea1i d\u1ea5u ngo\u1eb7c theo c\u00e1ch t\u01b0\u01a1ng t\u1ef1.</p> <p>Trong b\u00e0i vi\u1ebft n\u00e0y, ch\u00fang ta th\u1ea3o lu\u1eadn v\u1ec1 m\u1ed9t s\u1ed1 b\u00e0i to\u00e1n c\u1ed5 \u0111i\u1ec3n li\u00ean quan \u0111\u1ebfn d\u00e3y ngo\u1eb7c c\u00e2n b\u1eb1ng (\u0111\u1ec3 \u0111\u01a1n gi\u1ea3n ch\u00fang ta s\u1ebd ch\u1ec9 g\u1ecdi ch\u00fang l\u00e0 d\u00e3y): x\u00e1c th\u1ef1c, s\u1ed1 l\u01b0\u1ee3ng d\u00e3y, t\u00ecm d\u00e3y ti\u1ebfp theo theo th\u1ee9 t\u1ef1 t\u1eeb \u0111i\u1ec3n, t\u1ea1o t\u1ea5t c\u1ea3 c\u00e1c d\u00e3y c\u00f3 k\u00edch th\u01b0\u1edbc nh\u1ea5t \u0111\u1ecbnh, t\u00ecm ch\u1ec9 s\u1ed1 c\u1ee7a d\u00e3y, v\u00e0 t\u1ea1o d\u00e3y th\u1ee9 $k$. Ch\u00fang ta c\u0169ng s\u1ebd th\u1ea3o lu\u1eadn v\u1ec1 hai bi\u1ebfn th\u1ec3 cho c\u00e1c b\u00e0i to\u00e1n, phi\u00ean b\u1ea3n \u0111\u01a1n gi\u1ea3n h\u01a1n khi ch\u1ec9 cho ph\u00e9p m\u1ed9t lo\u1ea1i d\u1ea5u ngo\u1eb7c, v\u00e0 tr\u01b0\u1eddng h\u1ee3p kh\u00f3 h\u01a1n khi c\u00f3 nhi\u1ec1u lo\u1ea1i.</p>","tags":["Translated"]},{"location":"combinatorics/bracket_sequences.html#balance-validation","title":"Ki\u1ec3m tra t\u00ednh c\u00e2n b\u1eb1ng (Balance validation)","text":"<p>Ch\u00fang t\u00f4i mu\u1ed1n ki\u1ec3m tra xem m\u1ed9t chu\u1ed7i \u0111\u00e3 cho c\u00f3 c\u00e2n b\u1eb1ng hay kh\u00f4ng.</p> <p>\u0110\u1ea7u ti\u00ean gi\u1ea3 s\u1eed ch\u1ec9 c\u00f3 m\u1ed9t lo\u1ea1i d\u1ea5u ngo\u1eb7c. \u0110\u1ed1i v\u1edbi tr\u01b0\u1eddng h\u1ee3p n\u00e0y t\u1ed3n t\u1ea1i m\u1ed9t thu\u1eadt to\u00e1n r\u1ea5t \u0111\u01a1n gi\u1ea3n. G\u1ecdi $\\text{depth}$ l\u00e0 s\u1ed1 l\u01b0\u1ee3ng d\u1ea5u ngo\u1eb7c m\u1edf hi\u1ec7n t\u1ea1i. Ban \u0111\u1ea7u $\\text{depth} = 0$. Ch\u00fang ta l\u1eb7p qua t\u1ea5t c\u1ea3 c\u00e1c k\u00fd t\u1ef1 c\u1ee7a chu\u1ed7i, n\u1ebfu k\u00fd t\u1ef1 d\u1ea5u ngo\u1eb7c hi\u1ec7n t\u1ea1i l\u00e0 d\u1ea5u ngo\u1eb7c m\u1edf, th\u00ec ch\u00fang ta t\u0103ng $\\text{depth}$, n\u1ebfu kh\u00f4ng ch\u00fang ta gi\u1ea3m n\u00f3. N\u1ebfu b\u1ea5t c\u1ee9 l\u00fac n\u00e0o bi\u1ebfn $\\text{depth}$ tr\u1edf n\u00ean \u00e2m, ho\u1eb7c cu\u1ed1i c\u00f9ng n\u00f3 kh\u00e1c $0$, th\u00ec chu\u1ed7i kh\u00f4ng ph\u1ea3i l\u00e0 m\u1ed9t d\u00e3y c\u00e2n b\u1eb1ng. Ng\u01b0\u1ee3c l\u1ea1i th\u00ec \u0111\u00fang.</p> <p>N\u1ebfu c\u00f3 nhi\u1ec1u lo\u1ea1i d\u1ea5u ngo\u1eb7c tham gia, th\u00ec thu\u1eadt to\u00e1n c\u1ea7n ph\u1ea3i thay \u0111\u1ed5i. Thay v\u00ec m\u1ed9t b\u1ed9 \u0111\u1ebfm $\\text{depth}$ ch\u00fang ta t\u1ea1o m\u1ed9t ng\u0103n x\u1ebfp (stack), trong \u0111\u00f3 ch\u00fang ta s\u1ebd l\u01b0u tr\u1eef t\u1ea5t c\u1ea3 c\u00e1c d\u1ea5u ngo\u1eb7c m\u1edf m\u00e0 ch\u00fang ta g\u1eb7p. N\u1ebfu k\u00fd t\u1ef1 d\u1ea5u ngo\u1eb7c hi\u1ec7n t\u1ea1i l\u00e0 m\u1ed9t d\u1ea5u ngo\u1eb7c m\u1edf, ch\u00fang ta \u0111\u1eb7t n\u00f3 v\u00e0o ng\u0103n x\u1ebfp. N\u1ebfu n\u00f3 l\u00e0 m\u1ed9t d\u1ea5u ngo\u1eb7c \u0111\u00f3ng, th\u00ec ch\u00fang ta ki\u1ec3m tra xem ng\u0103n x\u1ebfp c\u00f3 kh\u00f4ng r\u1ed7ng hay kh\u00f4ng, v\u00e0 ph\u1ea7n t\u1eed tr\u00ean c\u00f9ng c\u1ee7a ng\u0103n x\u1ebfp c\u00f3 c\u00f9ng lo\u1ea1i v\u1edbi d\u1ea5u ngo\u1eb7c \u0111\u00f3ng hi\u1ec7n t\u1ea1i hay kh\u00f4ng. N\u1ebfu c\u1ea3 hai \u0111i\u1ec1u ki\u1ec7n \u0111\u01b0\u1ee3c \u0111\u00e1p \u1ee9ng, th\u00ec ch\u00fang ta lo\u1ea1i b\u1ecf d\u1ea5u ngo\u1eb7c m\u1edf kh\u1ecfi ng\u0103n x\u1ebfp. N\u1ebfu b\u1ea5t c\u1ee9 l\u00fac n\u00e0o m\u1ed9t trong c\u00e1c \u0111i\u1ec1u ki\u1ec7n kh\u00f4ng \u0111\u01b0\u1ee3c \u0111\u00e1p \u1ee9ng, ho\u1eb7c cu\u1ed1i c\u00f9ng ng\u0103n x\u1ebfp kh\u00f4ng r\u1ed7ng, th\u00ec chu\u1ed7i kh\u00f4ng c\u00e2n b\u1eb1ng. Ng\u01b0\u1ee3c l\u1ea1i th\u00ec \u0111\u00fang.</p>","tags":["Translated"]},{"location":"combinatorics/bracket_sequences.html#number-of-balanced-sequences","title":"S\u1ed1 l\u01b0\u1ee3ng d\u00e3y c\u00e2n b\u1eb1ng (Number of balanced sequences)","text":"","tags":["Translated"]},{"location":"combinatorics/bracket_sequences.html#formula","title":"C\u00f4ng th\u1ee9c (Formula)","text":"<p>S\u1ed1 l\u01b0\u1ee3ng d\u00e3y ngo\u1eb7c c\u00e2n b\u1eb1ng v\u1edbi ch\u1ec9 m\u1ed9t lo\u1ea1i d\u1ea5u ngo\u1eb7c c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ednh b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng s\u1ed1 Catalan. S\u1ed1 l\u01b0\u1ee3ng d\u00e3y ngo\u1eb7c c\u00e2n b\u1eb1ng c\u00f3 \u0111\u1ed9 d\u00e0i $2n$ ($n$ c\u1eb7p d\u1ea5u ngo\u1eb7c) l\u00e0:</p> $$\\frac{1}{n+1} \\binom{2n}{n}$$ <p>N\u1ebfu ch\u00fang ta cho ph\u00e9p $k$ lo\u1ea1i d\u1ea5u ngo\u1eb7c, th\u00ec m\u1ed7i c\u1eb7p c\u00f3 th\u1ec3 thu\u1ed9c b\u1ea5t k\u1ef3 lo\u1ea1i n\u00e0o trong s\u1ed1 $k$ lo\u1ea1i (\u0111\u1ed9c l\u1eadp v\u1edbi c\u00e1c lo\u1ea1i kh\u00e1c), do \u0111\u00f3 s\u1ed1 l\u01b0\u1ee3ng d\u00e3y ngo\u1eb7c c\u00e2n b\u1eb1ng l\u00e0:</p> $$\\frac{1}{n+1} \\binom{2n}{n} k^n$$","tags":["Translated"]},{"location":"combinatorics/bracket_sequences.html#dynamic-programming","title":"Quy ho\u1ea1ch \u0111\u1ed9ng (Dynamic programming)","text":"<p>M\u1eb7t kh\u00e1c, nh\u1eefng con s\u1ed1 n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng quy ho\u1ea1ch \u0111\u1ed9ng. G\u1ecdi $d[n]$ l\u00e0 s\u1ed1 l\u01b0\u1ee3ng d\u00e3y ngo\u1eb7c th\u00f4ng th\u01b0\u1eddng v\u1edbi $n$ c\u1eb7p d\u1ea5u ngo\u1eb7c. L\u01b0u \u00fd r\u1eb1ng \u1edf v\u1ecb tr\u00ed \u0111\u1ea7u ti\u00ean lu\u00f4n c\u00f3 m\u1ed9t d\u1ea5u ngo\u1eb7c m\u1edf. V\u00e0 \u0111\u00e2u \u0111\u00f3 sau \u0111\u00f3 l\u00e0 d\u1ea5u ngo\u1eb7c \u0111\u00f3ng t\u01b0\u01a1ng \u1ee9ng c\u1ee7a c\u1eb7p. R\u00f5 r\u00e0ng l\u00e0 b\u00ean trong c\u1eb7p n\u00e0y c\u00f3 m\u1ed9t d\u00e3y ngo\u1eb7c c\u00e2n b\u1eb1ng, v\u00e0 t\u01b0\u01a1ng t\u1ef1 sau c\u1eb7p n\u00e0y c\u00f3 m\u1ed9t d\u00e3y ngo\u1eb7c c\u00e2n b\u1eb1ng. V\u00ec v\u1eady, \u0111\u1ec3 t\u00ednh $d[n]$, ch\u00fang ta s\u1ebd xem x\u00e9t c\u00f3 bao nhi\u00eau d\u00e3y c\u00e2n b\u1eb1ng c\u1ee7a $i$ c\u1eb7p d\u1ea5u ngo\u1eb7c b\u00ean trong c\u1eb7p d\u1ea5u ngo\u1eb7c \u0111\u1ea7u ti\u00ean n\u00e0y, v\u00e0 c\u00f3 bao nhi\u00eau d\u00e3y c\u00e2n b\u1eb1ng v\u1edbi $n-1-i$ c\u1eb7p sau c\u1eb7p n\u00e0y. Do \u0111\u00f3 c\u00f4ng th\u1ee9c c\u00f3 d\u1ea1ng:</p> $$d[n] = \\sum_{i=0}^{n-1} d[i] \\cdot d[n-1-i]$$ <p>Gi\u00e1 tr\u1ecb ban \u0111\u1ea7u cho truy h\u1ed3i n\u00e0y l\u00e0 $d[0] = 1$.</p>","tags":["Translated"]},{"location":"combinatorics/bracket_sequences.html#finding-the-lexicographical-next-balanced-sequence","title":"T\u00ecm d\u00e3y c\u00e2n b\u1eb1ng ti\u1ebfp theo theo th\u1ee9 t\u1ef1 t\u1eeb \u0111i\u1ec3n (Finding the lexicographical next balanced sequence)","text":"<p>\u1ede \u0111\u00e2y ch\u00fang ta ch\u1ec9 xem x\u00e9t tr\u01b0\u1eddng h\u1ee3p v\u1edbi m\u1ed9t lo\u1ea1i d\u1ea5u ngo\u1eb7c h\u1ee3p l\u1ec7.</p> <p>Cho m\u1ed9t d\u00e3y c\u00e2n b\u1eb1ng, ch\u00fang ta ph\u1ea3i t\u00ecm d\u00e3y c\u00e2n b\u1eb1ng ti\u1ebfp theo (theo th\u1ee9 t\u1ef1 t\u1eeb \u0111i\u1ec3n).</p> <p>R\u00f5 r\u00e0ng l\u00e0, ch\u00fang ta ph\u1ea3i t\u00ecm d\u1ea5u ngo\u1eb7c m\u1edf ngo\u00e0i c\u00f9ng b\u00ean ph\u1ea3i, m\u00e0 ch\u00fang ta c\u00f3 th\u1ec3 thay th\u1ebf b\u1eb1ng m\u1ed9t d\u1ea5u ngo\u1eb7c \u0111\u00f3ng m\u00e0 kh\u00f4ng vi ph\u1ea1m \u0111i\u1ec1u ki\u1ec7n, r\u1eb1ng c\u00f3 nhi\u1ec1u d\u1ea5u ngo\u1eb7c \u0111\u00f3ng h\u01a1n d\u1ea5u ngo\u1eb7c m\u1edf cho \u0111\u1ebfn v\u1ecb tr\u00ed n\u00e0y. Sau khi thay th\u1ebf v\u1ecb tr\u00ed n\u00e0y, ch\u00fang ta c\u00f3 th\u1ec3 \u0111i\u1ec1n ph\u1ea7n c\u00f2n l\u1ea1i c\u1ee7a chu\u1ed7i b\u1eb1ng ph\u1ea7n nh\u1ecf nh\u1ea5t theo th\u1ee9 t\u1ef1 t\u1eeb \u0111i\u1ec3n: t\u1ee9c l\u00e0 \u0111\u1ea7u ti\u00ean v\u1edbi c\u00e0ng nhi\u1ec1u d\u1ea5u ngo\u1eb7c m\u1edf c\u00e0ng t\u1ed1t, v\u00e0 sau \u0111\u00f3 \u0111i\u1ec1n v\u00e0o c\u00e1c v\u1ecb tr\u00ed c\u00f2n l\u1ea1i b\u1eb1ng c\u00e1c d\u1ea5u ngo\u1eb7c \u0111\u00f3ng. N\u00f3i c\u00e1ch kh\u00e1c, ch\u00fang t\u00f4i c\u1ed1 g\u1eafng \u0111\u1ec3 l\u1ea1i m\u1ed9t ti\u1ec1n t\u1ed1 d\u00e0i nh\u1ea5t c\u00f3 th\u1ec3 kh\u00f4ng thay \u0111\u1ed5i, v\u00e0 h\u1eadu t\u1ed1 \u0111\u01b0\u1ee3c thay th\u1ebf b\u1eb1ng c\u00e1i nh\u1ecf nh\u1ea5t theo th\u1ee9 t\u1ef1 t\u1eeb \u0111i\u1ec3n.</p> <p>\u0110\u1ec3 t\u00ecm v\u1ecb tr\u00ed n\u00e0y, ch\u00fang ta c\u00f3 th\u1ec3 l\u1eb7p qua k\u00fd t\u1ef1 t\u1eeb ph\u1ea3i sang tr\u00e1i, v\u00e0 duy tr\u00ec \u0111\u1ed9 c\u00e2n b\u1eb1ng $\\text{depth}$ c\u1ee7a c\u00e1c d\u1ea5u ngo\u1eb7c m\u1edf v\u00e0 \u0111\u00f3ng. Khi ch\u00fang ta g\u1eb7p m\u1ed9t d\u1ea5u ngo\u1eb7c m\u1edf, ch\u00fang ta s\u1ebd gi\u1ea3m $\\text{depth}$, v\u00e0 khi ch\u00fang ta g\u1eb7p m\u1ed9t d\u1ea5u ngo\u1eb7c \u0111\u00f3ng, ch\u00fang ta t\u0103ng n\u00f3. N\u1ebfu t\u1ea1i m\u1ed9t th\u1eddi \u0111i\u1ec3m n\u00e0o \u0111\u00f3 ch\u00fang ta g\u1eb7p m\u1ed9t d\u1ea5u ngo\u1eb7c m\u1edf, v\u00e0 \u0111\u1ed9 c\u00e2n b\u1eb1ng sau khi x\u1eed l\u00fd k\u00fd hi\u1ec7u n\u00e0y l\u00e0 d\u01b0\u01a1ng, th\u00ec ch\u00fang ta \u0111\u00e3 t\u00ecm th\u1ea5y v\u1ecb tr\u00ed ngo\u00e0i c\u00f9ng b\u00ean ph\u1ea3i m\u00e0 ch\u00fang ta c\u00f3 th\u1ec3 thay \u0111\u1ed5i. Ch\u00fang ta thay \u0111\u1ed5i k\u00fd hi\u1ec7u, t\u00ednh s\u1ed1 l\u01b0\u1ee3ng d\u1ea5u ngo\u1eb7c m\u1edf v\u00e0 \u0111\u00f3ng m\u00e0 ch\u00fang ta ph\u1ea3i th\u00eam v\u00e0o ph\u00eda b\u00ean ph\u1ea3i, v\u00e0 s\u1eafp x\u1ebfp ch\u00fang theo c\u00e1ch nh\u1ecf nh\u1ea5t theo th\u1ee9 t\u1ef1 t\u1eeb \u0111i\u1ec3n.</p> <p>N\u1ebfu ch\u00fang ta kh\u00f4ng t\u00ecm th\u1ea5y m\u1ed9t v\u1ecb tr\u00ed ph\u00f9 h\u1ee3p, th\u00ec d\u00e3y n\u00e0y \u0111\u00e3 l\u00e0 d\u00e3y l\u1edbn nh\u1ea5t c\u00f3 th\u1ec3, v\u00e0 kh\u00f4ng c\u00f3 c\u00e2u tr\u1ea3 l\u1eddi.</p> <pre><code>bool next_balanced_sequence(string &amp; s) {\n    int n = s.size();\n    int depth = 0;\n    for (int i = n - 1; i &gt;= 0; i--) {\n        if (s[i] == '(')\n            depth--;\n        else\n            depth++;\n\n        if (s[i] == '(' &amp;&amp; depth &gt; 0) {\n            depth--;\n            int open = (n - i - 1 - depth) / 2;\n            int close = n - i - 1 - open;\n            string next = s.substr(0, i) + ')' + string(open, '(') + string(close, ')');\n            s.swap(next);\n            return true;\n        }\n    }\n    return false;\n}\n</code></pre> <p>H\u00e0m n\u00e0y t\u00ednh to\u00e1n trong th\u1eddi gian $O(n)$ d\u00e3y ngo\u1eb7c c\u00e2n b\u1eb1ng ti\u1ebfp theo, v\u00e0 tr\u1ea3 v\u1ec1 false n\u1ebfu kh\u00f4ng c\u00f3 d\u00e3y ti\u1ebfp theo.</p>","tags":["Translated"]},{"location":"combinatorics/bracket_sequences.html#finding-all-balanced-sequences","title":"T\u00ecm t\u1ea5t c\u1ea3 c\u00e1c d\u00e3y c\u00e2n b\u1eb1ng (Finding all balanced sequences)","text":"<p>\u0110\u00f4i khi \u0111\u01b0\u1ee3c y\u00eau c\u1ea7u t\u00ecm v\u00e0 xu\u1ea5t t\u1ea5t c\u1ea3 c\u00e1c d\u00e3y ngo\u1eb7c c\u00e2n b\u1eb1ng c\u00f3 \u0111\u1ed9 d\u00e0i c\u1ee5 th\u1ec3 $n$.</p> <p>\u0110\u1ec3 t\u1ea1o sau \u0111\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 b\u1eaft \u0111\u1ea7u v\u1edbi d\u00e3y nh\u1ecf nh\u1ea5t theo th\u1ee9 t\u1ef1 t\u1eeb \u0111i\u1ec3n $((\\dots(())\\dots))$, v\u00e0 sau \u0111\u00f3 ti\u1ebfp t\u1ee5c t\u00ecm c\u00e1c d\u00e3y ti\u1ebfp theo theo th\u1ee9 t\u1ef1 t\u1eeb \u0111i\u1ec3n v\u1edbi thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 trong ph\u1ea7n tr\u01b0\u1edbc.</p> <p>Tuy nhi\u00ean, n\u1ebfu \u0111\u1ed9 d\u00e0i c\u1ee7a chu\u1ed7i kh\u00f4ng qu\u00e1 d\u00e0i (v\u00ed d\u1ee5 $n$ nh\u1ecf h\u01a1n $12$), th\u00ec ch\u00fang ta c\u0169ng c\u00f3 th\u1ec3 t\u1ea1o t\u1ea5t c\u1ea3 c\u00e1c ho\u00e1n v\u1ecb m\u1ed9t c\u00e1ch thu\u1eadn ti\u1ec7n v\u1edbi h\u00e0m C++ STL <code>next_permutation</code>, v\u00e0 ki\u1ec3m tra t\u1eebng c\u00e1i m\u1ed9t cho t\u00ednh c\u00e2n b\u1eb1ng.</p> <p>Ngo\u00e0i ra ch\u00fang c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u1ea1o b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng c\u00e1c \u00fd t\u01b0\u1edfng ch\u00fang ta \u0111\u00e3 s\u1eed d\u1ee5ng \u0111\u1ec3 \u0111\u1ebfm t\u1ea5t c\u1ea3 c\u00e1c d\u00e3y v\u1edbi quy ho\u1ea1ch \u0111\u1ed9ng. Ch\u00fang ta s\u1ebd th\u1ea3o lu\u1eadn v\u1ec1 c\u00e1c \u00fd t\u01b0\u1edfng trong hai ph\u1ea7n ti\u1ebfp theo.</p>","tags":["Translated"]},{"location":"combinatorics/bracket_sequences.html#sequence-index","title":"Ch\u1ec9 s\u1ed1 c\u1ee7a d\u00e3y (Sequence index)","text":"<p>Cho m\u1ed9t d\u00e3y ngo\u1eb7c c\u00e2n b\u1eb1ng v\u1edbi $n$ c\u1eb7p d\u1ea5u ngo\u1eb7c. Ch\u00fang ta ph\u1ea3i t\u00ecm ch\u1ec9 s\u1ed1 c\u1ee7a n\u00f3 trong danh s\u00e1ch \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp theo th\u1ee9 t\u1ef1 t\u1eeb \u0111i\u1ec3n c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c d\u00e3y c\u00e2n b\u1eb1ng v\u1edbi $n$ c\u1eb7p d\u1ea5u ngo\u1eb7c.</p> <p>H\u00e3y x\u00e1c \u0111\u1ecbnh m\u1ed9t m\u1ea3ng ph\u1ee5 tr\u1ee3 $d[i][j]$, trong \u0111\u00f3 $i$ l\u00e0 \u0111\u1ed9 d\u00e0i c\u1ee7a d\u00e3y ngo\u1eb7c (b\u00e1n b\u00e2n b\u1eb1ng, m\u1ed7i d\u1ea5u ngo\u1eb7c \u0111\u00f3ng c\u00f3 m\u1ed9t d\u1ea5u ngo\u1eb7c m\u1edf t\u01b0\u01a1ng \u1ee9ng, nh\u01b0ng kh\u00f4ng ph\u1ea3i m\u1ecdi d\u1ea5u ngo\u1eb7c m\u1edf nh\u1ea5t thi\u1ebft ph\u1ea3i c\u00f3 m\u1ed9t d\u1ea5u ngo\u1eb7c \u0111\u00f3ng t\u01b0\u01a1ng \u1ee9ng), v\u00e0 $j$ l\u00e0 \u0111\u1ed9 c\u00e2n b\u1eb1ng hi\u1ec7n t\u1ea1i (hi\u1ec7u gi\u1eefa d\u1ea5u ngo\u1eb7c m\u1edf v\u00e0 \u0111\u00f3ng). $d[i][j]$ l\u00e0 s\u1ed1 l\u01b0\u1ee3ng c\u00e1c d\u00e3y nh\u01b0 v\u1eady ph\u00f9 h\u1ee3p v\u1edbi c\u00e1c tham s\u1ed1. Ch\u00fang ta s\u1ebd t\u00ednh to\u00e1n c\u00e1c s\u1ed1 n\u00e0y ch\u1ec9 v\u1edbi m\u1ed9t lo\u1ea1i d\u1ea5u ngo\u1eb7c.</p> <p>\u0110\u1ed1i v\u1edbi gi\u00e1 tr\u1ecb b\u1eaft \u0111\u1ea7u $i = 0$ c\u00e2u tr\u1ea3 l\u1eddi l\u00e0 r\u00f5 r\u00e0ng: $d[0][0] = 1$, v\u00e0 $d[0][j] = 0$ cho $j &gt; 0$. B\u00e2y gi\u1edd g\u1ecdi $i &gt; 0$, v\u00e0 ch\u00fang ta nh\u00ecn v\u00e0o k\u00fd t\u1ef1 cu\u1ed1i c\u00f9ng trong d\u00e3y. N\u1ebfu k\u00fd t\u1ef1 cu\u1ed1i c\u00f9ng l\u00e0 m\u1ed9t d\u1ea5u ngo\u1eb7c m\u1edf $($, th\u00ec tr\u1ea1ng th\u00e1i tr\u01b0\u1edbc \u0111\u00f3 l\u00e0 $(i-1, j-1)$, n\u1ebfu n\u00f3 l\u00e0 m\u1ed9t d\u1ea5u ngo\u1eb7c \u0111\u00f3ng $)$, th\u00ec tr\u1ea1ng th\u00e1i tr\u01b0\u1edbc \u0111\u00f3 l\u00e0 $(i-1, j+1)$. Do \u0111\u00f3 ch\u00fang ta thu \u0111\u01b0\u1ee3c c\u00f4ng th\u1ee9c \u0111\u1ec7 quy:</p> $$d[i][j] = d[i-1][j-1] + d[i-1][j+1]$$ <p>$d[i][j] = 0$ gi\u1eef \u0111\u00fang r\u00f5 r\u00e0ng cho $j$ \u00e2m. Do \u0111\u00f3 ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh m\u1ea3ng n\u00e0y trong $O(n^2)$.</p> <p>B\u00e2y gi\u1edd ch\u00fang ta h\u00e3y t\u1ea1o ch\u1ec9 s\u1ed1 cho m\u1ed9t d\u00e3y \u0111\u00e3 cho.</p> <p>\u0110\u1ea7u ti\u00ean g\u1ecdi ch\u1ec9 c\u00f3 m\u1ed9t lo\u1ea1i d\u1ea5u ngo\u1eb7c. Ch\u00fang ta s\u1ebd s\u1eed d\u1ee5ng b\u1ed9 \u0111\u1ebfm $\\text{depth}$ cho bi\u1ebft m\u1ee9c \u0111\u1ed9 l\u1ed3ng nhau hi\u1ec7n t\u1ea1i c\u1ee7a ch\u00fang ta, v\u00e0 l\u1eb7p qua c\u00e1c k\u00fd t\u1ef1 c\u1ee7a d\u00e3y. N\u1ebfu k\u00fd t\u1ef1 hi\u1ec7n t\u1ea1i $s[i]$ b\u1eb1ng $($, th\u00ec ch\u00fang ta t\u0103ng $\\text{depth}$. N\u1ebfu k\u00fd t\u1ef1 hi\u1ec7n t\u1ea1i $s[i]$ b\u1eb1ng $)$, th\u00ec ch\u00fang ta ph\u1ea3i th\u00eam $d[2n-i-1][\\text{depth}+1]$ v\u00e0o c\u00e2u tr\u1ea3 l\u1eddi, t\u00ednh \u0111\u1ebfn t\u1ea5t c\u1ea3 c\u00e1c k\u1ebft th\u00fac c\u00f3 th\u1ec3 b\u1eaft \u0111\u1ea7u b\u1eb1ng m\u1ed9t $($ (l\u00e0 c\u00e1c d\u00e3y nh\u1ecf h\u01a1n theo th\u1ee9 t\u1ef1 t\u1eeb \u0111i\u1ec3n), v\u00e0 sau \u0111\u00f3 gi\u1ea3m $\\text{depth}$.</p> <p>M\u1edbi g\u1ecdi c\u00f3 $k$ lo\u1ea1i d\u1ea5u ngo\u1eb7c kh\u00e1c nhau.</p> <p>Do \u0111\u00f3, khi ch\u00fang ta nh\u00ecn v\u00e0o k\u00fd t\u1ef1 hi\u1ec7n t\u1ea1i $s[i]$ tr\u01b0\u1edbc khi t\u00ednh to\u00e1n l\u1ea1i $\\text{depth}$, ch\u00fang ta ph\u1ea3i \u0111i qua t\u1ea5t c\u1ea3 c\u00e1c lo\u1ea1i d\u1ea5u ngo\u1eb7c nh\u1ecf h\u01a1n k\u00fd t\u1ef1 hi\u1ec7n t\u1ea1i, v\u00e0 c\u1ed1 g\u1eafng \u0111\u1eb7t d\u1ea5u ngo\u1eb7c n\u00e0y v\u00e0o v\u1ecb tr\u00ed hi\u1ec7n t\u1ea1i (thu \u0111\u01b0\u1ee3c \u0111\u1ed9 c\u00e2n b\u1eb1ng m\u1edbi $\\text{ndepth} = \\text{depth} \\pm 1$), v\u00e0 th\u00eam s\u1ed1 c\u00e1ch \u0111\u1ec3 ho\u00e0n th\u00e0nh d\u00e3y (\u0111\u1ed9 d\u00e0i $2n-i-1$, c\u00e2n b\u1eb1ng $ndepth$) v\u00e0o c\u00e2u tr\u1ea3 l\u1eddi:</p> $$d[2n - i - 1][\\text{ndepth}] \\cdot k^{\\frac{2n - i - 1 - ndepth}{2}}$$ <p>C\u00f4ng th\u1ee9c n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c suy ra nh\u01b0 sau: \u0110\u1ea7u ti\u00ean ch\u00fang ta \"qu\u00ean\" r\u1eb1ng c\u00f3 nhi\u1ec1u lo\u1ea1i d\u1ea5u ngo\u1eb7c, v\u00e0 ch\u1ec9 l\u1ea5y c\u00e2u tr\u1ea3 l\u1eddi $d[2n - i - 1][\\text{ndepth}]$. B\u00e2y gi\u1edd ch\u00fang ta xem x\u00e9t c\u00e2u tr\u1ea3 l\u1eddi s\u1ebd thay \u0111\u1ed5i nh\u01b0 th\u1ebf n\u00e0o n\u1ebfu ch\u00fang ta c\u00f3 $k$ lo\u1ea1i d\u1ea5u ngo\u1eb7c. Ch\u00fang ta c\u00f3 $2n - i - 1$ v\u1ecb tr\u00ed ch\u01b0a x\u00e1c \u0111\u1ecbnh, trong \u0111\u00f3 $\\text{ndepth}$ \u0111\u00e3 \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh tr\u01b0\u1edbc v\u00ec c\u00e1c d\u1ea5u ngo\u1eb7c m\u1edf. Nh\u01b0ng t\u1ea5t c\u1ea3 c\u00e1c d\u1ea5u ngo\u1eb7c kh\u00e1c ($(2n - i - 1 - \\text{ndepth})/2$ c\u1eb7p) c\u00f3 th\u1ec3 thu\u1ed9c b\u1ea5t k\u1ef3 lo\u1ea1i n\u00e0o, do \u0111\u00f3 ch\u00fang ta nh\u00e2n s\u1ed1 \u0111\u00f3 v\u1edbi m\u1ed9t l\u0169y th\u1eeba nh\u01b0 v\u1eady c\u1ee7a $k$.</p>","tags":["Translated"]},{"location":"combinatorics/bracket_sequences.html#finding-the-k-th-sequence","title":"T\u00ecm d\u00e3y th\u1ee9 $k$ (Finding the $k$-th sequence)","text":"<p>G\u1ecdi $n$ l\u00e0 s\u1ed1 l\u01b0\u1ee3ng c\u1eb7p d\u1ea5u ngo\u1eb7c trong d\u00e3y. Ch\u00fang ta ph\u1ea3i t\u00ecm d\u00e3y c\u00e2n b\u1eb1ng th\u1ee9 $k$ trong danh s\u00e1ch \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp theo th\u1ee9 t\u1ef1 t\u1eeb \u0111i\u1ec3n c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c d\u00e3y c\u00e2n b\u1eb1ng cho m\u1ed9t $k$ \u0111\u00e3 cho.</p> <p>Nh\u01b0 trong ph\u1ea7n tr\u01b0\u1edbc, ch\u00fang ta t\u00ednh m\u1ea3ng ph\u1ee5 $d[i][j]$, s\u1ed1 l\u01b0\u1ee3ng c\u00e1c d\u00e3y ngo\u1eb7c b\u00e1n c\u00e2n b\u1eb1ng c\u00f3 \u0111\u1ed9 d\u00e0i $i$ v\u1edbi \u0111\u1ed9 c\u00e2n b\u1eb1ng $j$.</p> <p>\u0110\u1ea7u ti\u00ean, ch\u00fang ta b\u1eaft \u0111\u1ea7u v\u1edbi ch\u1ec9 m\u1ed9t lo\u1ea1i d\u1ea5u ngo\u1eb7c.</p> <p>Ch\u00fang ta s\u1ebd l\u1eb7p qua c\u00e1c k\u00fd t\u1ef1 trong chu\u1ed7i ch\u00fang ta mu\u1ed1n t\u1ea1o. Nh\u01b0 trong b\u00e0i to\u00e1n tr\u01b0\u1edbc, ch\u00fang ta l\u01b0u tr\u1eef m\u1ed9t b\u1ed9 \u0111\u1ebfm $\\text{depth}$, \u0111\u1ed9 s\u00e2u l\u1ed3ng nhau hi\u1ec7n t\u1ea1i. T\u1ea1i m\u1ed7i v\u1ecb tr\u00ed, ch\u00fang ta ph\u1ea3i quy\u1ebft \u0111\u1ecbnh xem n\u00ean \u0111\u1eb7t m\u1ed9t d\u1ea5u ngo\u1eb7c m\u1edf hay d\u1ea5u ngo\u1eb7c \u0111\u00f3ng. \u0110\u1ec3 \u0111\u1eb7t m\u1ed9t d\u1ea5u ngo\u1eb7c m\u1edf, $d[2n - i - 1][\\text{depth}+1] \\ge k$ ph\u1ea3i \u0111\u00fang. N\u1ebfu v\u1eady, ch\u00fang ta t\u0103ng b\u1ed9 \u0111\u1ebfm $\\text{depth}$, v\u00e0 chuy\u1ec3n sang k\u00fd t\u1ef1 ti\u1ebfp theo. N\u1ebfu kh\u00f4ng, ch\u00fang ta gi\u1ea3m $k$ \u0111i $d[2n - i - 1][\\text{depth}+1]$, \u0111\u1eb7t m\u1ed9t d\u1ea5u ngo\u1eb7c \u0111\u00f3ng, v\u00e0 ti\u1ebfp t\u1ee5c.</p> <pre><code>string kth_balanced(int n, int k) {\n    vector&lt;vector&lt;int&gt;&gt; d(2*n+1, vector&lt;int&gt;(n+1, 0));\n    d[0][0] = 1;\n    for (int i = 1; i &lt;= 2*n; i++) {\n        d[i][0] = d[i-1][1];\n        for (int j = 1; j &lt; n; j++)\n            d[i][j] = d[i-1][j-1] + d[i-1][j+1];\n        d[i][n] = d[i-1][n-1];\n    }\n\n    string ans;\n    int depth = 0;\n    for (int i = 0; i &lt; 2*n; i++) {\n        if (depth + 1 &lt;= n &amp;&amp; d[2*n-i-1][depth+1] &gt;= k) {\n            ans += '(';\n            depth++;\n        } else {\n            ans += ')';\n            if (depth + 1 &lt;= n)\n                k -= d[2*n-i-1][depth+1];\n            depth--;\n        }\n    }\n    return ans;\n}\n</code></pre> <p>B\u00e2y gi\u1edd g\u1ecdi c\u00f3 $k$ lo\u1ea1i d\u1ea5u ngo\u1eb7c. Gi\u1ea3i ph\u00e1p s\u1ebd ch\u1ec9 kh\u00e1c m\u1ed9t ch\u00fat \u1edf ch\u1ed7 ch\u00fang ta ph\u1ea3i nh\u00e2n gi\u00e1 tr\u1ecb $d[2n-i-1][\\text{ndepth}]$ v\u1edbi $k^{(2n-i-1-\\text{ndepth})/2}$ v\u00e0 t\u00ednh \u0111\u1ebfn vi\u1ec7c c\u00f3 th\u1ec3 c\u00f3 c\u00e1c lo\u1ea1i d\u1ea5u ngo\u1eb7c kh\u00e1c nhau cho k\u00fd t\u1ef1 ti\u1ebfp theo.</p> <p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u1ed9t c\u00e0i \u0111\u1eb7t s\u1eed d\u1ee5ng hai lo\u1ea1i d\u1ea5u ngo\u1eb7c: tr\u00f2n v\u00e0 vu\u00f4ng:</p> <pre><code>string kth_balanced2(int n, int k) {\n    vector&lt;vector&lt;int&gt;&gt; d(2*n+1, vector&lt;int&gt;(n+1, 0));\n    d[0][0] = 1;\n    for (int i = 1; i &lt;= 2*n; i++) {\n        d[i][0] = d[i-1][1];\n        for (int j = 1; j &lt; n; j++)\n            d[i][j] = d[i-1][j-1] + d[i-1][j+1];\n        d[i][n] = d[i-1][n-1];\n    }\n\n    string ans;\n    int shift, depth = 0;\n\n    stack&lt;char&gt; st;\n    for (int i = 0; i &lt; 2*n; i++) {\n\n        // '('\n        shift = ((2*n-i-1-depth-1) / 2);\n        if (shift &gt;= 0 &amp;&amp; depth + 1 &lt;= n) {\n            int cnt = d[2*n-i-1][depth+1] &lt;&lt; shift;\n            if (cnt &gt;= k) {\n                ans += '(';\n                st.push('(');\n                depth++;\n                continue;\n            }\n            k -= cnt;\n        }\n\n        // ')'\n        shift = ((2*n-i-1-depth+1) / 2);\n        if (shift &gt;= 0 &amp;&amp; depth &amp;&amp; st.top() == '(') {\n            int cnt = d[2*n-i-1][depth-1] &lt;&lt; shift;\n            if (cnt &gt;= k) {\n                ans += ')';\n                st.pop();\n                depth--;\n                continue;\n            }\n            k -= cnt;\n        }\n\n        // '['\n        shift = ((2*n-i-1-depth-1) / 2);\n        if (shift &gt;= 0 &amp;&amp; depth + 1 &lt;= n) {\n            int cnt = d[2*n-i-1][depth+1] &lt;&lt; shift;\n            if (cnt &gt;= k) {\n                ans += '[';\n                st.push('[');\n                depth++;\n                continue;\n            }\n            k -= cnt;\n        }\n\n        // ']'\n        ans += ']';\n        st.pop();\n        depth--;\n    }\n    return ans;\n}\n</code></pre>","tags":["Translated"]},{"location":"combinatorics/bracket_sequences.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 273</li> <li>Translated lines: 273</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Translated"]},{"location":"combinatorics/burnside.html","title":"B\u1ed5 \u0111\u1ec1 Burnside / \u0110\u1ecbnh l\u00fd \u0111\u1ebfm P\u00f3lya (Burnside's lemma / P\u00f3lya enumeration theorem)","text":"","tags":["Translated"]},{"location":"combinatorics/burnside.html#burnsides-lemma","title":"B\u1ed5 \u0111\u1ec1 Burnside (Burnside's lemma)","text":"<p>B\u1ed5 \u0111\u1ec1 Burnside \u0111\u01b0\u1ee3c x\u00e2y d\u1ef1ng v\u00e0 ch\u1ee9ng minh b\u1edfi Burnside v\u00e0o n\u0103m 1897, nh\u01b0ng v\u1ec1 m\u1eb7t l\u1ecbch s\u1eed n\u00f3 \u0111\u00e3 \u0111\u01b0\u1ee3c ph\u00e1t hi\u1ec7n v\u00e0o n\u0103m 1887 b\u1edfi Frobenius, v\u00e0 th\u1eadm ch\u00ed s\u1edbm h\u01a1n v\u00e0o n\u0103m 1845 b\u1edfi Cauchy. Do \u0111\u00f3, n\u00f3 \u0111\u00f4i khi c\u0169ng \u0111\u01b0\u1ee3c \u0111\u1eb7t t\u00ean l\u00e0 b\u1ed5 \u0111\u1ec1 Cauchy-Frobenius.</p> <p>B\u1ed5 \u0111\u1ec1 Burnside cho ph\u00e9p ch\u00fang ta \u0111\u1ebfm s\u1ed1 l\u01b0\u1ee3ng c\u00e1c l\u1edbp t\u01b0\u01a1ng \u0111\u01b0\u01a1ng trong c\u00e1c t\u1eadp h\u1ee3p, d\u1ef1a tr\u00ean s\u1ef1 \u0111\u1ed1i x\u1ee9ng b\u00ean trong.</p>","tags":["Translated"]},{"location":"combinatorics/burnside.html#objects-and-representations","title":"\u0110\u1ed1i t\u01b0\u1ee3ng v\u00e0 bi\u1ec3u di\u1ec5n (Objects and representations)","text":"<p>Ch\u00fang ta ph\u1ea3i ph\u00e2n bi\u1ec7t r\u00f5 r\u00e0ng gi\u1eefa s\u1ed1 l\u01b0\u1ee3ng \u0111\u1ed1i t\u01b0\u1ee3ng v\u00e0 s\u1ed1 l\u01b0\u1ee3ng bi\u1ec3u di\u1ec5n.</p> <p>C\u00e1c bi\u1ec3u di\u1ec5n kh\u00e1c nhau c\u00f3 th\u1ec3 t\u01b0\u01a1ng \u1ee9ng v\u1edbi c\u00f9ng m\u1ed9t \u0111\u1ed1i t\u01b0\u1ee3ng, nh\u01b0ng t\u1ea5t nhi\u00ean m\u1ecdi bi\u1ec3u di\u1ec5n t\u01b0\u01a1ng \u1ee9ng v\u1edbi ch\u00ednh x\u00e1c m\u1ed9t \u0111\u1ed1i t\u01b0\u1ee3ng. Do \u0111\u00f3, t\u1eadp h\u1ee3p c\u00e1c bi\u1ec3u di\u1ec5n \u0111\u01b0\u1ee3c chia th\u00e0nh c\u00e1c l\u1edbp t\u01b0\u01a1ng \u0111\u01b0\u01a1ng. Nhi\u1ec7m v\u1ee5 c\u1ee7a ch\u00fang t\u00f4i l\u00e0 t\u00ednh s\u1ed1 l\u01b0\u1ee3ng \u0111\u1ed1i t\u01b0\u1ee3ng, ho\u1eb7c t\u01b0\u01a1ng \u0111\u01b0\u01a1ng, s\u1ed1 l\u01b0\u1ee3ng c\u00e1c l\u1edbp t\u01b0\u01a1ng \u0111\u01b0\u01a1ng. V\u00ed d\u1ee5 sau \u0111\u00e2y s\u1ebd l\u00e0m cho s\u1ef1 kh\u00e1c bi\u1ec7t gi\u1eefa \u0111\u1ed1i t\u01b0\u1ee3ng v\u00e0 bi\u1ec3u di\u1ec5n r\u00f5 r\u00e0ng h\u01a1n.</p>","tags":["Translated"]},{"location":"combinatorics/burnside.html#example-coloring-of-binary-trees","title":"V\u00ed d\u1ee5: t\u00f4 m\u00e0u c\u00e2y nh\u1ecb ph\u00e2n (Example: coloring of binary trees)","text":"<p>Gi\u1ea3 s\u1eed ch\u00fang ta c\u00f3 b\u00e0i to\u00e1n sau. Ch\u00fang ta ph\u1ea3i \u0111\u1ebfm s\u1ed1 c\u00e1ch t\u00f4 m\u00e0u m\u1ed9t c\u00e2y nh\u1ecb ph\u00e2n c\u00f3 g\u1ed1c v\u1edbi $n$ \u0111\u1ec9nh b\u1eb1ng hai m\u00e0u, trong \u0111\u00f3 t\u1ea1i m\u1ed7i \u0111\u1ec9nh ch\u00fang ta kh\u00f4ng ph\u00e2n bi\u1ec7t gi\u1eefa con tr\u00e1i v\u00e0 con ph\u1ea3i.</p> <p>\u1ede \u0111\u00e2y t\u1eadp h\u1ee3p c\u00e1c \u0111\u1ed1i t\u01b0\u1ee3ng l\u00e0 t\u1eadp h\u1ee3p c\u00e1c c\u00e1ch t\u00f4 m\u00e0u kh\u00e1c nhau c\u1ee7a c\u00e2y.</p> <p>B\u00e2y gi\u1edd ch\u00fang ta x\u00e1c \u0111\u1ecbnh t\u1eadp h\u1ee3p c\u00e1c bi\u1ec3u di\u1ec5n. M\u1ed9t bi\u1ec3u di\u1ec5n c\u1ee7a m\u1ed9t c\u00e1ch t\u00f4 m\u00e0u l\u00e0 m\u1ed9t h\u00e0m $f(v)$, g\u00e1n cho m\u1ed7i \u0111\u1ec9nh m\u1ed9t m\u00e0u (\u1edf \u0111\u00e2y ch\u00fang ta s\u1eed d\u1ee5ng c\u00e1c m\u00e0u $0$ v\u00e0 $1$). T\u1eadp h\u1ee3p c\u00e1c bi\u1ec3u di\u1ec5n l\u00e0 t\u1eadp h\u1ee3p ch\u1ee9a t\u1ea5t c\u1ea3 c\u00e1c h\u00e0m c\u00f3 th\u1ec3 thu\u1ed9c lo\u1ea1i n\u00e0y, v\u00e0 k\u00edch th\u01b0\u1edbc c\u1ee7a n\u00f3 r\u00f5 r\u00e0ng b\u1eb1ng $2^n$.</p> <p>\u0110\u1ed3ng th\u1eddi ch\u00fang ta gi\u1edbi thi\u1ec7u m\u1ed9t ph\u00e2n ho\u1ea1ch c\u1ee7a t\u1eadp h\u1ee3p n\u00e0y th\u00e0nh c\u00e1c l\u1edbp t\u01b0\u01a1ng \u0111\u01b0\u01a1ng.</p> <p>V\u00ed d\u1ee5, gi\u1ea3 s\u1eed $n = 3$, v\u00e0 c\u00e2y bao g\u1ed3m g\u1ed1c $1$ v\u00e0 hai con c\u1ee7a n\u00f3 $2$ v\u00e0 $3$. Khi \u0111\u00f3 c\u00e1c h\u00e0m $f_1$ v\u00e0 $f_2$ sau \u0111\u00e2y \u0111\u01b0\u1ee3c coi l\u00e0 t\u01b0\u01a1ng \u0111\u01b0\u01a1ng.</p> $$\\begin{array}{ll} f_1(1) = 0 &amp; f_2(1) = 0\\\\ f_1(2) = 1 &amp; f_2(2) = 0\\\\ f_1(3) = 0 &amp; f_2(3) = 1 \\end{array}$$","tags":["Translated"]},{"location":"combinatorics/burnside.html#invariant-permutations","title":"Ho\u00e1n v\u1ecb b\u1ea5t bi\u1ebfn (Invariant permutations)","text":"<p>T\u1ea1i sao hai h\u00e0m $f_1$ v\u00e0 $f_2$ n\u00e0y thu\u1ed9c c\u00f9ng m\u1ed9t l\u1edbp t\u01b0\u01a1ng \u0111\u01b0\u01a1ng? V\u1ec1 m\u1eb7t tr\u1ef1c gi\u00e1c, \u0111i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 hi\u1ec3u \u0111\u01b0\u1ee3c - ch\u00fang ta c\u00f3 th\u1ec3 s\u1eafp x\u1ebfp l\u1ea1i c\u00e1c con c\u1ee7a \u0111\u1ec9nh $1$, c\u00e1c \u0111\u1ec9nh $2$ v\u00e0 $3$, v\u00e0 sau m\u1ed9t ph\u00e9p bi\u1ebfn \u0111\u1ed5i nh\u01b0 v\u1eady c\u1ee7a h\u00e0m $f_1$ n\u00f3 s\u1ebd tr\u00f9ng v\u1edbi $f_2$.</p> <p>Nh\u01b0ng v\u1ec1 m\u1eb7t h\u00ecnh th\u1ee9c, \u0111i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 t\u1ed3n t\u1ea1i m\u1ed9t ho\u00e1n v\u1ecb b\u1ea5t bi\u1ebfn $\\pi$ (t\u1ee9c l\u00e0 m\u1ed9t ho\u00e1n v\u1ecb kh\u00f4ng thay \u0111\u1ed5i ch\u00ednh \u0111\u1ed1i t\u01b0\u1ee3ng, m\u00e0 ch\u1ec9 thay \u0111\u1ed5i bi\u1ec3u di\u1ec5n c\u1ee7a n\u00f3), sao cho:</p> $$f_2 \\pi \\equiv f_1$$ <p>V\u00ec v\u1eady, b\u1eaft \u0111\u1ea7u t\u1eeb \u0111\u1ecbnh ngh\u0129a c\u1ee7a c\u00e1c \u0111\u1ed1i t\u01b0\u1ee3ng, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm th\u1ea5y t\u1ea5t c\u1ea3 c\u00e1c ho\u00e1n v\u1ecb b\u1ea5t bi\u1ebfn, t\u1ee9c l\u00e0 t\u1ea5t c\u1ea3 c\u00e1c ho\u00e1n v\u1ecb kh\u00f4ng thay \u0111\u1ed5i \u0111\u1ed1i t\u01b0\u1ee3ng khi \u00e1p d\u1ee5ng ho\u00e1n v\u1ecb cho bi\u1ec3u di\u1ec5n. Sau \u0111\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 ki\u1ec3m tra xem hai h\u00e0m $f_1$ v\u00e0 $f_2$ c\u00f3 t\u01b0\u01a1ng \u0111\u01b0\u01a1ng hay kh\u00f4ng (t\u1ee9c l\u00e0 n\u1ebfu ch\u00fang t\u01b0\u01a1ng \u1ee9ng v\u1edbi c\u00f9ng m\u1ed9t \u0111\u1ed1i t\u01b0\u1ee3ng) b\u1eb1ng c\u00e1ch ki\u1ec3m tra \u0111i\u1ec1u ki\u1ec7n $f_2 \\pi \\equiv f_1$ cho m\u1ed7i ho\u00e1n v\u1ecb b\u1ea5t bi\u1ebfn (ho\u1eb7c t\u01b0\u01a1ng \u0111\u01b0\u01a1ng $f_1 \\pi \\equiv f_2$). N\u1ebfu t\u00ecm th\u1ea5y \u00edt nh\u1ea5t m\u1ed9t ho\u00e1n v\u1ecb m\u00e0 \u0111i\u1ec1u ki\u1ec7n \u0111\u01b0\u1ee3c th\u1ecfa m\u00e3n, th\u00ec $f_1$ v\u00e0 $f_2$ l\u00e0 t\u01b0\u01a1ng \u0111\u01b0\u01a1ng, n\u1ebfu kh\u00f4ng ch\u00fang kh\u00f4ng t\u01b0\u01a1ng \u0111\u01b0\u01a1ng.</p> <p>T\u00ecm t\u1ea5t c\u1ea3 c\u00e1c ho\u00e1n v\u1ecb b\u1ea5t bi\u1ebfn nh\u01b0 v\u1eady li\u00ean quan \u0111\u1ebfn \u0111\u1ecbnh ngh\u0129a \u0111\u1ed1i t\u01b0\u1ee3ng l\u00e0 m\u1ed9t b\u01b0\u1edbc quan tr\u1ecdng cho vi\u1ec7c \u00e1p d\u1ee5ng c\u1ea3 b\u1ed5 \u0111\u1ec1 Burnside v\u00e0 \u0111\u1ecbnh l\u00fd \u0111\u1ebfm P\u00f3lya. R\u00f5 r\u00e0ng l\u00e0 c\u00e1c ho\u00e1n v\u1ecb b\u1ea5t bi\u1ebfn n\u00e0y ph\u1ee5 thu\u1ed9c v\u00e0o b\u00e0i to\u00e1n c\u1ee5 th\u1ec3, v\u00e0 vi\u1ec7c t\u00ecm ki\u1ebfm ch\u00fang l\u00e0 m\u1ed9t qu\u00e1 tr\u00ecnh heuristic thu\u1ea7n t\u00fay d\u1ef1a tr\u00ean c\u00e1c c\u00e2n nh\u1eafc tr\u1ef1c quan. Tuy nhi\u00ean trong h\u1ea7u h\u1ebft c\u00e1c tr\u01b0\u1eddng h\u1ee3p, l\u00e0 \u0111\u1ee7 \u0111\u1ec3 t\u00ecm th\u1ee7 c\u00f4ng m\u1ed9t v\u00e0i ho\u00e1n v\u1ecb \"c\u01a1 b\u1ea3n\", v\u1edbi ch\u00fang t\u1ea5t c\u1ea3 c\u00e1c ho\u00e1n v\u1ecb kh\u00e1c c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u1ea1o ra (v\u00e0 ph\u1ea7n c\u00f4ng vi\u1ec7c n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c chuy\u1ec3n sang m\u00e1y t\u00ednh).</p> <p>Kh\u00f4ng kh\u00f3 \u0111\u1ec3 hi\u1ec3u r\u1eb1ng c\u00e1c ho\u00e1n v\u1ecb b\u1ea5t bi\u1ebfn t\u1ea1o th\u00e0nh m\u1ed9t nh\u00f3m, v\u00ec t\u00edch (h\u1ee3p th\u00e0nh) c\u1ee7a c\u00e1c ho\u00e1n v\u1ecb b\u1ea5t bi\u1ebfn l\u1ea1i l\u00e0 m\u1ed9t ho\u00e1n v\u1ecb b\u1ea5t bi\u1ebfn. Ch\u00fang t\u00f4i k\u00fd hi\u1ec7u nh\u00f3m c\u00e1c ho\u00e1n v\u1ecb b\u1ea5t bi\u1ebfn l\u00e0 $G$.</p>","tags":["Translated"]},{"location":"combinatorics/burnside.html#the-statement-of-the-lemma","title":"Ph\u00e1t bi\u1ec3u b\u1ed5 \u0111\u1ec1 (The statement of the lemma)","text":"<p>\u0110\u1ed1i v\u1edbi vi\u1ec7c x\u00e2y d\u1ef1ng b\u1ed5 \u0111\u1ec1, ch\u00fang ta c\u1ea7n th\u00eam m\u1ed9t \u0111\u1ecbnh ngh\u0129a n\u1eefa t\u1eeb \u0111\u1ea1i s\u1ed1. M\u1ed9t \u0111i\u1ec3m b\u1ea5t \u0111\u1ed9ng $f$ cho m\u1ed9t ho\u00e1n v\u1ecb $\\pi$ l\u00e0 m\u1ed9t ph\u1ea7n t\u1eed b\u1ea5t bi\u1ebfn d\u01b0\u1edbi ho\u00e1n v\u1ecb n\u00e0y: $f \\equiv f \\pi$. V\u00ed d\u1ee5 trong v\u00ed d\u1ee5 c\u1ee7a ch\u00fang ta, c\u00e1c \u0111i\u1ec3m b\u1ea5t \u0111\u1ed9ng l\u00e0 c\u00e1c h\u00e0m $f$, t\u01b0\u01a1ng \u1ee9ng v\u1edbi c\u00e1c c\u00e1ch t\u00f4 m\u00e0u kh\u00f4ng thay \u0111\u1ed5i khi ho\u00e1n v\u1ecb $\\pi$ \u0111\u01b0\u1ee3c \u00e1p d\u1ee5ng cho ch\u00fang (t\u1ee9c l\u00e0 ch\u00fang kh\u00f4ng thay \u0111\u1ed5i theo ngh\u0129a ch\u00ednh th\u1ee9c c\u1ee7a s\u1ef1 b\u1eb1ng nhau c\u1ee7a c\u00e1c h\u00e0m). Ch\u00fang t\u00f4i k\u00fd hi\u1ec7u $I(\\pi)$ l\u00e0 s\u1ed1 l\u01b0\u1ee3ng \u0111i\u1ec3m b\u1ea5t \u0111\u1ed9ng cho ho\u00e1n v\u1ecb $\\pi$.</p> <p>Khi \u0111\u00f3 b\u1ed5 \u0111\u1ec1 Burnside di\u1ec5n ra nh\u01b0 sau: s\u1ed1 l\u01b0\u1ee3ng c\u00e1c l\u1edbp t\u01b0\u01a1ng \u0111\u01b0\u01a1ng b\u1eb1ng t\u1ed5ng s\u1ed1 l\u01b0\u1ee3ng \u0111i\u1ec3m b\u1ea5t \u0111\u1ed9ng \u0111\u1ed1i v\u1edbi t\u1ea5t c\u1ea3 c\u00e1c ho\u00e1n v\u1ecb t\u1eeb nh\u00f3m $G$, chia cho k\u00edch th\u01b0\u1edbc c\u1ee7a nh\u00f3m n\u00e0y:</p> $$|\\text{Classes}| = \\frac{1}{|G|} \\sum_{\\pi \\in G} I(\\pi)$$ <p>M\u1eb7c d\u00f9 b\u1ea3n th\u00e2n b\u1ed5 \u0111\u1ec1 Burnside kh\u00f4ng thu\u1eadn ti\u1ec7n l\u1eafm \u0111\u1ec3 s\u1eed d\u1ee5ng trong th\u1ef1c t\u1ebf (kh\u00f4ng r\u00f5 l\u00e0m th\u1ebf n\u00e0o \u0111\u1ec3 nhanh ch\u00f3ng t\u00ecm ki\u1ebfm gi\u00e1 tr\u1ecb $I(\\pi)$, n\u00f3 ti\u1ebft l\u1ed9 r\u00f5 r\u00e0ng nh\u1ea5t b\u1ea3n ch\u1ea5t to\u00e1n h\u1ecdc d\u1ef1a tr\u00ean \u00fd t\u01b0\u1edfng t\u00ednh to\u00e1n c\u00e1c l\u1edbp t\u01b0\u01a1ng \u0111\u01b0\u01a1ng).</p>","tags":["Translated"]},{"location":"combinatorics/burnside.html#proof-of-burnsides-lemma","title":"Ch\u1ee9ng minh b\u1ed5 \u0111\u1ec1 Burnside (Proof of Burnside's lemma)","text":"<p>Ch\u1ee9ng minh b\u1ed5 \u0111\u1ec1 Burnside m\u00f4 t\u1ea3 \u1edf \u0111\u00e2y kh\u00f4ng quan tr\u1ecdng \u0111\u1ed1i v\u1edbi c\u00e1c \u1ee9ng d\u1ee5ng th\u1ef1c t\u1ebf, v\u00ec v\u1eady n\u00f3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c b\u1ecf qua trong l\u1ea7n \u0111\u1ecdc \u0111\u1ea7u ti\u00ean.</p> <p>Ch\u1ee9ng minh \u1edf \u0111\u00e2y l\u00e0 \u0111\u01a1n gi\u1ea3n nh\u1ea5t \u0111\u01b0\u1ee3c bi\u1ebft \u0111\u1ebfn, v\u00e0 kh\u00f4ng s\u1eed d\u1ee5ng l\u00fd thuy\u1ebft nh\u00f3m. Ch\u1ee9ng minh \u0111\u01b0\u1ee3c xu\u1ea5t b\u1ea3n b\u1edfi Kenneth P. Bogart v\u00e0o n\u0103m 1991.</p> <p>Ch\u00fang ta c\u1ea7n ch\u1ee9ng minh tuy\u00ean b\u1ed1 sau:</p> $$|\\text{Classes}| \\cdot |G| = \\sum_{\\pi \\in G} I(\\pi)$$ <p>Gi\u00e1 tr\u1ecb \u1edf ph\u00eda b\u00ean ph\u1ea3i kh\u00f4ng g\u00ec kh\u00e1c h\u01a1n l\u00e0 s\u1ed1 l\u01b0\u1ee3ng \"c\u1eb7p b\u1ea5t bi\u1ebfn\" $(f, \\pi)$, t\u1ee9c l\u00e0 c\u00e1c c\u1eb7p sao cho $f \\pi \\equiv f$. R\u00f5 r\u00e0ng l\u00e0 ch\u00fang ta c\u00f3 th\u1ec3 thay \u0111\u1ed5i th\u1ee9 t\u1ef1 t\u00ednh t\u1ed5ng. Ch\u00fang ta \u0111\u1ec3 t\u1ed5ng l\u1eb7p qua t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed $f$ v\u00e0 t\u00ednh t\u1ed5ng qua c\u00e1c gi\u00e1 tr\u1ecb $J(f)$ - s\u1ed1 l\u01b0\u1ee3ng ho\u00e1n v\u1ecb m\u00e0 $f$ l\u00e0 m\u1ed9t \u0111i\u1ec3m b\u1ea5t \u0111\u1ed9ng.</p> $$|\\text{Classes}| \\cdot |G| = \\sum_{f} J(f)$$ <p>\u0110\u1ec3 ch\u1ee9ng minh c\u00f4ng th\u1ee9c n\u00e0y, ch\u00fang ta s\u1ebd so\u1ea1n m\u1ed9t b\u1ea3ng v\u1edbi c\u00e1c c\u1ed9t \u0111\u01b0\u1ee3c g\u1eafn nh\u00e3n v\u1edbi t\u1ea5t c\u1ea3 c\u00e1c h\u00e0m $f_i$ v\u00e0 c\u00e1c h\u00e0ng \u0111\u01b0\u1ee3c g\u1eafn nh\u00e3n v\u1edbi t\u1ea5t c\u1ea3 c\u00e1c ho\u00e1n v\u1ecb $\\pi_j$. V\u00e0 ch\u00fang ta \u0111i\u1ec1n v\u00e0o c\u00e1c \u00f4 v\u1edbi $f_i \\pi_j$. N\u1ebfu ch\u00fang ta nh\u00ecn v\u00e0o c\u00e1c c\u1ed9t trong b\u1ea3ng n\u00e0y nh\u01b0 c\u00e1c t\u1eadp h\u1ee3p, th\u00ec m\u1ed9t s\u1ed1 trong s\u1ed1 ch\u00fang s\u1ebd tr\u00f9ng nhau, v\u00e0 \u0111i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 c\u00e1c h\u00e0m $f$ t\u01b0\u01a1ng \u1ee9ng cho c\u00e1c c\u1ed9t n\u00e0y c\u0169ng t\u01b0\u01a1ng \u0111\u01b0\u01a1ng. Do \u0111\u00f3 s\u1ed1 l\u01b0\u1ee3ng c\u00e1c c\u1ed9t kh\u00e1c nhau (nh\u01b0 t\u1eadp h\u1ee3p) b\u1eb1ng s\u1ed1 l\u01b0\u1ee3ng c\u00e1c l\u1edbp. T\u00ecnh c\u1edd, t\u1eeb quan \u0111i\u1ec3m c\u1ee7a l\u00fd thuy\u1ebft nh\u00f3m, c\u1ed9t \u0111\u01b0\u1ee3c g\u1eafn nh\u00e3n v\u1edbi $f_i$ l\u00e0 qu\u1ef9 \u0111\u1ea1o c\u1ee7a ph\u1ea7n t\u1eed n\u00e0y. \u0110\u1ed1i v\u1edbi c\u00e1c ph\u1ea7n t\u1eed t\u01b0\u01a1ng \u0111\u01b0\u01a1ng, c\u00e1c qu\u1ef9 \u0111\u1ea1o tr\u00f9ng nhau, v\u00e0 s\u1ed1 l\u01b0\u1ee3ng qu\u1ef9 \u0111\u1ea1o cho ch\u00ednh x\u00e1c s\u1ed1 l\u01b0\u1ee3ng c\u00e1c l\u1edbp.</p> <p>Do \u0111\u00f3 c\u00e1c c\u1ed9t c\u1ee7a b\u1ea3ng ph\u00e2n r\u00e3 th\u00e0nh c\u00e1c l\u1edbp t\u01b0\u01a1ng \u0111\u01b0\u01a1ng. H\u00e3y c\u1ed1 \u0111\u1ecbnh m\u1ed9t l\u1edbp, v\u00e0 nh\u00ecn v\u00e0o c\u00e1c c\u1ed9t trong \u0111\u00f3. Th\u1ee9 nh\u1ea5t, l\u01b0u \u00fd r\u1eb1ng c\u00e1c c\u1ed9t n\u00e0y ch\u1ec9 c\u00f3 th\u1ec3 ch\u1ee9a c\u00e1c ph\u1ea7n t\u1eed $f_i$ c\u1ee7a l\u1edbp t\u01b0\u01a1ng \u0111\u01b0\u01a1ng (n\u1ebfu kh\u00f4ng, m\u1ed9t ho\u00e1n v\u1ecb $\\pi_j$ n\u00e0o \u0111\u00f3 \u0111\u00e3 chuy\u1ec3n m\u1ed9t trong c\u00e1c h\u00e0m sang m\u1ed9t l\u1edbp t\u01b0\u01a1ng \u0111\u01b0\u01a1ng kh\u00e1c, \u0111i\u1ec1u n\u00e0y l\u00e0 kh\u00f4ng th\u1ec3 v\u00ec ch\u00fang ta ch\u1ec9 xem x\u00e9t c\u00e1c ho\u00e1n v\u1ecb b\u1ea5t bi\u1ebfn). Th\u1ee9 hai, m\u1ed7i ph\u1ea7n t\u1eed $f_i$ s\u1ebd xu\u1ea5t hi\u1ec7n c\u00f9ng m\u1ed9t s\u1ed1 l\u1ea7n trong m\u1ed7i c\u1ed9t (\u0111i\u1ec1u n\u00e0y c\u0169ng theo sau t\u1eeb th\u1ef1c t\u1ebf l\u00e0 c\u00e1c c\u1ed9t t\u01b0\u01a1ng \u1ee9ng v\u1edbi c\u00e1c ph\u1ea7n t\u1eed t\u01b0\u01a1ng \u0111\u01b0\u01a1ng). T\u1eeb \u0111\u00f3 ch\u00fang ta c\u00f3 th\u1ec3 k\u1ebft lu\u1eadn r\u1eb1ng, t\u1ea5t c\u1ea3 c\u00e1c c\u1ed9t trong c\u00f9ng m\u1ed9t l\u1edbp t\u01b0\u01a1ng \u0111\u01b0\u01a1ng tr\u00f9ng nhau nh\u01b0 \u0111a t\u1eadp h\u1ee3p (multisets).</p> <p>B\u00e2y gi\u1edd s\u1eeda m\u1ed9t ph\u1ea7n t\u1eed t\u00f9y \u00fd $f$. M\u1ed9t m\u1eb7t, n\u00f3 xu\u1ea5t hi\u1ec7n trong c\u1ed9t c\u1ee7a n\u00f3 ch\u00ednh x\u00e1c $J(f)$ l\u1ea7n (theo \u0111\u1ecbnh ngh\u0129a). M\u1eb7t kh\u00e1c, t\u1ea5t c\u1ea3 c\u00e1c c\u1ed9t trong c\u00f9ng m\u1ed9t l\u1edbp t\u01b0\u01a1ng \u0111\u01b0\u01a1ng gi\u1ed1ng nhau nh\u01b0 \u0111a t\u1eadp h\u1ee3p. Do \u0111\u00f3 trong m\u1ed7i c\u1ed9t c\u1ee7a m\u1ed9t l\u1edbp t\u01b0\u01a1ng \u0111\u01b0\u01a1ng nh\u1ea5t \u0111\u1ecbnh, b\u1ea5t k\u1ef3 ph\u1ea7n t\u1eed $g$ n\u00e0o c\u0169ng xu\u1ea5t hi\u1ec7n ch\u00ednh x\u00e1c $J(g)$ l\u1ea7n.</p> <p>Do \u0111\u00f3, n\u1ebfu ch\u00fang ta l\u1ea5y t\u00f9y \u00fd m\u1ed9t c\u1ed9t t\u1eeb m\u1ed7i l\u1edbp t\u01b0\u01a1ng \u0111\u01b0\u01a1ng, v\u00e0 t\u1ed5ng h\u1ee3p s\u1ed1 l\u01b0\u1ee3ng ph\u1ea7n t\u1eed trong ch\u00fang, ch\u00fang ta thu \u0111\u01b0\u1ee3c m\u1ed9t m\u1eb7t $|\\text{Classes}| \\cdot |G|$ (\u0111\u01a1n gi\u1ea3n b\u1eb1ng c\u00e1ch nh\u00e2n s\u1ed1 l\u01b0\u1ee3ng c\u1ed9t v\u1edbi s\u1ed1 l\u01b0\u1ee3ng h\u00e0ng), v\u00e0 m\u1eb7t kh\u00e1c t\u1ed5ng c\u1ee7a c\u00e1c \u0111\u1ea1i l\u01b0\u1ee3ng $J(f)$ cho t\u1ea5t c\u1ea3 $f$ (\u0111i\u1ec1u n\u00e0y theo sau t\u1eeb t\u1ea5t c\u1ea3 c\u00e1c l\u1eadp lu\u1eadn tr\u01b0\u1edbc \u0111\u00f3):</p> $$|\\text{Classes}| \\cdot |G| = \\sum_{f} J(f)$$","tags":["Translated"]},{"location":"combinatorics/burnside.html#polya-enumeration-theorem","title":"\u0110\u1ecbnh l\u00fd \u0111\u1ebfm P\u00f3lya (P\u00f3lya enumeration theorem)","text":"<p>\u0110\u1ecbnh l\u00fd \u0111\u1ebfm P\u00f3lya l\u00e0 m\u1ed9t s\u1ef1 t\u1ed5ng qu\u00e1t h\u00f3a c\u1ee7a b\u1ed5 \u0111\u1ec1 Burnside, v\u00e0 n\u00f3 c\u0169ng cung c\u1ea5p m\u1ed9t c\u00f4ng c\u1ee5 thu\u1eadn ti\u1ec7n h\u01a1n \u0111\u1ec3 t\u00ecm s\u1ed1 l\u01b0\u1ee3ng c\u00e1c l\u1edbp t\u01b0\u01a1ng \u0111\u01b0\u01a1ng. C\u1ea7n l\u01b0u \u00fd r\u1eb1ng \u0111\u1ecbnh l\u00fd n\u00e0y \u0111\u00e3 \u0111\u01b0\u1ee3c ph\u00e1t hi\u1ec7n tr\u01b0\u1edbc P\u00f3lya b\u1edfi Redfield v\u00e0o n\u0103m 1927, nh\u01b0ng \u1ea5n ph\u1ea9m c\u1ee7a \u00f4ng kh\u00f4ng \u0111\u01b0\u1ee3c c\u00e1c nh\u00e0 to\u00e1n h\u1ecdc ch\u00fa \u00fd. P\u00f3lya \u0111\u1ed9c l\u1eadp \u0111i \u0111\u1ebfn c\u00f9ng k\u1ebft qu\u1ea3 v\u00e0o n\u0103m 1937, v\u00e0 \u1ea5n ph\u1ea9m c\u1ee7a \u00f4ng th\u00e0nh c\u00f4ng h\u01a1n.</p> <p>\u1ede \u0111\u00e2y ch\u00fang t\u00f4i ch\u1ec9 th\u1ea3o lu\u1eadn v\u1ec1 m\u1ed9t tr\u01b0\u1eddng h\u1ee3p \u0111\u1eb7c bi\u1ec7t c\u1ee7a \u0111\u1ecbnh l\u00fd \u0111\u1ebfm P\u00f3lya, s\u1ebd tr\u1edf n\u00ean r\u1ea5t h\u1eefu \u00edch trong th\u1ef1c t\u1ebf. C\u00f4ng th\u1ee9c chung c\u1ee7a \u0111\u1ecbnh l\u00fd s\u1ebd kh\u00f4ng \u0111\u01b0\u1ee3c th\u1ea3o lu\u1eadn.</p> <p>Ch\u00fang t\u00f4i k\u00fd hi\u1ec7u $C(\\pi)$ l\u00e0 s\u1ed1 l\u01b0\u1ee3ng chu tr\u00ecnh trong ho\u00e1n v\u1ecb $\\pi$. Khi \u0111\u00f3 c\u00f4ng th\u1ee9c sau (tr\u01b0\u1eddng h\u1ee3p \u0111\u1eb7c bi\u1ec7t c\u1ee7a \u0111\u1ecbnh l\u00fd \u0111\u1ebfm P\u00f3lya) gi\u1eef:</p> $$|\\text{Classes}| = \\frac{1}{|G|} \\sum_{\\pi \\in G} k^{C(\\pi)}$$ <p>$k$ l\u00e0 s\u1ed1 l\u01b0\u1ee3ng gi\u00e1 tr\u1ecb m\u00e0 m\u1ed7i ph\u1ea7n t\u1eed bi\u1ec3u di\u1ec5n c\u00f3 th\u1ec3 nh\u1eadn, trong tr\u01b0\u1eddng h\u1ee3p t\u00f4 m\u00e0u c\u00e2y nh\u1ecb ph\u00e2n, \u0111i\u1ec1u n\u00e0y s\u1ebd l\u00e0 $k = 2$.</p>","tags":["Translated"]},{"location":"combinatorics/burnside.html#evidence","title":"B\u1eb1ng ch\u1ee9ng (Evidence)","text":"<p>C\u00f4ng th\u1ee9c n\u00e0y l\u00e0 h\u1ec7 qu\u1ea3 tr\u1ef1c ti\u1ebfp c\u1ee7a b\u1ed5 \u0111\u1ec1 Burnside. \u0110\u1ec3 c\u00f3 \u0111\u01b0\u1ee3c n\u00f3, ch\u00fang ta ch\u1ec9 c\u1ea7n t\u00ecm m\u1ed9t bi\u1ec3u th\u1ee9c r\u00f5 r\u00e0ng cho $I(\\pi)$, xu\u1ea5t hi\u1ec7n trong b\u1ed5 \u0111\u1ec1. H\u00e3y nh\u1edb l\u1ea1i, r\u1eb1ng $I(\\pi)$ l\u00e0 s\u1ed1 l\u01b0\u1ee3ng \u0111i\u1ec3m b\u1ea5t \u0111\u1ed9ng trong ho\u00e1n v\u1ecb $\\pi$.</p> <p>Do \u0111\u00f3, ch\u00fang ta xem x\u00e9t m\u1ed9t ho\u00e1n v\u1ecb $\\pi$ v\u00e0 m\u1ed9t s\u1ed1 ph\u1ea7n t\u1eed $f$. Trong qu\u00e1 tr\u00ecnh \u00e1p d\u1ee5ng $\\pi$, c\u00e1c ph\u1ea7n t\u1eed trong $f$ di chuy\u1ec3n qua c\u00e1c chu tr\u00ecnh trong ho\u00e1n v\u1ecb. V\u00ec k\u1ebft qu\u1ea3 s\u1ebd thu \u0111\u01b0\u1ee3c $f \\equiv f \\pi$, c\u00e1c ph\u1ea7n t\u1eed \u0111\u01b0\u1ee3c ch\u1ea1m b\u1edfi m\u1ed9t chu tr\u00ecnh \u0111\u1ec1u ph\u1ea3i b\u1eb1ng nhau. \u0110\u1ed3ng th\u1eddi, c\u00e1c chu tr\u00ecnh kh\u00e1c nhau l\u00e0 \u0111\u1ed9c l\u1eadp. Do \u0111\u00f3, \u0111\u1ed1i v\u1edbi m\u1ed7i chu tr\u00ecnh ho\u00e1n v\u1ecb $\\pi$, ch\u00fang ta c\u00f3 th\u1ec3 ch\u1ecdn m\u1ed9t gi\u00e1 tr\u1ecb (trong s\u1ed1 $k$ gi\u00e1 tr\u1ecb c\u00f3 th\u1ec3) v\u00e0 do \u0111\u00f3 ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c s\u1ed1 l\u01b0\u1ee3ng \u0111i\u1ec3m b\u1ea5t \u0111\u1ed9ng:</p> $$I(\\pi) = k^{C(\\pi)}$$","tags":["Translated"]},{"location":"combinatorics/burnside.html#application-coloring-necklaces","title":"\u1ee8ng d\u1ee5ng: T\u00f4 m\u00e0u v\u00f2ng c\u1ed5 (Application: Coloring necklaces)","text":"<p>B\u00e0i to\u00e1n \"V\u00f2ng c\u1ed5\" l\u00e0 m\u1ed9t trong nh\u1eefng b\u00e0i to\u00e1n t\u1ed5 h\u1ee3p c\u1ed5 \u0111i\u1ec3n. Nhi\u1ec7m v\u1ee5 l\u00e0 \u0111\u1ebfm s\u1ed1 l\u01b0\u1ee3ng v\u00f2ng c\u1ed5 kh\u00e1c nhau t\u1eeb $n$ h\u1ea1t, m\u1ed7i h\u1ea1t c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u01a1n b\u1eb1ng m\u1ed9t trong $k$ m\u00e0u. Khi so s\u00e1nh hai v\u00f2ng c\u1ed5, ch\u00fang c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c xoay, nh\u01b0ng kh\u00f4ng \u0111\u01b0\u1ee3c \u0111\u1ea3o ng\u01b0\u1ee3c (t\u1ee9c l\u00e0 cho ph\u00e9p d\u1ecbch chuy\u1ec3n v\u00f2ng tr\u00f2n).</p> <p>Trong b\u00e0i to\u00e1n n\u00e0y, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm ngay nh\u00f3m c\u00e1c ho\u00e1n v\u1ecb b\u1ea5t bi\u1ebfn:</p> $$\\begin{align} \\pi_0 &amp;= 1 2 3 \\dots n\\\\ \\pi_1 &amp;= 2 3 \\dots n 1\\\\ \\pi_2 &amp;= 3 \\dots n 12\\\\ &amp;\\dots\\\\ \\pi_{n-1} &amp;= n 1 2 3\\dots\\end{align}$$ <p>H\u00e3y t\u00ecm m\u1ed9t c\u00f4ng th\u1ee9c r\u00f5 r\u00e0ng \u0111\u1ec3 t\u00ednh to\u00e1n $C(\\pi_i)$. Tr\u01b0\u1edbc ti\u00ean ch\u00fang ta l\u01b0u \u00fd, r\u1eb1ng ho\u00e1n v\u1ecb $\\pi_i$ c\u00f3 gi\u00e1 tr\u1ecb $i + j$ t\u1ea1i v\u1ecb tr\u00ed th\u1ee9 $j$ (l\u1ea5y modulo $n$). N\u1ebfu ch\u00fang ta ki\u1ec3m tra c\u1ea5u tr\u00fac chu tr\u00ecnh cho $\\pi_i$. Ch\u00fang ta th\u1ea5y r\u1eb1ng $1$ \u0111i \u0111\u1ebfn $1 + i$, $1 + i$ \u0111i \u0111\u1ebfn $1 + 2i$, \u0111i \u0111\u1ebfn $1 + 3i$, v.v., cho \u0111\u1ebfn khi ch\u00fang ta \u0111\u1ebfn m\u1ed9t s\u1ed1 c\u00f3 d\u1ea1ng $1 + k n$. C\u00e1c tuy\u00ean b\u1ed1 t\u01b0\u01a1ng t\u1ef1 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n cho c\u00e1c ph\u1ea7n t\u1eed c\u00f2n l\u1ea1i. Do \u0111\u00f3, ch\u00fang ta th\u1ea5y r\u1eb1ng t\u1ea5t c\u1ea3 c\u00e1c chu tr\u00ecnh \u0111\u1ec1u c\u00f3 c\u00f9ng \u0111\u1ed9 d\u00e0i, c\u1ee5 th\u1ec3 l\u00e0 $\\frac{\\text{lcm}(i, n)}{i} = \\frac{n}{\\gcd(i, n)}$. Do \u0111\u00f3 s\u1ed1 l\u01b0\u1ee3ng chu tr\u00ecnh trong $\\pi_i$ s\u1ebd b\u1eb1ng $\\gcd(i, n)$.</p> <p>Thay c\u00e1c gi\u00e1 tr\u1ecb n\u00e0y v\u00e0o \u0111\u1ecbnh l\u00fd \u0111\u1ebfm P\u00f3lya, ch\u00fang t\u00f4i thu \u0111\u01b0\u1ee3c gi\u1ea3i ph\u00e1p:</p> $$\\frac{1}{n} \\sum_{i=1}^n k^{\\gcd(i, n)}$$ <p>B\u1ea1n c\u00f3 th\u1ec3 \u0111\u1ec3 c\u00f4ng th\u1ee9c n\u00e0y \u1edf d\u1ea1ng n\u00e0y, ho\u1eb7c b\u1ea1n c\u00f3 th\u1ec3 \u0111\u01a1n gi\u1ea3n h\u00f3a n\u00f3 h\u01a1n n\u1eefa. H\u00e3y chuy\u1ec3n t\u1ed5ng \u0111\u1ec3 n\u00f3 l\u1eb7p qua t\u1ea5t c\u1ea3 c\u00e1c \u01b0\u1edbc s\u1ed1 c\u1ee7a $n$. Trong t\u1ed5ng ban \u0111\u1ea7u s\u1ebd c\u00f3 nhi\u1ec1u s\u1ed1 h\u1ea1ng t\u01b0\u01a1ng \u0111\u01b0\u01a1ng: n\u1ebfu $i$ kh\u00f4ng ph\u1ea3i l\u00e0 \u01b0\u1edbc s\u1ed1 c\u1ee7a $n$, th\u00ec m\u1ed9t \u01b0\u1edbc s\u1ed1 nh\u01b0 v\u1eady c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y sau khi t\u00ednh $\\gcd(i, n)$. Do \u0111\u00f3 \u0111\u1ed1i v\u1edbi m\u1ed7i \u01b0\u1edbc s\u1ed1 $d ~|~ n$, s\u1ed1 h\u1ea1ng $k^{\\gcd(d, n)} = k^d$ c\u1ee7a n\u00f3 s\u1ebd xu\u1ea5t hi\u1ec7n trong t\u1ed5ng nhi\u1ec1u l\u1ea7n, t\u1ee9c l\u00e0 c\u00e2u tr\u1ea3 l\u1eddi cho b\u00e0i to\u00e1n c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c vi\u1ebft l\u1ea1i th\u00e0nh</p> $$\\frac{1}{n} \\sum_{d ~|~ n} C_d k^d,$$ <p>trong \u0111\u00f3 $C_d$ l\u00e0 s\u1ed1 l\u01b0\u1ee3ng c\u00e1c s\u1ed1 $i$ nh\u01b0 v\u1eady v\u1edbi $\\gcd(i, n) = d$. Ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm th\u1ea5y m\u1ed9t bi\u1ec3u th\u1ee9c r\u00f5 r\u00e0ng cho gi\u00e1 tr\u1ecb n\u00e0y. B\u1ea5t k\u1ef3 s\u1ed1 n\u00e0o $i$ nh\u01b0 v\u1eady \u0111\u1ec1u c\u00f3 d\u1ea1ng $i = d j$ v\u1edbi $\\gcd(j, n / d) = 1$ (n\u1ebfu kh\u00f4ng $\\gcd(i, n) &gt; d$). V\u00ec v\u1eady ch\u00fang ta c\u00f3 th\u1ec3 \u0111\u1ebfm s\u1ed1 l\u01b0\u1ee3ng $j$ v\u1edbi h\u00e0nh vi n\u00e0y. H\u00e0m phi Euler cho ch\u00fang ta k\u1ebft qu\u1ea3 $C_d = \\phi(n / d)$, v\u00e0 do \u0111\u00f3 ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c c\u00e2u tr\u1ea3 l\u1eddi:</p> $$\\frac{1}{n} \\sum_{d ~|~ n} \\phi\\left(\\frac{n}{d}\\right) k^d$$","tags":["Translated"]},{"location":"combinatorics/burnside.html#application-coloring-a-torus","title":"\u1ee8ng d\u1ee5ng: T\u00f4 m\u00e0u h\u00ecnh xuy\u1ebfn (Application: Coloring a torus)","text":"<p>Kh\u00e1 th\u01b0\u1eddng xuy\u00ean ch\u00fang ta kh\u00f4ng th\u1ec3 c\u00f3 \u0111\u01b0\u1ee3c m\u1ed9t c\u00f4ng th\u1ee9c r\u00f5 r\u00e0ng cho s\u1ed1 l\u01b0\u1ee3ng c\u00e1c l\u1edbp t\u01b0\u01a1ng \u0111\u01b0\u01a1ng. Trong nhi\u1ec1u b\u00e0i to\u00e1n, s\u1ed1 l\u01b0\u1ee3ng ho\u00e1n v\u1ecb trong m\u1ed9t nh\u00f3m c\u00f3 th\u1ec3 qu\u00e1 l\u1edbn \u0111\u1ec3 t\u00ednh to\u00e1n th\u1ee7 c\u00f4ng v\u00e0 kh\u00f4ng th\u1ec3 t\u00ednh to\u00e1n ph\u00e2n t\u00edch s\u1ed1 l\u01b0\u1ee3ng chu tr\u00ecnh trong \u0111\u00f3.</p> <p>Trong tr\u01b0\u1eddng h\u1ee3p \u0111\u00f3, ch\u00fang ta n\u00ean t\u00ecm th\u1ee7 c\u00f4ng m\u1ed9t v\u00e0i ho\u00e1n v\u1ecb \"c\u01a1 b\u1ea3n\", \u0111\u1ec3 ch\u00fang c\u00f3 th\u1ec3 t\u1ea1o ra to\u00e0n b\u1ed9 nh\u00f3m $G$. Ti\u1ebfp theo, ch\u00fang ta c\u00f3 th\u1ec3 vi\u1ebft m\u1ed9t ch\u01b0\u01a1ng tr\u00ecnh s\u1ebd t\u1ea1o ra t\u1ea5t c\u1ea3 c\u00e1c ho\u00e1n v\u1ecb c\u1ee7a nh\u00f3m $G$, \u0111\u1ebfm s\u1ed1 l\u01b0\u1ee3ng chu tr\u00ecnh trong \u0111\u00f3, v\u00e0 t\u00ednh to\u00e1n c\u00e2u tr\u1ea3 l\u1eddi b\u1eb1ng c\u00f4ng th\u1ee9c.</p> <p>Xem x\u00e9t v\u00ed d\u1ee5 v\u1ec1 b\u00e0i to\u00e1n t\u00f4 m\u00e0u h\u00ecnh xuy\u1ebfn. C\u00f3 m\u1ed9t t\u1edd gi\u1ea5y k\u1ebb \u00f4 vu\u00f4ng $n \\times m$ ($n &lt; m$), m\u1ed9t s\u1ed1 \u00f4 m\u00e0u \u0111en. Sau \u0111\u00f3, m\u1ed9t h\u00ecnh tr\u1ee5 thu \u0111\u01b0\u1ee3c t\u1eeb t\u1edd gi\u1ea5y n\u00e0y b\u1eb1ng c\u00e1ch d\u00e1n hai c\u1ea1nh c\u00f3 \u0111\u1ed9 d\u00e0i $m$ l\u1ea1i v\u1edbi nhau. Sau \u0111\u00f3, m\u1ed9t h\u00ecnh xuy\u1ebfn thu \u0111\u01b0\u1ee3c t\u1eeb h\u00ecnh tr\u1ee5 b\u1eb1ng c\u00e1ch d\u00e1n hai v\u00f2ng tr\u00f2n (tr\u00ean v\u00e0 d\u01b0\u1edbi) l\u1ea1i v\u1edbi nhau m\u00e0 kh\u00f4ng xo\u1eafn. Nhi\u1ec7m v\u1ee5 l\u00e0 t\u00ednh s\u1ed1 l\u01b0\u1ee3ng h\u00ecnh xuy\u1ebfn c\u00f3 m\u00e0u kh\u00e1c nhau, gi\u1ea3 s\u1eed r\u1eb1ng ch\u00fang ta kh\u00f4ng th\u1ec3 nh\u00ecn th\u1ea5y c\u00e1c \u0111\u01b0\u1eddng d\u00e1n, v\u00e0 h\u00ecnh xuy\u1ebfn c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c xoay v\u00e0 l\u1eadt.</p> <p>Ch\u00fang ta l\u1ea1i b\u1eaft \u0111\u1ea7u v\u1edbi m\u1ed9t m\u1ea3nh gi\u1ea5y $n \\times m$. D\u1ec5 th\u1ea5y r\u1eb1ng c\u00e1c lo\u1ea1i bi\u1ebfn \u0111\u1ed5i sau \u0111\u00e2y b\u1ea3o t\u1ed3n l\u1edbp t\u01b0\u01a1ng \u0111\u01b0\u01a1ng: d\u1ecbch chuy\u1ec3n v\u00f2ng c\u00e1c h\u00e0ng, d\u1ecbch chuy\u1ec3n v\u00f2ng c\u00e1c c\u1ed9t, v\u00e0 xoay t\u1edd gi\u1ea5y 180 \u0111\u1ed9. C\u0169ng d\u1ec5 th\u1ea5y r\u1eb1ng c\u00e1c bi\u1ebfn \u0111\u1ed5i n\u00e0y c\u00f3 th\u1ec3 t\u1ea1o ra to\u00e0n b\u1ed9 nh\u00f3m c\u00e1c bi\u1ebfn \u0111\u1ed5i b\u1ea5t bi\u1ebfn. N\u1ebfu ch\u00fang ta b\u1eb1ng c\u00e1ch n\u00e0o \u0111\u00f3 \u0111\u00e1nh s\u1ed1 c\u00e1c \u00f4 c\u1ee7a t\u1edd gi\u1ea5y, th\u00ec ch\u00fang ta c\u00f3 th\u1ec3 vi\u1ebft ba ho\u00e1n v\u1ecb $p_1$, $p_2$, $p_3$ t\u01b0\u01a1ng \u1ee9ng v\u1edbi c\u00e1c lo\u1ea1i bi\u1ebfn \u0111\u1ed5i n\u00e0y.</p> <p>Ti\u1ebfp theo ch\u1ec9 c\u00f2n l\u1ea1i \u0111\u1ec3 t\u1ea1o ra t\u1ea5t c\u1ea3 c\u00e1c ho\u00e1n v\u1ecb thu \u0111\u01b0\u1ee3c nh\u01b0 m\u1ed9t t\u00edch. R\u00f5 r\u00e0ng l\u00e0 t\u1ea5t c\u1ea3 c\u00e1c ho\u00e1n v\u1ecb nh\u01b0 v\u1eady c\u00f3 d\u1ea1ng $p_1^{i_1} p_2^{i_2} p_3^{i_3}$ trong \u0111\u00f3 $i_1 = 0 \\dots m-1$, $i_2 = 0 \\dots n-1$, $i_3 = 0 \\dots 1$.</p> <p>Do \u0111\u00f3 ch\u00fang ta c\u00f3 th\u1ec3 vi\u1ebft c\u00e1c c\u00e0i \u0111\u1eb7t cho b\u00e0i to\u00e1n n\u00e0y.</p> <pre><code>using Permutation = vector&lt;int&gt;;\n\nvoid operator*=(Permutation&amp; p, Permutation const&amp; q) {\n    Permutation copy = p;\n    for (int i = 0; i &lt; p.size(); i++)\n        p[i] = copy[q[i]];\n}\n\nint count_cycles(Permutation p) {\n    int cnt = 0;\n    for (int i = 0; i &lt; p.size(); i++) {\n        if (p[i] != -1) {\n            cnt++;\n            for (int j = i; p[j] != -1;) {\n                int next = p[j];\n                p[j] = -1;\n                j = next;\n            }\n        }\n    }\n    return cnt;\n}\n\nint solve(int n, int m) {\n    Permutation p(n*m), p1(n*m), p2(n*m), p3(n*m);\n    for (int i = 0; i &lt; n*m; i++) {\n        p[i] = i;\n        p1[i] = (i % n + 1) % n + i / n * n;\n        p2[i] = (i / n + 1) % m * n + i % n;\n        p3[i] = (m - 1 - i / n) * n + (n - 1 - i % n);\n    }\n\n    set&lt;Permutation&gt; s;\n    for (int i1 = 0; i1 &lt; n; i1++) {\n        for (int i2 = 0; i2 &lt; m; i2++) {\n            for (int i3 = 0; i3 &lt; 2; i3++) {\n                s.insert(p);\n                p *= p3;\n            }\n            p *= p2;\n        }\n        p *= p1;\n    }\n\n    int sum = 0;\n    for (Permutation const&amp; p : s) {\n        sum += 1 &lt;&lt; count_cycles(p);\n    }\n    return sum / s.size();\n}\n</code></pre>","tags":["Translated"]},{"location":"combinatorics/burnside.html#practice-problems","title":"B\u00e0i t\u1eadp luy\u1ec7n t\u1eadp","text":"<ul> <li>CSES - Counting Necklaces</li> <li>CSES - Counting Grids</li> <li>Codeforces - Buildings</li> <li>CS Academy - Cube Coloring</li> <li>Codeforces - Side Transmutations</li> <li>LightOJ - Necklace</li> <li>POJ - Necklace of Beads</li> <li>CodeChef - Lucy and Flowers</li> <li>HackerRank - Count the Necklaces</li> <li>POJ - Magic Bracelet</li> <li>SPOJ - Sorting Machine</li> <li>Project Euler - Pizza Toppings</li> <li>ICPC 2011 SERCP - Alphabet Soup</li> <li>GCPC 2017 - Buildings</li> </ul>","tags":["Translated"]},{"location":"combinatorics/burnside.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 284</li> <li>Translated lines: 284</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Translated"]},{"location":"combinatorics/catalan-numbers.html","title":"S\u1ed1 Catalan (Catalan Numbers)","text":"<p>S\u1ed1 Catalan l\u00e0 m\u1ed9t d\u00e3y s\u1ed1, \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y h\u1eefu \u00edch trong m\u1ed9t s\u1ed1 b\u00e0i to\u00e1n t\u1ed5 h\u1ee3p, th\u01b0\u1eddng li\u00ean quan \u0111\u1ebfn c\u00e1c \u0111\u1ed1i t\u01b0\u1ee3ng \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a \u0111\u1ec7 quy.</p> <p>D\u00e3y s\u1ed1 n\u00e0y \u0111\u01b0\u1ee3c \u0111\u1eb7t theo t\u00ean c\u1ee7a nh\u00e0 to\u00e1n h\u1ecdc ng\u01b0\u1eddi B\u1ec9 Catalan, ng\u01b0\u1eddi s\u1ed1ng \u1edf th\u1ebf k\u1ef7 19. (Tr\u00ean th\u1ef1c t\u1ebf, n\u00f3 \u0111\u00e3 \u0111\u01b0\u1ee3c bi\u1ebft \u0111\u1ebfn tr\u01b0\u1edbc \u0111\u00f3 v\u1edbi Euler, ng\u01b0\u1eddi s\u1ed1ng tr\u01b0\u1edbc Catalan m\u1ed9t th\u1ebf k\u1ef7).</p> <p>M\u1ed9t s\u1ed1 s\u1ed1 Catalan \u0111\u1ea7u ti\u00ean $C_n$ (b\u1eaft \u0111\u1ea7u t\u1eeb s\u1ed1 kh\u00f4ng):</p> <p>$1, 1, 2, 5, 14, 42, 132, 429, 1430, \\ldots$</p>","tags":["Translated"]},{"location":"combinatorics/catalan-numbers.html#application-in-some-combinatorial-problems","title":"\u1ee8ng d\u1ee5ng trong m\u1ed9t s\u1ed1 b\u00e0i to\u00e1n t\u1ed5 h\u1ee3p (Application in some combinatorial problems)","text":"<p>S\u1ed1 Catalan $C_n$ l\u00e0 l\u1eddi gi\u1ea3i cho</p> <ul> <li>S\u1ed1 l\u01b0\u1ee3ng d\u00e3y ngo\u1eb7c \u0111\u00fang bao g\u1ed3m $n$ d\u1ea5u ngo\u1eb7c m\u1edf v\u00e0 $n$ d\u1ea5u ngo\u1eb7c \u0111\u00f3ng.</li> <li>S\u1ed1 l\u01b0\u1ee3ng c\u00e2y nh\u1ecb ph\u00e2n \u0111\u1ea7y \u0111\u1ee7 c\u00f3 g\u1ed1c v\u1edbi $n + 1$ l\u00e1 (c\u00e1c \u0111\u1ec9nh kh\u00f4ng \u0111\u01b0\u1ee3c \u0111\u00e1nh s\u1ed1). M\u1ed9t c\u00e2y nh\u1ecb ph\u00e2n c\u00f3 g\u1ed1c l\u00e0 \u0111\u1ea7y \u0111\u1ee7 n\u1ebfu m\u1ecdi \u0111\u1ec9nh c\u00f3 hai con ho\u1eb7c kh\u00f4ng c\u00f3 con n\u00e0o.</li> <li>S\u1ed1 c\u00e1ch \u0111\u1ec3 \u0111\u1eb7t d\u1ea5u ngo\u1eb7c ho\u00e0n to\u00e0n cho $n + 1$ th\u1eeba s\u1ed1.</li> <li>S\u1ed1 l\u01b0\u1ee3ng ph\u00e2n t\u00edch c\u1ee7a m\u1ed9t \u0111a gi\u00e1c l\u1ed3i c\u00f3 $n + 2$ c\u1ea1nh th\u00e0nh c\u00e1c tam gi\u00e1c (t\u1ee9c l\u00e0 s\u1ed1 l\u01b0\u1ee3ng ph\u00e2n v\u00f9ng c\u1ee7a \u0111a gi\u00e1c th\u00e0nh c\u00e1c tam gi\u00e1c r\u1eddi r\u1ea1c b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng c\u00e1c \u0111\u01b0\u1eddng ch\u00e9o).</li> <li>S\u1ed1 c\u00e1ch \u0111\u1ec3 n\u1ed1i $2n$ \u0111i\u1ec3m tr\u00ean m\u1ed9t v\u00f2ng tr\u00f2n \u0111\u1ec3 t\u1ea1o th\u00e0nh $n$ d\u00e2y cung r\u1eddi r\u1ea1c.</li> <li>S\u1ed1 l\u01b0\u1ee3ng c\u00e2y nh\u1ecb ph\u00e2n \u0111\u1ea7y \u0111\u1ee7 kh\u00f4ng \u0111\u1eb3ng c\u1ea5u v\u1edbi $n$ n\u00fat trong (t\u1ee9c l\u00e0 c\u00e1c n\u00fat c\u00f3 \u00edt nh\u1ea5t m\u1ed9t con trai).</li> <li>S\u1ed1 l\u01b0\u1ee3ng \u0111\u01b0\u1eddng \u0111i l\u01b0\u1edbi \u0111\u01a1n \u0111i\u1ec7u t\u1eeb \u0111i\u1ec3m $(0, 0)$ \u0111\u1ebfn \u0111i\u1ec3m $(n, n)$ trong m\u1ed9t l\u01b0\u1edbi vu\u00f4ng c\u00f3 k\u00edch th\u01b0\u1edbc $n \\times n$, kh\u00f4ng \u0111i qua ph\u00eda tr\u00ean \u0111\u01b0\u1eddng ch\u00e9o ch\u00ednh (t\u1ee9c l\u00e0 n\u1ed1i $(0, 0)$ v\u1edbi $(n, n)$).</li> <li>S\u1ed1 l\u01b0\u1ee3ng ho\u00e1n v\u1ecb c\u00f3 \u0111\u1ed9 d\u00e0i $n$ c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp b\u1eb1ng ng\u0103n x\u1ebfp (t\u1ee9c l\u00e0 c\u00f3 th\u1ec3 ch\u1ec9 ra r\u1eb1ng s\u1ef1 s\u1eafp x\u1ebfp l\u1ea1i \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp b\u1eb1ng ng\u0103n x\u1ebfp khi v\u00e0 ch\u1ec9 khi kh\u00f4ng c\u00f3 ch\u1ec9 s\u1ed1 $i &lt; j &lt; k$ sao cho $a_k &lt; a_i &lt; a_j$).</li> <li>S\u1ed1 l\u01b0\u1ee3ng ph\u00e2n ho\u1ea1ch kh\u00f4ng ch\u00e9o c\u1ee7a m\u1ed9t t\u1eadp h\u1ee3p $n$ ph\u1ea7n t\u1eed.</li> <li>S\u1ed1 c\u00e1ch \u0111\u1ec3 ph\u1ee7 c\u00e1i thang $1 \\ldots n$ b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng $n$ h\u00ecnh ch\u1eef nh\u1eadt (C\u00e1i thang bao g\u1ed3m $n$ c\u1ed9t, trong \u0111\u00f3 c\u1ed9t th\u1ee9 $i$ c\u00f3 chi\u1ec1u cao $i$).</li> </ul>","tags":["Translated"]},{"location":"combinatorics/catalan-numbers.html#calculations","title":"T\u00ednh to\u00e1n (Calculations)","text":"<p>C\u00f3 hai c\u00f4ng th\u1ee9c cho c\u00e1c s\u1ed1 Catalan: Truy h\u1ed3i v\u00e0 Gi\u1ea3i t\u00edch. V\u00ec ch\u00fang t\u00f4i tin r\u1eb1ng t\u1ea5t c\u1ea3 c\u00e1c b\u00e0i to\u00e1n \u0111\u00e3 \u0111\u1ec1 c\u1eadp \u1edf tr\u00ean l\u00e0 t\u01b0\u01a1ng \u0111\u01b0\u01a1ng (c\u00f3 c\u00f9ng m\u1ed9t l\u1eddi gi\u1ea3i), \u0111\u1ec3 ch\u1ee9ng minh c\u00e1c c\u00f4ng th\u1ee9c d\u01b0\u1edbi \u0111\u00e2y, ch\u00fang t\u00f4i s\u1ebd ch\u1ecdn nhi\u1ec7m v\u1ee5 d\u1ec5 th\u1ef1c hi\u1ec7n nh\u1ea5t.</p>","tags":["Translated"]},{"location":"combinatorics/catalan-numbers.html#recursive-formula","title":"C\u00f4ng th\u1ee9c truy h\u1ed3i (Recursive formula)","text":"$$C_0 = C_1 = 1$$ $$C_n = \\sum_{k = 0}^{n-1} C_k C_{n-1-k} , {n} \\geq 2$$ <p>C\u00f4ng th\u1ee9c truy h\u1ed3i c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng suy ra t\u1eeb b\u00e0i to\u00e1n d\u00e3y ngo\u1eb7c \u0111\u00fang.</p> <p>D\u1ea5u ngo\u1eb7c m\u1edf ngo\u00e0i c\u00f9ng b\u00ean tr\u00e1i $l$ t\u01b0\u01a1ng \u1ee9ng v\u1edbi d\u1ea5u ngo\u1eb7c \u0111\u00f3ng nh\u1ea5t \u0111\u1ecbnh $r$, chia chu\u1ed7i th\u00e0nh 2 ph\u1ea7n, m\u1ed7i ph\u1ea7n l\u1ea7n l\u01b0\u1ee3t ph\u1ea3i l\u00e0 m\u1ed9t chu\u1ed7i d\u1ea5u ngo\u1eb7c \u0111\u00fang. Nh\u01b0 v\u1eady c\u00f4ng th\u1ee9c c\u0169ng \u0111\u01b0\u1ee3c chia th\u00e0nh 2 ph\u1ea7n. N\u1ebfu ch\u00fang ta k\u00fd hi\u1ec7u $k = {r - l - 1}$, th\u00ec v\u1edbi $r$ c\u1ed1 \u0111\u1ecbnh, s\u1ebd c\u00f3 ch\u00ednh x\u00e1c $C_k C_{n-1-k}$ d\u00e3y ngo\u1eb7c nh\u01b0 v\u1eady. T\u00ednh t\u1ed5ng n\u00e0y tr\u00ean t\u1ea5t c\u1ea3 c\u00e1c $k$ ch\u1ea5p nh\u1eadn \u0111\u01b0\u1ee3c, ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c quan h\u1ec7 truy h\u1ed3i tr\u00ean $C_n$.</p> <p>B\u1ea1n c\u0169ng c\u00f3 th\u1ec3 ngh\u0129 theo c\u00e1ch n\u00e0y. Theo \u0111\u1ecbnh ngh\u0129a, $C_n$ bi\u1ec3u th\u1ecb s\u1ed1 l\u01b0\u1ee3ng d\u00e3y ngo\u1eb7c \u0111\u00fang. B\u00e2y gi\u1edd, chu\u1ed7i c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c chia th\u00e0nh 2 ph\u1ea7n c\u00f3 \u0111\u1ed9 d\u00e0i $k$ v\u00e0 ${n - k}$, m\u1ed7i ph\u1ea7n ph\u1ea3i l\u00e0 m\u1ed9t d\u00e3y ngo\u1eb7c \u0111\u00fang. V\u00ed d\u1ee5 :</p> <p>$( ) ( ( ) )$ c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c chia th\u00e0nh $( )$ v\u00e0 $( ( ) )$, nh\u01b0ng kh\u00f4ng th\u1ec3 chia th\u00e0nh $( ) ($ v\u00e0 $( ) )$. M\u1ed9t l\u1ea7n n\u1eefa t\u00ednh t\u1ed5ng tr\u00ean t\u1ea5t c\u1ea3 c\u00e1c $k$ ch\u1ea5p nh\u1eadn \u0111\u01b0\u1ee3c, ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c quan h\u1ec7 truy h\u1ed3i tr\u00ean $C_n$.</p>","tags":["Translated"]},{"location":"combinatorics/catalan-numbers.html#cpp-implementation","title":"C\u00e0i \u0111\u1eb7t C++ (C++ implementation)","text":"<pre><code>const int MOD = ....\nconst int MAX = ....\nint catalan[MAX];\nvoid init() {\n    catalan[0] = catalan[1] = 1;\n    for (int i=2; i&lt;=n; i++) {\n        catalan[i] = 0;\n        for (int j=0; j &lt; i; j++) {\n            catalan[i] += (catalan[j] * catalan[i-j-1]) % MOD;\n            if (catalan[i] &gt;= MOD) {\n                catalan[i] -= MOD;\n            }\n        }\n    }\n}\n</code></pre>","tags":["Translated"]},{"location":"combinatorics/catalan-numbers.html#analytical-formula","title":"C\u00f4ng th\u1ee9c gi\u1ea3i t\u00edch (Analytical formula)","text":"$$C_n = \\frac{1}{n + 1} {\\binom{2n}{n}}$$ <p>(\u1edf \u0111\u00e2y $\\binom{n}{k}$ bi\u1ec3u th\u1ecb h\u1ec7 s\u1ed1 nh\u1ecb th\u1ee9c th\u00f4ng th\u01b0\u1eddng, t\u1ee9c l\u00e0 s\u1ed1 c\u00e1ch \u0111\u1ec3 ch\u1ecdn $k$ \u0111\u1ed1i t\u01b0\u1ee3ng t\u1eeb t\u1eadp h\u1ee3p $n$ \u0111\u1ed1i t\u01b0\u1ee3ng).</p> <p>C\u00f4ng th\u1ee9c tr\u00ean c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng k\u1ebft lu\u1eadn t\u1eeb b\u00e0i to\u00e1n c\u00e1c \u0111\u01b0\u1eddng \u0111i \u0111\u01a1n \u0111i\u1ec7u trong l\u01b0\u1edbi vu\u00f4ng. T\u1ed5ng s\u1ed1 \u0111\u01b0\u1eddng \u0111i \u0111\u01a1n \u0111i\u1ec7u trong l\u01b0\u1edbi k\u00edch th\u01b0\u1edbc $n \\times n$ \u0111\u01b0\u1ee3c cho b\u1edfi $\\binom{2n}{n}$.</p> <p>B\u00e2y gi\u1edd ch\u00fang ta \u0111\u1ebfm s\u1ed1 l\u01b0\u1ee3ng \u0111\u01b0\u1eddng \u0111i \u0111\u01a1n \u0111i\u1ec7u c\u1eaft \u0111\u01b0\u1eddng ch\u00e9o ch\u00ednh. Xem x\u00e9t c\u00e1c \u0111\u01b0\u1eddng \u0111i nh\u01b0 v\u1eady c\u1eaft \u0111\u01b0\u1eddng ch\u00e9o ch\u00ednh v\u00e0 t\u00ecm c\u1ea1nh \u0111\u1ea7u ti\u00ean trong \u0111\u00f3 n\u1eb1m ph\u00eda tr\u00ean \u0111\u01b0\u1eddng ch\u00e9o. Ph\u1ea3n chi\u1ebfu \u0111\u01b0\u1eddng \u0111i qua \u0111\u01b0\u1eddng ch\u00e9o tr\u00ean to\u00e0n b\u1ed9 qu\u00e3ng \u0111\u01b0\u1eddng, \u0111i sau c\u1ea1nh n\u00e0y. K\u1ebft qu\u1ea3 lu\u00f4n l\u00e0 m\u1ed9t \u0111\u01b0\u1eddng \u0111i \u0111\u01a1n \u0111i\u1ec7u trong l\u01b0\u1edbi $(n - 1) \\times (n + 1)$. M\u1eb7t kh\u00e1c, m\u1ecdi \u0111\u01b0\u1eddng \u0111i \u0111\u01a1n \u0111i\u1ec7u trong l\u01b0\u1edbi $(n - 1) \\times (n + 1)$ ph\u1ea3i c\u1eaft \u0111\u01b0\u1eddng ch\u00e9o. Do \u0111\u00f3, ch\u00fang ta \u0111\u00e3 li\u1ec7t k\u00ea t\u1ea5t c\u1ea3 c\u00e1c \u0111\u01b0\u1eddng \u0111i \u0111\u01a1n \u0111i\u1ec7u c\u1eaft \u0111\u01b0\u1eddng ch\u00e9o ch\u00ednh trong l\u01b0\u1edbi $n \\times n$.</p> <p>S\u1ed1 l\u01b0\u1ee3ng \u0111\u01b0\u1eddng \u0111i \u0111\u01a1n \u0111i\u1ec7u trong l\u01b0\u1edbi $(n - 1) \\times (n + 1)$ l\u00e0 $\\binom{2n}{n-1}$. H\u00e3y g\u1ecdi nh\u1eefng con \u0111\u01b0\u1eddng nh\u01b0 v\u1eady l\u00e0 nh\u1eefng con \u0111\u01b0\u1eddng \"x\u1ea5u\". K\u1ebft qu\u1ea3 l\u00e0, \u0111\u1ec3 c\u00f3 \u0111\u01b0\u1ee3c s\u1ed1 l\u01b0\u1ee3ng \u0111\u01b0\u1eddng \u0111i \u0111\u01a1n \u0111i\u1ec7u kh\u00f4ng c\u1eaft \u0111\u01b0\u1eddng ch\u00e9o ch\u00ednh, ch\u00fang ta tr\u1eeb c\u00e1c \u0111\u01b0\u1eddng \u0111i \"x\u1ea5u\" \u1edf tr\u00ean, thu \u0111\u01b0\u1ee3c c\u00f4ng th\u1ee9c:</p> $$C_n = \\binom{2n}{n} - \\binom{2n}{n-1} = \\frac{1}{n + 1} \\binom{2n}{n} , {n} \\geq 0$$","tags":["Translated"]},{"location":"combinatorics/catalan-numbers.html#reference","title":"Tham kh\u1ea3o (Reference)","text":"<ul> <li>Catalan Number by Tom Davis</li> </ul>","tags":["Translated"]},{"location":"combinatorics/catalan-numbers.html#practice-problems","title":"B\u00e0i t\u1eadp luy\u1ec7n t\u1eadp","text":"<ul> <li>Codechef - PANSTACK</li> <li>Spoj - Skyline</li> <li>UVA - Safe Salutations</li> <li>Codeforces - How many trees?</li> <li>SPOJ - FUNPROB</li> <li>LOJ - 1170 - Counting Perfect BST</li> <li>UVA - 12887 - The Soldier's Dilemma</li> </ul>","tags":["Translated"]},{"location":"combinatorics/catalan-numbers.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 96</li> <li>Translated lines: 96</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Translated"]},{"location":"combinatorics/counting_labeled_graphs.html","title":"\u0110\u1ebfm \u0111\u1ed3 th\u1ecb c\u00f3 nh\u00e3n (Counting labeled graphs)","text":"","tags":["Translated"]},{"location":"combinatorics/counting_labeled_graphs.html#labeled-graphs","title":"\u0110\u1ed3 th\u1ecb c\u00f3 nh\u00e3n (Labeled graphs)","text":"<p>G\u1ecdi s\u1ed1 \u0111\u1ec9nh trong m\u1ed9t \u0111\u1ed3 th\u1ecb l\u00e0 $n$. Ch\u00fang ta ph\u1ea3i t\u00ednh s\u1ed1 $G_n$ c\u00e1c \u0111\u1ed3 th\u1ecb c\u00f3 nh\u00e3n v\u1edbi $n$ \u0111\u1ec9nh (c\u00f3 nh\u00e3n c\u00f3 ngh\u0129a l\u00e0 c\u00e1c \u0111\u1ec9nh \u0111\u01b0\u1ee3c \u0111\u00e1nh d\u1ea5u b\u1eb1ng c\u00e1c s\u1ed1 t\u1eeb $1$ \u0111\u1ebfn $n$). C\u00e1c c\u1ea1nh c\u1ee7a \u0111\u1ed3 th\u1ecb \u0111\u01b0\u1ee3c coi l\u00e0 v\u00f4 h\u01b0\u1edbng, v\u00e0 c\u00e1c v\u00f2ng l\u1eb7p (loops) v\u00e0 \u0111a c\u1ea1nh (multiple edges) b\u1ecb c\u1ea5m.</p> <p>Ch\u00fang ta xem x\u00e9t t\u1eadp h\u1ee3p t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh c\u00f3 th\u1ec3 c\u1ee7a \u0111\u1ed3 th\u1ecb. \u0110\u1ed1i v\u1edbi m\u1ed7i c\u1ea1nh $(i, j)$ ch\u00fang ta c\u00f3 th\u1ec3 gi\u1ea3 \u0111\u1ecbnh r\u1eb1ng $i &lt; j$ (v\u00ec \u0111\u1ed3 th\u1ecb l\u00e0 v\u00f4 h\u01b0\u1edbng, v\u00e0 kh\u00f4ng c\u00f3 v\u00f2ng l\u1eb7p). Do \u0111\u00f3 t\u1eadp h\u1ee3p t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh c\u00f3 l\u1ef1c l\u01b0\u1ee3ng $\\binom{n}{2}$, t\u1ee9c l\u00e0 $\\frac{n(n-1)}{2}$.</p> <p>V\u00ec b\u1ea5t k\u1ef3 \u0111\u1ed3 th\u1ecb c\u00f3 nh\u00e3n n\u00e0o c\u0169ng \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh duy nh\u1ea5t b\u1edfi c\u00e1c c\u1ea1nh c\u1ee7a n\u00f3, s\u1ed1 l\u01b0\u1ee3ng \u0111\u1ed3 th\u1ecb c\u00f3 nh\u00e3n v\u1edbi $n$ \u0111\u1ec9nh b\u1eb1ng:</p> $$G_n = 2^{\\frac{n(n-1)}{2}}$$","tags":["Translated"]},{"location":"combinatorics/counting_labeled_graphs.html#connected-labeled-graphs","title":"\u0110\u1ed3 th\u1ecb c\u00f3 nh\u00e3n li\u00ean th\u00f4ng (Connected labeled graphs)","text":"<p>\u1ede \u0111\u00e2y, ch\u00fang ta \u00e1p \u0111\u1eb7t th\u00eam h\u1ea1n ch\u1ebf r\u1eb1ng \u0111\u1ed3 th\u1ecb ph\u1ea3i li\u00ean th\u00f4ng.</p> <p>H\u00e3y k\u00fd hi\u1ec7u s\u1ed1 l\u01b0\u1ee3ng \u0111\u1ed3 th\u1ecb li\u00ean th\u00f4ng c\u1ea7n thi\u1ebft v\u1edbi $n$ \u0111\u1ec9nh l\u00e0 $C_n$.</p> <p>\u0110\u1ea7u ti\u00ean ch\u00fang ta s\u1ebd th\u1ea3o lu\u1eadn xem c\u00f3 bao nhi\u00eau \u0111\u1ed3 th\u1ecb kh\u00f4ng li\u00ean th\u00f4ng t\u1ed3n t\u1ea1i. Khi \u0111\u00f3 s\u1ed1 l\u01b0\u1ee3ng \u0111\u1ed3 th\u1ecb li\u00ean th\u00f4ng s\u1ebd l\u00e0 $G_n$ tr\u1eeb \u0111i s\u1ed1 l\u01b0\u1ee3ng \u0111\u1ed3 th\u1ecb kh\u00f4ng li\u00ean th\u00f4ng. Th\u1eadm ch\u00ed nhi\u1ec1u h\u01a1n, ch\u00fang ta s\u1ebd \u0111\u1ebfm s\u1ed1 l\u01b0\u1ee3ng \u0111\u1ed3 th\u1ecb kh\u00f4ng li\u00ean th\u00f4ng, c\u00f3 g\u1ed1c. M\u1ed9t \u0111\u1ed3 th\u1ecb c\u00f3 g\u1ed1c l\u00e0 m\u1ed9t \u0111\u1ed3 th\u1ecb, trong \u0111\u00f3 ch\u00fang ta nh\u1ea5n m\u1ea1nh m\u1ed9t \u0111\u1ec9nh b\u1eb1ng c\u00e1ch d\u00e1n nh\u00e3n n\u00f3 l\u00e0 g\u1ed1c. R\u00f5 r\u00e0ng ch\u00fang ta c\u00f3 $n$ kh\u1ea3 n\u0103ng \u0111\u1ec3 root m\u1ed9t \u0111\u1ed3 th\u1ecb v\u1edbi $n$ \u0111\u1ec9nh c\u00f3 nh\u00e3n, do \u0111\u00f3 ch\u00fang ta s\u1ebd c\u1ea7n chia s\u1ed1 l\u01b0\u1ee3ng \u0111\u1ed3 th\u1ecb kh\u00f4ng li\u00ean th\u00f4ng c\u00f3 g\u1ed1c cho $n$ \u1edf cu\u1ed1i \u0111\u1ec3 c\u00f3 \u0111\u01b0\u1ee3c s\u1ed1 l\u01b0\u1ee3ng \u0111\u1ed3 th\u1ecb kh\u00f4ng li\u00ean th\u00f4ng.</p> <p>\u0110\u1ec9nh g\u1ed1c s\u1ebd xu\u1ea5t hi\u1ec7n trong m\u1ed9t th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng c\u00f3 k\u00edch th\u01b0\u1edbc $1, \\dots n-1$. C\u00f3 $k \\binom{n}{k} C_k G_{n-k}$ \u0111\u1ed3 th\u1ecb sao cho \u0111\u1ec9nh g\u1ed1c n\u1eb1m trong m\u1ed9t th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng v\u1edbi $k$ \u0111\u1ec9nh (c\u00f3 $\\binom{n}{k}$ c\u00e1ch \u0111\u1ec3 ch\u1ecdn $k$ \u0111\u1ec9nh cho th\u00e0nh ph\u1ea7n, nh\u1eefng \u0111\u1ec9nh n\u00e0y \u0111\u01b0\u1ee3c k\u1ebft n\u1ed1i theo m\u1ed9t trong $C_k$ c\u00e1ch, \u0111\u1ec9nh g\u1ed1c c\u00f3 th\u1ec3 l\u00e0 b\u1ea5t k\u1ef3 \u0111\u1ec9nh n\u00e0o trong s\u1ed1 $k$ \u0111\u1ec9nh, v\u00e0 $n-k$ \u0111\u1ec9nh c\u00f2n l\u1ea1i c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c k\u1ebft n\u1ed1i/kh\u00f4ng k\u1ebft n\u1ed1i theo b\u1ea5t k\u1ef3 c\u00e1ch n\u00e0o, \u0111i\u1ec1u n\u00e0y mang l\u1ea1i m\u1ed9t y\u1ebfu t\u1ed1 $G_{n-k}$). Do \u0111\u00f3 s\u1ed1 l\u01b0\u1ee3ng \u0111\u1ed3 th\u1ecb kh\u00f4ng li\u00ean th\u00f4ng v\u1edbi $n$ \u0111\u1ec9nh l\u00e0:</p> $$\\frac{1}{n} \\sum_{k=1}^{n-1} k \\binom{n}{k} C_k G_{n-k}$$ <p>V\u00e0 cu\u1ed1i c\u00f9ng s\u1ed1 l\u01b0\u1ee3ng \u0111\u1ed3 th\u1ecb li\u00ean th\u00f4ng l\u00e0:</p> $$C_n = G_n - \\frac{1}{n} \\sum_{k=1}^{n-1} k \\binom{n}{k} C_k G_{n-k}$$","tags":["Translated"]},{"location":"combinatorics/counting_labeled_graphs.html#labeled-graphs-with-k-connected-components","title":"\u0110\u1ed3 th\u1ecb c\u00f3 nh\u00e3n v\u1edbi $k$ th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng (Labeled graphs with $k$ connected components)","text":"<p>D\u1ef1a tr\u00ean c\u00f4ng th\u1ee9c t\u1eeb ph\u1ea7n tr\u01b0\u1edbc, ch\u00fang ta s\u1ebd h\u1ecdc c\u00e1ch \u0111\u1ebfm s\u1ed1 l\u01b0\u1ee3ng \u0111\u1ed3 th\u1ecb c\u00f3 nh\u00e3n v\u1edbi $n$ \u0111\u1ec9nh v\u00e0 $k$ th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng.</p> <p>S\u1ed1 n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ednh b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng quy ho\u1ea1ch \u0111\u1ed9ng. Ch\u00fang ta s\u1ebd t\u00ednh $D[i][j]$ - s\u1ed1 l\u01b0\u1ee3ng \u0111\u1ed3 th\u1ecb c\u00f3 nh\u00e3n v\u1edbi $i$ \u0111\u1ec9nh v\u00e0 $j$ th\u00e0nh ph\u1ea7n - cho m\u1ed7i $i \\le n$ v\u00e0 $j \\le k$.</p> <p>H\u00e3y th\u1ea3o lu\u1eadn v\u1ec1 c\u00e1ch t\u00ednh ph\u1ea7n t\u1eed ti\u1ebfp theo $D[n][k]$ n\u1ebfu ch\u00fang ta \u0111\u00e3 bi\u1ebft c\u00e1c gi\u00e1 tr\u1ecb tr\u01b0\u1edbc \u0111\u00f3. Ch\u00fang ta s\u1eed d\u1ee5ng m\u1ed9t c\u00e1ch ti\u1ebfp c\u1eadn ph\u1ed5 bi\u1ebfn, ch\u00fang ta l\u1ea5y \u0111\u1ec9nh cu\u1ed1i c\u00f9ng (ch\u1ec9 s\u1ed1 $n$). \u0110\u1ec9nh n\u00e0y thu\u1ed9c v\u1ec1 m\u1ed9t th\u00e0nh ph\u1ea7n n\u00e0o \u0111\u00f3. N\u1ebfu k\u00edch th\u01b0\u1edbc c\u1ee7a th\u00e0nh ph\u1ea7n n\u00e0y l\u00e0 $s$, th\u00ec c\u00f3 $\\binom{n-1}{s-1}$ c\u00e1ch \u0111\u1ec3 ch\u1ecdn m\u1ed9t t\u1eadp h\u1ee3p c\u00e1c \u0111\u1ec9nh nh\u01b0 v\u1eady, v\u00e0 $C_s$ c\u00e1ch \u0111\u1ec3 k\u1ebft n\u1ed1i ch\u00fang. Sau khi lo\u1ea1i b\u1ecf th\u00e0nh ph\u1ea7n n\u00e0y kh\u1ecfi \u0111\u1ed3 th\u1ecb, ch\u00fang ta c\u00f3 $n-s$ \u0111\u1ec9nh c\u00f2n l\u1ea1i v\u1edbi $k-1$ th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng. Do \u0111\u00f3 ch\u00fang ta thu \u0111\u01b0\u1ee3c quan h\u1ec7 truy h\u1ed3i sau:</p> $$D[n][k] = \\sum_{s=1}^{n} \\binom{n-1}{s-1} C_s D[n-s][k-1]$$","tags":["Translated"]},{"location":"combinatorics/counting_labeled_graphs.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 58</li> <li>Translated lines: 58</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Translated"]},{"location":"combinatorics/generating_combinations.html","title":"Sinh t\u1ea5t c\u1ea3 c\u00e1c t\u1ed5 h\u1ee3p ch\u1eadp $K$ (Generating all $K$-combinations)","text":"<p>Trong b\u00e0i vi\u1ebft n\u00e0y, ch\u00fang ta s\u1ebd th\u1ea3o lu\u1eadn v\u1ec1 b\u00e0i to\u00e1n sinh t\u1ea5t c\u1ea3 c\u00e1c t\u1ed5 h\u1ee3p ch\u1eadp $K$. Cho c\u00e1c s\u1ed1 t\u1ef1 nhi\u00ean $N$ v\u00e0 $K$, v\u00e0 xem x\u00e9t m\u1ed9t t\u1eadp h\u1ee3p c\u00e1c s\u1ed1 t\u1eeb $1$ \u0111\u1ebfn $N$. Nhi\u1ec7m v\u1ee5 l\u00e0 t\u00ecm ra t\u1ea5t c\u1ea3 c\u00e1c t\u1eadp con c\u00f3 k\u00edch th\u01b0\u1edbc $K$.</p>","tags":["Translated"]},{"location":"combinatorics/generating_combinations.html#generate-next-lexicographical-k-combination","title":"Sinh t\u1ed5 h\u1ee3p ch\u1eadp $K$ ti\u1ebfp theo theo th\u1ee9 t\u1ef1 t\u1eeb \u0111i\u1ec3n (Generate next lexicographical $K$-combination)","text":"<p>\u0110\u1ea7u ti\u00ean ch\u00fang ta s\u1ebd sinh ch\u00fang theo th\u1ee9 t\u1ef1 t\u1eeb \u0111i\u1ec3n. Thu\u1eadt to\u00e1n cho vi\u1ec7c n\u00e0y r\u1ea5t \u0111\u01a1n gi\u1ea3n. T\u1ed5 h\u1ee3p \u0111\u1ea7u ti\u00ean s\u1ebd l\u00e0 ${1, 2, ..., K}$. B\u00e2y gi\u1edd h\u00e3y xem l\u00e0m th\u1ebf n\u00e0o \u0111\u1ec3 t\u00ecm t\u1ed5 h\u1ee3p theo ngay sau t\u1ed5 h\u1ee3p n\u00e0y, theo th\u1ee9 t\u1ef1 t\u1eeb \u0111i\u1ec3n. \u0110\u1ec3 l\u00e0m nh\u01b0 v\u1eady, ch\u00fang ta xem x\u00e9t t\u1ed5 h\u1ee3p hi\u1ec7n t\u1ea1i c\u1ee7a m\u00ecnh, v\u00e0 t\u00ecm ph\u1ea7n t\u1eed ngo\u00e0i c\u00f9ng b\u00ean ph\u1ea3i ch\u01b0a \u0111\u1ea1t \u0111\u1ebfn gi\u00e1 tr\u1ecb cao nh\u1ea5t c\u00f3 th\u1ec3 c\u1ee7a n\u00f3. Khi t\u00ecm th\u1ea5y ph\u1ea7n t\u1eed n\u00e0y, ch\u00fang ta t\u0103ng n\u00f3 th\u00eam $1$, v\u00e0 g\u00e1n gi\u00e1 tr\u1ecb h\u1ee3p l\u1ec7 th\u1ea5p nh\u1ea5t cho t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed ti\u1ebfp theo.</p> <pre><code>bool next_combination(vector&lt;int&gt;&amp; a, int n) {\n    int k = (int)a.size();\n    for (int i = k - 1; i &gt;= 0; i--) {\n        if (a[i] &lt; n - k + i + 1) {\n            a[i]++;\n            for (int j = i + 1; j &lt; k; j++)\n                a[j] = a[j - 1] + 1;\n            return true;\n        }\n    }\n    return false;\n}\n</code></pre>","tags":["Translated"]},{"location":"combinatorics/generating_combinations.html#generate-all-k-combinations-such-that-adjacent-combinations-differ-by-one-element","title":"Sinh t\u1ea5t c\u1ea3 c\u00e1c t\u1ed5 h\u1ee3p ch\u1eadp $K$ sao cho c\u00e1c t\u1ed5 h\u1ee3p k\u1ec1 nhau kh\u00e1c nhau m\u1ed9t ph\u1ea7n t\u1eed (Generate all $K$-combinations such that adjacent combinations differ by one element)","text":"<p>L\u1ea7n n\u00e0y ch\u00fang ta mu\u1ed1n sinh t\u1ea5t c\u1ea3 c\u00e1c t\u1ed5 h\u1ee3p ch\u1eadp $K$ theo m\u1ed9t th\u1ee9 t\u1ef1 sao cho c\u00e1c t\u1ed5 h\u1ee3p k\u1ec1 nhau kh\u00e1c nhau ch\u00ednh x\u00e1c m\u1ed9t ph\u1ea7n t\u1eed.</p> <p>\u0110i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i quy\u1ebft b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng M\u00e3 Gray: N\u1ebfu ch\u00fang ta g\u00e1n m\u1ed9t bitmask cho m\u1ed7i t\u1eadp con, th\u00ec b\u1eb1ng c\u00e1ch sinh v\u00e0 l\u1eb7p qua c\u00e1c bitmask n\u00e0y v\u1edbi m\u00e3 Gray, ch\u00fang ta c\u00f3 th\u1ec3 thu \u0111\u01b0\u1ee3c c\u00e2u tr\u1ea3 l\u1eddi c\u1ee7a m\u00ecnh.</p> <p>Nhi\u1ec7m v\u1ee5 sinh c\u00e1c t\u1ed5 h\u1ee3p ch\u1eadp $K$ c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i quy\u1ebft b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng M\u00e3 Gray theo m\u1ed9t c\u00e1ch kh\u00e1c: Sinh M\u00e3 Gray cho c\u00e1c s\u1ed1 t\u1eeb $0$ \u0111\u1ebfn $2^N - 1$ v\u00e0 ch\u1ec9 gi\u1eef l\u1ea1i nh\u1eefng m\u00e3 ch\u1ee9a $K$ s\u1ed1 $1$. S\u1ef1 th\u1eadt \u0111\u00e1ng ng\u1ea1c nhi\u00ean l\u00e0 trong chu\u1ed7i $K$ bit \u0111\u01b0\u1ee3c set k\u1ebft qu\u1ea3, b\u1ea5t k\u1ef3 hai m\u1eb7t n\u1ea1 l\u00e2n c\u1eadn n\u00e0o (bao g\u1ed3m c\u1ea3 m\u1eb7t n\u1ea1 \u0111\u1ea7u ti\u00ean v\u00e0 cu\u1ed1i c\u00f9ng - l\u00e2n c\u1eadn theo ngh\u0129a v\u00f2ng tr\u00f2n) - s\u1ebd kh\u00e1c nhau ch\u00ednh x\u00e1c hai bit, \u0111\u00f3 l\u00e0 m\u1ee5c ti\u00eau c\u1ee7a ch\u00fang ta (x\u00f3a m\u1ed9t s\u1ed1, th\u00eam m\u1ed9t s\u1ed1).</p> <p>H\u00e3y ch\u1ee9ng minh \u0111i\u1ec1u n\u00e0y:</p> <p>\u0110\u1ec3 ch\u1ee9ng minh, ch\u00fang ta nh\u1eafc l\u1ea1i th\u1ef1c t\u1ebf l\u00e0 chu\u1ed7i $G(N)$ (\u0111\u1ea1i di\u1ec7n cho M\u00e3 Gray th\u1ee9 $N$) c\u00f3 th\u1ec3 thu \u0111\u01b0\u1ee3c nh\u01b0 sau:</p> $$G(N) = 0G(N-1) \\cup 1G(N-1)^\\text{R}$$ <p>Ngh\u0129a l\u00e0, xem x\u00e9t chu\u1ed7i M\u00e3 Gray cho $N-1$, v\u00e0 th\u00eam ti\u1ec1n t\u1ed1 $0$ tr\u01b0\u1edbc m\u1ed7i s\u1ed1 h\u1ea1ng. V\u00e0 xem x\u00e9t chu\u1ed7i M\u00e3 Gray \u0111\u1ea3o ng\u01b0\u1ee3c cho $N-1$ v\u00e0 th\u00eam ti\u1ec1n t\u1ed1 $1$ tr\u01b0\u1edbc m\u1ed7i m\u1eb7t n\u1ea1, v\u00e0 n\u1ed1i hai chu\u1ed7i n\u00e0y l\u1ea1i.</p> <p>B\u00e2y gi\u1edd ch\u00fang ta c\u00f3 th\u1ec3 \u0111\u01b0a ra ch\u1ee9ng minh c\u1ee7a m\u00ecnh.</p> <p>\u0110\u1ea7u ti\u00ean, ch\u00fang ta ch\u1ee9ng minh r\u1eb1ng m\u1eb7t n\u1ea1 \u0111\u1ea7u ti\u00ean v\u00e0 cu\u1ed1i c\u00f9ng kh\u00e1c nhau ch\u00ednh x\u00e1c \u1edf hai bit. \u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y, l\u00e0 \u0111\u1ee7 \u0111\u1ec3 l\u01b0u \u00fd r\u1eb1ng m\u1eb7t n\u1ea1 \u0111\u1ea7u ti\u00ean c\u1ee7a chu\u1ed7i $G(N)$, s\u1ebd c\u00f3 d\u1ea1ng $N-K$ s\u1ed1 $0$, theo sau l\u00e0 $K$ s\u1ed1 $1$. V\u00ec bit \u0111\u1ea7u ti\u00ean \u0111\u01b0\u1ee3c \u0111\u1eb7t l\u00e0 $0$, sau \u0111\u00f3 l\u00e0 $(N-K-1)$ s\u1ed1 $0$, sau \u0111\u00f3 l\u00e0 $K$ bit \u0111\u01b0\u1ee3c set theo sau v\u00e0 m\u1eb7t n\u1ea1 cu\u1ed1i c\u00f9ng s\u1ebd c\u00f3 d\u1ea1ng $1$, sau \u0111\u00f3 l\u00e0 $(N-K)$ s\u1ed1 $0$, sau \u0111\u00f3 l\u00e0 $K-1$ s\u1ed1 $1$. \u00c1p d\u1ee5ng nguy\u00ean l\u00fd quy n\u1ea1p to\u00e1n h\u1ecdc, v\u00e0 s\u1eed d\u1ee5ng c\u00f4ng th\u1ee9c cho $G(N)$, k\u1ebft lu\u1eadn ch\u1ee9ng minh.</p> <p>B\u00e2y gi\u1edd nhi\u1ec7m v\u1ee5 c\u1ee7a ch\u00fang ta l\u00e0 ch\u1ec9 ra r\u1eb1ng b\u1ea5t k\u1ef3 hai m\u00e3 li\u1ec1n k\u1ec1 n\u00e0o c\u0169ng kh\u00e1c nhau ch\u00ednh x\u00e1c \u1edf hai bit, ch\u00fang ta c\u00f3 th\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y b\u1eb1ng c\u00e1ch xem x\u00e9t ph\u01b0\u01a1ng tr\u00ecnh \u0111\u1ec7 quy c\u1ee7a ch\u00fang ta cho vi\u1ec7c sinh M\u00e3 Gray. H\u00e3y gi\u1ea3 s\u1eed n\u1ed9i dung c\u1ee7a hai n\u1eeda \u0111\u01b0\u1ee3c h\u00ecnh th\u00e0nh b\u1edfi $G(N-1)$ l\u00e0 \u0111\u00fang. B\u00e2y gi\u1edd ch\u00fang ta c\u1ea7n ch\u1ee9ng minh r\u1eb1ng c\u1eb7p li\u00ean ti\u1ebfp m\u1edbi \u0111\u01b0\u1ee3c h\u00ecnh th\u00e0nh t\u1ea1i \u0111i\u1ec3m n\u1ed1i (b\u1eb1ng c\u00e1ch n\u1ed1i hai n\u1eeda n\u00e0y) c\u0169ng h\u1ee3p l\u1ec7, t\u1ee9c l\u00e0 ch\u00fang kh\u00e1c nhau ch\u00ednh x\u00e1c hai bit.</p> <p>\u0110i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n, v\u00ec ch\u00fang ta bi\u1ebft m\u1eb7t n\u1ea1 cu\u1ed1i c\u00f9ng c\u1ee7a n\u1eeda \u0111\u1ea7u ti\u00ean v\u00e0 m\u1eb7t n\u1ea1 \u0111\u1ea7u ti\u00ean c\u1ee7a n\u1eeda th\u1ee9 hai. M\u1eb7t n\u1ea1 cu\u1ed1i c\u00f9ng c\u1ee7a n\u1eeda \u0111\u1ea7u ti\u00ean s\u1ebd l\u00e0 $1$, sau \u0111\u00f3 l\u00e0 $(N-K-1)$ s\u1ed1 $0$, sau \u0111\u00f3 l\u00e0 $K-1$ s\u1ed1 $1$. V\u00e0 m\u1eb7t n\u1ea1 \u0111\u1ea7u ti\u00ean c\u1ee7a n\u1eeda th\u1ee9 hai s\u1ebd l\u00e0 $0$, sau \u0111\u00f3 $(N-K-2)$ s\u1ed1 $0$ s\u1ebd theo sau, v\u00e0 sau \u0111\u00f3 l\u00e0 $K$ s\u1ed1 $1$. Do \u0111\u00f3, so s\u00e1nh hai m\u1eb7t n\u1ea1, ch\u00fang ta t\u00ecm th\u1ea5y ch\u00ednh x\u00e1c hai bit kh\u00e1c nhau.</p> <p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u1ed9t c\u00e0i \u0111\u1eb7t ng\u00e2y th\u01a1 ho\u1ea1t \u0111\u1ed9ng b\u1eb1ng c\u00e1ch sinh t\u1ea5t c\u1ea3 $2^{n}$ t\u1eadp con c\u00f3 th\u1ec3, v\u00e0 t\u00ecm c\u00e1c t\u1eadp con c\u00f3 k\u00edch th\u01b0\u1edbc $K$.</p> <pre><code>int gray_code (int n) {\n    return n ^ (n &gt;&gt; 1);\n}\n\nint count_bits (int n) {\n    int res = 0;\n    for (; n; n &gt;&gt;= 1)\n        res += n &amp; 1;\n    return res;\n}\n\nvoid all_combinations (int n, int k) {\n    for (int i = 0; i &lt; (1 &lt;&lt; n); i++) {\n        int cur = gray_code (i);\n        if (count_bits(cur) == k) {\n            for (int j = 0; j &lt; n; j++) {\n                if (cur &amp; (1 &lt;&lt; j))\n                    cout &lt;&lt; j + 1;\n            }\n            cout &lt;&lt; \"\\n\";\n        }\n    }\n}\n</code></pre> <p>\u0110\u00e1ng ch\u00fa \u00fd l\u00e0 t\u1ed3n t\u1ea1i m\u1ed9t c\u00e0i \u0111\u1eb7t hi\u1ec7u qu\u1ea3 h\u01a1n ch\u1ec9 d\u00f9ng \u0111\u1ebfn vi\u1ec7c x\u00e2y d\u1ef1ng c\u00e1c t\u1ed5 h\u1ee3p h\u1ee3p l\u1ec7 v\u00e0 do \u0111\u00f3 ho\u1ea1t \u0111\u1ed9ng trong $O\\left(N \\cdot \\binom{N}{K}\\right)$ tuy nhi\u00ean n\u00f3 c\u00f3 b\u1ea3n ch\u1ea5t \u0111\u1ec7 quy v\u00e0 \u0111\u1ed1i v\u1edbi c\u00e1c gi\u00e1 tr\u1ecb nh\u1ecf c\u1ee7a $N$ n\u00f3 c\u00f3 th\u1ec3 c\u00f3 h\u1eb1ng s\u1ed1 l\u1edbn h\u01a1n so v\u1edbi gi\u1ea3i ph\u00e1p tr\u01b0\u1edbc \u0111\u00f3.</p> <p>Vi\u1ec7c c\u00e0i \u0111\u1eb7t \u0111\u01b0\u1ee3c b\u1eaft ngu\u1ed3n t\u1eeb c\u00f4ng th\u1ee9c:</p> $$G(N, K) = 0G(N-1, K) \\cup 1G(N-1, K-1)^\\text{R}$$ <p>C\u00f4ng th\u1ee9c n\u00e0y thu \u0111\u01b0\u1ee3c b\u1eb1ng c\u00e1ch s\u1eeda \u0111\u1ed5i ph\u01b0\u01a1ng tr\u00ecnh chung \u0111\u1ec3 x\u00e1c \u0111\u1ecbnh m\u00e3 Gray, v\u00e0 ho\u1ea1t \u0111\u1ed9ng b\u1eb1ng c\u00e1ch ch\u1ecdn chu\u1ed7i con t\u1eeb c\u00e1c ph\u1ea7n t\u1eed th\u00edch h\u1ee3p.</p> <p>C\u00e0i \u0111\u1eb7t c\u1ee7a n\u00f3 nh\u01b0 sau:</p> <pre><code>vector&lt;int&gt; ans;\n\nvoid gen(int n, int k, int idx, bool rev) {\n    if (k &gt; n || k &lt; 0)\n        return;\n\n    if (!n) {\n        for (int i = 0; i &lt; idx; ++i) {\n            if (ans[i])\n                cout &lt;&lt; i + 1;\n        }\n        cout &lt;&lt; \"\\n\";\n        return;\n    }\n\n    ans[idx] = rev;\n    gen(n - 1, k - rev, idx + 1, false);\n    ans[idx] = !rev;\n    gen(n - 1, k - !rev, idx + 1, true);\n}\n\nvoid all_combinations(int n, int k) {\n    ans.resize(n);\n    gen(n, k, 0, false);\n}\n</code></pre>","tags":["Translated"]},{"location":"combinatorics/generating_combinations.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 142</li> <li>Translated lines: 142</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Translated"]},{"location":"combinatorics/inclusion-exclusion.html","title":"Nguy\u00ean l\u00fd bao h\u00e0m-lo\u1ea1i tr\u1eeb (The Inclusion-Exclusion Principle)","text":"<p>Nguy\u00ean l\u00fd bao h\u00e0m-lo\u1ea1i tr\u1eeb l\u00e0 m\u1ed9t c\u00e1ch t\u1ed5 h\u1ee3p quan tr\u1ecdng \u0111\u1ec3 t\u00ednh k\u00edch th\u01b0\u1edbc c\u1ee7a m\u1ed9t t\u1eadp h\u1ee3p ho\u1eb7c x\u00e1c su\u1ea5t c\u1ee7a c\u00e1c s\u1ef1 ki\u1ec7n ph\u1ee9c t\u1ea1p. N\u00f3 li\u00ean h\u1ec7 k\u00edch th\u01b0\u1edbc c\u1ee7a c\u00e1c t\u1eadp h\u1ee3p ri\u00eang l\u1ebb v\u1edbi h\u1ee3p c\u1ee7a ch\u00fang.</p>","tags":["Translated"]},{"location":"combinatorics/inclusion-exclusion.html#statement","title":"Ph\u00e1t bi\u1ec3u (Statement)","text":"","tags":["Translated"]},{"location":"combinatorics/inclusion-exclusion.html#the-verbal-formula","title":"C\u00f4ng th\u1ee9c b\u1eb1ng l\u1eddi (The verbal formula)","text":"<p>Nguy\u00ean l\u00fd bao h\u00e0m-lo\u1ea1i tr\u1eeb c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c di\u1ec5n \u0111\u1ea1t nh\u01b0 sau:</p> <p>\u0110\u1ec3 t\u00ednh k\u00edch th\u01b0\u1edbc c\u1ee7a m\u1ed9t h\u1ee3p c\u1ee7a nhi\u1ec1u t\u1eadp h\u1ee3p, c\u1ea7n thi\u1ebft ph\u1ea3i c\u1ed9ng k\u00edch th\u01b0\u1edbc c\u1ee7a c\u00e1c t\u1eadp h\u1ee3p n\u00e0y m\u1ed9t c\u00e1ch ri\u00eang bi\u1ec7t, v\u00e0 sau \u0111\u00f3 tr\u1eeb \u0111i k\u00edch th\u01b0\u1edbc c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c giao \u0111i\u1ec3m t\u1eebng \u0111\u00f4i m\u1ed9t c\u1ee7a c\u00e1c t\u1eadp h\u1ee3p, sau \u0111\u00f3 c\u1ed9ng l\u1ea1i k\u00edch th\u01b0\u1edbc c\u1ee7a c\u00e1c giao \u0111i\u1ec3m c\u1ee7a b\u1ed9 ba c\u00e1c t\u1eadp h\u1ee3p, tr\u1eeb \u0111i k\u00edch th\u01b0\u1edbc c\u1ee7a b\u1ed9 b\u1ed1n c\u00e1c t\u1eadp h\u1ee3p, v\u00e0 c\u1ee9 ti\u1ebfp t\u1ee5c nh\u01b0 v\u1eady, cho \u0111\u1ebfn giao \u0111i\u1ec3m c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c t\u1eadp h\u1ee3p.</p>","tags":["Translated"]},{"location":"combinatorics/inclusion-exclusion.html#the-formulation-in-terms-of-sets","title":"C\u00f4ng th\u1ee9c theo t\u1eadp h\u1ee3p (The formulation in terms of sets)","text":"<p>\u0110\u1ecbnh ngh\u0129a tr\u00ean c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c di\u1ec5n \u0111\u1ea1t b\u1eb1ng to\u00e1n h\u1ecdc nh\u01b0 sau:</p> $$\\left| \\bigcup_{i=1}^n A_i \\right| = \\sum_{i=1}^n|A_i| - \\sum_{1\\leq i&lt;j\\leq n} |A_i \\cap A_j| + \\sum _{1\\leq i&lt;j&lt;k\\leq n}|A_i \\cap A_j \\cap A_k| - \\cdots + (-1)^{n-1} | A_1 \\cap \\cdots \\cap A_n |$$ <p>V\u00e0 theo m\u1ed9t c\u00e1ch g\u1ecdn g\u00e0ng h\u01a1n:</p> $$\\left|\\bigcup_{i=1}^n A_i \\right| = \\sum_{\\emptyset \\neq J\\subseteq \\{1,2,\\ldots ,n\\}} (-1)^{|J|-1}{\\Biggl |}\\bigcap_{j\\in J}A_{j}{\\Biggr |}$$","tags":["Translated"]},{"location":"combinatorics/inclusion-exclusion.html#the-formulation-using-venn-diagrams","title":"C\u00f4ng th\u1ee9c s\u1eed d\u1ee5ng bi\u1ec3u \u0111\u1ed3 Venn (The formulation using Venn diagrams)","text":"<p>Gi\u1ea3 s\u1eed bi\u1ec3u \u0111\u1ed3 hi\u1ec3n th\u1ecb ba t\u1eadp h\u1ee3p $A$, $B$ v\u00e0 $C$:</p> <p></p> <p>Khi \u0111\u00f3 di\u1ec7n t\u00edch h\u1ee3p c\u1ee7a ch\u00fang $A \\cup B \\cup C$ b\u1eb1ng t\u1ed5ng di\u1ec7n t\u00edch c\u00e1c ph\u1ea7n $A$, $B$ v\u00e0 $C$ tr\u1eeb \u0111i c\u00e1c di\u1ec7n t\u00edch \u0111\u01b0\u1ee3c ph\u1ee7 hai l\u1ea7n $A \\cap B$, $A \\cap C$, $B \\cap C$, nh\u01b0ng c\u1ed9ng th\u00eam di\u1ec7n t\u00edch \u0111\u01b0\u1ee3c bao ph\u1ee7 b\u1edfi ba t\u1eadp h\u1ee3p $A \\cap B \\cap C$:</p> $$S(A \\cup B \\cup C) = S(A) + S(B) + S(C) - S(A \\cap B) - S(A \\cap C) - S(B \\cap C) + S(A \\cap B \\cap C)$$ <p>N\u00f3 c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u1ed5ng qu\u00e1t h\u00f3a cho m\u1ed9t s\u1ef1 k\u1ebft h\u1ee3p c\u1ee7a $n$ t\u1eadp h\u1ee3p.</p>","tags":["Translated"]},{"location":"combinatorics/inclusion-exclusion.html#the-formulation-in-terms-of-probability-theory","title":"C\u00f4ng th\u1ee9c theo l\u00fd thuy\u1ebft x\u00e1c su\u1ea5t (The formulation in terms of probability theory)","text":"<p>N\u1ebfu $A_i$ $(i = 1,2...n)$ l\u00e0 c\u00e1c s\u1ef1 ki\u1ec7n v\u00e0 ${\\cal P}(A_i)$ l\u00e0 x\u00e1c su\u1ea5t \u0111\u1ec3 m\u1ed9t s\u1ef1 ki\u1ec7n t\u1eeb $A_i$ x\u1ea3y ra, th\u00ec x\u00e1c su\u1ea5t h\u1ee3p c\u1ee7a ch\u00fang (t\u1ee9c l\u00e0 x\u00e1c su\u1ea5t \u0111\u1ec3 \u00edt nh\u1ea5t m\u1ed9t trong c\u00e1c s\u1ef1 ki\u1ec7n x\u1ea3y ra) b\u1eb1ng:</p> $$\\begin{eqnarray} {\\cal P} \\left( \\bigcup_{i=1}^n A_i \\right) &amp;=&amp; \\sum_{i=1}^n{\\cal P}(A_i)\\ - \\sum_{1\\leq i&lt;j\\leq n} {\\cal P}(A_i \\cap A_j)\\  + \\\\ &amp;+&amp; \\sum _{1\\leq i&lt;j&lt;k\\leq n}{\\cal P}(A_i \\cap A_j \\cap A_k) - \\cdots + (-1)^{n-1} {\\cal P}( A_1 \\cap \\cdots \\cap A_n ) \\end{eqnarray}$$ <p>V\u00e0 theo m\u1ed9t c\u00e1ch g\u1ecdn g\u00e0ng h\u01a1n:</p> $${\\cal P} \\left(\\bigcup_{i=1}^n A_i \\right) = \\sum_{\\emptyset \\neq J\\subseteq \\{1,2,\\ldots ,n\\}} (-1)^{|J|-1}\\ {\\cal P}{\\Biggl (}\\bigcap_{j\\in J}A_{j}{\\Biggr )}$$","tags":["Translated"]},{"location":"combinatorics/inclusion-exclusion.html#proof","title":"Ch\u1ee9ng minh (Proof)","text":"<p>\u0110\u1ec3 ch\u1ee9ng minh, thu\u1eadn ti\u1ec7n s\u1eed d\u1ee5ng c\u00f4ng th\u1ee9c to\u00e1n h\u1ecdc theo l\u00fd thuy\u1ebft t\u1eadp h\u1ee3p:</p> $$\\left|\\bigcup_{i=1}^n A_i \\right| = \\sum_{\\emptyset \\neq J\\subseteq \\{1,2,\\ldots ,n\\}} (-1)^{|J|-1}{\\Biggl |}\\bigcap_{j\\in J}A_{j}{\\Biggr |}$$ <p>Ch\u00fang t\u00f4i mu\u1ed1n ch\u1ee9ng minh r\u1eb1ng b\u1ea5t k\u1ef3 ph\u1ea7n t\u1eed n\u00e0o ch\u1ee9a trong \u00edt nh\u1ea5t m\u1ed9t trong c\u00e1c t\u1eadp h\u1ee3p $A_i$ s\u1ebd xu\u1ea5t hi\u1ec7n trong c\u00f4ng th\u1ee9c ch\u1ec9 m\u1ed9t l\u1ea7n (l\u01b0u \u00fd r\u1eb1ng c\u00e1c ph\u1ea7n t\u1eed kh\u00f4ng hi\u1ec7n di\u1ec7n trong b\u1ea5t k\u1ef3 t\u1eadp h\u1ee3p $A_i$ n\u00e0o s\u1ebd kh\u00f4ng bao gi\u1edd \u0111\u01b0\u1ee3c xem x\u00e9t \u1edf ph\u1ea7n b\u00ean ph\u1ea3i c\u1ee7a c\u00f4ng th\u1ee9c).</p> <p>Xem x\u00e9t m\u1ed9t ph\u1ea7n t\u1eed $x$ xu\u1ea5t hi\u1ec7n trong $k \\geq 1$ t\u1eadp h\u1ee3p $A_i$. Ch\u00fang t\u00f4i s\u1ebd ch\u1ec9 ra r\u1eb1ng n\u00f3 ch\u1ec9 \u0111\u01b0\u1ee3c \u0111\u1ebfm m\u1ed9t l\u1ea7n trong c\u00f4ng th\u1ee9c. L\u01b0u \u00fd r\u1eb1ng:</p> <ul> <li>trong c\u00e1c s\u1ed1 h\u1ea1ng m\u00e0 $|J| = 1$, m\u1ee5c $x$ s\u1ebd \u0111\u01b0\u1ee3c \u0111\u1ebfm $+\\ k$ l\u1ea7n;</li> <li>trong c\u00e1c s\u1ed1 h\u1ea1ng m\u00e0 $|J| = 2$, m\u1ee5c $x$ s\u1ebd \u0111\u01b0\u1ee3c \u0111\u1ebfm $-\\ \\binom{k}{2}$ l\u1ea7n - b\u1edfi v\u00ec n\u00f3 s\u1ebd \u0111\u01b0\u1ee3c \u0111\u1ebfm trong c\u00e1c s\u1ed1 h\u1ea1ng bao g\u1ed3m hai trong s\u1ed1 $k$ t\u1eadp h\u1ee3p ch\u1ee9a $x$;</li> <li>trong c\u00e1c s\u1ed1 h\u1ea1ng m\u00e0 $|J| = 3$, m\u1ee5c $x$ s\u1ebd \u0111\u01b0\u1ee3c \u0111\u1ebfm $+\\ \\binom{k}{3}$ l\u1ea7n;</li> <li>$\\cdots$</li> <li>trong c\u00e1c s\u1ed1 h\u1ea1ng m\u00e0 $|J| = k$, m\u1ee5c $x$ s\u1ebd \u0111\u01b0\u1ee3c \u0111\u1ebfm $(-1)^{k-1}\\cdot \\binom{k}{k}$ l\u1ea7n;</li> <li>trong c\u00e1c s\u1ed1 h\u1ea1ng m\u00e0 $|J| \\gt k$, m\u1ee5c $x$ s\u1ebd \u0111\u01b0\u1ee3c \u0111\u1ebfm kh\u00f4ng l\u1ea7n;</li> </ul> <p>\u0110i\u1ec1u n\u00e0y d\u1eabn ch\u00fang ta \u0111\u1ebfn t\u1ed5ng sau c\u1ee7a h\u1ec7 s\u1ed1 nh\u1ecb th\u1ee9c:</p> $$ T = \\binom{k}{1} - \\binom{k}{2} + \\binom{k}{3} - \\cdots + (-1)^{i-1}\\cdot \\binom{k}{i} + \\cdots + (-1)^{k-1}\\cdot \\binom{k}{k}$$ <p>Bi\u1ec3u th\u1ee9c n\u00e0y r\u1ea5t gi\u1ed1ng v\u1edbi khai tri\u1ec3n nh\u1ecb th\u1ee9c c\u1ee7a $(1 - x)^k$:</p> $$ (1 - x)^k = \\binom{k}{0} - \\binom{k}{1} \\cdot x + \\binom{k}{2} \\cdot x^2 - \\binom{k}{3} \\cdot x^3 + \\cdots + (-1)^k\\cdot \\binom{k}{k} \\cdot x^k $$ <p>Khi $x = 1$, $(1 - x)^k$ tr\u00f4ng r\u1ea5t gi\u1ed1ng $T$. Tuy nhi\u00ean, bi\u1ec3u th\u1ee9c c\u00f3 th\u00eam $\\binom{k}{0} = 1$, v\u00e0 n\u00f3 \u0111\u01b0\u1ee3c nh\u00e2n v\u1edbi $-1$. \u0110i\u1ec1u \u0111\u00f3 d\u1eabn ch\u00fang ta \u0111\u1ebfn $(1 - 1)^k = 1 - T$. Do \u0111\u00f3 $T = 1 - (1 - 1)^k = 1$, \u0111i\u1ec1u c\u1ea7n ph\u1ea3i ch\u1ee9ng minh. Ph\u1ea7n t\u1eed ch\u1ec9 \u0111\u01b0\u1ee3c \u0111\u1ebfm m\u1ed9t l\u1ea7n.</p>","tags":["Translated"]},{"location":"combinatorics/inclusion-exclusion.html#generalization-for-calculating-number-of-elements-in-exactly-r-sets","title":"T\u1ed5ng qu\u00e1t h\u00f3a \u0111\u1ec3 t\u00ednh s\u1ed1 l\u01b0\u1ee3ng ph\u1ea7n t\u1eed trong ch\u00ednh x\u00e1c $r$ t\u1eadp h\u1ee3p (Generalization for calculating number of elements in exactly $r$ sets)","text":"<p>Nguy\u00ean l\u00fd bao h\u00e0m-lo\u1ea1i tr\u1eeb c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c vi\u1ebft l\u1ea1i \u0111\u1ec3 t\u00ednh s\u1ed1 l\u01b0\u1ee3ng ph\u1ea7n t\u1eed hi\u1ec7n di\u1ec7n trong kh\u00f4ng t\u1eadp h\u1ee3p:</p> $$\\left|\\bigcap_{i=1}^n \\overline{A_i}\\right|=\\sum_{m=0}^n (-1)^m \\sum_{|X|=m} \\left|\\bigcap_{i\\in X} A_{i}\\right|$$ <p>Xem x\u00e9t t\u1ed5ng qu\u00e1t h\u00f3a c\u1ee7a n\u00f3 \u0111\u1ec3 t\u00ednh s\u1ed1 l\u01b0\u1ee3ng ph\u1ea7n t\u1eed hi\u1ec7n di\u1ec7n trong ch\u00ednh x\u00e1c $r$ t\u1eadp h\u1ee3p:</p> $$\\left|\\bigcup_{|B|=r}\\left[\\bigcap_{i \\in B} A_i \\cap \\bigcap_{j \\not\\in B} \\overline{A_j}\\right]\\right|=\\sum_{m=r}^n (-1)^{m-r}\\dbinom{m}{r} \\sum_{|X|=m} \\left|\\bigcap_{i \\in X} A_{i}\\right|$$ <p>\u0110\u1ec3 ch\u1ee9ng minh c\u00f4ng th\u1ee9c n\u00e0y, h\u00e3y xem x\u00e9t m\u1ed9t $B$ c\u1ee5 th\u1ec3 n\u00e0o \u0111\u00f3. Do nguy\u00ean l\u00fd bao h\u00e0m-lo\u1ea1i tr\u1eeb c\u01a1 b\u1ea3n, ch\u00fang ta c\u00f3 th\u1ec3 n\u00f3i v\u1ec1 n\u00f3 r\u1eb1ng:</p> $$\\left|\\bigcap_{i \\in B} A_i \\cap \\bigcap_{j \\not \\in B} \\overline{A_j}\\right|=\\sum_{m=r}^{n} (-1)^{m-r} \\sum_{\\substack{|X|=m \\newline B \\subset X}}\\left|\\bigcap_{i\\in X} A_{i}\\right|$$ <p>C\u00e1c t\u1eadp h\u1ee3p \u1edf ph\u00eda b\u00ean tr\u00e1u kh\u00f4ng giao nhau \u0111\u1ed1i v\u1edbi c\u00e1c $B$ kh\u00e1c nhau, do \u0111\u00f3 ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh t\u1ed5ng tr\u1ef1c ti\u1ebfp. Ngo\u00e0i ra, c\u1ea7n l\u01b0u \u00fd r\u1eb1ng b\u1ea5t k\u1ef3 t\u1eadp h\u1ee3p $X$ n\u00e0o c\u0169ng s\u1ebd lu\u00f4n c\u00f3 h\u1ec7 s\u1ed1 $(-1)^{m-r}$ n\u1ebfu n\u00f3 xu\u1ea5t hi\u1ec7n v\u00e0 n\u00f3 s\u1ebd xu\u1ea5t hi\u1ec7n cho ch\u00ednh x\u00e1c $\\dbinom{m}{r}$ t\u1eadp h\u1ee3p $B$.</p>","tags":["Translated"]},{"location":"combinatorics/inclusion-exclusion.html#usage-when-solving-problems","title":"S\u1eed d\u1ee5ng khi gi\u1ea3i c\u00e1c b\u00e0i to\u00e1n (Usage when solving problems)","text":"<p>Nguy\u00ean l\u00fd bao h\u00e0m-lo\u1ea1i tr\u1eeb r\u1ea5t kh\u00f3 hi\u1ec3u n\u1ebfu kh\u00f4ng nghi\u00ean c\u1ee9u c\u00e1c \u1ee9ng d\u1ee5ng c\u1ee7a n\u00f3.</p> <p>Tr\u01b0\u1edbc ti\u00ean, ch\u00fang ta s\u1ebd xem x\u00e9t ba nhi\u1ec7m v\u1ee5 \u0111\u01a1n gi\u1ea3n nh\u1ea5t \"tr\u00ean gi\u1ea5y\", minh h\u1ecda c\u00e1c \u1ee9ng d\u1ee5ng c\u1ee7a nguy\u00ean l\u00fd, v\u00e0 sau \u0111\u00f3 xem x\u00e9t c\u00e1c b\u00e0i to\u00e1n th\u1ef1c t\u1ebf h\u01a1n kh\u00f3 gi\u1ea3i quy\u1ebft n\u1ebfu kh\u00f4ng c\u00f3 nguy\u00ean l\u00fd bao h\u00e0m-lo\u1ea1i tr\u1eeb.</p> <p>C\u00e1c nhi\u1ec7m v\u1ee5 y\u00eau c\u1ea7u \"t\u00ecm s\u1ed1 c\u00e1ch\" \u0111\u00e1ng ch\u00fa \u00fd, v\u00ec ch\u00fang \u0111\u00f4i khi d\u1eabn \u0111\u1ebfn c\u00e1c gi\u1ea3i ph\u00e1p \u0111a th\u1ee9c, kh\u00f4ng nh\u1ea5t thi\u1ebft l\u00e0 h\u00e0m m\u0169.</p>","tags":["Translated"]},{"location":"combinatorics/inclusion-exclusion.html#a-simple-task-on-permutations","title":"M\u1ed9t nhi\u1ec7m v\u1ee5 \u0111\u01a1n gi\u1ea3n v\u1ec1 c\u00e1c ho\u00e1n v\u1ecb (A simple task on permutations)","text":"<p>Nhi\u1ec7m v\u1ee5: \u0111\u1ebfm xem c\u00f3 bao nhi\u00eau ho\u00e1n v\u1ecb c\u1ee7a c\u00e1c s\u1ed1 t\u1eeb $0$ \u0111\u1ebfn $9$ t\u1ed3n t\u1ea1i sao cho ph\u1ea7n t\u1eed \u0111\u1ea7u ti\u00ean l\u1edbn h\u01a1n $1$ v\u00e0 ph\u1ea7n t\u1eed cu\u1ed1i c\u00f9ng nh\u1ecf h\u01a1n $8$.</p> <p>H\u00e3y \u0111\u1ebfm s\u1ed1 l\u01b0\u1ee3ng ho\u00e1n v\u1ecb \"x\u1ea5u\", t\u1ee9c l\u00e0 c\u00e1c ho\u00e1n v\u1ecb trong \u0111\u00f3 ph\u1ea7n t\u1eed \u0111\u1ea7u ti\u00ean l\u00e0 $\\leq 1$ v\u00e0/ho\u1eb7c ph\u1ea7n t\u1eed cu\u1ed1i c\u00f9ng l\u00e0 $\\geq 8$.</p> <p>Ch\u00fang ta s\u1ebd k\u00fd hi\u1ec7u $X$ l\u00e0 t\u1eadp h\u1ee3p c\u00e1c ho\u00e1n v\u1ecb trong \u0111\u00f3 ph\u1ea7n t\u1eed \u0111\u1ea7u ti\u00ean l\u00e0 $\\leq 1$ v\u00e0 $Y$ l\u00e0 t\u1eadp h\u1ee3p c\u00e1c ho\u00e1n v\u1ecb trong \u0111\u00f3 ph\u1ea7n t\u1eed cu\u1ed1i c\u00f9ng l\u00e0 $\\geq 8$. Khi \u0111\u00f3 s\u1ed1 l\u01b0\u1ee3ng ho\u00e1n v\u1ecb \"x\u1ea5u\", nh\u01b0 tr\u00ean c\u00f4ng th\u1ee9c bao h\u00e0m-lo\u1ea1i tr\u1eeb, s\u1ebd l\u00e0:</p> $$ |X \\cup Y| = |X| + |Y| - |X \\cap Y| $$ <p>Sau m\u1ed9t t\u00ednh to\u00e1n t\u1ed5 h\u1ee3p \u0111\u01a1n gi\u1ea3n, ch\u00fang ta s\u1ebd \u0111i \u0111\u1ebfn:</p> $$ 2 \\cdot 9! + 2 \\cdot 9! - 2 \\cdot 2 \\cdot 8! $$ <p>\u0110i\u1ec1u duy nh\u1ea5t c\u00f2n l\u1ea1i l\u00e0 tr\u1eeb s\u1ed1 n\u00e0y kh\u1ecfi t\u1ed5ng s\u1ed1 $10!$ \u0111\u1ec3 c\u00f3 \u0111\u01b0\u1ee3c s\u1ed1 l\u01b0\u1ee3ng ho\u00e1n v\u1ecb \"t\u1ed1t\".</p>","tags":["Translated"]},{"location":"combinatorics/inclusion-exclusion.html#a-simple-task-on-0-1-2-sequences","title":"M\u1ed9t nhi\u1ec7m v\u1ee5 \u0111\u01a1n gi\u1ea3n v\u1ec1 c\u00e1c chu\u1ed7i (0, 1, 2) (A simple task on (0, 1, 2) sequences)","text":"<p>Nhi\u1ec7m v\u1ee5: \u0111\u1ebfm xem c\u00f3 bao nhi\u00eau chu\u1ed7i c\u00f3 \u0111\u1ed9 d\u00e0i $n$ t\u1ed3n t\u1ea1i ch\u1ec9 bao g\u1ed3m c\u00e1c s\u1ed1 $0,1,2$ sao cho m\u1ed7i s\u1ed1 xu\u1ea5t hi\u1ec7n \u00edt nh\u1ea5t m\u1ed9t l\u1ea7n.</p> <p>M\u1ed9t l\u1ea7n n\u1eefa, ch\u00fang ta h\u00e3y chuy\u1ec3n sang b\u00e0i to\u00e1n ngh\u1ecbch \u0111\u1ea3o, t\u1ee9c l\u00e0 ch\u00fang ta t\u00ednh s\u1ed1 l\u01b0\u1ee3ng chu\u1ed7i kh\u00f4ng ch\u1ee9a \u00edt nh\u1ea5t m\u1ed9t trong c\u00e1c s\u1ed1.</p> <p>H\u00e3y k\u00fd hi\u1ec7u $A_i (i = 0,1,2)$ l\u00e0 t\u1eadp h\u1ee3p c\u00e1c chu\u1ed7i trong \u0111\u00f3 ch\u1eef s\u1ed1 $i$ kh\u00f4ng x\u1ea3y ra. C\u00f4ng th\u1ee9c bao h\u00e0m-lo\u1ea1i tr\u1eeb tr\u00ean s\u1ed1 l\u01b0\u1ee3ng chu\u1ed7i \"x\u1ea5u\" s\u1ebd l\u00e0:</p> $$ |A_0 \\cup A_1 \\cup A_2| = |A_0| + |A_1| + |A_2| - |A_0 \\cap A_1| - |A_0 \\cap A_2| - |A_1 \\cap A_2| + |A_0 \\cap A_1 \\cap A_2| $$ <ul> <li>K\u00edch th\u01b0\u1edbc c\u1ee7a m\u1ed7i $A_i$ l\u00e0 $2^n$, v\u00ec m\u1ed7i chu\u1ed7i ch\u1ec9 c\u00f3 th\u1ec3 ch\u1ee9a hai trong c\u00e1c ch\u1eef s\u1ed1.</li> <li>K\u00edch th\u01b0\u1edbc c\u1ee7a m\u1ed7i giao \u0111i\u1ec3m t\u1eebng \u0111\u00f4i m\u1ed9t $A_i \\cap A_j$ b\u1eb1ng $1$, v\u00ec s\u1ebd ch\u1ec9 c\u00f3 m\u1ed9t ch\u1eef s\u1ed1 \u0111\u1ec3 x\u00e2y d\u1ef1ng chu\u1ed7i.</li> <li>K\u00edch th\u01b0\u1edbc c\u1ee7a giao \u0111i\u1ec3m c\u1ee7a t\u1ea5t c\u1ea3 ba t\u1eadp h\u1ee3p b\u1eb1ng $0$, v\u00ec s\u1ebd kh\u00f4ng c\u00f3 ch\u1eef s\u1ed1 n\u00e0o \u0111\u1ec3 x\u00e2y d\u1ef1ng chu\u1ed7i.</li> </ul> <p>V\u00ec ch\u00fang ta \u0111\u00e3 gi\u1ea3i quy\u1ebft b\u00e0i to\u00e1n ngh\u1ecbch \u0111\u1ea3o, ch\u00fang ta tr\u1eeb n\u00f3 kh\u1ecfi t\u1ed5ng s\u1ed1 $3^n$ chu\u1ed7i:</p> $$3^n - (3 \\cdot 2^n - 3 \\cdot 1 + 0)$$ <p></p>","tags":["Translated"]},{"location":"combinatorics/inclusion-exclusion.html#number-of-upper-bound-integer-sums","title":"S\u1ed1 l\u01b0\u1ee3ng nghi\u1ec7m nguy\u00ean c\u00f3 c\u1eadn tr\u00ean (Number of upper-bound integer sums)","text":"<p>Xem x\u00e9t ph\u01b0\u01a1ng tr\u00ecnh sau:</p> $$x_1 + x_2 + x_3 + x_4 + x_5 + x_6 = 20$$ <p>trong \u0111\u00f3 $0 \\le x_i \\le 8 ~ (i = 1,2,\\ldots 6)$.</p> <p>Nhi\u1ec7m v\u1ee5: \u0111\u1ebfm s\u1ed1 l\u01b0\u1ee3ng nghi\u1ec7m c\u1ee7a ph\u01b0\u01a1ng tr\u00ecnh.</p> <p>Qu\u00ean h\u1ea1n ch\u1ebf v\u1ec1 $x_i$ trong gi\u00e2y l\u00e1t v\u00e0 ch\u1ec9 \u0111\u1ebfm s\u1ed1 l\u01b0\u1ee3ng nghi\u1ec7m kh\u00f4ng \u00e2m cho ph\u01b0\u01a1ng tr\u00ecnh n\u00e0y. \u0110i\u1ec1u n\u00e0y d\u1ec5 d\u00e0ng \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng Ph\u01b0\u01a1ng ph\u00e1p Ng\u00f4i sao v\u00e0 V\u00e1ch ng\u0103n: ch\u00fang ta mu\u1ed1n chia m\u1ed9t chu\u1ed7i $20$ \u0111\u01a1n v\u1ecb th\u00e0nh $6$ nh\u00f3m, \u0111i\u1ec1u n\u00e0y gi\u1ed1ng nh\u01b0 s\u1eafp x\u1ebfp $5$ v\u00e1ch ng\u0103n v\u00e0 $20$ ng\u00f4i sao:</p> $$N_0 = \\binom{25}{5}$$ <p>B\u00e2y gi\u1edd ch\u00fang ta s\u1ebd t\u00ednh to\u00e1n s\u1ed1 l\u01b0\u1ee3ng nghi\u1ec7m \"x\u1ea5u\" v\u1edbi nguy\u00ean l\u00fd bao h\u00e0m-lo\u1ea1i tr\u1eeb. C\u00e1c nghi\u1ec7m \"x\u1ea5u\" s\u1ebd l\u00e0 nh\u1eefng nghi\u1ec7m trong \u0111\u00f3 m\u1ed9t ho\u1eb7c nhi\u1ec1u $x_i$ l\u1edbn h\u01a1n ho\u1eb7c b\u1eb1ng $9$.</p> <p>K\u00fd hi\u1ec7u $A_k ~ (k = 1,2\\ldots 6)$ l\u00e0 t\u1eadp h\u1ee3p c\u00e1c nghi\u1ec7m trong \u0111\u00f3 $x_k \\ge 9$, v\u00e0 t\u1ea5t c\u1ea3 c\u00e1c $x_i \\ge 0 ~ (i \\ne k)$ kh\u00e1c (ch\u00fang c\u00f3 th\u1ec3 $\\ge 9$ ho\u1eb7c kh\u00f4ng). \u0110\u1ec3 t\u00ednh k\u00edch th\u01b0\u1edbc c\u1ee7a $A_k$, l\u01b0u \u00fd r\u1eb1ng v\u1ec1 c\u01a1 b\u1ea3n ch\u00fang ta c\u00f3 c\u00f9ng m\u1ed9t b\u00e0i to\u00e1n t\u1ed5 h\u1ee3p \u0111\u00e3 \u0111\u01b0\u1ee3c gi\u1ea3i quy\u1ebft trong hai \u0111o\u1ea1n tr\u00ean, nh\u01b0ng b\u00e2y gi\u1edd $9$ \u0111\u01a1n v\u1ecb b\u1ecb lo\u1ea1i kh\u1ecfi c\u00e1c khe v\u00e0 ch\u1eafc ch\u1eafn thu\u1ed9c v\u1ec1 nh\u00f3m \u0111\u1ea7u ti\u00ean. V\u00ec v\u1eady:</p> $$ | A_k | = \\binom{16}{5} $$ <p>T\u01b0\u01a1ng t\u1ef1, k\u00edch th\u01b0\u1edbc c\u1ee7a giao \u0111i\u1ec3m gi\u1eefa hai t\u1eadp h\u1ee3p $A_k$ v\u00e0 $A_p$ (cho $k \\ne p$) b\u1eb1ng:</p> $$ \\left| A_k \\cap A_p \\right| = \\binom{7}{5}$$ <p>K\u00edch th\u01b0\u1edbc c\u1ee7a m\u1ed7i giao \u0111i\u1ec3m c\u1ee7a ba t\u1eadp h\u1ee3p l\u00e0 kh\u00f4ng, v\u00ec $20$ \u0111\u01a1n v\u1ecb s\u1ebd kh\u00f4ng \u0111\u1ee7 cho ba ho\u1eb7c nhi\u1ec1u bi\u1ebfn l\u1edbn h\u01a1n ho\u1eb7c b\u1eb1ng $9$.</p> <p>K\u1ebft h\u1ee3p t\u1ea5t c\u1ea3 nh\u1eefng \u0111i\u1ec1u n\u00e0y v\u00e0o c\u00f4ng th\u1ee9c bao h\u00e0m-lo\u1ea1i tr\u1eeb v\u00e0 cho bi\u1ebft ch\u00fang ta \u0111\u00e3 gi\u1ea3i quy\u1ebft b\u00e0i to\u00e1n ngh\u1ecbch \u0111\u1ea3o, cu\u1ed1i c\u00f9ng ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c c\u00e2u tr\u1ea3 l\u1eddi:</p> $$\\binom{25}{5} - \\left(\\binom{6}{1} \\cdot \\binom{16}{5} - \\binom{6}{2} \\cdot \\binom{7}{5}\\right) $$ <p>\u0110i\u1ec1u n\u00e0y d\u1ec5 d\u00e0ng t\u1ed5ng qu\u00e1t cho $d$ s\u1ed1 c\u00f3 t\u1ed5ng b\u1eb1ng $s$ v\u1edbi gi\u1edbi h\u1ea1n $0 \\le x_i \\le b$:</p> $$\\sum_{i=0}^d (-1)^i \\binom{d}{i} \\binom{s+d-1-(b+1)i}{d-1}$$ <p>Nh\u01b0 tr\u00ean, ch\u00fang ta coi c\u00e1c h\u1ec7 s\u1ed1 nh\u1ecb th\u1ee9c c\u00f3 ch\u1ec9 s\u1ed1 tr\u00ean \u00e2m l\u00e0 kh\u00f4ng.</p> <p>L\u01b0u \u00fd b\u00e0i to\u00e1n n\u00e0y c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i quy\u1ebft b\u1eb1ng quy ho\u1ea1ch \u0111\u1ed9ng ho\u1eb7c h\u00e0m sinh. C\u00e2u tr\u1ea3 l\u1eddi bao h\u00e0m-lo\u1ea1i tr\u1eeb \u0111\u01b0\u1ee3c t\u00ednh trong th\u1eddi gian $O(d)$ (gi\u1ea3 s\u1eed c\u00e1c ph\u00e9p to\u00e1n nh\u01b0 h\u1ec7 s\u1ed1 nh\u1ecb th\u1ee9c l\u00e0 th\u1eddi gian h\u1eb1ng s\u1ed1), trong khi ph\u01b0\u01a1ng ph\u00e1p DP \u0111\u01a1n gi\u1ea3n s\u1ebd m\u1ea5t th\u1eddi gian $O(ds)$.</p>","tags":["Translated"]},{"location":"combinatorics/inclusion-exclusion.html#the-number-of-relative-primes-in-a-given-interval","title":"S\u1ed1 l\u01b0\u1ee3ng s\u1ed1 nguy\u00ean t\u1ed1 c\u00f9ng nhau trong m\u1ed9t kho\u1ea3ng nh\u1ea5t \u0111\u1ecbnh (The number of relative primes in a given interval)","text":"<p>Nhi\u1ec7m v\u1ee5: cho hai s\u1ed1 $n$ v\u00e0 $r$, \u0111\u1ebfm s\u1ed1 l\u01b0\u1ee3ng s\u1ed1 nguy\u00ean trong kho\u1ea3ng $[1;r]$ nguy\u00ean t\u1ed1 c\u00f9ng nhau v\u1edbi n (\u01b0\u1edbc chung l\u1edbn nh\u1ea5t c\u1ee7a ch\u00fang l\u00e0 $1$).</p> <p>H\u00e3y gi\u1ea3i b\u00e0i to\u00e1n ngh\u1ecbch \u0111\u1ea3o - \u0111\u1ebfm s\u1ed1 l\u01b0\u1ee3ng s\u1ed1 kh\u00f4ng nguy\u00ean t\u1ed1 c\u00f9ng nhau v\u1edbi $n$.</p> <p>Ch\u00fang ta s\u1ebd k\u00fd hi\u1ec7u c\u00e1c th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1 c\u1ee7a $n$ l\u00e0 $p_i (i = 1\\cdots k)$.</p> <p>C\u00f3 bao nhi\u00eau s\u1ed1 trong kho\u1ea3ng $[1;r]$ chia h\u1ebft cho $p_i$? C\u00e2u tr\u1ea3 l\u1eddi cho c\u00e2u h\u1ecfi n\u00e0y l\u00e0:</p> $$ \\left\\lfloor \\frac{ r }{ p_i } \\right\\rfloor $$ <p>Tuy nhi\u00ean, n\u1ebfu ch\u00fang ta ch\u1ec9 \u0111\u01a1n gi\u1ea3n c\u1ed9ng c\u00e1c s\u1ed1 n\u00e0y, m\u1ed9t s\u1ed1 s\u1ed1 s\u1ebd \u0111\u01b0\u1ee3c t\u1ed5ng h\u1ee3p nhi\u1ec1u l\u1ea7n (nh\u1eefng s\u1ed1 chia s\u1ebb nhi\u1ec1u $p_i$ l\u00e0m th\u1eeba s\u1ed1 c\u1ee7a ch\u00fang). Do \u0111\u00f3, c\u1ea7n thi\u1ebft ph\u1ea3i s\u1eed d\u1ee5ng nguy\u00ean l\u00fd bao h\u00e0m-lo\u1ea1i tr\u1eeb.</p> <p>Ch\u00fang ta s\u1ebd l\u1eb7p qua t\u1ea5t c\u1ea3 $2^k$ t\u1eadp con c\u1ee7a $p_i$, t\u00ednh t\u00edch c\u1ee7a ch\u00fang v\u00e0 c\u1ed9ng ho\u1eb7c tr\u1eeb s\u1ed1 l\u01b0\u1ee3ng b\u1ed9i s\u1ed1 c\u1ee7a t\u00edch c\u1ee7a ch\u00fang.</p> <p>\u0110\u00e2y l\u00e0 m\u1ed9t c\u00e0i \u0111\u1eb7t C++:</p> <pre><code>int solve (int n, int r) {\n    vector&lt;int&gt; p;\n    for (int i=2; i*i&lt;=n; ++i)\n        if (n % i == 0) {\n            p.push_back (i);\n            while (n % i == 0)\n                n /= i;\n        }\n    if (n &gt; 1)\n        p.push_back (n);\n\n    int sum = 0;\n    for (int msk=1; msk&lt;(1&lt;&lt;p.size()); ++msk) {\n        int mult = 1,\n            bits = 0;\n        for (int i=0; i&lt;(int)p.size(); ++i)\n            if (msk &amp; (1&lt;&lt;i)) {\n                ++bits;\n                mult *= p[i];\n            }\n\n        int cur = r / mult;\n        if (bits % 2 == 1)\n            sum += cur;\n        else\n            sum -= cur;\n    }\n\n    return r - sum;\n}\n</code></pre> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p ti\u1ec7m c\u1eadn c\u1ee7a gi\u1ea3i ph\u00e1p l\u00e0 $O (\\sqrt{n})$.</p>","tags":["Translated"]},{"location":"combinatorics/inclusion-exclusion.html#the-number-of-integers-in-a-given-interval-which-are-multiple-of-at-least-one-of-the-given-numbers","title":"S\u1ed1 l\u01b0\u1ee3ng s\u1ed1 nguy\u00ean trong m\u1ed9t kho\u1ea3ng nh\u1ea5t \u0111\u1ecbnh l\u00e0 b\u1ed9i s\u1ed1 c\u1ee7a \u00edt nh\u1ea5t m\u1ed9t trong c\u00e1c s\u1ed1 \u0111\u00e3 cho (The number of integers in a given interval which are multiple of at least one of the given numbers)","text":"<p>Cho $n$ s\u1ed1 $a_i$ v\u00e0 s\u1ed1 $r$. B\u1ea1n mu\u1ed1n \u0111\u1ebfm s\u1ed1 l\u01b0\u1ee3ng s\u1ed1 nguy\u00ean trong kho\u1ea3ng $[1; r]$ l\u00e0 b\u1ed9i s\u1ed1 c\u1ee7a \u00edt nh\u1ea5t m\u1ed9t trong c\u00e1c $a_i$.</p> <p>Thu\u1eadt to\u00e1n gi\u1ea3i quy\u1ebft g\u1ea7n nh\u01b0 gi\u1ed1ng h\u1ec7t v\u1edbi thu\u1eadt to\u00e1n cho nhi\u1ec7m v\u1ee5 tr\u01b0\u1edbc \u2014 x\u00e2y d\u1ef1ng c\u00f4ng th\u1ee9c bao h\u00e0m-lo\u1ea1i tr\u1eeb tr\u00ean c\u00e1c s\u1ed1 $a_i$, t\u1ee9c l\u00e0 m\u1ed7i s\u1ed1 h\u1ea1ng trong c\u00f4ng th\u1ee9c n\u00e0y l\u00e0 s\u1ed1 l\u01b0\u1ee3ng c\u00e1c s\u1ed1 chia h\u1ebft cho m\u1ed9t t\u1eadp h\u1ee3p con nh\u1ea5t \u0111\u1ecbnh c\u1ee7a c\u00e1c s\u1ed1 $a_i$ (n\u00f3i c\u00e1ch kh\u00e1c, chia h\u1ebft cho b\u1ed9i chung nh\u1ecf nh\u1ea5t c\u1ee7a ch\u00fang).</p> <p>V\u00ec v\u1eady b\u00e2y gi\u1edd ch\u00fang ta s\u1ebd l\u1eb7p qua t\u1ea5t c\u1ea3 $2^n$ t\u1eadp con c\u1ee7a c\u00e1c s\u1ed1 nguy\u00ean $a_i$ v\u1edbi $O(n \\log r)$ ph\u00e9p to\u00e1n \u0111\u1ec3 t\u00ecm b\u1ed9i chung nh\u1ecf nh\u1ea5t c\u1ee7a ch\u00fang, c\u1ed9ng ho\u1eb7c tr\u1eeb s\u1ed1 l\u01b0\u1ee3ng b\u1ed9i s\u1ed1 c\u1ee7a n\u00f3 trong kho\u1ea3ng. \u0110\u1ed9 ph\u1ee9c t\u1ea1p ti\u1ec7m c\u1eadn l\u00e0 $O (2^n\\cdot n\\cdot \\log r)$.</p>","tags":["Translated"]},{"location":"combinatorics/inclusion-exclusion.html#the-number-of-strings-that-satisfy-a-given-pattern","title":"S\u1ed1 l\u01b0\u1ee3ng chu\u1ed7i th\u1ecfa m\u00e3n m\u1ed9t m\u1eabu \u0111\u00e3 cho (The number of strings that satisfy a given pattern)","text":"<p>Xem x\u00e9t $n$ m\u1eabu chu\u1ed7i c\u00f3 c\u00f9ng \u0111\u1ed9 d\u00e0i, ch\u1ec9 bao g\u1ed3m c\u00e1c ch\u1eef c\u00e1i ($a...z$) ho\u1eb7c d\u1ea5u h\u1ecfi. B\u1ea1n c\u0169ng \u0111\u01b0\u1ee3c cho m\u1ed9t s\u1ed1 $k$. M\u1ed9t chu\u1ed7i kh\u1edbp v\u1edbi m\u1ed9t m\u1eabu n\u1ebfu n\u00f3 c\u00f3 c\u00f9ng \u0111\u1ed9 d\u00e0i v\u1edbi m\u1eabu, v\u00e0 t\u1ea1i m\u1ed7i v\u1ecb tr\u00ed, ho\u1eb7c c\u00e1c k\u00fd t\u1ef1 t\u01b0\u01a1ng \u1ee9ng b\u1eb1ng nhau ho\u1eb7c k\u00fd t\u1ef1 trong m\u1eabu l\u00e0 m\u1ed9t d\u1ea5u h\u1ecfi. Nhi\u1ec7m v\u1ee5 l\u00e0 \u0111\u1ebfm s\u1ed1 l\u01b0\u1ee3ng chu\u1ed7i kh\u1edbp ch\u00ednh x\u00e1c $k$ m\u1eabu (b\u00e0i to\u00e1n \u0111\u1ea7u ti\u00ean) v\u00e0 \u00edt nh\u1ea5t $k$ m\u1eabu (b\u00e0i to\u00e1n th\u1ee9 hai).</p> <p>L\u01b0u \u00fd tr\u01b0\u1edbc ti\u00ean r\u1eb1ng ch\u00fang ta c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng \u0111\u1ebfm s\u1ed1 l\u01b0\u1ee3ng chu\u1ed7i th\u1ecfa m\u00e3n c\u00f9ng m\u1ed9t l\u00fac t\u1ea5t c\u1ea3 c\u00e1c m\u1eabu \u0111\u00e3 ch\u1ec9 \u0111\u1ecbnh. \u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y, ch\u1ec9 c\u1ea7n \"ch\u00e9o\" c\u00e1c m\u1eabu: l\u1eb7p qua c\u00e1c v\u1ecb tr\u00ed (\"khe\") v\u00e0 nh\u00ecn v\u00e0o m\u1ed9t v\u1ecb tr\u00ed tr\u00ean t\u1ea5t c\u1ea3 c\u00e1c m\u1eabu. N\u1ebfu t\u1ea5t c\u1ea3 c\u00e1c m\u1eabu \u0111\u1ec1u c\u00f3 d\u1ea5u h\u1ecfi \u1edf v\u1ecb tr\u00ed n\u00e0y, k\u00fd t\u1ef1 c\u00f3 th\u1ec3 l\u00e0 b\u1ea5t k\u1ef3 ch\u1eef c\u00e1i n\u00e0o t\u1eeb $a$ \u0111\u1ebfn $z$. Ng\u01b0\u1ee3c l\u1ea1i, k\u00fd t\u1ef1 c\u1ee7a v\u1ecb tr\u00ed n\u00e0y \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh duy nh\u1ea5t b\u1edfi c\u00e1c m\u1eabu kh\u00f4ng ch\u1ee9a d\u1ea5u h\u1ecfi.</p> <p>B\u00e2y gi\u1edd h\u00e3y t\u00ecm hi\u1ec3u \u0111\u1ec3 gi\u1ea3i quy\u1ebft phi\u00ean b\u1ea3n \u0111\u1ea7u ti\u00ean c\u1ee7a b\u00e0i to\u00e1n: khi chu\u1ed7i ph\u1ea3i th\u1ecfa m\u00e3n ch\u00ednh x\u00e1c $k$ m\u1eabu.</p> <p>\u0110\u1ec3 gi\u1ea3i quy\u1ebft n\u00f3, l\u1eb7p l\u1ea1i v\u00e0 c\u1ed1 \u0111\u1ecbnh m\u1ed9t t\u1eadp h\u1ee3p con c\u1ee5 th\u1ec3 $X$ t\u1eeb t\u1eadp h\u1ee3p c\u00e1c m\u1eabu bao g\u1ed3m $k$ m\u1eabu. Sau \u0111\u00f3 ch\u00fang ta ph\u1ea3i \u0111\u1ebfm s\u1ed1 l\u01b0\u1ee3ng chu\u1ed7i th\u1ecfa m\u00e3n t\u1eadp h\u1ee3p m\u1eabu n\u00e0y, v\u00e0 ch\u1ec9 kh\u1edbp v\u1edbi n\u00f3, ngh\u0129a l\u00e0, ch\u00fang kh\u00f4ng kh\u1edbp v\u1edbi b\u1ea5t k\u1ef3 m\u1eabu n\u00e0o kh\u00e1c. Ch\u00fang ta s\u1ebd s\u1eed d\u1ee5ng nguy\u00ean l\u00fd bao h\u00e0m-lo\u1ea1i tr\u1eeb theo m\u1ed9t c\u00e1ch h\u01a1i kh\u00e1c: ch\u00fang ta t\u00ednh t\u1ed5ng tr\u00ean t\u1ea5t c\u1ea3 c\u00e1c t\u1eadp cha $Y$ (t\u1eadp h\u1ee3p con t\u1eeb t\u1eadp h\u1ee3p chu\u1ed7i ban \u0111\u1ea7u ch\u1ee9a $X$), v\u00e0 ho\u1eb7c c\u1ed9ng v\u00e0o c\u00e2u tr\u1ea3 l\u1eddi hi\u1ec7n t\u1ea1i ho\u1eb7c tr\u1eeb n\u00f3 kh\u1ecfi s\u1ed1 l\u01b0\u1ee3ng chu\u1ed7i:</p> $$ ans(X) = \\sum_{Y \\supseteq X} (-1)^{|Y|-k} \\cdot f(Y) $$ <p>Trong \u0111\u00f3 $f(Y)$ l\u00e0 s\u1ed1 l\u01b0\u1ee3ng chu\u1ed7i kh\u1edbp $Y$ (\u00edt nh\u1ea5t $Y$).</p> <p>(N\u1ebfu b\u1ea1n g\u1eb7p kh\u00f3 kh\u0103n trong vi\u1ec7c t\u00ecm ra \u0111i\u1ec1u n\u00e0y, b\u1ea1n c\u00f3 th\u1ec3 th\u1eed v\u1ebd Bi\u1ec3u \u0111\u1ed3 Venn.)</p> <p>N\u1ebfu ch\u00fang ta t\u00ednh t\u1ed5ng tr\u00ean t\u1ea5t c\u1ea3 $ans(X)$, ch\u00fang ta s\u1ebd nh\u1eadn \u0111\u01b0\u1ee3c c\u00e2u tr\u1ea3 l\u1eddi cu\u1ed1i c\u00f9ng:</p> $$ ans = \\sum_{X ~ : ~ |X| = k} ans(X) $$ <p>Tuy nhi\u00ean, \u0111\u1ed9 ph\u1ee9c t\u1ea1p ti\u1ec7m c\u1eadn c\u1ee7a gi\u1ea3i ph\u00e1p n\u00e0y l\u00e0 $O(3^k \\cdot k)$. \u0110\u1ec3 c\u1ea3i thi\u1ec7n n\u00f3, h\u00e3y l\u01b0u \u00fd r\u1eb1ng c\u00e1c t\u00ednh to\u00e1n $ans(X)$ kh\u00e1c nhau th\u01b0\u1eddng chia s\u1ebb c\u00e1c t\u1eadp h\u1ee3p $Y$.</p> <p>Ch\u00fang ta s\u1ebd \u0111\u1ea3o ng\u01b0\u1ee3c c\u00f4ng th\u1ee9c bao h\u00e0m-lo\u1ea1i tr\u1eeb v\u00e0 t\u00ednh t\u1ed5ng theo c\u00e1c t\u1eadp h\u1ee3p $Y$. B\u00e2y gi\u1edd tr\u1edf n\u00ean r\u00f5 r\u00e0ng r\u1eb1ng c\u00f9ng m\u1ed9t t\u1eadp h\u1ee3p $Y$ s\u1ebd \u0111\u01b0\u1ee3c t\u00ednh \u0111\u1ebfn trong t\u00ednh to\u00e1n $ans(X)$ c\u1ee7a $\\binom{|Y|}{k}$ t\u1eadp h\u1ee3p c\u00f3 c\u00f9ng d\u1ea5u $(-1)^{|Y| - k}$.</p> $$ ans = \\sum_{Y ~ : ~ |Y| \\ge k} (-1)^{|Y|-k} \\cdot \\binom{|Y|}{k} \\cdot f(Y) $$ <p>B\u00e2y gi\u1edd gi\u1ea3i ph\u00e1p c\u1ee7a ch\u00fang ta c\u00f3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p ti\u1ec7m c\u1eadn $O(2^k \\cdot k)$.</p> <p>B\u00e2y gi\u1edd ch\u00fang ta s\u1ebd gi\u1ea3i quy\u1ebft phi\u00ean b\u1ea3n th\u1ee9 hai c\u1ee7a b\u00e0i to\u00e1n: t\u00ecm s\u1ed1 l\u01b0\u1ee3ng chu\u1ed7i kh\u1edbp \u00edt nh\u1ea5t $k$ m\u1eabu.</p> <p>T\u1ea5t nhi\u00ean, ch\u00fang ta ch\u1ec9 c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng gi\u1ea3i ph\u00e1p cho phi\u00ean b\u1ea3n \u0111\u1ea7u ti\u00ean c\u1ee7a b\u00e0i to\u00e1n v\u00e0 c\u1ed9ng c\u00e1c c\u00e2u tr\u1ea3 l\u1eddi cho c\u00e1c t\u1eadp h\u1ee3p c\u00f3 k\u00edch th\u01b0\u1edbc l\u1edbn h\u01a1n $k$. Tuy nhi\u00ean, b\u1ea1n c\u00f3 th\u1ec3 nh\u1eadn th\u1ea5y r\u1eb1ng trong b\u00e0i to\u00e1n n\u00e0y, m\u1ed9t t\u1eadp h\u1ee3p |Y| \u0111\u01b0\u1ee3c xem x\u00e9t trong c\u00f4ng th\u1ee9c cho t\u1ea5t c\u1ea3 c\u00e1c t\u1eadp h\u1ee3p c\u00f3 k\u00edch th\u01b0\u1edbc $\\ge k$ ch\u1ee9a trong $Y$. \u0110i\u1ec1u \u0111\u00f3 cho bi\u1ebft, ch\u00fang ta c\u00f3 th\u1ec3 vi\u1ebft ph\u1ea7n c\u1ee7a bi\u1ec3u th\u1ee9c \u0111ang \u0111\u01b0\u1ee3c nh\u00e2n v\u1edbi $f(Y)$ l\u00e0:</p> $$ (-1)^{|Y|-k} \\cdot \\binom{|Y|}{k} + (-1)^{|Y|-k-1} \\cdot \\binom{|Y|}{k+1} + (-1)^{|Y|-k-2} \\cdot \\binom{|Y|}{k+2} + \\cdots + (-1)^{|Y|-|Y|} \\cdot \\binom{|Y|}{|Y|} $$ <p>Nh\u00ecn v\u00e0o Graham's (Graham, Knuth, Patashnik. \"Concrete mathematics\" [1998] ), ch\u00fang ta th\u1ea5y m\u1ed9t c\u00f4ng th\u1ee9c n\u1ed5i ti\u1ebfng cho h\u1ec7 s\u1ed1 nh\u1ecb th\u1ee9c:</p> $$ \\sum_{k=0}^m (-1)^k \\cdot \\binom{n}{k} = (-1)^m \\cdot \\binom{n-1}{m} $$ <p>\u00c1p d\u1ee5ng n\u00f3 \u1edf \u0111\u00e2y, ch\u00fang ta th\u1ea5y r\u1eb1ng to\u00e0n b\u1ed9 t\u1ed5ng c\u1ee7a c\u00e1c h\u1ec7 s\u1ed1 nh\u1ecb th\u1ee9c \u0111\u01b0\u1ee3c gi\u1ea3m thi\u1ec3u:</p> $$ (-1)^{|Y|-k} \\cdot \\binom{|Y|-1}{|Y|-k} $$ <p>Do \u0111\u00f3, \u0111\u1ed1i v\u1edbi nhi\u1ec7m v\u1ee5 n\u00e0y, ch\u00fang t\u00f4i c\u0169ng \u0111\u00e3 thu \u0111\u01b0\u1ee3c m\u1ed9t gi\u1ea3i ph\u00e1p v\u1edbi \u0111\u1ed9 ph\u1ee9c t\u1ea1p ti\u1ec7m c\u1eadn $O(2^k \\cdot k)$:</p> $$ ans = \\sum_{Y ~ : ~ |Y| \\ge k} (-1)^{|Y|-k} \\cdot \\binom{|Y|-1}{|Y|-k} \\cdot f(Y) $$","tags":["Translated"]},{"location":"combinatorics/inclusion-exclusion.html#the-number-of-ways-of-going-from-a-cell-to-another","title":"S\u1ed1 c\u00e1ch \u0111i t\u1eeb m\u1ed9t \u00f4 \u0111\u1ebfn \u00f4 kh\u00e1c (The number of ways of going from a cell to another)","text":"<p>C\u00f3 m\u1ed9t tr\u01b0\u1eddng $n \\times m$, v\u00e0 $k$ \u00f4 c\u1ee7a n\u00f3 l\u00e0 nh\u1eefng b\u1ee9c t\u01b0\u1eddng kh\u00f4ng th\u1ec3 v\u01b0\u1ee3t qua. M\u1ed9t robot ban \u0111\u1ea7u \u1edf \u00f4 $(1,1)$ (d\u01b0\u1edbi c\u00f9ng b\u00ean tr\u00e1i). Robot ch\u1ec9 c\u00f3 th\u1ec3 di chuy\u1ec3n sang ph\u1ea3i ho\u1eb7c l\u00ean tr\u00ean, v\u00e0 cu\u1ed1i c\u00f9ng n\u00f3 c\u1ea7n ph\u1ea3i v\u00e0o \u00f4 $(n,m)$, tr\u00e1nh t\u1ea5t c\u1ea3 c\u00e1c ch\u01b0\u1edbng ng\u1ea1i v\u1eadt. B\u1ea1n c\u1ea7n \u0111\u1ebfm s\u1ed1 c\u00e1ch anh ta c\u00f3 th\u1ec3 l\u00e0m \u0111i\u1ec1u \u0111\u00f3.</p> <p>Gi\u1ea3 s\u1eed r\u1eb1ng k\u00edch th\u01b0\u1edbc $n$ v\u00e0 $m$ r\u1ea5t l\u1edbn (gi\u1ea3 s\u1eed, $10^9$), v\u00e0 s\u1ed1 l\u01b0\u1ee3ng $k$ nh\u1ecf (kho\u1ea3ng $100$).</p> <p>B\u00e2y gi\u1edd, h\u00e3y s\u1eafp x\u1ebfp c\u00e1c ch\u01b0\u1edbng ng\u1ea1i v\u1eadt theo t\u1ecda \u0111\u1ed9 $x$ c\u1ee7a ch\u00fang, v\u00e0 trong tr\u01b0\u1eddng h\u1ee3p b\u1eb1ng nhau \u2014 t\u1ecda \u0111\u1ed9 $y$.</p> <p>C\u0169ng ch\u1ec9 c\u1ea7n h\u1ecdc c\u00e1ch gi\u1ea3i quy\u1ebft m\u1ed9t b\u00e0i to\u00e1n kh\u00f4ng c\u00f3 ch\u01b0\u1edbng ng\u1ea1i v\u1eadt: t\u1ee9c l\u00e0 h\u1ecdc c\u00e1ch \u0111\u1ebfm s\u1ed1 c\u00e1ch \u0111\u1ec3 \u0111i t\u1eeb \u00f4 n\u00e0y sang \u00f4 kh\u00e1c. Trong m\u1ed9t tr\u1ee5c, ch\u00fang ta c\u1ea7n \u0111i qua $x$ \u00f4, v\u00e0 tr\u00ean tr\u1ee5c kia, $y$ \u00f4. T\u1eeb t\u1ed5 h\u1ee3p \u0111\u01a1n gi\u1ea3n, ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c m\u1ed9t c\u00f4ng th\u1ee9c s\u1eed d\u1ee5ng h\u1ec7 s\u1ed1 nh\u1ecb th\u1ee9c:</p> $$\\binom{x+y}{x}$$ <p>B\u00e2y gi\u1edd \u0111\u1ec3 \u0111\u1ebfm s\u1ed1 c\u00e1ch \u0111\u1ec3 \u0111i t\u1eeb \u00f4 n\u00e0y sang \u00f4 kh\u00e1c, tr\u00e1nh t\u1ea5t c\u1ea3 c\u00e1c ch\u01b0\u1edbng ng\u1ea1i v\u1eadt, b\u1ea1n c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng bao h\u00e0m-lo\u1ea1i tr\u1eeb \u0111\u1ec3 gi\u1ea3i b\u00e0i to\u00e1n ngh\u1ecbch \u0111\u1ea3o: \u0111\u1ebfm s\u1ed1 c\u00e1ch \u0111i qua b\u1ea3ng b\u01b0\u1edbc v\u00e0o m\u1ed9t t\u1eadp h\u1ee3p con c\u00e1c ch\u01b0\u1edbng ng\u1ea1i v\u1eadt (v\u00e0 tr\u1eeb n\u00f3 kh\u1ecfi t\u1ed5ng s\u1ed1 c\u00e1ch).</p> <p>Khi l\u1eb7p qua m\u1ed9t t\u1eadp h\u1ee3p con c\u00e1c ch\u01b0\u1edbng ng\u1ea1i v\u1eadt m\u00e0 ch\u00fang ta s\u1ebd b\u01b0\u1edbc v\u00e0o, \u0111\u1ec3 \u0111\u1ebfm s\u1ed1 c\u00e1ch l\u00e0m \u0111i\u1ec1u n\u00e0y ch\u1ec9 c\u1ea7n nh\u00e2n s\u1ed1 l\u01b0\u1ee3ng t\u1ea5t c\u1ea3 c\u00e1c \u0111\u01b0\u1eddng \u0111i t\u1eeb \u00f4 b\u1eaft \u0111\u1ea7u \u0111\u1ebfn ch\u01b0\u1edbng ng\u1ea1i v\u1eadt \u0111\u1ea7u ti\u00ean trong s\u1ed1 c\u00e1c ch\u01b0\u1edbng ng\u1ea1i v\u1eadt \u0111\u00e3 ch\u1ecdn, ch\u01b0\u1edbng ng\u1ea1i v\u1eadt \u0111\u1ea7u ti\u00ean \u0111\u1ebfn th\u1ee9 hai, v.v., v\u00e0 sau \u0111\u00f3 c\u1ed9ng ho\u1eb7c tr\u1eeb s\u1ed1 n\u00e0y kh\u1ecfi c\u00e2u tr\u1ea3 l\u1eddi, theo c\u00f4ng th\u1ee9c chu\u1ea9n c\u1ee7a bao h\u00e0m-lo\u1ea1i tr\u1eeb.</p> <p>Tuy nhi\u00ean, \u0111i\u1ec1u n\u00e0y m\u1ed9t l\u1ea7n n\u1eefa s\u1ebd kh\u00f4ng ph\u1ea3i l\u00e0 \u0111a th\u1ee9c v\u1ec1 \u0111\u1ed9 ph\u1ee9c t\u1ea1p $O(2^k \\cdot k)$.</p> <p>\u0110\u00e2y l\u00e0 m\u1ed9t gi\u1ea3i ph\u00e1p \u0111a th\u1ee9c:</p> <p>Ch\u00fang ta s\u1ebd s\u1eed d\u1ee5ng quy ho\u1ea1ch \u0111\u1ed9ng. \u0110\u1ec3 thu\u1eadn ti\u1ec7n, \u0111\u1ea9y (1,1) v\u00e0o \u0111\u1ea7u v\u00e0 (n,m) v\u00e0o cu\u1ed1i m\u1ea3ng ch\u01b0\u1edbng ng\u1ea1i v\u1eadt. H\u00e3y t\u00ednh c\u00e1c s\u1ed1 $d[i]$ \u2014 s\u1ed1 c\u00e1ch \u0111\u1ec3 \u0111i t\u1eeb \u0111i\u1ec3m b\u1eaft \u0111\u1ea7u ($th\u1ee9 0$) \u0111\u1ebfn $th\u1ee9 i$, m\u00e0 kh\u00f4ng b\u01b0\u1edbc l\u00ean b\u1ea5t k\u1ef3 ch\u01b0\u1edbng ng\u1ea1i v\u1eadt n\u00e0o kh\u00e1c (ngo\u1ea1i tr\u1eeb $i$, t\u1ea5t nhi\u00ean). Ch\u00fang t\u00f4i s\u1ebd t\u00ednh s\u1ed1 n\u00e0y cho t\u1ea5t c\u1ea3 c\u00e1c \u00f4 ch\u01b0\u1edbng ng\u1ea1i v\u1eadt, v\u00e0 c\u1ea3 \u00f4 k\u1ebft th\u00fac n\u1eefa.</p> <p>H\u00e3y qu\u00ean \u0111i c\u00e1c ch\u01b0\u1edbng ng\u1ea1i v\u1eadt trong m\u1ed9t gi\u00e2y v\u00e0 ch\u1ec9 \u0111\u1ebfm s\u1ed1 l\u01b0\u1ee3ng \u0111\u01b0\u1eddng \u0111i t\u1eeb \u00f4 $0$ \u0111\u1ebfn $i$. Ch\u00fang ta c\u1ea7n xem x\u00e9t m\u1ed9t s\u1ed1 \u0111\u01b0\u1eddng \u0111i \"x\u1ea5u\", nh\u1eefng \u0111\u01b0\u1eddng \u0111i qua c\u00e1c ch\u01b0\u1edbng ng\u1ea1i v\u1eadt, v\u00e0 tr\u1eeb ch\u00fang kh\u1ecfi t\u1ed5ng s\u1ed1 c\u00e1ch \u0111i t\u1eeb $0$ \u0111\u1ebfn $i$.</p> <p>Khi xem x\u00e9t m\u1ed9t ch\u01b0\u1edbng ng\u1ea1i v\u1eadt $t$ gi\u1eefa $0$ v\u00e0 $i$ ($0 &lt; t &lt; i$), m\u00e0 ch\u00fang ta c\u00f3 th\u1ec3 b\u01b0\u1edbc l\u00ean, ch\u00fang ta th\u1ea5y r\u1eb1ng s\u1ed1 l\u01b0\u1ee3ng \u0111\u01b0\u1eddng \u0111i t\u1eeb $0$ \u0111\u1ebfn $i$ \u0111i qua $t$ c\u00f3 $t$ l\u00e0 ch\u01b0\u1edbng ng\u1ea1i v\u1eadt \u0111\u1ea7u ti\u00ean gi\u1eefa b\u1eaft \u0111\u1ea7u v\u00e0 $i$. Ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh \u0111i\u1ec1u \u0111\u00f3 l\u00e0: $d[t]$ nh\u00e2n v\u1edbi s\u1ed1 l\u01b0\u1ee3ng \u0111\u01b0\u1eddng \u0111i t\u00f9y \u00fd t\u1eeb $t$ \u0111\u1ebfn $i$. Ch\u00fang ta c\u00f3 th\u1ec3 \u0111\u1ebfm s\u1ed1 l\u01b0\u1ee3ng c\u00e1ch \"x\u1ea5u\" c\u1ed9ng t\u1ed5ng s\u1ed1 n\u00e0y cho t\u1ea5t c\u1ea3 $t$ gi\u1eefa $0$ v\u00e0 $i$.</p> <p>Ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh $d[i]$ trong $O(k)$ cho $O(k)$ ch\u01b0\u1edbng ng\u1ea1i v\u1eadt, v\u00ec v\u1eady gi\u1ea3i ph\u00e1p n\u00e0y c\u00f3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p $O(k^2)$.</p>","tags":["Translated"]},{"location":"combinatorics/inclusion-exclusion.html#the-number-of-coprime-quadruples","title":"S\u1ed1 l\u01b0\u1ee3ng b\u1ed9 b\u1ed1n nguy\u00ean t\u1ed1 c\u00f9ng nhau (The number of coprime quadruples)","text":"<p>B\u1ea1n \u0111\u01b0\u1ee3c cho $n$ s\u1ed1: $a_1, a_2, \\ldots, a_n$. B\u1ea1n \u0111\u01b0\u1ee3c y\u00eau c\u1ea7u \u0111\u1ebfm s\u1ed1 c\u00e1ch ch\u1ecdn b\u1ed1n s\u1ed1 sao cho \u01b0\u1edbc chung l\u1edbn nh\u1ea5t k\u1ebft h\u1ee3p c\u1ee7a ch\u00fang b\u1eb1ng m\u1ed9t.</p> <p>Ch\u00fang ta s\u1ebd gi\u1ea3i b\u00e0i to\u00e1n ngh\u1ecbch \u0111\u1ea3o \u2014 t\u00ednh s\u1ed1 l\u01b0\u1ee3ng b\u1ed9 b\u1ed1n \"x\u1ea5u\", t\u1ee9c l\u00e0 c\u00e1c b\u1ed9 b\u1ed1n trong \u0111\u00f3 t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 \u0111\u1ec1u chia h\u1ebft cho m\u1ed9t s\u1ed1 $d &gt; 1$.</p> <p>Ch\u00fang ta s\u1ebd s\u1eed d\u1ee5ng nguy\u00ean l\u00fd bao h\u00e0m-lo\u1ea1i tr\u1eeb trong khi t\u00ednh t\u1ed5ng tr\u00ean t\u1ea5t c\u1ea3 c\u00e1c nh\u00f3m b\u1ed1n s\u1ed1 c\u00f3 th\u1ec3 chia h\u1ebft cho m\u1ed9t \u01b0\u1edbc s\u1ed1 $d$.</p> $$ans = \\sum_{d \\ge 2} (-1)^{deg(d)-1} \\cdot f(d)$$ <p>trong \u0111\u00f3 $deg(d)$ l\u00e0 s\u1ed1 l\u01b0\u1ee3ng s\u1ed1 nguy\u00ean t\u1ed1 trong ph\u00e2n t\u00edch th\u1eeba s\u1ed1 c\u1ee7a s\u1ed1 $d$ v\u00e0 $f(d)$ s\u1ed1 l\u01b0\u1ee3ng b\u1ed9 b\u1ed1n chia h\u1ebft cho $d$.</p> <p>\u0110\u1ec3 t\u00ednh h\u00e0m $f(d)$, b\u1ea1n ch\u1ec9 c\u1ea7n \u0111\u1ebfm s\u1ed1 l\u01b0\u1ee3ng b\u1ed9i s\u1ed1 c\u1ee7a $d$ (nh\u01b0 \u0111\u00e3 \u0111\u1ec1 c\u1eadp trong m\u1ed9t nhi\u1ec7m v\u1ee5 tr\u01b0\u1edbc) v\u00e0 s\u1eed d\u1ee5ng h\u1ec7 s\u1ed1 nh\u1ecb th\u1ee9c \u0111\u1ec3 \u0111\u1ebfm s\u1ed1 c\u00e1ch ch\u1ecdn b\u1ed1n trong s\u1ed1 ch\u00fang.</p> <p>Do \u0111\u00f3, s\u1eed d\u1ee5ng c\u00f4ng th\u1ee9c bao h\u00e0m-lo\u1ea1i tr\u1eeb, ch\u00fang ta c\u1ed9ng s\u1ed1 l\u01b0\u1ee3ng c\u00e1c nh\u00f3m b\u1ed1n chia h\u1ebft cho m\u1ed9t s\u1ed1 nguy\u00ean t\u1ed1, sau \u0111\u00f3 tr\u1eeb \u0111i s\u1ed1 l\u01b0\u1ee3ng b\u1ed9 b\u1ed1n chia h\u1ebft cho t\u00edch c\u1ee7a hai s\u1ed1 nguy\u00ean t\u1ed1, c\u1ed9ng c\u00e1c b\u1ed9 b\u1ed1n chia h\u1ebft cho ba s\u1ed1 nguy\u00ean t\u1ed1, v.v.</p>","tags":["Translated"]},{"location":"combinatorics/inclusion-exclusion.html#the-number-of-harmonic-triplets","title":"S\u1ed1 l\u01b0\u1ee3ng b\u1ed9 ba h\u00e0i h\u00f2a (The number of harmonic triplets)","text":"<p>B\u1ea1n \u0111\u01b0\u1ee3c cho m\u1ed9t s\u1ed1 $n \\le 10^6$. B\u1ea1n \u0111\u01b0\u1ee3c y\u00eau c\u1ea7u \u0111\u1ebfm s\u1ed1 l\u01b0\u1ee3ng b\u1ed9 ba $2 \\le a &lt; b &lt; c \\le n$ th\u1ecfa m\u00e3n m\u1ed9t trong c\u00e1c \u0111i\u1ec1u ki\u1ec7n sau:</p> <ul> <li>ho\u1eb7c ${\\rm gcd}(a,b) = {\\rm gcd}(a,c) = {\\rm gcd}(b,c) = 1$,</li> <li>ho\u1eb7c ${\\rm gcd}(a,b) &gt; 1, {\\rm gcd}(a,c) &gt; 1, {\\rm gcd}(b,c) &gt; 1$.</li> </ul> <p>\u0110\u1ea7u ti\u00ean, \u0111i th\u1eb3ng v\u00e0o b\u00e0i to\u00e1n ngh\u1ecbch \u0111\u1ea3o \u2014 t\u1ee9c l\u00e0 \u0111\u1ebfm s\u1ed1 l\u01b0\u1ee3ng b\u1ed9 ba kh\u00f4ng h\u00e0i h\u00f2a.</p> <p>Th\u1ee9 hai, l\u01b0u \u00fd r\u1eb1ng b\u1ea5t k\u1ef3 b\u1ed9 ba kh\u00f4ng h\u00e0i h\u00f2a n\u00e0 \u0111\u01b0\u1ee3c t\u1ea1o th\u00e0nh t\u1eeb m\u1ed9t c\u1eb7p s\u1ed1 nguy\u00ean t\u1ed1 c\u00f9ng nhau v\u00e0 m\u1ed9t s\u1ed1 th\u1ee9 ba kh\u00f4ng nguy\u00ean t\u1ed1 c\u00f9ng nhau v\u1edbi \u00edt nh\u1ea5t m\u1ed9t trong c\u1eb7p \u0111\u00f3.</p> <p>Do \u0111\u00f3, s\u1ed1 l\u01b0\u1ee3ng b\u1ed9 ba kh\u00f4ng h\u00e0i h\u00f2a ch\u1ee9a $i$ b\u1eb1ng s\u1ed1 l\u01b0\u1ee3ng s\u1ed1 nguy\u00ean t\u1eeb $2$ \u0111\u1ebfn $n$ nguy\u00ean t\u1ed1 c\u00f9ng nhau v\u1edbi $i$ nh\u00e2n v\u1edbi s\u1ed1 l\u01b0\u1ee3ng s\u1ed1 nguy\u00ean kh\u00f4ng nguy\u00ean t\u1ed1 c\u00f9ng nhau v\u1edbi $i$.</p> <p>Ho\u1eb7c $gcd(a,b) = 1 \\wedge gcd(a,c) &gt; 1 \\wedge gcd(b,c) &gt; 1$</p> <p>Ho\u1eb7c $gcd(a,b) = 1 \\wedge gcd(a,c) = 1 \\wedge gcd(b,c) &gt; 1$</p> <p>Trong c\u1ea3 hai tr\u01b0\u1eddng h\u1ee3p n\u00e0y, n\u00f3 s\u1ebd \u0111\u01b0\u1ee3c \u0111\u1ebfm hai l\u1ea7n. Tr\u01b0\u1eddng h\u1ee3p \u0111\u1ea7u ti\u00ean s\u1ebd \u0111\u01b0\u1ee3c \u0111\u1ebfm khi $i = a$ v\u00e0 khi $i = b$. Tr\u01b0\u1eddng h\u1ee3p th\u1ee9 hai s\u1ebd \u0111\u01b0\u1ee3c \u0111\u1ebfm khi $i = b$ v\u00e0 khi $i = c$. Do \u0111\u00f3, \u0111\u1ec3 t\u00ednh s\u1ed1 l\u01b0\u1ee3ng b\u1ed9 ba kh\u00f4ng h\u00e0i h\u00f2a, ch\u00fang ta t\u1ed5ng h\u1ee3p t\u00ednh to\u00e1n n\u00e0y th\u00f4ng qua t\u1ea5t c\u1ea3 $i$ t\u1eeb $2$ \u0111\u1ebfn $n$ v\u00e0 chia n\u00f3 cho $2$.</p> <p>B\u00e2y gi\u1edd t\u1ea5t c\u1ea3 nh\u1eefng g\u00ec ch\u00fang ta c\u00f2n l\u1ea1i \u0111\u1ec3 gi\u1ea3i quy\u1ebft l\u00e0 h\u1ecdc c\u00e1ch \u0111\u1ebfm s\u1ed1 l\u01b0\u1ee3ng s\u1ed1 nguy\u00ean t\u1ed1 c\u00f9ng nhau v\u1edbi $i$ trong kho\u1ea3ng $[2;n]$. M\u1eb7c d\u00f9 b\u00e0i to\u00e1n n\u00e0y \u0111\u00e3 \u0111\u01b0\u1ee3c \u0111\u1ec1 c\u1eadp, gi\u1ea3i ph\u00e1p tr\u00ean kh\u00f4ng ph\u00f9 h\u1ee3p \u1edf \u0111\u00e2y \u2014 n\u00f3 s\u1ebd y\u00eau c\u1ea7u ph\u00e2n t\u00edch th\u1eeba s\u1ed1 c\u1ee7a t\u1eebng s\u1ed1 nguy\u00ean t\u1eeb $2$ \u0111\u1ebfn $n$, v\u00e0 sau \u0111\u00f3 l\u1eb7p qua t\u1ea5t c\u1ea3 c\u00e1c t\u1eadp con c\u1ee7a c\u00e1c s\u1ed1 nguy\u00ean t\u1ed1 n\u00e0y.</p> <p>M\u1ed9t gi\u1ea3i ph\u00e1p nhanh h\u01a1n l\u00e0 c\u00f3 th\u1ec3 v\u1edbi s\u1eeda \u0111\u1ed5i nh\u01b0 v\u1eady c\u1ee7a s\u00e0ng Eratosthenes:</p> <ol> <li> <p>\u0110\u1ea7u ti\u00ean, ch\u00fang ta t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 trong kho\u1ea3ng $[2;n]$ sao cho ph\u00e2n t\u00edch th\u1eeba s\u1ed1 \u0111\u01a1n gi\u1ea3n c\u1ee7a n\u00f3 kh\u00f4ng bao g\u1ed3m m\u1ed9t th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1 hai l\u1ea7n. Ch\u00fang ta c\u0169ng s\u1ebd c\u1ea7n bi\u1ebft, \u0111\u1ed1i v\u1edbi c\u00e1c s\u1ed1 n\u00e0y, n\u00f3 bao g\u1ed3m bao nhi\u00eau th\u1eeba s\u1ed1.</p> <ul> <li>\u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y, ch\u00fang ta s\u1ebd duy tr\u00ec m\u1ed9t m\u1ea3ng $deg[i]$ \u0111\u1ec3 l\u01b0u tr\u1eef s\u1ed1 l\u01b0\u1ee3ng s\u1ed1 nguy\u00ean t\u1ed1 trong ph\u00e2n t\u00edch th\u1eeba s\u1ed1 c\u1ee7a $i$, v\u00e0 m\u1ed9t m\u1ea3ng $good[i]$, \u0111\u1ec3 \u0111\u00e1nh d\u1ea5u ho\u1eb7c n\u1ebfu $i$ ch\u1ee9a m\u1ed7i th\u1eeba s\u1ed1 t\u1ed1i \u0111a m\u1ed9t l\u1ea7n ($good[i] = 1$) ho\u1eb7c kh\u00f4ng ($good[i] = 0$). Khi l\u1eb7p t\u1eeb $2$ \u0111\u1ebfn $n$, n\u1ebfu ch\u00fang ta \u0111\u1ea1t \u0111\u1ebfn m\u1ed9t s\u1ed1 c\u00f3 $deg$ b\u1eb1ng $0$, th\u00ec n\u00f3 l\u00e0 m\u1ed9t s\u1ed1 nguy\u00ean t\u1ed1 v\u00e0 $deg$ c\u1ee7a n\u00f3 l\u00e0 $1$.</li> <li>Trong qu\u00e1 tr\u00ecnh s\u00e0ng Eratosthenes, ch\u00fang ta s\u1ebd l\u1eb7p $i$ t\u1eeb $2$ \u0111\u1ebfn $n$. Khi x\u1eed l\u00fd m\u1ed9t s\u1ed1 nguy\u00ean t\u1ed1, ch\u00fang ta \u0111i qua t\u1ea5t c\u1ea3 c\u00e1c b\u1ed9i s\u1ed1 c\u1ee7a n\u00f3 v\u00e0 t\u0103ng $deg[]$ c\u1ee7a ch\u00fang. N\u1ebfu m\u1ed9t trong nh\u1eefng b\u1ed9i s\u1ed1 n\u00e0y l\u00e0 b\u1ed9i s\u1ed1 c\u1ee7a b\u00ecnh ph\u01b0\u01a1ng c\u1ee7a $i$, th\u00ec ch\u00fang ta c\u00f3 th\u1ec3 \u0111\u1eb7t $good$ l\u00e0 false.</li> </ul> </li> <li> <p>Th\u1ee9 hai, ch\u00fang ta c\u1ea7n t\u00ednh c\u00e2u tr\u1ea3 l\u1eddi cho t\u1ea5t c\u1ea3 $i$ t\u1eeb $2$ \u0111\u1ebfn $n$, t\u1ee9c l\u00e0, m\u1ea3ng $cnt[]$ \u2014 s\u1ed1 l\u01b0\u1ee3ng s\u1ed1 nguy\u00ean kh\u00f4ng nguy\u00ean t\u1ed1 c\u00f9ng nhau v\u1edbi $i$.</p> <ul> <li>\u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y, h\u00e3y nh\u1edb c\u00e1ch c\u00f4ng th\u1ee9c bao h\u00e0m-lo\u1ea1i tr\u1eeb ho\u1ea1t \u0111\u1ed9ng \u2014 th\u1ef1c ra \u1edf \u0111\u00e2y ch\u00fang ta th\u1ef1c hi\u1ec7n c\u00f9ng m\u1ed9t kh\u00e1i ni\u1ec7m, nh\u01b0ng v\u1edbi logic \u0111\u1ea3o ng\u01b0\u1ee3c: ch\u00fang ta l\u1eb7p qua m\u1ed9t th\u00e0nh ph\u1ea7n (t\u00edch c\u1ee7a c\u00e1c s\u1ed1 nguy\u00ean t\u1ed1 t\u1eeb ph\u00e2n t\u00edch th\u1eeba s\u1ed1) v\u00e0 c\u1ed9ng ho\u1eb7c tr\u1eeb s\u1ed1 h\u1ea1ng c\u1ee7a n\u00f3 tr\u00ean c\u00f4ng th\u1ee9c bao h\u00e0m-lo\u1ea1i tr\u1eeb c\u1ee7a m\u1ed7i b\u1ed9i s\u1ed1 c\u1ee7a n\u00f3.</li> <li>V\u00ec v\u1eady, gi\u1ea3 s\u1eed ch\u00fang ta \u0111ang x\u1eed l\u00fd m\u1ed9t s\u1ed1 $i$ sao cho $good[i] = true$, t\u1ee9c l\u00e0, n\u00f3 tham gia v\u00e0o c\u00f4ng th\u1ee9c bao h\u00e0m-lo\u1ea1i tr\u1eeb. L\u1eb7p qua t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 l\u00e0 b\u1ed9i s\u1ed1 c\u1ee7a $i$, v\u00e0 ho\u1eb7c c\u1ed9ng ho\u1eb7c tr\u1eeb $\\lfloor N/i \\rfloor$ t\u1eeb $cnt[]$ c\u1ee7a ch\u00fang (d\u1ea5u ph\u1ee5 thu\u1ed9c v\u00e0o $deg[i]$: n\u1ebfu $deg[i]$ l\u00e0 l\u1ebb, th\u00ec ch\u00fang ta ph\u1ea3i c\u1ed9ng, n\u1ebfu kh\u00f4ng th\u00ec tr\u1eeb).</li> </ul> </li> </ol> <p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u1ed9t c\u00e0i \u0111\u1eb7t C++:</p> <pre><code>int n;\nbool good[MAXN];\nint deg[MAXN], cnt[MAXN];\n\nlong long solve() {\n    memset (good, 1, sizeof good);\n    memset (deg, 0, sizeof deg);\n    memset (cnt, 0, sizeof cnt);\n\n    long long ans_bad = 0;\n    for (int i=2; i&lt;=n; ++i) {\n        if (good[i]) {\n            if (deg[i] == 0)  deg[i] = 1;\n            for (int j=1; i*j&lt;=n; ++j) {\n                if (j &gt; 1 &amp;&amp; deg[i] == 1)\n                    if (j % i == 0)\n                        good[i*j] = false;\n                    else\n                        ++deg[i*j];\n                cnt[i*j] += (n / i) * (deg[i]%2==1 ? +1 : -1);\n            }\n        }\n        ans_bad += (cnt[i] - 1) * 1ll * (n-1 - cnt[i]);\n    }\n\n    return (n-1) * 1ll * (n-2) * (n-3) / 6 - ans_bad / 2;\n}\n</code></pre> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p ti\u1ec7m c\u1eadn c\u1ee7a gi\u1ea3i ph\u00e1p c\u1ee7a ch\u00fang ta l\u00e0 $O(n \\log n)$, v\u00ec \u0111\u1ed1i v\u1edbi h\u1ea7u h\u1ebft m\u1ecdi s\u1ed1 l\u00ean \u0111\u1ebfn $n$, ch\u00fang ta th\u1ef1c hi\u1ec7n $n/i$ l\u1ea7n l\u1eb7p tr\u00ean v\u00f2ng l\u1eb7p l\u1ed3ng nhau.</p>","tags":["Translated"]},{"location":"combinatorics/inclusion-exclusion.html#the-number-of-permutations-without-fixed-points-derangements","title":"S\u1ed1 l\u01b0\u1ee3ng ho\u00e1n v\u1ecb kh\u00f4ng c\u00f3 \u0111i\u1ec3m b\u1ea5t \u0111\u1ed9ng (derangements) (The number of permutations without fixed points (derangements))","text":"<p>Ch\u1ee9ng minh r\u1eb1ng s\u1ed1 l\u01b0\u1ee3ng ho\u00e1n v\u1ecb c\u00f3 \u0111\u1ed9 d\u00e0i $n$ kh\u00f4ng c\u00f3 \u0111i\u1ec3m b\u1ea5t \u0111\u1ed9ng (t\u1ee9c l\u00e0 kh\u00f4ng c\u00f3 s\u1ed1 $i$ n\u00e0o \u1edf v\u1ecb tr\u00ed $i$ - c\u00f2n \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 derangement) b\u1eb1ng s\u1ed1 sau:</p> $$n! - \\binom{n}{1} \\cdot (n-1)! + \\binom{n}{2} \\cdot (n-2)! - \\binom{n}{3} \\cdot (n-3)! + \\cdots \\pm \\binom{n}{n} \\cdot (n-n)! $$ <p>v\u00e0 x\u1ea5p x\u1ec9 b\u1eb1ng:</p> $$ \\frac{ n! }{ e } $$ <p>(n\u1ebfu b\u1ea1n l\u00e0m tr\u00f2n bi\u1ec3u th\u1ee9c n\u00e0y \u0111\u1ebfn s\u1ed1 nguy\u00ean g\u1ea7n nh\u1ea5t \u2014 b\u1ea1n nh\u1eadn \u0111\u01b0\u1ee3c ch\u00ednh x\u00e1c s\u1ed1 l\u01b0\u1ee3ng ho\u00e1n v\u1ecb kh\u00f4ng c\u00f3 \u0111i\u1ec3m b\u1ea5t \u0111\u1ed9ng)</p> <p>K\u00fd hi\u1ec7u $A_k$ l\u00e0 t\u1eadp h\u1ee3p c\u00e1c ho\u00e1n v\u1ecb c\u00f3 \u0111\u1ed9 d\u00e0i $n$ v\u1edbi m\u1ed9t \u0111i\u1ec3m b\u1ea5t \u0111\u1ed9ng t\u1ea1i v\u1ecb tr\u00ed $k$ ($1 \\le k \\le n$) (t\u1ee9c l\u00e0 ph\u1ea7n t\u1eed $k$ \u1edf v\u1ecb tr\u00ed $k$).</p> <p>B\u00e2y gi\u1edd ch\u00fang ta s\u1eed d\u1ee5ng c\u00f4ng th\u1ee9c bao h\u00e0m-lo\u1ea1i tr\u1eeb \u0111\u1ec3 \u0111\u1ebfm s\u1ed1 l\u01b0\u1ee3ng ho\u00e1n v\u1ecb v\u1edbi \u00edt nh\u1ea5t m\u1ed9t \u0111i\u1ec3m b\u1ea5t \u0111\u1ed9ng. \u0110\u1ed1i v\u1edbi \u0111i\u1ec1u n\u00e0y, ch\u00fang ta c\u1ea7n h\u1ecdc c\u00e1ch \u0111\u1ebfm k\u00edch th\u01b0\u1edbc c\u1ee7a giao \u0111i\u1ec3m c\u1ee7a c\u00e1c t\u1eadp h\u1ee3p $A_i$, nh\u01b0 sau:</p> $$\\begin{eqnarray} \\left| A_p \\right| &amp;=&amp; (n-1)!\\ , \\\\ \\left| A_p \\cap A_q \\right| &amp;=&amp; (n-2)!\\ , \\\\ \\left| A_p \\cap A_q \\cap A_r \\right| &amp;=&amp; (n-3)!\\ , \\\\ \\cdots , \\end{eqnarray}$$ <p>b\u1edfi v\u00ec n\u1ebfu ch\u00fang ta bi\u1ebft r\u1eb1ng s\u1ed1 l\u01b0\u1ee3ng \u0111i\u1ec3m b\u1ea5t \u0111\u1ed9ng b\u1eb1ng $x$, th\u00ec ch\u00fang ta bi\u1ebft v\u1ecb tr\u00ed c\u1ee7a $x$ ph\u1ea7n t\u1eed c\u1ee7a ho\u00e1n v\u1ecb, v\u00e0 t\u1ea5t c\u1ea3 $(n-x)$ ph\u1ea7n t\u1eed kh\u00e1c c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c \u0111\u1eb7t \u1edf b\u1ea5t c\u1ee9 \u0111\u00e2u.</p> <p>Thay th\u1ebf \u0111i\u1ec1u n\u00e0y v\u00e0o c\u00f4ng th\u1ee9c bao h\u00e0m-lo\u1ea1i tr\u1eeb, v\u00e0 cho r\u1eb1ng s\u1ed1 c\u00e1ch ch\u1ecdn m\u1ed9t t\u1eadp h\u1ee3p con c\u00f3 k\u00edch th\u01b0\u1edbc $x$ t\u1eeb t\u1eadp h\u1ee3p $n$ ph\u1ea7n t\u1eed b\u1eb1ng $\\binom{n}{x}$, ch\u00fang ta thu \u0111\u01b0\u1ee3c c\u00f4ng th\u1ee9c cho s\u1ed1 l\u01b0\u1ee3ng ho\u00e1n v\u1ecb v\u1edbi \u00edt nh\u1ea5t m\u1ed9t \u0111i\u1ec3m b\u1ea5t \u0111\u1ed9ng:</p> $$\\binom{n}{1} \\cdot (n-1)! - \\binom{n}{2} \\cdot (n-2)! + \\binom{n}{3} \\cdot (n-3)! - \\cdots \\pm \\binom{n}{n} \\cdot (n-n)! $$ <p>Khi \u0111\u00f3 s\u1ed1 l\u01b0\u1ee3ng ho\u00e1n v\u1ecb kh\u00f4ng c\u00f3 \u0111i\u1ec3m b\u1ea5t \u0111\u1ed9ng b\u1eb1ng:</p> $$n! - \\binom{n}{1} \\cdot (n-1)! + \\binom{n}{2} \\cdot (n-2)! - \\binom{n}{3} \\cdot (n-3)! + \\cdots \\pm \\binom{n}{n} \\cdot (n-n)! $$ <p>\u0110\u01a1n gi\u1ea3n h\u00f3a bi\u1ec3u th\u1ee9c n\u00e0y, ch\u00fang ta thu \u0111\u01b0\u1ee3c bi\u1ec3u th\u1ee9c ch\u00ednh x\u00e1c v\u00e0 x\u1ea5p x\u1ec9 cho s\u1ed1 l\u01b0\u1ee3ng ho\u00e1n v\u1ecb kh\u00f4ng c\u00f3 \u0111i\u1ec3m b\u1ea5t \u0111\u1ed9ng:</p> $$ n! \\left( 1 - \\frac{1}{1!} + \\frac{1}{2!} - \\frac{1}{3!} + \\cdots \\pm \\frac{1}{n!} \\right ) \\approx \\frac{n!}{e} $$ <p>(b\u1edfi v\u00ec t\u1ed5ng trong ngo\u1eb7c l\u00e0 $n+1$ s\u1ed1 h\u1ea1ng \u0111\u1ea7u ti\u00ean c\u1ee7a khai tri\u1ec3n chu\u1ed7i Taylor $e^{-1}$)</p> <p>\u0110i\u1ec1u \u0111\u00e1ng ch\u00fa \u00fd l\u00e0 m\u1ed9t b\u00e0i to\u00e1n t\u01b0\u01a1ng t\u1ef1 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i quy\u1ebft theo c\u00e1ch n\u00e0y: khi b\u1ea1n c\u1ea7n c\u00e1c \u0111i\u1ec3m b\u1ea5t \u0111\u1ed9ng kh\u00f4ng n\u1eb1m trong s\u1ed1 $m$ ph\u1ea7n t\u1eed \u0111\u1ea7u ti\u00ean c\u1ee7a ho\u00e1n v\u1ecb (v\u00e0 kh\u00f4ng n\u1eb1m trong s\u1ed1 t\u1ea5t c\u1ea3, nh\u01b0 ch\u00fang ta v\u1eeba gi\u1ea3i quy\u1ebft). C\u00f4ng th\u1ee9c thu \u0111\u01b0\u1ee3c gi\u1ed1ng nh\u01b0 c\u00f4ng th\u1ee9c ch\u00ednh x\u00e1c \u0111\u00e3 cho \u1edf tr\u00ean, nh\u01b0ng n\u00f3 s\u1ebd \u0111i \u0111\u1ebfn t\u1ed5ng c\u1ee7a $k$, thay v\u00ec $n$.</p>","tags":["Translated"]},{"location":"combinatorics/inclusion-exclusion.html#practice-problems","title":"B\u00e0i t\u1eadp luy\u1ec7n t\u1eadp","text":"<p>Danh s\u00e1ch c\u00e1c nhi\u1ec7m v\u1ee5 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i quy\u1ebft b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng nguy\u00ean l\u00fd bao h\u00e0m-lo\u1ea1i tr\u1eeb:</p> <ul> <li>UVA #10325 \"The Lottery\" [difficulty: low]</li> <li>UVA #11806 \"Cheerleaders\" [difficulty: low]</li> <li>TopCoder SRM 477 \"CarelessSecretary\" [difficulty: low]</li> <li>TopCoder TCHS 16 \"Divisibility\" [difficulty: low]</li> <li>SPOJ #6285 NGM2 , \"Another Game With Numbers\" [difficulty: low]</li> <li>TopCoder SRM 382 \"CharmingTicketsEasy\" [difficulty: medium]</li> <li>TopCoder SRM 390 \"SetOfPatterns\" [difficulty: medium]</li> <li>TopCoder SRM 176 \"Deranged\" [difficulty: medium]</li> <li>TopCoder SRM 457 \"TheHexagonsDivOne\" [difficulty: medium]</li> <li>SPOJ #4191 MSKYCODE \"Sky Code\" [difficulty: medium]</li> <li>SPOJ #4168 SQFREE \"Square-free integers\" [difficulty: medium]</li> <li>CodeChef \"Count Relations\" [difficulty: medium]</li> <li>SPOJ - Almost Prime Numbers Again</li> <li>SPOJ - Find number of Pair of Friends</li> <li>SPOJ - Balanced Cow Subsets</li> <li>SPOJ - EASY MATH [difficulty: medium]</li> <li>SPOJ - MOMOS - FEASTOFPIGS [difficulty: easy]</li> <li>Atcoder - Grid 2 [difficulty: easy]</li> <li>Codeforces - Count GCD</li> </ul>","tags":["Translated"]},{"location":"combinatorics/inclusion-exclusion.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 462</li> <li>Translated lines: 462</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Translated"]},{"location":"combinatorics/stars_and_bars.html","title":"Ph\u01b0\u01a1ng ph\u00e1p Ng\u00f4i sao v\u00e0 V\u00e1ch ng\u0103n (Stars and bars)","text":"<p>Ph\u01b0\u01a1ng ph\u00e1p Ng\u00f4i sao v\u00e0 V\u00e1ch ng\u0103n l\u00e0 m\u1ed9t k\u1ef9 thu\u1eadt to\u00e1n h\u1ecdc \u0111\u1ec3 gi\u1ea3i quy\u1ebft m\u1ed9t s\u1ed1 b\u00e0i to\u00e1n t\u1ed5 h\u1ee3p nh\u1ea5t \u0111\u1ecbnh. N\u00f3 xu\u1ea5t hi\u1ec7n b\u1ea5t c\u1ee9 khi n\u00e0o b\u1ea1n mu\u1ed1n \u0111\u1ebfm s\u1ed1 c\u00e1ch \u0111\u1ec3 nh\u00f3m c\u00e1c \u0111\u1ed1i t\u01b0\u1ee3ng gi\u1ed1ng h\u1ec7t nhau.</p>","tags":["Original"]},{"location":"combinatorics/stars_and_bars.html#theorem","title":"\u0110\u1ecbnh l\u00fd (Theorem)","text":"<p>S\u1ed1 c\u00e1ch \u0111\u1ec3 \u0111\u1eb7t $n$ \u0111\u1ed1i t\u01b0\u1ee3ng gi\u1ed1ng h\u1ec7t nhau v\u00e0o $k$ h\u1ed9p c\u00f3 nh\u00e3n l\u00e0</p> $$\\binom{n + k - 1}{n}.$$ <p>Ch\u1ee9ng minh li\u00ean quan \u0111\u1ebfn vi\u1ec7c bi\u1ebfn \u0111\u1ed5i c\u00e1c \u0111\u1ed1i t\u01b0\u1ee3ng th\u00e0nh c\u00e1c ng\u00f4i sao v\u00e0 ng\u0103n c\u00e1ch c\u00e1c h\u1ed9p b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng c\u00e1c v\u00e1ch ng\u0103n (do \u0111\u00f3 c\u00f3 t\u00ean g\u1ecdi n\u00e0y). V\u00ed d\u1ee5: ch\u00fang ta c\u00f3 th\u1ec3 bi\u1ec3u di\u1ec5n t\u00ecnh hu\u1ed1ng sau v\u1edbi $\\bigstar | \\bigstar \\bigstar |~| \\bigstar \\bigstar$: trong h\u1ed9p \u0111\u1ea7u ti\u00ean l\u00e0 m\u1ed9t \u0111\u1ed1i t\u01b0\u1ee3ng, trong h\u1ed9p th\u1ee9 hai l\u00e0 hai \u0111\u1ed1i t\u01b0\u1ee3ng, h\u1ed9p th\u1ee9 ba r\u1ed7ng v\u00e0 trong h\u1ed9p cu\u1ed1i c\u00f9ng l\u00e0 hai \u0111\u1ed1i t\u01b0\u1ee3ng. \u0110\u00e2y l\u00e0 m\u1ed9t c\u00e1ch chia 5 \u0111\u1ed1i t\u01b0\u1ee3ng v\u00e0o 4 h\u1ed9p.</p> <p>Kh\u00e1 r\u00f5 r\u00e0ng r\u1eb1ng, m\u1ecdi ph\u00e2n ho\u1ea1ch \u0111\u1ec1u c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng $n$ ng\u00f4i sao v\u00e0 $k - 1$ v\u00e1ch ng\u0103n v\u00e0 m\u1ecdi ho\u00e1n v\u1ecb c\u1ee7a c\u00e1c ng\u00f4i sao v\u00e0 v\u00e1ch ng\u0103n s\u1eed d\u1ee5ng $n$ ng\u00f4i sao v\u00e0 $k - 1$ v\u00e1ch ng\u0103n \u0111\u1ea1i di\u1ec7n cho m\u1ed9t ph\u00e2n ho\u1ea1ch. Do \u0111\u00f3 s\u1ed1 c\u00e1ch chia $n$ \u0111\u1ed1i t\u01b0\u1ee3ng gi\u1ed1ng h\u1ec7t nhau v\u00e0o $k$ h\u1ed9p c\u00f3 nh\u00e3n l\u00e0 c\u00f9ng m\u1ed9t s\u1ed1 l\u01b0\u1ee3ng ho\u00e1n v\u1ecb c\u1ee7a $n$ ng\u00f4i sao v\u00e0 $k - 1$ v\u00e1ch ng\u0103n. H\u1ec7 s\u1ed1 nh\u1ecb th\u1ee9c cung c\u1ea5p cho ch\u00fang ta c\u00f4ng th\u1ee9c mong mu\u1ed1n.</p>","tags":["Original"]},{"location":"combinatorics/stars_and_bars.html#number-of-non-negative-integer-sums","title":"S\u1ed1 l\u01b0\u1ee3ng nghi\u1ec7m nguy\u00ean kh\u00f4ng \u00e2m (Number of non-negative integer sums)","text":"<p>B\u00e0i to\u00e1n n\u00e0y l\u00e0 m\u1ed9t \u1ee9ng d\u1ee5ng tr\u1ef1c ti\u1ebfp c\u1ee7a \u0111\u1ecbnh l\u00fd.</p> <p>B\u1ea1n mu\u1ed1n \u0111\u1ebfm s\u1ed1 l\u01b0\u1ee3ng nghi\u1ec7m c\u1ee7a ph\u01b0\u01a1ng tr\u00ecnh</p> $$x_1 + x_2 + \\dots + x_k = n$$ <p>v\u1edbi $x_i \\ge 0$.</p> <p>M\u1ed9t l\u1ea7n n\u1eefa ch\u00fang ta c\u00f3 th\u1ec3 bi\u1ec3u di\u1ec5n m\u1ed9t nghi\u1ec7m b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng c\u00e1c ng\u00f4i sao v\u00e0 v\u00e1ch ng\u0103n. V\u00ed d\u1ee5: nghi\u1ec7m $1 + 3 + 0 = 4$ cho $n = 4$, $k = 3$ c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n b\u1eb1ng $\\bigstar | \\bigstar \\bigstar \\bigstar |$.</p> <p>D\u1ec5 th\u1ea5y r\u1eb1ng, \u0111\u00e2y ch\u00ednh x\u00e1c l\u00e0 \u0111\u1ecbnh l\u00fd ng\u00f4i sao v\u00e0 v\u00e1ch ng\u0103n. Do \u0111\u00f3 nghi\u1ec7m l\u00e0 $\\binom{n + k - 1}{n}$.</p>","tags":["Original"]},{"location":"combinatorics/stars_and_bars.html#number-of-positive-integer-sums","title":"S\u1ed1 l\u01b0\u1ee3ng nghi\u1ec7m nguy\u00ean d\u01b0\u01a1ng (Number of positive integer sums)","text":"<p>M\u1ed9t \u0111\u1ecbnh l\u00fd th\u1ee9 hai cung c\u1ea5p m\u1ed9t c\u00e1ch gi\u1ea3i th\u00edch th\u00fa v\u1ecb cho c\u00e1c s\u1ed1 nguy\u00ean d\u01b0\u01a1ng. Xem x\u00e9t c\u00e1c nghi\u1ec7m cho</p> $$x_1 + x_2 + \\dots + x_k = n$$ <p>v\u1edbi $x_i \\ge 1$.</p> <p>Ch\u00fang ta c\u00f3 th\u1ec3 xem x\u00e9t $n$ ng\u00f4i sao, nh\u01b0ng l\u1ea7n n\u00e0y ch\u00fang ta c\u00f3 th\u1ec3 \u0111\u1eb7t t\u1ed1i \u0111a m\u1ed9t v\u00e1ch ng\u0103n gi\u1eefa c\u00e1c ng\u00f4i sao, v\u00ec hai v\u00e1ch ng\u0103n gi\u1eefa c\u00e1c ng\u00f4i sao s\u1ebd \u0111\u1ea1i di\u1ec7n cho $x_i=0$, t\u1ee9c l\u00e0 m\u1ed9t h\u1ed9p r\u1ed7ng. C\u00f3 $n-1$ kho\u1ea3ng tr\u1ed1ng gi\u1eefa c\u00e1c ng\u00f4i sao \u0111\u1ec3 \u0111\u1eb7t $k-1$ v\u00e1ch ng\u0103n, v\u00ec v\u1eady nghi\u1ec7m l\u00e0 $\\binom{n-1}{k-1}$.</p>","tags":["Original"]},{"location":"combinatorics/stars_and_bars.html#number-of-lower-bound-integer-sums","title":"S\u1ed1 l\u01b0\u1ee3ng nghi\u1ec7m nguy\u00ean c\u00f3 c\u1eadn d\u01b0\u1edbi (Number of lower-bound integer sums)","text":"<p>\u0110i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng \u0111\u01b0\u1ee3c m\u1edf r\u1ed9ng cho c\u00e1c t\u1ed5ng s\u1ed1 nguy\u00ean v\u1edbi c\u00e1c c\u1eadn d\u01b0\u1edbi kh\u00e1c nhau. T\u1ee9c l\u00e0 ch\u00fang ta mu\u1ed1n \u0111\u1ebfm s\u1ed1 l\u01b0\u1ee3ng nghi\u1ec7m cho ph\u01b0\u01a1ng tr\u00ecnh</p> $$x_1 + x_2 + \\dots + x_k = n$$ <p>v\u1edbi $x_i \\ge a_i$.</p> <p>Sau khi thay th\u1ebf $x_i' := x_i - a_i$ ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c ph\u01b0\u01a1ng tr\u00ecnh \u0111\u00e3 s\u1eeda \u0111\u1ed5i</p> $$(x_1' + a_i) + (x_2' + a_i) + \\dots + (x_k' + a_k) = n$$ $$\\Leftrightarrow ~ ~ x_1' + x_2' + \\dots + x_k' = n - a_1 - a_2 - \\dots - a_k$$ <p>v\u1edbi $x_i' \\ge 0$. V\u00ec v\u1eady, ch\u00fang ta \u0111\u00e3 gi\u1ea3m b\u00e0i to\u00e1n v\u1ec1 tr\u01b0\u1eddng h\u1ee3p \u0111\u01a1n gi\u1ea3n h\u01a1n v\u1edbi $x_i' \\ge 0$ v\u00e0 m\u1ed9t l\u1ea7n n\u1eefa c\u00f3 th\u1ec3 \u00e1p d\u1ee5ng \u0111\u1ecbnh l\u00fd ng\u00f4i sao v\u00e0 v\u00e1ch ng\u0103n.</p>","tags":["Original"]},{"location":"combinatorics/stars_and_bars.html#number-of-upper-bound-integer-sums","title":"S\u1ed1 l\u01b0\u1ee3ng nghi\u1ec7m nguy\u00ean c\u00f3 c\u1eadn tr\u00ean (Number of upper-bound integer sums)","text":"<p>V\u1edbi m\u1ed9t ch\u00fat tr\u1ee3 gi\u00fap c\u1ee7a Nguy\u00ean l\u00fd bao h\u00e0m-lo\u1ea1i tr\u1eeb, b\u1ea1n c\u0169ng c\u00f3 th\u1ec3 h\u1ea1n ch\u1ebf c\u00e1c s\u1ed1 nguy\u00ean v\u1edbi c\u00e1c c\u1eadn tr\u00ean. Xem ph\u1ea7n S\u1ed1 l\u01b0\u1ee3ng nghi\u1ec7m nguy\u00ean c\u00f3 c\u1eadn tr\u00ean trong b\u00e0i vi\u1ebft t\u01b0\u01a1ng \u1ee9ng.</p>","tags":["Original"]},{"location":"combinatorics/stars_and_bars.html#practice-problems","title":"B\u00e0i t\u1eadp luy\u1ec7n t\u1eadp","text":"<ul> <li>Codeforces - Array</li> <li>Codeforces - Kyoya and Coloured Balls</li> <li>Codeforces - Colorful Bricks</li> <li>Codeforces - Two Arrays</li> <li>Codeforces - One-Dimensional Puzzle</li> </ul>","tags":["Original"]},{"location":"combinatorics/stars_and_bars.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 83</li> <li>Translated lines: 83</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Original"]},{"location":"data_structures/deleting_in_log_n.html","title":"X\u00f3a kh\u1ecfi c\u1ea5u tr\u00fac d\u1eef li\u1ec7u trong $O(T(n)\\log n)$ (Deleting from a data structure in $O(T(n)\\log n)$)","text":"<p>Gi\u1ea3 s\u1eed b\u1ea1n c\u00f3 m\u1ed9t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u cho ph\u00e9p th\u00eam c\u00e1c ph\u1ea7n t\u1eed trong th\u1ef1c s\u1ef1 $O(T(n))$. B\u00e0i vi\u1ebft n\u00e0y s\u1ebd m\u00f4 t\u1ea3 m\u1ed9t k\u1ef9 thu\u1eadt cho ph\u00e9p x\u00f3a trong $O(T(n)\\log n)$ offline.</p>","tags":["Original"]},{"location":"data_structures/deleting_in_log_n.html#algorithm","title":"Thu\u1eadt to\u00e1n (Algorithm)","text":"<p>M\u1ed7i ph\u1ea7n t\u1eed t\u1ed3n t\u1ea1i trong c\u1ea5u tr\u00fac d\u1eef li\u1ec7u cho m\u1ed9t s\u1ed1 \u0111o\u1ea1n th\u1eddi gian gi\u1eefa c\u00e1c l\u1ea7n th\u00eam v\u00e0 x\u00f3a. H\u00e3y x\u00e2y d\u1ef1ng m\u1ed9t c\u00e2y ph\u00e2n \u0111o\u1ea1n (segment tree) tr\u00ean c\u00e1c truy v\u1ea5n. M\u1ed7i \u0111o\u1ea1n khi m\u1ed9t s\u1ed1 ph\u1ea7n t\u1eed c\u00f2n t\u1ed3n t\u1ea1i t\u00e1ch th\u00e0nh $O(\\log n)$ n\u00fat c\u1ee7a c\u00e2y. H\u00e3y \u0111\u1eb7t m\u1ed7i truy v\u1ea5n khi ch\u00fang ta mu\u1ed1n bi\u1ebft \u0111i\u1ec1u g\u00ec \u0111\u00f3 v\u1ec1 c\u1ea5u tr\u00fac v\u00e0o l\u00e1 t\u01b0\u01a1ng \u1ee9ng. B\u00e2y gi\u1edd \u0111\u1ec3 x\u1eed l\u00fd t\u1ea5t c\u1ea3 c\u00e1c truy v\u1ea5n, ch\u00fang ta s\u1ebd ch\u1ea1y DFS tr\u00ean c\u00e2y ph\u00e2n \u0111o\u1ea1n. Khi v\u00e0o n\u00fat, ch\u00fang ta s\u1ebd th\u00eam t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed n\u1eb1m b\u00ean trong n\u00fat n\u00e0y. Sau \u0111\u00f3, ch\u00fang ta s\u1ebd \u0111i xa h\u01a1n \u0111\u1ebfn con c\u1ee7a n\u00fat n\u00e0y ho\u1eb7c tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n (n\u1ebfu n\u00fat l\u00e0 l\u00e1). Khi r\u1eddi kh\u1ecfi n\u00fat, ch\u00fang ta ph\u1ea3i ho\u00e0n t\u00e1c c\u00e1c b\u1ed5 sung. L\u01b0u \u00fd r\u1eb1ng n\u1ebfu ch\u00fang ta thay \u0111\u1ed5i c\u1ea5u tr\u00fac trong $O(T(n))$ ch\u00fang ta c\u00f3 th\u1ec3 kh\u00f4i ph\u1ee5c c\u00e1c thay \u0111\u1ed5i trong $O(T(n))$ b\u1eb1ng c\u00e1ch gi\u1eef m\u1ed9t ng\u0103n x\u1ebfp c\u00e1c thay \u0111\u1ed5i. L\u01b0u \u00fd r\u1eb1ng vi\u1ec7c kh\u00f4i ph\u1ee5c (rollbacks) ph\u00e1 v\u1ee1 \u0111\u1ed9 ph\u1ee9c t\u1ea1p kh\u1ea5u hao (amortized complexity).</p>","tags":["Original"]},{"location":"data_structures/deleting_in_log_n.html#notes","title":"Ghi ch\u00fa (Notes)","text":"<p>\u00dd t\u01b0\u1edfng t\u1ea1o m\u1ed9t c\u00e2y ph\u00e2n \u0111o\u1ea1n tr\u00ean c\u00e1c \u0111o\u1ea1n khi m\u1ed9t c\u00e1i g\u00ec \u0111\u00f3 c\u00f2n t\u1ed3n t\u1ea1i c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng kh\u00f4ng ch\u1ec9 cho c\u00e1c b\u00e0i to\u00e1n c\u1ea5u tr\u00fac d\u1eef li\u1ec7u. Xem m\u1ed9t s\u1ed1 b\u00e0i to\u00e1n d\u01b0\u1edbi \u0111\u00e2y.</p>","tags":["Original"]},{"location":"data_structures/deleting_in_log_n.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>C\u00e0i \u0111\u1eb7t n\u00e0y d\u00e0nh cho b\u00e0i to\u00e1n t\u00ednh li\u00ean th\u00f4ng \u0111\u1ed9ng. N\u00f3 c\u00f3 th\u1ec3 th\u00eam c\u1ea1nh, x\u00f3a c\u1ea1nh v\u00e0 \u0111\u1ebfm s\u1ed1 l\u01b0\u1ee3ng th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng.</p> <pre><code>struct dsu_save {\n    int v, rnkv, u, rnku;\n\n    dsu_save() {}\n\n    dsu_save(int _v, int _rnkv, int _u, int _rnku)\n        : v(_v), rnkv(_rnkv), u(_u), rnku(_rnku) {}\n};\n\nstruct dsu_with_rollbacks {\n    vector&lt;int&gt; p, rnk;\n    int comps;\n    stack&lt;dsu_save&gt; op;\n\n    dsu_with_rollbacks() {}\n\n    dsu_with_rollbacks(int n) {\n        p.resize(n);\n        rnk.resize(n);\n        for (int i = 0; i &lt; n; i++) {\n            p[i] = i;\n            rnk[i] = 0;\n        }\n        comps = n;\n    }\n\n    int find_set(int v) {\n        return (v == p[v]) ? v : find_set(p[v]);\n    }\n\n    bool unite(int v, int u) {\n        v = find_set(v);\n        u = find_set(u);\n        if (v == u)\n            return false;\n        comps--;\n        if (rnk[v] &gt; rnk[u])\n            swap(v, u);\n        op.push(dsu_save(v, rnk[v], u, rnk[u]));\n        p[v] = u;\n        if (rnk[u] == rnk[v])\n            rnk[u]++;\n        return true;\n    }\n\n    void rollback() {\n        if (op.empty())\n            return;\n        dsu_save x = op.top();\n        op.pop();\n        comps++;\n        p[x.v] = x.v;\n        rnk[x.v] = x.rnkv;\n        p[x.u] = x.u;\n        rnk[x.u] = x.rnku;\n    }\n};\n\nstruct query {\n    int v, u;\n    bool united;\n    query(int _v, int _u) : v(_v), u(_u) {\n    }\n};\n\nstruct QueryTree {\n    vector&lt;vector&lt;query&gt;&gt; t;\n    dsu_with_rollbacks dsu;\n    int T;\n\n    QueryTree() {}\n\n    QueryTree(int _T, int n) : T(_T) {\n        dsu = dsu_with_rollbacks(n);\n        t.resize(4 * T + 4);\n    }\n\n    void add_to_tree(int v, int l, int r, int ul, int ur, query&amp; q) {\n        if (ul &gt; ur)\n            return;\n        if (l == ul &amp;&amp; r == ur) {\n            t[v].push_back(q);\n            return;\n        }\n        int mid = (l + r) / 2;\n        add_to_tree(2 * v, l, mid, ul, min(ur, mid), q);\n        add_to_tree(2 * v + 1, mid + 1, r, max(ul, mid + 1), ur, q);\n    }\n\n    void add_query(query q, int l, int r) {\n        add_to_tree(1, 0, T - 1, l, r, q);\n    }\n\n    void dfs(int v, int l, int r, vector&lt;int&gt;&amp; ans) {\n        for (query&amp; q : t[v]) {\n            q.united = dsu.unite(q.v, q.u);\n        }\n        if (l == r)\n            ans[l] = dsu.comps;\n        else {\n            int mid = (l + r) / 2;\n            dfs(2 * v, l, mid, ans);\n            dfs(2 * v + 1, mid + 1, r, ans);\n        }\n        for (query q : t[v]) {\n            if (q.united)\n                dsu.rollback();\n        }\n    }\n\n    vector&lt;int&gt; solve() {\n        vector&lt;int&gt; ans(T);\n        dfs(1, 0, T - 1, ans);\n        return ans;\n    }\n};\n</code></pre>","tags":["Original"]},{"location":"data_structures/deleting_in_log_n.html#problems","title":"B\u00e0i t\u1eadp (Problems)","text":"<ul> <li>Codeforces - Connect and Disconnect</li> <li>Codeforces - Addition on Segments</li> <li>Codeforces - Extending Set of Points</li> </ul>","tags":["Original"]},{"location":"data_structures/deleting_in_log_n.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 158</li> <li>Translated lines: 158</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Original"]},{"location":"data_structures/disjoint_set_union.html","title":"C\u1ea5u tr\u00fac d\u1eef li\u1ec7u c\u00e1c t\u1eadp h\u1ee3p r\u1eddi nhau (Disjoint Set Union)","text":"<p>B\u00e0i vi\u1ebft n\u00e0y th\u1ea3o lu\u1eadn v\u1ec1 c\u1ea5u tr\u00fac d\u1eef li\u1ec7u C\u00e1c t\u1eadp h\u1ee3p r\u1eddi nhau (Disjoint Set Union) ho\u1eb7c DSU. Th\u00f4ng th\u01b0\u1eddng, n\u00f3 c\u0169ng \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 Union Find (H\u1ee3p-T\u00ecm) v\u00ec hai ho\u1ea1t \u0111\u1ed9ng ch\u00ednh c\u1ee7a n\u00f3.</p> <p>C\u1ea5u tr\u00fac d\u1eef li\u1ec7u n\u00e0y cung c\u1ea5p c\u00e1c kh\u1ea3 n\u0103ng sau. Ch\u00fang ta \u0111\u01b0\u1ee3c cho m\u1ed9t s\u1ed1 ph\u1ea7n t\u1eed, m\u1ed7i ph\u1ea7n t\u1eed l\u00e0 m\u1ed9t t\u1eadp h\u1ee3p ri\u00eang bi\u1ec7t. M\u1ed9t DSU s\u1ebd c\u00f3 m\u1ed9t thao t\u00e1c \u0111\u1ec3 k\u1ebft h\u1ee3p hai t\u1eadp h\u1ee3p b\u1ea5t k\u1ef3, v\u00e0 n\u00f3 s\u1ebd c\u00f3 th\u1ec3 cho bi\u1ebft ph\u1ea7n t\u1eed c\u1ee5 th\u1ec3 n\u1eb1m trong t\u1eadp h\u1ee3p n\u00e0o. Phi\u00ean b\u1ea3n c\u1ed5 \u0111i\u1ec3n c\u0169ng gi\u1edbi thi\u1ec7u thao t\u00e1c th\u1ee9 ba, n\u00f3 c\u00f3 th\u1ec3 t\u1ea1o m\u1ed9t t\u1eadp h\u1ee3p t\u1eeb m\u1ed9t ph\u1ea7n t\u1eed m\u1edbi.</p> <p>Do \u0111\u00f3, giao di\u1ec7n c\u01a1 b\u1ea3n c\u1ee7a c\u1ea5u tr\u00fac d\u1eef li\u1ec7u n\u00e0y ch\u1ec9 bao g\u1ed3m ba thao t\u00e1c:</p> <ul> <li><code>make_set(v)</code> - t\u1ea1o m\u1ed9t t\u1eadp h\u1ee3p m\u1edbi bao g\u1ed3m ph\u1ea7n t\u1eed m\u1edbi <code>v</code></li> <li><code>union_sets(a, b)</code> - h\u1ee3p nh\u1ea5t hai t\u1eadp h\u1ee3p \u0111\u00e3 ch\u1ec9 \u0111\u1ecbnh (t\u1eadp h\u1ee3p ch\u1ee9a ph\u1ea7n t\u1eed <code>a</code>, v\u00e0 t\u1eadp h\u1ee3p ch\u1ee9a ph\u1ea7n t\u1eed <code>b</code>)</li> <li><code>find_set(v)</code> - tr\u1ea3 v\u1ec1 \u0111\u1ea1i di\u1ec7n (c\u00f2n g\u1ecdi l\u00e0 l\u00e3nh \u0111\u1ea1o) c\u1ee7a t\u1eadp h\u1ee3p ch\u1ee9a ph\u1ea7n t\u1eed <code>v</code>. \u0110\u1ea1i di\u1ec7n n\u00e0y l\u00e0 m\u1ed9t ph\u1ea7n t\u1eed c\u1ee7a t\u1eadp h\u1ee3p t\u01b0\u01a1ng \u1ee9ng c\u1ee7a n\u00f3. N\u00f3 \u0111\u01b0\u1ee3c ch\u1ecdn trong m\u1ed7i t\u1eadp h\u1ee3p b\u1edfi ch\u00ednh c\u1ea5u tr\u00fac d\u1eef li\u1ec7u (v\u00e0 c\u00f3 th\u1ec3 thay \u0111\u1ed5i theo th\u1eddi gian, c\u1ee5 th\u1ec3 l\u00e0 sau c\u00e1c l\u1ec7nh g\u1ecdi <code>union_sets</code>). \u0110\u1ea1i di\u1ec7n n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 ki\u1ec3m tra xem hai ph\u1ea7n t\u1eed c\u00f3 thu\u1ed9c c\u00f9ng m\u1ed9t t\u1eadp h\u1ee3p hay kh\u00f4ng. <code>a</code> v\u00e0 <code>b</code> ch\u00ednh x\u00e1c trong c\u00f9ng m\u1ed9t t\u1eadp h\u1ee3p, n\u1ebfu <code>find_set(a) == find_set(b)</code>. Ng\u01b0\u1ee3c l\u1ea1i ch\u00fang \u1edf trong c\u00e1c t\u1eadp h\u1ee3p kh\u00e1c nhau.</li> </ul> <p>Nh\u01b0 \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 chi ti\u1ebft h\u01a1n sau n\u00e0y, c\u1ea5u tr\u00fac d\u1eef li\u1ec7u cho ph\u00e9p b\u1ea1n th\u1ef1c hi\u1ec7n t\u1eebng thao t\u00e1c n\u00e0y trong th\u1eddi gian trung b\u00ecnh g\u1ea7n nh\u01b0 $O(1)$.</p> <p>C\u0169ng trong m\u1ed9t trong c\u00e1c ti\u1ec3u m\u1ee5c, m\u1ed9t c\u1ea5u tr\u00fac thay th\u1ebf c\u1ee7a DSU \u0111\u01b0\u1ee3c gi\u1ea3i th\u00edch, \u0111\u1ea1t \u0111\u01b0\u1ee3c \u0111\u1ed9 ph\u1ee9c t\u1ea1p trung b\u00ecnh ch\u1eadm h\u01a1n l\u00e0 $O(\\log n)$, nh\u01b0ng c\u00f3 th\u1ec3 m\u1ea1nh h\u01a1n c\u1ea5u tr\u00fac DSU th\u00f4ng th\u01b0\u1eddng.</p>","tags":["Translated"]},{"location":"data_structures/disjoint_set_union.html#build-an-efficient-data-structure","title":"X\u00e2y d\u1ef1ng c\u1ea5u tr\u00fac d\u1eef li\u1ec7u hi\u1ec7u qu\u1ea3 (Build an efficient data structure)","text":"<p>Ch\u00fang ta s\u1ebd l\u01b0u tr\u1eef c\u00e1c t\u1eadp h\u1ee3p d\u01b0\u1edbi d\u1ea1ng c\u00e2y (trees): m\u1ed7i c\u00e2y s\u1ebd t\u01b0\u01a1ng \u1ee9ng v\u1edbi m\u1ed9t t\u1eadp h\u1ee3p. V\u00e0 g\u1ed1c c\u1ee7a c\u00e2y s\u1ebd l\u00e0 \u0111\u1ea1i di\u1ec7n/l\u00e3nh \u0111\u1ea1o c\u1ee7a t\u1eadp h\u1ee3p.</p> <p>Trong h\u00ecnh \u1ea3nh sau \u0111\u00e2y, b\u1ea1n c\u00f3 th\u1ec3 th\u1ea5y bi\u1ec3u di\u1ec5n c\u1ee7a c\u00e1c c\u00e2y nh\u01b0 v\u1eady.</p> <p></p> <p>Ban \u0111\u1ea7u, m\u1ed7i ph\u1ea7n t\u1eed b\u1eaft \u0111\u1ea7u nh\u01b0 m\u1ed9t t\u1eadp h\u1ee3p \u0111\u01a1n l\u1ebb, do \u0111\u00f3 m\u1ed7i \u0111\u1ec9nh l\u00e0 c\u00e2y c\u1ee7a ri\u00eang n\u00f3. Sau \u0111\u00f3, ch\u00fang ta k\u1ebft h\u1ee3p t\u1eadp h\u1ee3p ch\u1ee9a ph\u1ea7n t\u1eed 1 v\u00e0 t\u1eadp h\u1ee3p ch\u1ee9a ph\u1ea7n t\u1eed 2. Sau \u0111\u00f3, ch\u00fang ta k\u1ebft h\u1ee3p t\u1eadp h\u1ee3p ch\u1ee9a ph\u1ea7n t\u1eed 3 v\u00e0 t\u1eadp h\u1ee3p ch\u1ee9a ph\u1ea7n t\u1eed 4. V\u00e0 trong b\u01b0\u1edbc cu\u1ed1i c\u00f9ng, ch\u00fang ta k\u1ebft h\u1ee3p t\u1eadp h\u1ee3p ch\u1ee9a ph\u1ea7n t\u1eed 1 v\u00e0 t\u1eadp h\u1ee3p ch\u1ee9a ph\u1ea7n t\u1eed 3.</p> <p>\u0110\u1ed1i v\u1edbi vi\u1ec7c c\u00e0i \u0111\u1eb7t, \u0111i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 ch\u00fang ta s\u1ebd ph\u1ea3i duy tr\u00ec m\u1ed9t m\u1ea3ng <code>parent</code> l\u01b0u tr\u1eef m\u1ed9t tham chi\u1ebfu \u0111\u1ebfn t\u1ed5 ti\u00ean tr\u1ef1c ti\u1ebfp c\u1ee7a n\u00f3 trong c\u00e2y.</p>","tags":["Translated"]},{"location":"data_structures/disjoint_set_union.html#naive-implementation","title":"C\u00e0i \u0111\u1eb7t ng\u00e2y th\u01a1 (Naive implementation)","text":"<p>Ch\u00fang ta \u0111\u00e3 c\u00f3 th\u1ec3 vi\u1ebft b\u1ea3n c\u00e0i \u0111\u1eb7t \u0111\u1ea7u ti\u00ean c\u1ee7a c\u1ea5u tr\u00fac d\u1eef li\u1ec7u Disjoint Set Union. L\u00fac \u0111\u1ea7u n\u00f3 s\u1ebd kh\u00e1 k\u00e9m hi\u1ec7u qu\u1ea3, nh\u01b0ng sau \u0111\u00f3 ch\u00fang ta c\u00f3 th\u1ec3 c\u1ea3i thi\u1ec7n n\u00f3 b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng hai t\u1ed1i \u01b0u h\u00f3a, \u0111\u1ec3 n\u00f3 s\u1ebd m\u1ea5t th\u1eddi gian g\u1ea7n nh\u01b0 h\u1eb1ng s\u1ed1 cho m\u1ed7i l\u1ea7n g\u1ecdi h\u00e0m.</p> <p>Nh\u01b0 ch\u00fang ta \u0111\u00e3 n\u00f3i, t\u1ea5t c\u1ea3 th\u00f4ng tin v\u1ec1 c\u00e1c t\u1eadp h\u1ee3p ph\u1ea7n t\u1eed s\u1ebd \u0111\u01b0\u1ee3c l\u01b0u gi\u1eef trong m\u1ed9t m\u1ea3ng <code>parent</code>.</p> <p>\u0110\u1ec3 t\u1ea1o m\u1ed9t t\u1eadp h\u1ee3p m\u1edbi (thao t\u00e1c <code>make_set(v)</code>), ch\u00fang ta ch\u1ec9 c\u1ea7n t\u1ea1o m\u1ed9t c\u00e2y c\u00f3 g\u1ed1c t\u1ea1i \u0111\u1ec9nh <code>v</code>, ngh\u0129a l\u00e0 n\u00f3 l\u00e0 t\u1ed5 ti\u00ean c\u1ee7a ch\u00ednh n\u00f3.</p> <p>\u0110\u1ec3 k\u1ebft h\u1ee3p hai t\u1eadp h\u1ee3p (thao t\u00e1c <code>union_sets(a, b)</code>), tr\u01b0\u1edbc ti\u00ean ch\u00fang ta t\u00ecm \u0111\u1ea1i di\u1ec7n c\u1ee7a t\u1eadp h\u1ee3p ch\u1ee9a <code>a</code>, v\u00e0 \u0111\u1ea1i di\u1ec7n c\u1ee7a t\u1eadp h\u1ee3p ch\u1ee9a <code>b</code>. N\u1ebfu c\u00e1c \u0111\u1ea1i di\u1ec7n gi\u1ed1ng nhau, ch\u00fang ta kh\u00f4ng c\u00f3 g\u00ec \u0111\u1ec3 l\u00e0m, c\u00e1c b\u1ed9 \u0111\u00e3 \u0111\u01b0\u1ee3c h\u1ee3p nh\u1ea5t. Ng\u01b0\u1ee3c l\u1ea1i, ch\u00fang ta c\u00f3 th\u1ec3 ch\u1ec9 \u0111\u1ecbnh \u0111\u01a1n gi\u1ea3n r\u1eb1ng m\u1ed9t trong nh\u1eefng \u0111\u1ea1i di\u1ec7n l\u00e0 cha c\u1ee7a \u0111\u1ea1i di\u1ec7n kia - do \u0111\u00f3 k\u1ebft h\u1ee3p hai c\u00e2y.</p> <p>Cu\u1ed1i c\u00f9ng l\u00e0 vi\u1ec7c c\u00e0i \u0111\u1eb7t ch\u1ee9c n\u0103ng t\u00ecm \u0111\u1ea1i di\u1ec7n (thao t\u00e1c <code>find_set(v)</code>): ch\u00fang ta ch\u1ec9 c\u1ea7n leo l\u00ean c\u00e1c t\u1ed5 ti\u00ean c\u1ee7a \u0111\u1ec9nh <code>v</code> cho \u0111\u1ebfn khi ch\u00fang ta \u0111\u1ebfn g\u1ed1c, t\u1ee9c l\u00e0 m\u1ed9t \u0111\u1ec9nh sao cho tham chi\u1ebfu \u0111\u1ebfn t\u1ed5 ti\u00ean d\u1eabn \u0111\u1ebfn ch\u00ednh n\u00f3. Ho\u1ea1t \u0111\u1ed9ng n\u00e0y \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n d\u1ec5 d\u00e0ng b\u1eb1ng \u0111\u1ec7 quy.</p> <pre><code>void make_set(int v) {\n    parent[v] = v;\n}\n\nint find_set(int v) {\n    if (v == parent[v])\n        return v;\n    return find_set(parent[v]);\n}\n\nvoid union_sets(int a, int b) {\n    a = find_set(a);\n    b = find_set(b);\n    if (a != b)\n        parent[b] = a;\n}\n</code></pre> <p>Tuy nhi\u00ean, vi\u1ec7c c\u00e0i \u0111\u1eb7t n\u00e0y kh\u00f4ng hi\u1ec7u qu\u1ea3. Th\u1eadt d\u1ec5 d\u00e0ng \u0111\u1ec3 x\u00e2y d\u1ef1ng m\u1ed9t v\u00ed d\u1ee5, sao cho c\u00e1c c\u00e2y tho\u00e1i h\u00f3a th\u00e0nh c\u00e1c chu\u1ed7i d\u00e0i. Trong tr\u01b0\u1eddng h\u1ee3p \u0111\u00f3, m\u1ed7i l\u1ec7nh g\u1ecdi <code>find_set(v)</code> c\u00f3 th\u1ec3 m\u1ea5t th\u1eddi gian $O(n)$.</p> <p>\u0110i\u1ec1u n\u00e0y c\u00f2n xa \u0111\u1ed9 ph\u1ee9c t\u1ea1p m\u00e0 ch\u00fang ta mu\u1ed1n c\u00f3 (th\u1eddi gian g\u1ea7n nh\u01b0 h\u1eb1ng s\u1ed1). Do \u0111\u00f3, ch\u00fang ta s\u1ebd xem x\u00e9t hai t\u1ed1i \u01b0u h\u00f3a s\u1ebd cho ph\u00e9p t\u0103ng t\u1ed1c \u0111\u00e1ng k\u1ec3 c\u00f4ng vi\u1ec7c.</p>","tags":["Translated"]},{"location":"data_structures/disjoint_set_union.html#path-compression-optimization","title":"T\u1ed1i \u01b0u h\u00f3a n\u00e9n \u0111\u01b0\u1eddng (Path compression optimization)","text":"<p>T\u1ed1i \u01b0u h\u00f3a n\u00e0y \u0111\u01b0\u1ee3c thi\u1ebft k\u1ebf \u0111\u1ec3 t\u0103ng t\u1ed1c <code>find_set</code>.</p> <p>N\u1ebfu ch\u00fang ta g\u1ecdi <code>find_set(v)</code> cho m\u1ed9t s\u1ed1 \u0111\u1ec9nh <code>v</code>, ch\u00fang ta th\u1ef1c s\u1ef1 t\u00ecm th\u1ea5y \u0111\u1ea1i di\u1ec7n <code>p</code> cho t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh m\u00e0 ch\u00fang ta truy c\u1eadp tr\u00ean \u0111\u01b0\u1eddng \u0111i gi\u1eefa <code>v</code> v\u00e0 \u0111\u1ea1i di\u1ec7n th\u1ef1c t\u1ebf <code>p</code>. Th\u1ee7 thu\u1eadt l\u00e0 l\u00e0m cho c\u00e1c \u0111\u01b0\u1eddng d\u1eabn cho t\u1ea5t c\u1ea3 c\u00e1c n\u00fat \u0111\u00f3 ng\u1eafn h\u01a1n, b\u1eb1ng c\u00e1ch \u0111\u1eb7t cha c\u1ee7a m\u1ed7i \u0111\u1ec9nh \u0111\u01b0\u1ee3c truy c\u1eadp tr\u1ef1c ti\u1ebfp th\u00e0nh <code>p</code>.</p> <p>B\u1ea1n c\u00f3 th\u1ec3 th\u1ea5y thao t\u00e1c trong h\u00ecnh sau. B\u00ean tr\u00e1i c\u00f3 m\u1ed9t c\u00e1i c\u00e2y, v\u00e0 b\u00ean ph\u1ea3i c\u00f3 c\u00e2y n\u00e9n sau khi g\u1ecdi <code>find_set(7)</code>, l\u00e0m ng\u1eafn \u0111\u01b0\u1eddng d\u1eabn cho c\u00e1c n\u00fat \u0111\u00e3 truy c\u1eadp 7, 5, 3 v\u00e0 2.</p> <p></p> <p>Vi\u1ec7c c\u00e0i \u0111\u1eb7t m\u1edbi c\u1ee7a <code>find_set</code> nh\u01b0 sau:</p> <pre><code>int find_set(int v) {\n    if (v == parent[v])\n        return v;\n    return parent[v] = find_set(parent[v]);\n}\n</code></pre> <p>Vi\u1ec7c c\u00e0i \u0111\u1eb7t \u0111\u01a1n gi\u1ea3n th\u1ef1c hi\u1ec7n nh\u1eefng g\u00ec \u0111\u00e3 \u0111\u1ecbnh: \u0111\u1ea7u ti\u00ean t\u00ecm \u0111\u1ea1i di\u1ec7n c\u1ee7a t\u1eadp h\u1ee3p (\u0111\u1ec9nh g\u1ed1c), v\u00e0 sau \u0111\u00f3 trong qu\u00e1 tr\u00ecnh th\u00e1o ng\u0103n x\u1ebfp (stack unwinding), c\u00e1c n\u00fat \u0111\u01b0\u1ee3c truy c\u1eadp \u0111\u01b0\u1ee3c g\u1eafn tr\u1ef1c ti\u1ebfp v\u00e0o \u0111\u1ea1i di\u1ec7n.</p> <p>S\u1eeda \u0111\u1ed5i \u0111\u01a1n gi\u1ea3n n\u00e0y c\u1ee7a thao t\u00e1c \u0111\u00e3 \u0111\u1ea1t \u0111\u01b0\u1ee3c \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian trung b\u00ecnh $O(\\log n)$ m\u1ed7i l\u1ea7n g\u1ecdi (\u1edf \u0111\u00e2y kh\u00f4ng c\u00f3 ch\u1ee9ng minh). C\u00f3 m\u1ed9t s\u1eeda \u0111\u1ed5i th\u1ee9 hai, s\u1ebd l\u00e0m cho n\u00f3 nhanh h\u01a1n n\u1eefa.</p>","tags":["Translated"]},{"location":"data_structures/disjoint_set_union.html#union-by-size-rank","title":"H\u1ee3p nh\u1ea5t theo k\u00edch th\u01b0\u1edbc / h\u1ea1ng (Union by size / rank)","text":"<p>Trong t\u1ed1i \u01b0u h\u00f3a n\u00e0y, ch\u00fang ta s\u1ebd thay \u0111\u1ed5i thao t\u00e1c <code>union_set</code>. Ch\u00ednh x\u00e1c h\u01a1n, ch\u00fang ta s\u1ebd thay \u0111\u1ed5i c\u00e2y n\u00e0o \u0111\u01b0\u1ee3c g\u1eafn v\u00e0o c\u00e2y kia. Trong c\u00e1ch c\u00e0i \u0111\u1eb7t ng\u00e2y th\u01a1, c\u00e2y th\u1ee9 hai lu\u00f4n \u0111\u01b0\u1ee3c g\u1eafn v\u00e0o c\u00e2y th\u1ee9 nh\u1ea5t. Trong th\u1ef1c t\u1ebf, \u0111i\u1ec1u \u0111\u00f3 c\u00f3 th\u1ec3 d\u1eabn \u0111\u1ebfn c\u00e1c c\u00e2y ch\u1ee9a chu\u1ed7i c\u00f3 \u0111\u1ed9 d\u00e0i $O(n)$. V\u1edbi s\u1ef1 t\u1ed1i \u01b0u h\u00f3a n\u00e0y, ch\u00fang ta s\u1ebd tr\u00e1nh \u0111i\u1ec1u n\u00e0y b\u1eb1ng c\u00e1ch ch\u1ecdn r\u1ea5t c\u1ea9n th\u1eadn c\u00e2y n\u00e0o \u0111\u01b0\u1ee3c g\u1eafn v\u00e0o.</p> <p>C\u00f3 nhi\u1ec1u heuristic c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng. Ph\u1ed5 bi\u1ebfn nh\u1ea5t l\u00e0 hai c\u00e1ch ti\u1ebfp c\u1eadn sau: Trong c\u00e1ch ti\u1ebfp c\u1eadn \u0111\u1ea7u ti\u00ean, ch\u00fang ta s\u1eed d\u1ee5ng k\u00edch th\u01b0\u1edbc c\u1ee7a c\u00e2y l\u00e0m th\u1ee9 h\u1ea1ng (rank), v\u00e0 trong c\u00e1ch th\u1ee9 hai, ch\u00fang ta s\u1eed d\u1ee5ng \u0111\u1ed9 s\u00e2u c\u1ee7a c\u00e2y (ch\u00ednh x\u00e1c h\u01a1n l\u00e0 gi\u1edbi h\u1ea1n tr\u00ean c\u1ee7a \u0111\u1ed9 s\u00e2u c\u00e2y, v\u00ec \u0111\u1ed9 s\u00e2u s\u1ebd nh\u1ecf h\u01a1n khi \u00e1p d\u1ee5ng n\u00e9n \u0111\u01b0\u1eddng).</p> <p>Trong c\u1ea3 hai ph\u01b0\u01a1ng ph\u00e1p, b\u1ea3n ch\u1ea5t c\u1ee7a s\u1ef1 t\u1ed1i \u01b0u h\u00f3a l\u00e0 gi\u1ed1ng nhau: ch\u00fang ta g\u1eafn c\u00e2y c\u00f3 th\u1ee9 h\u1ea1ng th\u1ea5p h\u01a1n v\u00e0o c\u00e2y c\u00f3 th\u1ee9 h\u1ea1ng l\u1edbn h\u01a1n.</p> <p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 c\u00e0i \u0111\u1eb7t h\u1ee3p nh\u1ea5t theo k\u00edch th\u01b0\u1edbc:</p> <pre><code>void make_set(int v) {\n    parent[v] = v;\n    size[v] = 1;\n}\n\nvoid union_sets(int a, int b) {\n    a = find_set(a);\n    b = find_set(b);\n    if (a != b) {\n        if (size[a] &lt; size[b])\n            swap(a, b);\n        parent[b] = a;\n        size[a] += size[b];\n    }\n}\n</code></pre> <p>V\u00e0 \u0111\u00e2y l\u00e0 vi\u1ec7c c\u00e0i \u0111\u1eb7t h\u1ee3p nh\u1ea5t theo h\u1ea1ng d\u1ef1a tr\u00ean \u0111\u1ed9 s\u00e2u c\u1ee7a c\u00e2y:</p> <p><pre><code>void make_set(int v) {\n    parent[v] = v;\n    rank[v] = 0;\n}\n\nvoid union_sets(int a, int b) {\n    a = find_set(a);\n    b = find_set(b);\n    if (a != b) {\n        if (rank[a] &lt; rank[b])\n            swap(a, b);\n        parent[b] = a;\n        if (rank[a] == rank[b])\n            rank[a]++;\n    }\n}\n</code></pre> C\u1ea3 hai t\u1ed1i \u01b0u h\u00f3a \u0111\u1ec1u t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1ec1 \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian v\u00e0 kh\u00f4ng gian. V\u00ec v\u1eady, trong th\u1ef1c t\u1ebf, b\u1ea1n c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng b\u1ea5t k\u1ef3 trong s\u1ed1 ch\u00fang.</p>","tags":["Translated"]},{"location":"data_structures/disjoint_set_union.html#time-complexity","title":"\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian (Time complexity)","text":"<p>Nh\u01b0 \u0111\u00e3 \u0111\u1ec1 c\u1eadp tr\u01b0\u1edbc \u0111\u00e2y, n\u1ebfu ch\u00fang ta k\u1ebft h\u1ee3p c\u1ea3 hai t\u1ed1i \u01b0u h\u00f3a - n\u00e9n \u0111\u01b0\u1eddng v\u1edbi h\u1ee3p nh\u1ea5t theo k\u00edch th\u01b0\u1edbc / h\u1ea1ng - ch\u00fang ta s\u1ebd \u0111\u1ea1t \u0111\u01b0\u1ee3c c\u00e1c truy v\u1ea5n th\u1eddi gian g\u1ea7n nh\u01b0 h\u1eb1ng s\u1ed1. H\u00f3a ra, \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian kh\u1ea5u hao cu\u1ed1i c\u00f9ng l\u00e0 $O(\\alpha(n))$, trong \u0111\u00f3 $\\alpha(n)$ l\u00e0 h\u00e0m Ackermann ngh\u1ecbch \u0111\u1ea3o, ph\u00e1t tri\u1ec3n r\u1ea5t ch\u1eadm. Tr\u00ean th\u1ef1c t\u1ebf n\u00f3 ph\u00e1t tri\u1ec3n ch\u1eadm \u0111\u1ebfn m\u1ee9c, n\u00f3 kh\u00f4ng v\u01b0\u1ee3t qu\u00e1 $4$ cho t\u1ea5t c\u1ea3 c\u00e1c $n$ h\u1ee3p l\u00fd (kho\u1ea3ng $n &lt; 10^{600}$).</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p kh\u1ea5u hao l\u00e0 t\u1ed5ng th\u1eddi gian cho m\u1ed7i ho\u1ea1t \u0111\u1ed9ng, \u0111\u01b0\u1ee3c \u0111\u00e1nh gi\u00e1 qua m\u1ed9t chu\u1ed7i nhi\u1ec1u ho\u1ea1t \u0111\u1ed9ng. \u00dd t\u01b0\u1edfng l\u00e0 \u0111\u1ea3m b\u1ea3o t\u1ed5ng th\u1eddi gian c\u1ee7a to\u00e0n b\u1ed9 chu\u1ed7i, trong khi cho ph\u00e9p c\u00e1c ho\u1ea1t \u0111\u1ed9ng \u0111\u01a1n l\u1ebb ch\u1eadm h\u01a1n nhi\u1ec1u so v\u1edbi th\u1eddi gian kh\u1ea5u hao. V\u00ed d\u1ee5: trong tr\u01b0\u1eddng h\u1ee3p c\u1ee7a ch\u00fang ta, m\u1ed9t cu\u1ed9c g\u1ecdi \u0111\u01a1n l\u1ebb c\u00f3 th\u1ec3 m\u1ea5t $O(\\log n)$ trong tr\u01b0\u1eddng h\u1ee3p x\u1ea5u nh\u1ea5t, nh\u01b0ng n\u1ebfu ch\u00fang ta th\u1ef1c hi\u1ec7n $m$ cu\u1ed9c g\u1ecdi nh\u01b0 v\u1eady li\u00ean ti\u1ebfp, ch\u00fang ta s\u1ebd k\u1ebft th\u00fac v\u1edbi th\u1eddi gian trung b\u00ecnh l\u00e0 $O(\\alpha(n))$.</p> <p>Ch\u00fang t\u00f4i c\u0169ng s\u1ebd kh\u00f4ng tr\u00ecnh b\u00e0y b\u1eb1ng ch\u1ee9ng cho \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian n\u00e0y, v\u00ec n\u00f3 kh\u00e1 d\u00e0i v\u00e0 ph\u1ee9c t\u1ea1p.</p> <p>Ngo\u00e0i ra, \u0111i\u1ec1u \u0111\u00e1ng n\u00f3i l\u00e0 DSU c\u00f3 h\u1ee3p nh\u1ea5t theo k\u00edch th\u01b0\u1edbc / h\u1ea1ng, nh\u01b0ng kh\u00f4ng n\u00e9n \u0111\u01b0\u1eddng ho\u1ea1t \u0111\u1ed9ng trong th\u1eddi gian $O(\\log n)$ cho m\u1ed7i truy v\u1ea5n.</p>","tags":["Translated"]},{"location":"data_structures/disjoint_set_union.html#linking-by-index-coin-flip-linking","title":"Li\u00ean k\u1ebft theo ch\u1ec9 s\u1ed1 / li\u00ean k\u1ebft tung \u0111\u1ed3ng xu (Linking by index / coin-flip linking)","text":"<p>C\u1ea3 h\u1ee3p nh\u1ea5t theo h\u1ea1ng v\u00e0 h\u1ee3p nh\u1ea5t theo k\u00edch th\u01b0\u1edbc \u0111\u1ec1u y\u00eau c\u1ea7u b\u1ea1n l\u01b0u tr\u1eef th\u00eam d\u1eef li\u1ec7u cho m\u1ed7i t\u1eadp h\u1ee3p, v\u00e0 duy tr\u00ec c\u00e1c gi\u00e1 tr\u1ecb n\u00e0y trong m\u1ed7i thao t\u00e1c h\u1ee3p nh\u1ea5t. C\u0169ng t\u1ed3n t\u1ea1i m\u1ed9t thu\u1eadt to\u00e1n ng\u1eabu nhi\u00ean, gi\u00fap \u0111\u01a1n gi\u1ea3n h\u00f3a thao t\u00e1c h\u1ee3p nh\u1ea5t m\u1ed9t ch\u00fat: li\u00ean k\u1ebft theo ch\u1ec9 s\u1ed1.</p> <p>Ch\u00fang ta g\u00e1n cho m\u1ed7i t\u1eadp h\u1ee3p m\u1ed9t gi\u00e1 tr\u1ecb ng\u1eabu nhi\u00ean \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 ch\u1ec9 s\u1ed1, v\u00e0 ch\u00fang ta g\u1eafn t\u1eadp h\u1ee3p c\u00f3 ch\u1ec9 s\u1ed1 nh\u1ecf h\u01a1n v\u00e0o t\u1eadp h\u1ee3p c\u00f3 ch\u1ec9 s\u1ed1 l\u1edbn h\u01a1n. C\u00f3 kh\u1ea3 n\u0103ng l\u00e0 m\u1ed9t t\u1eadp h\u1ee3p l\u1edbn h\u01a1n s\u1ebd c\u00f3 ch\u1ec9 s\u1ed1 l\u1edbn h\u01a1n t\u1eadp h\u1ee3p nh\u1ecf h\u01a1n, do \u0111\u00f3 thao t\u00e1c n\u00e0y li\u00ean quan ch\u1eb7t ch\u1ebd \u0111\u1ebfn h\u1ee3p nh\u1ea5t theo k\u00edch th\u01b0\u1edbc. Tr\u00ean th\u1ef1c t\u1ebf, c\u00f3 th\u1ec3 ch\u1ee9ng minh r\u1eb1ng, ho\u1ea1t \u0111\u1ed9ng n\u00e0y c\u00f3 c\u00f9ng \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian v\u1edbi h\u1ee3p nh\u1ea5t theo k\u00edch th\u01b0\u1edbc. Tuy nhi\u00ean trong th\u1ef1c t\u1ebf, n\u00f3 ch\u1eadm h\u01a1n m\u1ed9t ch\u00fat so v\u1edbi h\u1ee3p nh\u1ea5t theo k\u00edch th\u01b0\u1edbc.</p> <p>B\u1ea1n c\u00f3 th\u1ec3 t\u00ecm th\u1ea5y b\u1eb1ng ch\u1ee9ng v\u1ec1 \u0111\u1ed9 ph\u1ee9c t\u1ea1p v\u00e0 th\u1eadm ch\u00ed nhi\u1ec1u k\u1ef9 thu\u1eadt h\u1ee3p nh\u1ea5t h\u01a1n t\u1ea1i \u0111\u00e2y.</p> <pre><code>void make_set(int v) {\n    parent[v] = v;\n    index[v] = rand();\n}\n\nvoid union_sets(int a, int b) {\n    a = find_set(a);\n    b = find_set(b);\n    if (a != b) {\n        if (index[a] &lt; index[b])\n            swap(a, b);\n        parent[b] = a;\n    }\n}\n</code></pre> <p>M\u1ed9t quan ni\u1ec7m sai l\u1ea7m ph\u1ed5 bi\u1ebfn l\u00e0 ch\u1ec9 c\u1ea7n tung \u0111\u1ed3ng xu, \u0111\u1ec3 quy\u1ebft \u0111\u1ecbnh t\u1eadp h\u1ee3p n\u00e0o ch\u00fang ta g\u1eafn v\u00e0o t\u1eadp h\u1ee3p kh\u00e1c, c\u00f3 c\u00f9ng \u0111\u1ed9 ph\u1ee9c t\u1ea1p. Tuy nhi\u00ean \u0111\u00f3 kh\u00f4ng ph\u1ea3i l\u00e0 s\u1ef1 th\u1eadt. B\u00e0i b\u00e1o \u0111\u01b0\u1ee3c li\u00ean k\u1ebft \u1edf tr\u00ean ph\u1ecfng \u0111o\u00e1n r\u1eb1ng li\u00ean k\u1ebft tung \u0111\u1ed3ng xu k\u1ebft h\u1ee3p v\u1edbi n\u00e9n \u0111\u01b0\u1eddng c\u00f3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p $\\Omega\\left(n \\frac{\\log n}{\\log \\log n}\\right)$. V\u00e0 trong c\u00e1c \u0111i\u1ec3m chu\u1ea9n, n\u00f3 ho\u1ea1t \u0111\u1ed9ng t\u1ed3i t\u1ec7 h\u01a1n nhi\u1ec1u so v\u1edbi h\u1ee3p nh\u1ea5t theo k\u00edch th\u01b0\u1edbc/h\u1ea1ng ho\u1eb7c li\u00ean k\u1ebft theo ch\u1ec9 s\u1ed1.</p> <pre><code>void union_sets(int a, int b) {\n    a = find_set(a);\n    b = find_set(b);\n    if (a != b) {\n        if (rand() % 2)\n            swap(a, b);\n        parent[b] = a;\n    }\n}\n</code></pre>","tags":["Translated"]},{"location":"data_structures/disjoint_set_union.html#applications-and-various-improvements","title":"\u1ee8ng d\u1ee5ng v\u00e0 c\u00e1c c\u1ea3i ti\u1ebfn kh\u00e1c (Applications and various improvements)","text":"<p>Trong ph\u1ea7n n\u00e0y ch\u00fang ta xem x\u00e9t m\u1ed9t s\u1ed1 \u1ee9ng d\u1ee5ng c\u1ee7a c\u1ea5u tr\u00fac d\u1eef li\u1ec7u, c\u1ea3 nh\u1eefng c\u00f4ng d\u1ee5ng t\u1ea7m th\u01b0\u1eddng v\u00e0 m\u1ed9t s\u1ed1 c\u1ea3i ti\u1ebfn cho c\u1ea5u tr\u00fac d\u1eef li\u1ec7u.</p>","tags":["Translated"]},{"location":"data_structures/disjoint_set_union.html#connected-components-in-a-graph","title":"Th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng trong \u0111\u1ed3 th\u1ecb (Connected components in a graph)","text":"<p>\u0110\u00e2y l\u00e0 m\u1ed9t trong nh\u1eefng \u1ee9ng d\u1ee5ng r\u00f5 r\u00e0ng c\u1ee7a DSU.</p> <p>M\u1ed9t c\u00e1ch ch\u00ednh th\u1ee9c, b\u00e0i to\u00e1n \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a theo c\u00e1ch sau: Ban \u0111\u1ea7u ch\u00fang ta c\u00f3 m\u1ed9t \u0111\u1ed3 th\u1ecb r\u1ed7ng. Ch\u00fang ta ph\u1ea3i th\u00eam c\u00e1c \u0111\u1ec9nh v\u00e0 c\u00e1c c\u1ea1nh v\u00f4 h\u01b0\u1edbng, v\u00e0 tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n c\u00f3 d\u1ea1ng $(a, b)$ - \"c\u00e1c \u0111\u1ec9nh $a$ v\u00e0 $b$ c\u00f3 n\u1eb1m trong c\u00f9ng m\u1ed9t th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng c\u1ee7a \u0111\u1ed3 th\u1ecb kh\u00f4ng?\"</p> <p>\u1ede \u0111\u00e2y ch\u00fang ta c\u00f3 th\u1ec3 \u00e1p d\u1ee5ng tr\u1ef1c ti\u1ebfp c\u1ea5u tr\u00fac d\u1eef li\u1ec7u n\u00e0y, v\u00e0 nh\u1eadn \u0111\u01b0\u1ee3c m\u1ed9t gi\u1ea3i ph\u00e1p x\u1eed l\u00fd vi\u1ec7c th\u00eam m\u1ed9t \u0111\u1ec9nh ho\u1eb7c m\u1ed9t c\u1ea1nh v\u00e0 m\u1ed9t truy v\u1ea5n trong th\u1eddi gian trung b\u00ecnh g\u1ea7n nh\u01b0 h\u1eb1ng s\u1ed1.</p> <p>\u1ee8ng d\u1ee5ng n\u00e0y kh\u00e1 quan tr\u1ecdng, b\u1edfi v\u00ec b\u00e0i to\u00e1n g\u1ea7n nh\u01b0 t\u01b0\u01a1ng t\u1ef1 xu\u1ea5t hi\u1ec7n trong Thu\u1eadt to\u00e1n Kruskal \u0111\u1ec3 t\u00ecm c\u00e2y khung nh\u1ecf nh\u1ea5t. S\u1eed d\u1ee5ng DSU, ch\u00fang ta c\u00f3 th\u1ec3 c\u1ea3i thi\u1ec7n \u0111\u1ed9 ph\u1ee9c t\u1ea1p $O(m \\log n + n^2)$ th\u00e0nh $O(m \\log n)$.</p>","tags":["Translated"]},{"location":"data_structures/disjoint_set_union.html#search-for-connected-components-in-an-image","title":"T\u00ecm ki\u1ebfm c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng trong \u1ea3nh (Search for connected components in an image)","text":"<p>M\u1ed9t trong nh\u1eefng \u1ee9ng d\u1ee5ng c\u1ee7a DSU l\u00e0 nhi\u1ec7m v\u1ee5 sau: c\u00f3 m\u1ed9t h\u00ecnh \u1ea3nh $n \\times m$ pixel. Ban \u0111\u1ea7u t\u1ea5t c\u1ea3 \u0111\u1ec1u m\u00e0u tr\u1eafng, nh\u01b0ng sau \u0111\u00f3 m\u1ed9t v\u00e0i pixel m\u00e0u \u0111en \u0111\u01b0\u1ee3c v\u1ebd. B\u1ea1n mu\u1ed1n x\u00e1c \u0111\u1ecbnh k\u00edch th\u01b0\u1edbc c\u1ee7a m\u1ed7i th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u00e0u tr\u1eafng trong h\u00ecnh \u1ea3nh cu\u1ed1i c\u00f9ng.</p> <p>\u0110\u1ed1i v\u1edbi gi\u1ea3i ph\u00e1p, ch\u00fang ta ch\u1ec9 c\u1ea7n l\u1eb7p qua t\u1ea5t c\u1ea3 c\u00e1c pixel m\u00e0u tr\u1eafng trong h\u00ecnh \u1ea3nh, \u0111\u1ed1i v\u1edbi m\u1ed7i \u00f4 l\u1eb7p qua b\u1ed1n h\u00e0ng x\u00f3m c\u1ee7a n\u00f3, v\u00e0 n\u1ebfu h\u00e0ng x\u00f3m l\u00e0 m\u00e0u tr\u1eafng th\u00ec g\u1ecdi <code>union_sets</code>. Do \u0111\u00f3 ch\u00fang ta s\u1ebd c\u00f3 m\u1ed9t DSU v\u1edbi $n m$ n\u00fat t\u01b0\u01a1ng \u1ee9ng v\u1edbi c\u00e1c pixel h\u00ecnh \u1ea3nh. C\u00e1c c\u00e2y k\u1ebft qu\u1ea3 trong DSU l\u00e0 c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng mong mu\u1ed1n.</p> <p>B\u00e0i to\u00e1n c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i quy\u1ebft b\u1eb1ng DFS ho\u1eb7c BFS, nh\u01b0ng ph\u01b0\u01a1ng ph\u00e1p \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 \u1edf \u0111\u00e2y c\u00f3 m\u1ed9t l\u1ee3i th\u1ebf: n\u00f3 c\u00f3 th\u1ec3 x\u1eed l\u00fd ma tr\u1eadn theo t\u1eebng h\u00e0ng (t\u1ee9c l\u00e0 \u0111\u1ec3 x\u1eed l\u00fd m\u1ed9t h\u00e0ng ch\u00fang ta ch\u1ec9 c\u1ea7n h\u00e0ng tr\u01b0\u1edbc \u0111\u00f3 v\u00e0 h\u00e0ng hi\u1ec7n t\u1ea1i, v\u00e0 ch\u1ec9 c\u1ea7n m\u1ed9t DSU \u0111\u01b0\u1ee3c x\u00e2y d\u1ef1ng cho c\u00e1c ph\u1ea7n t\u1eed c\u1ee7a m\u1ed9t h\u00e0ng) trong b\u1ed9 nh\u1edb $O(\\min(n, m))$.</p>","tags":["Translated"]},{"location":"data_structures/disjoint_set_union.html#store-additional-information-for-each-set","title":"L\u01b0u tr\u1eef th\u00eam th\u00f4ng tin cho m\u1ed7i t\u1eadp h\u1ee3p (Store additional information for each set)","text":"<p>DSU cho ph\u00e9p b\u1ea1n d\u1ec5 d\u00e0ng l\u01b0u tr\u1eef th\u00eam th\u00f4ng tin trong c\u00e1c t\u1eadp h\u1ee3p.</p> <p>M\u1ed9t v\u00ed d\u1ee5 \u0111\u01a1n gi\u1ea3n l\u00e0 k\u00edch th\u01b0\u1edbc c\u1ee7a c\u00e1c t\u1eadp h\u1ee3p: vi\u1ec7c l\u01b0u tr\u1eef k\u00edch th\u01b0\u1edbc \u0111\u00e3 \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 trong ph\u1ea7n H\u1ee3p nh\u1ea5t theo k\u00edch th\u01b0\u1edbc (th\u00f4ng tin \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef b\u1edfi \u0111\u1ea1i di\u1ec7n hi\u1ec7n t\u1ea1i c\u1ee7a t\u1eadp h\u1ee3p).</p> <p>Theo c\u00f9ng m\u1ed9t c\u00e1ch - b\u1eb1ng c\u00e1ch l\u01b0u tr\u1eef n\u00f3 t\u1ea1i c\u00e1c n\u00fat \u0111\u1ea1i di\u1ec7n - b\u1ea1n c\u0169ng c\u00f3 th\u1ec3 l\u01b0u tr\u1eef b\u1ea5t k\u1ef3 th\u00f4ng tin n\u00e0o kh\u00e1c v\u1ec1 c\u00e1c t\u1eadp h\u1ee3p.</p>","tags":["Translated"]},{"location":"data_structures/disjoint_set_union.html#compress-jumps-along-a-segment-painting-subarrays-offline","title":"N\u00e9n c\u00e1c b\u01b0\u1edbc nh\u1ea3y d\u1ecdc theo \u0111o\u1ea1n / T\u00f4 m\u00e0u c\u00e1c m\u1ea3ng con offline (Compress jumps along a segment / Painting subarrays offline)","text":"<p>M\u1ed9t \u1ee9ng d\u1ee5ng ph\u1ed5 bi\u1ebfn c\u1ee7a DSU l\u00e0 nh\u01b0 sau: C\u00f3 m\u1ed9t t\u1eadp h\u1ee3p c\u00e1c \u0111\u1ec9nh, v\u00e0 m\u1ed7i \u0111\u1ec9nh c\u00f3 m\u1ed9t c\u1ea1nh \u0111i ra \u0111\u1ebfn m\u1ed9t \u0111\u1ec9nh kh\u00e1c. V\u1edbi DSU b\u1ea1n c\u00f3 th\u1ec3 t\u00ecm \u0111i\u1ec3m cu\u1ed1i, m\u00e0 ch\u00fang ta \u0111\u1ebfn \u0111\u01b0\u1ee3c sau khi \u0111i theo t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh t\u1eeb m\u1ed9t \u0111i\u1ec3m b\u1eaft \u0111\u1ea7u nh\u1ea5t \u0111\u1ecbnh, trong th\u1eddi gian g\u1ea7n nh\u01b0 h\u1eb1ng s\u1ed1.</p> <p>M\u1ed9t v\u00ed d\u1ee5 \u0111i\u1ec3n h\u00ecnh c\u1ee7a \u1ee9ng d\u1ee5ng n\u00e0y l\u00e0 b\u00e0i to\u00e1n t\u00f4 m\u00e0u c\u00e1c m\u1ea3ng con. Ch\u00fang ta c\u00f3 m\u1ed9t \u0111o\u1ea1n c\u00f3 \u0111\u1ed9 d\u00e0i $L$, m\u1ed7i ph\u1ea7n t\u1eed ban \u0111\u1ea7u c\u00f3 m\u00e0u 0. Ch\u00fang ta ph\u1ea3i t\u00f4 l\u1ea1i m\u1ea3ng con $[l, r]$ v\u1edbi m\u00e0u $c$ cho m\u1ed7i truy v\u1ea5n $(l, r, c)$. Cu\u1ed1i c\u00f9ng ch\u00fang ta mu\u1ed1n t\u00ecm m\u00e0u cu\u1ed1i c\u00f9ng c\u1ee7a m\u1ed7i \u00f4. Ch\u00fang ta gi\u1ea3 s\u1eed r\u1eb1ng ch\u00fang ta bi\u1ebft tr\u01b0\u1edbc t\u1ea5t c\u1ea3 c\u00e1c truy v\u1ea5n, t\u1ee9c l\u00e0 nhi\u1ec7m v\u1ee5 l\u00e0 offline.</p> <p>\u0110\u1ed1i v\u1edbi gi\u1ea3i ph\u00e1p, ch\u00fang ta c\u00f3 th\u1ec3 t\u1ea1o m\u1ed9t DSU, trong \u0111\u00f3 m\u1ed7i \u00f4 l\u01b0u tr\u1eef m\u1ed9t li\u00ean k\u1ebft \u0111\u1ebfn \u00f4 ch\u01b0a \u0111\u01b0\u1ee3c t\u00f4 ti\u1ebfp theo. Do \u0111\u00f3 ban \u0111\u1ea7u m\u1ed7i \u00f4 tr\u1ecf \u0111\u1ebfn ch\u00ednh n\u00f3. Sau khi t\u00f4 m\u1ed9t l\u1ea7n t\u00f4 l\u1ea1i \u0111\u01b0\u1ee3c y\u00eau c\u1ea7u c\u1ee7a m\u1ed9t \u0111o\u1ea1n, t\u1ea5t c\u1ea3 c\u00e1c \u00f4 t\u1eeb \u0111o\u1ea1n \u0111\u00f3 s\u1ebd tr\u1ecf \u0111\u1ebfn \u00f4 sau \u0111o\u1ea1n \u0111\u00f3.</p> <p>B\u00e2y gi\u1edd \u0111\u1ec3 gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 n\u00e0y, ch\u00fang ta xem x\u00e9t c\u00e1c truy v\u1ea5n theo th\u1ee9 t\u1ef1 ng\u01b0\u1ee3c l\u1ea1i: t\u1eeb cu\u1ed1i c\u00f9ng \u0111\u1ebfn \u0111\u1ea7u ti\u00ean. B\u1eb1ng c\u00e1ch n\u00e0y khi ch\u00fang ta th\u1ef1c hi\u1ec7n m\u1ed9t truy v\u1ea5n, ch\u00fang ta ch\u1ec9 ph\u1ea3i t\u00f4 ch\u00ednh x\u00e1c c\u00e1c \u00f4 ch\u01b0a \u0111\u01b0\u1ee3c t\u00f4 trong m\u1ea3ng con $[l, r]$. T\u1ea5t c\u1ea3 c\u00e1c \u00f4 kh\u00e1c \u0111\u00e3 ch\u1ee9a m\u00e0u cu\u1ed1i c\u00f9ng c\u1ee7a ch\u00fang. \u0110\u1ec3 l\u1eb7p nhanh qua t\u1ea5t c\u1ea3 c\u00e1c \u00f4 ch\u01b0a \u0111\u01b0\u1ee3c t\u00f4, ch\u00fang ta s\u1eed d\u1ee5ng DSU. Ch\u00fang ta t\u00ecm \u00f4 ch\u01b0a \u0111\u01b0\u1ee3c t\u00f4 ngo\u00e0i c\u00f9ng b\u00ean tr\u00e1i b\u00ean trong m\u1ed9t \u0111o\u1ea1n, t\u00f4 l\u1ea1i n\u00f3, v\u00e0 v\u1edbi con tr\u1ecf ch\u00fang ta di chuy\u1ec3n \u0111\u1ebfn \u00f4 tr\u1ed1ng ti\u1ebfp theo b\u00ean ph\u1ea3i.</p> <p>\u1ede \u0111\u00e2y ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng DSU v\u1edbi n\u00e9n \u0111\u01b0\u1eddng, nh\u01b0ng ch\u00fang ta kh\u00f4ng th\u1ec3 s\u1eed d\u1ee5ng h\u1ee3p nh\u1ea5t theo h\u1ea1ng / k\u00edch th\u01b0\u1edbc (v\u00ec \u0111i\u1ec1u quan tr\u1ecdng l\u00e0 ai tr\u1edf th\u00e0nh l\u00e3nh \u0111\u1ea1o sau khi h\u1ee3p nh\u1ea5t). Do \u0111\u00f3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p s\u1ebd l\u00e0 $O(\\log n)$ cho m\u1ed7i l\u1ea7n h\u1ee3p nh\u1ea5t (c\u0169ng kh\u00e1 nhanh).</p> <p>C\u00e0i \u0111\u1eb7t:</p> <pre><code>for (int i = 0; i &lt;= L; i++) {\n    make_set(i);\n}\n\nfor (int i = m-1; i &gt;= 0; i--) {\n    int l = query[i].l;\n    int r = query[i].r;\n    int c = query[i].c;\n    for (int v = find_set(l); v &lt;= r; v = find_set(v)) {\n        answer[v] = c;\n        parent[v] = v + 1;\n    }\n}\n</code></pre> <p>C\u00f3 m\u1ed9t s\u1ef1 t\u1ed1i \u01b0u h\u00f3a: Ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng h\u1ee3p nh\u1ea5t theo h\u1ea1ng / k\u00edch th\u01b0\u1edbc, n\u1ebfu ch\u00fang ta l\u01b0u tr\u1eef \u00f4 ch\u01b0a \u0111\u01b0\u1ee3c t\u00f4 ti\u1ebfp theo trong m\u1ed9t m\u1ea3ng b\u1ed5 sung <code>end[]</code>. Sau \u0111\u00f3 ch\u00fang ta c\u00f3 th\u1ec3 h\u1ee3p nh\u1ea5t hai t\u1eadp h\u1ee3p th\u00e0nh m\u1ed9t theo heuristic c\u1ee7a ch\u00fang, v\u00e0 ch\u00fang ta c\u00f3 \u0111\u01b0\u1ee3c gi\u1ea3i ph\u00e1p trong $O(\\alpha(n))$.</p>","tags":["Translated"]},{"location":"data_structures/disjoint_set_union.html#support-distances-up-to-representative","title":"H\u1ed7 tr\u1ee3 kho\u1ea3ng c\u00e1ch \u0111\u1ebfn \u0111\u1ea1i di\u1ec7n (Support distances up to representative)","text":"<p>\u0110\u00f4i khi trong c\u00e1c \u1ee9ng d\u1ee5ng c\u1ee5 th\u1ec3 c\u1ee7a DSU, b\u1ea1n c\u1ea7n duy tr\u00ec kho\u1ea3ng c\u00e1ch gi\u1eefa m\u1ed9t \u0111\u1ec9nh v\u00e0 \u0111\u1ea1i di\u1ec7n c\u1ee7a t\u1eadp h\u1ee3p c\u1ee7a n\u00f3 (t\u1ee9c l\u00e0 \u0111\u1ed9 d\u00e0i \u0111\u01b0\u1eddng \u0111i trong c\u00e2y t\u1eeb n\u00fat hi\u1ec7n t\u1ea1i \u0111\u1ebfn g\u1ed1c c\u1ee7a c\u00e2y).</p> <p>N\u1ebfu ch\u00fang ta kh\u00f4ng s\u1eed d\u1ee5ng n\u00e9n \u0111\u01b0\u1eddng, kho\u1ea3ng c\u00e1ch ch\u1ec9 l\u00e0 s\u1ed1 l\u01b0\u1ee3ng c\u00e1c cu\u1ed9c g\u1ecdi \u0111\u1ec7 quy. Nh\u01b0ng \u0111i\u1ec1u n\u00e0y s\u1ebd kh\u00f4ng hi\u1ec7u qu\u1ea3.</p> <p>Tuy nhi\u00ean, c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n n\u00e9n \u0111\u01b0\u1eddng, n\u1ebfu ch\u00fang ta l\u01b0u tr\u1eef kho\u1ea3ng c\u00e1ch \u0111\u1ebfn cha nh\u01b0 th\u00f4ng tin b\u1ed5 sung cho m\u1ed7i n\u00fat.</p> <p>Trong vi\u1ec7c c\u00e0i \u0111\u1eb7t, thu\u1eadn ti\u1ec7n khi s\u1eed d\u1ee5ng m\u1ed9t m\u1ea3ng c\u00e1c c\u1eb7p cho <code>parent[]</code> v\u00e0 h\u00e0m <code>find_set</code> b\u00e2y gi\u1edd tr\u1ea3 v\u1ec1 hai s\u1ed1: \u0111\u1ea1i di\u1ec7n c\u1ee7a t\u1eadp h\u1ee3p v\u00e0 kho\u1ea3ng c\u00e1ch \u0111\u1ebfn n\u00f3.</p> <pre><code>void make_set(int v) {\n    parent[v] = make_pair(v, 0);\n    rank[v] = 0;\n}\n\npair&lt;int, int&gt; find_set(int v) {\n    if (v != parent[v].first) {\n        int len = parent[v].second;\n        parent[v] = find_set(parent[v].first);\n        parent[v].second += len;\n    }\n    return parent[v];\n}\n\nvoid union_sets(int a, int b) {\n    a = find_set(a).first;\n    b = find_set(b).first;\n    if (a != b) {\n        if (rank[a] &lt; rank[b])\n            swap(a, b);\n        parent[b] = make_pair(a, 1);\n        if (rank[a] == rank[b])\n            rank[a]++;\n    }\n}\n</code></pre>","tags":["Translated"]},{"location":"data_structures/disjoint_set_union.html#support-the-parity-of-the-path-length-checking-bipartiteness-online","title":"H\u1ed7 tr\u1ee3 t\u00ednh ch\u1eb5n l\u1ebb c\u1ee7a \u0111\u1ed9 d\u00e0i \u0111\u01b0\u1eddng \u0111i / Ki\u1ec3m tra t\u00ednh hai ph\u00eda online (Support the parity of the path length / Checking bipartiteness online)","text":"<p>Theo c\u00f9ng m\u1ed9t c\u00e1ch nh\u01b0 t\u00ednh to\u00e1n \u0111\u1ed9 d\u00e0i \u0111\u01b0\u1eddng \u0111i \u0111\u1ebfn l\u00e3nh \u0111\u1ea1o, c\u00f3 th\u1ec3 duy tr\u00ec t\u00ednh ch\u1eb5n l\u1ebb c\u1ee7a \u0111\u1ed9 d\u00e0i \u0111\u01b0\u1eddng \u0111i tr\u01b0\u1edbc anh ta. T\u1ea1i sao \u1ee9ng d\u1ee5ng n\u00e0y n\u1eb1m trong m\u1ed9t \u0111o\u1ea1n ri\u00eang bi\u1ec7t?</p> <p>Y\u00eau c\u1ea7u b\u1ea5t th\u01b0\u1eddng v\u1ec1 vi\u1ec7c l\u01b0u tr\u1eef t\u00ednh ch\u1eb5n l\u1ebb c\u1ee7a \u0111\u01b0\u1eddng \u0111i xu\u1ea5t hi\u1ec7n trong nhi\u1ec7m v\u1ee5 sau: ban \u0111\u1ea7u ch\u00fang ta \u0111\u01b0\u1ee3c cho m\u1ed9t \u0111\u1ed3 th\u1ecb r\u1ed7ng, n\u00f3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u00eam c\u00e1c c\u1ea1nh, v\u00e0 ch\u00fang ta ph\u1ea3i tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n c\u00f3 d\u1ea1ng \"th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng ch\u1ee9a \u0111\u1ec9nh n\u00e0y c\u00f3 ph\u1ea3i l\u00e0 hai ph\u00eda kh\u00f4ng?\".</p> <p>\u0110\u1ec3 gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 n\u00e0y, ch\u00fang ta t\u1ea1o m\u1ed9t DSU \u0111\u1ec3 l\u01b0u tr\u1eef c\u00e1c th\u00e0nh ph\u1ea7n v\u00e0 l\u01b0u tr\u1eef t\u00ednh ch\u1eb5n l\u1ebb c\u1ee7a \u0111\u01b0\u1eddng \u0111i \u0111\u1ebfn \u0111\u1ea1i di\u1ec7n cho m\u1ed7i \u0111\u1ec9nh. Do \u0111\u00f3 ch\u00fang ta c\u00f3 th\u1ec3 nhanh ch\u00f3ng ki\u1ec3m tra xem vi\u1ec7c th\u00eam m\u1ed9t c\u1ea1nh c\u00f3 d\u1eabn \u0111\u1ebfn vi ph\u1ea1m t\u00ednh hai ph\u00eda hay kh\u00f4ng: c\u1ee5 th\u1ec3 l\u00e0 n\u1ebfu c\u00e1c \u0111\u1ea7u m\u00fat c\u1ee7a c\u1ea1nh n\u1eb1m trong c\u00f9ng m\u1ed9t th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng v\u00e0 c\u00f3 c\u00f9ng \u0111\u1ed9 d\u00e0i ch\u1eb5n l\u1ebb \u0111\u1ebfn l\u00e3nh \u0111\u1ea1o, th\u00ec vi\u1ec7c th\u00eam c\u1ea1nh n\u00e0y s\u1ebd t\u1ea1o ra m\u1ed9t chu tr\u00ecnh c\u00f3 \u0111\u1ed9 d\u00e0i l\u1ebb, v\u00e0 th\u00e0nh ph\u1ea7n s\u1ebd m\u1ea5t t\u00ednh ch\u1ea5t hai ph\u00eda.</p> <p>Kh\u00f3 kh\u0103n duy nh\u1ea5t m\u00e0 ch\u00fang ta g\u1eb7p ph\u1ea3i l\u00e0 t\u00ednh to\u00e1n t\u00ednh ch\u1eb5n l\u1ebb trong ph\u01b0\u01a1ng th\u1ee9c <code>union_find</code>.</p> <p>N\u1ebfu ch\u00fang ta th\u00eam m\u1ed9t c\u1ea1nh $(a, b)$ k\u1ebft n\u1ed1i hai th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng th\u00e0nh m\u1ed9t, th\u00ec khi b\u1ea1n g\u1eafn m\u1ed9t c\u00e2y v\u00e0o c\u00e2y kh\u00e1c, ch\u00fang ta c\u1ea7n \u0111i\u1ec1u ch\u1ec9nh t\u00ednh ch\u1eb5n l\u1ebb.</p> <p>H\u00e3y suy ra m\u1ed9t c\u00f4ng th\u1ee9c, t\u00ednh to\u00e1n t\u00ednh ch\u1eb5n l\u1ebb \u0111\u01b0\u1ee3c c\u1ea5p cho l\u00e3nh \u0111\u1ea1o c\u1ee7a t\u1eadp h\u1ee3p s\u1ebd \u0111\u01b0\u1ee3c g\u1eafn v\u00e0o t\u1eadp h\u1ee3p kh\u00e1c. G\u1ecdi $x$ l\u00e0 t\u00ednh ch\u1eb5n l\u1ebb c\u1ee7a \u0111\u1ed9 d\u00e0i \u0111\u01b0\u1eddng \u0111i t\u1eeb \u0111\u1ec9nh $a$ \u0111\u1ebfn l\u00e3nh \u0111\u1ea1o $A$ c\u1ee7a n\u00f3, v\u00e0 $y$ l\u00e0 t\u00ednh ch\u1eb5n l\u1ebb c\u1ee7a \u0111\u1ed9 d\u00e0i \u0111\u01b0\u1eddng \u0111i t\u1eeb \u0111\u1ec9nh $b$ \u0111\u1ebfn l\u00e3nh \u0111\u1ea1o $B$ c\u1ee7a n\u00f3, v\u00e0 $t$ l\u00e0 t\u00ednh ch\u1eb5n l\u1ebb mong mu\u1ed1n m\u00e0 ch\u00fang ta ph\u1ea3i g\u00e1n cho $B$ sau khi h\u1ee3p nh\u1ea5t. \u0110\u01b0\u1eddng \u0111i bao g\u1ed3m ba ph\u1ea7n: t\u1eeb $B$ \u0111\u1ebfn $b$, t\u1eeb $b$ \u0111\u1ebfn $a$, \u0111\u01b0\u1ee3c n\u1ed1i b\u1edfi m\u1ed9t c\u1ea1nh v\u00e0 do \u0111\u00f3 c\u00f3 t\u00ednh ch\u1eb5n l\u1ebb $1$, v\u00e0 t\u1eeb $a$ \u0111\u1ebfn $A$. Do \u0111\u00f3 ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c c\u00f4ng th\u1ee9c ($\\oplus$ bi\u1ec3u th\u1ecb ph\u00e9p to\u00e1n XOR):</p> $$t = x \\oplus y \\oplus 1$$ <p>Do \u0111\u00f3 b\u1ea5t k\u1ec3 ch\u00fang ta th\u1ef1c hi\u1ec7n bao nhi\u00eau l\u1ea7n n\u1ed1i, t\u00ednh ch\u1eb5n l\u1ebb c\u1ee7a c\u00e1c c\u1ea1nh \u0111\u01b0\u1ee3c mang t\u1eeb l\u00e3nh \u0111\u1ea1o n\u00e0y sang l\u00e3nh \u0111\u1ea1o kh\u00e1c.</p> <p>Ch\u00fang t\u00f4i \u0111\u01b0a ra vi\u1ec7c c\u00e0i \u0111\u1eb7t DSU h\u1ed7 tr\u1ee3 t\u00ednh ch\u1eb5n l\u1ebb. Nh\u01b0 trong ph\u1ea7n tr\u01b0\u1edbc, ch\u00fang t\u00f4i s\u1eed d\u1ee5ng m\u1ed9t c\u1eb7p \u0111\u1ec3 l\u01b0u tr\u1eef t\u1ed5 ti\u00ean v\u00e0 t\u00ednh ch\u1eb5n l\u1ebb. Ngo\u00e0i ra \u0111\u1ed1i v\u1edbi m\u1ed7i t\u1eadp h\u1ee3p, ch\u00fang t\u00f4i l\u01b0u tr\u1eef trong m\u1ea3ng <code>bipartite[]</code> xem n\u00f3 c\u00f3 c\u00f2n l\u00e0 hai ph\u00eda hay kh\u00f4ng.</p> <pre><code>void make_set(int v) {\n    parent[v] = make_pair(v, 0);\n    rank[v] = 0;\n    bipartite[v] = true;\n}\n\npair&lt;int, int&gt; find_set(int v) {\n    if (v != parent[v].first) {\n        int parity = parent[v].second;\n        parent[v] = find_set(parent[v].first);\n        parent[v].second ^= parity;\n    }\n    return parent[v];\n}\n\nvoid add_edge(int a, int b) {\n    pair&lt;int, int&gt; pa = find_set(a);\n    a = pa.first;\n    int x = pa.second;\n\n    pair&lt;int, int&gt; pb = find_set(b);\n    b = pb.first;\n    int y = pb.second;\n\n    if (a == b) {\n        if (x == y)\n            bipartite[a] = false;\n    } else {\n        if (rank[a] &lt; rank[b])\n            swap (a, b);\n        parent[b] = make_pair(a, x^y^1);\n        bipartite[a] &amp;= bipartite[b];\n        if (rank[a] == rank[b])\n            ++rank[a];\n    }\n}\n\nbool is_bipartite(int v) {\n    return bipartite[find_set(v).first];\n}\n</code></pre>","tags":["Translated"]},{"location":"data_structures/disjoint_set_union.html#arpa","title":"RMQ offline (truy v\u1ea5n ph\u1ea1m vi t\u1ed1i thi\u1ec3u) trong trung b\u00ecnh $O(\\alpha(n))$ / Th\u1ee7 thu\u1eadt c\u1ee7a Arpa (Offline RMQ (range minimum query) in $O(\\alpha(n))$ on average / Arpa's trick)","text":"<p>Ch\u00fang ta \u0111\u01b0\u1ee3c cho m\u1ed9t m\u1ea3ng <code>a[]</code> v\u00e0 ch\u00fang ta ph\u1ea3i t\u00ednh to\u00e1n m\u1ed9t s\u1ed1 c\u1ef1c ti\u1ec3u trong c\u00e1c \u0111o\u1ea1n nh\u1ea5t \u0111\u1ecbnh c\u1ee7a m\u1ea3ng.</p> <p>\u00dd t\u01b0\u1edfng \u0111\u1ec3 gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 n\u00e0y v\u1edbi DSU nh\u01b0 sau: Ch\u00fang ta s\u1ebd l\u1eb7p qua m\u1ea3ng v\u00e0 khi ch\u00fang ta \u1edf ph\u1ea7n t\u1eed th\u1ee9 <code>i</code>, ch\u00fang ta s\u1ebd tr\u1ea3 l\u1eddi t\u1ea5t c\u1ea3 c\u00e1c truy v\u1ea5n <code>(L, R)</code> v\u1edbi <code>R == i</code>. \u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y m\u1ed9t c\u00e1ch hi\u1ec7u qu\u1ea3, ch\u00fang ta s\u1ebd gi\u1eef m\u1ed9t DSU b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng <code>i</code> ph\u1ea7n t\u1eed \u0111\u1ea7u ti\u00ean v\u1edbi c\u1ea5u tr\u00fac sau: cha c\u1ee7a m\u1ed9t ph\u1ea7n t\u1eed l\u00e0 ph\u1ea7n t\u1eed nh\u1ecf h\u01a1n ti\u1ebfp theo \u1edf b\u00ean ph\u1ea3i c\u1ee7a n\u00f3. Sau \u0111\u00f3 s\u1eed d\u1ee5ng c\u1ea5u tr\u00fac n\u00e0y, c\u00e2u tr\u1ea3 l\u1eddi cho m\u1ed9t truy v\u1ea5n s\u1ebd l\u00e0 <code>a[find_set(L)]</code>, s\u1ed1 nh\u1ecf nh\u1ea5t \u1edf b\u00ean ph\u1ea3i c\u1ee7a <code>L</code>.</p> <p>C\u00e1ch ti\u1ebfp c\u1eadn n\u00e0y r\u00f5 r\u00e0ng ch\u1ec9 ho\u1ea1t \u0111\u1ed9ng offline, t\u1ee9c l\u00e0 n\u1ebfu ch\u00fang ta bi\u1ebft tr\u01b0\u1edbc t\u1ea5t c\u1ea3 c\u00e1c truy v\u1ea5n.</p> <p>D\u1ec5 th\u1ea5y r\u1eb1ng ch\u00fang ta c\u00f3 th\u1ec3 \u00e1p d\u1ee5ng n\u00e9n \u0111\u01b0\u1eddng. V\u00e0 ch\u00fang ta c\u0169ng c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng H\u1ee3p nh\u1ea5t theo h\u1ea1ng, n\u1ebfu ch\u00fang ta l\u01b0u tr\u1eef l\u00e3nh \u0111\u1ea1o th\u1ef1c t\u1ebf trong m\u1ed9t m\u1ea3ng ri\u00eang bi\u1ec7t.</p> <pre><code>struct Query {\n    int L, R, idx;\n};\n\nvector&lt;int&gt; answer;\nvector&lt;vector&lt;Query&gt;&gt; container;\n</code></pre> <p><code>container[i]</code> ch\u1ee9a t\u1ea5t c\u1ea3 c\u00e1c truy v\u1ea5n v\u1edbi <code>R == i</code>.</p> <pre><code>stack&lt;int&gt; s;\nfor (int i = 0; i &lt; n; i++) {\n    while (!s.empty() &amp;&amp; a[s.top()] &gt; a[i]) {\n        parent[s.top()] = i;\n        s.pop();\n    }\n    s.push(i);\n    for (Query q : container[i]) {\n        answer[q.idx] = a[find_set(q.L)];\n    }\n}\n</code></pre> <p>Ng\u00e0y nay thu\u1eadt to\u00e1n n\u00e0y \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 th\u1ee7 thu\u1eadt c\u1ee7a Arpa. N\u00f3 \u0111\u01b0\u1ee3c \u0111\u1eb7t t\u00ean theo AmirReza Poorakhavan, ng\u01b0\u1eddi \u0111\u00e3 \u0111\u1ed9c l\u1eadp ph\u00e1t hi\u1ec7n v\u00e0 ph\u1ed5 bi\u1ebfn k\u1ef9 thu\u1eadt n\u00e0y. M\u1eb7c d\u00f9 thu\u1eadt to\u00e1n n\u00e0y \u0111\u00e3 t\u1ed3n t\u1ea1i tr\u01b0\u1edbc khi anh \u1ea5y ph\u00e1t hi\u1ec7n ra.</p>","tags":["Translated"]},{"location":"data_structures/disjoint_set_union.html#offline-lca","title":"LCA offline (t\u1ed5 ti\u00ean chung th\u1ea5p nh\u1ea5t trong c\u00e2y) trong trung b\u00ecnh $O(\\alpha(n))$ (Offline LCA (lowest common ancestor in a tree) in $O(\\alpha(n))$ on average)","text":"<p>Thu\u1eadt to\u00e1n \u0111\u1ec3 t\u00ecm LCA \u0111\u01b0\u1ee3c th\u1ea3o lu\u1eadn trong b\u00e0i vi\u1ebft T\u1ed5 ti\u00ean chung th\u1ea5p nh\u1ea5t - Thu\u1eadt to\u00e1n offline c\u1ee7a Tarjan. Thu\u1eadt to\u00e1n n\u00e0y so s\u00e1nh thu\u1eadn l\u1ee3i v\u1edbi c\u00e1c thu\u1eadt to\u00e1n kh\u00e1c \u0111\u1ec3 t\u00ecm LCA do s\u1ef1 \u0111\u01a1n gi\u1ea3n c\u1ee7a n\u00f3 (\u0111\u1eb7c bi\u1ec7t l\u00e0 so v\u1edbi m\u1ed9t thu\u1eadt to\u00e1n t\u1ed1i \u01b0u nh\u01b0 thu\u1eadt to\u00e1n t\u1eeb Farach-Colton v\u00e0 Bender).</p>","tags":["Translated"]},{"location":"data_structures/disjoint_set_union.html#storing-the-dsu-explicitly-in-a-set-list-applications-of-this-idea-when-merging-various-data-structures","title":"L\u01b0u tr\u1eef DSU r\u00f5 r\u00e0ng trong danh s\u00e1ch t\u1eadp h\u1ee3p / \u1ee8ng d\u1ee5ng c\u1ee7a \u00fd t\u01b0\u1edfng n\u00e0y khi h\u1ee3p nh\u1ea5t c\u00e1c c\u1ea5u tr\u00fac d\u1eef li\u1ec7u kh\u00e1c nhau (Storing the DSU explicitly in a set list / Applications of this idea when merging various data structures)","text":"<p>M\u1ed9t trong nh\u1eefng c\u00e1ch thay th\u1ebf \u0111\u1ec3 l\u01b0u tr\u1eef DSU l\u00e0 b\u1ea3o t\u1ed3n m\u1ed7i t\u1eadp h\u1ee3p d\u01b0\u1edbi d\u1ea1ng m\u1ed9t danh s\u00e1ch c\u00e1c ph\u1ea7n t\u1eed \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef r\u00f5 r\u00e0ng. \u0110\u1ed3ng th\u1eddi m\u1ed7i ph\u1ea7n t\u1eed c\u0169ng l\u01b0u tr\u1eef tham chi\u1ebfu \u0111\u1ebfn \u0111\u1ea1i di\u1ec7n c\u1ee7a t\u1eadp h\u1ee3p c\u1ee7a n\u00f3.</p> <p>Tho\u1ea1t nh\u00ecn, \u0111i\u1ec1u n\u00e0y tr\u00f4ng gi\u1ed1ng nh\u01b0 m\u1ed9t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u kh\u00f4ng hi\u1ec7u qu\u1ea3: b\u1eb1ng c\u00e1ch k\u1ebft h\u1ee3p hai t\u1eadp h\u1ee3p, ch\u00fang ta s\u1ebd ph\u1ea3i th\u00eam m\u1ed9t danh s\u00e1ch v\u00e0o cu\u1ed1i danh s\u00e1ch kh\u00e1c v\u00e0 ph\u1ea3i c\u1eadp nh\u1eadt quy\u1ec1n l\u00e3nh \u0111\u1ea1o trong t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed c\u1ee7a m\u1ed9t trong c\u00e1c danh s\u00e1ch.</p> <p>Tuy nhi\u00ean h\u00f3a ra, vi\u1ec7c s\u1eed d\u1ee5ng heuristic tr\u1ecdng s\u1ed1 (t\u01b0\u01a1ng t\u1ef1 nh\u01b0 H\u1ee3p nh\u1ea5t theo k\u00edch th\u01b0\u1edbc) c\u00f3 th\u1ec3 l\u00e0m gi\u1ea3m \u0111\u00e1ng k\u1ec3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p ti\u1ec7m c\u1eadn: $O(m + n \\log n)$ \u0111\u1ec3 th\u1ef1c hi\u1ec7n $m$ truy v\u1ea5n tr\u00ean $n$ ph\u1ea7n t\u1eed.</p> <p>D\u01b0\u1edbi heuristic tr\u1ecdng s\u1ed1, ch\u00fang t\u00f4i mu\u1ed1n n\u00f3i r\u1eb1ng, ch\u00fang t\u00f4i s\u1ebd lu\u00f4n th\u00eam t\u1eadp h\u1ee3p nh\u1ecf h\u01a1n trong hai t\u1eadp h\u1ee3p v\u00e0o t\u1eadp h\u1ee3p l\u1edbn h\u01a1n. Vi\u1ec7c th\u00eam m\u1ed9t t\u1eadp h\u1ee3p v\u00e0o t\u1eadp h\u1ee3p kh\u00e1c r\u1ea5t d\u1ec5 th\u1ef1c hi\u1ec7n trong <code>union_sets</code> v\u00e0 s\u1ebd m\u1ea5t th\u1eddi gian t\u1ef7 l\u1ec7 thu\u1eadn v\u1edbi k\u00edch th\u01b0\u1edbc c\u1ee7a t\u1eadp h\u1ee3p \u0111\u01b0\u1ee3c th\u00eam v\u00e0o. V\u00e0 vi\u1ec7c t\u00ecm ki\u1ebfm l\u00e3nh \u0111\u1ea1o trong <code>find_set</code> s\u1ebd m\u1ea5t $O(1)$ v\u1edbi ph\u01b0\u01a1ng ph\u00e1p l\u01b0u tr\u1eef n\u00e0y.</p> <p>H\u00e3y ch\u1ee9ng minh \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian $O(m + n \\log n)$ cho vi\u1ec7c th\u1ef1c hi\u1ec7n $m$ truy v\u1ea5n. Ch\u00fang ta s\u1ebd c\u1ed1 \u0111\u1ecbnh m\u1ed9t ph\u1ea7n t\u1eed $x$ t\u00f9y \u00fd v\u00e0 \u0111\u1ebfm xem n\u00f3 \u0111\u01b0\u1ee3c ch\u1ea1m bao nhi\u00eau l\u1ea7n trong thao t\u00e1c h\u1ee3p nh\u1ea5t <code>union_sets</code>. Khi ph\u1ea7n t\u1eed $x$ \u0111\u01b0\u1ee3c ch\u1ea1m l\u1ea7n \u0111\u1ea7u ti\u00ean, k\u00edch th\u01b0\u1edbc c\u1ee7a t\u1eadp h\u1ee3p m\u1edbi s\u1ebd \u00edt nh\u1ea5t l\u00e0 $2$. Khi n\u00f3 \u0111\u01b0\u1ee3c ch\u1ea1m l\u1ea7n th\u1ee9 hai, t\u1eadp h\u1ee3p k\u1ebft qu\u1ea3 s\u1ebd c\u00f3 k\u00edch th\u01b0\u1edbc \u00edt nh\u1ea5t l\u00e0 $4$, b\u1edfi v\u00ec t\u1eadp h\u1ee3p nh\u1ecf h\u01a1n \u0111\u01b0\u1ee3c th\u00eam v\u00e0o t\u1eadp h\u1ee3p l\u1edbn h\u01a1n. V\u00e0 c\u1ee9 th\u1ebf ti\u1ebfp t\u1ee5c. \u0110i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0, $x$ ch\u1ec9 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c di chuy\u1ec3n trong t\u1ed1i \u0111a $\\log n$ thao t\u00e1c h\u1ee3p nh\u1ea5t. Do \u0111\u00f3 t\u1ed5ng tr\u00ean t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh cho $O(n \\log n)$ c\u1ed9ng v\u1edbi $O(1)$ cho m\u1ed7i y\u00eau c\u1ea7u.</p> <p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u1ed9t c\u00e0i \u0111\u1eb7t:</p> <pre><code>vector&lt;int&gt; lst[MAXN];\nint parent[MAXN];\n\nvoid make_set(int v) {\n    lst[v] = vector&lt;int&gt;(1, v);\n    parent[v] = v;\n}\n\nint find_set(int v) {\n    return parent[v];\n}\n\nvoid union_sets(int a, int b) {\n    a = find_set(a);\n    b = find_set(b);\n    if (a != b) {\n        if (lst[a].size() &lt; lst[b].size())\n            swap(a, b);\n        while (!lst[b].empty()) {\n            int v = lst[b].back();\n            lst[b].pop_back();\n            parent[v] = a;\n            lst[a].push_back (v);\n        }\n    }\n}\n</code></pre> <p>\u00dd t\u01b0\u1edfng th\u00eam ph\u1ea7n nh\u1ecf h\u01a1n v\u00e0o ph\u1ea7n l\u1edbn h\u01a1n n\u00e0y c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng trong r\u1ea5t nhi\u1ec1u gi\u1ea3i ph\u00e1p kh\u00f4ng li\u00ean quan g\u00ec \u0111\u1ebfn DSU.</p> <p>V\u00ed d\u1ee5 xem x\u00e9t b\u00e0i to\u00e1n sau: ch\u00fang ta \u0111\u01b0\u1ee3c cho m\u1ed9t c\u00e2y, m\u1ed7i l\u00e1 c\u00f3 m\u1ed9t s\u1ed1 \u0111\u01b0\u1ee3c ch\u1ec9 \u0111\u1ecbnh (c\u00f9ng m\u1ed9t s\u1ed1 c\u00f3 th\u1ec3 xu\u1ea5t hi\u1ec7n nhi\u1ec1u l\u1ea7n tr\u00ean c\u00e1c l\u00e1 kh\u00e1c nhau). Ch\u00fang ta mu\u1ed1n t\u00ednh to\u00e1n s\u1ed1 l\u01b0\u1ee3ng c\u00e1c s\u1ed1 kh\u00e1c nhau trong c\u00e2y con cho m\u1ed7i n\u00fat c\u1ee7a c\u00e2y.</p> <p>\u00c1p d\u1ee5ng cho nhi\u1ec7m v\u1ee5 n\u00e0y c\u00f9ng m\u1ed9t \u00fd t\u01b0\u1edfng, c\u00f3 th\u1ec3 c\u00f3 \u0111\u01b0\u1ee3c gi\u1ea3i ph\u00e1p n\u00e0y: ch\u00fang ta c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n m\u1ed9t DFS, s\u1ebd tr\u1ea3 v\u1ec1 m\u1ed9t con tr\u1ecf \u0111\u1ebfn m\u1ed9t t\u1eadp h\u1ee3p c\u00e1c s\u1ed1 nguy\u00ean - danh s\u00e1ch c\u00e1c s\u1ed1 trong c\u00e2y con \u0111\u00f3. Sau \u0111\u00f3 \u0111\u1ec3 nh\u1eadn c\u00e2u tr\u1ea3 l\u1eddi cho n\u00fat hi\u1ec7n t\u1ea1i (tr\u1eeb khi t\u1ea5t nhi\u00ean n\u00f3 l\u00e0 m\u1ed9t l\u00e1), ch\u00fang ta g\u1ecdi DFS cho t\u1ea5t c\u1ea3 c\u00e1c con c\u1ee7a n\u00fat \u0111\u00f3, v\u00e0 h\u1ee3p nh\u1ea5t t\u1ea5t c\u1ea3 c\u00e1c t\u1eadp h\u1ee3p \u0111\u00e3 nh\u1eadn l\u1ea1i v\u1edbi nhau. K\u00edch th\u01b0\u1edbc c\u1ee7a t\u1eadp h\u1ee3p k\u1ebft qu\u1ea3 s\u1ebd l\u00e0 c\u00e2u tr\u1ea3 l\u1eddi cho n\u00fat hi\u1ec7n t\u1ea1i. \u0110\u1ec3 k\u1ebft h\u1ee3p hi\u1ec7u qu\u1ea3 nhi\u1ec1u t\u1eadp h\u1ee3p, ch\u00fang ta ch\u1ec9 c\u1ea7n \u00e1p d\u1ee5ng c\u00f4ng th\u1ee9c \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 \u1edf tr\u00ean: ch\u00fang ta h\u1ee3p nh\u1ea5t c\u00e1c t\u1eadp h\u1ee3p b\u1eb1ng c\u00e1ch \u0111\u01a1n gi\u1ea3n l\u00e0 th\u00eam c\u00e1c t\u1eadp h\u1ee3p nh\u1ecf h\u01a1n v\u00e0o l\u1edbn h\u01a1n. Cu\u1ed1i c\u00f9ng ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c m\u1ed9t gi\u1ea3i ph\u00e1p $O(n \\log^2 n)$, b\u1edfi v\u00ec m\u1ed9t s\u1ed1 s\u1ebd ch\u1ec9 \u0111\u01b0\u1ee3c th\u00eam v\u00e0o m\u1ed9t t\u1eadp h\u1ee3p t\u1ed1i \u0111a $O(\\log n)$ l\u1ea7n.</p>","tags":["Translated"]},{"location":"data_structures/disjoint_set_union.html#storing-the-dsu-by-maintaining-a-clear-tree-structure-online-bridge-finding","title":"L\u01b0u tr\u1eef DSU b\u1eb1ng c\u00e1ch duy tr\u00ec c\u1ea5u tr\u00fac c\u00e2y r\u00f5 r\u00e0ng / T\u00ecm c\u1ea7u online trong trung b\u00ecnh $O(\\alpha(n))$ (Storing the DSU by maintaining a clear tree structure / Online bridge finding in $O(\\alpha(n))$ on average)","text":"<p>M\u1ed9t trong nh\u1eefng \u1ee9ng d\u1ee5ng m\u1ea1nh m\u1ebd nh\u1ea5t c\u1ee7a DSU l\u00e0 n\u00f3 cho ph\u00e9p b\u1ea1n l\u01b0u tr\u1eef c\u1ea3 d\u01b0\u1edbi d\u1ea1ng c\u00e2y n\u00e9n v\u00e0 kh\u00f4ng n\u00e9n. D\u1ea1ng n\u00e9n c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 h\u1ee3p nh\u1ea5t c\u00e1c c\u00e2y v\u00e0 \u0111\u1ec3 x\u00e1c minh xem hai \u0111\u1ec9nh c\u00f3 n\u1eb1m trong c\u00f9ng m\u1ed9t c\u00e2y hay kh\u00f4ng, v\u00e0 d\u1ea1ng kh\u00f4ng n\u00e9n c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng - v\u00ed d\u1ee5 - \u0111\u1ec3 t\u00ecm ki\u1ebfm \u0111\u01b0\u1eddng \u0111i gi\u1eefa hai \u0111\u1ec9nh nh\u1ea5t \u0111\u1ecbnh, ho\u1eb7c c\u00e1c duy\u1ec7t c\u00e2y kh\u00e1c.</p> <p>Trong vi\u1ec7c c\u00e0i \u0111\u1eb7t, \u0111i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 ngo\u00e0i m\u1ea3ng t\u1ed5 ti\u00ean n\u00e9n <code>parent[]</code>, ch\u00fang ta s\u1ebd c\u1ea7n gi\u1eef m\u1ea3ng c\u00e1c t\u1ed5 ti\u00ean kh\u00f4ng n\u00e9n <code>real_parent[]</code>. Th\u1eadt t\u1ea7m th\u01b0\u1eddng khi duy tr\u00ec m\u1ea3ng b\u1ed5 sung n\u00e0y s\u1ebd kh\u00f4ng l\u00e0m x\u1ea5u \u0111i \u0111\u1ed9 ph\u1ee9c t\u1ea1p: c\u00e1c thay \u0111\u1ed5i trong n\u00f3 ch\u1ec9 x\u1ea3y ra khi ch\u00fang ta h\u1ee3p nh\u1ea5t hai c\u00e2y, v\u00e0 ch\u1ec9 trong m\u1ed9t ph\u1ea7n t\u1eed.</p> <p>M\u1eb7t kh\u00e1c khi \u00e1p d\u1ee5ng trong th\u1ef1c t\u1ebf, ch\u00fang ta th\u01b0\u1eddng c\u1ea7n k\u1ebft n\u1ed1i c\u00e1c c\u00e2y b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng m\u1ed9t c\u1ea1nh \u0111\u01b0\u1ee3c ch\u1ec9 \u0111\u1ecbnh kh\u00e1c v\u1edbi vi\u1ec7c s\u1eed d\u1ee5ng hai n\u00fat g\u1ed1c. \u0110i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 ch\u00fang ta kh\u00f4ng c\u00f3 l\u1ef1a ch\u1ecdn n\u00e0o kh\u00e1c ngo\u00e0i vi\u1ec7c \u0111\u1ecbnh l\u1ea1i g\u1ed1c cho m\u1ed9t trong c\u00e1c c\u00e2y (l\u00e0m cho c\u00e1c \u0111\u1ea7u m\u00fat c\u1ee7a c\u1ea1nh tr\u1edf th\u00e0nh g\u1ed1c m\u1edbi c\u1ee7a c\u00e2y).</p> <p>Tho\u1ea1t nh\u00ecn c\u00f3 v\u1ebb nh\u01b0 vi\u1ec7c \u0111\u1ecbnh l\u1ea1i g\u1ed1c n\u00e0y r\u1ea5t t\u1ed1n k\u00e9m v\u00e0 s\u1ebd l\u00e0m x\u1ea5u \u0111i \u0111\u00e1ng k\u1ec3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian. Th\u1eadt v\u1eady, \u0111\u1ec3 \u0111\u1ecbnh l\u1ea1i g\u1ed1c m\u1ed9t c\u00e2y t\u1ea1i \u0111\u1ec9nh $v$, ch\u00fang ta ph\u1ea3i \u0111i t\u1eeb \u0111\u1ec9nh \u0111\u1ebfn g\u1ed1c c\u0169 v\u00e0 thay \u0111\u1ed5i h\u01b0\u1edbng trong <code>parent[]</code> v\u00e0 <code>real_parent[]</code> cho t\u1ea5t c\u1ea3 c\u00e1c n\u00fat tr\u00ean \u0111\u01b0\u1eddng \u0111i \u0111\u00f3.</p> <p>Tuy nhi\u00ean trong th\u1ef1c t\u1ebf n\u00f3 kh\u00f4ng t\u1ec7 \u0111\u1ebfn th\u1ebf, ch\u00fang ta ch\u1ec9 c\u00f3 th\u1ec3 \u0111\u1ecbnh l\u1ea1i g\u1ed1c c\u00e2y nh\u1ecf h\u01a1n trong hai c\u00e2y t\u01b0\u01a1ng t\u1ef1 nh\u01b0 c\u00e1c \u00fd t\u01b0\u1edfng trong c\u00e1c ph\u1ea7n tr\u01b0\u1edbc, v\u00e0 nh\u1eadn \u0111\u01b0\u1ee3c $O(\\log n)$ trung b\u00ecnh.</p> <p>Chi ti\u1ebft h\u01a1n (bao g\u1ed3m b\u1eb1ng ch\u1ee9ng v\u1ec1 \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian) c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y trong b\u00e0i vi\u1ebft T\u00ecm c\u1ea7u tr\u1ef1c tuy\u1ebfn.</p>","tags":["Translated"]},{"location":"data_structures/disjoint_set_union.html#historical-retrospective","title":"H\u1ed3i c\u1ee9u l\u1ecbch s\u1eed (Historical retrospective)","text":"<p>C\u1ea5u tr\u00fac d\u1eef li\u1ec7u DSU \u0111\u00e3 \u0111\u01b0\u1ee3c bi\u1ebft \u0111\u1ebfn t\u1eeb l\u00e2u.</p> <p>C\u00e1ch l\u01b0u tr\u1eef c\u1ea5u tr\u00fac n\u00e0y d\u01b0\u1edbi d\u1ea1ng m\u1ed9t khu r\u1eebng c\u00e2y d\u01b0\u1eddng nh\u01b0 \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 l\u1ea7n \u0111\u1ea7u ti\u00ean b\u1edfi Galler v\u00e0 Fisher v\u00e0o n\u0103m 1964 (Galler, Fisher, \"An Improved Equivalence Algorithm), tuy nhi\u00ean ph\u00e2n t\u00edch ho\u00e0n ch\u1ec9nh v\u1ec1 \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian \u0111\u00e3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n mu\u1ed9n h\u01a1n nhi\u1ec1u.</p> <p>C\u00e1c t\u1ed1i \u01b0u h\u00f3a n\u00e9n \u0111\u01b0\u1eddng v\u00e0 H\u1ee3p nh\u1ea5t theo h\u1ea1ng \u0111\u00e3 \u0111\u01b0\u1ee3c ph\u00e1t tri\u1ec3n b\u1edfi McIlroy v\u00e0 Morris, v\u00e0 \u0111\u1ed9c l\u1eadp v\u1edbi h\u1ecd c\u0169ng b\u1edfi Tritter.</p> <p>Hopcroft v\u00e0 Ullman \u0111\u00e3 ch\u1ec9 ra v\u00e0o n\u0103m 1973 \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian $O(\\log^\\star n)$ (Hopcroft, Ullman \"Set-merging algorithms\") - \u1edf \u0111\u00e2y $\\log^\\star$ l\u00e0 logarit l\u1eb7p (\u0111\u00e2y l\u00e0 m\u1ed9t h\u00e0m t\u0103ng tr\u01b0\u1edfng ch\u1eadm, nh\u01b0ng v\u1eabn kh\u00f4ng ch\u1eadm nh\u01b0 h\u00e0m Ackermann ngh\u1ecbch \u0111\u1ea3o).</p> <p>L\u1ea7n \u0111\u1ea7u ti\u00ean \u0111\u00e1nh gi\u00e1 v\u1ec1 $O(\\alpha(n))$ \u0111\u01b0\u1ee3c hi\u1ec3n th\u1ecb v\u00e0o n\u0103m 1975 (Tarjan \"Efficiency of a Good But Not Linear Set Union Algorithm\"). Sau \u0111\u00f3 v\u00e0o n\u0103m 1985, \u00f4ng c\u00f9ng v\u1edbi Leeuwen, \u0111\u00e3 c\u00f4ng b\u1ed1 nhi\u1ec1u ph\u00e2n t\u00edch \u0111\u1ed9 ph\u1ee9c t\u1ea1p cho m\u1ed9t s\u1ed1 heuristic h\u1ea1ng v\u00e0 c\u00e1ch n\u00e9n \u0111\u01b0\u1eddng kh\u00e1c nhau (Tarjan, Leeuwen \"Worst-case Analysis of Set Union Algorithms\").</p> <p>Cu\u1ed1i c\u00f9ng v\u00e0o n\u0103m 1989 Fredman v\u00e0 Sachs \u0111\u00e3 ch\u1ee9ng minh r\u1eb1ng trong m\u00f4 h\u00ecnh t\u00ednh to\u00e1n \u0111\u01b0\u1ee3c \u00e1p d\u1ee5ng, b\u1ea5t k\u1ef3 thu\u1eadt to\u00e1n n\u00e0o cho b\u00e0i to\u00e1n h\u1ee3p nh\u1ea5t t\u1eadp h\u1ee3p r\u1eddi nhau \u0111\u1ec1u ph\u1ea3i ho\u1ea1t \u0111\u1ed9ng trong \u00edt nh\u1ea5t th\u1eddi gian trung b\u00ecnh $O(\\alpha(n))$ (Fredman, Saks, \"The cell probe complexity of dynamic data structures\").</p>","tags":["Translated"]},{"location":"data_structures/disjoint_set_union.html#problems","title":"B\u00e0i t\u1eadp (Problems)","text":"<ul> <li>TIMUS - Anansi's Cobweb</li> <li>Codeforces - Roads not only in Berland</li> <li>TIMUS - Parity</li> <li>SPOJ - Strange Food Chain</li> <li>SPOJ - COLORFUL ARRAY</li> <li>SPOJ - Consecutive Letters</li> <li>Toph - Unbelievable Array</li> <li>HackerEarth - Lexicographically minimal string</li> <li>HackerEarth - Fight in Ninja World</li> </ul>","tags":["Translated"]},{"location":"data_structures/fenwick.html","title":"C\u00e2y Fenwick (Fenwick Tree)","text":"<p>Gi\u1ea3 s\u1eed $f$ l\u00e0 m\u1ed9t ph\u00e9p to\u00e1n nh\u00f3m (m\u1ed9t h\u00e0m k\u1ebft h\u1ee3p hai ng\u00f4i tr\u00ean m\u1ed9t t\u1eadp h\u1ee3p v\u1edbi m\u1ed9t ph\u1ea7n t\u1eed \u0111\u01a1n v\u1ecb v\u00e0 c\u00e1c ph\u1ea7n t\u1eed ngh\u1ecbch \u0111\u1ea3o) v\u00e0 $A$ l\u00e0 m\u1ed9t m\u1ea3ng c\u00e1c s\u1ed1 nguy\u00ean c\u00f3 \u0111\u1ed9 d\u00e0i $N$. K\u00fd hi\u1ec7u trung t\u1ed1 c\u1ee7a $f$ l\u00e0 $*$; ngh\u0129a l\u00e0, $f(x,y) = x*y$ v\u1edbi c\u00e1c s\u1ed1 nguy\u00ean $x,y$ b\u1ea5t k\u1ef3. (V\u00ec ph\u00e9p to\u00e1n n\u00e0y c\u00f3 t\u00ednh ch\u1ea5t k\u1ebft h\u1ee3p, ch\u00fang ta s\u1ebd b\u1ecf qua c\u00e1c d\u1ea5u ngo\u1eb7c \u0111\u01a1n cho th\u1ee9 t\u1ef1 \u00e1p d\u1ee5ng c\u1ee7a $f$ khi s\u1eed d\u1ee5ng k\u00fd hi\u1ec7u trung t\u1ed1.)</p> <p>C\u00e2y Fenwick l\u00e0 m\u1ed9t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u m\u00e0:</p> <ul> <li>t\u00ednh to\u00e1n gi\u00e1 tr\u1ecb c\u1ee7a h\u00e0m $f$ trong \u0111o\u1ea1n \u0111\u00e3 cho $[l, r]$ (t\u1ee9c l\u00e0 $A_l * A_{l+1} * \\dots * A_r$) trong th\u1eddi gian $O(\\log N)$</li> <li>c\u1eadp nh\u1eadt gi\u00e1 tr\u1ecb c\u1ee7a m\u1ed9t ph\u1ea7n t\u1eed c\u1ee7a $A$ trong th\u1eddi gian $O(\\log N)$</li> <li>y\u00eau c\u1ea7u b\u1ed9 nh\u1edb $O(N)$ (c\u00f9ng m\u1ed9t l\u01b0\u1ee3ng c\u1ea7n thi\u1ebft cho $A$)</li> <li>d\u1ec5 s\u1eed d\u1ee5ng v\u00e0 l\u1eadp tr\u00ecnh, \u0111\u1eb7c bi\u1ec7t l\u00e0 trong tr\u01b0\u1eddng h\u1ee3p m\u1ea3ng nhi\u1ec1u chi\u1ec1u</li> </ul> <p>U\u1ee9ng d\u1ee5ng ph\u1ed5 bi\u1ebfn nh\u1ea5t c\u1ee7a c\u00e2y Fenwick l\u00e0 t\u00ednh t\u1ed5ng c\u1ee7a m\u1ed9t \u0111o\u1ea1n. V\u00ed d\u1ee5, s\u1eed d\u1ee5ng ph\u00e9p c\u1ed9ng tr\u00ean t\u1eadp h\u1ee3p c\u00e1c s\u1ed1 nguy\u00ean l\u00e0m ph\u00e9p to\u00e1n nh\u00f3m, t\u1ee9c l\u00e0 $f(x,y) = x + y$: ph\u00e9p to\u00e1n hai ng\u00f4i, $*$, l\u00e0 $+$ trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, v\u00ec v\u1eady $A_l * A_{l+1} * \\dots * A_r = A_l + A_{l+1} + \\dots + A_{r}$.</p> <p>C\u00e2y Fenwick c\u00f2n \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 C\u00e2y ch\u1ec9 s\u1ed1 nh\u1ecb ph\u00e2n (Binary Indexed Tree - BIT). N\u00f3 \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 l\u1ea7n \u0111\u1ea7u ti\u00ean trong m\u1ed9t b\u00e0i b\u00e1o c\u00f3 ti\u00eau \u0111\u1ec1 \"A new data structure for cumulative frequency tables\" (Peter M. Fenwick, 1994).</p>","tags":["Translated"]},{"location":"data_structures/fenwick.html#description","title":"M\u00f4 t\u1ea3 (Description)","text":"","tags":["Translated"]},{"location":"data_structures/fenwick.html#overview","title":"T\u1ed5ng quan (Overview)","text":"<p>\u0110\u1ec3 \u0111\u01a1n gi\u1ea3n, ch\u00fang ta s\u1ebd gi\u1ea3 \u0111\u1ecbnh r\u1eb1ng h\u00e0m $f$ \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a l\u00e0 $f(x,y) = x + y$ tr\u00ean c\u00e1c s\u1ed1 nguy\u00ean.</p> <p>Gi\u1ea3 s\u1eed ch\u00fang ta \u0111\u01b0\u1ee3c cho m\u1ed9t m\u1ea3ng c\u00e1c s\u1ed1 nguy\u00ean, $A[0 \\dots N-1]$. (L\u01b0u \u00fd r\u1eb1ng ch\u00fang ta \u0111ang s\u1eed d\u1ee5ng ch\u1ec9 s\u1ed1 b\u1eaft \u0111\u1ea7u t\u1eeb 0.) C\u00e2y Fenwick ch\u1ec9 l\u00e0 m\u1ed9t m\u1ea3ng, $T[0 \\dots N-1]$, trong \u0111\u00f3 m\u1ed7i ph\u1ea7n t\u1eed b\u1eb1ng t\u1ed5ng c\u00e1c ph\u1ea7n t\u1eed c\u1ee7a $A$ trong m\u1ed9t s\u1ed1 \u0111o\u1ea1n, $[g(i), i]$:</p> $$T_i = \\sum_{j = g(i)}^{i}{A_j}$$ <p>trong \u0111\u00f3 $g$ l\u00e0 m\u1ed9t h\u00e0m n\u00e0o \u0111\u00f3 th\u1ecfa m\u00e3n $0 \\le g(i) \\le i$. Ch\u00fang ta s\u1ebd \u0111\u1ecbnh ngh\u0129a $g$ trong m\u1ed9t v\u00e0i \u0111o\u1ea1n ti\u1ebfp theo.</p> <p>C\u1ea5u tr\u00fac d\u1eef li\u1ec7u \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 c\u00e2y v\u00ec c\u00f3 m\u1ed9t bi\u1ec3u di\u1ec5n \u0111\u1eb9p c\u1ee7a n\u00f3 d\u01b0\u1edbi d\u1ea1ng c\u00e2y, m\u1eb7c d\u00f9 ch\u00fang ta kh\u00f4ng c\u1ea7n l\u1eadp m\u00f4 h\u00ecnh m\u1ed9t c\u00e2y th\u1ef1c t\u1ebf v\u1edbi c\u00e1c n\u00fat v\u00e0 c\u1ea1nh. Ch\u00fang ta ch\u1ec9 c\u1ea7n duy tr\u00ec m\u1ea3ng $T$ \u0111\u1ec3 x\u1eed l\u00fd t\u1ea5t c\u1ea3 c\u00e1c truy v\u1ea5n.</p> <p>L\u01b0u \u00fd: C\u00e2y Fenwick \u0111\u01b0\u1ee3c tr\u00ecnh b\u00e0y \u1edf \u0111\u00e2y s\u1eed d\u1ee5ng ch\u1ec9 s\u1ed1 b\u1eaft \u0111\u1ea7u t\u1eeb 0. Nhi\u1ec1u ng\u01b0\u1eddi s\u1eed d\u1ee5ng m\u1ed9t phi\u00ean b\u1ea3n c\u1ee7a c\u00e2y Fenwick s\u1eed d\u1ee5ng ch\u1ec9 s\u1ed1 b\u1eaft \u0111\u1ea7u t\u1eeb 1. Do \u0111\u00f3, b\u1ea1n c\u0169ng s\u1ebd t\u00ecm th\u1ea5y m\u1ed9t tri\u1ec3n khai thay th\u1ebf s\u1eed d\u1ee5ng ch\u1ec9 s\u1ed1 b\u1eaft \u0111\u1ea7u t\u1eeb 1 trong ph\u1ea7n c\u00e0i \u0111\u1eb7t. C\u1ea3 hai phi\u00ean b\u1ea3n \u0111\u1ec1u t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1ec1 \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian v\u00e0 b\u1ed9 nh\u1edb.</p> <p>B\u00e2y gi\u1edd ch\u00fang ta c\u00f3 th\u1ec3 vi\u1ebft m\u1ed9t s\u1ed1 m\u00e3 gi\u1ea3 cho hai thao t\u00e1c \u0111\u01b0\u1ee3c \u0111\u1ec1 c\u1eadp \u1edf tr\u00ean. D\u01b0\u1edbi \u0111\u00e2y, ch\u00fang ta nh\u1eadn t\u1ed5ng c\u00e1c ph\u1ea7n t\u1eed c\u1ee7a $A$ trong \u0111o\u1ea1n $[0, r]$ v\u00e0 c\u1eadp nh\u1eadt (t\u0103ng) m\u1ed9t s\u1ed1 ph\u1ea7n t\u1eed $A_i$:</p> <pre><code>def sum(int r):\n    res = 0\n    while (r &gt;= 0):\n        res += t[r]\n        r = g(r) - 1\n    return res\n\ndef increase(int i, int delta):\n    for all j with g(j) &lt;= i &lt;= j:\n        t[j] += delta\n</code></pre> <p>H\u00e0m <code>sum</code> ho\u1ea1t \u0111\u1ed9ng nh\u01b0 sau:</p> <ol> <li>\u0110\u1ea7u ti\u00ean, n\u00f3 th\u00eam t\u1ed5ng c\u1ee7a \u0111o\u1ea1n $[g(r), r]$ (t\u1ee9c l\u00e0 $T[r]$) v\u00e0o <code>result</code>.</li> <li>Sau \u0111\u00f3, n\u00f3 \"nh\u1ea3y\" \u0111\u1ebfn \u0111o\u1ea1n $[g(g(r)-1), g(r)-1]$ v\u00e0 th\u00eam t\u1ed5ng c\u1ee7a \u0111o\u1ea1n n\u00e0y v\u00e0o <code>result</code>.</li> <li>\u0110i\u1ec1u n\u00e0y ti\u1ebfp t\u1ee5c cho \u0111\u1ebfn khi n\u00f3 \"nh\u1ea3y\" t\u1eeb $[0, g(g( \\dots g(r)-1 \\dots -1)-1)]$ \u0111\u1ebfn $[g(-1), -1]$; \u0111\u00e2y l\u00e0 n\u01a1i h\u00e0m <code>sum</code> ng\u1eebng nh\u1ea3y.</li> </ol> <p>H\u00e0m <code>increase</code> ho\u1ea1t \u0111\u1ed9ng v\u1edbi s\u1ef1 t\u01b0\u01a1ng t\u1ef1, nh\u01b0ng n\u00f3 \"nh\u1ea3y\" theo h\u01b0\u1edbng t\u0103ng ch\u1ec9 s\u1ed1:</p> <ol> <li>T\u1ed5ng cho m\u1ed7i \u0111o\u1ea1n c\u00f3 d\u1ea1ng $[g(j), j]$ th\u1ecfa m\u00e3n \u0111i\u1ec1u ki\u1ec7n $g(j) \\le i \\le j$ \u0111\u01b0\u1ee3c t\u0103ng th\u00eam <code>delta</code>; ngh\u0129a l\u00e0, <code>t[j] += delta</code>. Do \u0111\u00f3, n\u00f3 c\u1eadp nh\u1eadt t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed trong $T$ t\u01b0\u01a1ng \u1ee9ng v\u1edbi c\u00e1c \u0111o\u1ea1n m\u00e0 $A_i$ n\u1eb1m trong \u0111\u00f3.</li> </ol> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a c\u1ea3 <code>sum</code> v\u00e0 <code>increase</code> ph\u1ee5 thu\u1ed9c v\u00e0o h\u00e0m $g$. C\u00f3 nhi\u1ec1u c\u00e1ch \u0111\u1ec3 ch\u1ecdn h\u00e0m $g$ sao cho $0 \\le g(i) \\le i$ cho t\u1ea5t c\u1ea3 $i$. V\u00ed d\u1ee5, h\u00e0m $g(i) = i$ ho\u1ea1t \u0111\u1ed9ng, mang l\u1ea1i $T = A$ (trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, c\u00e1c truy v\u1ea5n t\u00ednh t\u1ed5ng ch\u1eadm). Ch\u00fang ta c\u0169ng c\u00f3 th\u1ec3 l\u1ea5y h\u00e0m $g(i) = 0$. \u0110i\u1ec1u n\u00e0y s\u1ebd t\u01b0\u01a1ng \u1ee9ng v\u1edbi c\u00e1c m\u1ea3ng t\u1ed5ng ti\u1ec1n t\u1ed1 (trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, vi\u1ec7c t\u00ecm t\u1ed5ng c\u1ee7a \u0111o\u1ea1n $[0, i]$ s\u1ebd ch\u1ec9 m\u1ea5t th\u1eddi gian h\u1eb1ng s\u1ed1; tuy nhi\u00ean, c\u00e1c c\u1eadp nh\u1eadt ch\u1eadm). Ph\u1ea7n th\u00f4ng minh c\u1ee7a thu\u1eadt to\u00e1n cho c\u00e2y Fenwick l\u00e0 c\u00e1ch n\u00f3 s\u1eed d\u1ee5ng m\u1ed9t \u0111\u1ecbnh ngh\u0129a \u0111\u1eb7c bi\u1ec7t c\u1ee7a h\u00e0m $g$ c\u00f3 th\u1ec3 x\u1eed l\u00fd c\u1ea3 hai thao t\u00e1c trong th\u1eddi gian $O(\\log N)$.</p>","tags":["Translated"]},{"location":"data_structures/fenwick.html#definition-of-gi","title":"\u0110\u1ecbnh ngh\u0129a c\u1ee7a $g(i)$ (Definition of g(i))","text":"<p>Vi\u1ec7c t\u00ednh to\u00e1n $g(i)$ \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng thao t\u00e1c \u0111\u01a1n gi\u1ea3n sau: ch\u00fang ta thay th\u1ebf t\u1ea5t c\u1ea3 c\u00e1c bit $1$ \u1edf cu\u1ed1i trong bi\u1ec3u di\u1ec5n nh\u1ecb ph\u00e2n c\u1ee7a $i$ b\u1eb1ng c\u00e1c bit $0$.</p> <p>N\u00f3i c\u00e1ch kh\u00e1c, n\u1ebfu ch\u1eef s\u1ed1 c\u00f3 ngh\u0129a nh\u1ecf nh\u1ea5t c\u1ee7a $i$ trong h\u1ec7 nh\u1ecb ph\u00e2n l\u00e0 $0$, th\u00ec $g(i) = i$. V\u00e0 ng\u01b0\u1ee3c l\u1ea1i, ch\u1eef s\u1ed1 c\u00f3 ngh\u0129a nh\u1ecf nh\u1ea5t l\u00e0 $1$, v\u00e0 ch\u00fang ta l\u1ea5y $1$ n\u00e0y v\u00e0 t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 $1$ \u1edf cu\u1ed1i kh\u00e1c v\u00e0 l\u1eadt ch\u00fang.</p> <p>V\u00ed d\u1ee5 ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c</p> $$\\begin{align} g(11) = g(1011_2) = 1000_2 &amp;= 8 \\\\\\\\ g(12) = g(1100_2) = 1100_2 &amp;= 12 \\\\\\\\ g(13) = g(1101_2) = 1100_2 &amp;= 12 \\\\\\\\ g(14) = g(1110_2) = 1110_2 &amp;= 14 \\\\\\\\ g(15) = g(1111_2) = 0000_2 &amp;= 0 \\\\\\\\ \\end{align}$$ <p>T\u1ed3n t\u1ea1i m\u1ed9t c\u00e1ch c\u00e0i \u0111\u1eb7t \u0111\u01a1n gi\u1ea3n b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng c\u00e1c ph\u00e9p to\u00e1n bit cho thao t\u00e1c kh\u00f4ng t\u1ea7m th\u01b0\u1eddng \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 \u1edf tr\u00ean:</p> $$g(i) = i ~\\&amp;~ (i+1),$$ <p>trong \u0111\u00f3 $\\&amp;$ l\u00e0 to\u00e1n t\u1eed AND bit. Kh\u00f4ng kh\u00f3 \u0111\u1ec3 thuy\u1ebft ph\u1ee5c b\u1ea3n th\u00e2n r\u1eb1ng gi\u1ea3i ph\u00e1p n\u00e0y th\u1ef1c hi\u1ec7n \u0111i\u1ec1u t\u01b0\u01a1ng t\u1ef1 nh\u01b0 thao t\u00e1c \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 \u1edf tr\u00ean.</p> <p>B\u00e2y gi\u1edd, ch\u00fang ta ch\u1ec9 c\u1ea7n t\u00ecm m\u1ed9t c\u00e1ch \u0111\u1ec3 l\u1eb7p l\u1ea1i t\u1ea5t c\u1ea3 c\u00e1c $j$, sao cho $g(j) \\le i \\le j$.</p> <p>D\u1ec5 th\u1ea5y r\u1eb1ng ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm th\u1ea5y t\u1ea5t c\u1ea3 c\u00e1c $j$ nh\u01b0 v\u1eady b\u1eb1ng c\u00e1ch b\u1eaft \u0111\u1ea7u v\u1edbi $i$ v\u00e0 l\u1eadt bit ch\u01b0a \u0111\u01b0\u1ee3c \u0111\u1eb7t cu\u1ed1i c\u00f9ng. Ch\u00fang ta s\u1ebd g\u1ecdi thao t\u00e1c n\u00e0y l\u00e0 $h(j)$. V\u00ed d\u1ee5, \u0111\u1ed1i v\u1edbi $i = 10$ ch\u00fang ta c\u00f3:</p> $$\\begin{align} 10 &amp;= 0001010_2 \\\\\\\\ h(10) = 11 &amp;= 0001011_2 \\\\\\\\ h(11) = 15 &amp;= 0001111_2 \\\\\\\\ h(15) = 31 &amp;= 0011111_2 \\\\\\\\ h(31) = 63 &amp;= 0111111_2 \\\\\\\\ \\vdots &amp; \\end{align}$$ <p>Kh\u00f4ng c\u00f3 g\u00ec ng\u1ea1c nhi\u00ean, c\u0169ng t\u1ed3n t\u1ea1i m\u1ed9t c\u00e1ch \u0111\u01a1n gi\u1ea3n \u0111\u1ec3 th\u1ef1c hi\u1ec7n $h$ b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng c\u00e1c ph\u00e9p to\u00e1n bit:</p> $$h(j) = j ~|~ (j+1),$$ <p>trong \u0111\u00f3 $|$ l\u00e0 to\u00e1n t\u1eed OR bit.</p> <p>H\u00ecnh \u1ea3nh sau \u0111\u00e2y cho th\u1ea5y m\u1ed9t c\u00e1ch gi\u1ea3i th\u00edch c\u00f3 th\u1ec3 c\u00f3 c\u1ee7a c\u00e2y Fenwick d\u01b0\u1edbi d\u1ea1ng c\u00e2y. C\u00e1c n\u00fat c\u1ee7a c\u00e2y hi\u1ec3n th\u1ecb c\u00e1c ph\u1ea1m vi ch\u00fang bao ph\u1ee7.</p>","tags":["Translated"]},{"location":"data_structures/fenwick.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"","tags":["Translated"]},{"location":"data_structures/fenwick.html#finding-sum-in-one-dimensional-array","title":"T\u00ecm t\u1ed5ng trong m\u1ea3ng m\u1ed9t chi\u1ec1u (Finding sum in one-dimensional array)","text":"<p>\u1ede \u0111\u00e2y ch\u00fang t\u00f4i tr\u00ecnh b\u00e0y m\u1ed9t c\u00e0i \u0111\u1eb7t c\u1ee7a c\u00e2y Fenwick cho c\u00e1c truy v\u1ea5n t\u1ed5ng v\u00e0 c\u1eadp nh\u1eadt \u0111\u01a1n l\u1ebb.</p> <p>C\u00e2y Fenwick b\u00ecnh th\u01b0\u1eddng ch\u1ec9 c\u00f3 th\u1ec3 tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n t\u1ed5ng c\u1ee7a lo\u1ea1i $[0, r]$ b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng <code>sum(int r)</code>, tuy nhi\u00ean ch\u00fang ta c\u0169ng c\u00f3 th\u1ec3 tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n kh\u00e1c c\u1ee7a lo\u1ea1i $[l, r]$ b\u1eb1ng c\u00e1ch t\u00ednh hai t\u1ed5ng $[0, r]$ v\u00e0 $[0, l-1]$ v\u00e0 tr\u1eeb ch\u00fang. \u0110i\u1ec1u n\u00e0y \u0111\u01b0\u1ee3c x\u1eed l\u00fd trong ph\u01b0\u01a1ng th\u1ee9c <code>sum(int l, int r)</code>.</p> <p>Ngo\u00e0i ra vi\u1ec7c c\u00e0i \u0111\u1eb7t n\u00e0y h\u1ed7 tr\u1ee3 hai h\u00e0m t\u1ea1o. B\u1ea1n c\u00f3 th\u1ec3 t\u1ea1o m\u1ed9t c\u00e2y Fenwick \u0111\u01b0\u1ee3c kh\u1edfi t\u1ea1o b\u1eb1ng c\u00e1c s\u1ed1 kh\u00f4ng, ho\u1eb7c b\u1ea1n c\u00f3 th\u1ec3 chuy\u1ec3n \u0111\u1ed5i m\u1ed9t m\u1ea3ng hi\u1ec7n c\u00f3 th\u00e0nh d\u1ea1ng Fenwick.</p> <pre><code>struct FenwickTree {\n    vector&lt;int&gt; bit;  // binary indexed tree\n    int n;\n\n    FenwickTree(int n) {\n        this-&gt;n = n;\n        bit.assign(n, 0);\n    }\n\n    FenwickTree(vector&lt;int&gt; const &amp;a) : FenwickTree(a.size()) {\n        for (size_t i = 0; i &lt; a.size(); i++)\n            add(i, a[i]);\n    }\n\n    int sum(int r) {\n        int ret = 0;\n        for (; r &gt;= 0; r = (r &amp; (r + 1)) - 1)\n            ret += bit[r];\n        return ret;\n    }\n\n    int sum(int l, int r) {\n        return sum(r) - sum(l - 1);\n    }\n\n    void add(int idx, int delta) {\n        for (; idx &lt; n; idx = idx | (idx + 1))\n            bit[idx] += delta;\n    }\n};\n</code></pre>","tags":["Translated"]},{"location":"data_structures/fenwick.html#linear-construction","title":"X\u00e2y d\u1ef1ng tuy\u1ebfn t\u00ednh (Linear construction)","text":"<p>Vi\u1ec7c c\u00e0i \u0111\u1eb7t tr\u00ean y\u00eau c\u1ea7u th\u1eddi gian $O(N \\log N)$. C\u00f3 th\u1ec3 c\u1ea3i thi\u1ec7n \u0111i\u1ec1u \u0111\u00f3 th\u00e0nh th\u1eddi gian $O(N)$.</p> <p>\u00dd t\u01b0\u1edfng l\u00e0, s\u1ed1 $a[i]$ t\u1ea1i ch\u1ec9 m\u1ee5c $i$ s\u1ebd \u0111\u00f3ng g\u00f3p v\u00e0o ph\u1ea1m vi \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef trong $bit[i]$, v\u00e0 cho t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea1m vi m\u00e0 ch\u1ec9 m\u1ee5c $i | (i + 1)$ \u0111\u00f3ng g\u00f3p v\u00e0o. V\u00ec v\u1eady, b\u1eb1ng c\u00e1ch th\u00eam c\u00e1c s\u1ed1 theo th\u1ee9 t\u1ef1, b\u1ea1n ch\u1ec9 c\u1ea7n \u0111\u1ea9y t\u1ed5ng hi\u1ec7n t\u1ea1i xa h\u01a1n sang ph\u1ea1m vi ti\u1ebfp theo, n\u01a1i n\u00f3 sau \u0111\u00f3 s\u1ebd \u0111\u01b0\u1ee3c \u0111\u1ea9y xa h\u01a1n sang ph\u1ea1m vi ti\u1ebfp theo, v.v.</p> <pre><code>FenwickTree(vector&lt;int&gt; const &amp;a) : FenwickTree(a.size()){\n    for (int i = 0; i &lt; n; i++) {\n        bit[i] += a[i];\n        int r = i | (i + 1);\n        if (r &lt; n) bit[r] += bit[i];\n    }\n}\n</code></pre>","tags":["Translated"]},{"location":"data_structures/fenwick.html#finding-minimum-of-0-r-in-one-dimensional-array","title":"T\u00ecm gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t c\u1ee7a $[0, r]$ trong m\u1ea3ng m\u1ed9t chi\u1ec1u (Finding minimum of [0, r] in one-dimensional array)","text":"<p>R\u00f5 r\u00e0ng l\u00e0 kh\u00f4ng c\u00f3 c\u00e1ch d\u1ec5 d\u00e0ng \u0111\u1ec3 t\u00ecm gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t c\u1ee7a \u0111o\u1ea1n $[l, r]$ b\u1eb1ng c\u00e2y Fenwick, v\u00ec c\u00e2y Fenwick ch\u1ec9 c\u00f3 th\u1ec3 tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n lo\u1ea1i $[0, r]$. Ngo\u00e0i ra, m\u1ed7i khi m\u1ed9t gi\u00e1 tr\u1ecb \u0111\u01b0\u1ee3c <code>update</code> (c\u1eadp nh\u1eadt), gi\u00e1 tr\u1ecb m\u1edbi ph\u1ea3i nh\u1ecf h\u01a1n gi\u00e1 tr\u1ecb hi\u1ec7n t\u1ea1i. C\u1ea3 hai h\u1ea1n ch\u1ebf \u0111\u00e1ng k\u1ec3 l\u00e0 do thao t\u00e1c $min$ c\u00f9ng v\u1edbi t\u1eadp h\u1ee3p c\u00e1c s\u1ed1 nguy\u00ean kh\u00f4ng t\u1ea1o th\u00e0nh m\u1ed9t nh\u00f3m, v\u00ec kh\u00f4ng c\u00f3 ph\u1ea7n t\u1eed ngh\u1ecbch \u0111\u1ea3o.</p> <pre><code>struct FenwickTreeMin {\n    vector&lt;int&gt; bit;\n    int n;\n    const int INF = (int)1e9;\n\n    FenwickTreeMin(int n) {\n        this-&gt;n = n;\n        bit.assign(n, INF);\n    }\n\n    FenwickTreeMin(vector&lt;int&gt; a) : FenwickTreeMin(a.size()) {\n        for (size_t i = 0; i &lt; a.size(); i++)\n            update(i, a[i]);\n    }\n\n    int getmin(int r) {\n        int ret = INF;\n        for (; r &gt;= 0; r = (r &amp; (r + 1)) - 1)\n            ret = min(ret, bit[r]);\n        return ret;\n    }\n\n    void update(int idx, int val) {\n        for (; idx &lt; n; idx = idx | (idx + 1))\n            bit[idx] = min(bit[idx], val);\n    }\n};\n</code></pre> <p>L\u01b0u \u00fd: c\u00f3 th\u1ec3 c\u00e0i \u0111\u1eb7t m\u1ed9t c\u00e2y Fenwick c\u00f3 th\u1ec3 x\u1eed l\u00fd c\u00e1c truy v\u1ea5n ph\u1ea1m vi t\u1ed1i thi\u1ec3u t\u00f9y \u00fd v\u00e0 c\u00e1c c\u1eadp nh\u1eadt t\u00f9y \u00fd. B\u00e0i b\u00e1o Truy v\u1ea5n ph\u1ea1m vi t\u1ed1i thi\u1ec3u hi\u1ec7u qu\u1ea3 s\u1eed d\u1ee5ng C\u00e2y ch\u1ec9 s\u1ed1 nh\u1ecb ph\u00e2n m\u00f4 t\u1ea3 m\u1ed9t c\u00e1ch ti\u1ebfp c\u1eadn nh\u01b0 v\u1eady. Tuy nhi\u00ean, v\u1edbi c\u00e1ch ti\u1ebfp c\u1eadn \u0111\u00f3, b\u1ea1n c\u1ea7n duy tr\u00ec m\u1ed9t c\u00e2y ch\u1ec9 s\u1ed1 nh\u1ecb ph\u00e2n th\u1ee9 hai tr\u00ean d\u1eef li\u1ec7u, v\u1edbi c\u1ea5u tr\u00fac h\u01a1i kh\u00e1c, v\u00ec m\u1ed9t c\u00e2y l\u00e0 kh\u00f4ng \u0111\u1ee7 \u0111\u1ec3 l\u01b0u tr\u1eef gi\u00e1 tr\u1ecb c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed trong m\u1ea3ng. Vi\u1ec7c c\u00e0i \u0111\u1eb7t c\u0169ng kh\u00f3 h\u01a1n nhi\u1ec1u so v\u1edbi vi\u1ec7c c\u00e0i \u0111\u1eb7t b\u00ecnh th\u01b0\u1eddng cho t\u1ed5ng.</p>","tags":["Translated"]},{"location":"data_structures/fenwick.html#finding-sum-in-two-dimensional-array","title":"T\u00ecm t\u1ed5ng trong m\u1ea3ng hai chi\u1ec1u (Finding sum in two-dimensional array)","text":"<p>Nh\u01b0 \u0111\u00e3 tuy\u00ean b\u1ed1 tr\u01b0\u1edbc \u0111\u00e2y, r\u1ea5t d\u1ec5 d\u00e0ng \u0111\u1ec3 c\u00e0i \u0111\u1eb7t C\u00e2y Fenwick cho m\u1ea3ng nhi\u1ec1u chi\u1ec1u.</p> <pre><code>struct FenwickTree2D {\n    vector&lt;vector&lt;int&gt;&gt; bit;\n    int n, m;\n\n    // init(...) { ... }\n\n    int sum(int x, int y) {\n        int ret = 0;\n        for (int i = x; i &gt;= 0; i = (i &amp; (i + 1)) - 1)\n            for (int j = y; j &gt;= 0; j = (j &amp; (j + 1)) - 1)\n                ret += bit[i][j];\n        return ret;\n    }\n\n    void add(int x, int y, int delta) {\n        for (int i = x; i &lt; n; i = i | (i + 1))\n            for (int j = y; j &lt; m; j = j | (j + 1))\n                bit[i][j] += delta;\n    }\n};\n</code></pre>","tags":["Translated"]},{"location":"data_structures/fenwick.html#one-based-indexing-approach","title":"C\u00e1ch ti\u1ebfp c\u1eadn ch\u1ec9 s\u1ed1 b\u1eaft \u0111\u1ea7u t\u1eeb 1 (One-based indexing approach)","text":"<p>\u0110\u1ed1i v\u1edbi c\u00e1ch ti\u1ebfp c\u1eadn n\u00e0y, ch\u00fang ta thay \u0111\u1ed5i c\u00e1c y\u00eau c\u1ea7u v\u00e0 \u0111\u1ecbnh ngh\u0129a cho $T[]$ v\u00e0 $g()$ m\u1ed9t ch\u00fat. Ch\u00fang ta mu\u1ed1n $T[i]$ l\u01b0u tr\u1eef t\u1ed5ng c\u1ee7a $[g(i)+1; i]$. \u0110i\u1ec1u n\u00e0y thay \u0111\u1ed5i vi\u1ec7c c\u00e0i \u0111\u1eb7t m\u1ed9t ch\u00fat, v\u00e0 cho ph\u00e9p m\u1ed9t \u0111\u1ecbnh ngh\u0129a \u0111\u1eb9p t\u01b0\u01a1ng t\u1ef1 cho $g(i)$:</p> <pre><code>def sum(int r):\n    res = 0\n    while (r &gt; 0):\n        res += t[r]\n        r = g(r)\n    return res\n\ndef increase(int i, int delta):\n    for all j with g(j) &lt; i &lt;= j:\n        t[j] += delta\n</code></pre> <p>Vi\u1ec7c t\u00ednh to\u00e1n $g(i)$ \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh l\u00e0: l\u1eadt bit $1$ \u0111\u01b0\u1ee3c \u0111\u1eb7t cu\u1ed1i c\u00f9ng trong bi\u1ec3u di\u1ec5n nh\u1ecb ph\u00e2n c\u1ee7a $i$.</p> $$\\begin{align} g(7) = g(111_2) = 110_2 &amp;= 6 \\\\\\\\ g(6) = g(110_2) = 100_2 &amp;= 4 \\\\\\\\ g(4) = g(100_2) = 000_2 &amp;= 0 \\\\\\\\ \\end{align}$$ <p>Bit \u0111\u01b0\u1ee3c \u0111\u1eb7t cu\u1ed1i c\u00f9ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c tr\u00edch xu\u1ea5t b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng $i ~\\&amp;~ (-i)$, v\u00ec v\u1eady thao t\u00e1c c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bi\u1ec3u th\u1ecb l\u00e0:</p> $$g(i) = i - (i ~\\&amp;~ (-i)).$$ <p>V\u00e0 kh\u00f4ng kh\u00f3 \u0111\u1ec3 th\u1ea5y, r\u1eb1ng b\u1ea1n c\u1ea7n thay \u0111\u1ed5i t\u1ea5t c\u1ea3 c\u00e1c gi\u00e1 tr\u1ecb $T[j]$ trong chu\u1ed7i $i,~ h(i),~ h(h(i)),~ \\dots$ khi b\u1ea1n mu\u1ed1n c\u1eadp nh\u1eadt $A[j]$, trong \u0111\u00f3 $h(i)$ \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a l\u00e0:</p> $$h(i) = i + (i ~\\&amp;~ (-i)).$$ <p>Nh\u01b0 b\u1ea1n c\u00f3 th\u1ec3 th\u1ea5y, l\u1ee3i \u00edch ch\u00ednh c\u1ee7a c\u00e1ch ti\u1ebfp c\u1eadn n\u00e0y l\u00e0 c\u00e1c ho\u1ea1t \u0111\u1ed9ng nh\u1ecb ph\u00e2n b\u1ed5 sung cho nhau r\u1ea5t t\u1ed1t.</p> <p>Vi\u1ec7c c\u00e0i \u0111\u1eb7t sau \u0111\u00e2y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng gi\u1ed1ng nh\u01b0 c\u00e1c c\u00e0i \u0111\u1eb7t kh\u00e1c, tuy nhi\u00ean n\u00f3 s\u1eed d\u1ee5ng l\u1eadp ch\u1ec9 m\u1ee5c d\u1ef1a tr\u00ean m\u1ed9t trong n\u1ed9i b\u1ed9.</p> <pre><code>struct FenwickTreeOneBasedIndexing {\n    vector&lt;int&gt; bit;  // binary indexed tree\n    int n;\n\n    FenwickTreeOneBasedIndexing(int n) {\n        this-&gt;n = n + 1;\n        bit.assign(n + 1, 0);\n    }\n\n    FenwickTreeOneBasedIndexing(vector&lt;int&gt; a)\n        : FenwickTreeOneBasedIndexing(a.size()) {\n        for (size_t i = 0; i &lt; a.size(); i++)\n            add(i, a[i]);\n    }\n\n    int sum(int idx) {\n        int ret = 0;\n        for (++idx; idx &gt; 0; idx -= idx &amp; -idx)\n            ret += bit[idx];\n        return ret;\n    }\n\n    int sum(int l, int r) {\n        return sum(r) - sum(l - 1);\n    }\n\n    void add(int idx, int delta) {\n        for (++idx; idx &lt; n; idx += idx &amp; -idx)\n            bit[idx] += delta;\n    }\n};\n</code></pre>","tags":["Translated"]},{"location":"data_structures/fenwick.html#range-operations","title":"C\u00e1c thao t\u00e1c tr\u00ean \u0111o\u1ea1n (Range operations)","text":"<p>M\u1ed9t c\u00e2y Fenwick c\u00f3 th\u1ec3 h\u1ed7 tr\u1ee3 c\u00e1c thao t\u00e1c ph\u1ea1m vi sau:</p> <ol> <li>C\u1eadp nh\u1eadt \u0111i\u1ec3m v\u00e0 Truy v\u1ea5n \u0111o\u1ea1n (Point Update and Range Query)</li> <li>C\u1eadp nh\u1eadt \u0111o\u1ea1n v\u00e0 Truy v\u1ea5n \u0111i\u1ec3m (Range Update and Point Query)</li> <li>C\u1eadp nh\u1eadt \u0111o\u1ea1n v\u00e0 Truy v\u1ea5n \u0111o\u1ea1n (Range Update and Range Query)</li> </ol>","tags":["Translated"]},{"location":"data_structures/fenwick.html#1-point-update-and-range-query","title":"1. C\u1eadp nh\u1eadt \u0111i\u1ec3m v\u00e0 Truy v\u1ea5n \u0111o\u1ea1n","text":"<p>\u0110\u00e2y ch\u1ec9 l\u00e0 c\u00e2y Fenwick b\u00ecnh th\u01b0\u1eddng nh\u01b0 \u0111\u00e3 gi\u1ea3i th\u00edch \u1edf tr\u00ean.</p>","tags":["Translated"]},{"location":"data_structures/fenwick.html#2-range-update-and-point-query","title":"2. C\u1eadp nh\u1eadt \u0111o\u1ea1n v\u00e0 Truy v\u1ea5n \u0111i\u1ec3m","text":"<p>S\u1eed d\u1ee5ng c\u00e1c th\u1ee7 thu\u1eadt \u0111\u01a1n gi\u1ea3n, ch\u00fang ta c\u0169ng c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n c\u00e1c thao t\u00e1c ng\u01b0\u1ee3c l\u1ea1i: t\u0103ng ph\u1ea1m vi v\u00e0 truy v\u1ea5n c\u00e1c gi\u00e1 tr\u1ecb \u0111\u01a1n l\u1ebb.</p> <p>H\u00e3y \u0111\u1ec3 c\u00e2y Fenwick \u0111\u01b0\u1ee3c kh\u1edfi t\u1ea1o v\u1edbi c\u00e1c s\u1ed1 kh\u00f4ng. Gi\u1ea3 s\u1eed r\u1eb1ng ch\u00fang ta mu\u1ed1n t\u0103ng kho\u1ea3ng $[l, r]$ th\u00eam $x$. Ch\u00fang ta th\u1ef1c hi\u1ec7n hai thao t\u00e1c c\u1eadp nh\u1eadt \u0111i\u1ec3m tr\u00ean c\u00e2y Fenwick l\u00e0 <code>add(l, x)</code> v\u00e0 <code>add(r+1, -x)</code>.</p> <p>N\u1ebfu ch\u00fang ta mu\u1ed1n nh\u1eadn gi\u00e1 tr\u1ecb c\u1ee7a $A[i]$, ch\u00fang ta ch\u1ec9 c\u1ea7n l\u1ea5y t\u1ed5ng ti\u1ec1n t\u1ed1 b\u1eb1ng ph\u01b0\u01a1ng ph\u00e1p t\u1ed5ng ph\u1ea1m vi th\u00f4ng th\u01b0\u1eddng. \u0110\u1ec3 xem t\u1ea1i sao \u0111i\u1ec1u n\u00e0y \u0111\u00fang, ch\u00fang ta c\u00f3 th\u1ec3 t\u1eadp trung v\u00e0o thao t\u00e1c t\u0103ng tr\u01b0\u1edbc \u0111\u00f3 m\u1ed9t l\u1ea7n n\u1eefa. N\u1ebfu $i &lt; l$, th\u00ec hai thao t\u00e1c c\u1eadp nh\u1eadt kh\u00f4ng \u1ea3nh h\u01b0\u1edfng \u0111\u1ebfn truy v\u1ea5n v\u00e0 ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c t\u1ed5ng $0$. N\u1ebfu $i \\in [l, r]$, th\u00ec ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c c\u00e2u tr\u1ea3 l\u1eddi $x$ v\u00ec thao t\u00e1c c\u1eadp nh\u1eadt \u0111\u1ea7u ti\u00ean. V\u00e0 n\u1ebfu $i &gt; r$, th\u00ec thao t\u00e1c c\u1eadp nh\u1eadt th\u1ee9 hai s\u1ebd h\u1ee7y b\u1ecf t\u00e1c d\u1ee5ng c\u1ee7a thao t\u00e1c \u0111\u1ea7u ti\u00ean.</p> <p>Vi\u1ec7c c\u00e0i \u0111\u1eb7t sau \u0111\u00e2y s\u1eed d\u1ee5ng ch\u1ec9 s\u1ed1 b\u1eaft \u0111\u1ea7u t\u1eeb 1.</p> <pre><code>void add(int idx, int val) {\n    for (++idx; idx &lt; n; idx += idx &amp; -idx)\n        bit[idx] += val;\n}\n\nvoid range_add(int l, int r, int val) {\n    add(l, val);\n    add(r + 1, -val);\n}\n\nint point_query(int idx) {\n    int ret = 0;\n    for (++idx; idx &gt; 0; idx -= idx &amp; -idx)\n        ret += bit[idx];\n    return ret;\n}\n</code></pre> <p>L\u01b0u \u00fd: t\u1ea5t nhi\u00ean c\u0169ng c\u00f3 th\u1ec3 t\u0103ng m\u1ed9t \u0111i\u1ec3m \u0111\u01a1n l\u1ebb $A[i]$ v\u1edbi <code>range_add(i, i, val)</code>.</p>","tags":["Translated"]},{"location":"data_structures/fenwick.html#3-range-update-and-range-query","title":"3. C\u1eadp nh\u1eadt \u0111o\u1ea1n v\u00e0 Truy v\u1ea5n \u0111o\u1ea1n","text":"<p>\u0110\u1ec3 h\u1ed7 tr\u1ee3 c\u1ea3 c\u1eadp nh\u1eadt ph\u1ea1m vi v\u00e0 truy v\u1ea5n ph\u1ea1m vi, ch\u00fang ta s\u1ebd s\u1eed d\u1ee5ng hai BIT c\u1ee5 th\u1ec3 l\u00e0 $B_1[]$ v\u00e0 $B_2[]$, \u0111\u01b0\u1ee3c kh\u1edfi t\u1ea1o b\u1eb1ng c\u00e1c s\u1ed1 kh\u00f4ng.</p> <p>Gi\u1ea3 s\u1eed r\u1eb1ng ch\u00fang ta mu\u1ed1n t\u0103ng kho\u1ea3ng $[l, r]$ th\u00eam gi\u00e1 tr\u1ecb $x$. T\u01b0\u01a1ng t\u1ef1 nh\u01b0 trong ph\u01b0\u01a1ng ph\u00e1p tr\u01b0\u1edbc, ch\u00fang ta th\u1ef1c hi\u1ec7n hai c\u1eadp nh\u1eadt \u0111i\u1ec3m tr\u00ean $B_1$: <code>add(B1, l, x)</code> v\u00e0 <code>add(B1, r+1, -x)</code>. V\u00e0 ch\u00fang ta c\u0169ng c\u1eadp nh\u1eadt $B_2$. C\u00e1c chi ti\u1ebft s\u1ebd \u0111\u01b0\u1ee3c gi\u1ea3i th\u00edch sau.</p> <p><pre><code>def range_add(l, r, x):\n    add(B1, l, x)\n    add(B1, r+1, -x)\n    add(B2, l, x*(l-1))\n    add(B2, r+1, -x*r))\n</code></pre> Sau khi c\u1eadp nh\u1eadt ph\u1ea1m vi $(l, r, x)$ truy v\u1ea5n t\u1ed5ng ph\u1ea1m vi s\u1ebd tr\u1ea3 v\u1ec1 c\u00e1c gi\u00e1 tr\u1ecb sau:</p> $$ sum[0, i]= \\begin{cases} 0 &amp; i &lt; l \\\\\\\\ x \\cdot (i-(l-1)) &amp; l \\le i \\le r \\\\\\\\ x \\cdot (r-l+1) &amp; i &gt; r \\\\\\\\ \\end{cases} $$ <p>Ch\u00fang ta c\u00f3 th\u1ec3 vi\u1ebft t\u1ed5ng ph\u1ea1m vi d\u01b0\u1edbi ch\u00eanh l\u1ec7ch c\u1ee7a hai s\u1ed1 h\u1ea1ng, trong \u0111\u00f3 ch\u00fang ta s\u1eed d\u1ee5ng $B_1$ cho s\u1ed1 h\u1ea1ng \u0111\u1ea7u ti\u00ean v\u00e0 $B_2$ cho s\u1ed1 h\u1ea1ng th\u1ee9 hai. S\u1ef1 kh\u00e1c bi\u1ec7t c\u1ee7a c\u00e1c truy v\u1ea5n s\u1ebd cho ch\u00fang ta t\u1ed5ng ti\u1ec1n t\u1ed1 tr\u00ean $[0, i]$.</p> $$\\begin{align} sum[0, i] &amp;= sum(B_1, i) \\cdot i - sum(B_2, i) \\\\\\\\ &amp;= \\begin{cases} 0 \\cdot i - 0 &amp; i &lt; l\\\\\\\\ x \\cdot i - x \\cdot (l-1) &amp; l \\le i \\le r \\\\\\\\ 0 \\cdot i - (x \\cdot (l-1) - x \\cdot r) &amp; i &gt; r \\\\\\\\ \\end{cases} \\end{align} $$ <p>Bi\u1ec3u th\u1ee9c cu\u1ed1i c\u00f9ng ch\u00ednh x\u00e1c b\u1eb1ng c\u00e1c thu\u1eadt ng\u1eef \u0111\u01b0\u1ee3c y\u00eau c\u1ea7u. Do \u0111\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng $B_2$ \u0111\u1ec3 lo\u1ea1i b\u1ecf c\u00e1c s\u1ed1 h\u1ea1ng th\u1eeba khi ch\u00fang ta nh\u00e2n $B_1[i]\\times i$.</p> <p>Ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm t\u1ed5ng ph\u1ea1m vi t\u00f9y \u00fd b\u1eb1ng c\u00e1ch t\u00ednh t\u1ed5ng ti\u1ec1n t\u1ed1 cho $l-1$ v\u00e0 $r$ v\u00e0 l\u1ea5y hi\u1ec7u c\u1ee7a ch\u00fang m\u1ed9t l\u1ea7n n\u1eefa.</p> <pre><code>def add(b, idx, x):\n    while idx &lt;= N:\n        b[idx] += x\n        idx += idx &amp; -idx\n\ndef range_add(l,r,x):\n    add(B1, l, x)\n    add(B1, r+1, -x)\n    add(B2, l, x*(l-1))\n    add(B2, r+1, -x*r)\n\ndef sum(b, idx):\n    total = 0\n    while idx &gt; 0:\n        total += b[idx]\n        idx -= idx &amp; -idx\n    return total\n\ndef prefix_sum(idx):\n    return sum(B1, idx)*idx -  sum(B2, idx)\n\ndef range_sum(l, r):\n    return prefix_sum(r) - prefix_sum(l-1)\n</code></pre>","tags":["Translated"]},{"location":"data_structures/fenwick.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>UVA 12086 - Potentiometers</li> <li>LOJ 1112 - Curious Robin Hood</li> <li>LOJ 1266 - Points in Rectangle</li> <li>Codechef - SPREAD</li> <li>SPOJ - CTRICK</li> <li>SPOJ - MATSUM</li> <li>SPOJ - DQUERY</li> <li>SPOJ - NKTEAM</li> <li>SPOJ - YODANESS</li> <li>SRM 310 - FloatingMedian</li> <li>SPOJ - Ada and Behives</li> <li>Hackerearth - Counting in Byteland</li> <li>DevSkill - Shan and String (archived)</li> <li>Codeforces - Little Artem and Time Machine</li> <li>Codeforces - Hanoi Factory</li> <li>SPOJ - Tulip and Numbers</li> <li>SPOJ - SUMSUM</li> <li>SPOJ - Sabir and Gifts</li> <li>SPOJ - The Permutation Game Again</li> <li>SPOJ - Zig when you Zag</li> <li>SPOJ - Cryon</li> <li>SPOJ - Weird Points</li> <li>SPOJ - Its a Murder</li> <li>SPOJ - Bored of Suffixes and Prefixes</li> <li>SPOJ - Mega Inversions</li> <li>Codeforces - Subsequences</li> <li>Codeforces - Ball</li> <li>GYM - The Kamphaeng Phet's Chedis</li> <li>Codeforces - Garlands</li> <li>Codeforces - Inversions after Shuffle</li> <li>GYM - Cairo Market</li> <li>Codeforces - Goodbye Souvenir</li> <li>SPOJ - Ada and Species</li> <li>Codeforces - Thor</li> <li>CSES - Forest Queries II</li> <li>Latin American Regionals 2017 - Fundraising</li> </ul>","tags":["Translated"]},{"location":"data_structures/fenwick.html#other-sources","title":"C\u00e1c ngu\u1ed3n kh\u00e1c (Other sources)","text":"<ul> <li>Fenwick tree on Wikipedia</li> <li>Binary indexed trees tutorial on TopCoder</li> <li>Range updates and queries </li> </ul>","tags":["Translated"]},{"location":"data_structures/fenwick.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 504</li> <li>Translated lines: 504</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Translated"]},{"location":"data_structures/randomized_heap.html","title":"Heap ng\u1eabu nhi\u00ean (Randomized Heap)","text":"<p>M\u1ed9t heap ng\u1eabu nhi\u00ean (randomized heap) l\u00e0 m\u1ed9t heap, th\u00f4ng qua vi\u1ec7c s\u1eed d\u1ee5ng ng\u1eabu nhi\u00ean h\u00f3a, cho ph\u00e9p th\u1ef1c hi\u1ec7n t\u1ea5t c\u1ea3 c\u00e1c thao t\u00e1c trong th\u1eddi gian logarit k\u1ef3 v\u1ecdng.</p> <p>M\u1ed9t min heap l\u00e0 m\u1ed9t c\u00e2y nh\u1ecb ph\u00e2n trong \u0111\u00f3 gi\u00e1 tr\u1ecb c\u1ee7a m\u1ed7i \u0111\u1ec9nh nh\u1ecf h\u01a1n ho\u1eb7c b\u1eb1ng gi\u00e1 tr\u1ecb c\u1ee7a c\u00e1c con c\u1ee7a n\u00f3. Do \u0111\u00f3, gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t c\u1ee7a c\u00e2y lu\u00f4n \u1edf \u0111\u1ec9nh g\u1ed1c.</p> <p>M\u1ed9t max heap c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a theo c\u00e1ch t\u01b0\u01a1ng t\u1ef1: b\u1eb1ng c\u00e1ch thay th\u1ebf nh\u1ecf h\u01a1n b\u1eb1ng l\u1edbn h\u01a1n.</p> <p>C\u00e1c thao t\u00e1c m\u1eb7c \u0111\u1ecbnh c\u1ee7a m\u1ed9t heap l\u00e0:</p> <ul> <li>Th\u00eam m\u1ed9t gi\u00e1 tr\u1ecb</li> <li>Tr\u00edch xu\u1ea5t gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t</li> <li>X\u00f3a gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t</li> <li>H\u1ee3p nh\u1ea5t hai heap (kh\u00f4ng x\u00f3a c\u00e1c b\u1ea3n sao)</li> <li>X\u00f3a m\u1ed9t ph\u1ea7n t\u1eed b\u1ea5t k\u1ef3 (n\u1ebfu bi\u1ebft v\u1ecb tr\u00ed c\u1ee7a n\u00f3 trong c\u00e2y)</li> </ul> <p>M\u1ed9t heap ng\u1eabu nhi\u00ean c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n t\u1ea5t c\u1ea3 c\u00e1c thao t\u00e1c n\u00e0y trong th\u1eddi gian k\u1ef3 v\u1ecdng $O(\\log n)$ v\u1edbi m\u1ed9t c\u00e0i \u0111\u1eb7t r\u1ea5t \u0111\u01a1n gi\u1ea3n.</p>","tags":["Translated"]},{"location":"data_structures/randomized_heap.html#data-structure","title":"C\u1ea5u tr\u00fac d\u1eef li\u1ec7u (Data structure)","text":"<p>Ch\u00fang ta c\u00f3 th\u1ec3 m\u00f4 t\u1ea3 ngay c\u1ea5u tr\u00fac c\u1ee7a binary heap:</p> <pre><code>struct Tree {\n    int value;\n    Tree * l = nullptr;\n    Tree * r = nullptr;\n    Tree(int val) : value(val) {}\n};\n</code></pre> <p>Trong \u0111\u1ec9nh, ch\u00fang ta l\u01b0u tr\u1eef m\u1ed9t gi\u00e1 tr\u1ecb. Ngo\u00e0i ra, ch\u00fang ta c\u00f3 c\u00e1c con tr\u1ecf \u0111\u1ebfn con tr\u00e1i v\u00e0 con ph\u1ea3i, tr\u1ecf \u0111\u1ebfn null n\u1ebfu con t\u01b0\u01a1ng \u1ee9ng kh\u00f4ng t\u1ed3n t\u1ea1i.</p>","tags":["Translated"]},{"location":"data_structures/randomized_heap.html#operations","title":"C\u00e1c thao t\u00e1c (Operations)","text":"<p>Kh\u00f4ng kh\u00f3 \u0111\u1ec3 th\u1ea5y r\u1eb1ng t\u1ea5t c\u1ea3 c\u00e1c thao t\u00e1c c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3m xu\u1ed1ng th\u00e0nh m\u1ed9t thao t\u00e1c duy nh\u1ea5t: h\u1ee3p nh\u1ea5t hai heap th\u00e0nh m\u1ed9t. Th\u1eadt v\u1eady, th\u00eam m\u1ed9t gi\u00e1 tr\u1ecb m\u1edbi v\u00e0o heap t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi vi\u1ec7c h\u1ee3p nh\u1ea5t heap v\u1edbi m\u1ed9t heap bao g\u1ed3m m\u1ed9t \u0111\u1ec9nh duy nh\u1ea5t c\u00f3 gi\u00e1 tr\u1ecb \u0111\u00f3. T\u00ecm gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t ho\u00e0n to\u00e0n kh\u00f4ng y\u00eau c\u1ea7u b\u1ea5t k\u1ef3 thao t\u00e1c n\u00e0o - gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t \u0111\u01a1n gi\u1ea3n l\u00e0 gi\u00e1 tr\u1ecb t\u1ea1i g\u1ed1c. X\u00f3a gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi k\u1ebft qu\u1ea3 c\u1ee7a vi\u1ec7c h\u1ee3p nh\u1ea5t con tr\u00e1i v\u00e0 con ph\u1ea3i c\u1ee7a \u0111\u1ec9nh g\u1ed1c. V\u00e0 x\u00f3a m\u1ed9t ph\u1ea7n t\u1eed b\u1ea5t k\u1ef3 c\u0169ng t\u01b0\u01a1ng t\u1ef1. Ch\u00fang ta h\u1ee3p nh\u1ea5t c\u00e1c con c\u1ee7a \u0111\u1ec9nh v\u00e0 thay th\u1ebf \u0111\u1ec9nh b\u1eb1ng k\u1ebft qu\u1ea3 c\u1ee7a vi\u1ec7c h\u1ee3p nh\u1ea5t.</p> <p>V\u00ec v\u1eady, ch\u00fang ta th\u1ef1c s\u1ef1 ch\u1ec9 c\u1ea7n c\u00e0i \u0111\u1eb7t thao t\u00e1c h\u1ee3p nh\u1ea5t hai heap. T\u1ea5t c\u1ea3 c\u00e1c thao t\u00e1c kh\u00e1c \u0111\u1ec1u \u0111\u01b0\u1ee3c gi\u1ea3m m\u1ed9t c\u00e1ch t\u1ea7m th\u01b0\u1eddng xu\u1ed1ng thao t\u00e1c n\u00e0y.</p> <p>Gi\u1ea3 s\u1eed c\u00f3 hai heap $T_1$ v\u00e0 $T_2$. R\u00f5 r\u00e0ng l\u00e0 g\u1ed1c c\u1ee7a m\u1ed7i heap n\u00e0y ch\u1ee9a gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t c\u1ee7a n\u00f3. V\u00ec v\u1eady, g\u1ed1c c\u1ee7a heap k\u1ebft qu\u1ea3 s\u1ebd l\u00e0 gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t c\u1ee7a hai gi\u00e1 tr\u1ecb n\u00e0y. V\u00ec v\u1eady, ch\u00fang ta so s\u00e1nh c\u1ea3 hai gi\u00e1 tr\u1ecb, v\u00e0 s\u1eed d\u1ee5ng gi\u00e1 tr\u1ecb nh\u1ecf h\u01a1n l\u00e0m g\u1ed1c m\u1edbi. B\u00e2y gi\u1edd ch\u00fang ta ph\u1ea3i k\u1ebft h\u1ee3p c\u00e1c con c\u1ee7a \u0111\u1ec9nh \u0111\u00e3 ch\u1ecdn v\u1edbi heap c\u00f2n l\u1ea1i. \u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y, ch\u00fang ta ch\u1ecdn m\u1ed9t trong c\u00e1c con, v\u00e0 h\u1ee3p nh\u1ea5t n\u00f3 v\u1edbi heap c\u00f2n l\u1ea1i. Do \u0111\u00f3, ch\u00fang ta l\u1ea1i c\u00f3 thao t\u00e1c h\u1ee3p nh\u1ea5t hai heap. S\u1edbm hay mu\u1ed9n qu\u00e1 tr\u00ecnh n\u00e0y s\u1ebd k\u1ebft th\u00fac (s\u1ed1 b\u01b0\u1edbc nh\u01b0 v\u1eady b\u1ecb gi\u1edbi h\u1ea1n b\u1edfi t\u1ed5ng chi\u1ec1u cao c\u1ee7a hai heap).</p> <p>\u0110\u1ec3 \u0111\u1ea1t \u0111\u01b0\u1ee3c \u0111\u1ed9 ph\u1ee9c t\u1ea1p logarit trung b\u00ecnh, ch\u00fang ta c\u1ea7n ch\u1ec9 \u0111\u1ecbnh m\u1ed9t ph\u01b0\u01a1ng ph\u00e1p \u0111\u1ec3 ch\u1ecdn m\u1ed9t trong hai con sao cho \u0111\u1ed9 d\u00e0i \u0111\u01b0\u1eddng \u0111i trung b\u00ecnh l\u00e0 logarit. Kh\u00f4ng kh\u00f3 \u0111\u1ec3 \u0111o\u00e1n r\u1eb1ng, ch\u00fang ta s\u1ebd \u0111\u01b0a ra quy\u1ebft \u0111\u1ecbnh n\u00e0y m\u1ed9t c\u00e1ch ng\u1eabu nhi\u00ean. Do \u0111\u00f3, vi\u1ec7c c\u00e0i \u0111\u1eb7t thao t\u00e1c h\u1ee3p nh\u1ea5t nh\u01b0 sau:</p> <pre><code>Tree* merge(Tree* t1, Tree* t2) {\n    if (!t1 || !t2)\n        return t1 ? t1 : t2;\n    if (t2-&gt;value &lt; t1-&gt;value)\n        swap(t1, t2);\n    if (rand() &amp; 1)\n        swap(t1-&gt;l, t1-&gt;r);\n    t1-&gt;l = merge(t1-&gt;l, t2);\n    return t1;\n}\n</code></pre> <p>\u1ede \u0111\u00e2y \u0111\u1ea7u ti\u00ean ch\u00fang ta ki\u1ec3m tra xem m\u1ed9t trong c\u00e1c heap c\u00f3 r\u1ed7ng hay kh\u00f4ng, n\u1ebfu c\u00f3 th\u00ec ch\u00fang ta ho\u00e0n to\u00e0n kh\u00f4ng c\u1ea7n th\u1ef1c hi\u1ec7n b\u1ea5t k\u1ef3 h\u00e0nh \u0111\u1ed9ng h\u1ee3p nh\u1ea5t n\u00e0o. Ng\u01b0\u1ee3c l\u1ea1i, ch\u00fang ta bi\u1ebfn heap <code>t1</code> th\u00e0nh heap c\u00f3 gi\u00e1 tr\u1ecb nh\u1ecf h\u01a1n (b\u1eb1ng c\u00e1ch ho\u00e1n \u0111\u1ed5i <code>t1</code> v\u00e0 <code>t2</code> n\u1ebfu c\u1ea7n thi\u1ebft). Ch\u00fang ta mu\u1ed1n h\u1ee3p nh\u1ea5t con tr\u00e1i c\u1ee7a <code>t1</code> v\u1edbi <code>t2</code>, do \u0111\u00f3 ch\u00fang ta ho\u00e1n \u0111\u1ed5i ng\u1eabu nhi\u00ean c\u00e1c con c\u1ee7a <code>t1</code>, v\u00e0 sau \u0111\u00f3 th\u1ef1c hi\u1ec7n h\u1ee3p nh\u1ea5t.</p>","tags":["Translated"]},{"location":"data_structures/randomized_heap.html#complexity","title":"\u0110\u1ed9 ph\u1ee9c t\u1ea1p (Complexity)","text":"<p>Ch\u00fang ta gi\u1edbi thi\u1ec7u bi\u1ebfn ng\u1eabu nhi\u00ean $h(T)$ bi\u1ec3u th\u1ecb \u0111\u1ed9 d\u00e0i c\u1ee7a \u0111\u01b0\u1eddng \u0111i ng\u1eabu nhi\u00ean t\u1eeb g\u1ed1c \u0111\u1ebfn l\u00e1 (\u0111\u1ed9 d\u00e0i theo s\u1ed1 l\u01b0\u1ee3ng c\u1ea1nh). R\u00f5 r\u00e0ng l\u00e0 thu\u1eadt to\u00e1n <code>merge</code> th\u1ef1c hi\u1ec7n c\u00e1c b\u01b0\u1edbc $O(h(T_1) + h(T_2))$. Do \u0111\u00f3, \u0111\u1ec3 hi\u1ec3u \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a c\u00e1c thao t\u00e1c, ch\u00fang ta ph\u1ea3i xem x\u00e9t bi\u1ebfn ng\u1eabu nhi\u00ean $h(T)$.</p>","tags":["Translated"]},{"location":"data_structures/randomized_heap.html#expected-value","title":"Gi\u00e1 tr\u1ecb k\u1ef3 v\u1ecdng (Expected value)","text":"<p>Ch\u00fang ta gi\u1ea3 \u0111\u1ecbnh r\u1eb1ng k\u1ef3 v\u1ecdng $h(T)$ c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c \u01b0\u1edbc t\u00ednh t\u1eeb ph\u00eda tr\u00ean b\u1eb1ng logarit c\u1ee7a s\u1ed1 l\u01b0\u1ee3ng \u0111\u1ec9nh trong heap:</p> $$\\mathbf{E} h(T) \\le \\log(n+1)$$ <p>\u0110i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng \u0111\u01b0\u1ee3c ch\u1ee9ng minh b\u1eb1ng quy n\u1ea1p. G\u1ecdi $L$ v\u00e0 $R$ l\u00e0 c\u00e1c c\u00e2y con b\u00ean tr\u00e1i v\u00e0 b\u00ean ph\u1ea3i c\u1ee7a g\u1ed1c $T$, v\u00e0 $n_L$ v\u00e0 $n_R$ l\u00e0 s\u1ed1 l\u01b0\u1ee3ng \u0111\u1ec9nh trong ch\u00fang ($n = n_L + n_R + 1$).</p> <p>\u0110i\u1ec1u sau \u0111\u00e2y cho th\u1ea5y b\u01b0\u1edbc quy n\u1ea1p:</p> $$\\begin{align} \\mathbf{E} h(T) &amp;= 1 + \\frac{\\mathbf{E} h(L) + \\mathbf{E} h(R)}{2}  \\le 1 + \\frac{\\log(n_L + 1) \\log(n_R + 1)}{2} \\\\\\\\ &amp;= 1 + \\log\\sqrt{(n_L + 1)(n_R + 1)} = \\log 2\\sqrt{(n_L + 1)(n_R + 1)} \\\\\\\\ &amp;\\le \\log \\frac{2\\left((n_L + 1) + (n_R + 1)\\right)}{2} = \\log(n_L + n_R + 2) = \\log(n+1) \\end{align}$$","tags":["Translated"]},{"location":"data_structures/randomized_heap.html#exceeding-the-expected-value","title":"V\u01b0\u1ee3t qu\u00e1 gi\u00e1 tr\u1ecb k\u1ef3 v\u1ecdng (Exceeding the expected value)","text":"<p>T\u1ea5t nhi\u00ean ch\u00fang ta v\u1eabn ch\u01b0a h\u00e0i l\u00f2ng. Gi\u00e1 tr\u1ecb k\u1ef3 v\u1ecdng c\u1ee7a $h(T)$ kh\u00f4ng n\u00f3i l\u00ean \u0111i\u1ec1u g\u00ec v\u1ec1 tr\u01b0\u1eddng h\u1ee3p x\u1ea5u nh\u1ea5t. V\u1eabn c\u00f3 th\u1ec3 x\u1ea3y ra tr\u01b0\u1eddng h\u1ee3p c\u00e1c \u0111\u01b0\u1eddng \u0111i t\u1eeb g\u1ed1c \u0111\u1ebfn c\u00e1c \u0111\u1ec9nh trung b\u00ecnh l\u1edbn h\u01a1n nhi\u1ec1u so v\u1edbi $\\log(n + 1)$ \u0111\u1ed1i v\u1edbi m\u1ed9t c\u00e2y c\u1ee5 th\u1ec3.</p> <p>H\u00e3y ch\u1ee9ng minh r\u1eb1ng vi\u1ec7c v\u01b0\u1ee3t qu\u00e1 gi\u00e1 tr\u1ecb k\u1ef3 v\u1ecdng th\u1ef1c s\u1ef1 l\u00e0 r\u1ea5t nh\u1ecf:</p> $$P\\{h(T) &gt; (c+1) \\log n\\} &lt; \\frac{1}{n^c}$$ <p>\u0111\u1ed1i v\u1edbi b\u1ea5t k\u1ef3 h\u1eb1ng s\u1ed1 d\u01b0\u01a1ng $c$ n\u00e0o.</p> <p>\u1ede \u0111\u00e2y ch\u00fang ta k\u00fd hi\u1ec7u $P$ l\u00e0 t\u1eadp h\u1ee3p c\u00e1c \u0111\u01b0\u1eddng \u0111i t\u1eeb g\u1ed1c c\u1ee7a heap \u0111\u1ebfn c\u00e1c l\u00e1 c\u00f3 \u0111\u1ed9 d\u00e0i v\u01b0\u1ee3t qu\u00e1 $(c+1) \\log n$. L\u01b0u \u00fd r\u1eb1ng \u0111\u1ed1i v\u1edbi b\u1ea5t k\u1ef3 \u0111\u01b0\u1eddng \u0111i $p$ n\u00e0o c\u00f3 \u0111\u1ed9 d\u00e0i $|p|$, x\u00e1c su\u1ea5t \u0111\u1ec3 n\u00f3 \u0111\u01b0\u1ee3c ch\u1ecdn l\u00e0m \u0111\u01b0\u1eddng \u0111i ng\u1eabu nhi\u00ean l\u00e0 $2^{-|p|}$. Do \u0111\u00f3 ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c:</p> $$P\\{h(T) &gt; (c+1) \\log n\\} = \\sum_{p \\in P} 2^{-|p|} &lt; \\sum_{p \\in P} 2^{-(c+1) \\log n} = |P| n^{-(c+1)} \\le n^{-c}$$","tags":["Translated"]},{"location":"data_structures/randomized_heap.html#complexity-of-the-algorithm","title":"\u0110\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a thu\u1eadt to\u00e1n (Complexity of the algorithm)","text":"<p>Do \u0111\u00f3, thu\u1eadt to\u00e1n <code>merge</code>, v\u00e0 do \u0111\u00f3 t\u1ea5t c\u1ea3 c\u00e1c thao t\u00e1c kh\u00e1c \u0111\u01b0\u1ee3c th\u1ec3 hi\u1ec7n b\u1eb1ng n\u00f3, c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong $O(\\log n)$ trung b\u00ecnh.</p> <p>H\u01a1n n\u1eefa, \u0111\u1ed1i v\u1edbi b\u1ea5t k\u1ef3 h\u1eb1ng s\u1ed1 d\u01b0\u01a1ng $\\epsilon$ n\u00e0o, c\u00f3 m\u1ed9t h\u1eb1ng s\u1ed1 d\u01b0\u01a1ng $c$, sao cho x\u00e1c su\u1ea5t m\u00e0 thao t\u00e1c s\u1ebd y\u00eau c\u1ea7u nhi\u1ec1u h\u01a1n $c \\log n$ b\u01b0\u1edbc nh\u1ecf h\u01a1n $n^{-\\epsilon}$ (theo m\u1ed9t ngh\u0129a n\u00e0o \u0111\u00f3, \u0111i\u1ec1u n\u00e0y m\u00f4 t\u1ea3 h\u00e0nh vi tr\u01b0\u1eddng h\u1ee3p x\u1ea5u nh\u1ea5t c\u1ee7a thu\u1eadt to\u00e1n).</p>","tags":["Translated"]},{"location":"data_structures/randomized_heap.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 130</li> <li>Translated lines: 130</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Translated"]},{"location":"data_structures/segment_tree.html","title":"C\u00e2y ph\u00e2n \u0111o\u1ea1n (Segment Tree)","text":"<p>Segment Tree (C\u00e2y ph\u00e2n \u0111o\u1ea1n) l\u00e0 m\u1ed9t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u l\u01b0u tr\u1eef th\u00f4ng tin v\u1ec1 c\u00e1c kho\u1ea3ng c\u1ee7a m\u1ea3ng d\u01b0\u1edbi d\u1ea1ng c\u00e2y. \u0110i\u1ec1u n\u00e0y cho ph\u00e9p tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n \u0111o\u1ea1n tr\u00ean m\u1ed9t m\u1ea3ng m\u1ed9t c\u00e1ch hi\u1ec7u qu\u1ea3, trong khi v\u1eabn \u0111\u1ee7 linh ho\u1ea1t \u0111\u1ec3 cho ph\u00e9p s\u1eeda \u0111\u1ed5i nhanh m\u1ea3ng. \u0110i\u1ec1u n\u00e0y bao g\u1ed3m vi\u1ec7c t\u00ecm t\u1ed5ng c\u1ee7a c\u00e1c ph\u1ea7n t\u1eed m\u1ea3ng li\u00ean ti\u1ebfp $a[l \\dots r]$, ho\u1eb7c t\u00ecm ph\u1ea7n t\u1eed nh\u1ecf nh\u1ea5t trong m\u1ed9t \u0111o\u1ea1n nh\u01b0 v\u1eady trong th\u1eddi gian $O(\\log n)$. Gi\u1eefa vi\u1ec7c tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n nh\u01b0 v\u1eady, Segment Tree cho ph\u00e9p s\u1eeda \u0111\u1ed5i m\u1ea3ng b\u1eb1ng c\u00e1ch thay th\u1ebf m\u1ed9t ph\u1ea7n t\u1eed, ho\u1eb7c th\u1eadm ch\u00ed thay \u0111\u1ed5i c\u00e1c ph\u1ea7n t\u1eed c\u1ee7a c\u1ea3 m\u1ed9t \u0111o\u1ea1n con (v\u00ed d\u1ee5: g\u00e1n t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed $a[l \\dots r]$ cho b\u1ea5t k\u1ef3 gi\u00e1 tr\u1ecb n\u00e0o, ho\u1eb7c th\u00eam m\u1ed9t gi\u00e1 tr\u1ecb v\u00e0o t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed trong \u0111o\u1ea1n con).</p> <p>Nh\u00ecn chung, Segment Tree l\u00e0 m\u1ed9t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u r\u1ea5t linh ho\u1ea1t, v\u00e0 m\u1ed9t s\u1ed1 l\u01b0\u1ee3ng l\u1edbn c\u00e1c b\u00e0i to\u00e1n c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i quy\u1ebft b\u1eb1ng n\u00f3. Ngo\u00e0i ra, c\u0169ng c\u00f3 th\u1ec3 \u00e1p d\u1ee5ng c\u00e1c thao t\u00e1c ph\u1ee9c t\u1ea1p h\u01a1n v\u00e0 tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n ph\u1ee9c t\u1ea1p h\u01a1n (xem C\u00e1c phi\u00ean b\u1ea3n n\u00e2ng cao c\u1ee7a Segment Trees). \u0110\u1eb7c bi\u1ec7t, Segment Tree c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng \u0111\u01b0\u1ee3c kh\u00e1i qu\u00e1t h\u00f3a cho c\u00e1c chi\u1ec1u l\u1edbn h\u01a1n. V\u00ed d\u1ee5, v\u1edbi Segment Tree hai chi\u1ec1u, b\u1ea1n c\u00f3 th\u1ec3 tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n t\u1ed5ng ho\u1eb7c gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t tr\u00ean m\u1ed9t h\u00ecnh ch\u1eef nh\u1eadt con c\u1ee7a m\u1ed9t ma tr\u1eadn \u0111\u00e3 cho ch\u1ec9 trong th\u1eddi gian $O(\\log^2 n)$.</p> <p>M\u1ed9t t\u00ednh ch\u1ea5t quan tr\u1ecdng c\u1ee7a Segment Trees l\u00e0 ch\u00fang ch\u1ec9 y\u00eau c\u1ea7u m\u1ed9t l\u01b0\u1ee3ng b\u1ed9 nh\u1edb tuy\u1ebfn t\u00ednh. Segment Tree ti\u00eau chu\u1ea9n y\u00eau c\u1ea7u $4n$ \u0111\u1ec9nh \u0111\u1ec3 l\u00e0m vi\u1ec7c tr\u00ean m\u1ed9t m\u1ea3ng c\u00f3 k\u00edch th\u01b0\u1edbc $n$.</p>","tags":["Translated"]},{"location":"data_structures/segment_tree.html#simplest-form-of-a-segment-tree","title":"D\u1ea1ng \u0111\u01a1n gi\u1ea3n nh\u1ea5t c\u1ee7a Segment Tree (Simplest form of a Segment Tree)","text":"<p>\u0110\u1ec3 b\u1eaft \u0111\u1ea7u d\u1ec5 d\u00e0ng, ch\u00fang ta xem x\u00e9t d\u1ea1ng \u0111\u01a1n gi\u1ea3n nh\u1ea5t c\u1ee7a Segment Tree. Ch\u00fang ta mu\u1ed1n tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n t\u1ed5ng m\u1ed9t c\u00e1ch hi\u1ec7u qu\u1ea3. \u0110\u1ecbnh ngh\u0129a ch\u00ednh th\u1ee9c c\u1ee7a nhi\u1ec7m v\u1ee5 c\u1ee7a ch\u00fang ta l\u00e0: Cho m\u1ed9t m\u1ea3ng $a[0 \\dots n-1]$, Segment Tree ph\u1ea3i c\u00f3 kh\u1ea3 n\u0103ng t\u00ecm t\u1ed5ng c\u1ee7a c\u00e1c ph\u1ea7n t\u1eed gi\u1eefa c\u00e1c ch\u1ec9 s\u1ed1 $l$ v\u00e0 $r$ (t\u1ee9c l\u00e0 t\u00ednh t\u1ed5ng $\\sum_{i=l}^r a[i]$), v\u00e0 c\u0169ng x\u1eed l\u00fd vi\u1ec7c thay \u0111\u1ed5i gi\u00e1 tr\u1ecb c\u1ee7a c\u00e1c ph\u1ea7n t\u1eed trong m\u1ea3ng (t\u1ee9c l\u00e0 th\u1ef1c hi\u1ec7n c\u00e1c ph\u00e9p g\u00e1n c\u00f3 d\u1ea1ng $a[i] = x$). Segment Tree ph\u1ea3i c\u00f3 kh\u1ea3 n\u0103ng x\u1eed l\u00fd c\u1ea3 hai truy v\u1ea5n trong th\u1eddi gian $O(\\log n)$.</p> <p>\u0110\u00e2y l\u00e0 m\u1ed9t s\u1ef1 c\u1ea3i ti\u1ebfn so v\u1edbi c\u00e1c c\u00e1ch ti\u1ebfp c\u1eadn \u0111\u01a1n gi\u1ea3n h\u01a1n. M\u1ed9t tri\u1ec3n khai m\u1ea3ng ng\u00e2y th\u01a1 - ch\u1ec9 s\u1eed d\u1ee5ng m\u1ed9t m\u1ea3ng \u0111\u01a1n gi\u1ea3n - c\u00f3 th\u1ec3 c\u1eadp nh\u1eadt c\u00e1c ph\u1ea7n t\u1eed trong $O(1)$, nh\u01b0ng y\u00eau c\u1ea7u $O(n)$ \u0111\u1ec3 t\u00ednh to\u00e1n t\u1eebng truy v\u1ea5n t\u1ed5ng. V\u00e0 t\u1ed5ng ti\u1ec1n t\u1ed1 \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n tr\u01b0\u1edbc c\u00f3 th\u1ec3 t\u00ednh to\u00e1n c\u00e1c truy v\u1ea5n t\u1ed5ng trong $O(1)$, nh\u01b0ng vi\u1ec7c c\u1eadp nh\u1eadt m\u1ed9t ph\u1ea7n t\u1eed m\u1ea3ng y\u00eau c\u1ea7u $O(n)$ thay \u0111\u1ed5i \u0111\u1ed1i v\u1edbi t\u1ed5ng ti\u1ec1n t\u1ed1.</p>","tags":["Translated"]},{"location":"data_structures/segment_tree.html#structure-of-the-segment-tree","title":"C\u1ea5u tr\u00fac c\u1ee7a Segment Tree (Structure of the Segment Tree)","text":"<p>Ch\u00fang ta c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n c\u00e1ch ti\u1ebfp c\u1eadn chia \u0111\u1ec3 tr\u1ecb khi n\u00f3i \u0111\u1ebfn c\u00e1c \u0111o\u1ea1n m\u1ea3ng. Ch\u00fang ta t\u00ednh to\u00e1n v\u00e0 l\u01b0u tr\u1eef t\u1ed5ng c\u1ee7a c\u00e1c ph\u1ea7n t\u1eed c\u1ee7a to\u00e0n b\u1ed9 m\u1ea3ng, t\u1ee9c l\u00e0 t\u1ed5ng c\u1ee7a \u0111o\u1ea1n $a[0 \\dots n-1]$. Sau \u0111\u00f3, ch\u00fang ta chia m\u1ea3ng th\u00e0nh hai n\u1eeda $a[0 \\dots (n-1)/2]$ v\u00e0 $a[(n+1)/2 \\dots n-1]$ v\u00e0 t\u00ednh t\u1ed5ng c\u1ee7a m\u1ed7i n\u1eeda v\u00e0 l\u01b0u tr\u1eef ch\u00fang. M\u1ed7i n\u1eeda trong hai n\u1eeda n\u00e0y l\u1ea7n l\u01b0\u1ee3t \u0111\u01b0\u1ee3c chia \u0111\u00f4i, v\u00e0 c\u1ee9 th\u1ebf cho \u0111\u1ebfn khi t\u1ea5t c\u1ea3 c\u00e1c \u0111o\u1ea1n \u0111\u1ea1t k\u00edch th\u01b0\u1edbc $1$.</p> <p>Ch\u00fang ta c\u00f3 th\u1ec3 xem c\u00e1c \u0111o\u1ea1n n\u00e0y t\u1ea1o th\u00e0nh m\u1ed9t c\u00e2y nh\u1ecb ph\u00e2n: g\u1ed1c c\u1ee7a c\u00e2y n\u00e0y l\u00e0 \u0111o\u1ea1n $a[0 \\dots n-1]$, v\u00e0 m\u1ed7i \u0111\u1ec9nh (tr\u1eeb c\u00e1c \u0111\u1ec9nh l\u00e1) c\u00f3 ch\u00ednh x\u00e1c hai \u0111\u1ec9nh con. \u0110\u00e2y l\u00e0 l\u00fd do t\u1ea1i sao c\u1ea5u tr\u00fac d\u1eef li\u1ec7u \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 \"Segment Tree\", m\u1eb7c d\u00f9 trong h\u1ea7u h\u1ebft c\u00e1c tri\u1ec3n khai, c\u00e2y kh\u00f4ng \u0111\u01b0\u1ee3c x\u00e2y d\u1ef1ng m\u1ed9t c\u00e1ch r\u00f5 r\u00e0ng (xem C\u00e0i \u0111\u1eb7t).</p> <p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u1ed9t bi\u1ec3u di\u1ec5n tr\u1ef1c quan c\u1ee7a m\u1ed9t Segment Tree nh\u01b0 v\u1eady tr\u00ean m\u1ea3ng $a = [1, 3, -2, 8, -7]$:</p> <p></p> <p>T\u1eeb m\u00f4 t\u1ea3 ng\u1eafn g\u1ecdn n\u00e0y v\u1ec1 c\u1ea5u tr\u00fac d\u1eef li\u1ec7u, ch\u00fang ta \u0111\u00e3 c\u00f3 th\u1ec3 k\u1ebft lu\u1eadn r\u1eb1ng m\u1ed9t Segment Tree ch\u1ec9 y\u00eau c\u1ea7u m\u1ed9t s\u1ed1 l\u01b0\u1ee3ng \u0111\u1ec9nh tuy\u1ebfn t\u00ednh. C\u1ea5p \u0111\u1ea7u ti\u00ean c\u1ee7a c\u00e2y ch\u1ee9a m\u1ed9t n\u00fat duy nh\u1ea5t (g\u1ed1c), c\u1ea5p th\u1ee9 hai s\u1ebd ch\u1ee9a hai \u0111\u1ec9nh, trong c\u1ea5p th\u1ee9 ba n\u00f3 s\u1ebd ch\u1ee9a b\u1ed1n \u0111\u1ec9nh, cho \u0111\u1ebfn khi s\u1ed1 l\u01b0\u1ee3ng \u0111\u1ec9nh \u0111\u1ea1t $n$. Do \u0111\u00f3, s\u1ed1 l\u01b0\u1ee3ng \u0111\u1ec9nh trong tr\u01b0\u1eddng h\u1ee3p x\u1ea5u nh\u1ea5t c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c \u01b0\u1edbc t\u00ednh b\u1eb1ng t\u1ed5ng $1 + 2 + 4 + \\dots + 2^{\\lceil\\log_2 n\\rceil} \\lt 2^{\\lceil\\log_2 n\\rceil + 1} \\lt 4n$.</p> <p>\u0110i\u1ec1u \u0111\u00e1ng ch\u00fa \u00fd l\u00e0 b\u1ea5t c\u1ee9 khi n\u00e0o $n$ kh\u00f4ng ph\u1ea3i l\u00e0 l\u0169y th\u1eeba c\u1ee7a hai, kh\u00f4ng ph\u1ea3i t\u1ea5t c\u1ea3 c\u00e1c c\u1ea5p c\u1ee7a Segment Tree s\u1ebd \u0111\u01b0\u1ee3c l\u1ea5p \u0111\u1ea7y ho\u00e0n to\u00e0n. Ch\u00fang ta c\u00f3 th\u1ec3 th\u1ea5y h\u00e0nh vi \u0111\u00f3 trong h\u00ecnh \u1ea3nh. B\u00e2y gi\u1edd ch\u00fang ta c\u00f3 th\u1ec3 qu\u00ean \u0111i th\u1ef1c t\u1ebf n\u00e0y, nh\u01b0ng n\u00f3 s\u1ebd tr\u1edf n\u00ean quan tr\u1ecdng sau n\u00e0y trong qu\u00e1 tr\u00ecnh c\u00e0i \u0111\u1eb7t.</p> <p>Chi\u1ec1u cao c\u1ee7a Segment Tree l\u00e0 $O(\\log n)$, b\u1edfi v\u00ec khi \u0111i xu\u1ed1ng t\u1eeb g\u1ed1c \u0111\u1ebfn c\u00e1c l\u00e1, k\u00edch th\u01b0\u1edbc c\u1ee7a c\u00e1c \u0111o\u1ea1n gi\u1ea3m kho\u1ea3ng m\u1ed9t n\u1eeda.</p>","tags":["Translated"]},{"location":"data_structures/segment_tree.html#construction","title":"X\u00e2y d\u1ef1ng (Construction)","text":"<p>Tr\u01b0\u1edbc khi x\u00e2y d\u1ef1ng segment tree, ch\u00fang ta c\u1ea7n quy\u1ebft \u0111\u1ecbnh:</p> <ol> <li>gi\u00e1 tr\u1ecb \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef t\u1ea1i m\u1ed7i n\u00fat c\u1ee7a segment tree.     V\u00ed d\u1ee5, trong m\u1ed9t segment tree t\u1ed5ng, m\u1ed9t n\u00fat s\u1ebd l\u01b0u tr\u1eef t\u1ed5ng c\u1ee7a c\u00e1c ph\u1ea7n t\u1eed trong ph\u1ea1m vi $[l, r]$ c\u1ee7a n\u00f3.</li> <li>thao t\u00e1c h\u1ee3p nh\u1ea5t (merge) k\u1ebft h\u1ee3p hai anh em trong m\u1ed9t segment tree.     V\u00ed d\u1ee5, trong m\u1ed9t segment tree t\u1ed5ng, hai n\u00fat t\u01b0\u01a1ng \u1ee9ng v\u1edbi c\u00e1c ph\u1ea1m vi $a[l_1 \\dots r_1]$ v\u00e0 $a[l_2 \\dots r_2]$ s\u1ebd \u0111\u01b0\u1ee3c h\u1ee3p nh\u1ea5t th\u00e0nh m\u1ed9t n\u00fat t\u01b0\u01a1ng \u1ee9ng v\u1edbi ph\u1ea1m vi $a[l_1 \\dots r_2]$ b\u1eb1ng c\u00e1ch c\u1ed9ng c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a hai n\u00fat.</li> </ol> <p>L\u01b0u \u00fd r\u1eb1ng m\u1ed9t \u0111\u1ec9nh l\u00e0 m\u1ed9t \"\u0111\u1ec9nh l\u00e1\", n\u1ebfu \u0111o\u1ea1n t\u01b0\u01a1ng \u1ee9ng c\u1ee7a n\u00f3 ch\u1ec9 bao g\u1ed3m m\u1ed9t gi\u00e1 tr\u1ecb trong m\u1ea3ng ban \u0111\u1ea7u. N\u00f3 c\u00f3 m\u1eb7t \u1edf c\u1ea5p th\u1ea5p nh\u1ea5t c\u1ee7a m\u1ed9t segment tree. Gi\u00e1 tr\u1ecb c\u1ee7a n\u00f3 s\u1ebd b\u1eb1ng ph\u1ea7n t\u1eed (t\u01b0\u01a1ng \u1ee9ng) $a[i]$.</p> <p>B\u00e2y gi\u1edd, \u0111\u1ec3 x\u00e2y d\u1ef1ng segment tree, ch\u00fang ta b\u1eaft \u0111\u1ea7u \u1edf c\u1ea5p d\u01b0\u1edbi c\u00f9ng (c\u00e1c \u0111\u1ec9nh l\u00e1) v\u00e0 g\u00e1n cho ch\u00fang c\u00e1c gi\u00e1 tr\u1ecb t\u01b0\u01a1ng \u1ee9ng. Tr\u00ean c\u01a1 s\u1edf c\u00e1c gi\u00e1 tr\u1ecb n\u00e0y, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh to\u00e1n c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a c\u1ea5p tr\u01b0\u1edbc \u0111\u00f3, b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng h\u00e0m <code>merge</code>. V\u00e0 tr\u00ean c\u01a1 s\u1edf \u0111\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh to\u00e1n c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a c\u1ea5p tr\u01b0\u1edbc n\u1eefa, v\u00e0 l\u1eb7p l\u1ea1i quy tr\u00ecnh cho \u0111\u1ebfn khi ch\u00fang ta \u0111\u1ebfn \u0111\u1ec9nh g\u1ed1c.</p> <p>Thu\u1eadn ti\u1ec7n \u0111\u1ec3 m\u00f4 t\u1ea3 thao t\u00e1c n\u00e0y m\u1ed9t c\u00e1ch \u0111\u1ec7 quy theo h\u01b0\u1edbng kh\u00e1c, t\u1ee9c l\u00e0, t\u1eeb \u0111\u1ec9nh g\u1ed1c \u0111\u1ebfn c\u00e1c \u0111\u1ec9nh l\u00e1. Th\u1ee7 t\u1ee5c x\u00e2y d\u1ef1ng, n\u1ebfu \u0111\u01b0\u1ee3c g\u1ecdi tr\u00ean m\u1ed9t \u0111\u1ec9nh kh\u00f4ng ph\u1ea3i l\u00e1, th\u1ef1c hi\u1ec7n nh\u01b0 sau:</p> <ol> <li>x\u00e2y d\u1ef1ng \u0111\u1ec7 quy c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a hai \u0111\u1ec9nh con</li> <li>h\u1ee3p nh\u1ea5t c\u00e1c gi\u00e1 tr\u1ecb \u0111\u00e3 t\u00ednh to\u00e1n c\u1ee7a c\u00e1c con n\u00e0y.</li> </ol> <p>Ch\u00fang ta b\u1eaft \u0111\u1ea7u x\u00e2y d\u1ef1ng t\u1ea1i \u0111\u1ec9nh g\u1ed1c, v\u00e0 do \u0111\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh to\u00e1n to\u00e0n b\u1ed9 segment tree.</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian c\u1ee7a vi\u1ec7c x\u00e2y d\u1ef1ng n\u00e0y l\u00e0 $O(n)$, gi\u1ea3 s\u1eed r\u1eb1ng thao t\u00e1c h\u1ee3p nh\u1ea5t l\u00e0 th\u1eddi gian h\u1eb1ng s\u1ed1 (thao t\u00e1c h\u1ee3p nh\u1ea5t \u0111\u01b0\u1ee3c g\u1ecdi $n$ l\u1ea7n, b\u1eb1ng s\u1ed1 l\u01b0\u1ee3ng c\u00e1c n\u00fat b\u00ean trong segment tree).</p>","tags":["Translated"]},{"location":"data_structures/segment_tree.html#sum-queries","title":"Truy v\u1ea5n t\u1ed5ng (Sum queries)","text":"<p>B\u00e2y gi\u1edd ch\u00fang ta s\u1ebd tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n t\u1ed5ng. L\u00e0 \u0111\u1ea7u v\u00e0o, ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c hai s\u1ed1 nguy\u00ean $l$ v\u00e0 $r$, v\u00e0 ch\u00fang ta ph\u1ea3i t\u00ednh t\u1ed5ng c\u1ee7a \u0111o\u1ea1n $a[l \\dots r]$ trong th\u1eddi gian $O(\\log n)$.</p> <p>\u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y, ch\u00fang ta s\u1ebd duy\u1ec7t qua Segment Tree v\u00e0 s\u1eed d\u1ee5ng c\u00e1c t\u1ed5ng \u0111\u00e3 t\u00ednh to\u00e1n tr\u01b0\u1edbc c\u1ee7a c\u00e1c \u0111o\u1ea1n. Gi\u1ea3 s\u1eed r\u1eb1ng ch\u00fang ta hi\u1ec7n \u0111ang \u1edf \u0111\u1ec9nh bao g\u1ed3m \u0111o\u1ea1n $a[tl \\dots tr]$. C\u00f3 ba tr\u01b0\u1eddng h\u1ee3p c\u00f3 th\u1ec3 x\u1ea3y ra.</p> <p>Tr\u01b0\u1eddng h\u1ee3p d\u1ec5 nh\u1ea5t l\u00e0 khi \u0111o\u1ea1n $a[l \\dots r]$ b\u1eb1ng v\u1edbi \u0111o\u1ea1n t\u01b0\u01a1ng \u1ee9ng c\u1ee7a \u0111\u1ec9nh hi\u1ec7n t\u1ea1i (t\u1ee9c l\u00e0 $a[l \\dots r] = a[tl \\dots tr]$), th\u00ec ch\u00fang ta \u0111\u00e3 ho\u00e0n th\u00e0nh v\u00e0 c\u00f3 th\u1ec3 tr\u1ea3 v\u1ec1 t\u1ed5ng \u0111\u00e3 t\u00ednh to\u00e1n tr\u01b0\u1edbc \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef trong \u0111\u1ec9nh.</p> <p>Ngo\u00e0i ra, \u0111o\u1ea1n c\u1ee7a truy v\u1ea5n c\u00f3 th\u1ec3 r\u01a1i ho\u00e0n to\u00e0n v\u00e0o mi\u1ec1n c\u1ee7a con tr\u00e1i ho\u1eb7c con ph\u1ea3i. H\u00e3y nh\u1edb l\u1ea1i r\u1eb1ng con tr\u00e1i bao g\u1ed3m \u0111o\u1ea1n $a[tl \\dots tm]$ v\u00e0 \u0111\u1ec9nh ph\u1ea3i bao g\u1ed3m \u0111o\u1ea1n $a[tm + 1 \\dots tr]$ v\u1edbi $tm = (tl + tr) / 2$. Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, ch\u00fang ta ch\u1ec9 c\u1ea7n \u0111i \u0111\u1ebfn \u0111\u1ec9nh con, m\u00e0 \u0111o\u1ea1n t\u01b0\u01a1ng \u1ee9ng bao g\u1ed3m \u0111o\u1ea1n truy v\u1ea5n, v\u00e0 th\u1ef1c thi thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 \u1edf \u0111\u00e2y v\u1edbi \u0111\u1ec9nh \u0111\u00f3.</p> <p>V\u00e0 sau \u0111\u00f3 l\u00e0 tr\u01b0\u1eddng h\u1ee3p cu\u1ed1i c\u00f9ng, \u0111o\u1ea1n truy v\u1ea5n giao v\u1edbi c\u1ea3 hai con. Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, ch\u00fang ta kh\u00f4ng c\u00f3 l\u1ef1a ch\u1ecdn n\u00e0o kh\u00e1c ngo\u00e0i vi\u1ec7c th\u1ef1c hi\u1ec7n hai cu\u1ed9c g\u1ecdi \u0111\u1ec7 quy, m\u1ed9t cho m\u1ed7i con. \u0110\u1ea7u ti\u00ean ch\u00fang ta \u0111i \u0111\u1ebfn con tr\u00e1i, t\u00ednh to\u00e1n c\u00e2u tr\u1ea3 l\u1eddi m\u1ed9t ph\u1ea7n cho \u0111\u1ec9nh n\u00e0y (t\u1ee9c l\u00e0 t\u1ed5ng c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a ph\u1ea7n giao nhau gi\u1eefa \u0111o\u1ea1n c\u1ee7a truy v\u1ea5n v\u00e0 \u0111o\u1ea1n c\u1ee7a con tr\u00e1i), sau \u0111\u00f3 \u0111i \u0111\u1ebfn con ph\u1ea3i, t\u00ednh to\u00e1n c\u00e2u tr\u1ea3 l\u1eddi m\u1ed9t ph\u1ea7n b\u1eb1ng \u0111\u1ec9nh \u0111\u00f3, v\u00e0 sau \u0111\u00f3 k\u1ebft h\u1ee3p c\u00e1c c\u00e2u tr\u1ea3 l\u1eddi b\u1eb1ng c\u00e1ch c\u1ed9ng ch\u00fang l\u1ea1i. N\u00f3i c\u00e1ch kh\u00e1c, v\u00ec con tr\u00e1i \u0111\u1ea1i di\u1ec7n cho \u0111o\u1ea1n $a[tl \\dots tm]$ v\u00e0 con ph\u1ea3i \u0111\u1ea1i di\u1ec7n cho \u0111o\u1ea1n $a[tm+1 \\dots tr]$, ch\u00fang ta t\u00ednh to\u00e1n truy v\u1ea5n t\u1ed5ng $a[l \\dots tm]$ b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng con tr\u00e1i, v\u00e0 truy v\u1ea5n t\u1ed5ng $a[tm+1 \\dots r]$ b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng con ph\u1ea3i.</p> <p>V\u00ec v\u1eady, x\u1eed l\u00fd truy v\u1ea5n t\u1ed5ng l\u00e0 m\u1ed9t h\u00e0m \u0111\u1ec7 quy t\u1ef1 g\u1ecdi ch\u00ednh n\u00f3 m\u1ed9t l\u1ea7n v\u1edbi con tr\u00e1i ho\u1eb7c con ph\u1ea3i (kh\u00f4ng thay \u0111\u1ed5i ranh gi\u1edbi truy v\u1ea5n), ho\u1eb7c hai l\u1ea7n, m\u1ed9t l\u1ea7n cho con tr\u00e1i v\u00e0 m\u1ed9t l\u1ea7n cho con ph\u1ea3i (b\u1eb1ng c\u00e1ch chia truy v\u1ea5n th\u00e0nh hai truy v\u1ea5n con). V\u00e0 \u0111\u1ec7 quy k\u1ebft th\u00fac, b\u1ea5t c\u1ee9 khi n\u00e0o ranh gi\u1edbi c\u1ee7a \u0111o\u1ea1n truy v\u1ea5n hi\u1ec7n t\u1ea1i tr\u00f9ng v\u1edbi ranh gi\u1edbi c\u1ee7a \u0111o\u1ea1n c\u1ee7a \u0111\u1ec9nh hi\u1ec7n t\u1ea1i. Trong tr\u01b0\u1eddng h\u1ee3p \u0111\u00f3, c\u00e2u tr\u1ea3 l\u1eddi s\u1ebd l\u00e0 gi\u00e1 tr\u1ecb \u0111\u00e3 t\u00ednh to\u00e1n tr\u01b0\u1edbc c\u1ee7a t\u1ed5ng c\u1ee7a \u0111o\u1ea1n n\u00e0y, \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef trong c\u00e2y.</p> <p>N\u00f3i c\u00e1ch kh\u00e1c, vi\u1ec7c t\u00ednh to\u00e1n truy v\u1ea5n l\u00e0 m\u1ed9t qu\u00e1 tr\u00ecnh duy\u1ec7t c\u00e2y, lan truy\u1ec1n qua t\u1ea5t c\u1ea3 c\u00e1c nh\u00e1nh c\u1ea7n thi\u1ebft c\u1ee7a c\u00e2y, v\u00e0 s\u1eed d\u1ee5ng c\u00e1c gi\u00e1 tr\u1ecb t\u1ed5ng \u0111\u00e3 t\u00ednh to\u00e1n tr\u01b0\u1edbc c\u1ee7a c\u00e1c \u0111o\u1ea1n trong c\u00e2y.</p> <p>R\u00f5 r\u00e0ng ch\u00fang ta s\u1ebd b\u1eaft \u0111\u1ea7u duy\u1ec7t t\u1eeb \u0111\u1ec9nh g\u1ed1c c\u1ee7a Segment Tree.</p> <p>Th\u1ee7 t\u1ee5c \u0111\u01b0\u1ee3c minh h\u1ecda trong h\u00ecnh \u1ea3nh sau. M\u1ed9t l\u1ea7n n\u1eefa m\u1ea3ng $a = [1, 3, -2, 8, -7]$ \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng, v\u00e0 \u1edf \u0111\u00e2y ch\u00fang ta mu\u1ed1n t\u00ednh t\u1ed5ng $\\sum_{i=2}^4 a[i]$. C\u00e1c \u0111\u1ec9nh c\u00f3 m\u00e0u s\u1ebd \u0111\u01b0\u1ee3c truy c\u1eadp, v\u00e0 ch\u00fang ta s\u1ebd s\u1eed d\u1ee5ng c\u00e1c gi\u00e1 tr\u1ecb \u0111\u00e3 t\u00ednh to\u00e1n tr\u01b0\u1edbc c\u1ee7a c\u00e1c \u0111\u1ec9nh m\u00e0u xanh l\u00e1 c\u00e2y. \u0110i\u1ec1u n\u00e0y cho ch\u00fang ta k\u1ebft qu\u1ea3 $-2 + 1 = -1$.</p> <p></p> <p>T\u1ea1i sao \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a thu\u1eadt to\u00e1n n\u00e0y l\u00e0 $O(\\log n)$? \u0110\u1ec3 hi\u1ec3n th\u1ecb \u0111\u1ed9 ph\u1ee9c t\u1ea1p n\u00e0y, ch\u00fang ta xem x\u00e9t t\u1eebng c\u1ea5p c\u1ee7a c\u00e2y. H\u00f3a ra, \u0111\u1ed1i v\u1edbi m\u1ed7i c\u1ea5p, ch\u00fang ta ch\u1ec9 truy c\u1eadp kh\u00f4ng qu\u00e1 b\u1ed1n \u0111\u1ec9nh. V\u00e0 v\u00ec chi\u1ec1u cao c\u1ee7a c\u00e2y l\u00e0 $O(\\log n)$, ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c th\u1eddi gian ch\u1ea1y mong mu\u1ed1n.</p> <p>Ch\u00fang ta c\u00f3 th\u1ec3 ch\u1ee9ng minh r\u1eb1ng m\u1ec7nh \u0111\u1ec1 n\u00e0y (t\u1ed1i \u0111a b\u1ed1n \u0111\u1ec9nh m\u1ed7i c\u1ea5p) l\u00e0 \u0111\u00fang b\u1eb1ng quy n\u1ea1p. \u1ede c\u1ea5p \u0111\u1ed9 \u0111\u1ea7u ti\u00ean, ch\u00fang ta ch\u1ec9 truy c\u1eadp m\u1ed9t \u0111\u1ec9nh, \u0111\u1ec9nh g\u1ed1c, v\u00ec v\u1eady \u1edf \u0111\u00e2y ch\u00fang ta truy c\u1eadp \u00edt h\u01a1n b\u1ed1n \u0111\u1ec9nh. B\u00e2y gi\u1edd h\u00e3y nh\u00ecn v\u00e0o m\u1ed9t c\u1ea5p \u0111\u1ed9 t\u00f9y \u00fd. Theo gi\u1ea3 thuy\u1ebft quy n\u1ea1p, ch\u00fang ta truy c\u1eadp t\u1ed1i \u0111a b\u1ed1n \u0111\u1ec9nh. N\u1ebfu ch\u00fang ta ch\u1ec9 truy c\u1eadp t\u1ed1i \u0111a hai \u0111\u1ec9nh, c\u1ea5p \u0111\u1ed9 ti\u1ebfp theo c\u00f3 t\u1ed1i \u0111a b\u1ed1n \u0111\u1ec9nh. \u0110i\u1ec1u \u0111\u00f3 l\u00e0 t\u1ea7m th\u01b0\u1eddng, b\u1edfi v\u00ec m\u1ed7i \u0111\u1ec9nh ch\u1ec9 c\u00f3 th\u1ec3 g\u00e2y ra t\u1ed1i \u0111a hai cu\u1ed9c g\u1ecdi \u0111\u1ec7 quy. V\u00ec v\u1eady, h\u00e3y gi\u1ea3 s\u1eed r\u1eb1ng ch\u00fang ta truy c\u1eadp ba ho\u1eb7c b\u1ed1n \u0111\u1ec9nh trong c\u1ea5p \u0111\u1ed9 hi\u1ec7n t\u1ea1i. T\u1eeb nh\u1eefng \u0111\u1ec9nh \u0111\u00f3, ch\u00fang ta s\u1ebd ph\u00e2n t\u00edch c\u00e1c \u0111\u1ec9nh \u1edf gi\u1eefa c\u1ea9n th\u1eadn h\u01a1n. V\u00ec truy v\u1ea5n t\u1ed5ng y\u00eau c\u1ea7u t\u1ed5ng c\u1ee7a m\u1ed9t m\u1ea3ng con li\u00ean t\u1ee5c, ch\u00fang ta bi\u1ebft r\u1eb1ng c\u00e1c \u0111o\u1ea1n t\u01b0\u01a1ng \u1ee9ng v\u1edbi c\u00e1c \u0111\u1ec9nh \u0111\u01b0\u1ee3c truy c\u1eadp \u1edf gi\u1eefa s\u1ebd \u0111\u01b0\u1ee3c bao ph\u1ee7 ho\u00e0n to\u00e0n b\u1edfi \u0111o\u1ea1n c\u1ee7a truy v\u1ea5n t\u1ed5ng. Do \u0111\u00f3, c\u00e1c \u0111\u1ec9nh n\u00e0y s\u1ebd kh\u00f4ng th\u1ef1c hi\u1ec7n b\u1ea5t k\u1ef3 cu\u1ed9c g\u1ecdi \u0111\u1ec7 quy n\u00e0o. V\u00ec v\u1eady, ch\u1ec9 c\u00f3 \u0111\u1ec9nh ngo\u00e0i c\u00f9ng b\u00ean tr\u00e1i v\u00e0 \u0111\u1ec9nh ngo\u00e0i c\u00f9ng b\u00ean ph\u1ea3i m\u1edbi c\u00f3 ti\u1ec1m n\u0103ng th\u1ef1c hi\u1ec7n c\u00e1c cu\u1ed9c g\u1ecdi \u0111\u1ec7 quy. V\u00e0 nh\u1eefng \u0111\u1ec9nh \u0111\u00f3 s\u1ebd ch\u1ec9 t\u1ea1o ra t\u1ed1i \u0111a b\u1ed1n cu\u1ed9c g\u1ecdi \u0111\u1ec7 quy, v\u00ec v\u1eady c\u1ea5p \u0111\u1ed9 ti\u1ebfp theo c\u0169ng s\u1ebd th\u1ecfa m\u00e3n kh\u1eb3ng \u0111\u1ecbnh. Ch\u00fang ta c\u00f3 th\u1ec3 n\u00f3i r\u1eb1ng m\u1ed9t nh\u00e1nh ti\u1ebfp c\u1eadn ranh gi\u1edbi b\u00ean tr\u00e1i c\u1ee7a truy v\u1ea5n, v\u00e0 nh\u00e1nh th\u1ee9 hai ti\u1ebfp c\u1eadn ranh gi\u1edbi b\u00ean ph\u1ea3i.</p> <p>Do \u0111\u00f3, ch\u00fang ta truy c\u1eadp t\u1ed1i \u0111a $4 \\log n$ \u0111\u1ec9nh trong t\u1ed5ng s\u1ed1, v\u00e0 \u0111i\u1ec1u \u0111\u00f3 b\u1eb1ng v\u1edbi th\u1eddi gian ch\u1ea1y l\u00e0 $O(\\log n)$.</p> <p>T\u00f3m l\u1ea1i, truy v\u1ea5n ho\u1ea1t \u0111\u1ed9ng b\u1eb1ng c\u00e1ch chia \u0111o\u1ea1n \u0111\u1ea7u v\u00e0o th\u00e0nh nhi\u1ec1u \u0111o\u1ea1n con m\u00e0 t\u1ea5t c\u1ea3 c\u00e1c t\u1ed5ng \u0111\u00e3 \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n tr\u01b0\u1edbc v\u00e0 l\u01b0u tr\u1eef trong c\u00e2y. V\u00e0 n\u1ebfu ch\u00fang ta ng\u1eebng ph\u00e2n chia b\u1ea5t c\u1ee9 khi n\u00e0o \u0111o\u1ea1n truy v\u1ea5n tr\u00f9ng v\u1edbi \u0111o\u1ea1n \u0111\u1ec9nh, th\u00ec ch\u00fang ta ch\u1ec9 c\u1ea7n $O(\\log n)$ \u0111o\u1ea1n nh\u01b0 v\u1eady, \u0111i\u1ec1u n\u00e0y mang l\u1ea1i hi\u1ec7u qu\u1ea3 c\u1ee7a Segment Tree.</p>","tags":["Translated"]},{"location":"data_structures/segment_tree.html#update-queries","title":"Truy v\u1ea5n c\u1eadp nh\u1eadt (Update queries)","text":"<p>B\u00e2y gi\u1edd ch\u00fang ta mu\u1ed1n s\u1eeda \u0111\u1ed5i m\u1ed9t ph\u1ea7n t\u1eed c\u1ee5 th\u1ec3 trong m\u1ea3ng, gi\u1ea3 s\u1eed ch\u00fang ta mu\u1ed1n th\u1ef1c hi\u1ec7n ph\u00e9p g\u00e1n $a[i] = x$. V\u00e0 ch\u00fang ta ph\u1ea3i x\u00e2y d\u1ef1ng l\u1ea1i Segment Tree, sao cho n\u00f3 t\u01b0\u01a1ng \u1ee9ng v\u1edbi m\u1ea3ng m\u1edbi, \u0111\u00e3 s\u1eeda \u0111\u1ed5i.</p> <p>Truy v\u1ea5n n\u00e0y d\u1ec5 h\u01a1n truy v\u1ea5n t\u1ed5ng. M\u1ed7i c\u1ea5p c\u1ee7a m\u1ed9t Segment Tree t\u1ea1o th\u00e0nh m\u1ed9t ph\u00e2n v\u00f9ng c\u1ee7a m\u1ea3ng. Do \u0111\u00f3, m\u1ed9t ph\u1ea7n t\u1eed $a[i]$ ch\u1ec9 \u0111\u00f3ng g\u00f3p v\u00e0o m\u1ed9t \u0111o\u1ea1n t\u1eeb m\u1ed7i c\u1ea5p. Do \u0111\u00f3 ch\u1ec9 c\u00f3 $O(\\log n)$ \u0111\u1ec9nh c\u1ea7n \u0111\u01b0\u1ee3c c\u1eadp nh\u1eadt.</p> <p>D\u1ec5 th\u1ea5y r\u1eb1ng, y\u00eau c\u1ea7u c\u1eadp nh\u1eadt c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng m\u1ed9t h\u00e0m \u0111\u1ec7 quy. H\u00e0m \u0111\u01b0\u1ee3c chuy\u1ec3n qua \u0111\u1ec9nh c\u00e2y hi\u1ec7n t\u1ea1i, v\u00e0 n\u00f3 g\u1ecdi \u0111\u1ec7 quy ch\u00ednh n\u00f3 v\u1edbi m\u1ed9t trong hai \u0111\u1ec9nh con (\u0111\u1ec9nh ch\u1ee9a $a[i]$ trong \u0111o\u1ea1n c\u1ee7a n\u00f3), v\u00e0 sau \u0111\u00f3 t\u00ednh to\u00e1n l\u1ea1i gi\u00e1 tr\u1ecb t\u1ed5ng c\u1ee7a n\u00f3, t\u01b0\u01a1ng t\u1ef1 nh\u01b0 c\u00e1ch n\u00f3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong ph\u01b0\u01a1ng th\u1ee9c build (\u0111\u00f3 l\u00e0 t\u1ed5ng c\u1ee7a hai con c\u1ee7a n\u00f3).</p> <p>M\u1ed9t l\u1ea7n n\u1eefa \u0111\u00e2y l\u00e0 m\u1ed9t h\u00ecnh \u1ea3nh tr\u1ef1c quan s\u1eed d\u1ee5ng c\u00f9ng m\u1ed9t m\u1ea3ng. \u1ede \u0111\u00e2y ch\u00fang ta th\u1ef1c hi\u1ec7n c\u1eadp nh\u1eadt $a[2] = 3$. C\u00e1c \u0111\u1ec9nh m\u00e0u xanh l\u00e1 c\u00e2y l\u00e0 c\u00e1c \u0111\u1ec9nh m\u00e0 ch\u00fang ta truy c\u1eadp v\u00e0 c\u1eadp nh\u1eadt.</p> <p></p>","tags":["Translated"]},{"location":"data_structures/segment_tree.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>C\u00e2n nh\u1eafc ch\u00ednh l\u00e0 c\u00e1ch l\u01b0u tr\u1eef Segment Tree. T\u1ea5t nhi\u00ean ch\u00fang ta c\u00f3 th\u1ec3 \u0111\u1ecbnh ngh\u0129a m\u1ed9t struct $\\text{Vertex}$ v\u00e0 t\u1ea1o c\u00e1c \u0111\u1ed1i t\u01b0\u1ee3ng, l\u01b0u tr\u1eef c\u00e1c ranh gi\u1edbi c\u1ee7a \u0111o\u1ea1n, t\u1ed5ng c\u1ee7a n\u00f3 v\u00e0 th\u00eam v\u00e0o \u0111\u00f3 l\u00e0 c\u00e1c con tr\u1ecf \u0111\u1ebfn c\u00e1c \u0111\u1ec9nh con c\u1ee7a n\u00f3. Tuy nhi\u00ean, \u0111i\u1ec1u n\u00e0y \u0111\u00f2i h\u1ecfi ph\u1ea3i l\u01b0u tr\u1eef r\u1ea5t nhi\u1ec1u th\u00f4ng tin d\u01b0 th\u1eeba d\u01b0\u1edbi d\u1ea1ng c\u00e1c con tr\u1ecf. Ch\u00fang ta s\u1ebd s\u1eed d\u1ee5ng m\u1ed9t th\u1ee7 thu\u1eadt \u0111\u01a1n gi\u1ea3n \u0111\u1ec3 l\u00e0m cho vi\u1ec7c n\u00e0y hi\u1ec7u qu\u1ea3 h\u01a1n nhi\u1ec1u b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng m\u1ed9t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u \u1ea9n (implicit data structure): Ch\u1ec9 l\u01b0u tr\u1eef c\u00e1c t\u1ed5ng trong m\u1ed9t m\u1ea3ng. (M\u1ed9t ph\u01b0\u01a1ng ph\u00e1p t\u01b0\u01a1ng t\u1ef1 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng cho binary heaps). T\u1ed5ng c\u1ee7a \u0111\u1ec9nh g\u1ed1c t\u1ea1i ch\u1ec9 s\u1ed1 1, t\u1ed5ng c\u1ee7a hai \u0111\u1ec9nh con c\u1ee7a n\u00f3 t\u1ea1i c\u00e1c ch\u1ec9 s\u1ed1 2 v\u00e0 3, t\u1ed5ng c\u1ee7a c\u00e1c con c\u1ee7a hai \u0111\u1ec9nh \u0111\u00f3 t\u1ea1i c\u00e1c ch\u1ec9 s\u1ed1 4 \u0111\u1ebfn 7, v.v. V\u1edbi ch\u1ec9 s\u1ed1 b\u1eaft \u0111\u1ea7u t\u1eeb 1, thu\u1eadn ti\u1ec7n l\u00e0 con tr\u00e1i c\u1ee7a m\u1ed9t \u0111\u1ec9nh t\u1ea1i ch\u1ec9 s\u1ed1 $i$ \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef t\u1ea1i ch\u1ec9 s\u1ed1 $2i$, v\u00e0 con ph\u1ea3i t\u1ea1i ch\u1ec9 s\u1ed1 $2i + 1$. T\u01b0\u01a1ng \u0111\u01b0\u01a1ng, cha c\u1ee7a m\u1ed9t \u0111\u1ec9nh t\u1ea1i ch\u1ec9 s\u1ed1 $i$ \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef t\u1ea1i $i/2$ (ph\u00e9p chia s\u1ed1 nguy\u00ean).</p> <p>\u0110i\u1ec1u n\u00e0y \u0111\u01a1n gi\u1ea3n h\u00f3a vi\u1ec7c c\u00e0i \u0111\u1eb7t r\u1ea5t nhi\u1ec1u. Ch\u00fang ta kh\u00f4ng c\u1ea7n l\u01b0u tr\u1eef c\u1ea5u tr\u00fac c\u1ee7a c\u00e2y trong b\u1ed9 nh\u1edb. N\u00f3 \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a ng\u1ea7m. Ch\u00fang ta ch\u1ec9 c\u1ea7n m\u1ed9t m\u1ea3ng ch\u1ee9a t\u1ed5ng c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c \u0111o\u1ea1n.</p> <p>Nh\u01b0 \u0111\u00e3 l\u01b0u \u00fd tr\u01b0\u1edbc \u0111\u00e2y, ch\u00fang ta c\u1ea7n l\u01b0u tr\u1eef t\u1ed1i \u0111a $4n$ \u0111\u1ec9nh. N\u00f3 c\u00f3 th\u1ec3 \u00edt h\u01a1n, nh\u01b0ng \u0111\u1ec3 thu\u1eadn ti\u1ec7n ch\u00fang ta lu\u00f4n c\u1ea5p ph\u00e1t m\u1ed9t m\u1ea3ng c\u00f3 k\u00edch th\u01b0\u1edbc $4n$. S\u1ebd c\u00f3 m\u1ed9t s\u1ed1 ph\u1ea7n t\u1eed trong m\u1ea3ng t\u1ed5ng, s\u1ebd kh\u00f4ng t\u01b0\u01a1ng \u1ee9ng v\u1edbi b\u1ea5t k\u1ef3 \u0111\u1ec9nh n\u00e0o trong c\u00e2y th\u1ef1c t\u1ebf, nh\u01b0ng \u0111i\u1ec1u n\u00e0y kh\u00f4ng l\u00e0m ph\u1ee9c t\u1ea1p vi\u1ec7c c\u00e0i \u0111\u1eb7t.</p> <p>V\u00ec v\u1eady, ch\u00fang ta l\u01b0u tr\u1eef Segment Tree \u0111\u01a1n gi\u1ea3n d\u01b0\u1edbi d\u1ea1ng m\u1ed9t m\u1ea3ng $t[]$ v\u1edbi k\u00edch th\u01b0\u1edbc g\u1ea5p b\u1ed1n l\u1ea7n k\u00edch th\u01b0\u1edbc \u0111\u1ea7u v\u00e0o $n$:</p> <pre><code>int n, t[4*MAXN];\n</code></pre> <p>Th\u1ee7 t\u1ee5c x\u00e2y d\u1ef1ng Segment Tree t\u1eeb m\u1ed9t m\u1ea3ng $a[]$ \u0111\u00e3 cho tr\u00f4ng nh\u01b0 th\u1ebf n\u00e0y: n\u00f3 l\u00e0 m\u1ed9t h\u00e0m \u0111\u1ec7 quy v\u1edbi c\u00e1c tham s\u1ed1 $a[]$ (m\u1ea3ng \u0111\u1ea7u v\u00e0o), $v$ (ch\u1ec9 s\u1ed1 c\u1ee7a \u0111\u1ec9nh hi\u1ec7n t\u1ea1i), v\u00e0 c\u00e1c ranh gi\u1edbi $tl$ v\u00e0 $tr$ c\u1ee7a \u0111o\u1ea1n hi\u1ec7n t\u1ea1i. Trong ch\u01b0\u01a1ng tr\u00ecnh ch\u00ednh, h\u00e0m n\u00e0y s\u1ebd \u0111\u01b0\u1ee3c g\u1ecdi v\u1edbi c\u00e1c tham s\u1ed1 c\u1ee7a \u0111\u1ec9nh g\u1ed1c: $v = 1$, $tl = 0$, v\u00e0 $tr = n - 1$.</p> <pre><code>void build(int a[], int v, int tl, int tr) {\n    if (tl == tr) {\n        t[v] = a[tl];\n    } else {\n        int tm = (tl + tr) / 2;\n        build(a, v*2, tl, tm);\n        build(a, v*2+1, tm+1, tr);\n        t[v] = t[v*2] + t[v*2+1];\n    }\n}\n</code></pre> <p>H\u01a1n n\u1eefa, h\u00e0m \u0111\u1ec3 tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n t\u1ed5ng c\u0169ng l\u00e0 m\u1ed9t h\u00e0m \u0111\u1ec7 quy, nh\u1eadn c\u00e1c tham s\u1ed1 th\u00f4ng tin v\u1ec1 \u0111\u1ec9nh/\u0111o\u1ea1n hi\u1ec7n t\u1ea1i (t\u1ee9c l\u00e0 ch\u1ec9 s\u1ed1 $v$ v\u00e0 c\u00e1c ranh gi\u1edbi $tl$ v\u00e0 $tr$) v\u00e0 c\u1ea3 th\u00f4ng tin v\u1ec1 c\u00e1c ranh gi\u1edbi c\u1ee7a truy v\u1ea5n, $l$ v\u00e0 $r$. \u0110\u1ec3 \u0111\u01a1n gi\u1ea3n h\u00f3a m\u00e3, h\u00e0m n\u00e0y lu\u00f4n th\u1ef1c hi\u1ec7n hai cu\u1ed9c g\u1ecdi \u0111\u1ec7 quy, ngay c\u1ea3 khi ch\u1ec9 c\u1ea7n m\u1ed9t - trong tr\u01b0\u1eddng h\u1ee3p \u0111\u00f3, cu\u1ed9c g\u1ecdi \u0111\u1ec7 quy th\u1eeba s\u1ebd c\u00f3 $l &gt; r$, v\u00e0 \u0111i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng b\u1ecb b\u1eaft b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng m\u1ed9t ki\u1ec3m tra b\u1ed5 sung \u1edf \u0111\u1ea7u h\u00e0m.</p> <pre><code>int sum(int v, int tl, int tr, int l, int r) {\n    if (l &gt; r) \n        return 0;\n    if (l == tl &amp;&amp; r == tr) {\n        return t[v];\n    }\n    int tm = (tl + tr) / 2;\n    return sum(v*2, tl, tm, l, min(r, tm))\n           + sum(v*2+1, tm+1, tr, max(l, tm+1), r);\n}\n</code></pre> <p>Cu\u1ed1i c\u00f9ng l\u00e0 truy v\u1ea5n c\u1eadp nh\u1eadt. H\u00e0m c\u0169ng s\u1ebd nh\u1eadn th\u00f4ng tin v\u1ec1 \u0111\u1ec9nh/\u0111o\u1ea1n hi\u1ec7n t\u1ea1i, v\u00e0 th\u00eam v\u00e0o \u0111\u00f3 l\u00e0 tham s\u1ed1 c\u1ee7a truy v\u1ea5n c\u1eadp nh\u1eadt (t\u1ee9c l\u00e0 v\u1ecb tr\u00ed c\u1ee7a ph\u1ea7n t\u1eed v\u00e0 gi\u00e1 tr\u1ecb m\u1edbi c\u1ee7a n\u00f3).</p> <pre><code>void update(int v, int tl, int tr, int pos, int new_val) {\n    if (tl == tr) {\n        t[v] = new_val;\n    } else {\n        int tm = (tl + tr) / 2;\n        if (pos &lt;= tm)\n            update(v*2, tl, tm, pos, new_val);\n        else\n            update(v*2+1, tm+1, tr, pos, new_val);\n        t[v] = t[v*2] + t[v*2+1];\n    }\n}\n</code></pre>","tags":["Translated"]},{"location":"data_structures/segment_tree.html#memory-efficient-implementation","title":"C\u00e0i \u0111\u1eb7t hi\u1ec7u qu\u1ea3 b\u1ed9 nh\u1edb (Memory efficient implementation)","text":"<p>H\u1ea7u h\u1ebft m\u1ecdi ng\u01b0\u1eddi s\u1eed d\u1ee5ng c\u00e0i \u0111\u1eb7t t\u1eeb ph\u1ea7n tr\u01b0\u1edbc. N\u1ebfu b\u1ea1n nh\u00ecn v\u00e0o m\u1ea3ng <code>t</code> b\u1ea1n c\u00f3 th\u1ec3 th\u1ea5y r\u1eb1ng n\u00f3 tu\u00e2n theo vi\u1ec7c \u0111\u00e1nh s\u1ed1 c\u00e1c n\u00fat c\u00e2y theo th\u1ee9 t\u1ef1 duy\u1ec7t BFS (duy\u1ec7t theo c\u1ea5p - level-order traversal). S\u1eed d\u1ee5ng c\u00e1ch duy\u1ec7t n\u00e0y, c\u00e1c con c\u1ee7a \u0111\u1ec9nh $v$ l\u1ea7n l\u01b0\u1ee3t l\u00e0 $2v$ v\u00e0 $2v + 1$. Tuy nhi\u00ean, n\u1ebfu $n$ kh\u00f4ng ph\u1ea3i l\u00e0 l\u0169y th\u1eeba c\u1ee7a hai, ph\u01b0\u01a1ng ph\u00e1p n\u00e0y s\u1ebd b\u1ecf qua m\u1ed9t s\u1ed1 ch\u1ec9 s\u1ed1 v\u00e0 \u0111\u1ec3 l\u1ea1i m\u1ed9t s\u1ed1 ph\u1ea7n c\u1ee7a m\u1ea3ng <code>t</code> kh\u00f4ng \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng. M\u1ee9c ti\u00eau th\u1ee5 b\u1ed9 nh\u1edb b\u1ecb gi\u1edbi h\u1ea1n b\u1edfi $4n$, m\u1eb7c d\u00f9 m\u1ed9t Segment Tree c\u1ee7a m\u1ed9t m\u1ea3ng $n$ ph\u1ea7n t\u1eed ch\u1ec9 y\u00eau c\u1ea7u $2n - 1$ \u0111\u1ec9nh.</p> <p>Tuy nhi\u00ean n\u00f3 c\u00f3 th\u1ec3 gi\u1ea3m \u0111\u01b0\u1ee3c. Ch\u00fang ta \u0111\u00e1nh s\u1ed1 l\u1ea1i c\u00e1c \u0111\u1ec9nh c\u1ee7a c\u00e2y theo th\u1ee9 t\u1ef1 duy\u1ec7t Euler tour (duy\u1ec7t ti\u1ec1n th\u1ee9 t\u1ef1 - pre-order traversal), v\u00e0 ch\u00fang ta vi\u1ebft t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh n\u00e0y c\u1ea1nh nhau.</p> <p>H\u00e3y xem x\u00e9t m\u1ed9t \u0111\u1ec9nh t\u1ea1i ch\u1ec9 s\u1ed1 $v$, v\u00e0 \u0111\u1ec3 n\u00f3 ch\u1ecbu tr\u00e1ch nhi\u1ec7m cho \u0111o\u1ea1n $[l, r]$, v\u00e0 \u0111\u1eb7t $mid = \\dfrac{l + r}{2}$. R\u00f5 r\u00e0ng l\u00e0 con tr\u00e1i s\u1ebd c\u00f3 ch\u1ec9 s\u1ed1 $v + 1$. Con tr\u00e1i ch\u1ecbu tr\u00e1ch nhi\u1ec7m cho \u0111o\u1ea1n $[l, mid]$, t\u1ee9c l\u00e0 t\u1ed5ng c\u1ed9ng s\u1ebd c\u00f3 $2 * (mid - l + 1) - 1$ \u0111\u1ec9nh trong c\u00e2y con c\u1ee7a con tr\u00e1i. Do \u0111\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh to\u00e1n ch\u1ec9 s\u1ed1 c\u1ee7a con ph\u1ea3i c\u1ee7a $v$. Ch\u1ec9 s\u1ed1 s\u1ebd l\u00e0 $v + 2 * (mid - l + 1)$. B\u1eb1ng c\u00e1ch \u0111\u00e1nh s\u1ed1 n\u00e0y, ch\u00fang ta \u0111\u1ea1t \u0111\u01b0\u1ee3c s\u1ef1 s\u1ee5t gi\u1ea3m b\u1ed9 nh\u1edb c\u1ea7n thi\u1ebft xu\u1ed1ng $2n$.</p>","tags":["Translated"]},{"location":"data_structures/segment_tree.html#advanced-versions-of-segment-trees","title":"C\u00e1c phi\u00ean b\u1ea3n n\u00e2ng cao c\u1ee7a Segment Trees (Advanced versions of Segment Trees)","text":"<p>M\u1ed9t Segment Tree l\u00e0 m\u1ed9t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u r\u1ea5t linh ho\u1ea1t, v\u00e0 cho ph\u00e9p c\u00e1c bi\u1ebfn th\u1ec3 v\u00e0 m\u1edf r\u1ed9ng theo nhi\u1ec1u h\u01b0\u1edbng kh\u00e1c nhau. H\u00e3y th\u1eed ph\u00e2n lo\u1ea1i ch\u00fang d\u01b0\u1edbi \u0111\u00e2y.</p>","tags":["Translated"]},{"location":"data_structures/segment_tree.html#more-complex-queries","title":"C\u00e1c truy v\u1ea5n ph\u1ee9c t\u1ea1p h\u01a1n (More complex queries)","text":"<p>C\u00f3 th\u1ec3 kh\u00e1 d\u1ec5 d\u00e0ng \u0111\u1ec3 thay \u0111\u1ed5i Segment Tree theo m\u1ed9t h\u01b0\u1edbng, sao cho n\u00f3 t\u00ednh to\u00e1n c\u00e1c truy v\u1ea5n kh\u00e1c nhau (v\u00ed d\u1ee5: t\u00ednh to\u00e1n gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t / l\u1edbn nh\u1ea5t thay v\u00ec t\u1ed5ng), nh\u01b0ng n\u00f3 c\u0169ng c\u00f3 th\u1ec3 r\u1ea5t kh\u00f4ng t\u1ea7m th\u01b0\u1eddng.</p>","tags":["Translated"]},{"location":"data_structures/segment_tree.html#finding-the-maximum","title":"T\u00ecm gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t (Finding the maximum)","text":"<p>Ch\u00fang ta h\u00e3y thay \u0111\u1ed5i nh\u1eb9 \u0111i\u1ec1u ki\u1ec7n c\u1ee7a b\u00e0i to\u00e1n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 \u1edf tr\u00ean: thay v\u00ec truy v\u1ea5n t\u1ed5ng, b\u00e2y gi\u1edd ch\u00fang ta s\u1ebd th\u1ef1c hi\u1ec7n c\u00e1c truy v\u1ea5n gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t.</p> <p>C\u00e2y s\u1ebd c\u00f3 c\u1ea5u tr\u00fac ch\u00ednh x\u00e1c gi\u1ed1ng nh\u01b0 c\u00e2y \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 \u1edf tr\u00ean. Ch\u00fang ta ch\u1ec9 c\u1ea7n thay \u0111\u1ed5i c\u00e1ch t\u00ednh $t[v]$ trong c\u00e1c h\u00e0m $\\text{build}$ v\u00e0 $\\text{update}$. $t[v]$ b\u00e2y gi\u1edd s\u1ebd l\u01b0u tr\u1eef gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t c\u1ee7a \u0111o\u1ea1n t\u01b0\u01a1ng \u1ee9ng. V\u00e0 ch\u00fang ta c\u0169ng c\u1ea7n thay \u0111\u1ed5i vi\u1ec7c t\u00ednh to\u00e1n gi\u00e1 tr\u1ecb tr\u1ea3 v\u1ec1 c\u1ee7a h\u00e0m $\\text{sum}$ (thay th\u1ebf ph\u00e9p c\u1ed9ng b\u1eb1ng gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t).</p> <p>T\u1ea5t nhi\u00ean b\u00e0i to\u00e1n n\u00e0y c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng thay \u0111\u1ed5i th\u00e0nh vi\u1ec7c t\u00ednh to\u00e1n gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t thay v\u00ec gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t.</p> <p>Thay v\u00ec hi\u1ec3n th\u1ecb m\u1ed9t c\u00e0i \u0111\u1eb7t cho b\u00e0i to\u00e1n n\u00e0y, c\u00e0i \u0111\u1eb7t s\u1ebd \u0111\u01b0\u1ee3c \u0111\u01b0a ra cho m\u1ed9t phi\u00ean b\u1ea3n ph\u1ee9c t\u1ea1p h\u01a1n c\u1ee7a b\u00e0i to\u00e1n n\u00e0y trong ph\u1ea7n ti\u1ebfp theo.</p>","tags":["Translated"]},{"location":"data_structures/segment_tree.html#finding-the-maximum-and-the-number-of-times-it-appears","title":"T\u00ecm gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t v\u00e0 s\u1ed1 l\u1ea7n xu\u1ea5t hi\u1ec7n c\u1ee7a n\u00f3 (Finding the maximum and the number of times it appears)","text":"<p>Nhi\u1ec7m v\u1ee5 n\u00e0y r\u1ea5t gi\u1ed1ng v\u1edbi nhi\u1ec7m v\u1ee5 tr\u01b0\u1edbc. Ngo\u00e0i vi\u1ec7c t\u00ecm gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t, ch\u00fang ta c\u0169ng ph\u1ea3i t\u00ecm s\u1ed1 l\u1ea7n xu\u1ea5t hi\u1ec7n c\u1ee7a n\u00f3.</p> <p>\u0110\u1ec3 gi\u1ea3i quy\u1ebft b\u00e0i to\u00e1n n\u00e0y, ch\u00fang ta l\u01b0u tr\u1eef m\u1ed9t c\u1eb7p s\u1ed1 t\u1ea1i m\u1ed7i \u0111\u1ec9nh trong c\u00e2y: Ngo\u00e0i gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t, ch\u00fang ta c\u0169ng l\u01b0u tr\u1eef s\u1ed1 l\u1ea7n xu\u1ea5t hi\u1ec7n c\u1ee7a n\u00f3 trong \u0111o\u1ea1n t\u01b0\u01a1ng \u1ee9ng. Vi\u1ec7c x\u00e1c \u0111\u1ecbnh c\u1eb7p ch\u00ednh x\u00e1c \u0111\u1ec3 l\u01b0u tr\u1eef t\u1ea1i $t[v]$ v\u1eabn c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong th\u1eddi gian h\u1eb1ng s\u1ed1 b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng th\u00f4ng tin c\u1ee7a c\u00e1c c\u1eb7p \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef t\u1ea1i c\u00e1c \u0111\u1ec9nh con. Vi\u1ec7c k\u1ebft h\u1ee3p hai c\u1eb7p nh\u01b0 v\u1eady n\u00ean \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong m\u1ed9t h\u00e0m ri\u00eang bi\u1ec7t, v\u00ec \u0111\u00e2y s\u1ebd l\u00e0 m\u1ed9t thao t\u00e1c m\u00e0 ch\u00fang ta s\u1ebd l\u00e0m trong khi x\u00e2y d\u1ef1ng c\u00e2y, trong khi tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t v\u00e0 trong khi th\u1ef1c hi\u1ec7n c\u00e1c s\u1eeda \u0111\u1ed5i.</p> <pre><code>pair&lt;int, int&gt; t[4*MAXN];\n\npair&lt;int, int&gt; combine(pair&lt;int, int&gt; a, pair&lt;int, int&gt; b) {\n    if (a.first &gt; b.first) \n        return a;\n    if (b.first &gt; a.first)\n        return b;\n    return make_pair(a.first, a.second + b.second);\n}\n\nvoid build(int a[], int v, int tl, int tr) {\n    if (tl == tr) {\n        t[v] = make_pair(a[tl], 1);\n    } else {\n        int tm = (tl + tr) / 2;\n        build(a, v*2, tl, tm);\n        build(a, v*2+1, tm+1, tr);\n        t[v] = combine(t[v*2], t[v*2+1]);\n    }\n}\n\npair&lt;int, int&gt; get_max(int v, int tl, int tr, int l, int r) {\n    if (l &gt; r)\n        return make_pair(-INF, 0);\n    if (l == tl &amp;&amp; r == tr)\n        return t[v];\n    int tm = (tl + tr) / 2;\n    return combine(get_max(v*2, tl, tm, l, min(r, tm)), \n                   get_max(v*2+1, tm+1, tr, max(l, tm+1), r));\n}\n\nvoid update(int v, int tl, int tr, int pos, int new_val) {\n    if (tl == tr) {\n        t[v] = make_pair(new_val, 1);\n    } else {\n        int tm = (tl + tr) / 2;\n        if (pos &lt;= tm)\n            update(v*2, tl, tm, pos, new_val);\n        else\n            update(v*2+1, tm+1, tr, pos, new_val);\n        t[v] = combine(t[v*2], t[v*2+1]);\n    }\n}\n</code></pre>","tags":["Translated"]},{"location":"data_structures/segment_tree.html#compute-the-greatest-common-divisor-least-common-multiple","title":"T\u00ednh \u01b0\u1edbc chung l\u1edbn nh\u1ea5t / b\u1ed9i chung nh\u1ecf nh\u1ea5t (Compute the greatest common divisor / least common multiple)","text":"<p>Trong b\u00e0i to\u00e1n n\u00e0y, ch\u00fang ta mu\u1ed1n t\u00ednh GCD / LCM c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 trong c\u00e1c ph\u1ea1m vi \u0111\u00e3 cho c\u1ee7a m\u1ea3ng.</p> <p>Bi\u1ebfn th\u1ec3 th\u00fa v\u1ecb n\u00e0y c\u1ee7a Segment Tree c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i quy\u1ebft theo c\u00e1ch ch\u00ednh x\u00e1c gi\u1ed1ng nh\u01b0 c\u00e1c Segment Trees m\u00e0 ch\u00fang ta \u0111\u00e3 suy ra cho c\u00e1c truy v\u1ea5n t\u1ed5ng / gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t / gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t: ch\u1ec9 c\u1ea7n l\u01b0u tr\u1eef GCD / LCM c\u1ee7a \u0111\u1ec9nh t\u01b0\u01a1ng \u1ee9ng trong m\u1ed7i \u0111\u1ec9nh c\u1ee7a c\u00e2y. Vi\u1ec7c k\u1ebft h\u1ee3p hai \u0111\u1ec9nh c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n b\u1eb1ng c\u00e1ch t\u00ednh GCD / LCM c\u1ee7a c\u1ea3 hai \u0111\u1ec9nh.</p>","tags":["Translated"]},{"location":"data_structures/segment_tree.html#counting-zero-search-kth","title":"\u0110\u1ebfm s\u1ed1 l\u01b0\u1ee3ng s\u1ed1 0, t\u00ecm s\u1ed1 0 th\u1ee9 $k$ (Counting the number of zeros, searching for the k-th zero)","text":"<p>Trong b\u00e0i to\u00e1n n\u00e0y, ch\u00fang ta mu\u1ed1n t\u00ecm s\u1ed1 l\u01b0\u1ee3ng s\u1ed1 0 trong m\u1ed9t \u0111o\u1ea1n \u0111\u00e3 cho, v\u00e0 t\u00ecm th\u00eam ch\u1ec9 s\u1ed1 c\u1ee7a s\u1ed1 0 th\u1ee9 $k$ b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng m\u1ed9t h\u00e0m th\u1ee9 hai.</p> <p>M\u1ed9t l\u1ea7n n\u1eefa, ch\u00fang ta ph\u1ea3i thay \u0111\u1ed5i c\u00e1c gi\u00e1 tr\u1ecb l\u01b0u tr\u1eef c\u1ee7a c\u00e2y m\u1ed9t ch\u00fat: L\u1ea7n n\u00e0y ch\u00fang ta s\u1ebd l\u01b0u tr\u1eef s\u1ed1 l\u01b0\u1ee3ng s\u1ed1 0 trong m\u1ed7i \u0111o\u1ea1n trong $t[]$. Kh\u00e1 r\u00f5 r\u00e0ng v\u1ec1 c\u00e1ch c\u00e0i \u0111\u1eb7t c\u00e1c h\u00e0m $\\text{build}$, $\\text{update}$ v\u00e0 $\\text{count_zero}$, ch\u00fang ta ch\u1ec9 c\u1ea7n s\u1eed d\u1ee5ng c\u00e1c \u00fd t\u01b0\u1edfng t\u1eeb b\u00e0i to\u00e1n truy v\u1ea5n t\u1ed5ng. Do \u0111\u00f3, ch\u00fang ta \u0111\u00e3 gi\u1ea3i quy\u1ebft ph\u1ea7n \u0111\u1ea7u ti\u00ean c\u1ee7a b\u00e0i to\u00e1n.</p> <p>B\u00e2y gi\u1edd ch\u00fang ta h\u1ecdc c\u00e1ch gi\u1ea3i quy\u1ebft b\u00e0i to\u00e1n t\u00ecm s\u1ed1 0 th\u1ee9 $k$ trong m\u1ea3ng $a[]$. \u0110\u1ec3 th\u1ef1c hi\u1ec7n nhi\u1ec7m v\u1ee5 n\u00e0y, ch\u00fang ta s\u1ebd \u0111i xu\u1ed1ng Segment Tree, b\u1eaft \u0111\u1ea7u t\u1eeb \u0111\u1ec9nh g\u1ed1c, v\u00e0 di chuy\u1ec3n m\u1ed7i l\u1ea7n sang con tr\u00e1i ho\u1eb7c con ph\u1ea3i, t\u00f9y thu\u1ed9c v\u00e0o vi\u1ec7c \u0111o\u1ea1n n\u00e0o ch\u1ee9a s\u1ed1 0 th\u1ee9 $k$. \u0110\u1ec3 quy\u1ebft \u0111\u1ecbnh ch\u00fang ta c\u1ea7n \u0111i \u0111\u1ebfn con n\u00e0o, ch\u1ec9 c\u1ea7n nh\u00ecn v\u00e0o s\u1ed1 l\u01b0\u1ee3ng s\u1ed1 0 xu\u1ea5t hi\u1ec7n trong \u0111o\u1ea1n t\u01b0\u01a1ng \u1ee9ng v\u1edbi \u0111\u1ec9nh tr\u00e1i. N\u1ebfu s\u1ed1 \u0111\u1ebfm \u0111\u00e3 t\u00ednh to\u00e1n tr\u01b0\u1edbc n\u00e0y l\u1edbn h\u01a1n ho\u1eb7c b\u1eb1ng $k$, c\u1ea7n ph\u1ea3i \u0111i xu\u1ed1ng con tr\u00e1i, v\u00e0 ng\u01b0\u1ee3c l\u1ea1i \u0111i xu\u1ed1ng con ph\u1ea3i. L\u01b0u \u00fd, n\u1ebfu ch\u00fang ta ch\u1ecdn con ph\u1ea3i, ch\u00fang ta ph\u1ea3i tr\u1eeb s\u1ed1 l\u01b0\u1ee3ng s\u1ed1 0 c\u1ee7a con tr\u00e1i kh\u1ecfi $k$.</p> <p>Trong vi\u1ec7c c\u00e0i \u0111\u1eb7t, ch\u00fang ta c\u00f3 th\u1ec3 x\u1eed l\u00fd tr\u01b0\u1eddng h\u1ee3p \u0111\u1eb7c bi\u1ec7t, $a[]$ ch\u1ee9a \u00edt h\u01a1n $k$ s\u1ed1 0, b\u1eb1ng c\u00e1ch tr\u1ea3 v\u1ec1 -1.</p> <pre><code>int find_kth(int v, int tl, int tr, int k) {\n    if (k &gt; t[v])\n        return -1;\n    if (tl == tr)\n        return tl;\n    int tm = (tl + tr) / 2;\n    if (t[v*2] &gt;= k)\n        return find_kth(v*2, tl, tm, k);\n    else \n        return find_kth(v*2+1, tm+1, tr, k - t[v*2]);\n}\n</code></pre>","tags":["Translated"]},{"location":"data_structures/segment_tree.html#searching-for-an-array-prefix-with-a-given-amount","title":"T\u00ecm ki\u1ebfm ti\u1ec1n t\u1ed1 m\u1ea3ng v\u1edbi m\u1ed9t l\u01b0\u1ee3ng nh\u1ea5t \u0111\u1ecbnh (Searching for an array prefix with a given amount)","text":"<p>Nhi\u1ec7m v\u1ee5 nh\u01b0 sau: \u0111\u1ed1i v\u1edbi m\u1ed9t gi\u00e1 tr\u1ecb $x$ \u0111\u00e3 cho, ch\u00fang ta ph\u1ea3i nhanh ch\u00f3ng t\u00ecm ch\u1ec9 s\u1ed1 nh\u1ecf nh\u1ea5t $i$ sao cho t\u1ed5ng c\u1ee7a $i$ ph\u1ea7n t\u1eed \u0111\u1ea7u ti\u00ean c\u1ee7a m\u1ea3ng $a[]$ l\u1edbn h\u01a1n ho\u1eb7c b\u1eb1ng $x$ (gi\u1ea3 s\u1eed r\u1eb1ng m\u1ea3ng $a[]$ ch\u1ec9 ch\u1ee9a c\u00e1c gi\u00e1 tr\u1ecb kh\u00f4ng \u00e2m).</p> <p>Nhi\u1ec7m v\u1ee5 n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i quy\u1ebft b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n, t\u00ednh t\u1ed5ng c\u1ee7a c\u00e1c ti\u1ec1n t\u1ed1 b\u1eb1ng Segment Tree. Tuy nhi\u00ean \u0111i\u1ec1u n\u00e0y s\u1ebd d\u1eabn \u0111\u1ebfn m\u1ed9t gi\u1ea3i ph\u00e1p $O(\\log^2 n)$.</p> <p>Thay v\u00e0o \u0111\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng c\u00f9ng m\u1ed9t \u00fd t\u01b0\u1edfng nh\u01b0 trong ph\u1ea7n tr\u01b0\u1edbc, v\u00e0 t\u00ecm v\u1ecb tr\u00ed b\u1eb1ng c\u00e1ch \u0111i xu\u1ed1ng c\u00e2y: b\u1eb1ng c\u00e1ch di chuy\u1ec3n m\u1ed7i l\u1ea7n sang tr\u00e1i ho\u1eb7c ph\u1ea3i, t\u00f9y thu\u1ed9c v\u00e0o t\u1ed5ng c\u1ee7a con tr\u00e1i. Do \u0111\u00f3 t\u00ecm th\u1ea5y c\u00e2u tr\u1ea3 l\u1eddi trong th\u1eddi gian $O(\\log n)$.</p>","tags":["Translated"]},{"location":"data_structures/segment_tree.html#searching-for-the-first-element-greater-than-a-given-amount","title":"T\u00ecm ki\u1ebfm ph\u1ea7n t\u1eed \u0111\u1ea7u ti\u00ean l\u1edbn h\u01a1n m\u1ed9t l\u01b0\u1ee3ng nh\u1ea5t \u0111\u1ecbnh (Searching for the first element greater than a given amount)","text":"<p>Nhi\u1ec7m v\u1ee5 nh\u01b0 sau: \u0111\u1ed1i v\u1edbi m\u1ed9t gi\u00e1 tr\u1ecb $x$ \u0111\u00e3 cho v\u00e0 m\u1ed9t \u0111o\u1ea1n $a[l \\dots r]$, t\u00ecm $i$ nh\u1ecf nh\u1ea5t trong \u0111o\u1ea1n $a[l \\dots r]$, sao cho $a[i]$ l\u1edbn h\u01a1n $x$.</p> <p>Nhi\u1ec7m v\u1ee5 n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i quy\u1ebft b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n tr\u00ean c\u00e1c truy v\u1ea5n ti\u1ec1n t\u1ed1 max v\u1edbi Segment Tree. Tuy nhi\u00ean, \u0111i\u1ec1u n\u00e0y s\u1ebd d\u1eabn \u0111\u1ebfn m\u1ed9t gi\u1ea3i ph\u00e1p $O(\\log^2 n)$.</p> <p>Thay v\u00e0o \u0111\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng c\u00f9ng m\u1ed9t \u00fd t\u01b0\u1edfng nh\u01b0 trong c\u00e1c ph\u1ea7n tr\u01b0\u1edbc, v\u00e0 t\u00ecm v\u1ecb tr\u00ed b\u1eb1ng c\u00e1ch \u0111i xu\u1ed1ng c\u00e2y: b\u1eb1ng c\u00e1ch di chuy\u1ec3n m\u1ed7i l\u1ea7n sang tr\u00e1i ho\u1eb7c ph\u1ea3i, t\u00f9y thu\u1ed9c v\u00e0o gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t c\u1ee7a con tr\u00e1i. Do \u0111\u00f3 t\u00ecm th\u1ea5y c\u00e2u tr\u1ea3 l\u1eddi trong th\u1eddi gian $O(\\log n)$.</p> <pre><code>int get_first(int v, int tl, int tr, int l, int r, int x) {\n    if(tl &gt; r || tr &lt; l) return -1;\n    if(t[v] &lt;= x) return -1;\n\n    if (tl== tr) return tl;\n\n    int tm = tl + (tr-tl)/2;\n    int left = get_first(2*v, tl, tm, l, r, x);\n    if(left != -1) return left;\n    return get_first(2*v+1, tm+1, tr, l ,r, x);\n}\n</code></pre>","tags":["Translated"]},{"location":"data_structures/segment_tree.html#finding-subsegments-with-the-maximal-sum","title":"T\u00ecm c\u00e1c \u0111o\u1ea1n con c\u00f3 t\u1ed5ng l\u1edbn nh\u1ea5t (Finding subsegments with the maximal sum)","text":"<p>\u1ede \u0111\u00e2y m\u1ed9t l\u1ea7n n\u1eefa ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c m\u1ed9t \u0111o\u1ea1n $a[l \\dots r]$ cho m\u1ed7i truy v\u1ea5n, l\u1ea7n n\u00e0y ch\u00fang ta ph\u1ea3i t\u00ecm m\u1ed9t \u0111o\u1ea1n con $a[l^\\prime \\dots r^\\prime]$ sao cho $l \\le l^\\prime$ v\u00e0 $r^\\prime \\le r$ v\u00e0 t\u1ed5ng c\u1ee7a c\u00e1c ph\u1ea7n t\u1eed c\u1ee7a \u0111o\u1ea1n n\u00e0y l\u00e0 l\u1edbn nh\u1ea5t. Nh\u01b0 tr\u01b0\u1edbc \u0111\u00e2y ch\u00fang ta c\u0169ng mu\u1ed1n c\u00f3 th\u1ec3 s\u1eeda \u0111\u1ed5i c\u00e1c ph\u1ea7n t\u1eed ri\u00eang l\u1ebb c\u1ee7a m\u1ea3ng. C\u00e1c ph\u1ea7n t\u1eed c\u1ee7a m\u1ea3ng c\u00f3 th\u1ec3 l\u00e0 s\u1ed1 \u00e2m, v\u00e0 \u0111o\u1ea1n con t\u1ed1i \u01b0u c\u00f3 th\u1ec3 r\u1ed7ng (v\u00ed d\u1ee5: n\u1ebfu t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed \u0111\u1ec1u \u00e2m).</p> <p>B\u00e0i to\u00e1n n\u00e0y l\u00e0 m\u1ed9t c\u00e1ch s\u1eed d\u1ee5ng kh\u00f4ng t\u1ea7m th\u01b0\u1eddng c\u1ee7a Segment Tree. L\u1ea7n n\u00e0y ch\u00fang ta s\u1ebd l\u01b0u tr\u1eef b\u1ed1n gi\u00e1 tr\u1ecb cho m\u1ed7i \u0111\u1ec9nh: t\u1ed5ng c\u1ee7a \u0111o\u1ea1n, t\u1ed5ng ti\u1ec1n t\u1ed1 l\u1edbn nh\u1ea5t, t\u1ed5ng h\u1eadu t\u1ed1 l\u1edbn nh\u1ea5t, v\u00e0 t\u1ed5ng c\u1ee7a \u0111o\u1ea1n con l\u1edbn nh\u1ea5t trong n\u00f3. N\u00f3i c\u00e1ch kh\u00e1c, \u0111\u1ed1i v\u1edbi m\u1ed7i \u0111o\u1ea1n c\u1ee7a Segment Tree, c\u00e2u tr\u1ea3 l\u1eddi \u0111\u00e3 \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n tr\u01b0\u1edbc c\u0169ng nh\u01b0 c\u00e1c c\u00e2u tr\u1ea3 l\u1eddi cho c\u00e1c \u0111o\u1ea1n ch\u1ea1m v\u00e0o ranh gi\u1edbi b\u00ean tr\u00e1i v\u00e0 b\u00ean ph\u1ea3i c\u1ee7a \u0111o\u1ea1n.</p> <p>L\u00e0m th\u1ebf n\u00e0o \u0111\u1ec3 x\u00e2y d\u1ef1ng m\u1ed9t c\u00e1i c\u00e2y v\u1edbi d\u1eef li\u1ec7u nh\u01b0 v\u1eady? M\u1ed9t l\u1ea7n n\u1eefa ch\u00fang ta t\u00ednh to\u00e1n n\u00f3 theo ki\u1ec3u \u0111\u1ec7 quy: \u0111\u1ea7u ti\u00ean ch\u00fang ta t\u00ednh to\u00e1n t\u1ea5t c\u1ea3 b\u1ed1n gi\u00e1 tr\u1ecb cho con tr\u00e1i v\u00e0 con ph\u1ea3i, v\u00e0 sau \u0111\u00f3 k\u1ebft h\u1ee3p ch\u00fang \u0111\u1ec3 l\u01b0u tr\u1eef b\u1ed1n gi\u00e1 tr\u1ecb cho \u0111\u1ec9nh hi\u1ec7n t\u1ea1i. L\u01b0u \u00fd c\u00e2u tr\u1ea3 l\u1eddi cho \u0111\u1ec9nh hi\u1ec7n t\u1ea1i l\u00e0 m\u1ed9t trong s\u1ed1:</p> <ul> <li>c\u00e2u tr\u1ea3 l\u1eddi c\u1ee7a con tr\u00e1i, c\u00f3 ngh\u0129a l\u00e0 \u0111o\u1ea1n con t\u1ed1i \u01b0u n\u1eb1m ho\u00e0n to\u00e0n trong \u0111o\u1ea1n c\u1ee7a con tr\u00e1i</li> <li>c\u00e2u tr\u1ea3 l\u1eddi c\u1ee7a con ph\u1ea3i, c\u00f3 ngh\u0129a l\u00e0 \u0111o\u1ea1n con t\u1ed1i \u01b0u n\u1eb1m ho\u00e0n to\u00e0n trong \u0111o\u1ea1n c\u1ee7a con ph\u1ea3i</li> <li>t\u1ed5ng c\u1ee7a t\u1ed5ng h\u1eadu t\u1ed1 l\u1edbn nh\u1ea5t c\u1ee7a con tr\u00e1i v\u00e0 t\u1ed5ng ti\u1ec1n t\u1ed1 l\u1edbn nh\u1ea5t c\u1ee7a con ph\u1ea3i, c\u00f3 ngh\u0129a l\u00e0 \u0111o\u1ea1n con t\u1ed1i \u01b0u giao v\u1edbi c\u1ea3 hai con.</li> </ul> <p>Do \u0111\u00f3 c\u00e2u tr\u1ea3 l\u1eddi cho \u0111\u1ec9nh hi\u1ec7n t\u1ea1i l\u00e0 gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t c\u1ee7a ba gi\u00e1 tr\u1ecb n\u00e0y. Vi\u1ec7c t\u00ednh to\u00e1n t\u1ed5ng ti\u1ec1n t\u1ed1 / h\u1eadu t\u1ed1 l\u1edbn nh\u1ea5t th\u1eadm ch\u00ed c\u00f2n d\u1ec5 d\u00e0ng h\u01a1n. D\u01b0\u1edbi \u0111\u00e2y l\u00e0 c\u00e0i \u0111\u1eb7t c\u1ee7a h\u00e0m $\\text{combine}$, ch\u1ec9 nh\u1eadn d\u1eef li\u1ec7u t\u1eeb con tr\u00e1i v\u00e0 con ph\u1ea3i, v\u00e0 tr\u1ea3 v\u1ec1 d\u1eef li\u1ec7u c\u1ee7a \u0111\u1ec9nh hi\u1ec7n t\u1ea1i.</p> <pre><code>struct data {\n    int sum, pref, suff, ans;\n};\n\ndata combine(data l, data r) {\n    data res;\n    res.sum = l.sum + r.sum;\n    res.pref = max(l.pref, l.sum + r.pref);\n    res.suff = max(r.suff, r.sum + l.suff);\n    res.ans = max(max(l.ans, r.ans), l.suff + r.pref);\n    return res;\n}\n</code></pre> <p>S\u1eed d\u1ee5ng h\u00e0m $\\text{combine}$, th\u1eadt d\u1ec5 d\u00e0ng \u0111\u1ec3 x\u00e2y d\u1ef1ng Segment Tree. Ch\u00fang ta c\u00f3 th\u1ec3 c\u00e0i \u0111\u1eb7t n\u00f3 theo c\u00e1ch ch\u00ednh x\u00e1c gi\u1ed1ng nh\u01b0 trong c\u00e1c c\u00e0i \u0111\u1eb7t tr\u01b0\u1edbc. \u0110\u1ec3 kh\u1edfi t\u1ea1o c\u00e1c \u0111\u1ec9nh l\u00e1, ch\u00fang ta t\u1ea1o th\u00eam h\u00e0m ph\u1ee5 tr\u1ee3 $\\text{make_data}$, s\u1ebd tr\u1ea3 v\u1ec1 m\u1ed9t \u0111\u1ed1i t\u01b0\u1ee3ng $\\text{data}$ ch\u1ee9a th\u00f4ng tin c\u1ee7a m\u1ed9t gi\u00e1 tr\u1ecb duy nh\u1ea5t.</p> <pre><code>data make_data(int val) {\n    data res;\n    res.sum = val;\n    res.pref = res.suff = res.ans = max(0, val);\n    return res;\n}\n\nvoid build(int a[], int v, int tl, int tr) {\n    if (tl == tr) {\n        t[v] = make_data(a[tl]);\n    } else {\n        int tm = (tl + tr) / 2;\n        build(a, v*2, tl, tm);\n        build(a, v*2+1, tm+1, tr);\n        t[v] = combine(t[v*2], t[v*2+1]);\n    }\n}\n\nvoid update(int v, int tl, int tr, int pos, int new_val) {\n    if (tl == tr) {\n        t[v] = make_data(new_val);\n    } else {\n        int tm = (tl + tr) / 2;\n        if (pos &lt;= tm)\n            update(v*2, tl, tm, pos, new_val);\n        else\n            update(v*2+1, tm+1, tr, pos, new_val);\n        t[v] = combine(t[v*2], t[v*2+1]);\n    }\n}\n</code></pre> <p>Ch\u1ec9 c\u00f2n l\u1ea1i, l\u00e0m th\u1ebf n\u00e0o \u0111\u1ec3 t\u00ednh to\u00e1n c\u00e2u tr\u1ea3 l\u1eddi cho m\u1ed9t truy v\u1ea5n. \u0110\u1ec3 tr\u1ea3 l\u1eddi n\u00f3, ch\u00fang ta \u0111i xu\u1ed1ng c\u00e2y nh\u01b0 tr\u01b0\u1edbc, chia truy v\u1ea5n th\u00e0nh nhi\u1ec1u \u0111o\u1ea1n con tr\u00f9ng v\u1edbi c\u00e1c \u0111o\u1ea1n c\u1ee7a Segment Tree, v\u00e0 k\u1ebft h\u1ee3p c\u00e1c c\u00e2u tr\u1ea3 l\u1eddi trong ch\u00fang th\u00e0nh m\u1ed9t c\u00e2u tr\u1ea3 l\u1eddi duy nh\u1ea5t cho truy v\u1ea5n. Khi \u0111\u00f3, r\u00f5 r\u00e0ng l\u00e0 c\u00f4ng vi\u1ec7c ho\u00e0n to\u00e0n gi\u1ed1ng nh\u01b0 trong Segment Tree \u0111\u01a1n gi\u1ea3n, nh\u01b0ng thay v\u00ec t\u00ednh t\u1ed5ng / t\u1ed1i thi\u1ec3u / t\u1ed1i \u0111a c\u00e1c gi\u00e1 tr\u1ecb, ch\u00fang ta s\u1eed d\u1ee5ng h\u00e0m $\\text{combine}$.</p> <pre><code>data query(int v, int tl, int tr, int l, int r) {\n    if (l &gt; r) \n        return make_data(0);\n    if (l == tl &amp;&amp; r == tr) \n        return t[v];\n    int tm = (tl + tr) / 2;\n    return combine(query(v*2, tl, tm, l, min(r, tm)), \n                   query(v*2+1, tm+1, tr, max(l, tm+1), r));\n}\n</code></pre>","tags":["Translated"]},{"location":"data_structures/segment_tree.html#luu-tru-toan-bo-mang-con-trong-moi-inh-saving-the-entire-subarrays-in-each-vertex","title":"L\u01b0u tr\u1eef to\u00e0n b\u1ed9 m\u1ea3ng con trong m\u1ed7i \u0111\u1ec9nh (Saving the entire subarrays in each vertex)","text":"<p>\u0110\u00e2y l\u00e0 m\u1ed9t ti\u1ec3u m\u1ee5c ri\u00eang bi\u1ec7t \u0111\u1ee9ng t\u00e1ch bi\u1ec7t v\u1edbi nh\u1eefng c\u00e1i kh\u00e1c, b\u1edfi v\u00ec t\u1ea1i m\u1ed7i \u0111\u1ec9nh c\u1ee7a Segment Tree, ch\u00fang ta kh\u00f4ng l\u01b0u tr\u1eef th\u00f4ng tin v\u1ec1 \u0111o\u1ea1n t\u01b0\u01a1ng \u1ee9ng \u1edf d\u1ea1ng n\u00e9n (t\u1ed5ng, t\u1ed1i thi\u1ec3u, t\u1ed1i \u0111a, ...), m\u00e0 l\u01b0u tr\u1eef t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed c\u1ee7a \u0111o\u1ea1n. Do \u0111\u00f3, g\u1ed1c c\u1ee7a Segment Tree s\u1ebd l\u01b0u tr\u1eef t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed c\u1ee7a m\u1ea3ng, \u0111\u1ec9nh con b\u00ean tr\u00e1i s\u1ebd l\u01b0u tr\u1eef n\u1eeda \u0111\u1ea7u c\u1ee7a m\u1ea3ng, \u0111\u1ec9nh b\u00ean ph\u1ea3i n\u1eeda sau, v.v.</p> <p>Trong \u1ee9ng d\u1ee5ng \u0111\u01a1n gi\u1ea3n nh\u1ea5t c\u1ee7a k\u1ef9 thu\u1eadt n\u00e0y, ch\u00fang ta l\u01b0u tr\u1eef c\u00e1c ph\u1ea7n t\u1eed theo th\u1ee9 t\u1ef1 \u0111\u00e3 s\u1eafp x\u1ebfp. Trong c\u00e1c phi\u00ean b\u1ea3n ph\u1ee9c t\u1ea1p h\u01a1n, c\u00e1c ph\u1ea7n t\u1eed kh\u00f4ng \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef trong danh s\u00e1ch, m\u00e0 l\u00e0 c\u00e1c c\u1ea5u tr\u00fac d\u1eef li\u1ec7u n\u00e2ng cao h\u01a1n (sets, maps, ...). Nh\u01b0ng t\u1ea5t c\u1ea3 c\u00e1c ph\u01b0\u01a1ng ph\u00e1p n\u00e0y \u0111\u1ec1u c\u00f3 y\u1ebfu t\u1ed1 chung, \u0111\u00f3 l\u00e0 m\u1ed7i \u0111\u1ec9nh y\u00eau c\u1ea7u b\u1ed9 nh\u1edb tuy\u1ebfn t\u00ednh (t\u1ee9c l\u00e0 t\u1ef7 l\u1ec7 thu\u1eadn v\u1edbi \u0111\u1ed9 d\u00e0i c\u1ee7a \u0111o\u1ea1n t\u01b0\u01a1ng \u1ee9ng).</p> <p>C\u00e2u h\u1ecfi t\u1ef1 nhi\u00ean \u0111\u1ea7u ti\u00ean, khi xem x\u00e9t c\u00e1c Segment Trees n\u00e0y, l\u00e0 v\u1ec1 m\u1ee9c ti\u00eau th\u1ee5 b\u1ed9 nh\u1edb. Theo tr\u1ef1c gi\u00e1c, \u0111i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 tr\u00f4ng gi\u1ed1ng nh\u01b0 b\u1ed9 nh\u1edb $O(n^2)$, nh\u01b0ng h\u00f3a ra to\u00e0n b\u1ed9 c\u00e2y s\u1ebd ch\u1ec9 c\u1ea7n b\u1ed9 nh\u1edb $O(n \\log n)$. T\u1ea1i sao l\u1ea1i nh\u01b0 v\u1eady? Kh\u00e1 \u0111\u01a1n gi\u1ea3n, b\u1edfi v\u00ec m\u1ed7i ph\u1ea7n t\u1eed c\u1ee7a m\u1ea3ng r\u01a1i v\u00e0o $O(\\log n)$ \u0111o\u1ea1n (h\u00e3y nh\u1edb chi\u1ec1u cao c\u1ee7a c\u00e2y l\u00e0 $O(\\log n)$).</p> <p>V\u00ec v\u1eady, m\u1eb7c d\u00f9 c\u00f3 v\u1ebb phung ph\u00ed c\u1ee7a m\u1ed9t Segment Tree nh\u01b0 v\u1eady, n\u00f3 ch\u1ec9 ti\u00eau th\u1ee5 nhi\u1ec1u b\u1ed9 nh\u1edb h\u01a1n m\u1ed9t ch\u00fat so v\u1edbi Segment Tree th\u00f4ng th\u01b0\u1eddng.</p> <p>M\u1ed9t s\u1ed1 \u1ee9ng d\u1ee5ng \u0111i\u1ec3n h\u00ecnh c\u1ee7a c\u1ea5u tr\u00fac d\u1eef li\u1ec7u n\u00e0y \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 d\u01b0\u1edbi \u0111\u00e2y. \u0110i\u1ec1u \u0111\u00e1ng ch\u00fa \u00fd l\u00e0 s\u1ef1 t\u01b0\u01a1ng \u0111\u1ed3ng c\u1ee7a c\u00e1c Segment Trees n\u00e0y v\u1edbi c\u1ea5u tr\u00fac d\u1eef li\u1ec7u 2D (tr\u00ean th\u1ef1c t\u1ebf \u0111\u00e2y l\u00e0 c\u1ea5u tr\u00fac d\u1eef li\u1ec7u 2D, nh\u01b0ng v\u1edbi kh\u1ea3 n\u0103ng h\u1ea1n ch\u1ebf).</p>","tags":["Translated"]},{"location":"data_structures/segment_tree.html#tim-so-nho-nhat-lon-hon-hoac-bang-mot-so-a-chi-inh-khong-co-truy-van-sua-oi","title":"T\u00ecm s\u1ed1 nh\u1ecf nh\u1ea5t l\u1edbn h\u01a1n ho\u1eb7c b\u1eb1ng m\u1ed9t s\u1ed1 \u0111\u00e3 ch\u1ec9 \u0111\u1ecbnh. Kh\u00f4ng c\u00f3 truy v\u1ea5n s\u1eeda \u0111\u1ed5i.","text":"<p>Ch\u00fang ta mu\u1ed1n tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n c\u00f3 d\u1ea1ng sau: \u0111\u1ed1i v\u1edbi ba s\u1ed1 \u0111\u00e3 cho $(l, r, x)$, ch\u00fang ta ph\u1ea3i t\u00ecm s\u1ed1 nh\u1ecf nh\u1ea5t trong \u0111o\u1ea1n $a[l \\dots r]$ l\u1edbn h\u01a1n ho\u1eb7c b\u1eb1ng $x$.</p> <p>Ch\u00fang ta x\u00e2y d\u1ef1ng m\u1ed9t Segment Tree. Trong m\u1ed7i \u0111\u1ec9nh, ch\u00fang ta l\u01b0u tr\u1eef m\u1ed9t danh s\u00e1ch \u0111\u00e3 s\u1eafp x\u1ebfp c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 xu\u1ea5t hi\u1ec7n trong \u0111o\u1ea1n t\u01b0\u01a1ng \u1ee9ng, nh\u01b0 \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 \u1edf tr\u00ean. L\u00e0m th\u1ebf n\u00e0o \u0111\u1ec3 x\u00e2y d\u1ef1ng m\u1ed9t Segment Tree nh\u01b0 v\u1eady hi\u1ec7u qu\u1ea3 nh\u1ea5t c\u00f3 th\u1ec3? Nh\u01b0 m\u1ecdi khi, ch\u00fang ta ti\u1ebfp c\u1eadn v\u1ea5n \u0111\u1ec1 n\u00e0y m\u1ed9t c\u00e1ch \u0111\u1ec7 quy: gi\u1ea3 s\u1eed danh s\u00e1ch c\u1ee7a c\u00e1c con b\u00ean tr\u00e1i v\u00e0 b\u00ean ph\u1ea3i \u0111\u00e3 \u0111\u01b0\u1ee3c x\u00e2y d\u1ef1ng, v\u00e0 ch\u00fang ta mu\u1ed1n x\u00e2y d\u1ef1ng danh s\u00e1ch cho \u0111\u1ec9nh hi\u1ec7n t\u1ea1i. T\u1eeb g\u00f3c nh\u00ecn n\u00e0y, thao t\u00e1c b\u00e2y gi\u1edd l\u00e0 t\u1ea7m th\u01b0\u1eddng v\u00e0 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong th\u1eddi gian tuy\u1ebfn t\u00ednh: Ch\u00fang ta ch\u1ec9 c\u1ea7n k\u1ebft h\u1ee3p hai danh s\u00e1ch \u0111\u00e3 s\u1eafp x\u1ebfp th\u00e0nh m\u1ed9t, c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n b\u1eb1ng c\u00e1ch l\u1eb7p qua ch\u00fang b\u1eb1ng hai con tr\u1ecf. C++ STL \u0111\u00e3 c\u00f3 m\u1ed9t tri\u1ec3n khai c\u1ee7a thu\u1eadt to\u00e1n n\u00e0y.</p> <p>B\u1edfi v\u00ec c\u1ea5u tr\u00fac n\u00e0y c\u1ee7a Segment Tree v\u00e0 nh\u1eefng \u0111i\u1ec3m t\u01b0\u01a1ng \u0111\u1ed3ng v\u1edbi thu\u1eadt to\u00e1n s\u1eafp x\u1ebfp tr\u1ed9n (merge sort), c\u1ea5u tr\u00fac d\u1eef li\u1ec7u n\u00e0y c\u0169ng th\u01b0\u1eddng \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 \"Merge Sort Tree\".</p> <pre><code>vector&lt;int&gt; t[4*MAXN];\n\nvoid build(int a[], int v, int tl, int tr) {\n    if (tl == tr) {\n        t[v] = vector&lt;int&gt;(1, a[tl]);\n    } else { \n        int tm = (tl + tr) / 2;\n        build(a, v*2, tl, tm);\n        build(a, v*2+1, tm+1, tr);\n        merge(t[v*2].begin(), t[v*2].end(), t[v*2+1].begin(), t[v*2+1].end(),\n              back_inserter(t[v]));\n    }\n}\n</code></pre> <p>Ch\u00fang ta \u0111\u00e3 bi\u1ebft r\u1eb1ng Segment Tree \u0111\u01b0\u1ee3c x\u00e2y d\u1ef1ng theo c\u00e1ch n\u00e0y s\u1ebd y\u00eau c\u1ea7u b\u1ed9 nh\u1edb $O(n \\log n)$. V\u00e0 nh\u1edd tri\u1ec3n khai n\u00e0y, vi\u1ec7c x\u00e2y d\u1ef1ng c\u1ee7a n\u00f3 c\u0169ng m\u1ea5t th\u1eddi gian $O(n \\log n)$, suy cho c\u00f9ng, m\u1ed7i danh s\u00e1ch \u0111\u01b0\u1ee3c x\u00e2y d\u1ef1ng trong th\u1eddi gian tuy\u1ebfn t\u00ednh \u0111\u1ed1i v\u1edbi k\u00edch th\u01b0\u1edbc c\u1ee7a n\u00f3.</p> <p>B\u00e2y gi\u1edd h\u00e3y xem x\u00e9t c\u00e2u tr\u1ea3 l\u1eddi cho truy v\u1ea5n. Ch\u00fang ta s\u1ebd \u0111i xu\u1ed1ng c\u00e2y, gi\u1ed1ng nh\u01b0 trong Segment Tree th\u00f4ng th\u01b0\u1eddng, chia \u0111o\u1ea1n $a[l \\dots r]$ c\u1ee7a ch\u00fang ta th\u00e0nh nhi\u1ec1u \u0111o\u1ea1n con (th\u00e0nh t\u1ed1i \u0111a $O(\\log n)$ ph\u1ea7n). R\u00f5 r\u00e0ng l\u00e0 c\u00e2u tr\u1ea3 l\u1eddi c\u1ee7a to\u00e0n b\u1ed9 c\u00e2u tr\u1ea3 l\u1eddi l\u00e0 gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t c\u1ee7a m\u1ed7i truy v\u1ea5n con. V\u00ec v\u1eady, b\u00e2y gi\u1edd ch\u00fang ta ch\u1ec9 c\u1ea7n hi\u1ec3u, l\u00e0m th\u1ebf n\u00e0o \u0111\u1ec3 ph\u1ea3n h\u1ed3i m\u1ed9t truy v\u1ea5n tr\u00ean m\u1ed9t \u0111o\u1ea1n con nh\u01b0 v\u1eady t\u01b0\u01a1ng \u1ee9ng v\u1edbi m\u1ed9t s\u1ed1 \u0111\u1ec9nh c\u1ee7a c\u00e2y.</p> <p>Ch\u00fang ta \u0111ang \u1edf m\u1ed9t \u0111\u1ec9nh n\u00e0o \u0111\u00f3 c\u1ee7a Segment Tree v\u00e0 ch\u00fang ta mu\u1ed1n t\u00ednh to\u00e1n c\u00e2u tr\u1ea3 l\u1eddi cho truy v\u1ea5n, t\u1ee9c l\u00e0 t\u00ecm s\u1ed1 nh\u1ecf nh\u1ea5t l\u1edbn h\u01a1n ho\u1eb7c b\u1eb1ng m\u1ed9t s\u1ed1 $x$ \u0111\u00e3 cho. V\u00ec \u0111\u1ec9nh ch\u1ee9a danh s\u00e1ch c\u00e1c ph\u1ea7n t\u1eed theo th\u1ee9 t\u1ef1 \u0111\u00e3 s\u1eafp x\u1ebfp, ch\u00fang ta c\u00f3 th\u1ec3 ch\u1ec9 c\u1ea7n th\u1ef1c hi\u1ec7n t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n tr\u00ean danh s\u00e1ch n\u00e0y v\u00e0 tr\u1ea3 v\u1ec1 s\u1ed1 \u0111\u1ea7u ti\u00ean, l\u1edbn h\u01a1n ho\u1eb7c b\u1eb1ng $x$.</p> <p>Do \u0111\u00f3, c\u00e2u tr\u1ea3 l\u1eddi cho truy v\u1ea5n trong m\u1ed9t \u0111o\u1ea1n c\u1ee7a c\u00e2y m\u1ea5t th\u1eddi gian $O(\\log n)$, v\u00e0 to\u00e0n b\u1ed9 truy v\u1ea5n \u0111\u01b0\u1ee3c x\u1eed l\u00fd trong $O(\\log^2 n)$.</p> <pre><code>int query(int v, int tl, int tr, int l, int r, int x) {\n    if (l &gt; r)\n        return INF;\n    if (l == tl &amp;&amp; r == tr) {\n        vector&lt;int&gt;::iterator pos = lower_bound(t[v].begin(), t[v].end(), x);\n        if (pos != t[v].end())\n            return *pos;\n        return INF;\n    }\n    int tm = (tl + tr) / 2;\n    return min(query(v*2, tl, tm, l, min(r, tm), x), \n               query(v*2+1, tm+1, tr, max(l, tm+1), r, x));\n}\n</code></pre> <p>H\u1eb1ng s\u1ed1 $\\text{INF}$ b\u1eb1ng m\u1ed9t s\u1ed1 l\u1edbn n\u00e0o \u0111\u00f3 l\u1edbn h\u01a1n t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 trong m\u1ea3ng. Vi\u1ec7c s\u1eed d\u1ee5ng n\u00f3 c\u00f3 ngh\u0129a l\u00e0, kh\u00f4ng c\u00f3 s\u1ed1 n\u00e0o l\u1edbn h\u01a1n ho\u1eb7c b\u1eb1ng $x$ trong \u0111o\u1ea1n. N\u00f3 c\u00f3 \u00fd ngh\u0129a l\u00e0 \"kh\u00f4ng c\u00f3 c\u00e2u tr\u1ea3 l\u1eddi trong kho\u1ea3ng \u0111\u00e3 cho\".</p>","tags":["Translated"]},{"location":"data_structures/segment_tree.html#tim-so-nho-nhat-lon-hon-hoac-bang-mot-so-a-chi-inh-voi-cac-truy-van-sua-oi","title":"T\u00ecm s\u1ed1 nh\u1ecf nh\u1ea5t l\u1edbn h\u01a1n ho\u1eb7c b\u1eb1ng m\u1ed9t s\u1ed1 \u0111\u00e3 ch\u1ec9 \u0111\u1ecbnh. V\u1edbi c\u00e1c truy v\u1ea5n s\u1eeda \u0111\u1ed5i.","text":"<p>Nhi\u1ec7m v\u1ee5 n\u00e0y t\u01b0\u01a1ng t\u1ef1 nh\u01b0 tr\u01b0\u1edbc. C\u00e1ch ti\u1ebfp c\u1eadn cu\u1ed1i c\u00f9ng c\u00f3 m\u1ed9t nh\u01b0\u1ee3c \u0111i\u1ec3m, \u0111\u00f3 l\u00e0 kh\u00f4ng th\u1ec3 s\u1eeda \u0111\u1ed5i m\u1ea3ng gi\u1eefa c\u00e1c l\u1ea7n tr\u1ea3 l\u1eddi truy v\u1ea5n. B\u00e2y gi\u1edd ch\u00fang ta mu\u1ed1n l\u00e0m ch\u00ednh x\u00e1c \u0111i\u1ec1u n\u00e0y: m\u1ed9t truy v\u1ea5n s\u1eeda \u0111\u1ed5i s\u1ebd th\u1ef1c hi\u1ec7n ph\u00e9p g\u00e1n $a[i] = y$.</p> <p>Gi\u1ea3i ph\u00e1p t\u01b0\u01a1ng t\u1ef1 nh\u01b0 gi\u1ea3i ph\u00e1p c\u1ee7a v\u1ea5n \u0111\u1ec1 tr\u01b0\u1edbc, nh\u01b0ng thay v\u00ec danh s\u00e1ch t\u1ea1i m\u1ed7i \u0111\u1ec9nh c\u1ee7a Segment Tree, ch\u00fang ta s\u1ebd l\u01b0u tr\u1eef m\u1ed9t danh s\u00e1ch c\u00e2n b\u1eb1ng cho ph\u00e9p b\u1ea1n t\u00ecm ki\u1ebfm nhanh c\u00e1c s\u1ed1, x\u00f3a s\u1ed1 v\u00e0 ch\u00e8n s\u1ed1 m\u1edbi. V\u00ec m\u1ea3ng c\u00f3 th\u1ec3 ch\u1ee9a m\u1ed9t s\u1ed1 l\u1eb7p l\u1ea1i, l\u1ef1a ch\u1ecdn t\u1ed1i \u01b0u l\u00e0 c\u1ea5u tr\u00fac d\u1eef li\u1ec7u $\\text{multiset}$.</p> <p>Vi\u1ec7c x\u00e2y d\u1ef1ng m\u1ed9t Segment Tree nh\u01b0 v\u1eady \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n theo c\u00e1ch kh\u00e1 gi\u1ed1ng nh\u01b0 trong v\u1ea5n \u0111\u1ec1 tr\u01b0\u1edbc, ch\u1ec9 c\u00f3 \u0111i\u1ec1u b\u00e2y gi\u1edd ch\u00fang ta c\u1ea7n k\u1ebft h\u1ee3p c\u00e1c $\\text{multiset}$ ch\u1ee9 kh\u00f4ng ph\u1ea3i danh s\u00e1ch \u0111\u00e3 s\u1eafp x\u1ebfp. \u0110i\u1ec1u n\u00e0y d\u1eabn \u0111\u1ebfn th\u1eddi gian x\u00e2y d\u1ef1ng l\u00e0 $O(n \\log^2 n)$ (n\u00f3i chung vi\u1ec7c h\u1ee3p nh\u1ea5t hai c\u00e2y \u0111\u1ecf-\u0111en c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong th\u1eddi gian tuy\u1ebfn t\u00ednh, nh\u01b0ng C++ STL kh\u00f4ng \u0111\u1ea3m b\u1ea3o \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian n\u00e0y).</p> <p>H\u00e0m $\\text{query}$ c\u0169ng g\u1ea7n nh\u01b0 t\u01b0\u01a1ng \u0111\u01b0\u01a1ng, ch\u1ec9 kh\u00e1c l\u00e0 h\u00e0m $\\text{lower_bound}$ c\u1ee7a h\u00e0m $\\text{multiset}$ n\u00ean \u0111\u01b0\u1ee3c g\u1ecdi thay th\u1ebf ($\\text{std::lower_bound}$ ch\u1ec9 ho\u1ea1t \u0111\u1ed9ng trong th\u1eddi gian $O(\\log n)$ n\u1ebfu \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng v\u1edbi c\u00e1c tr\u00ecnh l\u1eb7p truy c\u1eadp ng\u1eabu nhi\u00ean).</p> <p>Cu\u1ed1i c\u00f9ng l\u00e0 y\u00eau c\u1ea7u s\u1eeda \u0111\u1ed5i. \u0110\u1ec3 x\u1eed l\u00fd n\u00f3, ch\u00fang ta ph\u1ea3i \u0111i xu\u1ed1ng c\u00e2y, v\u00e0 s\u1eeda \u0111\u1ed5i t\u1ea5t c\u1ea3 $\\text{multiset}$ t\u1eeb c\u00e1c \u0111o\u1ea1n t\u01b0\u01a1ng \u1ee9ng c\u00f3 ch\u1ee9a ph\u1ea7n t\u1eed b\u1ecb \u1ea3nh h\u01b0\u1edfng. Ch\u00fang ta ch\u1ec9 c\u1ea7n x\u00f3a gi\u00e1 tr\u1ecb c\u0169 c\u1ee7a ph\u1ea7n t\u1eed n\u00e0y (nh\u01b0ng ch\u1ec9 m\u1ed9t l\u1ea7n xu\u1ea5t hi\u1ec7n), v\u00e0 ch\u00e8n gi\u00e1 tr\u1ecb m\u1edbi.</p> <pre><code>void update(int v, int tl, int tr, int pos, int new_val) {\n    t[v].erase(t[v].find(a[pos]));\n    t[v].insert(new_val);\n    if (tl != tr) {\n        int tm = (tl + tr) / 2;\n        if (pos &lt;= tm)\n            update(v*2, tl, tm, pos, new_val);\n        else\n            update(v*2+1, tm+1, tr, pos, new_val);\n    } else {\n        a[pos] = new_val;\n    }\n}\n</code></pre> <p>Vi\u1ec7c x\u1eed l\u00fd truy v\u1ea5n s\u1eeda \u0111\u1ed5i n\u00e0y c\u0169ng m\u1ea5t th\u1eddi gian $O(\\log^2 n)$.</p>","tags":["Translated"]},{"location":"data_structures/segment_tree.html#tim-so-nho-nhat-lon-hon-hoac-bang-mot-so-a-chi-inh-tang-toc-voi-fractional-cascading","title":"T\u00ecm s\u1ed1 nh\u1ecf nh\u1ea5t l\u1edbn h\u01a1n ho\u1eb7c b\u1eb1ng m\u1ed9t s\u1ed1 \u0111\u00e3 ch\u1ec9 \u0111\u1ecbnh. T\u0103ng t\u1ed1c v\u1edbi \"fractional cascading\".","text":"<p>Ch\u00fang ta c\u00f3 c\u00f9ng m\u1ed9t ph\u00e1t bi\u1ec3u b\u00e0i to\u00e1n, ch\u00fang ta mu\u1ed1n t\u00ecm s\u1ed1 nh\u1ecf nh\u1ea5t l\u1edbn h\u01a1n ho\u1eb7c b\u1eb1ng $x$ trong m\u1ed9t \u0111o\u1ea1n, nh\u01b0ng l\u1ea7n n\u00e0y trong th\u1eddi gian $O(\\log n)$. Ch\u00fang ta s\u1ebd c\u1ea3i thi\u1ec7n \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng k\u1ef9 thu\u1eadt \"fractional cascading\".</p> <p>Fractional cascading l\u00e0 m\u1ed9t k\u1ef9 thu\u1eadt \u0111\u01a1n gi\u1ea3n cho ph\u00e9p b\u1ea1n c\u1ea3i thi\u1ec7n th\u1eddi gian ch\u1ea1y c\u1ee7a nhi\u1ec1u t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n, \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n c\u00f9ng m\u1ed9t l\u00fac. C\u00e1ch ti\u1ebfp c\u1eadn tr\u01b0\u1edbc \u0111\u00e2y c\u1ee7a ch\u00fang ta \u0111\u1ed1i v\u1edbi truy v\u1ea5n t\u00ecm ki\u1ebfm l\u00e0, ch\u00fang ta chia nhi\u1ec7m v\u1ee5 th\u00e0nh nhi\u1ec1u nhi\u1ec7m v\u1ee5 con, m\u1ed7i nhi\u1ec7m v\u1ee5 \u0111\u01b0\u1ee3c gi\u1ea3i quy\u1ebft b\u1eb1ng m\u1ed9t t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n. Fractional cascading cho ph\u00e9p b\u1ea1n thay th\u1ebf t\u1ea5t c\u1ea3 c\u00e1c t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n n\u00e0y b\u1eb1ng m\u1ed9t t\u00ecm ki\u1ebfm duy nh\u1ea5t.</p> <p>V\u00ed d\u1ee5 \u0111\u01a1n gi\u1ea3n nh\u1ea5t v\u00e0 r\u00f5 r\u00e0ng nh\u1ea5t v\u1ec1 fractional cascading l\u00e0 b\u00e0i to\u00e1n sau: c\u00f3 $k$ danh s\u00e1ch s\u1ed1 \u0111\u00e3 s\u1eafp x\u1ebfp, v\u00e0 ch\u00fang ta ph\u1ea3i t\u00ecm trong m\u1ed7i danh s\u00e1ch s\u1ed1 \u0111\u1ea7u ti\u00ean l\u1edbn h\u01a1n ho\u1eb7c b\u1eb1ng s\u1ed1 \u0111\u00e3 cho.</p> <p>Thay v\u00ec th\u1ef1c hi\u1ec7n t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n cho m\u1ed7i danh s\u00e1ch, ch\u00fang ta c\u00f3 th\u1ec3 h\u1ee3p nh\u1ea5t t\u1ea5t c\u1ea3 c\u00e1c danh s\u00e1ch th\u00e0nh m\u1ed9t danh s\u00e1ch l\u1edbn \u0111\u00e3 s\u1eafp x\u1ebfp. Ngo\u00e0i ra, \u0111\u1ed1i v\u1edbi m\u1ed7i ph\u1ea7n t\u1eed $y$, ch\u00fang ta l\u01b0u tr\u1eef m\u1ed9t danh s\u00e1ch k\u1ebft qu\u1ea3 t\u00ecm ki\u1ebfm $y$ trong m\u1ed7i danh s\u00e1ch trong s\u1ed1 $k$ danh s\u00e1ch. Do \u0111\u00f3 n\u1ebfu ch\u00fang ta mu\u1ed1n t\u00ecm s\u1ed1 nh\u1ecf nh\u1ea5t l\u1edbn h\u01a1n ho\u1eb7c b\u1eb1ng $x$, ch\u00fang ta ch\u1ec9 c\u1ea7n th\u1ef1c hi\u1ec7n m\u1ed9t t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n duy nh\u1ea5t, v\u00e0 t\u1eeb danh s\u00e1ch c\u00e1c ch\u1ec9 s\u1ed1, ch\u00fang ta c\u00f3 th\u1ec3 x\u00e1c \u0111\u1ecbnh s\u1ed1 nh\u1ecf nh\u1ea5t trong m\u1ed7i danh s\u00e1ch. Tuy nhi\u00ean, c\u00e1ch ti\u1ebfp c\u1eadn n\u00e0y y\u00eau c\u1ea7u $O(n \\cdot k)$ ($n$ l\u00e0 \u0111\u1ed9 d\u00e0i c\u1ee7a c\u00e1c danh s\u00e1ch k\u1ebft h\u1ee3p), c\u00f3 th\u1ec3 kh\u00e1 k\u00e9m hi\u1ec7u qu\u1ea3.</p> <p>Fractional cascading l\u00e0m gi\u1ea3m \u0111\u1ed9 ph\u1ee9c t\u1ea1p b\u1ed9 nh\u1edb n\u00e0y xu\u1ed1ng $O(n)$ b\u1ed9 nh\u1edb, b\u1eb1ng c\u00e1ch t\u1ea1o t\u1eeb $k$ danh s\u00e1ch \u0111\u1ea7u v\u00e0o $k$ danh s\u00e1ch m\u1edbi, trong \u0111\u00f3 m\u1ed7i danh s\u00e1ch ch\u1ee9a danh s\u00e1ch t\u01b0\u01a1ng \u1ee9ng v\u00e0 th\u00eam v\u00e0o \u0111\u00f3 l\u00e0 m\u1ed7i ph\u1ea7n t\u1eed th\u1ee9 hai c\u1ee7a danh s\u00e1ch m\u1edbi ti\u1ebfp theo. S\u1eed d\u1ee5ng c\u1ea5u tr\u00fac n\u00e0y, ch\u1ec9 c\u1ea7n l\u01b0u tr\u1eef hai ch\u1ec9 s\u1ed1, ch\u1ec9 s\u1ed1 c\u1ee7a ph\u1ea7n t\u1eed trong danh s\u00e1ch g\u1ed1c, v\u00e0 ch\u1ec9 s\u1ed1 c\u1ee7a ph\u1ea7n t\u1eed trong danh s\u00e1ch m\u1edbi ti\u1ebfp theo. V\u00ec v\u1eady, c\u00e1ch ti\u1ebfp c\u1eadn n\u00e0y ch\u1ec9 s\u1eed d\u1ee5ng $O(n)$ b\u1ed9 nh\u1edb, v\u00e0 v\u1eabn c\u00f3 th\u1ec3 tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng m\u1ed9t t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n duy nh\u1ea5t.</p> <p>Nh\u01b0ng \u0111\u1ed1i v\u1edbi \u1ee9ng d\u1ee5ng c\u1ee7a ch\u00fang ta, ch\u00fang ta kh\u00f4ng c\u1ea7n to\u00e0n b\u1ed9 s\u1ee9c m\u1ea1nh c\u1ee7a fractional cascading. Trong Segment Tree c\u1ee7a ch\u00fang ta, m\u1ed9t \u0111\u1ec9nh s\u1ebd ch\u1ee9a danh s\u00e1ch \u0111\u00e3 s\u1eafp x\u1ebfp c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed xu\u1ea5t hi\u1ec7n trong c\u00e1c c\u00e2y con b\u00ean tr\u00e1i ho\u1eb7c b\u00ean ph\u1ea3i (gi\u1ed1ng nh\u01b0 trong Merge Sort Tree). Ngo\u00e0i danh s\u00e1ch \u0111\u00e3 s\u1eafp x\u1ebfp n\u00e0y, ch\u00fang ta l\u01b0u tr\u1eef hai v\u1ecb tr\u00ed cho m\u1ed7i ph\u1ea7n t\u1eed. \u0110\u1ed1i v\u1edbi m\u1ed9t ph\u1ea7n t\u1eed $y$, ch\u00fang ta l\u01b0u tr\u1eef ch\u1ec9 s\u1ed1 nh\u1ecf nh\u1ea5t $i$, sao cho ph\u1ea7n t\u1eed th\u1ee9 $i$ trong danh s\u00e1ch \u0111\u00e3 s\u1eafp x\u1ebfp c\u1ee7a con tr\u00e1i l\u1edbn h\u01a1n ho\u1eb7c b\u1eb1ng $y$. V\u00e0 ch\u00fang ta l\u01b0u tr\u1eef ch\u1ec9 s\u1ed1 nh\u1ecf nh\u1ea5t $j$, sao cho ph\u1ea7n t\u1eed th\u1ee9 $j$ trong danh s\u00e1ch \u0111\u00e3 s\u1eafp x\u1ebfp c\u1ee7a con ph\u1ea3i l\u1edbn h\u01a1n ho\u1eb7c b\u1eb1ng $y$. C\u00e1c gi\u00e1 tr\u1ecb n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n song song v\u1edbi b\u01b0\u1edbc h\u1ee3p nh\u1ea5t khi ch\u00fang ta x\u00e2y d\u1ef1ng c\u00e2y.</p> <p>\u0110i\u1ec1u n\u00e0y t\u0103ng t\u1ed1c c\u00e1c truy v\u1ea5n nh\u01b0 th\u1ebf n\u00e0o?</p> <p>H\u00e3y nh\u1edb r\u1eb1ng, trong gi\u1ea3i ph\u00e1p th\u00f4ng th\u01b0\u1eddng, ch\u00fang ta \u0111\u00e3 th\u1ef1c hi\u1ec7n t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n trong m\u1ecdi n\u00fat. Nh\u01b0ng v\u1edbi s\u1eeda \u0111\u1ed5i n\u00e0y, ch\u00fang ta c\u00f3 th\u1ec3 tr\u00e1nh t\u1ea5t c\u1ea3 ngo\u1ea1i tr\u1eeb m\u1ed9t c\u00e1i.</p> <p>\u0110\u1ec3 tr\u1ea3 l\u1eddi m\u1ed9t truy v\u1ea5n, ch\u00fang ta ch\u1ec9 c\u1ea7n th\u1ef1c hi\u1ec7n t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n trong n\u00fat g\u1ed1c. \u0110i\u1ec1u n\u00e0y cho ch\u00fang ta ph\u1ea7n t\u1eed nh\u1ecf nh\u1ea5t $y \\ge x$ trong m\u1ea3ng ho\u00e0n ch\u1ec9nh, nh\u01b0ng n\u00f3 c\u0169ng cho ch\u00fang ta hai v\u1ecb tr\u00ed. Ch\u1ec9 s\u1ed1 c\u1ee7a ph\u1ea7n t\u1eed nh\u1ecf nh\u1ea5t l\u1edbn h\u01a1n ho\u1eb7c b\u1eb1ng $x$ trong c\u00e2y con tr\u00e1i, v\u00e0 ch\u1ec9 s\u1ed1 c\u1ee7a ph\u1ea7n t\u1eed nh\u1ecf nh\u1ea5t $y$ trong c\u00e2y con ph\u1ea3i. L\u01b0u \u00fd r\u1eb1ng $\\ge y$ gi\u1ed1ng nh\u01b0 $\\ge x$, v\u00ec m\u1ea3ng c\u1ee7a ch\u00fang ta kh\u00f4ng ch\u1ee9a b\u1ea5t k\u1ef3 ph\u1ea7n t\u1eed n\u00e0o gi\u1eefa $x$ v\u00e0 $y$. Trong gi\u1ea3i ph\u00e1p Merge Sort Tree th\u00f4ng th\u01b0\u1eddng, ch\u00fang ta s\u1ebd t\u00ednh to\u00e1n c\u00e1c ch\u1ec9 s\u1ed1 n\u00e0y th\u00f4ng qua t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n, nh\u01b0ng v\u1edbi s\u1ef1 tr\u1ee3 gi\u00fap c\u1ee7a c\u00e1c gi\u00e1 tr\u1ecb \u0111\u00e3 t\u00ednh to\u00e1n tr\u01b0\u1edbc, ch\u00fang ta ch\u1ec9 c\u00f3 th\u1ec3 tra c\u1ee9u ch\u00fang trong $O(1)$. V\u00e0 ch\u00fang ta c\u00f3 th\u1ec3 l\u1eb7p l\u1ea1i \u0111i\u1ec1u \u0111\u00f3 cho \u0111\u1ebfn khi ch\u00fang ta truy c\u1eadp t\u1ea5t c\u1ea3 c\u00e1c n\u00fat bao g\u1ed3m kho\u1ea3ng truy v\u1ea5n c\u1ee7a ch\u00fang ta.</p> <p>T\u00f3m l\u1ea1i, nh\u01b0 th\u01b0\u1eddng l\u1ec7, ch\u00fang ta ch\u1ea1m v\u00e0o $O(\\log n)$ n\u00fat trong m\u1ed9t truy v\u1ea5n. Trong n\u00fat g\u1ed1c, ch\u00fang ta th\u1ef1c hi\u1ec7n t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n, v\u00e0 trong t\u1ea5t c\u1ea3 c\u00e1c n\u00fat kh\u00e1c, ch\u00fang ta ch\u1ec9 th\u1ef1c hi\u1ec7n c\u00f4ng vi\u1ec7c h\u1eb1ng s\u1ed1. \u0110i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 \u0111\u1ed9 ph\u1ee9c t\u1ea1p \u0111\u1ec3 tr\u1ea3 l\u1eddi m\u1ed9t truy v\u1ea5n l\u00e0 $O(\\log n)$.</p> <p>Nh\u01b0ng h\u00e3y ch\u00fa \u00fd r\u1eb1ng, \u0111i\u1ec1u n\u00e0y s\u1eed d\u1ee5ng b\u1ed9 nh\u1edb g\u1ea5p ba l\u1ea7n so v\u1edbi Merge Sort Tree th\u00f4ng th\u01b0\u1eddng, v\u1ed1n \u0111\u00e3 s\u1eed d\u1ee5ng r\u1ea5t nhi\u1ec1u b\u1ed9 nh\u1edb ($O(n \\log n)$).</p> <p>R\u1ea5t \u0111\u01a1n gi\u1ea3n \u0111\u1ec3 \u00e1p d\u1ee5ng k\u1ef9 thu\u1eadt n\u00e0y cho m\u1ed9t v\u1ea5n \u0111\u1ec1, kh\u00f4ng y\u00eau c\u1ea7u b\u1ea5t k\u1ef3 truy v\u1ea5n s\u1eeda \u0111\u1ed5i n\u00e0o. Hai v\u1ecb tr\u00ed ch\u1ec9 l\u00e0 c\u00e1c s\u1ed1 nguy\u00ean v\u00e0 c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n b\u1eb1ng c\u00e1ch \u0111\u1ebfm khi h\u1ee3p nh\u1ea5t hai chu\u1ed7i \u0111\u00e3 s\u1eafp x\u1ebfp.</p> <p>V\u1eabn c\u00f3 th\u1ec3 cho ph\u00e9p c\u00e1c truy v\u1ea5n s\u1eeda \u0111\u1ed5i, nh\u01b0ng \u0111i\u1ec1u \u0111\u00f3 l\u00e0m ph\u1ee9c t\u1ea1p to\u00e0n b\u1ed9 m\u00e3. Thay v\u00ec s\u1ed1 nguy\u00ean, b\u1ea1n c\u1ea7n l\u01b0u tr\u1eef m\u1ea3ng \u0111\u00e3 s\u1eafp x\u1ebfp d\u01b0\u1edbi d\u1ea1ng <code>multiset</code>, v\u00e0 thay v\u00ec ch\u1ec9 s\u1ed1, b\u1ea1n c\u1ea7n l\u01b0u tr\u1eef tr\u00ecnh l\u1eb7p (iterators). V\u00e0 b\u1ea1n c\u1ea7n l\u00e0m vi\u1ec7c r\u1ea5t c\u1ea9n th\u1eadn, \u0111\u1ec3 b\u1ea1n t\u0103ng ho\u1eb7c gi\u1ea3m \u0111\u00fang c\u00e1c tr\u00ecnh l\u1eb7p trong m\u1ed9t truy v\u1ea5n s\u1eeda \u0111\u1ed5i.</p>","tags":["Translated"]},{"location":"data_structures/segment_tree.html#other-possible-variations","title":"C\u00e1c bi\u1ebfn th\u1ec3 c\u00f3 th\u1ec3 kh\u00e1c (Other possible variations)","text":"<p>k\u1ef9 thu\u1eadt n\u00e0y ng\u1ee5 \u00fd m\u1ed9t l\u1edbp ho\u00e0n to\u00e0n m\u1edbi c\u00e1c \u1ee9ng d\u1ee5ng c\u00f3 th\u1ec3. Thay v\u00ec l\u01b0u tr\u1eef m\u1ed9t $\\text{vector}$ ho\u1eb7c m\u1ed9t $\\text{multiset}$ trong m\u1ed7i \u0111\u1ec9nh, c\u00e1c c\u1ea5u tr\u00fac d\u1eef li\u1ec7u kh\u00e1c c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng: c\u00e1c Segment Trees kh\u00e1c (ph\u1ea7n n\u00e0o \u0111\u01b0\u1ee3c th\u1ea3o lu\u1eadn trong Kh\u00e1i qu\u00e1t h\u00f3a sang c\u00e1c chi\u1ec1u cao h\u01a1n), Fenwick Trees, Cartesian trees, v.v.</p>","tags":["Translated"]},{"location":"data_structures/segment_tree.html#range-updates-lazy-propagation","title":"C\u1eadp nh\u1eadt \u0111o\u1ea1n (Lazy Propagation)","text":"<p>T\u1ea5t c\u1ea3 c\u00e1c b\u00e0i to\u00e1n trong c\u00e1c ph\u1ea7n tr\u00ean \u0111\u00e3 th\u1ea3o lu\u1eadn v\u1ec1 c\u00e1c truy v\u1ea5n s\u1eeda \u0111\u1ed5i ch\u1ec9 \u1ea3nh h\u01b0\u1edfng \u0111\u1ebfn m\u1ed9t ph\u1ea7n t\u1eed duy nh\u1ea5t c\u1ee7a m\u1ea3ng m\u1ed7i l\u1ea7n. Tuy nhi\u00ean, Segment Tree cho ph\u00e9p \u00e1p d\u1ee5ng c\u00e1c truy v\u1ea5n s\u1eeda \u0111\u1ed5i cho to\u00e0n b\u1ed9 m\u1ed9t \u0111o\u1ea1n c\u00e1c ph\u1ea7n t\u1eed li\u1ec1n k\u1ec1, v\u00e0 th\u1ef1c hi\u1ec7n truy v\u1ea5n trong c\u00f9ng th\u1eddi gian $O(\\log n)$.</p>","tags":["Translated"]},{"location":"data_structures/segment_tree.html#addition-on-segments","title":"C\u1ed9ng tr\u00ean c\u00e1c \u0111o\u1ea1n (Addition on segments)","text":"<p>Ch\u00fang ta b\u1eaft \u0111\u1ea7u b\u1eb1ng c\u00e1ch xem x\u00e9t c\u00e1c b\u00e0i to\u00e1n c\u00f3 d\u1ea1ng \u0111\u01a1n gi\u1ea3n nh\u1ea5t: truy v\u1ea5n s\u1eeda \u0111\u1ed5i n\u00ean c\u1ed9ng m\u1ed9t s\u1ed1 $x$ v\u00e0o t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 trong \u0111o\u1ea1n $a[l \\dots r]$. Truy v\u1ea5n th\u1ee9 hai, m\u00e0 ch\u00fang ta ph\u1ea3i tr\u1ea3 l\u1eddi, ch\u1ec9 \u0111\u01a1n gi\u1ea3n l\u00e0 y\u00eau c\u1ea7u gi\u00e1 tr\u1ecb c\u1ee7a $a[i]$.</p> <p>\u0110\u1ec3 l\u00e0m cho truy v\u1ea5n c\u1ed9ng hi\u1ec7u qu\u1ea3, ch\u00fang ta l\u01b0u tr\u1eef t\u1ea1i m\u1ed7i \u0111\u1ec9nh trong Segment Tree s\u1ed1 l\u01b0\u1ee3ng ch\u00fang ta n\u00ean c\u1ed9ng v\u00e0o t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 trong \u0111o\u1ea1n t\u01b0\u01a1ng \u1ee9ng. V\u00ed d\u1ee5, n\u1ebfu truy v\u1ea5n \"c\u1ed9ng 3 v\u00e0o to\u00e0n b\u1ed9 m\u1ea3ng $a[0 \\dots n-1]$\" \u0111\u1ebfn, th\u00ec ch\u00fang ta \u0111\u1eb7t s\u1ed1 3 v\u00e0o g\u1ed1c c\u1ee7a c\u00e2y. N\u00f3i chung, ch\u00fang ta ph\u1ea3i \u0111\u1eb7t s\u1ed1 n\u00e0y v\u00e0o nhi\u1ec1u \u0111o\u1ea1n, t\u1ea1o th\u00e0nh m\u1ed9t ph\u00e2n v\u00f9ng c\u1ee7a \u0111o\u1ea1n truy v\u1ea5n. Do \u0111\u00f3, ch\u00fang ta kh\u00f4ng ph\u1ea3i thay \u0111\u1ed5i t\u1ea5t c\u1ea3 $O(n)$ gi\u00e1 tr\u1ecb, m\u00e0 ch\u1ec9 $O(\\log n)$.</p> <p>Th\u1ebf n\u00ean b\u00e2y gi\u1edd n\u1ebfu c\u00f3 m\u1ed9t truy v\u1ea5n h\u1ecfi gi\u00e1 tr\u1ecb hi\u1ec7n t\u1ea1i c\u1ee7a m\u1ed9t m\u1ee5c m\u1ea3ng c\u1ee5 th\u1ec3, ch\u1ec9 c\u1ea7n \u0111i xu\u1ed1ng c\u00e2y v\u00e0 c\u1ed9ng t\u1ea5t c\u1ea3 c\u00e1c gi\u00e1 tr\u1ecb t\u00ecm th\u1ea5y tr\u00ean \u0111\u01b0\u1eddng \u0111i.</p> <pre><code>void build(int a[], int v, int tl, int tr) {\n    if (tl == tr) {\n        t[v] = a[tl];\n    } else {\n        int tm = (tl + tr) / 2;\n        build(a, v*2, tl, tm);\n        build(a, v*2+1, tm+1, tr);\n        t[v] = 0;\n    }\n}\n\nvoid update(int v, int tl, int tr, int l, int r, int add) {\n    if (l &gt; r)\n        return;\n    if (l == tl &amp;&amp; r == tr) {\n        t[v] += add;\n    } else {\n        int tm = (tl + tr) / 2;\n        update(v*2, tl, tm, l, min(r, tm), add);\n        update(v*2+1, tm+1, tr, max(l, tm+1), r, add);\n    }\n}\n\nint get(int v, int tl, int tr, int pos) {\n    if (tl == tr)\n        return t[v];\n    int tm = (tl + tr) / 2;\n    if (pos &lt;= tm)\n        return t[v] + get(v*2, tl, tm, pos);\n    else\n        return t[v] + get(v*2+1, tm+1, tr, pos);\n}\n</code></pre>","tags":["Translated"]},{"location":"data_structures/segment_tree.html#assignment-on-segments","title":"G\u00e1n tr\u00ean c\u00e1c \u0111o\u1ea1n (Assignment on segments)","text":"<p>B\u00e2y gi\u1edd gi\u1ea3 s\u1eed r\u1eb1ng truy v\u1ea5n s\u1eeda \u0111\u1ed5i y\u00eau c\u1ea7u g\u00e1n m\u1ed7i ph\u1ea7n t\u1eed c\u1ee7a m\u1ed9t \u0111o\u1ea1n nh\u1ea5t \u0111\u1ecbnh $a[l \\dots r]$ cho m\u1ed9t gi\u00e1 tr\u1ecb $p$ n\u00e0o \u0111\u00f3. L\u00e0 m\u1ed9t truy v\u1ea5n th\u1ee9 hai, ch\u00fang ta s\u1ebd xem x\u00e9t l\u1ea1i vi\u1ec7c \u0111\u1ecdc gi\u00e1 tr\u1ecb c\u1ee7a m\u1ea3ng $a[i]$.</p> <p>\u0110\u1ec3 th\u1ef1c hi\u1ec7n truy v\u1ea5n s\u1eeda \u0111\u1ed5i n\u00e0y tr\u00ean to\u00e0n b\u1ed9 \u0111o\u1ea1n, b\u1ea1n ph\u1ea3i l\u01b0u tr\u1eef t\u1ea1i m\u1ed7i \u0111\u1ec9nh c\u1ee7a Segment Tree xem \u0111o\u1ea1n t\u01b0\u01a1ng \u1ee9ng c\u00f3 \u0111\u01b0\u1ee3c bao ph\u1ee7 ho\u00e0n to\u00e0n b\u1edfi c\u00f9ng m\u1ed9t gi\u00e1 tr\u1ecb hay kh\u00f4ng. \u0110i\u1ec1u n\u00e0y cho ph\u00e9p ch\u00fang ta th\u1ef1c hi\u1ec7n c\u1eadp nh\u1eadt \"l\u01b0\u1eddi bi\u1ebfng\" (lazy): thay v\u00ec thay \u0111\u1ed5i t\u1ea5t c\u1ea3 c\u00e1c \u0111o\u1ea1n trong c\u00e2y bao ph\u1ee7 \u0111o\u1ea1n truy v\u1ea5n, ch\u00fang ta ch\u1ec9 thay \u0111\u1ed5i m\u1ed9t s\u1ed1, v\u00e0 \u0111\u1ec3 nh\u1eefng c\u00e1i kh\u00e1c kh\u00f4ng thay \u0111\u1ed5i. M\u1ed9t \u0111\u1ec9nh \u0111\u01b0\u1ee3c \u0111\u00e1nh d\u1ea5u s\u1ebd c\u00f3 ngh\u0129a l\u00e0, m\u1ecdi ph\u1ea7n t\u1eed c\u1ee7a \u0111o\u1ea1n t\u01b0\u01a1ng \u1ee9ng \u0111\u01b0\u1ee3c g\u00e1n cho gi\u00e1 tr\u1ecb \u0111\u00f3, v\u00e0 th\u1ef1c t\u1ebf l\u00e0 to\u00e0n b\u1ed9 c\u00e2y con c\u0169ng ch\u1ec9 n\u00ean ch\u1ee9a gi\u00e1 tr\u1ecb n\u00e0y. Theo m\u1ed9t ngh\u0129a n\u00e0o \u0111\u00f3, ch\u00fang ta l\u01b0\u1eddi bi\u1ebfng v\u00e0 tr\u00ec ho\u00e3n vi\u1ec7c vi\u1ebft gi\u00e1 tr\u1ecb m\u1edbi cho t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh \u0111\u00f3. Ch\u00fang ta c\u00f3 th\u1ec3 l\u00e0m c\u00f4ng vi\u1ec7c t\u1ebb nh\u1ea1t n\u00e0y sau, n\u1ebfu \u0111i\u1ec1u n\u00e0y l\u00e0 c\u1ea7n thi\u1ebft.</p> <p>V\u00ec v\u1eady, sau khi truy v\u1ea5n s\u1eeda \u0111\u1ed5i \u0111\u01b0\u1ee3c th\u1ef1c thi, m\u1ed9t s\u1ed1 ph\u1ea7n c\u1ee7a c\u00e2y tr\u1edf n\u00ean kh\u00f4ng li\u00ean quan - m\u1ed9t s\u1ed1 s\u1eeda \u0111\u1ed5i v\u1eabn ch\u01b0a \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong \u0111\u00f3.</p> <p>V\u00ed d\u1ee5 n\u1ebfu m\u1ed9t truy v\u1ea5n s\u1eeda \u0111\u1ed5i \"g\u00e1n m\u1ed9t s\u1ed1 cho to\u00e0n b\u1ed9 m\u1ea3ng $a[0 \\dots n-1]$\" \u0111\u01b0\u1ee3c th\u1ef1c thi, trong Segment Tree ch\u1ec9 c\u00f3 m\u1ed9t thay \u0111\u1ed5i duy nh\u1ea5t \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n - s\u1ed1 \u0111\u01b0\u1ee3c \u0111\u1eb7t v\u00e0o g\u1ed1c c\u1ee7a c\u00e2y v\u00e0 \u0111\u1ec9nh n\u00e0y \u0111\u01b0\u1ee3c \u0111\u00e1nh d\u1ea5u. C\u00e1c \u0111o\u1ea1n c\u00f2n l\u1ea1i kh\u00f4ng thay \u0111\u1ed5i, m\u1eb7c d\u00f9 tr\u00ean th\u1ef1c t\u1ebf s\u1ed1 n\u00e0y n\u00ean \u0111\u01b0\u1ee3c \u0111\u1eb7t trong to\u00e0n b\u1ed9 c\u00e2y.</p> <p>B\u00e2y gi\u1edd gi\u1ea3 s\u1eed r\u1eb1ng truy v\u1ea5n s\u1eeda \u0111\u1ed5i th\u1ee9 hai n\u00f3i r\u1eb1ng, n\u1eeda \u0111\u1ea7u c\u1ee7a m\u1ea3ng $a[0 \\dots n/2]$ n\u00ean \u0111\u01b0\u1ee3c g\u00e1n b\u1eb1ng m\u1ed9t s\u1ed1 kh\u00e1c. \u0110\u1ec3 x\u1eed l\u00fd truy v\u1ea5n n\u00e0y, ch\u00fang ta ph\u1ea3i g\u00e1n m\u1ed7i ph\u1ea7n t\u1eed trong to\u00e0n b\u1ed9 con tr\u00e1i c\u1ee7a \u0111\u1ec9nh g\u1ed1c b\u1eb1ng s\u1ed1 \u0111\u00f3. Nh\u01b0ng tr\u01b0\u1edbc khi ch\u00fang ta l\u00e0m \u0111i\u1ec1u n\u00e0y, tr\u01b0\u1edbc ti\u00ean ch\u00fang ta ph\u1ea3i gi\u1ea3i quy\u1ebft \u0111\u1ec9nh g\u1ed1c. S\u1ef1 tinh t\u1ebf \u1edf \u0111\u00e2y l\u00e0 n\u1eeda b\u00ean ph\u1ea3i c\u1ee7a m\u1ea3ng v\u1eabn n\u00ean \u0111\u01b0\u1ee3c g\u00e1n cho gi\u00e1 tr\u1ecb c\u1ee7a truy v\u1ea5n \u0111\u1ea7u ti\u00ean, v\u00e0 t\u1ea1i th\u1eddi \u0111i\u1ec3m hi\u1ec7n t\u1ea1i kh\u00f4ng c\u00f3 th\u00f4ng tin n\u00e0o cho n\u1eeda b\u00ean ph\u1ea3i \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef.</p> <p>C\u00e1ch \u0111\u1ec3 gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 n\u00e0y l\u00e0 \u0111\u1ea9y (push) th\u00f4ng tin c\u1ee7a g\u1ed1c xu\u1ed1ng c\u00e1c con c\u1ee7a n\u00f3, t\u1ee9c l\u00e0 n\u1ebfu g\u1ed1c c\u1ee7a c\u00e2y \u0111\u01b0\u1ee3c g\u00e1n b\u1eb1ng b\u1ea5t k\u1ef3 s\u1ed1 n\u00e0o, th\u00ec ch\u00fang ta g\u00e1n c\u00e1c \u0111\u1ec9nh con tr\u00e1i v\u00e0 ph\u1ea3i b\u1eb1ng s\u1ed1 n\u00e0y v\u00e0 lo\u1ea1i b\u1ecf \u0111\u00e1nh d\u1ea5u c\u1ee7a g\u1ed1c. Sau \u0111\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 g\u00e1n con tr\u00e1i v\u1edbi gi\u00e1 tr\u1ecb m\u1edbi m\u00e0 kh\u00f4ng l\u00e0m m\u1ea5t b\u1ea5t k\u1ef3 th\u00f4ng tin c\u1ea7n thi\u1ebft n\u00e0o.</p> <p>T\u00f3m l\u1ea1i ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c: \u0111\u1ed1i v\u1edbi b\u1ea5t k\u1ef3 truy v\u1ea5n n\u00e0o (m\u1ed9t s\u1eeda \u0111\u1ed5i ho\u1eb7c truy v\u1ea5n \u0111\u1ecdc) trong qu\u00e1 tr\u00ecnh \u0111i xu\u1ed1ng d\u1ecdc theo c\u00e2y, ch\u00fang ta ph\u1ea3i lu\u00f4n \u0111\u1ea9y th\u00f4ng tin t\u1eeb \u0111\u1ec9nh hi\u1ec7n t\u1ea1i v\u00e0o c\u1ea3 hai con c\u1ee7a n\u00f3. Ch\u00fang ta c\u00f3 th\u1ec3 hi\u1ec3u \u0111i\u1ec1u n\u00e0y theo c\u00e1ch nh\u01b0 v\u1eady, r\u1eb1ng khi ch\u00fang ta \u0111i xu\u1ed1ng c\u00e2y, ch\u00fang ta \u00e1p d\u1ee5ng c\u00e1c s\u1eeda \u0111\u1ed5i b\u1ecb tr\u00ec ho\u00e3n, nh\u01b0ng ch\u00ednh x\u00e1c nhi\u1ec1u nh\u1ea5t m\u1ee9c c\u1ea7n thi\u1ebft (\u0111\u1ec3 kh\u00f4ng l\u00e0m gi\u1ea3m \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a $O(\\log n)$).</p> <p>\u0110\u1ed1i v\u1edbi vi\u1ec7c c\u00e0i \u0111\u1eb7t, ch\u00fang ta c\u1ea7n t\u1ea1o m\u1ed9t h\u00e0m $\\text{push}$, s\u1ebd nh\u1eadn \u0111\u1ec9nh hi\u1ec7n t\u1ea1i, v\u00e0 n\u00f3 s\u1ebd \u0111\u1ea9y th\u00f4ng tin cho \u0111\u1ec9nh c\u1ee7a n\u00f3 \u0111\u1ebfn c\u1ea3 hai con c\u1ee7a n\u00f3. Ch\u00fang ta s\u1ebd g\u1ecdi h\u00e0m n\u00e0y \u1edf \u0111\u1ea7u c\u00e1c h\u00e0m truy v\u1ea5n (nh\u01b0ng ch\u00fang ta s\u1ebd kh\u00f4ng g\u1ecdi n\u00f3 t\u1eeb c\u00e1c l\u00e1, v\u00ec kh\u00f4ng c\u1ea7n \u0111\u1ea9y th\u00f4ng tin t\u1eeb ch\u00fang \u0111i xa h\u01a1n).</p> <pre><code>void push(int v) {\n    if (marked[v]) {\n        t[v*2] = t[v*2+1] = t[v];\n        marked[v*2] = marked[v*2+1] = true;\n        marked[v] = false;\n    }\n}\n\nvoid update(int v, int tl, int tr, int l, int r, int new_val) {\n    if (l &gt; r) \n        return;\n    if (l == tl &amp;&amp; tr == r) {\n        t[v] = new_val;\n        marked[v] = true;\n    } else {\n        push(v);\n        int tm = (tl + tr) / 2;\n        update(v*2, tl, tm, l, min(r, tm), new_val);\n        update(v*2+1, tm+1, tr, max(l, tm+1), r, new_val);\n    }\n}\n\nint get(int v, int tl, int tr, int pos) {\n    if (tl == tr) {\n        return t[v];\n    }\n    push(v);\n    int tm = (tl + tr) / 2;\n    if (pos &lt;= tm) \n        return get(v*2, tl, tm, pos);\n    else\n        return get(v*2+1, tm+1, tr, pos);\n}\n</code></pre> <p>L\u01b0u \u00fd: h\u00e0m $\\text{get}$ c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c c\u00e0i \u0111\u1eb7t theo m\u1ed9t c\u00e1ch kh\u00e1c: kh\u00f4ng th\u1ef1c hi\u1ec7n c\u00e1c c\u1eadp nh\u1eadt b\u1ecb tr\u00ec ho\u00e3n, m\u00e0 tr\u1ea3 v\u1ec1 ngay gi\u00e1 tr\u1ecb $t[v]$ n\u1ebfu $marked[v]$ l\u00e0 \u0111\u00fang.</p>","tags":["Translated"]},{"location":"data_structures/segment_tree.html#adding-on-segments-querying-for-maximum","title":"C\u1ed9ng tr\u00ean c\u00e1c \u0111o\u1ea1n, truy v\u1ea5n gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t (Adding on segments, querying for maximum)","text":"<p>B\u00e2y gi\u1edd truy v\u1ea5n s\u1eeda \u0111\u1ed5i l\u00e0 c\u1ed9ng m\u1ed9t s\u1ed1 v\u00e0o t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed trong m\u1ed9t \u0111o\u1ea1n, v\u00e0 truy v\u1ea5n \u0111\u1ecdc l\u00e0 t\u00ecm gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t trong m\u1ed9t \u0111o\u1ea1n.</p> <p>V\u00ec v\u1eady, \u0111\u1ed1i v\u1edbi m\u1ed7i \u0111\u1ec9nh c\u1ee7a Segment Tree, ch\u00fang ta ph\u1ea3i l\u01b0u tr\u1eef gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t c\u1ee7a \u0111o\u1ea1n con t\u01b0\u01a1ng \u1ee9ng. Ph\u1ea7n th\u00fa v\u1ecb l\u00e0 l\u00e0m th\u1ebf n\u00e0o \u0111\u1ec3 t\u00ednh to\u00e1n l\u1ea1i c\u00e1c gi\u00e1 tr\u1ecb n\u00e0y trong m\u1ed9t y\u00eau c\u1ea7u s\u1eeda \u0111\u1ed5i.</p> <p>V\u00ec m\u1ee5c \u0111\u00edch n\u00e0y, ch\u00fang ta l\u01b0u tr\u1eef th\u00eam m\u1ed9t gi\u00e1 tr\u1ecb b\u1ed5 sung cho m\u1ed7i \u0111\u1ec9nh. Trong gi\u00e1 tr\u1ecb n\u00e0y, ch\u00fang ta l\u01b0u tr\u1eef c\u00e1c s\u1ed1 h\u1ea1ng m\u00e0 ch\u00fang ta ch\u01b0a lan truy\u1ec1n \u0111\u1ebfn c\u00e1c \u0111\u1ec9nh con. Tr\u01b0\u1edbc khi di chuy\u1ec3n \u0111\u1ebfn m\u1ed9t \u0111\u1ec9nh con, ch\u00fang ta g\u1ecdi $\\text{push}$ v\u00e0 lan truy\u1ec1n gi\u00e1 tr\u1ecb cho c\u1ea3 hai con. Ch\u00fang ta ph\u1ea3i l\u00e0m \u0111i\u1ec1u n\u00e0y trong c\u1ea3 h\u00e0m $\\text{update}$ v\u00e0 h\u00e0m $\\text{query}$.</p> <pre><code>void build(int a[], int v, int tl, int tr) {\n    if (tl == tr) {\n        t[v] = a[tl];\n    } else {\n        int tm = (tl + tr) / 2;\n        build(a, v*2, tl, tm);\n        build(a, v*2+1, tm+1, tr);\n        t[v] = max(t[v*2], t[v*2 + 1]);\n    }\n}\n\nvoid push(int v) {\n    t[v*2] += lazy[v];\n    lazy[v*2] += lazy[v];\n    t[v*2+1] += lazy[v];\n    lazy[v*2+1] += lazy[v];\n    lazy[v] = 0;\n}\n\nvoid update(int v, int tl, int tr, int l, int r, int addend) {\n    if (l &gt; r) \n        return;\n    if (l == tl &amp;&amp; tr == r) {\n        t[v] += addend;\n        lazy[v] += addend;\n    } else {\n        push(v);\n        int tm = (tl + tr) / 2;\n        update(v*2, tl, tm, l, min(r, tm), addend);\n        update(v*2+1, tm+1, tr, max(l, tm+1), r, addend);\n        t[v] = max(t[v*2], t[v*2+1]);\n    }\n}\n\nint query(int v, int tl, int tr, int l, int r) {\n    if (l &gt; r)\n        return -INF;\n    if (l == tl &amp;&amp; tr == r)\n        return t[v];\n    push(v);\n    int tm = (tl + tr) / 2;\n    return max(query(v*2, tl, tm, l, min(r, tm)), \n               query(v*2+1, tm+1, tr, max(l, tm+1), r));\n}\n</code></pre>","tags":["Translated"]},{"location":"data_structures/segment_tree.html#khai-quat-hoa-sang-cac-chieu-cao-hon-generalization-to-higher-dimensions","title":"Kh\u00e1i qu\u00e1t h\u00f3a sang c\u00e1c chi\u1ec1u cao h\u01a1n (Generalization to higher dimensions)","text":"<p>M\u1ed9t Segment Tree c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c kh\u00e1i qu\u00e1t h\u00f3a kh\u00e1 t\u1ef1 nhi\u00ean sang c\u00e1c chi\u1ec1u cao h\u01a1n. N\u1ebfu trong tr\u01b0\u1eddng h\u1ee3p m\u1ed9t chi\u1ec1u, ch\u00fang ta chia c\u00e1c ch\u1ec9 s\u1ed1 c\u1ee7a m\u1ea3ng th\u00e0nh c\u00e1c \u0111o\u1ea1n, th\u00ec trong tr\u01b0\u1eddng h\u1ee3p hai chi\u1ec1u, ch\u00fang ta th\u1ef1c hi\u1ec7n m\u1ed9t Segment Tree b\u00ecnh th\u01b0\u1eddng \u0111\u1ed1i v\u1edbi c\u00e1c ch\u1ec9 s\u1ed1 \u0111\u1ea7u ti\u00ean, v\u00e0 \u0111\u1ed1i v\u1edbi m\u1ed7i \u0111o\u1ea1n, ch\u00fang ta x\u00e2y d\u1ef1ng m\u1ed9t Segment Tree b\u00ecnh th\u01b0\u1eddng \u0111\u1ed1i v\u1edbi c\u00e1c ch\u1ec9 s\u1ed1 th\u1ee9 hai.</p>","tags":["Translated"]},{"location":"data_structures/segment_tree.html#simple-2d-segment-tree","title":"Segment Tree 2D \u0111\u01a1n gi\u1ea3n (Simple 2D Segment Tree)","text":"<p>M\u1ed9t ma tr\u1eadn $a[0 \\dots n-1, 0 \\dots m-1]$ \u0111\u01b0\u1ee3c cho, v\u00e0 ch\u00fang ta ph\u1ea3i t\u00ecm t\u1ed5ng (ho\u1eb7c t\u1ed1i thi\u1ec3u/t\u1ed1i \u0111a) tr\u00ean m\u1ed9t ma tr\u1eadn con $a[x_1 \\dots x_2, y_1 \\dots y_2]$, c\u0169ng nh\u01b0 th\u1ef1c hi\u1ec7n s\u1eeda \u0111\u1ed5i c\u00e1c ph\u1ea7n t\u1eed ma tr\u1eadn ri\u00eang l\u1ebb (t\u1ee9c l\u00e0 c\u00e1c truy v\u1ea5n c\u00f3 d\u1ea1ng $a[x][y] = p$).</p> <p>V\u00ec v\u1eady, ch\u00fang ta x\u00e2y d\u1ef1ng m\u1ed9t Segment Tree 2D: \u0111\u1ea7u ti\u00ean l\u00e0 Segment Tree s\u1eed d\u1ee5ng t\u1ecda \u0111\u1ed9 \u0111\u1ea7u ti\u00ean ($x$), sau \u0111\u00f3 l\u00e0 th\u1ee9 hai ($y$).</p> <p>\u0110\u1ec3 l\u00e0m cho qu\u00e1 tr\u00ecnh x\u00e2y d\u1ef1ng d\u1ec5 hi\u1ec3u h\u01a1n, b\u1ea1n c\u00f3 th\u1ec3 qu\u00ean \u0111i m\u1ed9t l\u00fac r\u1eb1ng ma tr\u1eadn l\u00e0 hai chi\u1ec1u, v\u00e0 ch\u1ec9 \u0111\u1ec3 l\u1ea1i t\u1ecda \u0111\u1ed9 \u0111\u1ea7u ti\u00ean. Ch\u00fang ta s\u1ebd x\u00e2y d\u1ef1ng m\u1ed9t Segment Tree m\u1ed9t chi\u1ec1u th\u00f4ng th\u01b0\u1eddng ch\u1ec9 s\u1eed d\u1ee5ng t\u1ecda \u0111\u1ed9 \u0111\u1ea7u ti\u00ean. Nh\u01b0ng thay v\u00ec l\u01b0u tr\u1eef m\u1ed9t s\u1ed1 trong m\u1ed9t \u0111o\u1ea1n, ch\u00fang ta l\u01b0u tr\u1eef m\u1ed9t Segment Tree ho\u00e0n ch\u1ec9nh: t\u1ee9c l\u00e0 t\u1ea1i th\u1eddi \u0111i\u1ec3m n\u00e0y, ch\u00fang ta nh\u1edb r\u1eb1ng ch\u00fang ta c\u0169ng c\u00f3 m\u1ed9t t\u1ecda \u0111\u1ed9 th\u1ee9 hai; nh\u01b0ng v\u00ec t\u1ea1i th\u1eddi \u0111i\u1ec3m n\u00e0y, t\u1ecda \u0111\u1ed9 \u0111\u1ea7u ti\u00ean \u0111\u00e3 \u0111\u01b0\u1ee3c c\u1ed1 \u0111\u1ecbnh v\u00e0o m\u1ed9t kho\u1ea3ng n\u00e0o \u0111\u00f3 $[l \\dots r]$, ch\u00fang ta th\u1ef1c s\u1ef1 l\u00e0m vi\u1ec7c v\u1edbi m\u1ed9t d\u1ea3i nh\u01b0 v\u1eady $a[l \\dots r, 0 \\dots m-1]$ v\u00e0 \u0111\u1ed1i v\u1edbi n\u00f3, ch\u00fang ta x\u00e2y d\u1ef1ng m\u1ed9t Segment Tree.</p> <p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 c\u00e0i \u0111\u1eb7t c\u1ee7a vi\u1ec7c x\u00e2y d\u1ef1ng m\u1ed9t Segment Tree 2D. N\u00f3 th\u1ef1c s\u1ef1 \u0111\u1ea1i di\u1ec7n cho hai kh\u1ed1i ri\u00eang bi\u1ec7t: vi\u1ec7c x\u00e2y d\u1ef1ng m\u1ed9t Segment Tree d\u1ecdc theo t\u1ecda \u0111\u1ed9 $x$ ($\\text{build}_x$), v\u00e0 t\u1ecda \u0111\u1ed9 $y$ ($\\text{build}_y$). \u0110\u1ed1i v\u1edbi c\u00e1c n\u00fat l\u00e1 trong $\\text{build}_y$, ch\u00fang ta ph\u1ea3i ph\u00e2n t\u00e1ch hai tr\u01b0\u1eddng h\u1ee3p: khi \u0111o\u1ea1n hi\u1ec7n t\u1ea1i c\u1ee7a t\u1ecda \u0111\u1ed9 \u0111\u1ea7u ti\u00ean $[tlx \\dots trx]$ c\u00f3 \u0111\u1ed9 d\u00e0i 1, v\u00e0 khi n\u00f3 c\u00f3 \u0111\u1ed9 d\u00e0i l\u1edbn h\u01a1n m\u1ed9t. Trong tr\u01b0\u1eddng h\u1ee3p \u0111\u1ea7u ti\u00ean, ch\u00fang ta ch\u1ec9 l\u1ea5y gi\u00e1 tr\u1ecb t\u01b0\u01a1ng \u1ee9ng t\u1eeb ma tr\u1eadn, v\u00e0 trong tr\u01b0\u1eddng h\u1ee3p th\u1ee9 hai, ch\u00fang ta c\u00f3 th\u1ec3 k\u1ebft h\u1ee3p c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a hai Segment Tree t\u1eeb con b\u00ean tr\u00e1i v\u00e0 b\u00ean ph\u1ea3i trong t\u1ecda \u0111\u1ed9 $x$.</p> <pre><code>void build_y(int vx, int lx, int rx, int vy, int ly, int ry) {\n    if (ly == ry) {\n        if (lx == rx)\n            t[vx][vy] = a[lx][ly];\n        else\n            t[vx][vy] = t[vx*2][vy] + t[vx*2+1][vy];\n    } else {\n        int my = (ly + ry) / 2;\n        build_y(vx, lx, rx, vy*2, ly, my);\n        build_y(vx, lx, rx, vy*2+1, my+1, ry);\n        t[vx][vy] = t[vx][vy*2] + t[vx][vy*2+1];\n    }\n}\n\nvoid build_x(int vx, int lx, int rx) {\n    if (lx != rx) {\n        int mx = (lx + rx) / 2;\n        build_x(vx*2, lx, mx);\n        build_x(vx*2+1, mx+1, rx);\n    }\n    build_y(vx, lx, rx, 1, 0, m-1);\n}\n</code></pre> <p>M\u1ed9t Segment Tree nh\u01b0 v\u1eady v\u1eabn s\u1eed d\u1ee5ng m\u1ed9t l\u01b0\u1ee3ng b\u1ed9 nh\u1edb tuy\u1ebfn t\u00ednh, nh\u01b0ng v\u1edbi h\u1eb1ng s\u1ed1 l\u1edbn h\u01a1n: $16 n m$. R\u00f5 r\u00e0ng l\u00e0 th\u1ee7 t\u1ee5c \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 $\\text{build}_x$ c\u0169ng ho\u1ea1t \u0111\u1ed9ng trong th\u1eddi gian tuy\u1ebfn t\u00ednh.</p> <p>B\u00e2y gi\u1edd ch\u00fang ta chuy\u1ec3n sang x\u1eed l\u00fd c\u00e1c truy v\u1ea5n. Ch\u00fang ta s\u1ebd tr\u1ea3 l\u1eddi truy v\u1ea5n hai chi\u1ec1u b\u1eb1ng c\u00f9ng m\u1ed9t nguy\u00ean t\u1eafc: \u0111\u1ea7u ti\u00ean ph\u00e1 v\u1ee1 truy v\u1ea5n tr\u00ean t\u1ecda \u0111\u1ed9 \u0111\u1ea7u ti\u00ean, v\u00e0 sau \u0111\u00f3 \u0111\u1ed1i v\u1edbi m\u1ed7i \u0111\u1ec9nh \u0111\u1ea1t \u0111\u01b0\u1ee3c, ch\u00fang ta g\u1ecdi Segment Tree t\u01b0\u01a1ng \u1ee9ng c\u1ee7a t\u1ecda \u0111\u1ed9 th\u1ee9 hai.</p> <pre><code>int sum_y(int vx, int vy, int tly, int try_, int ly, int ry) {\n    if (ly &gt; ry) \n        return 0;\n    if (ly == tly &amp;&amp; try_ == ry)\n        return t[vx][vy];\n    int tmy = (tly + try_) / 2;\n    return sum_y(vx, vy*2, tly, tmy, ly, min(ry, tmy))\n         + sum_y(vx, vy*2+1, tmy+1, try_, max(ly, tmy+1), ry);\n}\n\nint sum_x(int vx, int tlx, int trx, int lx, int rx, int ly, int ry) {\n    if (lx &gt; rx)\n        return 0;\n    if (lx == tlx &amp;&amp; trx == rx)\n        return sum_y(vx, 1, 0, m-1, ly, ry);\n    int tmx = (tlx + trx) / 2;\n    return sum_x(vx*2, tlx, tmx, lx, min(rx, tmx), ly, ry)\n         + sum_x(vx*2+1, tmx+1, trx, max(lx, tmx+1), rx, ly, ry);\n}\n</code></pre> <p>H\u00e0m n\u00e0y ho\u1ea1t \u0111\u1ed9ng trong th\u1eddi gian $O(\\log n \\log m)$, v\u00ec ban \u0111\u1ea7u n\u00f3 \u0111i xu\u1ed1ng c\u00e2y \u1edf t\u1ecda \u0111\u1ed9 \u0111\u1ea7u ti\u00ean, v\u00e0 \u0111\u1ed1i v\u1edbi m\u1ed7i \u0111\u1ec9nh \u0111\u01b0\u1ee3c duy\u1ec7t trong c\u00e2y, n\u00f3 th\u1ef1c hi\u1ec7n m\u1ed9t truy v\u1ea5n trong Segment Tree t\u01b0\u01a1ng \u1ee9ng d\u1ecdc theo t\u1ecda \u0111\u1ed9 th\u1ee9 hai.</p> <p>Cu\u1ed1i c\u00f9ng ch\u00fang ta xem x\u00e9t truy v\u1ea5n s\u1eeda \u0111\u1ed5i. Ch\u00fang ta mu\u1ed1n h\u1ecdc c\u00e1ch s\u1eeda \u0111\u1ed5i Segment Tree theo s\u1ef1 thay \u0111\u1ed5i gi\u00e1 tr\u1ecb c\u1ee7a m\u1ed9t ph\u1ea7n t\u1eed n\u00e0o \u0111\u00f3 $a[x][y] = p$. R\u00f5 r\u00e0ng l\u00e0, nh\u1eefng thay \u0111\u1ed5i s\u1ebd ch\u1ec9 x\u1ea3y ra trong nh\u1eefng \u0111\u1ec9nh c\u1ee7a Segment Tree \u0111\u1ea7u ti\u00ean bao g\u1ed3m t\u1ecda \u0111\u1ed9 $x$ (v\u00e0 s\u1ed1 l\u01b0\u1ee3ng \u0111\u00f3 s\u1ebd l\u00e0 $O(\\log n)$), v\u00e0 \u0111\u1ed1i v\u1edbi c\u00e1c Segment Tree t\u01b0\u01a1ng \u1ee9ng v\u1edbi ch\u00fang, c\u00e1c thay \u0111\u1ed5i s\u1ebd ch\u1ec9 x\u1ea3y ra t\u1ea1i nh\u1eefng \u0111\u1ec9nh bao g\u1ed3m t\u1ecda \u0111\u1ed9 $y$ (v\u00e0 s\u1ed1 l\u01b0\u1ee3ng \u0111\u00f3 s\u1ebd l\u00e0 $O(\\log m)$). Do \u0111\u00f3, vi\u1ec7c c\u00e0i \u0111\u1eb7t s\u1ebd kh\u00f4ng kh\u00e1c nhi\u1ec1u so v\u1edbi tr\u01b0\u1eddng h\u1ee3p m\u1ed9t chi\u1ec1u, ch\u1ec9 c\u00f3 \u0111i\u1ec1u b\u00e2y gi\u1edd ch\u00fang ta \u0111i xu\u1ed1ng t\u1ecda \u0111\u1ed9 \u0111\u1ea7u ti\u00ean tr\u01b0\u1edbc, v\u00e0 sau \u0111\u00f3 l\u00e0 t\u1ecda \u0111\u1ed9 th\u1ee9 hai.</p> <pre><code>void update_y(int vx, int lx, int rx, int vy, int ly, int ry, int x, int y, int new_val) {\n    if (ly == ry) {\n        if (lx == rx)\n            t[vx][vy] = new_val;\n        else\n            t[vx][vy] = t[vx*2][vy] + t[vx*2+1][vy];\n    } else {\n        int my = (ly + ry) / 2;\n        if (y &lt;= my)\n            update_y(vx, lx, rx, vy*2, ly, my, x, y, new_val);\n        else\n            update_y(vx, lx, rx, vy*2+1, my+1, ry, x, y, new_val);\n        t[vx][vy] = t[vx][vy*2] + t[vx][vy*2+1];\n    }\n}\n\nvoid update_x(int vx, int lx, int rx, int x, int y, int new_val) {\n    if (lx != rx) {\n        int mx = (lx + rx) / 2;\n        if (x &lt;= mx)\n            update_x(vx*2, lx, mx, x, y, new_val);\n        else\n            update_x(vx*2+1, mx+1, rx, x, y, new_val);\n    }\n    update_y(vx, lx, rx, 1, 0, m-1, x, y, new_val);\n}\n</code></pre>","tags":["Translated"]},{"location":"data_structures/segment_tree.html#compression-of-2d-segment-tree","title":"N\u00e9n Segment Tree 2D (Compression of 2D Segment Tree)","text":"<p>Gi\u1ea3 s\u1eed b\u00e0i to\u00e1n l\u00e0 nh\u01b0 sau: c\u00f3 $n$ \u0111i\u1ec3m tr\u00ean m\u1eb7t ph\u1eb3ng \u0111\u01b0\u1ee3c cho b\u1edfi t\u1ecda \u0111\u1ed9 c\u1ee7a ch\u00fang $(x_i, y_i)$ v\u00e0 c\u00e1c truy v\u1ea5n c\u00f3 d\u1ea1ng \"\u0111\u1ebfm s\u1ed1 l\u01b0\u1ee3ng \u0111i\u1ec3m n\u1eb1m trong h\u00ecnh ch\u1eef nh\u1eadt $((x_1, y_1), (x_2, y_2))$\". R\u00f5 r\u00e0ng l\u00e0 trong tr\u01b0\u1eddng h\u1ee3p c\u1ee7a m\u1ed9t b\u00e0i to\u00e1n nh\u01b0 v\u1eady, vi\u1ec7c x\u00e2y d\u1ef1ng m\u1ed9t Segment Tree hai chi\u1ec1u v\u1edbi $O(n^2)$ ph\u1ea7n t\u1eed tr\u1edf n\u00ean l\u00e3ng ph\u00ed m\u1ed9t c\u00e1ch v\u00f4 l\u00fd. H\u1ea7u h\u1ebft b\u1ed9 nh\u1edb n\u00e0y s\u1ebd b\u1ecb l\u00e3ng ph\u00ed, v\u00ec m\u1ed7i \u0111i\u1ec3m \u0111\u01a1n l\u1ebb ch\u1ec9 c\u00f3 th\u1ec3 \u0111i v\u00e0o $O(\\log n)$ \u0111o\u1ea1n c\u1ee7a c\u00e2y d\u1ecdc theo t\u1ecda \u0111\u1ed9 \u0111\u1ea7u ti\u00ean, v\u00e0 do \u0111\u00f3 t\u1ed5ng k\u00edch th\u01b0\u1edbc \"h\u1eefu \u00edch\" c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c \u0111o\u1ea1n c\u00e2y tr\u00ean t\u1ecda \u0111\u1ed9 th\u1ee9 hai l\u00e0 $O(n \\log n)$.</p> <p>V\u00ec v\u1eady, ch\u00fang ta ti\u1ebfn h\u00e0nh nh\u01b0 sau: t\u1ea1i m\u1ed7i \u0111\u1ec9nh c\u1ee7a Segment Tree \u0111\u1ed1i v\u1edbi t\u1ecda \u0111\u1ed9 \u0111\u1ea7u ti\u00ean, ch\u00fang ta l\u01b0u tr\u1eef m\u1ed9t Segment Tree \u0111\u01b0\u1ee3c x\u00e2y d\u1ef1ng ch\u1ec9 b\u1edfi nh\u1eefng t\u1ecda \u0111\u1ed9 th\u1ee9 hai x\u1ea3y ra trong \u0111o\u1ea1n hi\u1ec7n t\u1ea1i c\u1ee7a t\u1ecda \u0111\u1ed9 \u0111\u1ea7u ti\u00ean. N\u00f3i c\u00e1ch kh\u00e1c, khi x\u00e2y d\u1ef1ng m\u1ed9t Segment Tree b\u00ean trong m\u1ed9t \u0111\u1ec9nh c\u00f3 ch\u1ec9 s\u1ed1 $vx$ v\u00e0 c\u00e1c ranh gi\u1edbi $tlx$ v\u00e0 $trx$, ch\u00fang ta ch\u1ec9 xem x\u00e9t nh\u1eefng \u0111i\u1ec3m r\u01a1i v\u00e0o kho\u1ea3ng n\u00e0y $x \\in [tlx, trx]$, v\u00e0 x\u00e2y d\u1ef1ng m\u1ed9t Segment Tree ch\u1ec9 s\u1eed d\u1ee5ng ch\u00fang.</p> <p>Do \u0111\u00f3, ch\u00fang ta s\u1ebd \u0111\u1ea1t \u0111\u01b0\u1ee3c r\u1eb1ng m\u1ed7i Segment Tree tr\u00ean t\u1ecda \u0111\u1ed9 th\u1ee9 hai s\u1ebd chi\u1ebfm ch\u00ednh x\u00e1c nhi\u1ec1u b\u1ed9 nh\u1edb nh\u01b0 n\u00f3 n\u00ean. K\u1ebft qu\u1ea3 l\u00e0, t\u1ed5ng l\u01b0\u1ee3ng b\u1ed9 nh\u1edb s\u1ebd gi\u1ea3m xu\u1ed1ng $O(n \\log n)$. Ch\u00fang ta v\u1eabn c\u00f3 th\u1ec3 tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n trong th\u1eddi gian $O(\\log^2 n)$, ch\u00fang ta ch\u1ec9 c\u1ea7n th\u1ef1c hi\u1ec7n t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n tr\u00ean t\u1ecda \u0111\u1ed9 th\u1ee9 hai, nh\u01b0ng \u0111i\u1ec1u n\u00e0y s\u1ebd kh\u00f4ng l\u00e0m x\u1ea5u \u0111i \u0111\u1ed9 ph\u1ee9c t\u1ea1p.</p> <p>Nh\u01b0ng c\u00e1c truy v\u1ea5n s\u1eeda \u0111\u1ed5i s\u1ebd l\u00e0 kh\u00f4ng th\u1ec3 v\u1edbi c\u1ea5u tr\u00fac n\u00e0y: tr\u00ean th\u1ef1c t\u1ebf n\u1ebfu m\u1ed9t \u0111i\u1ec3m m\u1edbi xu\u1ea5t hi\u1ec7n, ch\u00fang ta ph\u1ea3i th\u00eam m\u1ed9t ph\u1ea7n t\u1eed m\u1edbi v\u00e0o gi\u1eefa m\u1ed9t Segment Tree n\u00e0o \u0111\u00f3 d\u1ecdc theo t\u1ecda \u0111\u1ed9 th\u1ee9 hai, \u0111i\u1ec1u n\u00e0y kh\u00f4ng th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n m\u1ed9t c\u00e1ch hi\u1ec7u qu\u1ea3.</p> <p>K\u1ebft lu\u1eadn, ch\u00fang ta l\u01b0u \u00fd r\u1eb1ng Segment Tree hai chi\u1ec1u \u0111\u01b0\u1ee3c r\u00fat g\u1ecdn theo c\u00e1ch \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 tr\u1edf n\u00ean g\u1ea7n nh\u01b0 t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi vi\u1ec7c s\u1eeda \u0111\u1ed5i Segment Tree m\u1ed9t chi\u1ec1u (xem L\u01b0u tr\u1eef to\u00e0n b\u1ed9 m\u1ea3ng con trong m\u1ed7i \u0111\u1ec9nh). \u0110\u1eb7c bi\u1ec7t, Segment Tree hai chi\u1ec1u ch\u1ec9 l\u00e0 m\u1ed9t tr\u01b0\u1eddng h\u1ee3p \u0111\u1eb7c bi\u1ec7t c\u1ee7a vi\u1ec7c l\u01b0u tr\u1eef m\u1ed9t m\u1ea3ng con trong m\u1ed7i \u0111\u1ec9nh c\u1ee7a c\u00e2y. Theo \u0111\u00f3, n\u1ebfu b\u1ea1n ph\u1ea3i t\u1eeb b\u1ecf Segment Tree hai chi\u1ec1u do kh\u00f4ng th\u1ec3 th\u1ef1c hi\u1ec7n truy v\u1ea5n, th\u00ec vi\u1ec7c thay th\u1ebf Segment Tree l\u1ed3ng nhau b\u1eb1ng m\u1ed9t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u m\u1ea1nh h\u01a1n, v\u00ed d\u1ee5 nh\u01b0 Cartesian tree, l\u00e0 \u0111i\u1ec1u h\u1ee3p l\u00fd.</p>","tags":["Translated"]},{"location":"data_structures/segment_tree.html#preserving-the-history-of-its-values-persistent-segment-tree","title":"B\u1ea3o t\u1ed3n l\u1ecbch s\u1eed c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a n\u00f3 (Persistent Segment Tree)","text":"<p>M\u1ed9t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u persistent l\u00e0 m\u1ed9t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u ghi nh\u1edb tr\u1ea1ng th\u00e1i tr\u01b0\u1edbc \u0111\u00f3 c\u1ee7a n\u00f3 cho m\u1ed7i l\u1ea7n s\u1eeda \u0111\u1ed5i. \u0110i\u1ec1u n\u00e0y cho ph\u00e9p truy c\u1eadp b\u1ea5t k\u1ef3 phi\u00ean b\u1ea3n n\u00e0o c\u1ee7a c\u1ea5u tr\u00fac d\u1eef li\u1ec7u n\u00e0y m\u00e0 ch\u00fang ta quan t\u00e2m v\u00e0 th\u1ef1c hi\u1ec7n truy v\u1ea5n tr\u00ean \u0111\u00f3.</p> <p>Segment Tree l\u00e0 m\u1ed9t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bi\u1ebfn th\u00e0nh m\u1ed9t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u persistent m\u1ed9t c\u00e1ch hi\u1ec7u qu\u1ea3 (c\u1ea3 v\u1ec1 th\u1eddi gian v\u00e0 m\u1ee9c ti\u00eau th\u1ee5 b\u1ed9 nh\u1edb). Ch\u00fang ta mu\u1ed1n tr\u00e1nh sao ch\u00e9p to\u00e0n b\u1ed9 c\u00e2y tr\u01b0\u1edbc m\u1ed7i l\u1ea7n s\u1eeda \u0111\u1ed5i, v\u00e0 ch\u00fang ta kh\u00f4ng mu\u1ed1n m\u1ea5t h\u00e0nh vi th\u1eddi gian $O(\\log n)$ \u0111\u1ec3 tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n \u0111o\u1ea1n.</p> <p>Tr\u00ean th\u1ef1c t\u1ebf, b\u1ea5t k\u1ef3 y\u00eau c\u1ea7u thay \u0111\u1ed5i n\u00e0o trong Segment Tree \u0111\u1ec1u d\u1eabn \u0111\u1ebfn s\u1ef1 thay \u0111\u1ed5i d\u1eef li\u1ec7u c\u1ee7a ch\u1ec9 $O(\\log n)$ \u0111\u1ec9nh d\u1ecdc theo \u0111\u01b0\u1eddng \u0111i b\u1eaft \u0111\u1ea7u t\u1eeb g\u1ed1c. V\u00ec v\u1eady, n\u1ebfu ch\u00fang ta l\u01b0u tr\u1eef Segment Tree b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng c\u00e1c con tr\u1ecf (t\u1ee9c l\u00e0 m\u1ed9t \u0111\u1ec9nh l\u01b0u tr\u1eef c\u00e1c con tr\u1ecf \u0111\u1ebfn c\u00e1c \u0111\u1ec9nh con tr\u00e1i v\u00e0 ph\u1ea3i), th\u00ec khi th\u1ef1c hi\u1ec7n truy v\u1ea5n s\u1eeda \u0111\u1ed5i, ch\u00fang ta ch\u1ec9 c\u1ea7n t\u1ea1o c\u00e1c \u0111\u1ec9nh m\u1edbi thay v\u00ec thay \u0111\u1ed5i c\u00e1c \u0111\u1ec9nh c\u00f3 s\u1eb5n. C\u00e1c \u0111\u1ec9nh kh\u00f4ng b\u1ecb \u1ea3nh h\u01b0\u1edfng b\u1edfi truy v\u1ea5n s\u1eeda \u0111\u1ed5i v\u1eabn c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng b\u1eb1ng c\u00e1ch tr\u1ecf c\u00e1c con tr\u1ecf \u0111\u1ebfn c\u00e1c \u0111\u1ec9nh c\u0169. Do \u0111\u00f3, \u0111\u1ed1i v\u1edbi m\u1ed9t truy v\u1ea5n s\u1eeda \u0111\u1ed5i, $O(\\log n)$ \u0111\u1ec9nh m\u1edbi s\u1ebd \u0111\u01b0\u1ee3c t\u1ea1o, bao g\u1ed3m m\u1ed9t \u0111\u1ec9nh g\u1ed1c m\u1edbi c\u1ee7a Segment Tree, v\u00e0 to\u00e0n b\u1ed9 phi\u00ean b\u1ea3n tr\u01b0\u1edbc \u0111\u00f3 c\u1ee7a c\u00e2y b\u1eaft ngu\u1ed3n t\u1eeb \u0111\u1ec9nh g\u1ed1c c\u0169 s\u1ebd kh\u00f4ng thay \u0111\u1ed5i.</p> <p>H\u00e3y \u0111\u01b0a ra m\u1ed9t v\u00ed d\u1ee5 c\u00e0i \u0111\u1eb7t cho Segment Tree \u0111\u01a1n gi\u1ea3n nh\u1ea5t: khi ch\u1ec9 c\u00f3 m\u1ed9t truy v\u1ea5n y\u00eau c\u1ea7u t\u1ed5ng, v\u00e0 c\u00e1c truy v\u1ea5n s\u1eeda \u0111\u1ed5i c\u1ee7a c\u00e1c ph\u1ea7n t\u1eed \u0111\u01a1n l\u1ebb.</p> <p><pre><code>struct Vertex {\n    Vertex *l, *r;\n    int sum;\n\n    Vertex(int val) : l(nullptr), r(nullptr), sum(val) {}\n    Vertex(Vertex *l, Vertex *r) : l(l), r(r), sum(0) {\n        if (l) sum += l-&gt;sum;\n        if (r) sum += r-&gt;sum;\n    }\n};\n\nVertex* build(int a[], int tl, int tr) {\n    if (tl == tr)\n        return new Vertex(a[tl]);\n    int tm = (tl + tr) / 2;\n    return new Vertex(build(a, tl, tm), build(a, tm+1, tr));\n}\n\nint get_sum(Vertex* v, int tl, int tr, int l, int r) {\n    if (l &gt; r)\n        return 0;\n    if (l == tl &amp;&amp; tr == r)\n        return v-&gt;sum;\n    int tm = (tl + tr) / 2;\n    return get_sum(v-&gt;l, tl, tm, l, min(r, tm))\n         + get_sum(v-&gt;r, tm+1, tr, max(l, tm+1), r);\n}\n\nVertex* update(Vertex* v, int tl, int tr, int pos, int new_val) {\n    if (tl == tr)\n        return new Vertex(new_val);\n    int tm = (tl + tr) / 2;\n    if (pos &lt;= tm)\n        return new Vertex(update(v-&gt;l, tl, tm, pos, new_val), v-&gt;r);\n    else\n        return new Vertex(v-&gt;l, update(v-&gt;r, tm+1, tr, pos, new_val));\n}\n</code></pre> \u0110\u1ed1i v\u1edbi m\u1ed7i l\u1ea7n s\u1eeda \u0111\u1ed5i c\u1ee7a Segment Tree, ch\u00fang ta s\u1ebd nh\u1eadn \u0111\u01b0\u1ee3c m\u1ed9t \u0111\u1ec9nh g\u1ed1c m\u1edbi. \u0110\u1ec3 nhanh ch\u00f3ng chuy\u1ec3n \u0111\u1ed5i gi\u1eefa hai phi\u00ean b\u1ea3n kh\u00e1c nhau c\u1ee7a Segment Tree, ch\u00fang ta c\u1ea7n l\u01b0u tr\u1eef c\u00e1c g\u1ed1c n\u00e0y trong m\u1ed9t m\u1ea3ng. \u0110\u1ec3 s\u1eed d\u1ee5ng m\u1ed9t phi\u00ean b\u1ea3n c\u1ee5 th\u1ec3 c\u1ee7a Segment Tree, ch\u00fang ta ch\u1ec9 c\u1ea7n g\u1ecdi truy v\u1ea5n b\u1eb1ng \u0111\u1ec9nh g\u1ed1c th\u00edch h\u1ee3p.</p> <p>V\u1edbi c\u00e1ch ti\u1ebfp c\u1eadn \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 \u1edf tr\u00ean, h\u1ea7u h\u1ebft m\u1ecdi Segment Tree \u0111\u1ec1u c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bi\u1ebfn th\u00e0nh m\u1ed9t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u persistent.</p>","tags":["Translated"]},{"location":"data_structures/segment_tree.html#finding-the-k-th-smallest-number-in-a-range","title":"T\u00ecm s\u1ed1 nh\u1ecf th\u1ee9 $k$ trong m\u1ed9t \u0111o\u1ea1n (Finding the $k$-th smallest number in a range)","text":"<p>L\u1ea7n n\u00e0y ch\u00fang ta ph\u1ea3i tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n c\u00f3 d\u1ea1ng \"Ph\u1ea7n t\u1eed nh\u1ecf th\u1ee9 $k$ trong \u0111o\u1ea1n $a[l \\dots r]$ l\u00e0 g\u00ec\". Truy v\u1ea5n n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c tr\u1ea3 l\u1eddi b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n v\u00e0 Merge Sort Tree, nh\u01b0ng \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian cho m\u1ed9t truy v\u1ea5n \u0111\u01a1n l\u1ebb s\u1ebd l\u00e0 $O(\\log^3 n)$. Ch\u00fang ta s\u1ebd ho\u00e0n th\u00e0nh nhi\u1ec7m v\u1ee5 t\u01b0\u01a1ng t\u1ef1 b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng Segment Tree persistent trong $O(\\log n)$.</p> <p>\u0110\u1ea7u ti\u00ean ch\u00fang ta s\u1ebd th\u1ea3o lu\u1eadn v\u1ec1 m\u1ed9t gi\u1ea3i ph\u00e1p cho m\u1ed9t v\u1ea5n \u0111\u1ec1 \u0111\u01a1n gi\u1ea3n h\u01a1n: Ch\u00fang ta s\u1ebd ch\u1ec9 xem x\u00e9t c\u00e1c m\u1ea3ng trong \u0111\u00f3 c\u00e1c ph\u1ea7n t\u1eed b\u1ecb gi\u1edbi h\u1ea1n b\u1edfi $0 \\le a[i] \\lt n$. V\u00e0 ch\u00fang ta ch\u1ec9 mu\u1ed1n t\u00ecm ph\u1ea7n t\u1eed nh\u1ecf th\u1ee9 $k$ trong m\u1ed9t ti\u1ec1n t\u1ed1 n\u00e0o \u0111\u00f3 c\u1ee7a m\u1ea3ng $a$. S\u1ebd r\u1ea5t d\u1ec5 d\u00e0ng \u0111\u1ec3 m\u1edf r\u1ed9ng c\u00e1c \u00fd t\u01b0\u1edfng \u0111\u00e3 ph\u00e1t tri\u1ec3n sau n\u00e0y cho c\u00e1c m\u1ea3ng kh\u00f4ng b\u1ecb h\u1ea1n ch\u1ebf v\u00e0 c\u00e1c truy v\u1ea5n \u0111o\u1ea1n kh\u00f4ng b\u1ecb h\u1ea1n ch\u1ebf. L\u01b0u \u00fd r\u1eb1ng ch\u00fang ta s\u1ebd s\u1eed d\u1ee5ng ch\u1ec9 m\u1ee5c d\u1ef1a tr\u00ean 1 cho $a$.</p> <p>Ch\u00fang ta s\u1ebd s\u1eed d\u1ee5ng m\u1ed9t Segment Tree \u0111\u1ebfm t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 xu\u1ea5t hi\u1ec7n, t\u1ee9c l\u00e0 trong Segment Tree ch\u00fang ta s\u1ebd l\u01b0u tr\u1eef bi\u1ec3u \u0111\u1ed3 t\u1ea7n su\u1ea5t (histogram) c\u1ee7a m\u1ea3ng. V\u00ec v\u1eady, c\u00e1c \u0111\u1ec9nh l\u00e1 s\u1ebd l\u01b0u tr\u1eef t\u1ea7n su\u1ea5t c\u00e1c gi\u00e1 tr\u1ecb $0$, $1$, $\\dots$, $n-1$ s\u1ebd xu\u1ea5t hi\u1ec7n trong m\u1ea3ng, v\u00e0 c\u00e1c \u0111\u1ec9nh kh\u00e1c l\u01b0u tr\u1eef c\u00f3 bao nhi\u00eau s\u1ed1 trong m\u1ed9t ph\u1ea1m vi n\u00e0o \u0111\u00f3 n\u1eb1m trong m\u1ea3ng. N\u00f3i c\u00e1ch kh\u00e1c, ch\u00fang ta t\u1ea1o m\u1ed9t Segment Tree th\u00f4ng th\u01b0\u1eddng v\u1edbi c\u00e1c truy v\u1ea5n t\u1ed5ng tr\u00ean bi\u1ec3u \u0111\u1ed3 t\u1ea7n su\u1ea5t c\u1ee7a m\u1ea3ng. Nh\u01b0ng thay v\u00ec t\u1ea1o t\u1ea5t c\u1ea3 $n$ Segment Trees cho m\u1ecdi ti\u1ec1n t\u1ed1 c\u00f3 th\u1ec3, ch\u00fang ta s\u1ebd t\u1ea1o m\u1ed9t c\u00e1i persistent, s\u1ebd ch\u1ee9a c\u00f9ng th\u00f4ng tin. Ch\u00fang ta s\u1ebd b\u1eaft \u0111\u1ea7u v\u1edbi m\u1ed9t Segment Tree r\u1ed7ng (t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 \u0111\u1ebfm s\u1ebd l\u00e0 $0$) \u0111\u01b0\u1ee3c tr\u1ecf b\u1edfi $root_0$, v\u00e0 th\u00eam c\u00e1c ph\u1ea7n t\u1eed $a[1]$, $a[2]$, $\\dots$, $a[n]$ l\u1ea7n l\u01b0\u1ee3t. \u0110\u1ed1i v\u1edbi m\u1ed7i thay \u0111\u1ed5i, ch\u00fang ta s\u1ebd nh\u1eadn \u0111\u01b0\u1ee3c m\u1ed9t \u0111\u1ec9nh g\u1ed1c m\u1edbi, h\u00e3y g\u1ecdi $root_i$ l\u00e0 g\u1ed1c c\u1ee7a Segment Tree sau khi ch\u00e8n $i$ ph\u1ea7n t\u1eed \u0111\u1ea7u ti\u00ean c\u1ee7a m\u1ea3ng $a$. Segment Tree c\u00f3 g\u1ed1c t\u1ea1i $root_i$ s\u1ebd ch\u1ee9a bi\u1ec3u \u0111\u1ed3 t\u1ea7n su\u1ea5t c\u1ee7a ti\u1ec1n t\u1ed1 $a[1 \\dots i]$. S\u1eed d\u1ee5ng Segment Tree n\u00e0y, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm th\u1ea5y trong th\u1eddi gian $O(\\log n)$ v\u1ecb tr\u00ed c\u1ee7a ph\u1ea7n t\u1eed th\u1ee9 $k$ b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng c\u00f9ng k\u1ef9 thu\u1eadt \u0111\u00e3 th\u1ea3o lu\u1eadn trong \u0110\u1ebfm s\u1ed1 l\u01b0\u1ee3ng s\u1ed1 0, t\u00ecm s\u1ed1 0 th\u1ee9 $k$.</p> <p>B\u00e2y gi\u1edd \u0111\u1ebfn phi\u00ean b\u1ea3n kh\u00f4ng h\u1ea1n ch\u1ebf c\u1ee7a v\u1ea5n \u0111\u1ec1.</p> <p>\u0110\u1ea7u ti\u00ean \u0111\u1ed1i v\u1edbi h\u1ea1n ch\u1ebf v\u1ec1 c\u00e1c truy v\u1ea5n: Thay v\u00ec ch\u1ec9 th\u1ef1c hi\u1ec7n c\u00e1c truy v\u1ea5n n\u00e0y tr\u00ean m\u1ed9t ti\u1ec1n t\u1ed1 c\u1ee7a $a$, ch\u00fang ta mu\u1ed1n s\u1eed d\u1ee5ng b\u1ea5t k\u1ef3 \u0111o\u1ea1n t\u00f9y \u00fd n\u00e0o $a[l \\dots r]$. \u1ede \u0111\u00e2y ch\u00fang ta c\u1ea7n m\u1ed9t Segment Tree \u0111\u1ea1i di\u1ec7n cho bi\u1ec3u \u0111\u1ed3 t\u1ea7n su\u1ea5t c\u1ee7a c\u00e1c ph\u1ea7n t\u1eed trong \u0111o\u1ea1n $a[l \\dots r]$. D\u1ec5 th\u1ea5y r\u1eb1ng m\u1ed9t Segment Tree nh\u01b0 v\u1eady ch\u1ec9 l\u00e0 s\u1ef1 kh\u00e1c bi\u1ec7t gi\u1eefa Segment Tree c\u00f3 g\u1ed1c t\u1ea1i $root_{r}$ v\u00e0 Segment Tree c\u00f3 g\u1ed1c t\u1ea1i $root_{l-1}$, t\u1ee9c l\u00e0 m\u1ecdi \u0111\u1ec9nh trong Segment Tree $[l \\dots r]$ c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ednh b\u1eb1ng \u0111\u1ec9nh c\u1ee7a c\u00e2y $root_{r}$ tr\u1eeb \u0111i \u0111\u1ec9nh c\u1ee7a c\u00e2y $root_{l-1}$.</p> <p>Trong vi\u1ec7c c\u00e0i \u0111\u1eb7t h\u00e0m $\\text{find_kth}$, \u0111i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c x\u1eed l\u00fd b\u1eb1ng c\u00e1ch truy\u1ec1n hai con tr\u1ecf \u0111\u1ec9nh v\u00e0 t\u00ednh to\u00e1n s\u1ed1 \u0111\u1ebfm/t\u1ed5ng c\u1ee7a \u0111o\u1ea1n hi\u1ec7n t\u1ea1i d\u01b0\u1edbi d\u1ea1ng hi\u1ec7u c\u1ee7a hai s\u1ed1 \u0111\u1ebfm/t\u1ed5ng c\u1ee7a c\u00e1c \u0111\u1ec9nh.</p> <p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 c\u00e1c h\u00e0m $\\text{build}$, $\\text{update}$ v\u00e0 $\\text{find_kth}$ \u0111\u00e3 s\u1eeda \u0111\u1ed5i</p> <pre><code>Vertex* build(int tl, int tr) {\n    if (tl == tr)\n        return new Vertex(0);\n    int tm = (tl + tr) / 2;\n    return new Vertex(build(tl, tm), build(tm+1, tr));\n}\n\nVertex* update(Vertex* v, int tl, int tr, int pos) {\n    if (tl == tr)\n        return new Vertex(v-&gt;sum+1);\n    int tm = (tl + tr) / 2;\n    if (pos &lt;= tm)\n        return new Vertex(update(v-&gt;l, tl, tm, pos), v-&gt;r);\n    else\n        return new Vertex(v-&gt;l, update(v-&gt;r, tm+1, tr, pos));\n}\n\nint find_kth(Vertex* vl, Vertex *vr, int tl, int tr, int k) {\n    if (tl == tr)\n        return tl;\n    int tm = (tl + tr) / 2, left_count = vr-&gt;l-&gt;sum - vl-&gt;l-&gt;sum;\n    if (left_count &gt;= k)\n        return find_kth(vl-&gt;l, vr-&gt;l, tl, tm, k);\n    return find_kth(vl-&gt;r, vr-&gt;r, tm+1, tr, k-left_count);\n}\n</code></pre> <p>Nh\u01b0 \u0111\u00e3 vi\u1ebft \u1edf tr\u00ean, ch\u00fang ta c\u1ea7n l\u01b0u tr\u1eef g\u1ed1c c\u1ee7a Segment Tree ban \u0111\u1ea7u, v\u00e0 c\u1ea3 t\u1ea5t c\u1ea3 c\u00e1c g\u1ed1c sau m\u1ed7i l\u1ea7n c\u1eadp nh\u1eadt. D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u00e3 \u0111\u1ec3 x\u00e2y d\u1ef1ng m\u1ed9t Segment Tree persistent tr\u00ean m\u1ed9t vector <code>a</code> v\u1edbi c\u00e1c ph\u1ea7n t\u1eed trong ph\u1ea1m vi <code>[0, MAX_VALUE]</code>.</p> <pre><code>int tl = 0, tr = MAX_VALUE + 1;\nstd::vector&lt;Vertex*&gt; roots;\nroots.push_back(build(tl, tr));\nfor (int i = 0; i &lt; a.size(); i++) {\n    roots.push_back(update(roots.back(), tl, tr, a[i]));\n}\n\n// find the 5th smallest number from the subarray [a[2], a[3], ..., a[19]]\nint result = find_kth(roots[2], roots[20], tl, tr, 5);\n</code></pre> <p>B\u00e2y gi\u1edd \u0111\u1ebfn c\u00e1c h\u1ea1n ch\u1ebf v\u1ec1 c\u00e1c ph\u1ea7n t\u1eed m\u1ea3ng: Ch\u00fang ta th\u1ef1c s\u1ef1 c\u00f3 th\u1ec3 chuy\u1ec3n \u0111\u1ed5i b\u1ea5t k\u1ef3 m\u1ea3ng n\u00e0o th\u00e0nh m\u1ed9t m\u1ea3ng nh\u01b0 v\u1eady b\u1eb1ng c\u00e1ch n\u00e9n ch\u1ec9 m\u1ee5c. Ph\u1ea7n t\u1eed nh\u1ecf nh\u1ea5t trong m\u1ea3ng s\u1ebd \u0111\u01b0\u1ee3c g\u00e1n gi\u00e1 tr\u1ecb 0, nh\u1ecf th\u1ee9 hai l\u00e0 gi\u00e1 tr\u1ecb 1, v.v. Th\u1eadt d\u1ec5 d\u00e0ng \u0111\u1ec3 t\u1ea1o c\u00e1c b\u1ea3ng tra c\u1ee9u (v\u00ed d\u1ee5: s\u1eed d\u1ee5ng $\\text{map}$), chuy\u1ec3n \u0111\u1ed5i m\u1ed9t gi\u00e1 tr\u1ecb th\u00e0nh ch\u1ec9 s\u1ed1 c\u1ee7a n\u00f3 v\u00e0 ng\u01b0\u1ee3c l\u1ea1i trong th\u1eddi gian $O(\\log n)$.</p>","tags":["Translated"]},{"location":"data_structures/segment_tree.html#dynamic-segment-tree","title":"Segment tree \u0111\u1ed9ng (Dynamic segment tree)","text":"<p>(\u0110\u01b0\u1ee3c g\u1ecdi nh\u01b0 v\u1eady v\u00ec h\u00ecnh d\u1ea1ng c\u1ee7a n\u00f3 l\u00e0 \u0111\u1ed9ng v\u00e0 c\u00e1c n\u00fat th\u01b0\u1eddng \u0111\u01b0\u1ee3c ph\u00e2n b\u1ed5 \u0111\u1ed9ng. C\u00f2n \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 implicit segment tree (segment tree ng\u1ea7m) ho\u1eb7c sparse segment tree (segment tree th\u01b0a).)</p> <p>Tr\u01b0\u1edbc \u0111\u00e2y, ch\u00fang ta \u0111\u00e3 xem x\u00e9t c\u00e1c tr\u01b0\u1eddng h\u1ee3p khi ch\u00fang ta c\u00f3 kh\u1ea3 n\u0103ng x\u00e2y d\u1ef1ng segment tree ban \u0111\u1ea7u. Nh\u01b0ng ph\u1ea3i l\u00e0m g\u00ec n\u1ebfu k\u00edch th\u01b0\u1edbc ban \u0111\u1ea7u \u0111\u01b0\u1ee3c l\u1ea5p \u0111\u1ea7y b\u1eb1ng m\u1ed9t s\u1ed1 ph\u1ea7n t\u1eed m\u1eb7c \u0111\u1ecbnh, nh\u01b0ng k\u00edch th\u01b0\u1edbc c\u1ee7a n\u00f3 kh\u00f4ng cho ph\u00e9p b\u1ea1n x\u00e2y d\u1ef1ng ho\u00e0n to\u00e0n cho \u0111\u1ebfn n\u00f3 tr\u01b0\u1edbc?</p> <p>Ch\u00fang ta c\u00f3 th\u1ec3 gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 n\u00e0y b\u1eb1ng c\u00e1ch t\u1ea1o m\u1ed9t segment tree m\u1ed9t c\u00e1ch l\u01b0\u1eddi bi\u1ebfng (t\u0103ng d\u1ea7n). Ban \u0111\u1ea7u, ch\u00fang ta s\u1ebd ch\u1ec9 t\u1ea1o g\u1ed1c, v\u00e0 ch\u00fang ta s\u1ebd ch\u1ec9 t\u1ea1o c\u00e1c \u0111\u1ec9nh kh\u00e1c khi ch\u00fang ta c\u1ea7n ch\u00fang. Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, ch\u00fang ta s\u1ebd s\u1eed d\u1ee5ng c\u00e0i \u0111\u1eb7t tr\u00ean con tr\u1ecf (tr\u01b0\u1edbc khi \u0111i \u0111\u1ebfn con c\u1ee7a \u0111\u1ec9nh, h\u00e3y ki\u1ec3m tra xem ch\u00fang \u0111\u00e3 \u0111\u01b0\u1ee3c t\u1ea1o ch\u01b0a, v\u00e0 n\u1ebfu ch\u01b0a, h\u00e3y t\u1ea1o ch\u00fang). M\u1ed7i truy v\u1ea5n v\u1eabn ch\u1ec9 c\u00f3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p $O(\\log n)$, \u0111\u1ee7 nh\u1ecf cho h\u1ea7u h\u1ebft c\u00e1c tr\u01b0\u1eddng h\u1ee3p s\u1eed d\u1ee5ng (v\u00ed d\u1ee5: $\\log_2 10^9 \\approx 30$).</p> <p>Trong c\u00e0i \u0111\u1eb7t n\u00e0y, ch\u00fang ta c\u00f3 hai truy v\u1ea5n, th\u00eam m\u1ed9t gi\u00e1 tr\u1ecb v\u00e0o m\u1ed9t v\u1ecb tr\u00ed (ban \u0111\u1ea7u t\u1ea5t c\u1ea3 c\u00e1c gi\u00e1 tr\u1ecb l\u00e0 $0$), v\u00e0 t\u00ednh t\u1ed5ng c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c gi\u00e1 tr\u1ecb trong m\u1ed9t \u0111o\u1ea1n. <code>Vertex(0, n)</code> s\u1ebd l\u00e0 \u0111\u1ec9nh g\u1ed1c c\u1ee7a c\u00e2y ng\u1ea7m.</p> <pre><code>struct Vertex {\n    int left, right;\n    int sum = 0;\n    Vertex *left_child = nullptr, *right_child = nullptr;\n\n    Vertex(int lb, int rb) {\n        left = lb;\n        right = rb;\n    }\n\n    void extend() {\n        if (!left_child &amp;&amp; left + 1 &lt; right) {\n            int t = (left + right) / 2;\n            left_child = new Vertex(left, t);\n            right_child = new Vertex(t, right);\n        }\n    }\n\n    void add(int k, int x) {\n        extend();\n        sum += x;\n        if (left_child) {\n            if (k &lt; left_child-&gt;right)\n                left_child-&gt;add(k, x);\n            else\n                right_child-&gt;add(k, x);\n        }\n    }\n\n    int get_sum(int lq, int rq) {\n        if (lq &lt;= left &amp;&amp; right &lt;= rq)\n            return sum;\n        if (max(left, lq) &gt;= min(right, rq))\n            return 0;\n        extend();\n        return left_child-&gt;get_sum(lq, rq) + right_child-&gt;get_sum(lq, rq);\n    }\n};\n</code></pre> <p>R\u00f5 r\u00e0ng \u00fd t\u01b0\u1edfng n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c m\u1edf r\u1ed9ng theo nhi\u1ec1u c\u00e1ch kh\u00e1c nhau. V\u00ed d\u1ee5: b\u1eb1ng c\u00e1ch th\u00eam h\u1ed7 tr\u1ee3 cho c\u1eadp nh\u1eadt \u0111o\u1ea1n th\u00f4ng qua lazy propagation.</p>","tags":["Translated"]},{"location":"data_structures/segment_tree.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>SPOJ - KQUERY [Persistent segment tree / Merge sort tree]</li> <li>Codeforces - Xenia and Bit Operations</li> <li>UVA 11402 - Ahoy, Pirates!</li> <li>SPOJ - GSS3</li> <li>Codeforces - Distinct Characters Queries</li> <li>Codeforces - Knight Tournament [For beginners]</li> <li>Codeforces - Ant colony</li> <li>Codeforces - Drazil and Park</li> <li>Codeforces - Circular RMQ</li> <li>Codeforces - Lucky Array</li> <li>Codeforces - The Child and Sequence</li> <li>Codeforces - DZY Loves Fibonacci Numbers [Lazy propagation]</li> <li>Codeforces - Alphabet Permutations</li> <li>Codeforces - Eyes Closed</li> <li>Codeforces - Kefa and Watch</li> <li>Codeforces - A Simple Task</li> <li>Codeforces - SUM and REPLACE</li> <li>Codeforces - XOR on Segment [Lazy propagation]</li> <li>Codeforces - Please, another Queries on Array? [Lazy propagation]</li> <li>COCI - Deda [Last element smaller or equal to x / Binary search]</li> <li>Codeforces - The Untended Antiquity [2D]</li> <li>CSES - Hotel Queries</li> <li>CSES - Polynomial Queries</li> <li>CSES - Range Updates and Sums</li> </ul>","tags":["Translated"]},{"location":"data_structures/segment_tree.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 1213</li> <li>Translated lines: 1213</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Translated"]},{"location":"data_structures/sparse-table.html","title":"B\u1ea3ng th\u01b0a (Sparse Table)","text":"<p>Sparse Table l\u00e0 m\u1ed9t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u cho ph\u00e9p tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n \u0111o\u1ea1n (range queries). N\u00f3 c\u00f3 th\u1ec3 tr\u1ea3 l\u1eddi h\u1ea7u h\u1ebft c\u00e1c truy v\u1ea5n \u0111o\u1ea1n trong $O(\\log n)$, nh\u01b0ng s\u1ee9c m\u1ea1nh th\u1ef1c s\u1ef1 c\u1ee7a n\u00f3 l\u00e0 tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t trong \u0111o\u1ea1n (range minimum queries) (ho\u1eb7c c\u00e1c truy v\u1ea5n gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t trong \u0111o\u1ea1n t\u01b0\u01a1ng \u0111\u01b0\u01a1ng). \u0110\u1ed1i v\u1edbi c\u00e1c truy v\u1ea5n \u0111\u00f3, n\u00f3 c\u00f3 th\u1ec3 t\u00ednh to\u00e1n c\u00e2u tr\u1ea3 l\u1eddi trong th\u1eddi gian $O(1)$.</p> <p>H\u1ea1n ch\u1ebf duy nh\u1ea5t c\u1ee7a c\u1ea5u tr\u00fac d\u1eef li\u1ec7u n\u00e0y l\u00e0, n\u00f3 ch\u1ec9 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng tr\u00ean c\u00e1c m\u1ea3ng b\u1ea5t bi\u1ebfn (immutable). \u0110i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0, m\u1ea3ng kh\u00f4ng th\u1ec3 thay \u0111\u1ed5i gi\u1eefa hai truy v\u1ea5n. N\u1ebfu b\u1ea5t k\u1ef3 ph\u1ea7n t\u1eed n\u00e0o trong m\u1ea3ng thay \u0111\u1ed5i, to\u00e0n b\u1ed9 c\u1ea5u tr\u00fac d\u1eef li\u1ec7u ph\u1ea3i \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n l\u1ea1i.</p>","tags":["Original"]},{"location":"data_structures/sparse-table.html#intuition","title":"Tr\u1ef1c gi\u00e1c (Intuition)","text":"<p>B\u1ea5t k\u1ef3 s\u1ed1 kh\u00f4ng \u00e2m n\u00e0o c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n duy nh\u1ea5t d\u01b0\u1edbi d\u1ea1ng t\u1ed5ng c\u1ee7a c\u00e1c l\u0169y th\u1eeba gi\u1ea3m d\u1ea7n c\u1ee7a hai. \u0110\u00e2y ch\u1ec9 l\u00e0 m\u1ed9t bi\u1ebfn th\u1ec3 c\u1ee7a bi\u1ec3u di\u1ec5n nh\u1ecb ph\u00e2n c\u1ee7a m\u1ed9t s\u1ed1. V\u00ed d\u1ee5: $13 = (1101)_2 = 8 + 4 + 1$. \u0110\u1ed1i v\u1edbi m\u1ed9t s\u1ed1 $x$, c\u00f3 th\u1ec3 c\u00f3 nhi\u1ec1u nh\u1ea5t $\\lceil \\log_2 x \\rceil$ s\u1ed1 h\u1ea1ng.</p> <p>B\u1eb1ng l\u00fd lu\u1eadn t\u01b0\u01a1ng t\u1ef1, b\u1ea5t k\u1ef3 kho\u1ea3ng n\u00e0o c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n duy nh\u1ea5t d\u01b0\u1edbi d\u1ea1ng h\u1ee3p c\u1ee7a c\u00e1c kho\u1ea3ng c\u00f3 \u0111\u1ed9 d\u00e0i l\u00e0 l\u0169y th\u1eeba gi\u1ea3m d\u1ea7n c\u1ee7a hai. V\u00ed d\u1ee5: $[2, 14] = [2, 9] \\cup [10, 13] \\cup [14, 14]$, trong \u0111\u00f3 \u0111o\u1ea1n ho\u00e0n ch\u1ec9nh c\u00f3 \u0111\u1ed9 d\u00e0i 13, v\u00e0 c\u00e1c \u0111o\u1ea1n ri\u00eang l\u1ebb c\u00f3 \u0111\u1ed9 d\u00e0i l\u1ea7n l\u01b0\u1ee3t l\u00e0 8, 4 v\u00e0 1. V\u00e0 c\u0169ng \u1edf \u0111\u00e2y, h\u1ee3p bao g\u1ed3m nhi\u1ec1u nh\u1ea5t $\\lceil \\log_2(\\text{chi\u1ec1u d\u00e0i kho\u1ea3ng}) \\rceil$ kho\u1ea3ng.</p> <p>\u00dd t\u01b0\u1edfng ch\u00ednh \u0111\u1eb1ng sau Sparse Tables l\u00e0 t\u00ednh to\u00e1n tr\u01b0\u1edbc t\u1ea5t c\u1ea3 c\u00e1c c\u00e2u tr\u1ea3 l\u1eddi cho c\u00e1c truy v\u1ea5n \u0111o\u1ea1n c\u00f3 \u0111\u1ed9 d\u00e0i l\u00e0 l\u0169y th\u1eeba c\u1ee7a hai. Sau \u0111\u00f3, m\u1ed9t truy v\u1ea5n \u0111o\u1ea1n kh\u00e1c c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c tr\u1ea3 l\u1eddi b\u1eb1ng c\u00e1ch chia \u0111o\u1ea1n th\u00e0nh c\u00e1c \u0111o\u1ea1n c\u00f3 \u0111\u1ed9 d\u00e0i l\u00e0 l\u0169y th\u1eeba c\u1ee7a hai, tra c\u1ee9u c\u00e1c c\u00e2u tr\u1ea3 l\u1eddi \u0111\u00e3 t\u00ednh to\u00e1n tr\u01b0\u1edbc, v\u00e0 k\u1ebft h\u1ee3p ch\u00fang \u0111\u1ec3 nh\u1eadn \u0111\u01b0\u1ee3c c\u00e2u tr\u1ea3 l\u1eddi ho\u00e0n ch\u1ec9nh.</p>","tags":["Original"]},{"location":"data_structures/sparse-table.html#precomputation","title":"T\u00ednh to\u00e1n tr\u01b0\u1edbc (Precomputation)","text":"<p>Ch\u00fang ta s\u1ebd s\u1eed d\u1ee5ng m\u1ed9t m\u1ea3ng 2 chi\u1ec1u \u0111\u1ec3 l\u01b0u tr\u1eef c\u00e1c c\u00e2u tr\u1ea3 l\u1eddi cho c\u00e1c truy v\u1ea5n \u0111\u00e3 t\u00ednh to\u00e1n tr\u01b0\u1edbc. $\\text{st}[i][j]$ s\u1ebd l\u01b0u tr\u1eef c\u00e2u tr\u1ea3 l\u1eddi cho \u0111o\u1ea1n $[j, j + 2^i - 1]$ c\u00f3 \u0111\u1ed9 d\u00e0i $2^i$. K\u00edch th\u01b0\u1edbc c\u1ee7a m\u1ea3ng 2 chi\u1ec1u s\u1ebd l\u00e0 $(K + 1) \\times \\text{MAXN}$, trong \u0111\u00f3 $\\text{MAXN}$ l\u00e0 \u0111\u1ed9 d\u00e0i m\u1ea3ng l\u1edbn nh\u1ea5t c\u00f3 th\u1ec3. $\\text{K}$ ph\u1ea3i th\u1ecfa m\u00e3n $\\text{K} \\ge \\lfloor \\log_2 \\text{MAXN} \\rfloor$, b\u1edfi v\u00ec $2^{\\lfloor \\log_2 \\text{MAXN} \\rfloor}$ l\u00e0 \u0111o\u1ea1n l\u0169y th\u1eeba c\u1ee7a hai l\u1edbn nh\u1ea5t m\u00e0 ch\u00fang ta ph\u1ea3i h\u1ed7 tr\u1ee3. \u0110\u1ed1i v\u1edbi c\u00e1c m\u1ea3ng c\u00f3 \u0111\u1ed9 d\u00e0i h\u1ee3p l\u00fd ($\\le 10^7$ ph\u1ea7n t\u1eed), $K = 25$ l\u00e0 m\u1ed9t gi\u00e1 tr\u1ecb t\u1ed1t.</p> <p>K\u00edch th\u01b0\u1edbc $\\text{MAXN}$ l\u00e0 th\u1ee9 hai \u0111\u1ec3 cho ph\u00e9p truy c\u1eadp b\u1ed9 nh\u1edb li\u00ean ti\u1ebfp (th\u00e2n thi\u1ec7n v\u1edbi b\u1ed9 nh\u1edb cache).</p> <pre><code>int st[K + 1][MAXN];\n</code></pre> <p>B\u1edfi v\u00ec \u0111o\u1ea1n $[j, j + 2^i - 1]$ c\u00f3 \u0111\u1ed9 d\u00e0i $2^i$ chia t\u00e1ch \u0111\u1ed9c \u0111\u00e1o th\u00e0nh c\u00e1c \u0111o\u1ea1n $[j, j + 2^{i - 1} - 1]$ v\u00e0 $[j + 2^{i - 1}, j + 2^i - 1]$, c\u1ea3 hai \u0111\u1ec1u c\u00f3 \u0111\u1ed9 d\u00e0i $2^{i - 1}$, ch\u00fang ta c\u00f3 th\u1ec3 t\u1ea1o b\u1ea3ng m\u1ed9t c\u00e1ch hi\u1ec7u qu\u1ea3 b\u1eb1ng quy ho\u1ea1ch \u0111\u1ed9ng:</p> <pre><code>std::copy(array.begin(), array.end(), st[0]);\n\nfor (int i = 1; i &lt;= K; i++)\n    for (int j = 0; j + (1 &lt;&lt; i) &lt;= N; j++)\n        st[i][j] = f(st[i - 1][j], st[i - 1][j + (1 &lt;&lt; (i - 1))]);\n</code></pre> <p>H\u00e0m $f$ s\u1ebd ph\u1ee5 thu\u1ed9c v\u00e0o lo\u1ea1i truy v\u1ea5n. \u0110\u1ed1i v\u1edbi c\u00e1c truy v\u1ea5n t\u1ed5ng \u0111o\u1ea1n, n\u00f3 s\u1ebd t\u00ednh t\u1ed5ng, \u0111\u1ed1i v\u1edbi c\u00e1c truy v\u1ea5n gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t trong \u0111o\u1ea1n, n\u00f3 s\u1ebd t\u00ednh gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t.</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian c\u1ee7a vi\u1ec7c t\u00ednh to\u00e1n tr\u01b0\u1edbc l\u00e0 $O(\\text{N} \\log \\text{N})$.</p>","tags":["Original"]},{"location":"data_structures/sparse-table.html#range-sum-queries","title":"Truy v\u1ea5n t\u1ed5ng \u0111o\u1ea1n (Range Sum Queries)","text":"<p>\u0110\u1ed1i v\u1edbi lo\u1ea1i truy v\u1ea5n n\u00e0y, ch\u00fang ta mu\u1ed1n t\u00ecm t\u1ed5ng c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c gi\u00e1 tr\u1ecb trong m\u1ed9t \u0111o\u1ea1n. Do \u0111\u00f3, \u0111\u1ecbnh ngh\u0129a t\u1ef1 nhi\u00ean c\u1ee7a h\u00e0m $f$ l\u00e0 $f(x, y) = x + y$. Ch\u00fang ta c\u00f3 th\u1ec3 x\u00e2y d\u1ef1ng c\u1ea5u tr\u00fac d\u1eef li\u1ec7u v\u1edbi:</p> <pre><code>long long st[K + 1][MAXN];\n\nstd::copy(array.begin(), array.end(), st[0]);\n\nfor (int i = 1; i &lt;= K; i++)\n    for (int j = 0; j + (1 &lt;&lt; i) &lt;= N; j++)\n        st[i][j] = st[i - 1][j] + st[i - 1][j + (1 &lt;&lt; (i - 1))];\n</code></pre> <p>\u0110\u1ec3 tr\u1ea3 l\u1eddi truy v\u1ea5n t\u1ed5ng cho \u0111o\u1ea1n $[L, R]$, ch\u00fang ta l\u1eb7p l\u1ea1i t\u1ea5t c\u1ea3 c\u00e1c l\u0169y th\u1eeba c\u1ee7a hai, b\u1eaft \u0111\u1ea7u t\u1eeb l\u0169y th\u1eeba l\u1edbn nh\u1ea5t. Ngay khi l\u0169y th\u1eeba c\u1ee7a hai $2^i$ nh\u1ecf h\u01a1n ho\u1eb7c b\u1eb1ng \u0111\u1ed9 d\u00e0i c\u1ee7a \u0111o\u1ea1n ($= R - L + 1$), ch\u00fang ta x\u1eed l\u00fd ph\u1ea7n \u0111\u1ea7u ti\u00ean c\u1ee7a \u0111o\u1ea1n $[L, L + 2^i - 1]$, v\u00e0 ti\u1ebfp t\u1ee5c v\u1edbi \u0111o\u1ea1n c\u00f2n l\u1ea1i $[L + 2^i, R]$.</p> <pre><code>long long sum = 0;\nfor (int i = K; i &gt;= 0; i--) {\n    if ((1 &lt;&lt; i) &lt;= R - L + 1) {\n        sum += st[i][L];\n        L += 1 &lt;&lt; i;\n    }\n}\n</code></pre> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian cho m\u1ed9t Truy v\u1ea5n T\u1ed5ng \u0110o\u1ea1n l\u00e0 $O(K) = O(\\log \\text{MAXN})$.</p>","tags":["Original"]},{"location":"data_structures/sparse-table.html#range-minimum-queries-rmq","title":"Truy v\u1ea5n gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t trong \u0111o\u1ea1n (Range Minimum Queries - RMQ)","text":"<p>\u0110\u00e2y l\u00e0 nh\u1eefng truy v\u1ea5n m\u00e0 Sparse Table t\u1ecfa s\u00e1ng. Khi t\u00ednh to\u00e1n gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t c\u1ee7a m\u1ed9t \u0111o\u1ea1n, kh\u00f4ng quan tr\u1ecdng n\u1ebfu ch\u00fang ta x\u1eed l\u00fd m\u1ed9t gi\u00e1 tr\u1ecb trong \u0111o\u1ea1n m\u1ed9t l\u1ea7n hay hai l\u1ea7n. Do \u0111\u00f3 thay v\u00ec chia m\u1ed9t \u0111o\u1ea1n th\u00e0nh nhi\u1ec1u \u0111o\u1ea1n, ch\u00fang ta c\u0169ng c\u00f3 th\u1ec3 chia \u0111o\u1ea1n th\u00e0nh ch\u1ec9 hai \u0111o\u1ea1n ch\u1ed3ng l\u00ean nhau c\u00f3 \u0111\u1ed9 d\u00e0i l\u00e0 l\u0169y th\u1eeba c\u1ee7a hai. V\u00ed d\u1ee5: ch\u00fang ta c\u00f3 th\u1ec3 chia \u0111o\u1ea1n $[1, 6]$ th\u00e0nh c\u00e1c \u0111o\u1ea1n $[1, 4]$ v\u00e0 $[3, 6]$. Gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t trong \u0111o\u1ea1n c\u1ee7a $[1, 6]$ r\u00f5 r\u00e0ng gi\u1ed1ng nh\u01b0 gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t c\u1ee7a gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t trong \u0111o\u1ea1n c\u1ee7a $[1, 4]$ v\u00e0 gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t trong \u0111o\u1ea1n c\u1ee7a $[3, 6]$. V\u00ec v\u1eady, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh to\u00e1n gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t c\u1ee7a \u0111o\u1ea1n $[L, R]$ v\u1edbi:</p> $$\\min(\\text{st}[i][L], \\text{st}[i][R - 2^i + 1]) \\quad \\text{ trong \u0111\u00f3 } i = \\log_2(R - L + 1)$$ <p>\u0110i\u1ec1u n\u00e0y \u0111\u00f2i h\u1ecfi r\u1eb1ng ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh to\u00e1n $\\log_2(R - L + 1)$ nhanh. B\u1ea1n c\u00f3 th\u1ec3 ho\u00e0n th\u00e0nh \u0111i\u1ec1u \u0111\u00f3 b\u1eb1ng c\u00e1ch t\u00ednh to\u00e1n tr\u01b0\u1edbc t\u1ea5t c\u1ea3 c\u00e1c logarit:</p> <p><pre><code>int lg[MAXN+1];\nlg[1] = 0;\nfor (int i = 2; i &lt;= MAXN; i++)\n    lg[i] = lg[i/2] + 1;\n</code></pre> Ngo\u00e0i ra, log c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n nhanh ch\u00f3ng trong kh\u00f4ng gian v\u00e0 th\u1eddi gian h\u1eb1ng s\u1ed1: <pre><code>// C++20\n#include &lt;bit&gt;\nint log2_floor(unsigned long i) {\n    return std::bit_width(i) - 1;\n}\n\n// pre C++20\nint log2_floor(unsigned long long i) {\n    return i ? __builtin_clzll(1) - __builtin_clzll(i) : -1;\n}\n</code></pre> Benchmark n\u00e0y ch\u1ec9 ra r\u1eb1ng vi\u1ec7c s\u1eed d\u1ee5ng m\u1ea3ng <code>lg</code> ch\u1eadm h\u01a1n do l\u1ed7i b\u1ed9 nh\u1edb cache (cache misses).</p> <p>Sau \u0111\u00f3, ch\u00fang ta c\u1ea7n t\u00ednh to\u00e1n tr\u01b0\u1edbc c\u1ea5u tr\u00fac Sparse Table. L\u1ea7n n\u00e0y ch\u00fang ta \u0111\u1ecbnh ngh\u0129a $f$ v\u1edbi $f(x, y) = \\min(x, y)$.</p> <pre><code>int st[K + 1][MAXN];\n\nstd::copy(array.begin(), array.end(), st[0]);\n\nfor (int i = 1; i &lt;= K; i++)\n    for (int j = 0; j + (1 &lt;&lt; i) &lt;= N; j++)\n        st[i][j] = min(st[i - 1][j], st[i - 1][j + (1 &lt;&lt; (i - 1))]);\n</code></pre> <p>V\u00e0 gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t c\u1ee7a m\u1ed9t \u0111o\u1ea1n $[L, R]$ c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ednh b\u1eb1ng:</p> <pre><code>int i = lg[R - L + 1];\nint minimum = min(st[i][L], st[i][R - (1 &lt;&lt; i) + 1]);\n</code></pre> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian cho m\u1ed9t Truy v\u1ea5n Gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t trong \u0110o\u1ea1n l\u00e0 $O(1)$.</p>","tags":["Original"]},{"location":"data_structures/sparse-table.html#similar-data-structures-supporting-more-types-of-queries","title":"C\u00e1c c\u1ea5u tr\u00fac d\u1eef li\u1ec7u t\u01b0\u01a1ng t\u1ef1 h\u1ed7 tr\u1ee3 nhi\u1ec1u lo\u1ea1i truy v\u1ea5n h\u01a1n (Similar data structures supporting more types of queries)","text":"<p>M\u1ed9t trong nh\u1eefng \u0111i\u1ec3m y\u1ebfu ch\u00ednh c\u1ee7a c\u00e1ch ti\u1ebfp c\u1eadn $O(1)$ \u0111\u01b0\u1ee3c th\u1ea3o lu\u1eadn trong ph\u1ea7n tr\u01b0\u1edbc l\u00e0, c\u00e1ch ti\u1ebfp c\u1eadn n\u00e0y ch\u1ec9 h\u1ed7 tr\u1ee3 c\u00e1c truy v\u1ea5n c\u1ee7a h\u00e0m l\u0169y \u0111\u1eb3ng (idempotent functions). T\u1ee9c l\u00e0 n\u00f3 ho\u1ea1t \u0111\u1ed9ng t\u1ed1t cho c\u00e1c truy v\u1ea5n gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t trong \u0111o\u1ea1n, nh\u01b0ng kh\u00f4ng th\u1ec3 tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n t\u1ed5ng \u0111o\u1ea1n b\u1eb1ng ph\u01b0\u01a1ng ph\u00e1p n\u00e0y.</p> <p>C\u00f3 nh\u1eefng c\u1ea5u tr\u00fac d\u1eef li\u1ec7u t\u01b0\u01a1ng t\u1ef1 c\u00f3 th\u1ec3 x\u1eed l\u00fd b\u1ea5t k\u1ef3 lo\u1ea1i h\u00e0m k\u1ebft h\u1ee3p (associative functions) n\u00e0o v\u00e0 tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n \u0111o\u1ea1n trong $O(1)$. M\u1ed9t trong s\u1ed1 ch\u00fang \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 Disjoint Sparse Table. M\u1ed9t c\u1ea5u tr\u00fac kh\u00e1c s\u1ebd l\u00e0 Sqrt Tree.</p>","tags":["Original"]},{"location":"data_structures/sparse-table.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>SPOJ - RMQSQ</li> <li>SPOJ - THRBL</li> <li>Codechef - MSTICK</li> <li>Codechef - SEAD</li> <li>Codeforces - CGCDSSQ</li> <li>Codeforces - R2D2 and Droid Army</li> <li>Codeforces - Maximum of Maximums of Minimums</li> <li>SPOJ - Miraculous</li> <li>DevSkill - Multiplication Interval (archived)</li> <li>Codeforces - Animals and Puzzles</li> <li>Codeforces - Trains and Statistics</li> <li>SPOJ - Postering</li> <li>SPOJ - Negative Score</li> <li>SPOJ - A Famous City</li> <li>SPOJ - Diferencija</li> <li>Codeforces - Turn off the TV</li> <li>Codeforces - Map</li> <li>Codeforces - Awards for Contestants</li> <li>Codeforces - Longest Regular Bracket Sequence</li> <li>CSES - Static Range Minimum Queries</li> <li>Codeforces - Array Stabilization (GCD version)</li> </ul>","tags":["Original"]},{"location":"data_structures/sparse-table.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 178</li> <li>Translated lines: 178</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Original"]},{"location":"data_structures/sqrt-tree.html","title":"Sqrt Tree","text":"<p>Cho m\u1ed9t m\u1ea3ng $a$ ch\u1ee9a $n$ ph\u1ea7n t\u1eed v\u00e0 ph\u00e9p to\u00e1n $\\circ$ th\u1ecfa m\u00e3n t\u00ednh ch\u1ea5t k\u1ebft h\u1ee3p: $(x \\circ y) \\circ z = x \\circ (y \\circ z)$ l\u00e0 \u0111\u00fang v\u1edbi m\u1ecdi $x$, $y$, $z$.</p> <p>V\u00ec v\u1eady, c\u00e1c ph\u00e9p to\u00e1n nh\u01b0 $\\gcd$, $\\min$, $\\max$, $+$, $\\text{and}$, $\\text{or}$, $\\text{xor}$, v.v. th\u1ecfa m\u00e3n c\u00e1c \u0111i\u1ec1u ki\u1ec7n n\u00e0y.</p> <p>Ngo\u00e0i ra ch\u00fang ta c\u00f3 m\u1ed9t s\u1ed1 truy v\u1ea5n $q(l, r)$. \u0110\u1ed1i v\u1edbi m\u1ed7i truy v\u1ea5n, ch\u00fang ta c\u1ea7n t\u00ednh $a_l \\circ a_{l+1} \\circ \\dots \\circ a_r$.</p> <p>Sqrt Tree c\u00f3 th\u1ec3 x\u1eed l\u00fd c\u00e1c truy v\u1ea5n nh\u01b0 v\u1eady trong th\u1eddi gian $O(1)$ v\u1edbi th\u1eddi gian ti\u1ec1n x\u1eed l\u00fd $O(n \\cdot \\log \\log n)$ v\u00e0 b\u1ed9 nh\u1edb $O(n \\cdot \\log \\log n)$.</p>","tags":["Translated"]},{"location":"data_structures/sqrt-tree.html#description","title":"M\u00f4 t\u1ea3 (Description)","text":"","tags":["Translated"]},{"location":"data_structures/sqrt-tree.html#building-sqrt-decomposition","title":"X\u00e2y d\u1ef1ng ph\u00e2n r\u00e3 c\u0103n b\u1eadc hai (Building sqrt decomposition)","text":"<p>H\u00e3y th\u1ef1c hi\u1ec7n m\u1ed9t ph\u00e2n r\u00e3 c\u0103n b\u1eadc hai (sqrt decomposition). Ch\u00fang ta chia m\u1ea3ng c\u1ee7a m\u00ecnh th\u00e0nh $\\sqrt{n}$ kh\u1ed1i, m\u1ed7i kh\u1ed1i c\u00f3 k\u00edch th\u01b0\u1edbc $\\sqrt{n}$. \u0110\u1ed1i v\u1edbi m\u1ed7i kh\u1ed1i, ch\u00fang ta t\u00ednh to\u00e1n:</p> <ol> <li>C\u00e2u tr\u1ea3 l\u1eddi cho c\u00e1c truy v\u1ea5n n\u1eb1m trong kh\u1ed1i v\u00e0 b\u1eaft \u0111\u1ea7u \u1edf \u0111\u1ea7u kh\u1ed1i ($\\text{prefixOp}$)</li> <li>C\u00e2u tr\u1ea3 l\u1eddi cho c\u00e1c truy v\u1ea5n n\u1eb1m trong kh\u1ed1i v\u00e0 k\u1ebft th\u00fac \u1edf cu\u1ed1i kh\u1ed1i ($\\text{suffixOp}$)</li> </ol> <p>V\u00e0 ch\u00fang ta s\u1ebd t\u00ednh to\u00e1n th\u00eam m\u1ed9t m\u1ea3ng:</p> <ol> <li>$\\text{between}_{i, j}$ (v\u1edbi $i \\le j$) - c\u00e2u tr\u1ea3 l\u1eddi cho truy v\u1ea5n b\u1eaft \u0111\u1ea7u \u1edf \u0111\u1ea7u kh\u1ed1i $i$ v\u00e0 k\u1ebft th\u00fac \u1edf cu\u1ed1i kh\u1ed1i $j$. L\u01b0u \u00fd r\u1eb1ng ch\u00fang ta c\u00f3 $\\sqrt{n}$ kh\u1ed1i, v\u00ec v\u1eady k\u00edch th\u01b0\u1edbc c\u1ee7a m\u1ea3ng n\u00e0y s\u1ebd l\u00e0 $O(\\sqrt{n}^2) = O(n)$.</li> </ol> <p>H\u00e3y xem v\u00ed d\u1ee5.</p> <p>Gi\u1ea3 s\u1eed $\\circ$ l\u00e0 $+$ (ch\u00fang ta t\u00ednh t\u1ed5ng tr\u00ean m\u1ed9t \u0111o\u1ea1n) v\u00e0 ch\u00fang ta c\u00f3 m\u1ea3ng $a$ sau:</p> <p><code>{1, 2, 3, 4, 5, 6, 7, 8, 9}</code></p> <p>N\u00f3 s\u1ebd \u0111\u01b0\u1ee3c chia th\u00e0nh ba kh\u1ed1i: <code>{1, 2, 3}</code>, <code>{4, 5, 6}</code> v\u00e0 <code>{7, 8, 9}</code>.</p> <p>\u0110\u1ed1i v\u1edbi kh\u1ed1i \u0111\u1ea7u ti\u00ean $\\text{prefixOp}$ l\u00e0 <code>{1, 3, 6}</code> v\u00e0 $\\text{suffixOp}$ l\u00e0 <code>{6, 5, 3}</code>.</p> <p>\u0110\u1ed1i v\u1edbi kh\u1ed1i th\u1ee9 hai $\\text{prefixOp}$ l\u00e0 <code>{4, 9, 15}</code> v\u00e0 $\\text{suffixOp}$ l\u00e0 <code>{15, 11, 6}</code>.</p> <p>\u0110\u1ed1i v\u1edbi kh\u1ed1i th\u1ee9 ba $\\text{prefixOp}$ l\u00e0 <code>{7, 15, 24}</code> v\u00e0 $\\text{suffixOp}$ l\u00e0 <code>{24, 17, 9}</code>.</p> <p>M\u1ea3ng $\\text{between}$ l\u00e0:</p> <pre><code>{\n    {6, 21, 45},\n    {0, 15, 39},\n    {0, 0,  24}\n}\n</code></pre> <p>(ch\u00fang ta gi\u1ea3 s\u1eed r\u1eb1ng c\u00e1c ph\u1ea7n t\u1eed kh\u00f4ng h\u1ee3p l\u1ec7 n\u01a1i $i &gt; j$ \u0111\u01b0\u1ee3c \u0111i\u1ec1n b\u1eb1ng s\u1ed1 kh\u00f4ng)</p> <p>R\u00f5 r\u00e0ng \u0111\u1ec3 th\u1ea5y r\u1eb1ng c\u00e1c m\u1ea3ng n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n d\u1ec5 d\u00e0ng trong th\u1eddi gian v\u00e0 b\u1ed9 nh\u1edb $O(n)$.</p> <p>Ch\u00fang ta \u0111\u00e3 c\u00f3 th\u1ec3 tr\u1ea3 l\u1eddi m\u1ed9t s\u1ed1 truy v\u1ea5n b\u1eb1ng c\u00e1c m\u1ea3ng n\u00e0y. N\u1ebfu truy v\u1ea5n kh\u00f4ng n\u1eb1m g\u1ecdn trong m\u1ed9t kh\u1ed1i, ch\u00fang ta c\u00f3 th\u1ec3 chia n\u00f3 th\u00e0nh ba ph\u1ea7n: h\u1eadu t\u1ed1 c\u1ee7a m\u1ed9t kh\u1ed1i, sau \u0111\u00f3 l\u00e0 m\u1ed9t \u0111o\u1ea1n c\u1ee7a c\u00e1c kh\u1ed1i li\u1ec1n k\u1ec1 v\u00e0 sau \u0111\u00f3 l\u00e0 ti\u1ec1n t\u1ed1 c\u1ee7a m\u1ed9t kh\u1ed1i n\u00e0o \u0111\u00f3. Ch\u00fang ta c\u00f3 th\u1ec3 tr\u1ea3 l\u1eddi m\u1ed9t truy v\u1ea5n b\u1eb1ng c\u00e1ch chia n\u00f3 th\u00e0nh ba ph\u1ea7n v\u00e0 th\u1ef1c hi\u1ec7n ph\u00e9p to\u00e1n c\u1ee7a ch\u00fang ta v\u1edbi m\u1ed9t gi\u00e1 tr\u1ecb t\u1eeb $\\text{suffixOp}$, sau \u0111\u00f3 m\u1ed9t gi\u00e1 tr\u1ecb t\u1eeb $\\text{between}$, sau \u0111\u00f3 m\u1ed9t gi\u00e1 tr\u1ecb t\u1eeb $\\text{prefixOp}$.</p> <p>Nh\u01b0ng n\u1ebfu ch\u00fang ta c\u00f3 c\u00e1c truy v\u1ea5n n\u1eb1m ho\u00e0n to\u00e0n trong m\u1ed9t kh\u1ed1i, ch\u00fang ta kh\u00f4ng th\u1ec3 x\u1eed l\u00fd ch\u00fang b\u1eb1ng ba m\u1ea3ng n\u00e0y. V\u00ec v\u1eady, ch\u00fang ta c\u1ea7n ph\u1ea3i l\u00e0m g\u00ec \u0111\u00f3.</p>","tags":["Translated"]},{"location":"data_structures/sqrt-tree.html#making-a-tree","title":"T\u1ea1o m\u1ed9t c\u00e1i c\u00e2y (Making a tree)","text":"<p>Ch\u00fang ta kh\u00f4ng th\u1ec3 tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n n\u1eb1m ho\u00e0n to\u00e0n trong m\u1ed9t kh\u1ed1i. Nh\u01b0ng \u0111i\u1ec1u g\u00ec s\u1ebd x\u1ea3y ra n\u1ebfu ch\u00fang ta x\u00e2y d\u1ef1ng c\u00f9ng m\u1ed9t c\u1ea5u tr\u00fac nh\u01b0 m\u00f4 t\u1ea3 \u1edf tr\u00ean cho m\u1ed7i kh\u1ed1i? \u0110\u00fang v\u1eady, ch\u00fang ta c\u00f3 th\u1ec3 l\u00e0m \u0111i\u1ec1u \u0111\u00f3. V\u00e0 ch\u00fang ta l\u00e0m \u0111i\u1ec1u \u0111\u00f3 m\u1ed9t c\u00e1ch \u0111\u1ec7 quy, cho \u0111\u1ebfn khi ch\u00fang ta \u0111\u1ea1t \u0111\u1ebfn k\u00edch th\u01b0\u1edbc kh\u1ed1i l\u00e0 $1$ ho\u1eb7c $2$. C\u00e2u tr\u1ea3 l\u1eddi cho c\u00e1c kh\u1ed1i nh\u01b0 v\u1eady c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n d\u1ec5 d\u00e0ng trong $O(1)$.</p> <p>V\u00ec v\u1eady, ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c m\u1ed9t c\u00e1i c\u00e2y. M\u1ed7i n\u00fat c\u1ee7a c\u00e2y \u0111\u1ea1i di\u1ec7n cho m\u1ed9t \u0111o\u1ea1n c\u1ee7a m\u1ea3ng. N\u00fat \u0111\u1ea1i di\u1ec7n cho \u0111o\u1ea1n m\u1ea3ng c\u00f3 k\u00edch th\u01b0\u1edbc $k$ c\u00f3 $\\sqrt{k}$ con -- cho m\u1ed7i kh\u1ed1i. Ngo\u00e0i ra m\u1ed7i n\u00fat ch\u1ee9a ba m\u1ea3ng \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 \u1edf tr\u00ean cho \u0111o\u1ea1n m\u00e0 n\u00f3 ch\u1ee9a. G\u1ed1c c\u1ee7a c\u00e2y \u0111\u1ea1i di\u1ec7n cho to\u00e0n b\u1ed9 m\u1ea3ng. C\u00e1c n\u00fat c\u00f3 \u0111\u1ed9 d\u00e0i \u0111o\u1ea1n $1$ ho\u1eb7c $2$ l\u00e0 c\u00e1c l\u00e1.</p> <p>C\u0169ng r\u00f5 r\u00e0ng l\u00e0 chi\u1ec1u cao c\u1ee7a c\u00e2y n\u00e0y l\u00e0 $O(\\log \\log n)$, b\u1edfi v\u00ec n\u1ebfu m\u1ed9t \u0111\u1ec9nh n\u00e0o \u0111\u00f3 c\u1ee7a c\u00e2y \u0111\u1ea1i di\u1ec7n cho m\u1ed9t m\u1ea3ng c\u00f3 \u0111\u1ed9 d\u00e0i $k$, th\u00ec c\u00e1c con c\u1ee7a n\u00f3 c\u00f3 \u0111\u1ed9 d\u00e0i $\\sqrt{k}$. $\\log(\\sqrt{k}) = \\frac{\\log{k}}{2}$, v\u00ec v\u1eady $\\log k$ gi\u1ea3m hai l\u1ea7n m\u1ed7i l\u1edbp c\u1ee7a c\u00e2y v\u00e0 do \u0111\u00f3 chi\u1ec1u cao c\u1ee7a n\u00f3 l\u00e0 $O(\\log \\log n)$. Th\u1eddi gian x\u00e2y d\u1ef1ng v\u00e0 s\u1eed d\u1ee5ng b\u1ed9 nh\u1edb s\u1ebd l\u00e0 $O(n \\cdot \\log \\log n)$, b\u1edfi v\u00ec m\u1ed7i ph\u1ea7n t\u1eed c\u1ee7a m\u1ea3ng xu\u1ea5t hi\u1ec7n ch\u00ednh x\u00e1c m\u1ed9t l\u1ea7n tr\u00ean m\u1ed7i l\u1edbp c\u1ee7a c\u00e2y.</p> <p>B\u00e2y gi\u1edd ch\u00fang ta c\u00f3 th\u1ec3 tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n trong $O(\\log \\log n)$. Ch\u00fang ta c\u00f3 th\u1ec3 \u0111i xu\u1ed1ng c\u00e2y cho \u0111\u1ebfn khi g\u1eb7p m\u1ed9t \u0111o\u1ea1n c\u00f3 \u0111\u1ed9 d\u00e0i $1$ ho\u1eb7c $2$ (c\u00e2u tr\u1ea3 l\u1eddi cho n\u00f3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ednh trong th\u1eddi gian $O(1)$) ho\u1eb7c g\u1eb7p \u0111o\u1ea1n \u0111\u1ea7u ti\u00ean m\u00e0 truy v\u1ea5n c\u1ee7a ch\u00fang ta kh\u00f4ng n\u1eb1m g\u1ecdn ho\u00e0n to\u00e0n trong m\u1ed9t kh\u1ed1i. Xem ph\u1ea7n \u0111\u1ea7u ti\u00ean v\u1ec1 c\u00e1ch tr\u1ea3 l\u1eddi truy v\u1ea5n trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y.</p> <p>OK, b\u00e2y gi\u1edd ch\u00fang ta c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n $O(\\log \\log n)$ m\u1ed7i truy v\u1ea5n. C\u00f3 th\u1ec3 l\u00e0m nhanh h\u01a1n kh\u00f4ng?</p>","tags":["Translated"]},{"location":"data_structures/sqrt-tree.html#optimizing-the-query-complexity","title":"T\u1ed1i \u01b0u h\u00f3a \u0111\u1ed9 ph\u1ee9c t\u1ea1p truy v\u1ea5n (Optimizing the query complexity)","text":"<p>M\u1ed9t trong nh\u1eefng t\u1ed1i \u01b0u h\u00f3a r\u00f5 r\u00e0ng nh\u1ea5t l\u00e0 t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n n\u00fat c\u00e2y ch\u00fang ta c\u1ea7n. S\u1eed d\u1ee5ng t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n, ch\u00fang ta c\u00f3 th\u1ec3 \u0111\u1ea1t \u0111\u01b0\u1ee3c \u0111\u1ed9 ph\u1ee9c t\u1ea1p $O(\\log \\log \\log n)$ m\u1ed7i truy v\u1ea5n. Ch\u00fang ta c\u00f3 th\u1ec3 l\u00e0m nhanh h\u01a1n n\u1eefa kh\u00f4ng?</p> <p>C\u00e2u tr\u1ea3 l\u1eddi l\u00e0 c\u00f3. H\u00e3y gi\u1ea3 s\u1eed hai \u0111i\u1ec1u sau:</p> <ol> <li>K\u00edch th\u01b0\u1edbc m\u1ed7i kh\u1ed1i l\u00e0 m\u1ed9t l\u0169y th\u1eeba c\u1ee7a hai.</li> <li>T\u1ea5t c\u1ea3 c\u00e1c kh\u1ed1i \u0111\u1ec1u b\u1eb1ng nhau tr\u00ean m\u1ed7i l\u1edbp.</li> </ol> <p>\u0110\u1ec3 \u0111\u1ea1t \u0111\u01b0\u1ee3c \u0111i\u1ec1u n\u00e0y, ch\u00fang ta c\u00f3 th\u1ec3 th\u00eam m\u1ed9t s\u1ed1 ph\u1ea7n t\u1eed zero v\u00e0o m\u1ea3ng c\u1ee7a m\u00ecnh \u0111\u1ec3 k\u00edch th\u01b0\u1edbc c\u1ee7a n\u00f3 tr\u1edf th\u00e0nh l\u0169y th\u1eeba c\u1ee7a hai.</p> <p>Khi ch\u00fang ta s\u1eed d\u1ee5ng \u0111i\u1ec1u n\u00e0y, k\u00edch th\u01b0\u1edbc m\u1ed9t s\u1ed1 kh\u1ed1i c\u00f3 th\u1ec3 tr\u1edf n\u00ean l\u1edbn g\u1ea5p \u0111\u00f4i \u0111\u1ec3 tr\u1edf th\u00e0nh l\u0169y th\u1eeba c\u1ee7a hai, nh\u01b0ng n\u00f3 v\u1eabn c\u00f3 k\u00edch th\u01b0\u1edbc $O(\\sqrt{k})$ v\u00e0 ch\u00fang ta gi\u1eef \u0111\u1ed9 ph\u1ee9c t\u1ea1p tuy\u1ebfn t\u00ednh \u0111\u1ec3 x\u00e2y d\u1ef1ng c\u00e1c m\u1ea3ng trong m\u1ed9t \u0111o\u1ea1n.</p> <p>B\u00e2y gi\u1edd, ch\u00fang ta c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng ki\u1ec3m tra xem truy v\u1ea5n c\u00f3 n\u1eb1m ho\u00e0n to\u00e0n trong m\u1ed9t kh\u1ed1i c\u00f3 k\u00edch th\u01b0\u1edbc $2^k$ hay kh\u00f4ng. H\u00e3y vi\u1ebft c\u00e1c ph\u1ea1m vi c\u1ee7a truy v\u1ea5n, $l$ v\u00e0 $r$ (ch\u00fang ta s\u1eed d\u1ee5ng ch\u1ec9 s\u1ed1 0) d\u01b0\u1edbi d\u1ea1ng nh\u1ecb ph\u00e2n. V\u00ed d\u1ee5: gi\u1ea3 s\u1eed $k=4, l=39, r=46$. Bi\u1ec3u di\u1ec5n nh\u1ecb ph\u00e2n c\u1ee7a $l$ v\u00e0 $r$ l\u00e0:</p> <p>$l = 39_{10} = 100111_2$</p> <p>$r = 46_{10} = 101110_2$</p> <p>H\u00e3y nh\u1edb r\u1eb1ng m\u1ed9t l\u1edbp ch\u1ee9a c\u00e1c \u0111o\u1ea1n c\u00f3 k\u00edch th\u01b0\u1edbc b\u1eb1ng nhau, v\u00e0 kh\u1ed1i tr\u00ean m\u1ed9t l\u1edbp c\u0169ng c\u00f3 k\u00edch th\u01b0\u1edbc b\u1eb1ng nhau (trong tr\u01b0\u1eddng h\u1ee3p c\u1ee7a ch\u00fang ta, k\u00edch th\u01b0\u1edbc c\u1ee7a ch\u00fang l\u00e0 $2^k = 2^4 = 16$. C\u00e1c kh\u1ed1i bao ph\u1ee7 m\u1ea3ng ho\u00e0n to\u00e0n, v\u00ec v\u1eady kh\u1ed1i \u0111\u1ea7u ti\u00ean bao ph\u1ee7 c\u00e1c ph\u1ea7n t\u1eed $(0 - 15)$ ($(000000_2 - 001111_2)$ trong h\u1ec7 nh\u1ecb ph\u00e2n), kh\u1ed1i th\u1ee9 hai bao ph\u1ee7 c\u00e1c ph\u1ea7n t\u1eed $(16 - 31)$ ($(010000_2 - 011111_2)$ trong h\u1ec7 nh\u1ecb ph\u00e2n) v\u00e0 c\u1ee9 th\u1ebf. Ch\u00fang ta th\u1ea5y r\u1eb1ng c\u00e1c ch\u1ec9 s\u1ed1 c\u1ee7a c\u00e1c v\u1ecb tr\u00ed \u0111\u01b0\u1ee3c bao ph\u1ee7 b\u1edfi m\u1ed9t kh\u1ed1i c\u00f3 th\u1ec3 ch\u1ec9 kh\u00e1c nhau \u1edf $k$ bit cu\u1ed1i c\u00f9ng (trong tr\u01b0\u1eddng h\u1ee3p c\u1ee7a ch\u00fang ta l\u00e0 $4$). Trong tr\u01b0\u1eddng h\u1ee3p c\u1ee7a ch\u00fang ta $l$ v\u00e0 $r$ c\u00f3 c\u00e1c bit b\u1eb1ng nhau ngo\u1ea1i tr\u1eeb b\u1ed1n bit th\u1ea5p nh\u1ea5t, v\u00ec v\u1eady ch\u00fang n\u1eb1m trong m\u1ed9t kh\u1ed1i.</p> <p>V\u00ec v\u1eady, ch\u00fang ta c\u1ea7n ki\u1ec3m tra xem kh\u00f4ng c\u00f3 g\u00ec nhi\u1ec1u h\u01a1n $k$ bit nh\u1ecf nh\u1ea5t kh\u00e1c nhau (ho\u1eb7c $l\\ \\text{xor}\\ r$ kh\u00f4ng v\u01b0\u1ee3t qu\u00e1 $2^k-1$).</p> <p>S\u1eed d\u1ee5ng quan s\u00e1t n\u00e0y, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm th\u1ea5y m\u1ed9t l\u1edbp ph\u00f9 h\u1ee3p \u0111\u1ec3 tr\u1ea3 l\u1eddi truy v\u1ea5n m\u1ed9t c\u00e1ch nhanh ch\u00f3ng. C\u00e1ch l\u00e0m \u0111i\u1ec1u n\u00e0y:</p> <ol> <li> <p>\u0110\u1ed1i v\u1edbi m\u1ed7i $i$ kh\u00f4ng v\u01b0\u1ee3t qu\u00e1 k\u00edch th\u01b0\u1edbc m\u1ea3ng, ch\u00fang ta t\u00ecm bit cao nh\u1ea5t b\u1eb1ng $1$. \u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y nhanh ch\u00f3ng, ch\u00fang ta s\u1eed d\u1ee5ng DP v\u00e0 m\u1ed9t m\u1ea3ng \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n tr\u01b0\u1edbc.</p> </li> <li> <p>B\u00e2y gi\u1edd, \u0111\u1ed1i v\u1edbi m\u1ed7i $q(l, r)$ ch\u00fang ta t\u00ecm bit cao nh\u1ea5t c\u1ee7a $l\\ \\text{xor}\\ r$ v\u00e0, s\u1eed d\u1ee5ng th\u00f4ng tin n\u00e0y, th\u1eadt d\u1ec5 d\u00e0ng \u0111\u1ec3 ch\u1ecdn l\u1edbp m\u00e0 ch\u00fang ta c\u00f3 th\u1ec3 x\u1eed l\u00fd truy v\u1ea5n m\u1ed9t c\u00e1ch d\u1ec5 d\u00e0ng. Ch\u00fang ta c\u0169ng c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng m\u1ed9t m\u1ea3ng \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n tr\u01b0\u1edbc \u1edf \u0111\u00e2y.</p> </li> </ol> <p>\u0110\u1ec3 bi\u1ebft th\u00eam chi ti\u1ebft, h\u00e3y xem m\u00e3 b\u00ean d\u01b0\u1edbi.</p> <p>V\u00ec v\u1eady, s\u1eed d\u1ee5ng \u0111i\u1ec1u n\u00e0y, ch\u00fang ta c\u00f3 th\u1ec3 tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n trong $O(1)$ m\u1ed7i truy v\u1ea5n. Hoan h\u00f4! :)</p>","tags":["Translated"]},{"location":"data_structures/sqrt-tree.html#updating-elements","title":"C\u1eadp nh\u1eadt c\u00e1c ph\u1ea7n t\u1eed (Updating elements)","text":"<p>Ch\u00fang ta c\u0169ng c\u00f3 th\u1ec3 c\u1eadp nh\u1eadt c\u00e1c ph\u1ea7n t\u1eed trong Sqrt Tree. C\u1ea3 c\u1eadp nh\u1eadt ph\u1ea7n t\u1eed \u0111\u01a1n l\u1ebb v\u00e0 c\u1eadp nh\u1eadt tr\u00ean m\u1ed9t \u0111o\u1ea1n \u0111\u1ec1u \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3.</p>","tags":["Translated"]},{"location":"data_structures/sqrt-tree.html#updating-a-single-element","title":"C\u1eadp nh\u1eadt m\u1ed9t ph\u1ea7n t\u1eed \u0111\u01a1n l\u1ebb (Updating a single element)","text":"<p>Xem x\u00e9t m\u1ed9t truy v\u1ea5n $\\text{update}(x, val)$ th\u1ef1c hi\u1ec7n ph\u00e9p g\u00e1n $a_x = val$. Ch\u00fang ta c\u1ea7n th\u1ef1c hi\u1ec7n truy v\u1ea5n n\u00e0y \u0111\u1ee7 nhanh.</p>","tags":["Translated"]},{"location":"data_structures/sqrt-tree.html#naive-approach","title":"C\u00e1ch ti\u1ebfp c\u1eadn ng\u00e2y th\u01a1 (Naive approach)","text":"<p>\u0110\u1ea7u ti\u00ean, h\u00e3y xem nh\u1eefng g\u00ec thay \u0111\u1ed5i trong c\u00e2y khi m\u1ed9t ph\u1ea7n t\u1eed \u0111\u01a1n l\u1ebb thay \u0111\u1ed5i. Xem x\u00e9t m\u1ed9t n\u00fat c\u00e2y c\u00f3 \u0111\u1ed9 d\u00e0i $l$ v\u00e0 c\u00e1c m\u1ea3ng c\u1ee7a n\u00f3: $\\text{prefixOp}$, $\\text{suffixOp}$ v\u00e0 $\\text{between}$. D\u1ec5 th\u1ea5y r\u1eb1ng ch\u1ec9 c\u00f3 $O(\\sqrt{l})$ ph\u1ea7n t\u1eed t\u1eeb $\\text{prefixOp}$ v\u00e0 $\\text{suffixOp}$ thay \u0111\u1ed5i (ch\u1ec9 b\u00ean trong kh\u1ed1i v\u1edbi ph\u1ea7n t\u1eed \u0111\u00e3 thay \u0111\u1ed5i). $O(l)$ ph\u1ea7n t\u1eed \u0111\u01b0\u1ee3c thay \u0111\u1ed5i trong $\\text{between}$. Do \u0111\u00f3, $O(l)$ ph\u1ea7n t\u1eed trong n\u00fat c\u00e2y \u0111\u01b0\u1ee3c c\u1eadp nh\u1eadt.</p> <p>Ch\u00fang ta nh\u1edb r\u1eb1ng b\u1ea5t k\u1ef3 ph\u1ea7n t\u1eed $x$ n\u00e0o c\u0169ng hi\u1ec7n di\u1ec7n trong ch\u00ednh x\u00e1c m\u1ed9t n\u00fat c\u00e2y \u1edf m\u1ed7i l\u1edbp. N\u00fat g\u1ed1c (l\u1edbp $0$) c\u00f3 \u0111\u1ed9 d\u00e0i $O(n)$, c\u00e1c n\u00fat tr\u00ean l\u1edbp $1$ c\u00f3 \u0111\u1ed9 d\u00e0i $O(\\sqrt{n})$, c\u00e1c n\u00fat tr\u00ean l\u1edbp $2$ c\u00f3 \u0111\u1ed9 d\u00e0i $O(\\sqrt{\\sqrt{n}})$, v.v. V\u00ec v\u1eady, \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian cho m\u1ed7i l\u1ea7n c\u1eadp nh\u1eadt l\u00e0 $O(n + \\sqrt{n} + \\sqrt{\\sqrt{n}} + \\dots) = O(n)$.</p> <p>Nh\u01b0ng n\u00f3 qu\u00e1 ch\u1eadm. C\u00f3 th\u1ec3 l\u00e0m nhanh h\u01a1n kh\u00f4ng?</p>","tags":["Translated"]},{"location":"data_structures/sqrt-tree.html#an-sqrt-tree-inside-the-sqrt-tree","title":"M\u1ed9t sqrt-tree b\u00ean trong sqrt-tree (An sqrt-tree inside the sqrt-tree)","text":"<p>L\u01b0u \u00fd r\u1eb1ng n\u00fat th\u1eaft c\u1ed5 chai c\u1ee7a vi\u1ec7c c\u1eadp nh\u1eadt l\u00e0 x\u00e2y d\u1ef1ng l\u1ea1i $\\text{between}$ c\u1ee7a n\u00fat g\u1ed1c. \u0110\u1ec3 t\u1ed1i \u01b0u h\u00f3a c\u00e2y, h\u00e3y lo\u1ea1i b\u1ecf m\u1ea3ng n\u00e0y! Thay v\u00ec m\u1ea3ng $\\text{between}$, ch\u00fang ta l\u01b0u tr\u1eef m\u1ed9t sqrt-tree kh\u00e1c cho n\u00fat g\u1ed1c. H\u00e3y g\u1ecdi n\u00f3 l\u00e0 $\\text{index}$. N\u00f3 \u0111\u00f3ng vai tr\u00f2 t\u01b0\u01a1ng t\u1ef1 nh\u01b0 $\\text{between}$\u2014 tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n tr\u00ean c\u00e1c \u0111o\u1ea1n c\u1ee7a c\u00e1c kh\u1ed1i. L\u01b0u \u00fd r\u1eb1ng c\u00e1c n\u00fat c\u00e2y c\u00f2n l\u1ea1i kh\u00f4ng c\u00f3 $\\text{index}$, ch\u00fang gi\u1eef c\u00e1c m\u1ea3ng $\\text{between}$ c\u1ee7a m\u00ecnh.</p> <p>M\u1ed9t sqrt-tree \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 \u0111\u01b0\u1ee3c l\u1eadp ch\u1ec9 m\u1ee5c (indexed), n\u1ebfu n\u00fat g\u1ed1c c\u1ee7a n\u00f3 c\u00f3 $\\text{index}$. M\u1ed9t sqrt-tree v\u1edbi m\u1ea3ng $\\text{between}$ trong n\u00fat g\u1ed1c c\u1ee7a n\u00f3 l\u00e0 kh\u00f4ng \u0111\u01b0\u1ee3c l\u1eadp ch\u1ec9 m\u1ee5c (unindexed). L\u01b0u \u00fd r\u1eb1ng $\\text{index}$ b\u1ea3n th\u00e2n n\u00f3 l\u00e0 kh\u00f4ng \u0111\u01b0\u1ee3c l\u1eadp ch\u1ec9 m\u1ee5c.</p> <p>V\u00ec v\u1eady, ch\u00fang ta c\u00f3 thu\u1eadt to\u00e1n sau \u0111\u1ec3 c\u1eadp nh\u1eadt m\u1ed9t c\u00e2y \u0111\u01b0\u1ee3c l\u1eadp ch\u1ec9 m\u1ee5c:</p> <ul> <li> <p>C\u1eadp nh\u1eadt $\\text{prefixOp}$ v\u00e0 $\\text{suffixOp}$ trong $O(\\sqrt{n})$.</p> </li> <li> <p>C\u1eadp nh\u1eadt $\\text{index}$. N\u00f3 c\u00f3 \u0111\u1ed9 d\u00e0i $O(\\sqrt{n})$ v\u00e0 ch\u00fang ta ch\u1ec9 c\u1ea7n c\u1eadp nh\u1eadt m\u1ed9t m\u1ee5c trong \u0111\u00f3 (m\u1ee5c \u0111\u1ea1i di\u1ec7n cho kh\u1ed1i \u0111\u00e3 thay \u0111\u1ed5i). V\u00ec v\u1eady, \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian cho b\u01b0\u1edbc n\u00e0y l\u00e0 $O(\\sqrt{n})$. Ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 \u1edf \u0111\u1ea7u ph\u1ea7n n\u00e0y (thu\u1eadt to\u00e1n \"ch\u1eadm\") \u0111\u1ec3 l\u00e0m \u0111i\u1ec1u \u0111\u00f3.</p> </li> <li> <p>\u0110i v\u00e0o n\u00fat con \u0111\u1ea1i di\u1ec7n cho kh\u1ed1i \u0111\u00e3 thay \u0111\u1ed5i v\u00e0 c\u1eadp nh\u1eadt n\u00f3 trong $O(\\sqrt{n})$ b\u1eb1ng thu\u1eadt to\u00e1n \"ch\u1eadm\".</p> </li> </ul> <p>L\u01b0u \u00fd r\u1eb1ng \u0111\u1ed9 ph\u1ee9c t\u1ea1p truy v\u1ea5n v\u1eabn l\u00e0 $O(1)$: ch\u00fang ta c\u1ea7n s\u1eed d\u1ee5ng $\\text{index}$ trong truy v\u1ea5n kh\u00f4ng qu\u00e1 m\u1ed9t l\u1ea7n, v\u00e0 \u0111i\u1ec1u n\u00e0y s\u1ebd m\u1ea5t th\u1eddi gian $O(1)$.</p> <p>V\u00ec v\u1eady, t\u1ed5ng \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian \u0111\u1ec3 c\u1eadp nh\u1eadt m\u1ed9t ph\u1ea7n t\u1eed \u0111\u01a1n l\u1ebb l\u00e0 $O(\\sqrt{n})$. Hoan h\u00f4! :)</p>","tags":["Translated"]},{"location":"data_structures/sqrt-tree.html#updating-a-segment","title":"C\u1eadp nh\u1eadt m\u1ed9t \u0111o\u1ea1n (Updating a segment)","text":"<p>Sqrt-tree c\u0169ng c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n nh\u1eefng vi\u1ec7c nh\u01b0 g\u00e1n m\u1ed9t ph\u1ea7n t\u1eed tr\u00ean m\u1ed9t \u0111o\u1ea1n. $\\text{massUpdate}(x, l, r)$ c\u00f3 ngh\u0129a l\u00e0 $a_i = x$ cho t\u1ea5t c\u1ea3 $l \\le i \\le r$.</p> <p>C\u00f3 hai c\u00e1ch ti\u1ebfp c\u1eadn \u0111\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y: m\u1ed9t trong s\u1ed1 ch\u00fang th\u1ef1c hi\u1ec7n $\\text{massUpdate}$ trong $O(\\sqrt{n}\\cdot \\log \\log n)$, gi\u1eef $O(1)$ cho m\u1ed7i truy v\u1ea5n. C\u00e1ch th\u1ee9 hai th\u1ef1c hi\u1ec7n $\\text{massUpdate}$ trong $O(\\sqrt{n})$, nh\u01b0ng \u0111\u1ed9 ph\u1ee9c t\u1ea1p truy v\u1ea5n tr\u1edf th\u00e0nh $O(\\log \\log n)$.</p> <p>Ch\u00fang ta s\u1ebd th\u1ef1c hi\u1ec7n lazy propagation theo c\u00f9ng m\u1ed9t c\u00e1ch nh\u01b0 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong segment trees: ch\u00fang ta \u0111\u00e1nh d\u1ea5u m\u1ed9t s\u1ed1 n\u00fat l\u00e0 lazy, ngh\u0129a l\u00e0 ch\u00fang ta s\u1ebd \u0111\u1ea9y ch\u00fang khi c\u1ea7n thi\u1ebft. Nh\u01b0ng c\u00f3 m\u1ed9t \u0111i\u1ec1u kh\u00e1c v\u1edbi segment trees: \u0111\u1ea9y m\u1ed9t n\u00fat r\u1ea5t t\u1ed1n k\u00e9m, v\u00ec v\u1eady n\u00f3 kh\u00f4ng th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong c\u00e1c truy v\u1ea5n. Tr\u00ean l\u1edbp $0$, \u0111\u1ea9y m\u1ed9t n\u00fat m\u1ea5t th\u1eddi gian $O(\\sqrt{n})$. V\u00ec v\u1eady, ch\u00fang ta kh\u00f4ng \u0111\u1ea9y c\u00e1c n\u00fat b\u00ean trong c\u00e1c truy v\u1ea5n, ch\u00fang ta ch\u1ec9 xem li\u1ec7u n\u00fat hi\u1ec7n t\u1ea1i ho\u1eb7c cha c\u1ee7a n\u00f3 c\u00f3 lazy hay kh\u00f4ng, v\u00e0 ch\u1ec9 t\u00ednh \u0111\u1ebfn n\u00f3 trong khi th\u1ef1c hi\u1ec7n c\u00e1c truy v\u1ea5n.</p>","tags":["Translated"]},{"location":"data_structures/sqrt-tree.html#first-approach","title":"C\u00e1ch ti\u1ebfp c\u1eadn \u0111\u1ea7u ti\u00ean (First approach)","text":"<p>Trong c\u00e1ch ti\u1ebfp c\u1eadn \u0111\u1ea7u ti\u00ean, ch\u00fang ta n\u00f3i r\u1eb1ng ch\u1ec9 c\u00e1c n\u00fat tr\u00ean l\u1edbp $1$ (v\u1edbi \u0111\u1ed9 d\u00e0i $O(\\sqrt{n}$) c\u00f3 th\u1ec3 l\u00e0 lazy. Khi \u0111\u1ea9y m\u1ed9t n\u00fat nh\u01b0 v\u1eady, n\u00f3 c\u1eadp nh\u1eadt t\u1ea5t c\u1ea3 c\u00e2y con c\u1ee7a n\u00f3 bao g\u1ed3m ch\u00ednh n\u00f3 trong $O(\\sqrt{n}\\cdot \\log \\log n)$. Qu\u00e1 tr\u00ecnh $\\text{massUpdate}$ \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n nh\u01b0 sau:</p> <ul> <li> <p>Xem x\u00e9t c\u00e1c n\u00fat tr\u00ean l\u1edbp $1$ v\u00e0 c\u00e1c kh\u1ed1i t\u01b0\u01a1ng \u1ee9ng v\u1edbi ch\u00fang.</p> </li> <li> <p>M\u1ed9t s\u1ed1 kh\u1ed1i \u0111\u01b0\u1ee3c bao ph\u1ee7 ho\u00e0n to\u00e0n b\u1edfi $\\text{massUpdate}$. \u0110\u00e1nh d\u1ea5u ch\u00fang l\u00e0 lazy trong $O(\\sqrt{n})$.</p> </li> <li> <p>M\u1ed9t s\u1ed1 kh\u1ed1i \u0111\u01b0\u1ee3c bao ph\u1ee7 m\u1ed9t ph\u1ea7n. L\u01b0u \u00fd r\u1eb1ng kh\u00f4ng c\u00f3 qu\u00e1 hai kh\u1ed1i lo\u1ea1i n\u00e0y. X\u00e2y d\u1ef1ng l\u1ea1i ch\u00fang trong $O(\\sqrt{n}\\cdot \\log \\log n)$. N\u1ebfu ch\u00fang l\u00e0 lazy, h\u00e3y t\u00ednh \u0111\u1ebfn n\u00f3.</p> </li> <li> <p>C\u1eadp nh\u1eadt $\\text{prefixOp}$ v\u00e0 $\\text{suffixOp}$ cho c\u00e1c kh\u1ed1i \u0111\u01b0\u1ee3c bao ph\u1ee7 m\u1ed9t ph\u1ea7n trong $O(\\sqrt{n})$ (b\u1edfi v\u00ec ch\u1ec9 c\u00f3 hai kh\u1ed1i nh\u01b0 v\u1eady).</p> </li> <li> <p>X\u00e2y d\u1ef1ng l\u1ea1i $\\text{index}$ trong $O(\\sqrt{n}\\cdot \\log \\log n)$.</p> </li> </ul> <p>V\u00ec v\u1eady, ch\u00fang ta c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n $\\text{massUpdate}$ nhanh ch\u00f3ng. Nh\u01b0ng lazy propagation \u1ea3nh h\u01b0\u1edfng \u0111\u1ebfn c\u00e1c truy v\u1ea5n nh\u01b0 th\u1ebf n\u00e0o? Ch\u00fang s\u1ebd c\u00f3 c\u00e1c s\u1eeda \u0111\u1ed5i sau:</p> <ul> <li> <p>N\u1ebfu truy v\u1ea5n c\u1ee7a ch\u00fang ta n\u1eb1m ho\u00e0n to\u00e0n trong m\u1ed9t kh\u1ed1i lazy, h\u00e3y t\u00ednh to\u00e1n n\u00f3 v\u00e0 t\u00ednh \u0111\u1ebfn lazy. $O(1)$.</p> </li> <li> <p>N\u1ebfu truy v\u1ea5n c\u1ee7a ch\u00fang ta bao g\u1ed3m nhi\u1ec1u kh\u1ed1i, m\u1ed9t s\u1ed1 trong \u0111\u00f3 l\u00e0 lazy, ch\u00fang ta ch\u1ec9 c\u1ea7n quan t\u00e2m \u0111\u1ebfn lazy tr\u00ean kh\u1ed1i ngo\u00e0i c\u00f9ng b\u00ean tr\u00e1i v\u00e0 ngo\u00e0i c\u00f9ng b\u00ean ph\u1ea3i. C\u00e1c kh\u1ed1i c\u00f2n l\u1ea1i \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng $\\text{index}$, v\u1ed1n \u0111\u00e3 bi\u1ebft c\u00e2u tr\u1ea3 l\u1eddi tr\u00ean kh\u1ed1i lazy (v\u00ec n\u00f3 \u0111\u01b0\u1ee3c x\u00e2y d\u1ef1ng l\u1ea1i sau m\u1ed7i l\u1ea7n s\u1eeda \u0111\u1ed5i). $O(1)$.</p> </li> </ul> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p truy v\u1ea5n v\u1eabn l\u00e0 $O(1)$.</p>","tags":["Translated"]},{"location":"data_structures/sqrt-tree.html#second-approach","title":"C\u00e1ch ti\u1ebfp c\u1eadn th\u1ee9 hai (Second approach)","text":"<p>Trong c\u00e1ch ti\u1ebfp c\u1eadn n\u00e0y, m\u1ed7i n\u00fat c\u00f3 th\u1ec3 l\u00e0 lazy (tr\u1eeb g\u1ed1c). Ngay c\u1ea3 c\u00e1c n\u00fat trong $\\text{index}$ c\u0169ng c\u00f3 th\u1ec3 l\u00e0 lazy. V\u00ec v\u1eady, trong khi x\u1eed l\u00fd m\u1ed9t truy v\u1ea5n, ch\u00fang ta ph\u1ea3i t\u00ecm c\u00e1c th\u1ebb lazy trong t\u1ea5t c\u1ea3 c\u00e1c n\u00fat cha, t\u1ee9c l\u00e0 \u0111\u1ed9 ph\u1ee9c t\u1ea1p truy v\u1ea5n s\u1ebd l\u00e0 $O(\\log \\log n)$.</p> <p>Nh\u01b0ng $\\text{massUpdate}$ tr\u1edf n\u00ean nhanh h\u01a1n. N\u00f3 tr\u00f4ng nh\u01b0 sau:</p> <ul> <li> <p>M\u1ed9t s\u1ed1 kh\u1ed1i \u0111\u01b0\u1ee3c bao ph\u1ee7 ho\u00e0n to\u00e0n v\u1edbi $\\text{massUpdate}$. V\u00ec v\u1eady, c\u00e1c th\u1ebb lazy \u0111\u01b0\u1ee3c th\u00eam v\u00e0o ch\u00fang. \u0110\u00f3 l\u00e0 $O(\\sqrt{n})$.</p> </li> <li> <p>C\u1eadp nh\u1eadt $\\text{prefixOp}$ v\u00e0 $\\text{suffixOp}$ cho c\u00e1c kh\u1ed1i \u0111\u01b0\u1ee3c bao ph\u1ee7 m\u1ed9t ph\u1ea7n trong $O(\\sqrt{n})$ (b\u1edfi v\u00ec ch\u1ec9 c\u00f3 hai kh\u1ed1i nh\u01b0 v\u1eady).</p> </li> <li> <p>\u0110\u1eebng qu\u00ean c\u1eadp nh\u1eadt index. \u0110\u00f3 l\u00e0 $O(\\sqrt{n})$ (ch\u00fang ta s\u1eed d\u1ee5ng c\u00f9ng m\u1ed9t thu\u1eadt to\u00e1n $\\text{massUpdate}$).</p> </li> <li> <p>C\u1eadp nh\u1eadt m\u1ea3ng $\\text{between}$ cho c\u00e1c c\u00e2y con unindexed.</p> </li> <li> <p>\u0110i v\u00e0o c\u00e1c n\u00fat \u0111\u1ea1i di\u1ec7n cho c\u00e1c kh\u1ed1i \u0111\u01b0\u1ee3c bao ph\u1ee7 m\u1ed9t ph\u1ea7n v\u00e0 g\u1ecdi $\\text{massUpdate}$ m\u1ed9t c\u00e1ch \u0111\u1ec7 quy.</p> </li> </ul> <p>L\u01b0u \u00fd r\u1eb1ng khi ch\u00fang ta th\u1ef1c hi\u1ec7n cu\u1ed9c g\u1ecdi \u0111\u1ec7 quy, ch\u00fang ta th\u1ef1c hi\u1ec7n $\\text{massUpdate}$ ti\u1ec1n t\u1ed1 ho\u1eb7c h\u1eadu t\u1ed1. Nh\u01b0ng \u0111\u1ed1i v\u1edbi c\u00e1c c\u1eadp nh\u1eadt ti\u1ec1n t\u1ed1 v\u00e0 h\u1eadu t\u1ed1, ch\u00fang ta kh\u00f4ng th\u1ec3 c\u00f3 qu\u00e1 m\u1ed9t con \u0111\u01b0\u1ee3c bao ph\u1ee7 m\u1ed9t ph\u1ea7n. V\u00ec v\u1eady, ch\u00fang ta truy c\u1eadp m\u1ed9t n\u00fat tr\u00ean l\u1edbp $1$, hai n\u00fat tr\u00ean l\u1edbp $2$ v\u00e0 hai n\u00fat tr\u00ean b\u1ea5t k\u1ef3 c\u1ea5p \u0111\u1ed9 s\u00e2u h\u01a1n n\u00e0o. V\u00ec v\u1eady, \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian l\u00e0 $O(\\sqrt{n} + \\sqrt{\\sqrt{n}} + \\dots) = O(\\sqrt{n})$. C\u00e1ch ti\u1ebfp c\u1eadn \u1edf \u0111\u00e2y t\u01b0\u01a1ng t\u1ef1 nh\u01b0 c\u1eadp nh\u1eadt h\u00e0ng lo\u1ea1t segment tree.</p>","tags":["Translated"]},{"location":"data_structures/sqrt-tree.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>Vi\u1ec7c c\u00e0i \u0111\u1eb7t sau \u0111\u00e2y c\u1ee7a Sqrt Tree c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n c\u00e1c thao t\u00e1c sau: x\u00e2y d\u1ef1ng trong $O(n \\cdot \\log \\log n)$, tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n trong $O(1)$ v\u00e0 c\u1eadp nh\u1eadt m\u1ed9t ph\u1ea7n t\u1eed trong $O(\\sqrt{n})$.</p> <pre><code>SqrtTreeItem op(const SqrtTreeItem &amp;a, const SqrtTreeItem &amp;b);\n\ninline int log2Up(int n) {\n    int res = 0;\n    while ((1 &lt;&lt; res) &lt; n) {\n        res++;\n    }\n    return res;\n}\n\nclass SqrtTree {\nprivate:\n    int n, lg, indexSz;\n    vector&lt;SqrtTreeItem&gt; v;\n    vector&lt;int&gt; clz, layers, onLayer;\n    vector&lt; vector&lt;SqrtTreeItem&gt; &gt; pref, suf, between;\n\n    inline void buildBlock(int layer, int l, int r) {\n        pref[layer][l] = v[l];\n        for (int i = l+1; i &lt; r; i++) {\n            pref[layer][i] = op(pref[layer][i-1], v[i]);\n        }\n        suf[layer][r-1] = v[r-1];\n        for (int i = r-2; i &gt;= l; i--) {\n            suf[layer][i] = op(v[i], suf[layer][i+1]);\n        }\n    }\n\n    inline void buildBetween(int layer, int lBound, int rBound, int betweenOffs) {\n        int bSzLog = (layers[layer]+1) &gt;&gt; 1;\n        int bCntLog = layers[layer] &gt;&gt; 1;\n        int bSz = 1 &lt;&lt; bSzLog;\n        int bCnt = (rBound - lBound + bSz - 1) &gt;&gt; bSzLog;\n        for (int i = 0; i &lt; bCnt; i++) {\n            SqrtTreeItem ans;\n            for (int j = i; j &lt; bCnt; j++) {\n                SqrtTreeItem add = suf[layer][lBound + (j &lt;&lt; bSzLog)];\n                ans = (i == j) ? add : op(ans, add);\n                between[layer-1][betweenOffs + lBound + (i &lt;&lt; bCntLog) + j] = ans;\n            }\n        }\n    }\n\n    inline void buildBetweenZero() {\n        int bSzLog = (lg+1) &gt;&gt; 1;\n        for (int i = 0; i &lt; indexSz; i++) {\n            v[n+i] = suf[0][i &lt;&lt; bSzLog];\n        }\n        build(1, n, n + indexSz, (1 &lt;&lt; lg) - n);\n    }\n\n    inline void updateBetweenZero(int bid) {\n        int bSzLog = (lg+1) &gt;&gt; 1;\n        v[n+bid] = suf[0][bid &lt;&lt; bSzLog];\n        update(1, n, n + indexSz, (1 &lt;&lt; lg) - n, n+bid);\n    }\n\n    void build(int layer, int lBound, int rBound, int betweenOffs) {\n        if (layer &gt;= (int)layers.size()) {\n            return;\n        }\n        int bSz = 1 &lt;&lt; ((layers[layer]+1) &gt;&gt; 1);\n        for (int l = lBound; l &lt; rBound; l += bSz) {\n            int r = min(l + bSz, rBound);\n            buildBlock(layer, l, r);\n            build(layer+1, l, r, betweenOffs);\n        }\n        if (layer == 0) {\n            buildBetweenZero();\n        } else {\n            buildBetween(layer, lBound, rBound, betweenOffs);\n        }\n    }\n\n    void update(int layer, int lBound, int rBound, int betweenOffs, int x) {\n        if (layer &gt;= (int)layers.size()) {\n            return;\n        }\n        int bSzLog = (layers[layer]+1) &gt;&gt; 1;\n        int bSz = 1 &lt;&lt; bSzLog;\n        int blockIdx = (x - lBound) &gt;&gt; bSzLog;\n        int l = lBound + (blockIdx &lt;&lt; bSzLog);\n        int r = min(l + bSz, rBound);\n        buildBlock(layer, l, r);\n        if (layer == 0) {\n            updateBetweenZero(blockIdx);\n        } else {\n            buildBetween(layer, lBound, rBound, betweenOffs);\n        }\n        update(layer+1, l, r, betweenOffs, x);\n    }\n\n    inline SqrtTreeItem query(int l, int r, int betweenOffs, int base) {\n        if (l == r) {\n            return v[l];\n        }\n        if (l + 1 == r) {\n            return op(v[l], v[r]);\n        }\n        int layer = onLayer[clz[(l - base) ^ (r - base)]];\n        int bSzLog = (layers[layer]+1) &gt;&gt; 1;\n        int bCntLog = layers[layer] &gt;&gt; 1;\n        int lBound = (((l - base) &gt;&gt; layers[layer]) &lt;&lt; layers[layer]) + base;\n        int lBlock = ((l - lBound) &gt;&gt; bSzLog) + 1;\n        int rBlock = ((r - lBound) &gt;&gt; bSzLog) - 1;\n        SqrtTreeItem ans = suf[layer][l];\n        if (lBlock &lt;= rBlock) {\n            SqrtTreeItem add = (layer == 0) ? (\n                query(n + lBlock, n + rBlock, (1 &lt;&lt; lg) - n, n)\n            ) : (\n                between[layer-1][betweenOffs + lBound + (lBlock &lt;&lt; bCntLog) + rBlock]\n            );\n            ans = op(ans, add);\n        }\n        ans = op(ans, pref[layer][r]);\n        return ans;\n    }\npublic:\n    inline SqrtTreeItem query(int l, int r) {\n        return query(l, r, 0, 0);\n    }\n\n    inline void update(int x, const SqrtTreeItem &amp;item) {\n        v[x] = item;\n        update(0, 0, n, 0, x);\n    }\n\n    SqrtTree(const vector&lt;SqrtTreeItem&gt;&amp; a)\n        : n((int)a.size()), lg(log2Up(n)), v(a), clz(1 &lt;&lt; lg), onLayer(lg+1) {\n        clz[0] = 0;\n        for (int i = 1; i &lt; (int)clz.size(); i++) {\n            clz[i] = clz[i &gt;&gt; 1] + 1;\n        }\n        int tlg = lg;\n        while (tlg &gt; 1) {\n            onLayer[tlg] = (int)layers.size();\n            layers.push_back(tlg);\n            tlg = (tlg+1) &gt;&gt; 1;\n        }\n        for (int i = lg-1; i &gt;= 0; i--) {\n            onLayer[i] = max(onLayer[i], onLayer[i+1]);\n        }\n        int betweenLayers = max(0, (int)layers.size() - 1);\n        int bSzLog = (lg+1) &gt;&gt; 1;\n        int bSz = 1 &lt;&lt; bSzLog;\n        indexSz = (n + bSz - 1) &gt;&gt; bSzLog;\n        v.resize(n + indexSz);\n        pref.assign(layers.size(), vector&lt;SqrtTreeItem&gt;(n + indexSz));\n        suf.assign(layers.size(), vector&lt;SqrtTreeItem&gt;(n + indexSz));\n        between.assign(betweenLayers, vector&lt;SqrtTreeItem&gt;((1 &lt;&lt; lg) + bSz));\n        build(0, 0, n, 0);\n    }\n};\n</code></pre>","tags":["Translated"]},{"location":"data_structures/sqrt-tree.html#problems","title":"B\u00e0i t\u1eadp (Problems)","text":"<p>CodeChef - SEGPROD</p>","tags":["Translated"]},{"location":"data_structures/sqrt-tree.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 352</li> <li>Translated lines: 352</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Translated"]},{"location":"data_structures/sqrt_decomposition.html","title":"Ph\u00e2n r\u00e3 c\u0103n b\u1eadc hai (Sqrt Decomposition)","text":"<p>Ph\u00e2n r\u00e3 c\u0103n b\u1eadc hai (Sqrt Decomposition) l\u00e0 m\u1ed9t ph\u01b0\u01a1ng ph\u00e1p (ho\u1eb7c m\u1ed9t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u) cho ph\u00e9p b\u1ea1n th\u1ef1c hi\u1ec7n m\u1ed9t s\u1ed1 thao t\u00e1c ph\u1ed5 bi\u1ebfn (t\u00ecm t\u1ed5ng c\u00e1c ph\u1ea7n t\u1eed c\u1ee7a m\u1ea3ng con, t\u00ecm ph\u1ea7n t\u1eed nh\u1ecf nh\u1ea5t/l\u1edbn nh\u1ea5t, v.v.) trong $O(\\sqrt n)$ thao t\u00e1c, nhanh h\u01a1n nhi\u1ec1u so v\u1edbi $O(n)$ c\u1ee7a thu\u1eadt to\u00e1n t\u1ea7m th\u01b0\u1eddng.</p> <p>\u0110\u1ea7u ti\u00ean, ch\u00fang ta m\u00f4 t\u1ea3 c\u1ea5u tr\u00fac d\u1eef li\u1ec7u cho m\u1ed9t trong nh\u1eefng \u1ee9ng d\u1ee5ng \u0111\u01a1n gi\u1ea3n nh\u1ea5t c\u1ee7a \u00fd t\u01b0\u1edfng n\u00e0y, sau \u0111\u00f3 ch\u1ec9 ra c\u00e1ch kh\u00e1i qu\u00e1t h\u00f3a n\u00f3 \u0111\u1ec3 gi\u1ea3i quy\u1ebft m\u1ed9t s\u1ed1 b\u00e0i to\u00e1n kh\u00e1c, v\u00e0 cu\u1ed1i c\u00f9ng xem x\u00e9t m\u1ed9t c\u00e1ch s\u1eed d\u1ee5ng h\u01a1i kh\u00e1c c\u1ee7a \u00fd t\u01b0\u1edfng n\u00e0y: chia c\u00e1c y\u00eau c\u1ea7u \u0111\u1ea7u v\u00e0o th\u00e0nh c\u00e1c kh\u1ed1i c\u0103n b\u1eadc hai.</p>","tags":["Translated"]},{"location":"data_structures/sqrt_decomposition.html#sqrt-decomposition-based-data-structure","title":"C\u1ea5u tr\u00fac d\u1eef li\u1ec7u d\u1ef1a tr\u00ean ph\u00e2n r\u00e3 c\u0103n b\u1eadc hai (Sqrt-decomposition based data structure)","text":"<p>Cho m\u1ed9t m\u1ea3ng $a[0 \\dots n-1]$, h\u00e3y c\u00e0i \u0111\u1eb7t m\u1ed9t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u cho ph\u00e9p t\u00ecm t\u1ed5ng c\u1ee7a c\u00e1c ph\u1ea7n t\u1eed $a[l \\dots r]$ v\u1edbi $l$ v\u00e0 $r$ b\u1ea5t k\u1ef3 trong $O(\\sqrt n)$ thao t\u00e1c.</p>","tags":["Translated"]},{"location":"data_structures/sqrt_decomposition.html#description","title":"M\u00f4 t\u1ea3 (Description)","text":"<p>\u00dd t\u01b0\u1edfng c\u01a1 b\u1ea3n c\u1ee7a ph\u00e2n r\u00e3 c\u0103n b\u1eadc hai l\u00e0 ti\u1ec1n x\u1eed l\u00fd. Ch\u00fang ta s\u1ebd chia m\u1ea3ng $a$ th\u00e0nh c\u00e1c kh\u1ed1i c\u00f3 \u0111\u1ed9 d\u00e0i x\u1ea5p x\u1ec9 $\\sqrt n$, v\u00e0 \u0111\u1ed1i v\u1edbi m\u1ed7i kh\u1ed1i $i$, ch\u00fang ta s\u1ebd t\u00ednh to\u00e1n tr\u01b0\u1edbc t\u1ed5ng c\u00e1c ph\u1ea7n t\u1eed trong \u0111\u00f3, g\u1ecdi l\u00e0 $b[i]$.</p> <p>Ch\u00fang ta c\u00f3 th\u1ec3 gi\u1ea3 \u0111\u1ecbnh r\u1eb1ng c\u1ea3 k\u00edch th\u01b0\u1edbc c\u1ee7a kh\u1ed1i v\u00e0 s\u1ed1 l\u01b0\u1ee3ng kh\u1ed1i \u0111\u1ec1u b\u1eb1ng $\\sqrt n$ l\u00e0m tr\u00f2n l\u00ean:</p> $$ s = \\lceil \\sqrt n \\rceil $$ <p>Khi \u0111\u00f3 m\u1ea3ng $a$ \u0111\u01b0\u1ee3c chia th\u00e0nh c\u00e1c kh\u1ed1i theo c\u00e1ch sau:</p> $$ \\underbrace{a[0], a[1], \\dots, a[s-1]}_{\\text{b[0]}}, \\underbrace{a[s], \\dots, a[2s-1]}_{\\text{b[1]}}, \\dots, \\underbrace{a[(s-1) \\cdot s], \\dots, a[n-1]}_{\\text{b[s-1]}} $$ <p>Kh\u1ed1i cu\u1ed1i c\u00f9ng c\u00f3 th\u1ec3 c\u00f3 \u00edt ph\u1ea7n t\u1eed h\u01a1n c\u00e1c kh\u1ed1i kh\u00e1c (n\u1ebfu $n$ kh\u00f4ng ph\u1ea3i l\u00e0 b\u1ed9i s\u1ed1 c\u1ee7a $s$), \u0111i\u1ec1u n\u00e0y kh\u00f4ng quan tr\u1ecdng \u0111\u1ed1i v\u1edbi cu\u1ed9c th\u1ea3o lu\u1eadn (v\u00ec n\u00f3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c x\u1eed l\u00fd d\u1ec5 d\u00e0ng). Do \u0111\u00f3, \u0111\u1ed1i v\u1edbi m\u1ed7i kh\u1ed1i $k$, ch\u00fang ta bi\u1ebft t\u1ed5ng c\u1ee7a c\u00e1c ph\u1ea7n t\u1eed tr\u00ean \u0111\u00f3 $b[k]$:</p> $$ b[k] = \\sum\\limits_{i=k\\cdot s}^{\\min {(n-1,(k+1)\\cdot s - 1})} a[i] $$ <p>V\u00ec v\u1eady, ch\u00fang ta \u0111\u00e3 t\u00ednh to\u00e1n c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a $b[k]$ (\u0111i\u1ec1u n\u00e0y y\u00eau c\u1ea7u $O(n)$ thao t\u00e1c). L\u00e0m th\u1ebf n\u00e0o ch\u00fang c\u00f3 th\u1ec3 gi\u00fap ch\u00fang ta tr\u1ea3 l\u1eddi t\u1eebng truy v\u1ea5n $[l, r]$? H\u00e3y l\u01b0u \u00fd r\u1eb1ng n\u1ebfu kho\u1ea3ng $[l, r]$ \u0111\u1ee7 d\u00e0i, n\u00f3 s\u1ebd ch\u1ee9a m\u1ed9t v\u00e0i kh\u1ed1i tr\u1ecdn v\u1eb9n, v\u00e0 \u0111\u1ed1i v\u1edbi c\u00e1c kh\u1ed1i \u0111\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm t\u1ed5ng c\u1ee7a c\u00e1c ph\u1ea7n t\u1eed trong \u0111\u00f3 ch\u1ec9 b\u1eb1ng m\u1ed9t thao t\u00e1c. K\u1ebft qu\u1ea3 l\u00e0, kho\u1ea3ng $[l, r]$ s\u1ebd ch\u1ec9 ch\u1ee9a c\u00e1c ph\u1ea7n c\u1ee7a hai kh\u1ed1i \u1edf hai \u0111\u1ea7u, v\u00e0 ch\u00fang ta s\u1ebd ph\u1ea3i t\u00ednh t\u1ed5ng c\u00e1c ph\u1ea7n t\u1eed trong c\u00e1c ph\u1ea7n n\u00e0y m\u1ed9t c\u00e1ch t\u1ea7m th\u01b0\u1eddng.</p> <p>Do \u0111\u00f3, \u0111\u1ec3 t\u00ednh t\u1ed5ng c\u00e1c ph\u1ea7n t\u1eed tr\u00ean kho\u1ea3ng $[l, r]$, ch\u00fang ta ch\u1ec9 c\u1ea7n t\u00ednh t\u1ed5ng c\u00e1c ph\u1ea7n t\u1eed c\u1ee7a hai \"\u0111u\u00f4i\": $[l\\dots (k + 1)\\cdot s-1]$ v\u00e0 $[p\\cdot s\\dots r]$, v\u00e0 c\u1ed9ng c\u00e1c gi\u00e1 tr\u1ecb $b[i]$ trong t\u1ea5t c\u1ea3 c\u00e1c kh\u1ed1i t\u1eeb $k + 1$ \u0111\u1ebfn $p-1$:</p> $$ \\sum\\limits_{i=l}^r a[i] = \\sum\\limits_{i=l}^{(k+1) \\cdot s-1} a[i] + \\sum\\limits_{i=k+1}^{p-1} b[i] + \\sum\\limits_{i=p\\cdot s}^r a[i] $$ <p>L\u01b0u \u00fd: Khi $k = p$, t\u1ee9c l\u00e0 $l$ v\u00e0 $r$ thu\u1ed9c c\u00f9ng m\u1ed9t kh\u1ed1i, c\u00f4ng th\u1ee9c kh\u00f4ng th\u1ec3 \u0111\u01b0\u1ee3c \u00e1p d\u1ee5ng, v\u00e0 t\u1ed5ng n\u00ean \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n theo c\u00e1ch t\u1ea7m th\u01b0\u1eddng.</p> <p>C\u00e1ch ti\u1ebfp c\u1eadn n\u00e0y cho ph\u00e9p ch\u00fang ta gi\u1ea3m \u0111\u00e1ng k\u1ec3 s\u1ed1 l\u01b0\u1ee3ng thao t\u00e1c. Th\u1eadt v\u1eady, k\u00edch th\u01b0\u1edbc c\u1ee7a m\u1ed7i \"\u0111u\u00f4i\" kh\u00f4ng v\u01b0\u1ee3t qu\u00e1 chi\u1ec1u d\u00e0i kh\u1ed1i $s$, v\u00e0 s\u1ed1 l\u01b0\u1ee3ng kh\u1ed1i trong t\u1ed5ng kh\u00f4ng v\u01b0\u1ee3t qu\u00e1 $s$. V\u00ec ch\u00fang ta \u0111\u00e3 ch\u1ecdn $s \\approx \\sqrt n$, t\u1ed5ng s\u1ed1 thao t\u00e1c c\u1ea7n thi\u1ebft \u0111\u1ec3 t\u00ecm t\u1ed5ng c\u00e1c ph\u1ea7n t\u1eed tr\u00ean kho\u1ea3ng $[l, r]$ l\u00e0 $O(\\sqrt n)$.</p>","tags":["Translated"]},{"location":"data_structures/sqrt_decomposition.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>H\u00e3y b\u1eaft \u0111\u1ea7u v\u1edbi c\u00e1ch c\u00e0i \u0111\u1eb7t \u0111\u01a1n gi\u1ea3n nh\u1ea5t:</p> <pre><code>// input data\nint n;\nvector&lt;int&gt; a (n);\n\n// preprocessing\nint len = (int) sqrt (n + .0) + 1; // size of the block and the number of blocks\nvector&lt;int&gt; b (len);\nfor (int i=0; i&lt;n; ++i)\n    b[i / len] += a[i];\n\n// answering the queries\nfor (;;) {\n    int l, r;\n  // read input data for the next query\n    int sum = 0;\n    for (int i=l; i&lt;=r; )\n        if (i % len == 0 &amp;&amp; i + len - 1 &lt;= r) {\n            // if the whole block starting at i belongs to [l, r]\n            sum += b[i / len];\n            i += len;\n        }\n        else {\n            sum += a[i];\n            ++i;\n        }\n}\n</code></pre> <p>Vi\u1ec7c c\u00e0i \u0111\u1eb7t n\u00e0y c\u00f3 qu\u00e1 nhi\u1ec1u thao t\u00e1c chia m\u1ed9t c\u00e1ch b\u1ea5t h\u1ee3p l\u00fd (ch\u00fang ch\u1eadm h\u01a1n nhi\u1ec1u so v\u1edbi c\u00e1c thao t\u00e1c s\u1ed1 h\u1ecdc kh\u00e1c). Thay v\u00e0o \u0111\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh c\u00e1c ch\u1ec9 s\u1ed1 c\u1ee7a c\u00e1c kh\u1ed1i $c_l$ v\u00e0 $c_r$ ch\u1ee9a ch\u1ec9 s\u1ed1 $l$ v\u00e0 $r$, v\u00e0 l\u1eb7p qua c\u00e1c kh\u1ed1i $c_l+1 \\dots c_r-1$ v\u1edbi vi\u1ec7c x\u1eed l\u00fd ri\u00eang bi\u1ec7t c\u00e1c \"\u0111u\u00f4i\" trong c\u00e1c kh\u1ed1i $c_l$ v\u00e0 $c_r$. C\u00e1ch ti\u1ebfp c\u1eadn n\u00e0y t\u01b0\u01a1ng \u1ee9ng v\u1edbi c\u00f4ng th\u1ee9c cu\u1ed1i c\u00f9ng trong ph\u1ea7n m\u00f4 t\u1ea3, v\u00e0 coi tr\u01b0\u1eddng h\u1ee3p $c_l = c_r$ l\u00e0 m\u1ed9t tr\u01b0\u1eddng h\u1ee3p \u0111\u1eb7c bi\u1ec7t.</p> <pre><code>int sum = 0;\nint c_l = l / len,   c_r = r / len;\nif (c_l == c_r)\n    for (int i=l; i&lt;=r; ++i)\n        sum += a[i];\nelse {\n    for (int i=l, end=(c_l+1)*len-1; i&lt;=end; ++i)\n        sum += a[i];\n    for (int i=c_l+1; i&lt;=c_r-1; ++i)\n        sum += b[i];\n    for (int i=c_r*len; i&lt;=r; ++i)\n        sum += a[i];\n}\n</code></pre>","tags":["Translated"]},{"location":"data_structures/sqrt_decomposition.html#other-problems","title":"C\u00e1c b\u00e0i to\u00e1n kh\u00e1c (Other problems)","text":"<p>Cho \u0111\u1ebfn nay ch\u00fang ta \u0111\u00e3 th\u1ea3o lu\u1eadn v\u1ec1 b\u00e0i to\u00e1n t\u00ecm t\u1ed5ng c\u00e1c ph\u1ea7n t\u1eed c\u1ee7a m\u1ed9t m\u1ea3ng con li\u00ean t\u1ee5c. B\u00e0i to\u00e1n n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c m\u1edf r\u1ed9ng \u0111\u1ec3 cho ph\u00e9p c\u1eadp nh\u1eadt c\u00e1c ph\u1ea7n t\u1eed m\u1ea3ng ri\u00eang l\u1ebb. N\u1ebfu m\u1ed9t ph\u1ea7n t\u1eed $a[i]$ thay \u0111\u1ed5i, ch\u1ec9 c\u1ea7n c\u1eadp nh\u1eadt gi\u00e1 tr\u1ecb c\u1ee7a $b[k]$ cho kh\u1ed1i m\u00e0 ph\u1ea7n t\u1eed n\u00e0y thu\u1ed9c v\u1ec1 ($k = i / s$) trong m\u1ed9t thao t\u00e1c:</p> $$ b[k] += a_{new}[i] - a_{old}[i] $$ <p>M\u1eb7t kh\u00e1c, nhi\u1ec7m v\u1ee5 t\u00ecm t\u1ed5ng c\u00e1c ph\u1ea7n t\u1eed c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c thay th\u1ebf b\u1eb1ng nhi\u1ec7m v\u1ee5 t\u00ecm ph\u1ea7n t\u1eed nh\u1ecf nh\u1ea5t/l\u1edbn nh\u1ea5t c\u1ee7a m\u1ed9t m\u1ea3ng con. N\u1ebfu b\u00e0i to\u00e1n n\u00e0y c\u0169ng ph\u1ea3i gi\u1ea3i quy\u1ebft c\u00e1c c\u1eadp nh\u1eadt c\u1ee7a c\u00e1c ph\u1ea7n t\u1eed ri\u00eang l\u1ebb, vi\u1ec7c c\u1eadp nh\u1eadt gi\u00e1 tr\u1ecb c\u1ee7a $b[k]$ c\u0169ng l\u00e0 c\u00f3 th\u1ec3, nh\u01b0ng n\u00f3 s\u1ebd y\u00eau c\u1ea7u l\u1eb7p qua t\u1ea5t c\u1ea3 c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a kh\u1ed1i $k$ trong $O(s) = O(\\sqrt{n})$ thao t\u00e1c.</p> <p>Ph\u00e2n r\u00e3 c\u0103n b\u1eadc hai c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c \u00e1p d\u1ee5ng theo c\u00e1ch t\u01b0\u01a1ng t\u1ef1 cho c\u1ea3 m\u1ed9t l\u1edbp c\u00e1c b\u00e0i to\u00e1n kh\u00e1c: t\u00ecm s\u1ed1 l\u01b0\u1ee3ng ph\u1ea7n t\u1eed b\u1eb1ng 0, t\u00ecm ph\u1ea7n t\u1eed kh\u00e1c 0 \u0111\u1ea7u ti\u00ean, \u0111\u1ebfm c\u00e1c ph\u1ea7n t\u1eed th\u1ecfa m\u00e3n m\u1ed9t t\u00ednh ch\u1ea5t nh\u1ea5t \u0111\u1ecbnh, v.v.</p> <p>M\u1ed9t l\u1edbp b\u00e0i to\u00e1n kh\u00e1c xu\u1ea5t hi\u1ec7n khi ch\u00fang ta c\u1ea7n c\u1eadp nh\u1eadt c\u00e1c ph\u1ea7n t\u1eed m\u1ea3ng tr\u00ean c\u00e1c kho\u1ea3ng: t\u0103ng c\u00e1c ph\u1ea7n t\u1eed hi\u1ec7n c\u00f3 ho\u1eb7c thay th\u1ebf ch\u00fang b\u1eb1ng m\u1ed9t gi\u00e1 tr\u1ecb \u0111\u00e3 cho.</p> <p>V\u00ed d\u1ee5, gi\u1ea3 s\u1eed ch\u00fang ta c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n hai lo\u1ea1i thao t\u00e1c tr\u00ean m\u1ed9t m\u1ea3ng: th\u00eam m\u1ed9t gi\u00e1 tr\u1ecb $\\delta$ \u0111\u00e3 cho v\u00e0o t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed m\u1ea3ng tr\u00ean kho\u1ea3ng $[l, r]$ ho\u1eb7c truy v\u1ea5n gi\u00e1 tr\u1ecb c\u1ee7a ph\u1ea7n t\u1eed $a[i]$. H\u00e3y l\u01b0u tr\u1eef gi\u00e1 tr\u1ecb c\u1ea7n \u0111\u01b0\u1ee3c th\u00eam v\u00e0o t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed c\u1ee7a kh\u1ed1i $k$ trong $b[k]$ (ban \u0111\u1ea7u t\u1ea5t c\u1ea3 $b[k] = 0$). Trong m\u1ed7i thao t\u00e1c \"th\u00eam\", ch\u00fang ta c\u1ea7n c\u1ed9ng $\\delta$ v\u00e0o $b[k]$ cho t\u1ea5t c\u1ea3 c\u00e1c kh\u1ed1i thu\u1ed9c v\u1ec1 kho\u1ea3ng $[l, r]$ v\u00e0 c\u1ed9ng $\\delta$ v\u00e0o $a[i]$ cho t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed thu\u1ed9c v\u1ec1 c\u00e1c \"\u0111u\u00f4i\" c\u1ee7a kho\u1ea3ng. C\u00e2u tr\u1ea3 l\u1eddi cho truy v\u1ea5n $i$ ch\u1ec9 \u0111\u01a1n gi\u1ea3n l\u00e0 $a[i] + b[i/s]$. Theo c\u00e1ch n\u00e0y, thao t\u00e1c \"th\u00eam\" c\u00f3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p $O(\\sqrt{n})$, v\u00e0 tr\u1ea3 l\u1eddi m\u1ed9t truy v\u1ea5n c\u00f3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p $O(1)$.</p> <p>Cu\u1ed1i c\u00f9ng, hai l\u1edbp b\u00e0i to\u00e1n \u0111\u00f3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c k\u1ebft h\u1ee3p n\u1ebfu nhi\u1ec7m v\u1ee5 y\u00eau c\u1ea7u th\u1ef1c hi\u1ec7n c\u1ea3 c\u1eadp nh\u1eadt ph\u1ea7n t\u1eed tr\u00ean m\u1ed9t kho\u1ea3ng v\u00e0 truy v\u1ea5n tr\u00ean m\u1ed9t kho\u1ea3ng. C\u1ea3 hai thao t\u00e1c \u0111\u1ec1u c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n v\u1edbi \u0111\u1ed9 ph\u1ee9c t\u1ea1p $O(\\sqrt{n})$. \u0110i\u1ec1u n\u00e0y s\u1ebd y\u00eau c\u1ea7u hai m\u1ea3ng kh\u1ed1i $b$ v\u00e0 $c$: m\u1ed9t \u0111\u1ec3 theo d\u00f5i c\u00e1c c\u1eadp nh\u1eadt ph\u1ea7n t\u1eed v\u00e0 m\u1ed9t \u0111\u1ec3 theo d\u00f5i c\u00e1c c\u00e2u tr\u1ea3 l\u1eddi cho truy v\u1ea5n.</p> <p>C\u00f3 c\u00e1c b\u00e0i to\u00e1n kh\u00e1c c\u00f3 th\u1ec3 gi\u1ea3i quy\u1ebft \u0111\u01b0\u1ee3c b\u1eb1ng ph\u00e2n r\u00e3 c\u0103n b\u1eadc hai, v\u00ed d\u1ee5, b\u00e0i to\u00e1n duy tr\u00ec m\u1ed9t t\u1eadp h\u1ee3p c\u00e1c s\u1ed1 cho ph\u00e9p th\u00eam/x\u00f3a s\u1ed1, ki\u1ec3m tra xem m\u1ed9t s\u1ed1 c\u00f3 thu\u1ed9c v\u1ec1 t\u1eadp h\u1ee3p hay kh\u00f4ng v\u00e0 t\u00ecm s\u1ed1 l\u1edbn th\u1ee9 $k$. \u0110\u1ec3 gi\u1ea3i quy\u1ebft n\u00f3, ng\u01b0\u1eddi ta ph\u1ea3i l\u01b0u tr\u1eef c\u00e1c s\u1ed1 theo th\u1ee9 t\u1ef1 t\u0103ng d\u1ea7n, chia th\u00e0nh nhi\u1ec1u kh\u1ed1i v\u1edbi $\\sqrt{n}$ s\u1ed1 trong m\u1ed7i kh\u1ed1i. M\u1ed7i khi m\u1ed9t s\u1ed1 \u0111\u01b0\u1ee3c th\u00eam/x\u00f3a, c\u00e1c kh\u1ed1i ph\u1ea3i \u0111\u01b0\u1ee3c c\u00e2n b\u1eb1ng l\u1ea1i b\u1eb1ng c\u00e1ch di chuy\u1ec3n c\u00e1c s\u1ed1 gi\u1eefa \u0111\u1ea7u v\u00e0 cu\u1ed1i c\u1ee7a c\u00e1c kh\u1ed1i li\u1ec1n k\u1ec1.</p>","tags":["Translated"]},{"location":"data_structures/sqrt_decomposition.html#mo-s-algorithm","title":"Thu\u1eadt to\u00e1n Mo (Mo's algorithm)","text":"<p>M\u1ed9t \u00fd t\u01b0\u1edfng t\u01b0\u01a1ng t\u1ef1, d\u1ef1a tr\u00ean ph\u00e2n r\u00e3 c\u0103n b\u1eadc hai, c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n \u0111o\u1ea1n ($Q$) ngo\u1ea1i tuy\u1ebfn (offline) trong $O((N+Q)\\sqrt{N})$. \u0110i\u1ec1u n\u00e0y nghe c\u00f3 v\u1ebb t\u1ed3i t\u1ec7 h\u01a1n nhi\u1ec1u so v\u1edbi c\u00e1c ph\u01b0\u01a1ng ph\u00e1p trong ph\u1ea7n tr\u01b0\u1edbc, v\u00ec \u0111\u00e2y l\u00e0 \u0111\u1ed9 ph\u1ee9c t\u1ea1p h\u01a1i t\u1ec7 h\u01a1n so v\u1edbi nh\u1eefng g\u00ec ch\u00fang ta c\u00f3 tr\u01b0\u1edbc \u0111\u00f3 v\u00e0 kh\u00f4ng th\u1ec3 c\u1eadp nh\u1eadt c\u00e1c gi\u00e1 tr\u1ecb gi\u1eefa hai truy v\u1ea5n. Nh\u01b0ng trong r\u1ea5t nhi\u1ec1u t\u00ecnh hu\u1ed1ng, ph\u01b0\u01a1ng ph\u00e1p n\u00e0y c\u00f3 l\u1ee3i th\u1ebf. Trong qu\u00e1 tr\u00ecnh ph\u00e2n r\u00e3 c\u0103n b\u1eadc hai th\u00f4ng th\u01b0\u1eddng, ch\u00fang ta ph\u1ea3i t\u00ednh to\u00e1n tr\u01b0\u1edbc c\u00e1c c\u00e2u tr\u1ea3 l\u1eddi cho t\u1eebng kh\u1ed1i v\u00e0 h\u1ee3p nh\u1ea5t ch\u00fang trong khi tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n. Trong m\u1ed9t s\u1ed1 b\u00e0i to\u00e1n, b\u01b0\u1edbc h\u1ee3p nh\u1ea5t n\u00e0y c\u00f3 th\u1ec3 kh\u00e1 r\u1eafc r\u1ed1i. V\u00ed d\u1ee5: khi m\u1ed7i truy v\u1ea5n y\u00eau c\u1ea7u t\u00ecm mode (y\u1ebfu v\u1ecb - gi\u00e1 tr\u1ecb xu\u1ea5t hi\u1ec7n nhi\u1ec1u nh\u1ea5t) c\u1ee7a ph\u1ea1m vi c\u1ee7a n\u00f3. \u0110\u1ed1i v\u1edbi \u0111i\u1ec1u n\u00e0y, m\u1ed7i kh\u1ed1i s\u1ebd ph\u1ea3i l\u01b0u tr\u1eef s\u1ed1 l\u01b0\u1ee3ng c\u1ee7a m\u1ed7i s\u1ed1 trong \u0111\u00f3 trong m\u1ed9t lo\u1ea1i c\u1ea5u tr\u00fac d\u1eef li\u1ec7u n\u00e0o \u0111\u00f3, v\u00e0 ch\u00fang ta kh\u00f4ng c\u00f2n c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n b\u01b0\u1edbc h\u1ee3p nh\u1ea5t \u0111\u1ee7 nhanh n\u1eefa. Thu\u1eadt to\u00e1n Mo s\u1eed d\u1ee5ng m\u1ed9t c\u00e1ch ti\u1ebfp c\u1eadn ho\u00e0n to\u00e0n kh\u00e1c, c\u00f3 th\u1ec3 tr\u1ea3 l\u1eddi lo\u1ea1i truy v\u1ea5n n\u00e0y nhanh ch\u00f3ng, b\u1edfi v\u00ec n\u00f3 ch\u1ec9 theo d\u00f5i m\u1ed9t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u, v\u00e0 c\u00e1c thao t\u00e1c duy nh\u1ea5t v\u1edbi n\u00f3 l\u00e0 d\u1ec5 d\u00e0ng v\u00e0 nhanh ch\u00f3ng.</p> <p>\u00dd t\u01b0\u1edfng l\u00e0 tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n theo m\u1ed9t th\u1ee9 t\u1ef1 \u0111\u1eb7c bi\u1ec7t d\u1ef1a tr\u00ean c\u00e1c ch\u1ec9 s\u1ed1. Tr\u01b0\u1edbc ti\u00ean ch\u00fang ta s\u1ebd tr\u1ea3 l\u1eddi t\u1ea5t c\u1ea3 c\u00e1c truy v\u1ea5n c\u00f3 ch\u1ec9 s\u1ed1 b\u00ean tr\u00e1i trong kh\u1ed1i 0, sau \u0111\u00f3 tr\u1ea3 l\u1eddi t\u1ea5t c\u1ea3 c\u00e1c truy v\u1ea5n c\u00f3 ch\u1ec9 s\u1ed1 b\u00ean tr\u00e1i trong kh\u1ed1i 1, v.v. V\u00e0 ch\u00fang ta c\u0169ng s\u1ebd ph\u1ea3i tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n c\u1ee7a m\u1ed9t kh\u1ed1i theo m\u1ed9t th\u1ee9 t\u1ef1 \u0111\u1eb7c bi\u1ec7t, c\u1ee5 th\u1ec3 l\u00e0 \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp theo ch\u1ec9 s\u1ed1 b\u00ean ph\u1ea3i c\u1ee7a c\u00e1c truy v\u1ea5n.</p> <p>Nh\u01b0 \u0111\u00e3 n\u00f3i, ch\u00fang ta s\u1ebd s\u1eed d\u1ee5ng m\u1ed9t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u duy nh\u1ea5t. C\u1ea5u tr\u00fac d\u1eef li\u1ec7u n\u00e0y s\u1ebd l\u01b0u tr\u1eef th\u00f4ng tin v\u1ec1 ph\u1ea1m vi. L\u00fac \u0111\u1ea7u ph\u1ea1m vi n\u00e0y s\u1ebd tr\u1ed1ng. Khi ch\u00fang ta mu\u1ed1n tr\u1ea3 l\u1eddi truy v\u1ea5n ti\u1ebfp theo (theo th\u1ee9 t\u1ef1 \u0111\u1eb7c bi\u1ec7t), ch\u00fang ta ch\u1ec9 c\u1ea7n m\u1edf r\u1ed9ng ho\u1eb7c thu nh\u1ecf ph\u1ea1m vi, b\u1eb1ng c\u00e1ch th\u00eam/b\u1edbt c\u00e1c ph\u1ea7n t\u1eed \u1edf c\u1ea3 hai ph\u00eda c\u1ee7a ph\u1ea1m vi hi\u1ec7n t\u1ea1i, cho \u0111\u1ebfn khi ch\u00fang ta bi\u1ebfn \u0111\u1ed5i n\u00f3 th\u00e0nh ph\u1ea1m vi truy v\u1ea5n. Theo c\u00e1ch n\u00e0y, ch\u00fang ta ch\u1ec9 c\u1ea7n th\u00eam ho\u1eb7c b\u1edbt m\u1ed9t ph\u1ea7n t\u1eed duy nh\u1ea5t m\u1ed7i l\u1ea7n, \u0111\u00e2y ph\u1ea3i l\u00e0 c\u00e1c thao t\u00e1c kh\u00e1 d\u1ec5 d\u00e0ng trong c\u1ea5u tr\u00fac d\u1eef li\u1ec7u c\u1ee7a ch\u00fang ta.</p> <p>V\u00ec ch\u00fang ta thay \u0111\u1ed5i th\u1ee9 t\u1ef1 tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n, \u0111i\u1ec1u n\u00e0y ch\u1ec9 c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n \u0111\u01b0\u1ee3c khi ch\u00fang ta \u0111\u01b0\u1ee3c ph\u00e9p tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n \u1edf ch\u1ebf \u0111\u1ed9 ngo\u1ea1i tuy\u1ebfn (offline).</p>","tags":["Translated"]},{"location":"data_structures/sqrt_decomposition.html#implementation-1","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>Trong thu\u1eadt to\u00e1n Mo, ch\u00fang ta s\u1eed d\u1ee5ng hai h\u00e0m \u0111\u1ec3 th\u00eam m\u1ed9t ch\u1ec9 s\u1ed1 v\u00e0 \u0111\u1ec3 x\u00f3a m\u1ed9t ch\u1ec9 s\u1ed1 kh\u1ecfi ph\u1ea1m vi m\u00e0 ch\u00fang ta hi\u1ec7n \u0111ang duy tr\u00ec.</p> <pre><code>void remove(idx);  // TODO: remove value at idx from data structure\nvoid add(idx);     // TODO: add value at idx from data structure\nint get_answer();  // TODO: extract the current answer of the data structure\n\nint block_size;\n\nstruct Query {\n    int l, r, idx;\n    bool operator&lt;(Query other) const\n    {\n        return make_pair(l / block_size, r) &lt;\n               make_pair(other.l / block_size, other.r);\n    }\n};\n\nvector&lt;int&gt; mo_s_algorithm(vector&lt;Query&gt; queries) {\n    vector&lt;int&gt; answers(queries.size());\n    sort(queries.begin(), queries.end());\n\n    // TODO: initialize data structure\n\n    int cur_l = 0;\n    int cur_r = -1;\n    // invariant: data structure will always reflect the range [cur_l, cur_r]\n    for (Query q : queries) {\n        while (cur_l &gt; q.l) {\n            cur_l--;\n            add(cur_l);\n        }\n        while (cur_r &lt; q.r) {\n            cur_r++;\n            add(cur_r);\n        }\n        while (cur_l &lt; q.l) {\n            remove(cur_l);\n            cur_l++;\n        }\n        while (cur_r &gt; q.r) {\n            remove(cur_r);\n            cur_r--;\n        }\n        answers[q.idx] = get_answer();\n    }\n    return answers;\n}\n</code></pre> <p>D\u1ef1a tr\u00ean b\u00e0i to\u00e1n, ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng m\u1ed9t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u kh\u00e1c v\u00e0 s\u1eeda \u0111\u1ed5i c\u00e1c h\u00e0m <code>add</code>/<code>remove</code>/<code>get_answer</code> cho ph\u00f9 h\u1ee3p. V\u00ed d\u1ee5: n\u1ebfu ch\u00fang ta \u0111\u01b0\u1ee3c y\u00eau c\u1ea7u t\u00ecm c\u00e1c truy v\u1ea5n t\u1ed5ng ph\u1ea1m vi th\u00ec ch\u00fang ta s\u1eed d\u1ee5ng m\u1ed9t s\u1ed1 nguy\u00ean \u0111\u01a1n gi\u1ea3n l\u00e0m c\u1ea5u tr\u00fac d\u1eef li\u1ec7u, l\u00e0 $0$ khi b\u1eaft \u0111\u1ea7u. H\u00e0m <code>add</code> s\u1ebd ch\u1ec9 c\u1ea7n c\u1ed9ng gi\u00e1 tr\u1ecb c\u1ee7a v\u1ecb tr\u00ed v\u00e0 sau \u0111\u00f3 c\u1eadp nh\u1eadt bi\u1ebfn k\u1ebft qu\u1ea3. M\u1eb7t kh\u00e1c h\u00e0m <code>remove</code> s\u1ebd tr\u1eeb gi\u00e1 tr\u1ecb t\u1ea1i v\u1ecb tr\u00ed v\u00e0 sau \u0111\u00f3 c\u1eadp nh\u1eadt bi\u1ebfn k\u1ebft qu\u1ea3. V\u00e0 <code>get_answer</code> ch\u1ec9 tr\u1ea3 v\u1ec1 s\u1ed1 nguy\u00ean.</p> <p>\u0110\u1ec3 tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n mode, ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng c\u00e2y t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n (v\u00ed d\u1ee5: <code>map&lt;int, int&gt;</code>) \u0111\u1ec3 l\u01b0u tr\u1eef t\u1ea7n xu\u1ea5t m\u1ed7i s\u1ed1 xu\u1ea5t hi\u1ec7n trong ph\u1ea1m vi hi\u1ec7n t\u1ea1i, v\u00e0 c\u00e2y t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n th\u1ee9 hai (v\u00ed d\u1ee5: <code>set&lt;pair&lt;int, int&gt;&gt;</code>) \u0111\u1ec3 gi\u1eef s\u1ed1 l\u01b0\u1ee3ng c\u1ee7a c\u00e1c s\u1ed1 (v\u00ed d\u1ee5: d\u01b0\u1edbi d\u1ea1ng c\u1eb7p s\u1ed1 l\u01b0\u1ee3ng-s\u1ed1) theo th\u1ee9 t\u1ef1. Ph\u01b0\u01a1ng th\u1ee9c <code>add</code> lo\u1ea1i b\u1ecf s\u1ed1 hi\u1ec7n t\u1ea1i kh\u1ecfi BST th\u1ee9 hai, t\u0103ng s\u1ed1 l\u01b0\u1ee3ng trong c\u00e1i \u0111\u1ea7u ti\u00ean v\u00e0 ch\u00e8n l\u1ea1i s\u1ed1 v\u00e0o c\u00e1i th\u1ee9 hai. <code>remove</code> l\u00e0m \u0111i\u1ec1u t\u01b0\u01a1ng t\u1ef1, n\u00f3 ch\u1ec9 gi\u1ea3m s\u1ed1 l\u01b0\u1ee3ng. V\u00e0 <code>get_answer</code> ch\u1ec9 nh\u00ecn v\u00e0o c\u00e2y th\u1ee9 hai v\u00e0 tr\u1ea3 v\u1ec1 gi\u00e1 tr\u1ecb t\u1ed1t nh\u1ea5t trong $O(1)$.</p>","tags":["Translated"]},{"location":"data_structures/sqrt_decomposition.html#complexity","title":"\u0110\u1ed9 ph\u1ee9c t\u1ea1p (Complexity)","text":"<p>S\u1eafp x\u1ebfp t\u1ea5t c\u1ea3 c\u00e1c truy v\u1ea5n s\u1ebd m\u1ea5t $O(Q \\log Q)$.</p> <p>C\u00f2n c\u00e1c thao t\u00e1c kh\u00e1c th\u00ec sao? <code>add</code> v\u00e0 <code>remove</code> s\u1ebd \u0111\u01b0\u1ee3c g\u1ecdi bao nhi\u00eau l\u1ea7n?</p> <p>Gi\u1ea3 s\u1eed k\u00edch th\u01b0\u1edbc kh\u1ed1i l\u00e0 $S$.</p> <p>N\u1ebfu ch\u00fang ta ch\u1ec9 xem x\u00e9t t\u1ea5t c\u1ea3 c\u00e1c truy v\u1ea5n c\u00f3 ch\u1ec9 s\u1ed1 b\u00ean tr\u00e1i trong c\u00f9ng m\u1ed9t kh\u1ed1i, c\u00e1c truy v\u1ea5n \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp theo ch\u1ec9 s\u1ed1 b\u00ean ph\u1ea3i. Do \u0111\u00f3, ch\u00fang ta s\u1ebd g\u1ecdi <code>add(cur_r)</code> v\u00e0 <code>remove(cur_r)</code> ch\u1ec9 $O(N)$ l\u1ea7n cho t\u1ea5t c\u1ea3 c\u00e1c truy v\u1ea5n n\u00e0y k\u1ebft h\u1ee3p l\u1ea1i. \u0110i\u1ec1u n\u00e0y mang l\u1ea1i $O(\\frac{N}{S} N)$ cu\u1ed9c g\u1ecdi cho t\u1ea5t c\u1ea3 c\u00e1c kh\u1ed1i.</p> <p>Gi\u00e1 tr\u1ecb c\u1ee7a <code>cur_l</code> c\u00f3 th\u1ec3 thay \u0111\u1ed5i t\u1ed1i \u0111a $O(S)$ gi\u1eefa hai truy v\u1ea5n. Do \u0111\u00f3 ch\u00fang ta c\u00f3 th\u00eam $O(S Q)$ cu\u1ed9c g\u1ecdi c\u1ee7a <code>add(cur_l)</code> v\u00e0 <code>remove(cur_l)</code>.</p> <p>\u0110\u1ed1i v\u1edbi $S \\approx \\sqrt{N}$, \u0111i\u1ec1u n\u00e0y mang l\u1ea1i $O((N + Q) \\sqrt{N})$ thao t\u00e1c t\u1ed5ng c\u1ed9ng. Do \u0111\u00f3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p l\u00e0 $O((N+Q)F\\sqrt{N})$ trong \u0111\u00f3 $O(F)$ l\u00e0 \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a h\u00e0m <code>add</code> v\u00e0 <code>remove</code>.</p>","tags":["Translated"]},{"location":"data_structures/sqrt_decomposition.html#tips-for-improving-runtime","title":"M\u1eb9o c\u1ea3i thi\u1ec7n th\u1eddi gian ch\u1ea1y (Tips for improving runtime)","text":"<ul> <li>K\u00edch th\u01b0\u1edbc kh\u1ed1i ch\u00ednh x\u00e1c l\u00e0 $\\sqrt{N}$ kh\u00f4ng ph\u1ea3i l\u00fac n\u00e0o c\u0169ng mang l\u1ea1i th\u1eddi gian ch\u1ea1y t\u1ed1t nh\u1ea5t. V\u00ed d\u1ee5, n\u1ebfu $\\sqrt{N}=750$ th\u00ec c\u00f3 th\u1ec3 x\u1ea3y ra tr\u01b0\u1eddng h\u1ee3p k\u00edch th\u01b0\u1edbc kh\u1ed1i l\u00e0 $700$ ho\u1eb7c $800$ c\u00f3 th\u1ec3 ch\u1ea1y t\u1ed1t h\u01a1n.     Quan tr\u1ecdng h\u01a1n, kh\u00f4ng t\u00ednh to\u00e1n k\u00edch th\u01b0\u1edbc kh\u1ed1i khi ch\u1ea1y - h\u00e3y \u0111\u1eb7t n\u00f3 l\u00e0 <code>const</code>. Ph\u00e9p chia cho h\u1eb1ng s\u1ed1 \u0111\u01b0\u1ee3c t\u1ed1i \u01b0u h\u00f3a t\u1ed1t b\u1edfi c\u00e1c tr\u00ecnh bi\u00ean d\u1ecbch.</li> <li>Trong c\u00e1c kh\u1ed1i l\u1ebb, s\u1eafp x\u1ebfp ch\u1ec9 s\u1ed1 b\u00ean ph\u1ea3i theo th\u1ee9 t\u1ef1 t\u0103ng d\u1ea7n v\u00e0 trong c\u00e1c kh\u1ed1i ch\u1eb5n, s\u1eafp x\u1ebfp n\u00f3 theo th\u1ee9 t\u1ef1 gi\u1ea3m d\u1ea7n. \u0110i\u1ec1u n\u00e0y s\u1ebd gi\u1ea3m thi\u1ec3u s\u1ef1 di chuy\u1ec3n c\u1ee7a con tr\u1ecf b\u00ean ph\u1ea3i, v\u00ec vi\u1ec7c s\u1eafp x\u1ebfp b\u00ecnh th\u01b0\u1eddng s\u1ebd di chuy\u1ec3n con tr\u1ecf b\u00ean ph\u1ea3i t\u1eeb cu\u1ed1i v\u1ec1 \u0111\u1ea7u \u1edf \u0111\u1ea7u m\u1ed7i kh\u1ed1i. V\u1edbi phi\u00ean b\u1ea3n c\u1ea3i ti\u1ebfn n\u00e0y, vi\u1ec7c \u0111\u1eb7t l\u1ea1i n\u00e0y kh\u00f4ng c\u00f2n c\u1ea7n thi\u1ebft n\u1eefa.</li> </ul> <pre><code>bool cmp(pair&lt;int, int&gt; p, pair&lt;int, int&gt; q) {\n    if (p.first / BLOCK_SIZE != q.first / BLOCK_SIZE)\n        return p &lt; q;\n    return (p.first / BLOCK_SIZE &amp; 1) ? (p.second &lt; q.second) : (p.second &gt; q.second);\n}\n</code></pre> <p>B\u1ea1n c\u00f3 th\u1ec3 \u0111\u1ecdc v\u1ec1 c\u00e1ch ti\u1ebfp c\u1eadn s\u1eafp x\u1ebfp nhanh h\u01a1n n\u1eefa t\u1ea1i \u0111\u00e2y.</p>","tags":["Translated"]},{"location":"data_structures/sqrt_decomposition.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>Codeforces - Kuriyama Mirai's Stones</li> <li>UVA - 12003 - Array Transformer</li> <li>UVA - 11990 Dynamic Inversion</li> <li>SPOJ - Give Away</li> <li>Codeforces - Till I Collapse</li> <li>Codeforces - Destiny</li> <li>Codeforces - Holes</li> <li>Codeforces - XOR and Favorite Number</li> <li>Codeforces - Powerful array</li> <li>SPOJ - DQUERY</li> <li>Codeforces - Robin Hood Archery</li> </ul>","tags":["Translated"]},{"location":"data_structures/sqrt_decomposition.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 250</li> <li>Translated lines: 250</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Translated"]},{"location":"data_structures/stack_queue_modification.html","title":"Ng\u0103n x\u1ebfp / H\u00e0ng \u0111\u1ee3i t\u00ecm gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t (Minimum stack / Minimum queue)","text":"<p>Trong b\u00e0i vi\u1ebft n\u00e0y, ch\u00fang ta s\u1ebd xem x\u00e9t ba v\u1ea5n \u0111\u1ec1: \u0111\u1ea7u ti\u00ean ch\u00fang ta s\u1ebd s\u1eeda \u0111\u1ed5i ng\u0103n x\u1ebfp (stack) theo c\u00e1ch cho ph\u00e9p ch\u00fang ta t\u00ecm ph\u1ea7n t\u1eed nh\u1ecf nh\u1ea5t c\u1ee7a ng\u0103n x\u1ebfp trong $O(1)$, sau \u0111\u00f3 ch\u00fang ta s\u1ebd l\u00e0m \u0111i\u1ec1u t\u01b0\u01a1ng t\u1ef1 v\u1edbi h\u00e0ng \u0111\u1ee3i (queue), v\u00e0 cu\u1ed1i c\u00f9ng ch\u00fang ta s\u1ebd s\u1eed d\u1ee5ng c\u00e1c c\u1ea5u tr\u00fac d\u1eef li\u1ec7u n\u00e0y \u0111\u1ec3 t\u00ecm gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t trong t\u1ea5t c\u1ea3 c\u00e1c m\u1ea3ng con c\u00f3 \u0111\u1ed9 d\u00e0i c\u1ed1 \u0111\u1ecbnh trong m\u1ed9t m\u1ea3ng trong $O(n)$.</p>","tags":["Translated"]},{"location":"data_structures/stack_queue_modification.html#stack-modification","title":"S\u1eeda \u0111\u1ed5i ng\u0103n x\u1ebfp (Stack modification)","text":"<p>Ch\u00fang ta mu\u1ed1n s\u1eeda \u0111\u1ed5i c\u1ea5u tr\u00fac d\u1eef li\u1ec7u ng\u0103n x\u1ebfp sao cho c\u00f3 th\u1ec3 t\u00ecm th\u1ea5y ph\u1ea7n t\u1eed nh\u1ecf nh\u1ea5t trong ng\u0103n x\u1ebfp trong th\u1eddi gian $O(1)$, trong khi v\u1eabn duy tr\u00ec h\u00e0nh vi ti\u1ec7m c\u1eadn t\u01b0\u01a1ng t\u1ef1 cho vi\u1ec7c th\u00eam v\u00e0 x\u00f3a c\u00e1c ph\u1ea7n t\u1eed kh\u1ecfi ng\u0103n x\u1ebfp. Nh\u1eafc l\u1ea1i nhanh, tr\u00ean m\u1ed9t ng\u0103n x\u1ebfp ch\u00fang ta ch\u1ec9 th\u00eam v\u00e0 x\u00f3a c\u00e1c ph\u1ea7n t\u1eed \u1edf m\u1ed9t \u0111\u1ea7u.</p> <p>\u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y, ch\u00fang ta s\u1ebd kh\u00f4ng ch\u1ec9 l\u01b0u tr\u1eef c\u00e1c ph\u1ea7n t\u1eed trong ng\u0103n x\u1ebfp, m\u00e0 ch\u00fang ta s\u1ebd l\u01b0u tr\u1eef ch\u00fang theo c\u1eb7p: ch\u00ednh ph\u1ea7n t\u1eed \u0111\u00f3 v\u00e0 gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t trong ng\u0103n x\u1ebfp b\u1eaft \u0111\u1ea7u t\u1eeb ph\u1ea7n t\u1eed n\u00e0y tr\u1edf xu\u1ed1ng.</p> <pre><code>stack&lt;pair&lt;int, int&gt;&gt; st;\n</code></pre> <p>R\u00f5 r\u00e0ng l\u00e0 vi\u1ec7c t\u00ecm ki\u1ebfm gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t trong to\u00e0n b\u1ed9 ng\u0103n x\u1ebfp ch\u1ec9 bao g\u1ed3m vi\u1ec7c xem gi\u00e1 tr\u1ecb <code>stack.top().second</code>.</p> <p>C\u0169ng r\u00f5 r\u00e0ng l\u00e0 vi\u1ec7c th\u00eam ho\u1eb7c x\u00f3a m\u1ed9t ph\u1ea7n t\u1eed m\u1edbi v\u00e0o ng\u0103n x\u1ebfp c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong th\u1eddi gian h\u1eb1ng s\u1ed1.</p> <p>C\u00e0i \u0111\u1eb7t:</p> <ul> <li> <p>Th\u00eam m\u1ed9t ph\u1ea7n t\u1eed: <pre><code>int new_min = st.empty() ? new_elem : min(new_elem, st.top().second);\nst.push({new_elem, new_min});\n</code></pre></p> </li> <li> <p>X\u00f3a m\u1ed9t ph\u1ea7n t\u1eed: <pre><code>int removed_element = st.top().first;\nst.pop();\n</code></pre></p> </li> <li> <p>T\u00ecm gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t: <pre><code>int minimum = st.top().second;\n</code></pre></p> </li> </ul>","tags":["Translated"]},{"location":"data_structures/stack_queue_modification.html#queue-modification-method-1","title":"S\u1eeda \u0111\u1ed5i h\u00e0ng \u0111\u1ee3i (ph\u01b0\u01a1ng ph\u00e1p 1) (Queue modification (method 1))","text":"<p>B\u00e2y gi\u1edd ch\u00fang ta mu\u1ed1n \u0111\u1ea1t \u0111\u01b0\u1ee3c c\u00e1c thao t\u00e1c t\u01b0\u01a1ng t\u1ef1 v\u1edbi h\u00e0ng \u0111\u1ee3i, t\u1ee9c l\u00e0 ch\u00fang ta mu\u1ed1n th\u00eam c\u00e1c ph\u1ea7n t\u1eed v\u00e0o cu\u1ed1i v\u00e0 x\u00f3a ch\u00fang kh\u1ecfi \u0111\u1ea7u.</p> <p>\u1ede \u0111\u00e2y ch\u00fang ta xem x\u00e9t m\u1ed9t ph\u01b0\u01a1ng ph\u00e1p \u0111\u01a1n gi\u1ea3n \u0111\u1ec3 s\u1eeda \u0111\u1ed5i h\u00e0ng \u0111\u1ee3i. Tuy nhi\u00ean, n\u00f3 c\u00f3 m\u1ed9t nh\u01b0\u1ee3c \u0111i\u1ec3m l\u1edbn, b\u1edfi v\u00ec h\u00e0ng \u0111\u1ee3i \u0111\u01b0\u1ee3c s\u1eeda \u0111\u1ed5i th\u1ef1c s\u1ef1 s\u1ebd kh\u00f4ng l\u01b0u tr\u1eef t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed.</p> <p>\u00dd t\u01b0\u1edfng ch\u00ednh l\u00e0 ch\u1ec9 l\u01b0u tr\u1eef c\u00e1c m\u1ee5c trong h\u00e0ng \u0111\u1ee3i c\u1ea7n thi\u1ebft \u0111\u1ec3 x\u00e1c \u0111\u1ecbnh gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t. C\u1ee5 th\u1ec3 l\u00e0 ch\u00fang ta s\u1ebd gi\u1eef h\u00e0ng \u0111\u1ee3i theo th\u1ee9 t\u1ef1 kh\u00f4ng gi\u1ea3m (t\u1ee9c l\u00e0 gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t s\u1ebd \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef \u1edf \u0111\u1ea7u), v\u00e0 t\u1ea5t nhi\u00ean kh\u00f4ng ph\u1ea3i theo b\u1ea5t k\u1ef3 c\u00e1ch t\u00f9y \u00fd n\u00e0o, gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t th\u1ef1c t\u1ebf ph\u1ea3i lu\u00f4n \u0111\u01b0\u1ee3c ch\u1ee9a trong h\u00e0ng \u0111\u1ee3i. Theo c\u00e1ch n\u00e0y, ph\u1ea7n t\u1eed nh\u1ecf nh\u1ea5t s\u1ebd lu\u00f4n \u1edf \u0111\u1ea7u h\u00e0ng \u0111\u1ee3i. Tr\u01b0\u1edbc khi th\u00eam m\u1ed9t ph\u1ea7n t\u1eed m\u1edbi v\u00e0o h\u00e0ng \u0111\u1ee3i, ch\u1ec9 c\u1ea7n th\u1ef1c hi\u1ec7n \"c\u1eaft\": ch\u00fang ta s\u1ebd lo\u1ea1i b\u1ecf t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed \u1edf cu\u1ed1i h\u00e0ng \u0111\u1ee3i l\u1edbn h\u01a1n ph\u1ea7n t\u1eed m\u1edbi, v\u00e0 sau \u0111\u00f3 th\u00eam ph\u1ea7n t\u1eed m\u1edbi v\u00e0o h\u00e0ng \u0111\u1ee3i. Theo c\u00e1ch n\u00e0y, ch\u00fang ta kh\u00f4ng ph\u00e1 v\u1ee1 th\u1ee9 t\u1ef1 c\u1ee7a h\u00e0ng \u0111\u1ee3i, v\u00e0 ch\u00fang ta c\u0169ng s\u1ebd kh\u00f4ng l\u00e0m m\u1ea5t ph\u1ea7n t\u1eed hi\u1ec7n t\u1ea1i n\u1ebfu n\u00f3 l\u00e0 gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t \u1edf b\u1ea5t k\u1ef3 b\u01b0\u1edbc ti\u1ebfp theo n\u00e0o. T\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed m\u00e0 ch\u00fang ta \u0111\u00e3 lo\u1ea1i b\u1ecf kh\u00f4ng bao gi\u1edd c\u00f3 th\u1ec3 l\u00e0 ch\u00ednh n\u00f3, v\u00ec v\u1eady thao t\u00e1c n\u00e0y \u0111\u01b0\u1ee3c cho ph\u00e9p. Khi ch\u00fang ta mu\u1ed1n tr\u00edch xu\u1ea5t m\u1ed9t ph\u1ea7n t\u1eed t\u1eeb \u0111\u1ea7u, n\u00f3 th\u1ef1c s\u1ef1 c\u00f3 th\u1ec3 kh\u00f4ng \u1edf \u0111\u00f3 (b\u1edfi v\u00ec ch\u00fang ta \u0111\u00e3 lo\u1ea1i b\u1ecf n\u00f3 tr\u01b0\u1edbc \u0111\u00f3 trong khi th\u00eam m\u1ed9t ph\u1ea7n t\u1eed nh\u1ecf h\u01a1n). Do \u0111\u00f3 khi x\u00f3a m\u1ed9t ph\u1ea7n t\u1eed kh\u1ecfi h\u00e0ng \u0111\u1ee3i, ch\u00fang ta c\u1ea7n bi\u1ebft gi\u00e1 tr\u1ecb c\u1ee7a ph\u1ea7n t\u1eed \u0111\u00f3. N\u1ebfu \u0111\u1ea7u h\u00e0ng \u0111\u1ee3i c\u00f3 c\u00f9ng gi\u00e1 tr\u1ecb, ch\u00fang ta c\u00f3 th\u1ec3 x\u00f3a n\u00f3 m\u1ed9t c\u00e1ch an to\u00e0n, ng\u01b0\u1ee3c l\u1ea1i ch\u00fang ta kh\u00f4ng l\u00e0m g\u00ec c\u1ea3.</p> <p>Xem x\u00e9t vi\u1ec7c c\u00e0i \u0111\u1eb7t c\u00e1c thao t\u00e1c tr\u00ean:</p> <pre><code>deque&lt;int&gt; q;\n</code></pre> <ul> <li> <p>T\u00ecm gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t: <pre><code>int minimum = q.front();\n</code></pre></p> </li> <li> <p>Th\u00eam m\u1ed9t ph\u1ea7n t\u1eed: <pre><code>while (!q.empty() &amp;&amp; q.back() &gt; new_element)\n    q.pop_back();\nq.push_back(new_element);\n</code></pre></p> </li> <li> <p>X\u00f3a m\u1ed9t ph\u1ea7n t\u1eed: <pre><code>if (!q.empty() &amp;&amp; q.front() == remove_element)\n    q.pop_front();\n</code></pre></p> </li> </ul> <p>R\u00f5 r\u00e0ng l\u00e0 trung b\u00ecnh t\u1ea5t c\u1ea3 c\u00e1c thao t\u00e1c n\u00e0y ch\u1ec9 m\u1ea5t th\u1eddi gian $O(1)$ (b\u1edfi v\u00ec m\u1ed7i ph\u1ea7n t\u1eed ch\u1ec9 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c \u0111\u1ea9y v\u00e0 b\u1eadt m\u1ed9t l\u1ea7n).</p>","tags":["Translated"]},{"location":"data_structures/stack_queue_modification.html#queue-modification-method-2","title":"S\u1eeda \u0111\u1ed5i h\u00e0ng \u0111\u1ee3i (ph\u01b0\u01a1ng ph\u00e1p 2) (Queue modification (method 2))","text":"<p>\u0110\u00e2y l\u00e0 m\u1ed9t s\u1eeda \u0111\u1ed5i c\u1ee7a ph\u01b0\u01a1ng ph\u00e1p 1. Ch\u00fang ta mu\u1ed1n c\u00f3 th\u1ec3 x\u00f3a c\u00e1c ph\u1ea7n t\u1eed m\u00e0 kh\u00f4ng c\u1ea7n bi\u1ebft ch\u00fang ta ph\u1ea3i x\u00f3a ph\u1ea7n t\u1eed n\u00e0o. Ch\u00fang ta c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n \u0111i\u1ec1u \u0111\u00f3 b\u1eb1ng c\u00e1ch l\u01b0u tr\u1eef ch\u1ec9 s\u1ed1 cho m\u1ed7i ph\u1ea7n t\u1eed trong h\u00e0ng \u0111\u1ee3i. V\u00e0 ch\u00fang ta c\u0169ng nh\u1edb c\u00f3 bao nhi\u00eau ph\u1ea7n t\u1eed ch\u00fang ta \u0111\u00e3 th\u00eam v\u00e0 x\u00f3a.</p> <pre><code>deque&lt;pair&lt;int, int&gt;&gt; q;\nint cnt_added = 0;\nint cnt_removed = 0;\n</code></pre> <ul> <li> <p>T\u00ecm gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t: <pre><code>int minimum = q.front().first;\n</code></pre></p> </li> <li> <p>Th\u00eam m\u1ed9t ph\u1ea7n t\u1eed: <pre><code>while (!q.empty() &amp;&amp; q.back().first &gt; new_element)\n    q.pop_back();\nq.push_back({new_element, cnt_added});\ncnt_added++;\n</code></pre></p> </li> <li> <p>X\u00f3a m\u1ed9t ph\u1ea7n t\u1eed: <pre><code>if (!q.empty() &amp;&amp; q.front().second == cnt_removed) \n    q.pop_front();\ncnt_removed++;\n</code></pre></p> </li> </ul>","tags":["Translated"]},{"location":"data_structures/stack_queue_modification.html#queue-modification-method-3","title":"S\u1eeda \u0111\u1ed5i h\u00e0ng \u0111\u1ee3i (ph\u01b0\u01a1ng ph\u00e1p 3) (Queue modification (method 3))","text":"<p>\u1ede \u0111\u00e2y ch\u00fang ta xem x\u00e9t m\u1ed9t c\u00e1ch kh\u00e1c \u0111\u1ec3 s\u1eeda \u0111\u1ed5i h\u00e0ng \u0111\u1ee3i \u0111\u1ec3 t\u00ecm gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t trong $O(1)$. C\u00e1ch n\u00e0y c\u00f3 ph\u1ea7n ph\u1ee9c t\u1ea1p h\u01a1n \u0111\u1ec3 c\u00e0i \u0111\u1eb7t, nh\u01b0ng l\u1ea7n n\u00e0y ch\u00fang ta th\u1ef1c s\u1ef1 l\u01b0u tr\u1eef t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed. V\u00e0 ch\u00fang ta c\u0169ng c\u00f3 th\u1ec3 x\u00f3a m\u1ed9t ph\u1ea7n t\u1eed kh\u1ecfi \u0111\u1ea7u m\u00e0 kh\u00f4ng c\u1ea7n bi\u1ebft gi\u00e1 tr\u1ecb c\u1ee7a n\u00f3.</p> <p>\u00dd t\u01b0\u1edfng l\u00e0 gi\u1ea3m b\u00e0i to\u00e1n th\u00e0nh b\u00e0i to\u00e1n c\u1ee7a ng\u0103n x\u1ebfp, v\u1ed1n \u0111\u00e3 \u0111\u01b0\u1ee3c gi\u1ea3i quy\u1ebft b\u1edfi ch\u00fang ta. V\u00ec v\u1eady, ch\u00fang ta ch\u1ec9 c\u1ea7n h\u1ecdc c\u00e1ch m\u00f4 ph\u1ecfng m\u1ed9t h\u00e0ng \u0111\u1ee3i b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng hai ng\u0103n x\u1ebfp.</p> <p>Ch\u00fang ta t\u1ea1o hai ng\u0103n x\u1ebfp, <code>s1</code> v\u00e0 <code>s2</code>. T\u1ea5t nhi\u00ean c\u00e1c ng\u0103n x\u1ebfp n\u00e0y s\u1ebd \u1edf d\u1ea1ng s\u1eeda \u0111\u1ed5i, \u0111\u1ec3 ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm th\u1ea5y gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t trong $O(1)$. Ch\u00fang ta s\u1ebd th\u00eam c\u00e1c ph\u1ea7n t\u1eed m\u1edbi v\u00e0o ng\u0103n x\u1ebfp <code>s1</code>, v\u00e0 x\u00f3a c\u00e1c ph\u1ea7n t\u1eed kh\u1ecfi ng\u0103n x\u1ebfp <code>s2</code>. N\u1ebfu b\u1ea5t c\u1ee9 l\u00fac n\u00e0o ng\u0103n x\u1ebfp <code>s2</code> tr\u1ed1ng, ch\u00fang ta di chuy\u1ec3n t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed t\u1eeb <code>s1</code> sang <code>s2</code> (v\u1ec1 c\u01a1 b\u1ea3n \u0111\u1ea3o ng\u01b0\u1ee3c th\u1ee9 t\u1ef1 c\u1ee7a c\u00e1c ph\u1ea7n t\u1eed \u0111\u00f3). Cu\u1ed1i c\u00f9ng vi\u1ec7c t\u00ecm ki\u1ebfm gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t trong m\u1ed9t h\u00e0ng \u0111\u1ee3i ch\u1ec9 li\u00ean quan \u0111\u1ebfn vi\u1ec7c t\u00ecm gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t c\u1ee7a c\u1ea3 hai ng\u0103n x\u1ebfp.</p> <p>Do \u0111\u00f3, ch\u00fang ta th\u1ef1c hi\u1ec7n t\u1ea5t c\u1ea3 c\u00e1c thao t\u00e1c trong $O(1)$ trung b\u00ecnh (m\u1ed7i ph\u1ea7n t\u1eed s\u1ebd \u0111\u01b0\u1ee3c th\u00eam v\u00e0o ng\u0103n x\u1ebfp <code>s1</code> m\u1ed9t l\u1ea7n, \u0111\u01b0\u1ee3c chuy\u1ec3n sang <code>s2</code> m\u1ed9t l\u1ea7n v\u00e0 \u0111\u01b0\u1ee3c b\u1eadt ra kh\u1ecfi <code>s2</code> m\u1ed9t l\u1ea7n)</p> <p>C\u00e0i \u0111\u1eb7t:</p> <pre><code>stack&lt;pair&lt;int, int&gt;&gt; s1, s2;\n</code></pre> <ul> <li> <p>T\u00ecm gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t: <pre><code>if (s1.empty() || s2.empty()) \n    minimum = s1.empty() ? s2.top().second : s1.top().second;\nelse\n    minimum = min(s1.top().second, s2.top().second);\n</code></pre></p> </li> <li> <p>Th\u00eam ph\u1ea7n t\u1eed: <pre><code>int minimum = s1.empty() ? new_element : min(new_element, s1.top().second);\ns1.push({new_element, minimum});\n</code></pre></p> </li> <li> <p>X\u00f3a m\u1ed9t ph\u1ea7n t\u1eed: <pre><code>if (s2.empty()) {\n    while (!s1.empty()) {\n        int element = s1.top().first;\n        s1.pop();\n        int minimum = s2.empty() ? element : min(element, s2.top().second);\n        s2.push({element, minimum});\n    }\n}\nint remove_element = s2.top().first;\ns2.pop();\n</code></pre></p> </li> </ul>","tags":["Translated"]},{"location":"data_structures/stack_queue_modification.html#finding-the-minimum-for-all-subarrays-of-fixed-length","title":"T\u00ecm gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t cho m\u1ecdi m\u1ea3ng con c\u00f3 \u0111\u1ed9 d\u00e0i c\u1ed1 \u0111\u1ecbnh (Finding the minimum for all subarrays of fixed length)","text":"<p>Gi\u1ea3 s\u1eed ch\u00fang ta \u0111\u01b0\u1ee3c cho m\u1ed9t m\u1ea3ng $A$ c\u00f3 \u0111\u1ed9 d\u00e0i $N$ v\u00e0 m\u1ed9t $M \\le N$ \u0111\u00e3 cho. Ch\u00fang ta ph\u1ea3i t\u00ecm gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t c\u1ee7a m\u1ed7i m\u1ea3ng con c\u00f3 \u0111\u1ed9 d\u00e0i $M$ trong m\u1ea3ng n\u00e0y, t\u1ee9c l\u00e0 ch\u00fang ta ph\u1ea3i t\u00ecm:</p> $$\\min_{0 \\le i \\le M-1} A[i], \\min_{1 \\le i \\le M} A[i], \\min_{2 \\le i \\le M+1} A[i],~\\dots~, \\min_{N-M \\le i \\le N-1} A[i]$$ <p>Ch\u00fang ta ph\u1ea3i gi\u1ea3i quy\u1ebft b\u00e0i to\u00e1n n\u00e0y trong th\u1eddi gian tuy\u1ebfn t\u00ednh, t\u1ee9c l\u00e0 $O(n)$.</p> <p>Ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng b\u1ea5t k\u1ef3 h\u00e0ng \u0111\u1ee3i n\u00e0o trong ba h\u00e0ng \u0111\u1ee3i \u0111\u00e3 s\u1eeda \u0111\u1ed5i \u0111\u1ec3 gi\u1ea3i quy\u1ebft b\u00e0i to\u00e1n. C\u00e1c gi\u1ea3i ph\u00e1p n\u00ean r\u00f5 r\u00e0ng: ch\u00fang ta th\u00eam $M$ ph\u1ea7n t\u1eed \u0111\u1ea7u ti\u00ean c\u1ee7a m\u1ea3ng, t\u00ecm v\u00e0 xu\u1ea5t gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t c\u1ee7a n\u00f3, sau \u0111\u00f3 th\u00eam ph\u1ea7n t\u1eed ti\u1ebfp theo v\u00e0o h\u00e0ng \u0111\u1ee3i v\u00e0 x\u00f3a ph\u1ea7n t\u1eed \u0111\u1ea7u ti\u00ean c\u1ee7a m\u1ea3ng, t\u00ecm v\u00e0 xu\u1ea5t gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t c\u1ee7a n\u00f3, v.v. V\u00ec t\u1ea5t c\u1ea3 c\u00e1c thao t\u00e1c v\u1edbi h\u00e0ng \u0111\u1ee3i \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong th\u1eddi gian h\u1eb1ng s\u1ed1 trung b\u00ecnh, \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a to\u00e0n b\u1ed9 thu\u1eadt to\u00e1n s\u1ebd l\u00e0 $O(n)$.</p>","tags":["Translated"]},{"location":"data_structures/stack_queue_modification.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>Queries with Fixed Length</li> <li>Sliding Window Minimum</li> <li>Binary Land</li> </ul>","tags":["Translated"]},{"location":"data_structures/stack_queue_modification.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 193</li> <li>Translated lines: 193</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Translated"]},{"location":"data_structures/treap.html","title":"Treap (C\u00e2y Descartes)","text":"<p>M\u1ed9t treap l\u00e0 m\u1ed9t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u k\u1ebft h\u1ee3p gi\u1eefa c\u00e2y nh\u1ecb ph\u00e2n (binary tree) v\u00e0 heap nh\u1ecb ph\u00e2n (binary heap) (do \u0111\u00f3 c\u00f3 t\u00ean: tree + heap $\\Rightarrow$ Treap).</p> <p>C\u1ee5 th\u1ec3 h\u01a1n, treap l\u00e0 m\u1ed9t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u l\u01b0u tr\u1eef c\u00e1c c\u1eb7p $(X, Y)$ trong m\u1ed9t c\u00e2y nh\u1ecb ph\u00e2n theo c\u00e1ch m\u00e0 n\u00f3 l\u00e0 m\u1ed9t c\u00e2y t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n theo $X$ v\u00e0 m\u1ed9t heap nh\u1ecb ph\u00e2n theo $Y$. N\u1ebfu m\u1ed9t n\u00fat n\u00e0o \u0111\u00f3 c\u1ee7a c\u00e2y ch\u1ee9a c\u00e1c gi\u00e1 tr\u1ecb $(X_0, Y_0)$, t\u1ea5t c\u1ea3 c\u00e1c n\u00fat trong c\u00e2y con b\u00ean tr\u00e1i c\u00f3 $X \\leq X_0$, t\u1ea5t c\u1ea3 c\u00e1c n\u00fat trong c\u00e2y con b\u00ean ph\u1ea3i c\u00f3 $X_0 \\leq X$, v\u00e0 t\u1ea5t c\u1ea3 c\u00e1c n\u00fat trong c\u1ea3 hai c\u00e2y con b\u00ean tr\u00e1i v\u00e0 b\u00ean ph\u1ea3i \u0111\u1ec1u c\u00f3 $Y \\leq Y_0$.</p> <p>M\u1ed9t treap c\u0169ng th\u01b0\u1eddng \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 \"c\u00e2y Descartes\" (cartesian tree), v\u00ec r\u1ea5t d\u1ec5 nh\u00fang n\u00f3 v\u00e0o m\u1ed9t m\u1eb7t ph\u1eb3ng Descartes:</p> <p>Treap \u0111\u00e3 \u0111\u01b0\u1ee3c \u0111\u1ec1 xu\u1ea5t b\u1edfi Raimund Siedel v\u00e0 Cecilia Aragon v\u00e0o n\u0103m 1989.</p>","tags":["Translated"]},{"location":"data_structures/treap.html#advantages-of-such-data-organisation","title":"\u01afu \u0111i\u1ec3m c\u1ee7a c\u00e1ch t\u1ed5 ch\u1ee9c d\u1eef li\u1ec7u nh\u01b0 v\u1eady (Advantages of such data organisation)","text":"<p>Trong c\u00e1ch c\u00e0i \u0111\u1eb7t nh\u01b0 v\u1eady, c\u00e1c gi\u00e1 tr\u1ecb $X$ l\u00e0 c\u00e1c kh\u00f3a (v\u00e0 \u0111\u1ed3ng th\u1eddi l\u00e0 c\u00e1c gi\u00e1 tr\u1ecb \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef trong treap), v\u00e0 c\u00e1c gi\u00e1 tr\u1ecb $Y$ \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 \u0111\u1ed9 \u01b0u ti\u00ean (priorities). N\u1ebfu kh\u00f4ng c\u00f3 \u0111\u1ed9 \u01b0u ti\u00ean, treap s\u1ebd l\u00e0 m\u1ed9t c\u00e2y t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n th\u00f4ng th\u01b0\u1eddng theo $X$, v\u00e0 m\u1ed9t t\u1eadp h\u1ee3p c\u00e1c gi\u00e1 tr\u1ecb $X$ c\u00f3 th\u1ec3 t\u01b0\u01a1ng \u1ee9ng v\u1edbi r\u1ea5t nhi\u1ec1u c\u00e2y kh\u00e1c nhau, m\u1ed9t s\u1ed1 trong \u0111\u00f3 b\u1ecb suy bi\u1ebfn (v\u00ed d\u1ee5, d\u01b0\u1edbi d\u1ea1ng danh s\u00e1ch li\u00ean k\u1ebft), v\u00e0 do \u0111\u00f3 c\u1ef1c k\u1ef3 ch\u1eadm (c\u00e1c thao t\u00e1c ch\u00ednh s\u1ebd c\u00f3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p $O(N)$).</p> <p>\u0110\u1ed3ng th\u1eddi, \u0111\u1ed9 \u01b0u ti\u00ean (khi ch\u00fang l\u00e0 duy nh\u1ea5t) cho ph\u00e9p x\u00e1c \u0111\u1ecbnh duy nh\u1ea5t c\u00e2y s\u1ebd \u0111\u01b0\u1ee3c x\u00e2y d\u1ef1ng (t\u1ea5t nhi\u00ean, n\u00f3 kh\u00f4ng ph\u1ee5 thu\u1ed9c v\u00e0o th\u1ee9 t\u1ef1 m\u00e0 c\u00e1c gi\u00e1 tr\u1ecb \u0111\u01b0\u1ee3c th\u00eam v\u00e0o), \u0111i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c ch\u1ee9ng minh b\u1eb1ng \u0111\u1ecbnh l\u00fd t\u01b0\u01a1ng \u1ee9ng. R\u00f5 r\u00e0ng, n\u1ebfu b\u1ea1n ch\u1ecdn \u0111\u1ed9 \u01b0u ti\u00ean m\u1ed9t c\u00e1ch ng\u1eabu nhi\u00ean, b\u1ea1n s\u1ebd nh\u1eadn \u0111\u01b0\u1ee3c c\u00e1c c\u00e2y kh\u00f4ng suy bi\u1ebfn v\u1ec1 trung b\u00ecnh, \u0111i\u1ec1u n\u00e0y s\u1ebd \u0111\u1ea3m b\u1ea3o \u0111\u1ed9 ph\u1ee9c t\u1ea1p $O(\\log N)$ cho c\u00e1c thao t\u00e1c ch\u00ednh. Do \u0111\u00f3 t\u00ean g\u1ecdi kh\u00e1c c\u1ee7a c\u1ea5u tr\u00fac d\u1eef li\u1ec7u n\u00e0y - c\u00e2y t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n ng\u1eabu nhi\u00ean (randomized binary search tree).</p>","tags":["Translated"]},{"location":"data_structures/treap.html#operations","title":"C\u00e1c thao t\u00e1c (Operations)","text":"<p>M\u1ed9t treap cung c\u1ea5p c\u00e1c thao t\u00e1c sau:</p> <ul> <li>Insert (X,Y) trong $O(\\log N)$.     Th\u00eam m\u1ed9t n\u00fat m\u1edbi v\u00e0o c\u00e2y. M\u1ed9t bi\u1ebfn th\u1ec3 c\u00f3 th\u1ec3 l\u00e0 ch\u1ec9 truy\u1ec1n $X$ v\u00e0 t\u1ea1o $Y$ ng\u1eabu nhi\u00ean b\u00ean trong thao t\u00e1c.</li> <li>Search (X) trong $O(\\log N)$.     T\u00ecm ki\u1ebfm m\u1ed9t n\u00fat v\u1edbi gi\u00e1 tr\u1ecb kh\u00f3a $X$ \u0111\u01b0\u1ee3c ch\u1ec9 \u0111\u1ecbnh. Vi\u1ec7c c\u00e0i \u0111\u1eb7t gi\u1ed1ng nh\u01b0 \u0111\u1ed1i v\u1edbi m\u1ed9t c\u00e2y t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n th\u00f4ng th\u01b0\u1eddng.</li> <li>Erase (X) trong $O(\\log N)$.     T\u00ecm ki\u1ebfm m\u1ed9t n\u00fat v\u1edbi gi\u00e1 tr\u1ecb kh\u00f3a $X$ \u0111\u01b0\u1ee3c ch\u1ec9 \u0111\u1ecbnh v\u00e0 x\u00f3a n\u00f3 kh\u1ecfi c\u00e2y.</li> <li>Build ($X_1$, ..., $X_N$) trong $O(N)$.     X\u00e2y d\u1ef1ng m\u1ed9t c\u00e2y t\u1eeb m\u1ed9t danh s\u00e1ch c\u00e1c gi\u00e1 tr\u1ecb. \u0110i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong th\u1eddi gian tuy\u1ebfn t\u00ednh (gi\u1ea3 s\u1eed r\u1eb1ng $X_1, ..., X_N$ \u0111\u00e3 \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp).</li> <li>Union ($T_1$, $T_2$) trong $O(M \\log (N/M))$.     H\u1ee3p nh\u1ea5t hai c\u00e2y, gi\u1ea3 s\u1eed r\u1eb1ng t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed \u0111\u1ec1u kh\u00e1c nhau. C\u00f3 th\u1ec3 \u0111\u1ea1t \u0111\u01b0\u1ee3c c\u00f9ng \u0111\u1ed9 ph\u1ee9c t\u1ea1p n\u1ec3u c\u00e1c ph\u1ea7n t\u1eed tr\u00f9ng l\u1eb7p c\u1ea7n \u0111\u01b0\u1ee3c lo\u1ea1i b\u1ecf trong khi h\u1ee3p nh\u1ea5t.</li> <li>Intersect ($T_1$, $T_2$) trong $O(M \\log (N/M))$.     T\u00ecm giao c\u1ee7a hai c\u00e2y (t\u1ee9c l\u00e0 c\u00e1c ph\u1ea7n t\u1eed chung c\u1ee7a ch\u00fang). Ch\u00fang ta s\u1ebd kh\u00f4ng xem x\u00e9t vi\u1ec7c c\u00e0i \u0111\u1eb7t thao t\u00e1c n\u00e0y \u1edf \u0111\u00e2y.</li> </ul> <p>Ngo\u00e0i ra, do th\u1ef1c t\u1ebf l\u00e0 treap l\u00e0 m\u1ed9t c\u00e2y t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n, n\u00f3 c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n c\u00e1c thao t\u00e1c kh\u00e1c, ch\u1eb3ng h\u1ea1n nh\u01b0 t\u00ecm ph\u1ea7n t\u1eed l\u1edbn th\u1ee9 $K$ ho\u1eb7c t\u00ecm ch\u1ec9 s\u1ed1 c\u1ee7a m\u1ed9t ph\u1ea7n t\u1eed.</p>","tags":["Translated"]},{"location":"data_structures/treap.html#implementation-description","title":"M\u00f4 t\u1ea3 c\u00e0i \u0111\u1eb7t (Implementation Description)","text":"<p>V\u1ec1 m\u1eb7t c\u00e0i \u0111\u1eb7t, m\u1ed7i n\u00fat ch\u1ee9a $X$, $Y$ v\u00e0 c\u00e1c con tr\u1ecf \u0111\u1ebfn c\u00e1c con b\u00ean tr\u00e1i ($L$) v\u00e0 b\u00ean ph\u1ea3i ($R$).</p> <p>Ch\u00fang ta s\u1ebd c\u00e0i \u0111\u1eb7t t\u1ea5t c\u1ea3 c\u00e1c thao t\u00e1c c\u1ea7n thi\u1ebft ch\u1ec9 b\u1eb1ng hai thao t\u00e1c ph\u1ee5 tr\u1ee3: Split (T\u00e1ch) v\u00e0 Merge (H\u1ee3p).</p>","tags":["Translated"]},{"location":"data_structures/treap.html#split","title":"Split (T\u00e1ch)","text":"<p>Split ($T$, $X$) t\u00e1ch c\u00e2y $T$ th\u00e0nh 2 c\u00e2y con $L$ v\u00e0 $R$ (l\u00e0 c\u00e1c gi\u00e1 tr\u1ecb tr\u1ea3 v\u1ec1 c\u1ee7a split) sao cho $L$ ch\u1ee9a t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed c\u00f3 kh\u00f3a $X_L \\le X$, v\u00e0 $R$ ch\u1ee9a t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed c\u00f3 kh\u00f3a $X_R &gt; X$. Thao t\u00e1c n\u00e0y c\u00f3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p $O (\\log N)$ v\u00e0 \u0111\u01b0\u1ee3c c\u00e0i \u0111\u1eb7t b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng \u0111\u1ec3 quy s\u1ea1ch:</p> <ol> <li>N\u1ebfu gi\u00e1 tr\u1ecb c\u1ee7a n\u00fat g\u1ed1c (R) l\u00e0 $\\le X$, th\u00ec <code>L</code> \u00edt nh\u1ea5t s\u1ebd bao g\u1ed3m <code>R-&gt;L</code> v\u00e0 <code>R</code>. Sau \u0111\u00f3 ch\u00fang ta g\u1ecdi split tr\u00ean <code>R-&gt;R</code>, v\u00e0 ghi nh\u1eadn k\u1ebft qu\u1ea3 split c\u1ee7a n\u00f3 l\u00e0 <code>L'</code> v\u00e0 <code>R'</code>. Cu\u1ed1i c\u00f9ng, <code>L</code> c\u0169ng s\u1ebd ch\u1ee9a <code>L'</code>, trong khi <code>R = R'</code>.</li> <li>N\u1ebfu gi\u00e1 tr\u1ecb c\u1ee7a n\u00fat g\u1ed1c (R) l\u00e0 $&gt; X$, th\u00ec <code>R</code> \u00edt nh\u1ea5t s\u1ebd bao g\u1ed3m <code>R</code> v\u00e0 <code>R-&gt;R</code>. Sau \u0111\u00f3 ch\u00fang ta g\u1ecdi split tr\u00ean <code>R-&gt;L</code>, v\u00e0 ghi nh\u1eadn k\u1ebft qu\u1ea3 split c\u1ee7a n\u00f3 l\u00e0 <code>L'</code> v\u00e0 <code>R'</code>. Cu\u1ed1i c\u00f9ng, <code>L=L'</code>, trong khi <code>R</code> c\u0169ng s\u1ebd ch\u1ee9a <code>R'</code>.</li> </ol> <p>Do \u0111\u00f3, thu\u1eadt to\u00e1n split l\u00e0:</p> <ol> <li>quy\u1ebft \u0111\u1ecbnh c\u00e2y con n\u00e0o n\u00fat g\u1ed1c s\u1ebd thu\u1ed9c v\u1ec1 (tr\u00e1i ho\u1eb7c ph\u1ea3i)</li> <li>g\u1ecdi \u0111\u1ec7 quy split tr\u00ean m\u1ed9t trong c\u00e1c con c\u1ee7a n\u00f3</li> <li>t\u1ea1o k\u1ebft qu\u1ea3 cu\u1ed1i c\u00f9ng b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng l\u1ea1i l\u1ec7nh g\u1ecdi split \u0111\u1ec7 quy.</li> </ol>","tags":["Translated"]},{"location":"data_structures/treap.html#merge","title":"Merge (H\u1ee3p)","text":"<p>Merge ($T_1$, $T_2$) k\u1ebft h\u1ee3p hai c\u00e2y con $T_1$ v\u00e0 $T_2$ v\u00e0 tr\u1ea3 v\u1ec1 c\u00e2y m\u1edbi. Thao t\u00e1c n\u00e0y c\u0169ng c\u00f3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p $O (\\log N)$. N\u00f3 ho\u1ea1t \u0111\u1ed9ng d\u01b0\u1edbi gi\u1ea3 \u0111\u1ecbnh r\u1eb1ng $T_1$ v\u00e0 $T_2$ \u0111\u00e3 \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp (t\u1ea5t c\u1ea3 c\u00e1c kh\u00f3a $X$ trong $T_1$ \u0111\u1ec1u nh\u1ecf h\u01a1n c\u00e1c kh\u00f3a trong $T_2$). V\u00ec v\u1eady, ch\u00fang ta c\u1ea7n k\u1ebft h\u1ee3p c\u00e1c c\u00e2y n\u00e0y m\u00e0 kh\u00f4ng vi ph\u1ea1m th\u1ee9 t\u1ef1 c\u1ee7a \u0111\u1ed9 \u01b0u ti\u00ean $Y$. \u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y, ch\u00fang ta ch\u1ecdn c\u00e2y n\u00e0o c\u00f3 \u0111\u1ed9 \u01b0u ti\u00ean $Y$ cao h\u01a1n trong n\u00fat g\u1ed1c l\u00e0m g\u1ed1c, v\u00e0 g\u1ecdi \u0111\u1ec7 quy Merge cho c\u00e2y kia v\u00e0 c\u00e2y con t\u01b0\u01a1ng \u1ee9ng c\u1ee7a n\u00fat g\u1ed1c \u0111\u00e3 ch\u1ecdn.</p>","tags":["Translated"]},{"location":"data_structures/treap.html#insert","title":"Insert (Ch\u00e8n)","text":"<p>B\u00e2y gi\u1edd vi\u1ec7c c\u00e0i \u0111\u1eb7t Insert ($X$, $Y$) tr\u1edf n\u00ean r\u00f5 r\u00e0ng. \u0110\u1ea7u ti\u00ean ch\u00fang ta \u0111i xu\u1ed1ng trong c\u00e2y (nh\u01b0 trong m\u1ed9t c\u00e2y t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n th\u00f4ng th\u01b0\u1eddng theo X), v\u00e0 d\u1eebng l\u1ea1i \u1edf n\u00fat \u0111\u1ea7u ti\u00ean m\u00e0 gi\u00e1 tr\u1ecb \u0111\u1ed9 \u01b0u ti\u00ean nh\u1ecf h\u01a1n $Y$. Ch\u00fang ta \u0111\u00e3 t\u00ecm th\u1ea5y n\u01a1i ch\u00fang ta s\u1ebd ch\u00e8n ph\u1ea7n t\u1eed m\u1edbi. Ti\u1ebfp theo, ch\u00fang ta g\u1ecdi Split (T, X) tr\u00ean c\u00e2y con b\u1eaft \u0111\u1ea7u t\u1ea1i n\u00fat t\u00ecm th\u1ea5y, v\u00e0 s\u1eed d\u1ee5ng c\u00e1c c\u00e2y con $L$ v\u00e0 $R$ \u0111\u01b0\u1ee3c tr\u1ea3 v\u1ec1 l\u00e0m con tr\u00e1i v\u00e0 ph\u1ea3i c\u1ee7a n\u00fat m\u1edbi.</p> <p>Ngo\u00e0i ra, insert c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n b\u1eb1ng c\u00e1ch t\u00e1ch treap ban \u0111\u1ea7u theo $X$ v\u00e0 th\u1ef1c hi\u1ec7n $2$ l\u1ea7n merge v\u1edbi n\u00fat m\u1edbi (xem h\u00ecnh).</p>","tags":["Translated"]},{"location":"data_structures/treap.html#erase","title":"Erase (X\u00f3a)","text":"<p>Vi\u1ec7c c\u00e0i \u0111\u1eb7t Erase ($X$) c\u0169ng r\u00f5 r\u00e0ng. \u0110\u1ea7u ti\u00ean ch\u00fang ta \u0111i xu\u1ed1ng trong c\u00e2y (nh\u01b0 trong m\u1ed9t c\u00e2y t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n th\u01b0\u1eddng theo $X$), t\u00ecm ki\u1ebfm ph\u1ea7n t\u1eed ch\u00fang ta mu\u1ed1n x\u00f3a. Khi t\u00ecm th\u1ea5y n\u00fat, ch\u00fang ta g\u1ecdi Merge tr\u00ean c\u00e1c con c\u1ee7a n\u00f3 v\u00e0 \u0111\u1eb7t gi\u00e1 tr\u1ecb tr\u1ea3 v\u1ec1 c\u1ee7a thao t\u00e1c v\u00e0o v\u1ecb tr\u00ed c\u1ee7a ph\u1ea7n t\u1eed ch\u00fang ta \u0111ang x\u00f3a.</p> <p>Ngo\u00e0i ra, ch\u00fang ta c\u00f3 th\u1ec3 t\u00e1ch c\u00e2y con gi\u1eef $X$ b\u1eb1ng $2$ thao t\u00e1c split v\u00e0 h\u1ee3p nh\u1ea5t c\u00e1c treap c\u00f2n l\u1ea1i (xem h\u00ecnh).</p>","tags":["Translated"]},{"location":"data_structures/treap.html#build","title":"Build (X\u00e2y d\u1ef1ng)","text":"<p>Ch\u00fang ta c\u00e0i \u0111\u1eb7t thao t\u00e1c Build v\u1edbi \u0111\u1ed9 ph\u1ee9c t\u1ea1p $O (N \\log N)$ b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng $N$ l\u1ec7nh g\u1ecdi Insert.</p>","tags":["Translated"]},{"location":"data_structures/treap.html#union","title":"Union (H\u1ee3p nh\u1ea5t)","text":"<p>Union ($T_1$, $T_2$) c\u00f3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p l\u00fd thuy\u1ebft l\u00e0 $O (M \\log (N / M))$, nh\u01b0ng trong th\u1ef1c t\u1ebf n\u00f3 ho\u1ea1t \u0111\u1ed9ng r\u1ea5t t\u1ed1t, c\u00f3 th\u1ec3 v\u1edbi m\u1ed9t h\u1eb1ng s\u1ed1 \u1ea9n r\u1ea5t nh\u1ecf. H\u00e3y gi\u1ea3 s\u1eed kh\u00f4ng m\u1ea5t t\u00ednh t\u1ed5ng qu\u00e1t r\u1eb1ng $T_1 \\rightarrow Y &gt; T_2 \\rightarrow Y$, t\u1ee9c l\u00e0 g\u1ed1c c\u1ee7a $T_1$ s\u1ebd l\u00e0 g\u1ed1c c\u1ee7a k\u1ebft qu\u1ea3. \u0110\u1ec3 c\u00f3 \u0111\u01b0\u1ee3c k\u1ebft qu\u1ea3, ch\u00fang ta c\u1ea7n h\u1ee3p nh\u1ea5t c\u00e1c c\u00e2y $T_1 \\rightarrow L$, $T_1 \\rightarrow R$ v\u00e0 $T_2$ th\u00e0nh hai c\u00e2y c\u00f3 th\u1ec3 l\u00e0 con c\u1ee7a g\u1ed1c $T_1$. \u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y, ch\u00fang ta g\u1ecdi Split ($T_2$, $T_1\\rightarrow X$), do \u0111\u00f3 t\u00e1ch $T_2$ th\u00e0nh hai ph\u1ea7n L v\u00e0 R, sau \u0111\u00f3 ch\u00fang ta k\u1ebft h\u1ee3p \u0111\u1ec7 quy v\u1edbi c\u00e1c con c\u1ee7a $T_1$: Union ($T_1 \\rightarrow L$, $L$) v\u00e0 Union ($T_1 \\rightarrow R$, $R$), do \u0111\u00f3 nh\u1eadn \u0111\u01b0\u1ee3c c\u00e1c c\u00e2y con b\u00ean tr\u00e1i v\u00e0 b\u00ean ph\u1ea3i c\u1ee7a k\u1ebft qu\u1ea3.</p>","tags":["Translated"]},{"location":"data_structures/treap.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<pre><code>struct item {\n    int key, prior;\n    item *l, *r;\n    item () { }\n    item (int key) : key(key), prior(rand()), l(NULL), r(NULL) { }\n    item (int key, int prior) : key(key), prior(prior), l(NULL), r(NULL) { }\n};\ntypedef item* pitem;\n</code></pre> <p>\u0110\u00e2y l\u00e0 \u0111\u1ecbnh ngh\u0129a item c\u1ee7a ch\u00fang ta. L\u01b0u \u00fd c\u00f3 hai con tr\u1ecf con, v\u00e0 m\u1ed9t kh\u00f3a s\u1ed1 nguy\u00ean (cho BST) v\u00e0 m\u1ed9t \u0111\u1ed9 \u01b0u ti\u00ean s\u1ed1 nguy\u00ean (cho heap). \u0110\u1ed9 \u01b0u ti\u00ean \u0111\u01b0\u1ee3c g\u00e1n b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng m\u1ed9t b\u1ed9 t\u1ea1o s\u1ed1 ng\u1eabu nhi\u00ean.</p> <pre><code>void split (pitem t, int key, pitem &amp; l, pitem &amp; r) {\n    if (!t)\n        l = r = NULL;\n    else if (t-&gt;key &lt;= key)\n        split (t-&gt;r, key, t-&gt;r, r),  l = t;\n    else\n        split (t-&gt;l, key, l, t-&gt;l),  r = t;\n}\n</code></pre> <p><code>t</code> l\u00e0 treap \u0111\u1ec3 t\u00e1ch, v\u00e0 <code>key</code> l\u00e0 gi\u00e1 tr\u1ecb BST \u0111\u1ec3 t\u00e1ch theo. L\u01b0u \u00fd r\u1eb1ng ch\u00fang ta kh\u00f4ng <code>return</code> gi\u00e1 tr\u1ecb k\u1ebft qu\u1ea3 \u1edf b\u1ea5t c\u1ee9 \u0111\u00e2u, thay v\u00e0o \u0111\u00f3, ch\u00fang ta ch\u1ec9 s\u1eed d\u1ee5ng ch\u00fang nh\u01b0 sau:</p> <pre><code>pitem l = nullptr, r = nullptr;\nsplit(t, 5, l, r);\nif (l) cout &lt;&lt; \"Left subtree size: \" &lt;&lt; (l-&gt;size) &lt;&lt; endl;\nif (r) cout &lt;&lt; \"Right subtree size: \" &lt;&lt; (r-&gt;size) &lt;&lt; endl;\n</code></pre> <p>H\u00e0m <code>split</code> n\u00e0y c\u00f3 th\u1ec3 kh\u00f3 hi\u1ec3u, v\u00ec n\u00f3 c\u00f3 c\u1ea3 con tr\u1ecf (<code>pitem</code>) c\u0169ng nh\u01b0 tham chi\u1ebfu \u0111\u1ebfn c\u00e1c con tr\u1ecf \u0111\u00f3 (<code>pitem &amp;l</code>). H\u00e3y hi\u1ec3u b\u1eb1ng l\u1eddi nh\u1eefng g\u00ec h\u00e0m g\u1ecdi <code>split(t, k, l, r)</code> d\u1ef1 \u0111\u1ecbnh: \"t\u00e1ch treap <code>t</code> theo gi\u00e1 tr\u1ecb <code>k</code> th\u00e0nh hai treap, v\u00e0 l\u01b0u tr\u1eef treap b\u00ean tr\u00e1i trong <code>l</code> v\u00e0 treap b\u00ean ph\u1ea3i trong <code>r</code>\". Tuy\u1ec7t v\u1eddi! B\u00e2y gi\u1edd, h\u00e3y \u00e1p d\u1ee5ng \u0111\u1ecbnh ngh\u0129a n\u00e0y cho hai l\u1ec7nh g\u1ecdi \u0111\u1ec7 quy, s\u1eed d\u1ee5ng tr\u01b0\u1eddng h\u1ee3p ch\u00fang ta \u0111\u00e3 ph\u00e2n t\u00edch trong ph\u1ea7n tr\u01b0\u1edbc: (\u0110i\u1ec1u ki\u1ec7n if \u0111\u1ea7u ti\u00ean l\u00e0 tr\u01b0\u1eddng h\u1ee3p c\u01a1 s\u1edf t\u1ea7m th\u01b0\u1eddng cho m\u1ed9t treap r\u1ed7ng)</p> <ol> <li>Khi gi\u00e1 tr\u1ecb n\u00fat g\u1ed1c l\u00e0 $\\le$ key, ch\u00fang ta g\u1ecdi <code>split (t-&gt;r, key, t-&gt;r, r)</code>, c\u00f3 ngh\u0129a l\u00e0: \"t\u00e1ch treap <code>t-&gt;r</code> (c\u00e2y con b\u00ean ph\u1ea3i c\u1ee7a <code>t</code>) theo gi\u00e1 tr\u1ecb <code>key</code> v\u00e0 l\u01b0u tr\u1eef c\u00e2y con b\u00ean tr\u00e1i trong <code>t-&gt;r</code> v\u00e0 c\u00e2y con b\u00ean ph\u1ea3i trong <code>r</code>\". Sau \u0111\u00f3, ch\u00fang ta \u0111\u1eb7t <code>l = t</code>. L\u01b0u \u00fd b\u00e2y gi\u1edd gi\u00e1 tr\u1ecb k\u1ebft qu\u1ea3 <code>l</code> ch\u1ee9a <code>t-&gt;l</code>, <code>t</code> c\u0169ng nh\u01b0 <code>t-&gt;r</code> (l\u00e0 k\u1ebft qu\u1ea3 c\u1ee7a l\u1ec7nh g\u1ecdi \u0111\u1ec7 quy ch\u00fang ta \u0111\u00e3 th\u1ef1c hi\u1ec7n) t\u1ea5t c\u1ea3 \u0111\u00e3 \u0111\u01b0\u1ee3c h\u1ee3p nh\u1ea5t theo \u0111\u00fang th\u1ee9 t\u1ef1! B\u1ea1n n\u00ean t\u1ea1m d\u1eebng \u0111\u1ec3 \u0111\u1ea3m b\u1ea3o r\u1eb1ng k\u1ebft qu\u1ea3 n\u00e0y c\u1ee7a <code>l</code> v\u00e0 <code>r</code> t\u01b0\u01a1ng \u1ee9ng ch\u00ednh x\u00e1c v\u1edbi nh\u1eefng g\u00ec ch\u00fang ta \u0111\u00e3 th\u1ea3o lu\u1eadn tr\u01b0\u1edbc \u0111\u00f3 trong M\u00f4 t\u1ea3 C\u00e0i \u0111\u1eb7t.</li> <li>Khi gi\u00e1 tr\u1ecb n\u00fat g\u1ed1c l\u1edbn h\u01a1n key, ch\u00fang ta g\u1ecdi <code>split (t-&gt;l, key, l, t-&gt;l)</code>, c\u00f3 ngh\u0129a l\u00e0: \"t\u00e1ch treap <code>t-&gt;l</code> (c\u00e2y con b\u00ean tr\u00e1i c\u1ee7a <code>t</code>) theo gi\u00e1 tr\u1ecb <code>key</code> v\u00e0 l\u01b0u tr\u1eef c\u00e2y con b\u00ean tr\u00e1i trong <code>l</code> v\u00e0 c\u00e2y con b\u00ean ph\u1ea3i trong <code>t-&gt;l</code>\". Sau \u0111\u00f3, ch\u00fang ta \u0111\u1eb7t <code>r = t</code>. L\u01b0u \u00fd b\u00e2y gi\u1edd gi\u00e1 tr\u1ecb k\u1ebft qu\u1ea3 <code>r</code> ch\u1ee9a <code>t-&gt;l</code> (l\u00e0 k\u1ebft qu\u1ea3 c\u1ee7a l\u1ec7nh g\u1ecdi \u0111\u1ec7 quy ch\u00fang ta \u0111\u00e3 th\u1ef1c hi\u1ec7n), <code>t</code> c\u0169ng nh\u01b0 <code>t-&gt;r</code>, t\u1ea5t c\u1ea3 \u0111\u00e3 \u0111\u01b0\u1ee3c h\u1ee3p nh\u1ea5t theo \u0111\u00fang th\u1ee9 t\u1ef1! B\u1ea1n n\u00ean t\u1ea1m d\u1eebng \u0111\u1ec3 \u0111\u1ea3m b\u1ea3o r\u1eb1ng k\u1ebft qu\u1ea3 n\u00e0y c\u1ee7a <code>l</code> v\u00e0 <code>r</code> t\u01b0\u01a1ng \u1ee9ng ch\u00ednh x\u00e1c v\u1edbi nh\u1eefng g\u00ec ch\u00fang ta \u0111\u00e3 th\u1ea3o lu\u1eadn tr\u01b0\u1edbc \u0111\u00f3 trong M\u00f4 t\u1ea3 C\u00e0i \u0111\u1eb7t.</li> </ol> <p>N\u1ebfu b\u1ea1n v\u1eabn g\u1eb7p kh\u00f3 kh\u0103n trong vi\u1ec7c hi\u1ec3u c\u00e0i \u0111\u1eb7t, b\u1ea1n n\u00ean nh\u00ecn v\u00e0o n\u00f3 m\u1ed9t c\u00e1ch quy n\u1ea1p, t\u1ee9c l\u00e0: \u0111\u1eebng c\u1ed1 g\u1eafng ph\u00e1 v\u1ee1 c\u00e1c l\u1ec7nh g\u1ecdi \u0111\u1ec7 quy l\u1eb7p \u0111i l\u1eb7p l\u1ea1i. Gi\u1ea3 s\u1eed vi\u1ec7c c\u00e0i \u0111\u1eb7t split ho\u1ea1t \u0111\u1ed9ng ch\u00ednh x\u00e1c tr\u00ean treap r\u1ed7ng, sau \u0111\u00f3 th\u1eed ch\u1ea1y n\u00f3 cho treap m\u1ed9t n\u00fat, sau \u0111\u00f3 l\u00e0 treap hai n\u00fat, v\u00e0 c\u1ee9 th\u1ebf, m\u1ed7i l\u1ea7n s\u1eed d\u1ee5ng l\u1ea1i ki\u1ebfn th\u1ee9c c\u1ee7a b\u1ea1n r\u1eb1ng split tr\u00ean c\u00e1c treap nh\u1ecf h\u01a1n ho\u1ea1t \u0111\u1ed9ng.</p> <pre><code>void insert (pitem &amp; t, pitem it) {\n    if (!t)\n        t = it;\n    else if (it-&gt;prior &gt; t-&gt;prior)\n        split (t, it-&gt;key, it-&gt;l, it-&gt;r),  t = it;\n    else\n        insert (t-&gt;key &lt;= it-&gt;key ? t-&gt;r : t-&gt;l, it);\n}\n\nvoid merge (pitem &amp; t, pitem l, pitem r) {\n    if (!l || !r)\n        t = l ? l : r;\n    else if (l-&gt;prior &gt; r-&gt;prior)\n        merge (l-&gt;r, l-&gt;r, r),  t = l;\n    else\n        merge (r-&gt;l, l, r-&gt;l),  t = r;\n}\n\nvoid erase (pitem &amp; t, int key) {\n    if (t-&gt;key == key) {\n        pitem th = t;\n        merge (t, t-&gt;l, t-&gt;r);\n        delete th;\n    }\n    else\n        erase (key &lt; t-&gt;key ? t-&gt;l : t-&gt;r, key);\n}\n\npitem unite (pitem l, pitem r) {\n    if (!l || !r)  return l ? l : r;\n    if (l-&gt;prior &lt; r-&gt;prior)  swap (l, r);\n    pitem lt, rt;\n    split (r, l-&gt;key, lt, rt);\n    l-&gt;l = unite (l-&gt;l, lt);\n    l-&gt;r = unite (l-&gt;r, rt);\n    return l;\n}\n</code></pre>","tags":["Translated"]},{"location":"data_structures/treap.html#maintaining-the-sizes-of-subtrees","title":"Duy tr\u00ec k\u00edch th\u01b0\u1edbc c\u1ee7a c\u00e1c c\u00e2y con (Maintaining the sizes of subtrees)","text":"<p>\u0110\u1ec3 m\u1edf r\u1ed9ng ch\u1ee9c n\u0103ng c\u1ee7a treap, th\u01b0\u1eddng c\u1ea7n l\u01b0u tr\u1eef s\u1ed1 l\u01b0\u1ee3ng n\u00fat trong c\u00e2y con c\u1ee7a m\u1ed7i n\u00fat - tr\u01b0\u1eddng <code>int cnt</code> trong c\u1ea5u tr\u00fac <code>item</code>. V\u00ed d\u1ee5, n\u00f3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 t\u00ecm ph\u1ea7n t\u1eed l\u1edbn th\u1ee9 K c\u1ee7a c\u00e2y trong $O (\\log N)$, ho\u1eb7c \u0111\u1ec3 t\u00ecm ch\u1ec9 s\u1ed1 c\u1ee7a ph\u1ea7n t\u1eed trong danh s\u00e1ch \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp v\u1edbi c\u00f9ng \u0111\u1ed9 ph\u1ee9c t\u1ea1p. Vi\u1ec7c c\u00e0i \u0111\u1eb7t c\u00e1c thao t\u00e1c n\u00e0y s\u1ebd gi\u1ed1ng nh\u01b0 \u0111\u1ed1i v\u1edbi c\u00e2y t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n th\u00f4ng th\u01b0\u1eddng.</p> <p>Khi m\u1ed9t c\u00e2y thay \u0111\u1ed5i (c\u00e1c n\u00fat \u0111\u01b0\u1ee3c th\u00eam ho\u1eb7c x\u00f3a, v.v.), <code>cnt</code> c\u1ee7a m\u1ed9t s\u1ed1 n\u00fat n\u00ean \u0111\u01b0\u1ee3c c\u1eadp nh\u1eadt t\u01b0\u01a1ng \u1ee9ng. Ch\u00fang ta s\u1ebd t\u1ea1o hai h\u00e0m: <code>cnt()</code> s\u1ebd tr\u1ea3 v\u1ec1 gi\u00e1 tr\u1ecb hi\u1ec7n t\u1ea1i c\u1ee7a <code>cnt</code> ho\u1eb7c 0 n\u1ebfu n\u00fat kh\u00f4ng t\u1ed3n t\u1ea1i, v\u00e0 <code>upd_cnt()</code> s\u1ebd c\u1eadp nh\u1eadt gi\u00e1 tr\u1ecb c\u1ee7a <code>cnt</code> cho n\u00fat n\u00e0y gi\u1ea3 s\u1eed r\u1eb1ng \u0111\u1ed1i v\u1edbi c\u00e1c con c\u1ee7a n\u00f3 L v\u00e0 R, c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a <code>cnt</code> \u0111\u00e3 \u0111\u01b0\u1ee3c c\u1eadp nh\u1eadt. R\u00f5 r\u00e0ng l\u00e0 \u0111\u1ee7 \u0111\u1ec3 th\u00eam c\u00e1c l\u1ec7nh g\u1ecdi <code>upd_cnt()</code> v\u00e0o cu\u1ed1i <code>insert</code>, <code>erase</code>, <code>split</code> v\u00e0 <code>merge</code> \u0111\u1ec3 gi\u1eef cho c\u00e1c gi\u00e1 tr\u1ecb <code>cnt</code> \u0111\u01b0\u1ee3c c\u1eadp nh\u1eadt.</p> <pre><code>int cnt (pitem t) {\n    return t ? t-&gt;cnt : 0;\n}\n\nvoid upd_cnt (pitem t) {\n    if (t)\n        t-&gt;cnt = 1 + cnt(t-&gt;l) + cnt (t-&gt;r);\n}\n</code></pre>","tags":["Translated"]},{"location":"data_structures/treap.html#building-a-treap-in-o-n-in-offline-mode","title":"X\u00e2y d\u1ef1ng m\u1ed9t Treap trong $O (N)$ \u1edf ch\u1ebf \u0111\u1ed9 offline (Building a Treap in O(N) in offline mode)","text":"<p>Cho m\u1ed9t danh s\u00e1ch c\u00e1c kh\u00f3a \u0111\u00e3 ph\u00e2n lo\u1ea1i, c\u00f3 th\u1ec3 x\u00e2y d\u1ef1ng m\u1ed9t treap nhanh h\u01a1n so v\u1edbi vi\u1ec7c ch\u00e8n c\u00e1c kh\u00f3a t\u1eebng c\u00e1i m\u1ed9t m\u1ea5t $O(N \\log N)$. V\u00ec c\u00e1c kh\u00f3a \u0111\u00e3 \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp, m\u1ed9t c\u00e2y t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n c\u00e2n b\u1eb1ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c x\u00e2y d\u1ef1ng d\u1ec5 d\u00e0ng trong th\u1eddi gian tuy\u1ebfn t\u00ednh. C\u00e1c gi\u00e1 tr\u1ecb heap $Y$ \u0111\u01b0\u1ee3c kh\u1edfi t\u1ea1o ng\u1eabu nhi\u00ean v\u00e0 sau \u0111\u00f3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c heapify \u0111\u1ed9c l\u1eadp v\u1edbi c\u00e1c kh\u00f3a $X$ \u0111\u1ec3 x\u00e2y d\u1ef1ng heap trong $O(N)$.</p> <pre><code>void heapify (pitem t) {\n    if (!t) return;\n    pitem max = t;\n    if (t-&gt;l != NULL &amp;&amp; t-&gt;l-&gt;prior &gt; max-&gt;prior)\n        max = t-&gt;l;\n    if (t-&gt;r != NULL &amp;&amp; t-&gt;r-&gt;prior &gt; max-&gt;prior)\n        max = t-&gt;r;\n    if (max != t) {\n        swap (t-&gt;prior, max-&gt;prior);\n        heapify (max);\n    }\n}\n\npitem build (int * a, int n) {\n    // Construct a treap on values {a[0], a[1], ..., a[n - 1]}\n    if (n == 0) return NULL;\n    int mid = n / 2;\n    pitem t = new item (a[mid], rand ());\n    t-&gt;l = build (a, mid);\n    t-&gt;r = build (a + mid + 1, n - mid - 1);\n    heapify (t);\n    upd_cnt(t)\n    return t;\n}\n</code></pre> <p>L\u01b0u \u00fd: g\u1ecdi <code>upd_cnt(t)</code> ch\u1ec9 c\u1ea7n thi\u1ebft n\u1ebfu b\u1ea1n c\u1ea7n k\u00edch th\u01b0\u1edbc c\u00e2y con.</p> <p>C\u00e1ch ti\u1ebfp c\u1eadn tr\u00ean lu\u00f4n cung c\u1ea5p m\u1ed9t c\u00e2y c\u00e2n b\u1eb1ng ho\u00e0n h\u1ea3o, \u0111i\u1ec1u n\u00e0y th\u01b0\u1eddng t\u1ed1t cho c\u00e1c m\u1ee5c \u0111\u00edch th\u1ef1c t\u1ebf, nh\u01b0ng v\u1edbi c\u00e1i gi\u00e1 l\u00e0 kh\u00f4ng b\u1ea3o t\u1ed3n c\u00e1c \u01b0u ti\u00ean ban \u0111\u1ea7u \u0111\u01b0\u1ee3c g\u00e1n cho m\u1ed7i n\u00fat. Do \u0111\u00f3, c\u00e1ch ti\u1ebfp c\u1eadn n\u00e0y kh\u00f4ng kh\u1ea3 thi \u0111\u1ec3 gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 sau:</p> <p>acmsguru - Cartesian Tree</p> <p>Cho m\u1ed9t d\u00e3y c\u00e1c c\u1eb7p $(x_i, y_i)$, x\u00e2y d\u1ef1ng m\u1ed9t c\u00e2y Descartes tr\u00ean ch\u00fang. T\u1ea5t c\u1ea3 $x_i$ v\u00e0 t\u1ea5t c\u1ea3 $y_i$ l\u00e0 duy nh\u1ea5t.</p> <p>L\u01b0u \u00fd r\u1eb1ng trong b\u00e0i to\u00e1n n\u00e0y c\u00e1c \u01b0u ti\u00ean kh\u00f4ng ph\u1ea3i l\u00e0 ng\u1eabu nhi\u00ean, do \u0111\u00f3 ch\u1ec9 c\u1ea7n ch\u00e8n c\u00e1c \u0111\u1ec9nh t\u1eebng c\u00e1i m\u1ed9t c\u00f3 th\u1ec3 cung c\u1ea5p m\u1ed9t gi\u1ea3i ph\u00e1p b\u1eadc hai.</p> <p>M\u1ed9t trong nh\u1eefng gi\u1ea3i ph\u00e1p kh\u1ea3 thi \u1edf \u0111\u00e2y l\u00e0 t\u00ecm cho m\u1ed7i ph\u1ea7n t\u1eed c\u00e1c ph\u1ea7n t\u1eed g\u1ea7n nh\u1ea5t b\u00ean tr\u00e1i v\u00e0 b\u00ean ph\u1ea3i c\u00f3 \u0111\u1ed9 \u01b0u ti\u00ean nh\u1ecf h\u01a1n ph\u1ea7n t\u1eed n\u00e0y. Trong s\u1ed1 hai ph\u1ea7n t\u1eed n\u00e0y, ph\u1ea7n t\u1eed c\u00f3 \u0111\u1ed9 \u01b0u ti\u00ean l\u1edbn h\u01a1n ph\u1ea3i l\u00e0 cha c\u1ee7a ph\u1ea7n t\u1eed hi\u1ec7n t\u1ea1i.</p> <p>B\u00e0i to\u00e1n n\u00e0y c\u00f3 th\u1ec3 gi\u1ea3i \u0111\u01b0\u1ee3c v\u1edbi s\u1eeda \u0111\u1ed5i ng\u0103n x\u1ebfp t\u00ecm min trong th\u1eddi gian tuy\u1ebfn t\u00ednh:</p> <pre><code>void connect(auto from, auto to) {\n    vector&lt;pitem&gt; st;\n    for(auto it: ranges::subrange(from, to)) {\n        while(!st.empty() &amp;&amp; st.back()-&gt;prior &gt; it-&gt;prior) {\n            st.pop_back();\n        }\n        if(!st.empty()) {\n            if(!it-&gt;p || it-&gt;p-&gt;prior &lt; st.back()-&gt;prior) {\n                it-&gt;p = st.back();\n            }\n        }\n        st.push_back(it);\n    }\n}\n\npitem build(int *x, int *y, int n) {\n    vector&lt;pitem&gt; nodes(n);\n    for(int i = 0; i &lt; n; i++) {\n        nodes[i] = new item(x[i], y[i]);\n    }\n    connect(nodes.begin(), nodes.end());\n    connect(nodes.rbegin(), nodes.rend());\n    for(int i = 0; i &lt; n; i++) {\n        if(nodes[i]-&gt;p) {\n            if(nodes[i]-&gt;p-&gt;key &lt; nodes[i]-&gt;key) {\n                nodes[i]-&gt;p-&gt;r = nodes[i];\n            } else {\n                nodes[i]-&gt;p-&gt;l = nodes[i];\n            }\n        }\n    }\n    return nodes[min_element(y, y + n) - y];\n}\n</code></pre>","tags":["Translated"]},{"location":"data_structures/treap.html#implicit-treaps","title":"Implicit Treaps (Treap ng\u1ea7m \u0111\u1ecbnh)","text":"<p>Treap ng\u1ea7m \u0111\u1ecbnh l\u00e0 m\u1ed9t s\u1eeda \u0111\u1ed5i \u0111\u01a1n gi\u1ea3n c\u1ee7a treap th\u00f4ng th\u01b0\u1eddng nh\u01b0ng l\u00e0 m\u1ed9t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u r\u1ea5t m\u1ea1nh m\u1ebd. Tr\u00ean th\u1ef1c t\u1ebf, treap ng\u1ea7m \u0111\u1ecbnh c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c coi l\u00e0 m\u1ed9t m\u1ea3ng v\u1edbi c\u00e1c th\u1ee7 t\u1ee5c sau \u0111\u01b0\u1ee3c c\u00e0i \u0111\u1eb7t (t\u1ea5t c\u1ea3 trong $O (\\log N)$ trong ch\u1ebf \u0111\u1ed9 tr\u1ef1c tuy\u1ebfn):</p> <ul> <li>Ch\u00e8n m\u1ed9t ph\u1ea7n t\u1eed v\u00e0o m\u1ea3ng \u1edf b\u1ea5t k\u1ef3 v\u1ecb tr\u00ed n\u00e0o</li> <li>X\u00f3a m\u1ed9t ph\u1ea7n t\u1eed t\u00f9y \u00fd</li> <li>T\u00ecm t\u1ed5ng, ph\u1ea7n t\u1eed nh\u1ecf nh\u1ea5t / l\u1edbn nh\u1ea5t, v.v. tr\u00ean m\u1ed9t kho\u1ea3ng t\u00f9y \u00fd</li> <li>Ph\u00e9p c\u1ed9ng, t\u00f4 m\u00e0u tr\u00ean m\u1ed9t kho\u1ea3ng t\u00f9y \u00fd</li> <li>\u0110\u1ea3o ng\u01b0\u1ee3c c\u00e1c ph\u1ea7n t\u1eed tr\u00ean m\u1ed9t kho\u1ea3ng t\u00f9y \u00fd</li> </ul> <p>\u00dd t\u01b0\u1edfng l\u00e0 c\u00e1c kh\u00f3a ph\u1ea3i l\u00e0 c\u00e1c ch\u1ec9 s\u1ed1 d\u1ef1a tr\u00ean null c\u1ee7a c\u00e1c ph\u1ea7n t\u1eed trong m\u1ea3ng. Nh\u01b0ng ch\u00fang ta s\u1ebd kh\u00f4ng l\u01b0u tr\u1eef c\u00e1c gi\u00e1 tr\u1ecb n\u00e0y m\u1ed9t c\u00e1ch r\u00f5 r\u00e0ng (n\u1ebfu kh\u00f4ng, v\u00ed d\u1ee5, ch\u00e8n m\u1ed9t ph\u1ea7n t\u1eed s\u1ebd g\u00e2y ra thay \u0111\u1ed5i kh\u00f3a trong $O (N)$ n\u00fat c\u1ee7a c\u00e2y).</p> <p>L\u01b0u \u00fd r\u1eb1ng kh\u00f3a c\u1ee7a m\u1ed9t n\u00fat l\u00e0 s\u1ed1 l\u01b0\u1ee3ng n\u00fat nh\u1ecf h\u01a1n n\u00f3 (c\u00e1c n\u00fat nh\u01b0 v\u1eady c\u00f3 th\u1ec3 hi\u1ec7n di\u1ec7n kh\u00f4ng ch\u1ec9 trong c\u00e2y con b\u00ean tr\u00e1i c\u1ee7a n\u00f3 m\u00e0 c\u00f2n trong c\u00e1c c\u00e2y con b\u00ean tr\u00e1i c\u1ee7a t\u1ed5 ti\u00ean n\u00f3). C\u1ee5 th\u1ec3 h\u01a1n, kh\u00f3a ng\u1ea7m \u0111\u1ecbnh (implicit key) cho m\u1ed9t s\u1ed1 n\u00fat T l\u00e0 s\u1ed1 l\u01b0\u1ee3ng \u0111\u1ec9nh $cnt (T \\rightarrow L)$ trong c\u00e2y con b\u00ean tr\u00e1i c\u1ee7a n\u00fat n\u00e0y c\u1ed9ng v\u1edbi c\u00e1c gi\u00e1 tr\u1ecb t\u01b0\u01a1ng t\u1ef1 $cnt (P \\rightarrow L) + 1$ cho m\u1ed7i t\u1ed5 ti\u00ean P c\u1ee7a n\u00fat T, v\u00e0 n\u1ebfu T n\u1eb1m trong c\u00e2y con b\u00ean ph\u1ea3i c\u1ee7a P.</p> <p>B\u00e2y gi\u1edd \u0111\u00e3 r\u00f5 c\u00e1ch t\u00ednh to\u00e1n nhanh kh\u00f3a ng\u1ea7m \u0111\u1ecbnh c\u1ee7a n\u00fat hi\u1ec7n t\u1ea1i. V\u00ec trong t\u1ea5t c\u1ea3 c\u00e1c thao t\u00e1c, ch\u00fang ta \u0111\u1ebfn b\u1ea5t k\u1ef3 n\u00fat n\u00e0o b\u1eb1ng c\u00e1ch \u0111i xu\u1ed1ng trong c\u00e2y, ch\u00fang ta ch\u1ec9 c\u00f3 th\u1ec3 t\u00edch l\u0169y t\u1ed5ng n\u00e0y v\u00e0 chuy\u1ec3n n\u00f3 cho h\u00e0m. N\u1ebfu ch\u00fang ta \u0111i \u0111\u1ebfn c\u00e2y con b\u00ean tr\u00e1i, t\u1ed5ng t\u00edch l\u0169y kh\u00f4ng thay \u0111\u1ed5i, n\u1ebfu ch\u00fang ta \u0111i \u0111\u1ebfn c\u00e2y con b\u00ean ph\u1ea3i, n\u00f3 t\u0103ng th\u00eam $cnt (T \\rightarrow L) +1$.</p> <p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 c\u00e1c c\u00e0i \u0111\u1eb7t m\u1edbi c\u1ee7a Split v\u00e0 Merge:</p> <pre><code>void merge (pitem &amp; t, pitem l, pitem r) {\n    if (!l || !r)\n        t = l ? l : r;\n    else if (l-&gt;prior &gt; r-&gt;prior)\n        merge (l-&gt;r, l-&gt;r, r),  t = l;\n    else\n        merge (r-&gt;l, l, r-&gt;l),  t = r;\n    upd_cnt (t);\n}\n\nvoid split (pitem t, pitem &amp; l, pitem &amp; r, int key, int add = 0) {\n    if (!t)\n        return void( l = r = 0 );\n    int cur_key = add + cnt(t-&gt;l); //implicit key\n    if (key &lt;= cur_key)\n        split (t-&gt;l, l, t-&gt;l, key, add),  r = t;\n    else\n        split (t-&gt;r, t-&gt;r, r, key, add + 1 + cnt(t-&gt;l)),  l = t;\n    upd_cnt (t);\n}\n</code></pre> <p>Trong c\u00e0i \u0111\u1eb7t tr\u00ean, sau l\u1ec7nh g\u1ecdi $split(T, T_1, T_2, k)$, c\u00e2y $T_1$ s\u1ebd bao g\u1ed3m $k$ ph\u1ea7n t\u1eed \u0111\u1ea7u ti\u00ean c\u1ee7a $T$ (t\u1ee9c l\u00e0, c\u00e1c ph\u1ea7n t\u1eed c\u00f3 kh\u00f3a ng\u1ea7m \u0111\u1ecbnh nh\u1ecf h\u01a1n $k$) v\u00e0 $T_2$ s\u1ebd bao g\u1ed3m t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n c\u00f2n l\u1ea1i.</p> <p>B\u00e2y gi\u1edd h\u00e3y xem x\u00e9t vi\u1ec7c c\u00e0i \u0111\u1eb7t c\u00e1c thao t\u00e1c kh\u00e1c nhau tr\u00ean c\u00e1c treap ng\u1ea7m \u0111\u1ecbnh:</p> <ul> <li>Ch\u00e8n ph\u1ea7n t\u1eed.     Gi\u1ea3 s\u1eed ch\u00fang ta c\u1ea7n ch\u00e8n m\u1ed9t ph\u1ea7n t\u1eed t\u1ea1i v\u1ecb tr\u00ed $pos$. Ch\u00fang ta chia treap th\u00e0nh hai ph\u1ea7n, t\u01b0\u01a1ng \u1ee9ng v\u1edbi c\u00e1c m\u1ea3ng $[0..pos-1]$ v\u00e0 $[pos..sz]$; \u0111\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y ch\u00fang ta g\u1ecdi $split(T, T_1, T_2, pos)$. Sau \u0111\u00f3 ch\u00fang ta c\u00f3 th\u1ec3 k\u1ebft h\u1ee3p c\u00e2y $T_1$ v\u1edbi \u0111\u1ec9nh m\u1edbi b\u1eb1ng c\u00e1ch g\u1ecdi $merge(T_1, T_1, \\text{new item})$ (d\u1ec5 th\u1ea5y r\u1eb1ng t\u1ea5t c\u1ea3 c\u00e1c \u0111i\u1ec1u ki\u1ec7n ti\u00ean quy\u1ebft \u0111\u1ec1u \u0111\u01b0\u1ee3c \u0111\u00e1p \u1ee9ng). Cu\u1ed1i c\u00f9ng, ch\u00fang ta k\u1ebft h\u1ee3p c\u00e1c c\u00e2y $T_1$ v\u00e0 $T_2$ tr\u1edf l\u1ea1i th\u00e0nh $T$ b\u1eb1ng c\u00e1ch g\u1ecdi $merge(T, T_1, T_2)$.</li> <li>X\u00f3a ph\u1ea7n t\u1eed.     Thao t\u00e1c n\u00e0y th\u1eadm ch\u00ed c\u00f2n d\u1ec5 d\u00e0ng h\u01a1n: t\u00ecm ph\u1ea7n t\u1eed c\u1ea7n x\u00f3a $T$, th\u1ef1c hi\u1ec7n merge c\u00e1c con c\u1ee7a n\u00f3 $L$ v\u00e0 $R$, v\u00e0 thay th\u1ebf ph\u1ea7n t\u1eed $T$ b\u1eb1ng k\u1ebft qu\u1ea3 c\u1ee7a merge. Tr\u00ean th\u1ef1c t\u1ebf, x\u00f3a ph\u1ea7n t\u1eed trong treap ng\u1ea7m \u0111\u1ecbnh ho\u00e0n to\u00e0n gi\u1ed1ng nh\u01b0 trong treap th\u00f4ng th\u01b0\u1eddng.</li> <li>T\u00ecm t\u1ed5ng / gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t, v.v. tr\u00ean kho\u1ea3ng.     \u0110\u1ea7u ti\u00ean, t\u1ea1o th\u00eam m\u1ed9t tr\u01b0\u1eddng $F$ trong c\u1ea5u tr\u00fac <code>item</code> \u0111\u1ec3 l\u01b0u tr\u1eef gi\u00e1 tr\u1ecb c\u1ee7a h\u00e0m m\u1ee5c ti\u00eau cho c\u00e2y con c\u1ee7a n\u00fat n\u00e0y. Tr\u01b0\u1eddng n\u00e0y d\u1ec5 b\u1ea3o tr\u00ec t\u01b0\u01a1ng t\u1ef1 nh\u01b0 duy tr\u00ec k\u00edch th\u01b0\u1edbc c\u1ee7a c\u00e1c c\u00e2y con: t\u1ea1o m\u1ed9t h\u00e0m t\u00ednh to\u00e1n gi\u00e1 tr\u1ecb n\u00e0y cho m\u1ed9t n\u00fat d\u1ef1a tr\u00ean c\u00e1c gi\u00e1 tr\u1ecb cho c\u00e1c con c\u1ee7a n\u00f3 v\u00e0 th\u00eam c\u00e1c l\u1ec7nh g\u1ecdi h\u00e0m n\u00e0y v\u00e0o cu\u1ed1i t\u1ea5t c\u1ea3 c\u00e1c h\u00e0m s\u1eeda \u0111\u1ed5i c\u00e2y.     Th\u1ee9 hai, ch\u00fang ta c\u1ea7n bi\u1ebft c\u00e1ch x\u1eed l\u00fd truy v\u1ea5n cho m\u1ed9t kho\u1ea3ng t\u00f9y \u00fd $[A; B]$.     \u0110\u1ec3 l\u1ea5y m\u1ed9t ph\u1ea7n c\u1ee7a c\u00e2y t\u01b0\u01a1ng \u1ee9ng v\u1edbi kho\u1ea3ng $[A; B]$, ch\u00fang ta c\u1ea7n g\u1ecdi $split(T, T_2, T_3, B+1)$, v\u00e0 sau \u0111\u00f3 $split(T_2, T_1, T_2, A)$: sau \u0111\u00f3 $T_2$ s\u1ebd bao g\u1ed3m t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed trong kho\u1ea3ng $[A; B]$, v\u00e0 ch\u1ec9 ch\u00fang m\u00e0 th\u00f4i. Do \u0111\u00f3, ph\u1ea3n h\u1ed3i cho truy v\u1ea5n s\u1ebd \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef trong tr\u01b0\u1eddng $F$ c\u1ee7a g\u1ed1c c\u1ee7a $T_2$. Sau khi truy v\u1ea5n \u0111\u01b0\u1ee3c tr\u1ea3 l\u1eddi, c\u00e2y ph\u1ea3i \u0111\u01b0\u1ee3c kh\u00f4i ph\u1ee5c b\u1eb1ng c\u00e1ch g\u1ecdi $merge(T, T_1, T_2)$ v\u00e0 $merge(T, T, T_3)$.</li> <li>Ph\u00e9p c\u1ed9ng / t\u00f4 m\u00e0u tr\u00ean kho\u1ea3ng.     Ch\u00fang ta h\u00e0nh \u0111\u1ed9ng t\u01b0\u01a1ng t\u1ef1 nh\u01b0 \u0111o\u1ea1n tr\u01b0\u1edbc, nh\u01b0ng thay v\u00ec tr\u01b0\u1eddng F ch\u00fang ta s\u1ebd l\u01b0u tr\u1eef m\u1ed9t tr\u01b0\u1eddng <code>add</code> s\u1ebd ch\u1ee9a gi\u00e1 tr\u1ecb \u0111\u00e3 th\u00eam cho c\u00e2y con (ho\u1eb7c gi\u00e1 tr\u1ecb m\u00e0 c\u00e2y con \u0111\u01b0\u1ee3c t\u00f4 m\u00e0u). Tr\u01b0\u1edbc khi th\u1ef1c hi\u1ec7n b\u1ea5t k\u1ef3 thao t\u00e1c n\u00e0o, ch\u00fang ta ph\u1ea3i \"\u0111\u1ea9y\" (push) gi\u00e1 tr\u1ecb n\u00e0y m\u1ed9t c\u00e1ch ch\u00ednh x\u00e1c - t\u1ee9c l\u00e0 thay \u0111\u1ed5i $T \\rightarrow L \\rightarrow add$ v\u00e0 $T \\rightarrow R \\rightarrow add$, v\u00e0 l\u00e0m s\u1ea1ch <code>add</code> trong n\u00fat cha. Theo c\u00e1ch n\u00e0y sau b\u1ea5t k\u1ef3 thay \u0111\u1ed5i n\u00e0o \u0111\u1ed1i v\u1edbi c\u00e2y th\u00f4ng tin s\u1ebd kh\u00f4ng b\u1ecb m\u1ea5t.</li> <li>\u0110\u1ea3o ng\u01b0\u1ee3c tr\u00ean kho\u1ea3ng.     \u0110i\u1ec1u n\u00e0y m\u1ed9t l\u1ea7n n\u1eefa t\u01b0\u01a1ng t\u1ef1 nh\u01b0 thao t\u00e1c tr\u01b0\u1edbc: ch\u00fang ta ph\u1ea3i th\u00eam c\u1edd boolean <code>rev</code> v\u00e0 \u0111\u1eb7t n\u00f3 th\u00e0nh true khi c\u00e2y con c\u1ee7a n\u00fat hi\u1ec7n t\u1ea1i ph\u1ea3i \u0111\u01b0\u1ee3c \u0111\u1ea3o ng\u01b0\u1ee3c. Vi\u1ec7c \"\u0111\u1ea9y\" gi\u00e1 tr\u1ecb n\u00e0y h\u01a1i ph\u1ee9c t\u1ea1p - ch\u00fang ta ho\u00e1n \u0111\u1ed5i c\u00e1c con c\u1ee7a n\u00fat n\u00e0y v\u00e0 \u0111\u1eb7t c\u1edd n\u00e0y th\u00e0nh true cho ch\u00fang.</li> </ul> <p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u1ed9t v\u00ed d\u1ee5 c\u00e0i \u0111\u1eb7t c\u1ee7a treap ng\u1ea7m \u0111\u1ecbnh v\u1edbi \u0111\u1ea3o ng\u01b0\u1ee3c tr\u00ean kho\u1ea3ng. \u0110\u1ed1i v\u1edbi m\u1ed7i n\u00fat, ch\u00fang ta l\u01b0u tr\u1eef tr\u01b0\u1eddng \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 <code>value</code> l\u00e0 gi\u00e1 tr\u1ecb th\u1ef1c t\u1ebf c\u1ee7a ph\u1ea7n t\u1eed m\u1ea3ng t\u1ea1i v\u1ecb tr\u00ed hi\u1ec7n t\u1ea1i. Ch\u00fang ta c\u0169ng cung c\u1ea5p vi\u1ec7c c\u00e0i \u0111\u1eb7t h\u00e0m <code>output()</code>, xu\u1ea5t ra m\u1ed9t m\u1ea3ng t\u01b0\u01a1ng \u1ee9ng v\u1edbi tr\u1ea1ng th\u00e1i hi\u1ec7n t\u1ea1i c\u1ee7a treap ng\u1ea7m \u0111\u1ecbnh.</p> <pre><code>typedef struct item * pitem;\nstruct item {\n    int prior, value, cnt;\n    bool rev;\n    pitem l, r;\n};\n\nint cnt (pitem it) {\n    return it ? it-&gt;cnt : 0;\n}\n\nvoid upd_cnt (pitem it) {\n    if (it)\n        it-&gt;cnt = cnt(it-&gt;l) + cnt(it-&gt;r) + 1;\n}\n\nvoid push (pitem it) {\n    if (it &amp;&amp; it-&gt;rev) {\n        it-&gt;rev = false;\n        swap (it-&gt;l, it-&gt;r);\n        if (it-&gt;l)  it-&gt;l-&gt;rev ^= true;\n        if (it-&gt;r)  it-&gt;r-&gt;rev ^= true;\n    }\n}\n\nvoid merge (pitem &amp; t, pitem l, pitem r) {\n    push (l);\n    push (r);\n    if (!l || !r)\n        t = l ? l : r;\n    else if (l-&gt;prior &gt; r-&gt;prior)\n        merge (l-&gt;r, l-&gt;r, r),  t = l;\n    else\n        merge (r-&gt;l, l, r-&gt;l),  t = r;\n    upd_cnt (t);\n}\n\nvoid split (pitem t, pitem &amp; l, pitem &amp; r, int key, int add = 0) {\n    if (!t)\n        return void( l = r = 0 );\n    push (t);\n    int cur_key = add + cnt(t-&gt;l);\n    if (key &lt;= cur_key)\n        split (t-&gt;l, l, t-&gt;l, key, add),  r = t;\n    else\n        split (t-&gt;r, t-&gt;r, r, key, add + 1 + cnt(t-&gt;l)),  l = t;\n    upd_cnt (t);\n}\n\nvoid reverse (pitem t, int l, int r) {\n    pitem t1, t2, t3;\n    split (t, t1, t2, l);\n    split (t2, t2, t3, r-l+1);\n    t2-&gt;rev ^= true;\n    merge (t, t1, t2);\n    merge (t, t, t3);\n}\n\nvoid output (pitem t) {\n    if (!t)  return;\n    push (t);\n    output (t-&gt;l);\n    printf (\"%d \", t-&gt;value);\n    output (t-&gt;r);\n}\n</code></pre>","tags":["Translated"]},{"location":"data_structures/treap.html#literature","title":"T\u00e0i li\u1ec7u tham kh\u1ea3o (Literature)","text":"<ul> <li>Blelloch, Reid-Miller \"Fast Set Operations Using Treaps\"</li> </ul>","tags":["Translated"]},{"location":"data_structures/treap.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>SPOJ - Ada and Aphids</li> <li>SPOJ - Ada and Harvest</li> <li>Codeforces - Radio Stations</li> <li>SPOJ - Ghost Town</li> <li>SPOJ - Arrangement Validity</li> <li>SPOJ - All in One</li> <li>Codeforces - Dog Show</li> <li>Codeforces - Yet Another Array Queries Problem</li> <li>SPOJ - Mean of Array</li> <li>SPOJ - TWIST</li> <li>SPOJ - KOILINE</li> <li>CodeChef - The Prestige</li> <li>Codeforces - T-Shirts</li> <li>Codeforces - Wizards and Roads</li> <li>Codeforces - Yaroslav and Points</li> </ul>","tags":["Translated"]},{"location":"data_structures/treap.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 436</li> <li>Translated lines: 436</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Translated"]},{"location":"dynamic_programming/divide-and-conquer-dp.html","title":"Quy ho\u1ea1ch \u0111\u1ed9ng Chia \u0111\u1ec3 tr\u1ecb (Divide and Conquer DP)","text":"<p>Chia \u0111\u1ec3 tr\u1ecb l\u00e0 m\u1ed9t k\u1ef9 thu\u1eadt t\u1ed1i \u01b0u h\u00f3a quy ho\u1ea1ch \u0111\u1ed9ng.</p>","tags":["Translated"]},{"location":"dynamic_programming/divide-and-conquer-dp.html#preconditions","title":"\u0110i\u1ec1u ki\u1ec7n ti\u00ean quy\u1ebft (Preconditions)","text":"<p>M\u1ed9t s\u1ed1 b\u00e0i to\u00e1n quy ho\u1ea1ch \u0111\u1ed9ng c\u00f3 c\u00f4ng th\u1ee9c truy h\u1ed3i d\u1ea1ng sau:</p> $$ dp(i, j) = \\min_{0 \\leq k \\leq j} \\\\{ dp(i - 1, k - 1) + C(k, j) \\\\} $$ <p>trong \u0111\u00f3 $C(k, j)$ l\u00e0 m\u1ed9t h\u00e0m chi ph\u00ed v\u00e0 $dp(i, j) = 0$ khi $j \\lt 0$.</p> <p>Gi\u1ea3 s\u1eed $0 \\leq i \\lt m$ v\u00e0 $0 \\leq j \\lt n$, v\u00e0 vi\u1ec7c t\u00ednh to\u00e1n $C$ m\u1ea5t th\u1eddi gian $O(1)$. Khi \u0111\u00f3 vi\u1ec7c \u0111\u00e1nh gi\u00e1 tr\u1ef1c ti\u1ebfp c\u00f4ng th\u1ee9c truy h\u1ed3i tr\u00ean l\u00e0 $O(m n^2)$. C\u00f3 $m \\times n$ tr\u1ea1ng th\u00e1i, v\u00e0 $n$ chuy\u1ec3n \u0111\u1ed5i cho m\u1ed7i tr\u1ea1ng th\u00e1i.</p> <p>G\u1ecdi $opt(i, j)$ l\u00e0 gi\u00e1 tr\u1ecb c\u1ee7a $k$ l\u00e0m gi\u1ea3m thi\u1ec3u bi\u1ec3u th\u1ee9c tr\u00ean. Gi\u1ea3 s\u1eed r\u1eb1ng h\u00e0m chi ph\u00ed th\u1ecfa m\u00e3n b\u1ea5t \u0111\u1eb3ng th\u1ee9c t\u1ee9 gi\u00e1c, ch\u00fang ta c\u00f3 th\u1ec3 ch\u1ec9 ra r\u1eb1ng $opt(i, j) \\leq opt(i, j + 1)$ v\u1edbi m\u1ecdi $i, j$. \u0110\u00e2y \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 \u0111i\u1ec1u ki\u1ec7n \u0111\u01a1n \u0111i\u1ec7u (monotonicity condition). Sau \u0111\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 \u00e1p d\u1ee5ng DP chia \u0111\u1ec3 tr\u1ecb. \"\u0110i\u1ec3m chia\" t\u1ed1i \u01b0u cho m\u1ed9t $i$ c\u1ed1 \u0111\u1ecbnh t\u0103ng khi $j$ t\u0103ng.</p> <p>\u0110i\u1ec1u n\u00e0y cho ph\u00e9p ch\u00fang ta gi\u1ea3i quy\u1ebft t\u1ea5t c\u1ea3 c\u00e1c tr\u1ea1ng th\u00e1i hi\u1ec7u qu\u1ea3 h\u01a1n. Gi\u1ea3 s\u1eed ch\u00fang ta t\u00ednh $opt(i, j)$ cho m\u1ed9t s\u1ed1 c\u1ed1 \u0111\u1ecbnh $i$ v\u00e0 $j$. Sau \u0111\u00f3 v\u1edbi b\u1ea5t k\u1ef3 $j' &lt; j$ n\u00e0o ch\u00fang ta bi\u1ebft r\u1eb1ng $opt(i, j') \\leq opt(i, j)$. \u0110i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 khi t\u00ednh to\u00e1n $opt(i, j')$, ch\u00fang ta kh\u00f4ng ph\u1ea3i xem x\u00e9t nhi\u1ec1u \u0111i\u1ec3m chia!</p> <p>\u0110\u1ec3 gi\u1ea3m thi\u1ec3u th\u1eddi gian ch\u1ea1y, ch\u00fang ta \u00e1p d\u1ee5ng \u00fd t\u01b0\u1edfng \u0111\u1eb1ng sau chia \u0111\u1ec3 tr\u1ecb. \u0110\u1ea7u ti\u00ean, t\u00ednh $opt(i, n / 2)$. Sau \u0111\u00f3, t\u00ednh $opt(i, n / 4)$, bi\u1ebft r\u1eb1ng n\u00f3 nh\u1ecf h\u01a1n ho\u1eb7c b\u1eb1ng $opt(i, n / 2)$ v\u00e0 $opt(i, 3 n / 4)$ bi\u1ebft r\u1eb1ng n\u00f3 l\u1edbn h\u01a1n ho\u1eb7c b\u1eb1ng $opt(i, n / 2)$. B\u1eb1ng c\u00e1ch theo d\u00f5i \u0111\u1ec7 quy c\u00e1c gi\u1edbi h\u1ea1n d\u01b0\u1edbi v\u00e0 tr\u00ean tr\u00ean $opt$, ch\u00fang ta \u0111\u1ea1t \u0111\u01b0\u1ee3c th\u1eddi gian ch\u1ea1y $O(m n \\log n)$. M\u1ed7i gi\u00e1 tr\u1ecb c\u00f3 th\u1ec3 c\u00f3 c\u1ee7a $opt(i, j)$ ch\u1ec9 xu\u1ea5t hi\u1ec7n trong $\\log n$ n\u00fat kh\u00e1c nhau.</p> <p>L\u01b0u \u00fd r\u1eb1ng kh\u00f4ng quan tr\u1ecdng $opt(i, j)$ \"c\u00e2n b\u1eb1ng\" nh\u01b0 th\u1ebf n\u00e0o. Qua m\u1ed9t c\u1ea5p \u0111\u1ed9 c\u1ed1 \u0111\u1ecbnh, m\u1ed7i gi\u00e1 tr\u1ecb c\u1ee7a $k$ \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng t\u1ed1i \u0111a hai l\u1ea7n, v\u00e0 c\u00f3 t\u1ed1i \u0111a $\\log n$ c\u1ea5p \u0111\u1ed9.</p>","tags":["Translated"]},{"location":"dynamic_programming/divide-and-conquer-dp.html#generic-implementation","title":"C\u00e0i \u0111\u1eb7t chung (Generic implementation)","text":"<p>M\u1eb7c d\u00f9 vi\u1ec7c c\u00e0i \u0111\u1eb7t thay \u0111\u1ed5i t\u00f9y theo b\u00e0i to\u00e1n, \u0111\u00e2y l\u00e0 m\u1ed9t m\u1eabu kh\u00e1 chung. H\u00e0m <code>compute</code> t\u00ednh to\u00e1n m\u1ed9t h\u00e0ng $i$ c\u1ee7a c\u00e1c tr\u1ea1ng th\u00e1i <code>dp_cur</code>, v\u1edbi h\u00e0ng tr\u01b0\u1edbc $i-1$ c\u1ee7a c\u00e1c tr\u1ea1ng th\u00e1i <code>dp_before</code>. N\u00f3 ph\u1ea3i \u0111\u01b0\u1ee3c g\u1ecdi v\u1edbi <code>compute(0, n-1, 0, n-1)</code>. H\u00e0m <code>solve</code> t\u00ednh to\u00e1n <code>m</code> h\u00e0ng v\u00e0 tr\u1ea3 v\u1ec1 k\u1ebft qu\u1ea3.</p> <pre><code>int m, n;\nvector&lt;long long&gt; dp_before, dp_cur;\n\nlong long C(int i, int j);\n\n// compute dp_cur[l], ... dp_cur[r] (inclusive)\nvoid compute(int l, int r, int optl, int optr) {\n    if (l &gt; r)\n        return;\n\n    int mid = (l + r) &gt;&gt; 1;\n    pair&lt;long long, int&gt; best = {LLONG_MAX, -1};\n\n    for (int k = optl; k &lt;= min(mid, optr); k++) {\n        best = min(best, {(k ? dp_before[k - 1] : 0) + C(k, mid), k});\n    }\n\n    dp_cur[mid] = best.first;\n    int opt = best.second;\n\n    compute(l, mid - 1, optl, opt);\n    compute(mid + 1, r, opt, optr);\n}\n\nlong long solve() {\n    dp_before.assign(n,0);\n    dp_cur.assign(n,0);\n\n    for (int i = 0; i &lt; n; i++)\n        dp_before[i] = C(0, i);\n\n    for (int i = 1; i &lt; m; i++) {\n        compute(0, n - 1, 0, n - 1);\n        dp_before = dp_cur;\n    }\n\n    return dp_before[n - 1];\n}\n</code></pre>","tags":["Translated"]},{"location":"dynamic_programming/divide-and-conquer-dp.html#things-to-look-out-for","title":"Nh\u1eefng \u0111i\u1ec1u c\u1ea7n l\u01b0u \u00fd (Things to look out for)","text":"<p>Kh\u00f3 kh\u0103n l\u1edbn nh\u1ea5t v\u1edbi c\u00e1c b\u00e0i to\u00e1n DP Chia \u0111\u1ec3 tr\u1ecb l\u00e0 ch\u1ee9ng minh t\u00ednh \u0111\u01a1n \u0111i\u1ec7u c\u1ee7a $opt$. M\u1ed9t tr\u01b0\u1eddng h\u1ee3p \u0111\u1eb7c bi\u1ec7t m\u00e0 \u0111i\u1ec1u n\u00e0y \u0111\u00fang l\u00e0 khi h\u00e0m chi ph\u00ed th\u1ecfa m\u00e3n b\u1ea5t \u0111\u1eb3ng th\u1ee9c t\u1ee9 gi\u00e1c, t\u1ee9c l\u00e0, $C(a, c) + C(b, d) \\leq C(a, d) + C(b, c)$ v\u1edbi m\u1ecdi $a \\leq b \\leq c \\leq d$. Nhi\u1ec1u b\u00e0i to\u00e1n DP Chia \u0111\u1ec3 tr\u1ecb c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i quy\u1ebft b\u1eb1ng th\u1ee7 thu\u1eadt Bao l\u1ed3i (Convex Hull trick) ho\u1eb7c ng\u01b0\u1ee3c l\u1ea1i. Vi\u1ec7c bi\u1ebft v\u00e0 hi\u1ec3u c\u1ea3 hai l\u00e0 r\u1ea5t h\u1eefu \u00edch!</p>","tags":["Translated"]},{"location":"dynamic_programming/divide-and-conquer-dp.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>AtCoder - Yakiniku Restaurants</li> <li>CodeForces - Ciel and Gondolas (Be careful with I/O!)</li> <li>CodeForces - Levels And Regions</li> <li>CodeForces - Partition Game</li> <li>CodeForces - The Bakery</li> <li>CodeForces - Yet Another Minimization Problem</li> <li>Codechef - CHEFAOR</li> <li>CodeForces - GUARDS (\u0110\u00e2y ch\u00ednh x\u00e1c l\u00e0 b\u00e0i to\u00e1n trong b\u00e0i vi\u1ebft n\u00e0y.)</li> <li>Hackerrank - Guardians of the Lunatics</li> <li>Hackerrank - Mining</li> <li>Kattis - Money (ACM ICPC World Finals 2017)</li> <li>SPOJ - ADAMOLD</li> <li>SPOJ - LARMY</li> <li>SPOJ - NKLEAVES</li> <li>Timus - Bicolored Horses</li> <li>USACO - Circular Barn</li> <li>UVA - Arranging Heaps</li> <li>UVA - Naming Babies</li> </ul>","tags":["Translated"]},{"location":"dynamic_programming/divide-and-conquer-dp.html#references","title":"T\u00e0i li\u1ec7u tham kh\u1ea3o (References)","text":"<ul> <li>Quora Answer by Michael Levin</li> <li>Video Tutorial by \"Sothe\" the Algorithm Wolf</li> </ul>","tags":["Translated"]},{"location":"dynamic_programming/intro-to-dp.html","title":"Gi\u1edbi thi\u1ec7u v\u1ec1 Quy ho\u1ea1ch \u0111\u1ed9ng (Introduction to Dynamic Programming)","text":"<p>B\u1ea3n ch\u1ea5t c\u1ee7a quy ho\u1ea1ch \u0111\u1ed9ng (dynamic programming) l\u00e0 tr\u00e1nh t\u00ednh to\u00e1n l\u1eb7p l\u1ea1i. Th\u00f4ng th\u01b0\u1eddng, c\u00e1c b\u00e0i to\u00e1n quy ho\u1ea1ch \u0111\u1ed9ng th\u01b0\u1eddng c\u00f3 th\u1ec3 gi\u1ea3i quy\u1ebft m\u1ed9t c\u00e1ch t\u1ef1 nhi\u00ean b\u1eb1ng \u0111\u1ec7 quy. Trong nh\u1eefng tr\u01b0\u1eddng h\u1ee3p nh\u01b0 v\u1eady, c\u00e1ch d\u1ec5 nh\u1ea5t l\u00e0 vi\u1ebft gi\u1ea3i ph\u00e1p \u0111\u1ec7 quy, sau \u0111\u00f3 l\u01b0u l\u1ea1i c\u00e1c tr\u1ea1ng th\u00e1i l\u1eb7p l\u1ea1i trong m\u1ed9t b\u1ea3ng tra c\u1ee9u (lookup table). Qu\u00e1 tr\u00ecnh n\u00e0y \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 quy ho\u1ea1ch \u0111\u1ed9ng t\u1eeb tr\u00ean xu\u1ed1ng (top-down) v\u1edbi ghi nh\u1edb (memoization).</p> <p>M\u1ed9t trong nh\u1eefng v\u00ed d\u1ee5 c\u01a1 b\u1ea3n, kinh \u0111i\u1ec3n nh\u1ea5t c\u1ee7a qu\u00e1 tr\u00ecnh n\u00e0y l\u00e0 d\u00e3y Fibonacci. C\u00f4ng th\u1ee9c \u0111\u1ec7 quy c\u1ee7a n\u00f3 l\u00e0 $f(n) = f(n-1) + f(n-2)$ v\u1edbi $n \\ge 2$ v\u00e0 $f(0)=0$ v\u00e0 $f(1)=1$. Trong C++, \u0111i\u1ec1u n\u00e0y s\u1ebd \u0111\u01b0\u1ee3c bi\u1ec3u th\u1ecb nh\u01b0 sau:</p> <pre><code>int f(int n) {\n    if (n == 0) return 0;\n    if (n == 1) return 1;\n    return f(n - 1) + f(n - 2);\n}\n</code></pre> <p>Th\u1eddi gian ch\u1ea1y c\u1ee7a h\u00e0m \u0111\u1ec7 quy n\u00e0y l\u00e0 c\u1ea5p s\u1ed1 m\u0169 - x\u1ea5p x\u1ec9 $O(2^n)$ v\u00ec m\u1ed9t l\u1ec7nh g\u1ecdi h\u00e0m ($f(n)$) d\u1eabn \u0111\u1ebfn 2 l\u1ec7nh g\u1ecdi h\u00e0m c\u00f3 k\u00edch th\u01b0\u1edbc t\u01b0\u01a1ng t\u1ef1 ($f(n-1)$ v\u00e0 $f(n-2)$).</p>","tags":["Translated"]},{"location":"dynamic_programming/intro-to-dp.html#speeding-up-fibonacci-with-dynamic-programming-memoization","title":"T\u0103ng t\u1ed1c Fibonacci v\u1edbi Quy ho\u1ea1ch \u0111\u1ed9ng (Ghi nh\u1edb) (Speeding up Fibonacci with Dynamic Programming (Memoization))","text":"<p>H\u00e0m \u0111\u1ec7 quy c\u1ee7a ch\u00fang ta hi\u1ec7n gi\u1ea3i quy\u1ebft Fibonacci trong th\u1eddi gian c\u1ea5p s\u1ed1 m\u0169. \u0110i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 ch\u00fang ta ch\u1ec9 c\u00f3 th\u1ec3 x\u1eed l\u00fd c\u00e1c gi\u00e1 tr\u1ecb \u0111\u1ea7u v\u00e0o nh\u1ecf tr\u01b0\u1edbc khi b\u00e0i to\u00e1n tr\u1edf n\u00ean qu\u00e1 kh\u00f3 kh\u0103n. V\u00ed d\u1ee5, $f(29)$ d\u1eabn \u0111\u1ebfn h\u01a1n 1 tri\u1ec7u l\u1ec7nh g\u1ecdi h\u00e0m!</p> <p>\u0110\u1ec3 t\u0103ng t\u1ed1c \u0111\u1ed9, ch\u00fang ta nh\u1eadn ra r\u1eb1ng s\u1ed1 l\u01b0\u1ee3ng b\u00e0i to\u00e1n con ch\u1ec9 l\u00e0 $O(n)$. T\u1ee9c l\u00e0, \u0111\u1ec3 t\u00ednh $f(n)$, ch\u00fang ta ch\u1ec9 c\u1ea7n bi\u1ebft $f(n-1),f(n-2), \\dots ,f(0)$. Do \u0111\u00f3, thay v\u00ec t\u00ednh to\u00e1n l\u1ea1i c\u00e1c b\u00e0i to\u00e1n con n\u00e0y, ch\u00fang ta gi\u1ea3i ch\u00fang m\u1ed9t l\u1ea7n v\u00e0 sau \u0111\u00f3 l\u01b0u k\u1ebft qu\u1ea3 v\u00e0o b\u1ea3ng tra c\u1ee9u. C\u00e1c l\u1ec7nh g\u1ecdi ti\u1ebfp theo s\u1ebd s\u1eed d\u1ee5ng b\u1ea3ng tra c\u1ee9u n\u00e0y v\u00e0 tr\u1ea3 v\u1ec1 k\u1ebft qu\u1ea3 ngay l\u1eadp t\u1ee9c, do \u0111\u00f3 lo\u1ea1i b\u1ecf c\u00f4ng vi\u1ec7c theo c\u1ea5p s\u1ed1 m\u0169!</p> <p>M\u1ed7i l\u1ec7nh g\u1ecdi \u0111\u1ec7 quy s\u1ebd ki\u1ec3m tra b\u1ea3ng tra c\u1ee9u xem gi\u00e1 tr\u1ecb \u0111\u00e3 \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n ch\u01b0a. \u0110i\u1ec1u n\u00e0y \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong th\u1eddi gian $O(1)$. N\u1ebfu ch\u00fang ta \u0111\u00e3 t\u00ednh to\u00e1n n\u00f3 tr\u01b0\u1edbc \u0111\u00f3, h\u00e3y tr\u1ea3 v\u1ec1 k\u1ebft qu\u1ea3, ng\u01b0\u1ee3c l\u1ea1i, ch\u00fang ta t\u00ednh to\u00e1n h\u00e0m m\u1ed9t c\u00e1ch b\u00ecnh th\u01b0\u1eddng. Th\u1eddi gian ch\u1ea1y t\u1ed5ng th\u1ec3 l\u00e0 $O(n)$. \u0110\u00e2y l\u00e0 m\u1ed9t s\u1ef1 c\u1ea3i thi\u1ec7n to l\u1edbn so v\u1edbi thu\u1eadt to\u00e1n th\u1eddi gian c\u1ea5p s\u1ed1 m\u0169 tr\u01b0\u1edbc \u0111\u00e2y c\u1ee7a ch\u00fang ta!</p> <pre><code>const int MAXN = 100;\nbool found[MAXN];\nint memo[MAXN];\n\nint f(int n) {\n    if (found[n]) return memo[n];\n    if (n == 0) return 0;\n    if (n == 1) return 1;\n\n    found[n] = true;\n    return memo[n] = f(n - 1) + f(n - 2);\n}\n</code></pre> <p>V\u1edbi h\u00e0m \u0111\u1ec7 quy \u0111\u00e3 \u0111\u01b0\u1ee3c ghi nh\u1edb m\u1edbi c\u1ee7a ch\u00fang ta, $f(29)$, v\u1ed1n t\u1eebng d\u1eabn \u0111\u1ebfn h\u01a1n 1 tri\u1ec7u cu\u1ed9c g\u1ecdi, gi\u1edd \u0111\u00e2y ch\u1ec9 d\u1eabn \u0111\u1ebfn 57 cu\u1ed9c g\u1ecdi, \u00edt h\u01a1n g\u1ea7n 20.000 l\u1ea7n! Tr\u1edb tr\u00eau thay, b\u00e2y gi\u1edd ch\u00fang ta b\u1ecb gi\u1edbi h\u1ea1n b\u1edfi ki\u1ec3u d\u1eef li\u1ec7u c\u1ee7a ch\u00fang ta. $f(46)$ l\u00e0 s\u1ed1 Fibonacci cu\u1ed1i c\u00f9ng c\u00f3 th\u1ec3 v\u1eeba v\u1edbi m\u1ed9t s\u1ed1 nguy\u00ean 32 bit c\u00f3 d\u1ea5u.</p> <p>Th\u00f4ng th\u01b0\u1eddng, ch\u00fang ta c\u1ed1 g\u1eafng l\u01b0u c\u00e1c tr\u1ea1ng th\u00e1i trong m\u1ea3ng, n\u1ebfu c\u00f3 th\u1ec3, v\u00ec th\u1eddi gian tra c\u1ee9u l\u00e0 $O(1)$ v\u1edbi chi ph\u00ed t\u1ed1i thi\u1ec3u. Tuy nhi\u00ean, t\u1ed5ng qu\u00e1t h\u01a1n, ch\u00fang ta c\u00f3 th\u1ec3 l\u01b0u c\u00e1c tr\u1ea1ng th\u00e1i theo b\u1ea5t k\u1ef3 c\u00e1ch n\u00e0o ch\u00fang ta mu\u1ed1n. C\u00e1c v\u00ed d\u1ee5 kh\u00e1c bao g\u1ed3m c\u00e2y t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n (<code>map</code> trong C++) ho\u1eb7c b\u1ea3ng b\u0103m (<code>unordered_map</code> trong C++).</p> <p>M\u1ed9t v\u00ed d\u1ee5 v\u1ec1 \u0111i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 l\u00e0:</p> <pre><code>unordered_map&lt;int, int&gt; memo;\nint f(int n) {\n    if (memo.count(n)) return memo[n];\n    if (n == 0) return 0;\n    if (n == 1) return 1;\n\n    return memo[n] = f(n - 1) + f(n - 2);\n}\n</code></pre> <p>Ho\u1eb7c t\u01b0\u01a1ng t\u1ef1:</p> <pre><code>map&lt;int, int&gt; memo;\nint f(int n) {\n    if (memo.count(n)) return memo[n];\n    if (n == 0) return 0;\n    if (n == 1) return 1;\n\n    return memo[n] = f(n - 1) + f(n - 2);\n}\n</code></pre> <p>C\u1ea3 hai c\u00e1ch n\u00e0y h\u1ea7u nh\u01b0 s\u1ebd lu\u00f4n ch\u1eadm h\u01a1n phi\u00ean b\u1ea3n d\u1ef1a tr\u00ean m\u1ea3ng \u0111\u1ed1i v\u1edbi m\u1ed9t h\u00e0m \u0111\u1ec7 quy \u0111\u01b0\u1ee3c ghi nh\u1edb chung. C\u00e1c c\u00e1ch l\u01b0u tr\u1ea1ng th\u00e1i thay th\u1ebf n\u00e0y ch\u1ee7 y\u1ebfu h\u1eefu \u00edch khi l\u01b0u c\u00e1c vect\u01a1 ho\u1eb7c chu\u1ed7i nh\u01b0 m\u1ed9t ph\u1ea7n c\u1ee7a kh\u00f4ng gian tr\u1ea1ng th\u00e1i.</p> <p>C\u00e1ch ph\u00e2n t\u00edch th\u1eddi gian ch\u1ea1y c\u1ee7a m\u1ed9t h\u00e0m \u0111\u1ec7 quy \u0111\u01b0\u1ee3c ghi nh\u1edb l\u00e0:</p> $$\\text{c\u00f4ng vi\u1ec7c tr\u00ean m\u1ed7i b\u00e0i to\u00e1n con} * \\text{s\u1ed1 l\u01b0\u1ee3ng b\u00e0i to\u00e1n con}$$ <p>S\u1eed d\u1ee5ng c\u00e2y t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n (map trong C++) \u0111\u1ec3 l\u01b0u c\u00e1c tr\u1ea1ng th\u00e1i v\u1ec1 m\u1eb7t k\u1ef9 thu\u1eadt s\u1ebd d\u1eabn \u0111\u1ebfn $O(n \\log n)$ v\u00ec m\u1ed7i l\u1ea7n tra c\u1ee9u v\u00e0 ch\u00e8n s\u1ebd m\u1ea5t $O(\\log n)$ c\u00f4ng vi\u1ec7c v\u00e0 v\u1edbi $O(n)$ b\u00e0i to\u00e1n con duy nh\u1ea5t, ch\u00fang ta c\u00f3 th\u1eddi gian $O(n \\log n)$.</p> <p>C\u00e1ch ti\u1ebfp c\u1eadn n\u00e0y \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 t\u1eeb tr\u00ean xu\u1ed1ng (top-down), v\u00ec ch\u00fang ta c\u00f3 th\u1ec3 g\u1ecdi h\u00e0m v\u1edbi m\u1ed9t gi\u00e1 tr\u1ecb truy v\u1ea5n v\u00e0 vi\u1ec7c t\u00ednh to\u00e1n b\u1eaft \u0111\u1ea7u \u0111i t\u1eeb tr\u00ean (gi\u00e1 tr\u1ecb \u0111\u01b0\u1ee3c truy v\u1ea5n) xu\u1ed1ng d\u01b0\u1edbi (c\u00e1c tr\u01b0\u1eddng h\u1ee3p c\u01a1 s\u1edf c\u1ee7a \u0111\u1ec7 quy), v\u00e0 th\u1ef1c hi\u1ec7n c\u00e1c \u0111\u01b0\u1eddng t\u1eaft th\u00f4ng qua ghi nh\u1edb tr\u00ean \u0111\u01b0\u1eddng \u0111i.</p>","tags":["Translated"]},{"location":"dynamic_programming/intro-to-dp.html#bottom-up-dynamic-programming","title":"Quy ho\u1ea1ch \u0111\u1ed9ng t\u1eeb d\u01b0\u1edbi l\u00ean (Bottom-up Dynamic Programming)","text":"<p>Cho \u0111\u1ebfn nay, b\u1ea1n ch\u1ec9 m\u1edbi th\u1ea5y quy ho\u1ea1ch \u0111\u1ed9ng t\u1eeb tr\u00ean xu\u1ed1ng v\u1edbi ghi nh\u1edb. Tuy nhi\u00ean, ch\u00fang ta c\u0169ng c\u00f3 th\u1ec3 gi\u1ea3i quy\u1ebft c\u00e1c b\u00e0i to\u00e1n b\u1eb1ng quy ho\u1ea1ch \u0111\u1ed9ng t\u1eeb d\u01b0\u1edbi l\u00ean (bottom-up). Bottom-up ho\u00e0n to\u00e0n \u0111\u1ed1i l\u1eadp v\u1edbi top-down, b\u1ea1n b\u1eaft \u0111\u1ea7u t\u1eeb d\u01b0\u1edbi c\u00f9ng (c\u00e1c tr\u01b0\u1eddng h\u1ee3p c\u01a1 s\u1edf c\u1ee7a \u0111\u1ec7 quy), v\u00e0 m\u1edf r\u1ed9ng n\u00f3 sang ng\u00e0y c\u00e0ng nhi\u1ec1u gi\u00e1 tr\u1ecb.</p> <p>\u0110\u1ec3 t\u1ea1o ra m\u1ed9t c\u00e1ch ti\u1ebfp c\u1eadn t\u1eeb d\u01b0\u1edbi l\u00ean cho c\u00e1c s\u1ed1 Fibonacci, ch\u00fang ta kh\u1edfi t\u1ea1o c\u00e1c tr\u01b0\u1eddng h\u1ee3p c\u01a1 s\u1edf trong m\u1ed9t m\u1ea3ng. Sau \u0111\u00f3, ch\u00fang ta ch\u1ec9 c\u1ea7n s\u1eed d\u1ee5ng \u0111\u1ecbnh ngh\u0129a \u0111\u1ec7 quy tr\u00ean m\u1ea3ng:</p> <pre><code>const int MAXN = 100;\nint fib[MAXN];\n\nint f(int n) {\n    fib[0] = 0;\n    fib[1] = 1;\n    for (int i = 2; i &lt;= n; i++) fib[i] = fib[i - 1] + fib[i - 2];\n\n    return fib[n];\n}\n</code></pre> <p>T\u1ea5t nhi\u00ean, nh\u01b0 \u0111\u00e3 vi\u1ebft, \u0111i\u1ec1u n\u00e0y h\u01a1i ng\u1edb ng\u1ea9n v\u00ec hai l\u00fd do: Th\u1ee9 nh\u1ea5t, ch\u00fang ta th\u1ef1c hi\u1ec7n c\u00f4ng vi\u1ec7c l\u1eb7p l\u1ea1i n\u1ebfu ch\u00fang ta g\u1ecdi h\u00e0m nhi\u1ec1u h\u01a1n m\u1ed9t l\u1ea7n. Th\u1ee9 hai, ch\u00fang ta ch\u1ec9 c\u1ea7n s\u1eed d\u1ee5ng hai gi\u00e1 tr\u1ecb tr\u01b0\u1edbc \u0111\u00f3 \u0111\u1ec3 t\u00ednh to\u00e1n ph\u1ea7n t\u1eed hi\u1ec7n t\u1ea1i. Do \u0111\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 gi\u1ea3m b\u1ed9 nh\u1edb t\u1eeb $O(n)$ xu\u1ed1ng $O(1)$.</p> <p>M\u1ed9t v\u00ed d\u1ee5 v\u1ec1 gi\u1ea3i ph\u00e1p quy ho\u1ea1ch \u0111\u1ed9ng t\u1eeb d\u01b0\u1edbi l\u00ean cho Fibonacci s\u1eed d\u1ee5ng b\u1ed9 nh\u1edb $O(1)$ c\u00f3 th\u1ec3 l\u00e0:</p> <pre><code>const int MAX_SAVE = 3;\nint fib[MAX_SAVE];\n\nint f(int n) {\n    fib[0] = 0;\n    fib[1] = 1;\n    for (int i = 2; i &lt;= n; i++)\n        fib[i % MAX_SAVE] = fib[(i - 1) % MAX_SAVE] + fib[(i - 2) % MAX_SAVE];\n\n    return fib[n % MAX_SAVE];\n}\n</code></pre> <p>L\u01b0u \u00fd r\u1eb1ng ch\u00fang ta \u0111\u00e3 thay \u0111\u1ed5i h\u1eb1ng s\u1ed1 t\u1eeb <code>MAXN</code> SANG <code>MAX_SAVE</code>. \u0110i\u1ec1u n\u00e0y l\u00e0 do t\u1ed5ng s\u1ed1 ph\u1ea7n t\u1eed ch\u00fang ta c\u1ea7n truy c\u1eadp ch\u1ec9 l\u00e0 3. N\u00f3 kh\u00f4ng c\u00f2n t\u1ef7 l\u1ec7 v\u1edbi k\u00edch th\u01b0\u1edbc \u0111\u1ea7u v\u00e0o v\u00e0 theo \u0111\u1ecbnh ngh\u0129a l\u00e0 b\u1ed9 nh\u1edb $O(1)$. Ngo\u00e0i ra, ch\u00fang ta s\u1eed d\u1ee5ng m\u1ed9t th\u1ee7 thu\u1eadt ph\u1ed5 bi\u1ebfn (s\u1eed d\u1ee5ng to\u00e1n t\u1eed modulo) ch\u1ec9 duy tr\u00ec c\u00e1c gi\u00e1 tr\u1ecb m\u00e0 ch\u00fang ta c\u1ea7n.</p> <p>\u0110\u00f3 l\u00e0 t\u1ea5t c\u1ea3. \u0110\u00f3 l\u00e0 nh\u1eefng \u0111i\u1ec1u c\u01a1 b\u1ea3n c\u1ee7a quy ho\u1ea1ch \u0111\u1ed9ng: \u0110\u1eebng l\u1eb7p l\u1ea1i c\u00f4ng vi\u1ec7c b\u1ea1n \u0111\u00e3 l\u00e0m tr\u01b0\u1edbc \u0111\u00f3.</p> <p>M\u1ed9t trong nh\u1eefng th\u1ee7 thu\u1eadt \u0111\u1ec3 l\u00e0m t\u1ed1t h\u01a1n v\u1ec1 quy ho\u1ea1ch \u0111\u1ed9ng l\u00e0 nghi\u00ean c\u1ee9u m\u1ed9t s\u1ed1 v\u00ed d\u1ee5 kinh \u0111i\u1ec3n.</p>","tags":["Translated"]},{"location":"dynamic_programming/intro-to-dp.html#classic-dynamic-programming-problems","title":"C\u00e1c b\u00e0i to\u00e1n Quy ho\u1ea1ch \u0111\u1ed9ng kinh \u0111i\u1ec3n (Classic Dynamic Programming Problems)","text":"T\u00ean M\u00f4 t\u1ea3/V\u00ed d\u1ee5 C\u00e1i t\u00fai 0-1 (0-1 Knapsack) Cho $N$ v\u1eadt ph\u1ea9m v\u1edbi tr\u1ecdng l\u01b0\u1ee3ng $w_i$ v\u00e0 gi\u00e1 tr\u1ecb $v_i$ v\u00e0 tr\u1ecdng l\u01b0\u1ee3ng t\u1ed1i \u0111a $W$, gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t $\\sum_{i=1}^{k} v_i$ cho m\u1ed7i t\u1eadp con c\u00e1c v\u1eadt ph\u1ea9m c\u00f3 k\u00edch th\u01b0\u1edbc $k$ ($1 \\le k \\le N$) trong khi \u0111\u1ea3m b\u1ea3o $\\sum_{i=1}^{k} w_i \\le W$ l\u00e0 bao nhi\u00eau? T\u1ed5ng t\u1eadp con (Subset Sum) Cho $N$ s\u1ed1 nguy\u00ean v\u00e0 $T$, x\u00e1c \u0111\u1ecbnh xem c\u00f3 t\u1ed3n t\u1ea1i m\u1ed9t t\u1eadp con c\u1ee7a t\u1eadp h\u1ee3p \u0111\u00e3 cho c\u00f3 t\u1ed5ng c\u00e1c ph\u1ea7n t\u1eed b\u1eb1ng $T$ hay kh\u00f4ng. D\u00e3y con t\u0103ng d\u00e0i nh\u1ea5t (LIS) B\u1ea1n \u0111\u01b0\u1ee3c cho m\u1ed9t m\u1ea3ng ch\u1ee9a $N$ s\u1ed1 nguy\u00ean. Nhi\u1ec7m v\u1ee5 c\u1ee7a b\u1ea1n l\u00e0 x\u00e1c \u0111\u1ecbnh LIS trong m\u1ea3ng, t\u1ee9c l\u00e0 m\u1ed9t d\u00e3y con m\u00e0 m\u1ed7i ph\u1ea7n t\u1eed \u0111\u1ec1u l\u1edbn h\u01a1n ph\u1ea7n t\u1eed tr\u01b0\u1edbc \u0111\u00f3. \u0110\u1ebfm \u0111\u01b0\u1eddng \u0111i trong m\u1ea3ng 2D (Counting Paths in a 2D Array) Cho $N$ v\u00e0 $M$, \u0111\u1ebfm t\u1ea5t c\u1ea3 c\u00e1c \u0111\u01b0\u1eddng \u0111i ri\u00eang bi\u1ec7t c\u00f3 th\u1ec3 t\u1eeb $(1,1)$ \u0111\u1ebfn $(N, M)$, trong \u0111\u00f3 m\u1ed7i b\u01b0\u1edbc l\u00e0 t\u1eeb $(i,j)$ \u0111\u1ebfn $(i+1,j)$ ho\u1eb7c $(i,j+1)$. D\u00e3y con chung d\u00e0i nh\u1ea5t (Longest Common Subsequence) B\u1ea1n \u0111\u01b0\u1ee3c cho c\u00e1c chu\u1ed7i $s$ v\u00e0 $t$. T\u00ecm \u0111\u1ed9 d\u00e0i c\u1ee7a chu\u1ed7i d\u00e0i nh\u1ea5t l\u00e0 d\u00e3y con c\u1ee7a c\u1ea3 $s$ v\u00e0 $t$. \u0110\u01b0\u1eddng \u0111i d\u00e0i nh\u1ea5t trong \u0111\u1ed3 th\u1ecb c\u00f3 h\u01b0\u1edbng kh\u00f4ng chu tr\u00ecnh (DAG) T\u00ecm \u0111\u01b0\u1eddng \u0111i d\u00e0i nh\u1ea5t trong DAG. D\u00e3y con Palindrome d\u00e0i nh\u1ea5t (Longest Palindromic Subsequence) T\u00ecm D\u00e3y con Palindrome d\u00e0i nh\u1ea5t (LPS) c\u1ee7a m\u1ed9t chu\u1ed7i nh\u1ea5t \u0111\u1ecbnh. C\u1eaft thanh (Rod Cutting) Cho m\u1ed9t thanh c\u00f3 \u0111\u1ed9 d\u00e0i $n$ \u0111\u01a1n v\u1ecb, Cho m\u1ed9t m\u1ea3ng s\u1ed1 nguy\u00ean cuts trong \u0111\u00f3 cuts[i] bi\u1ec3u th\u1ecb m\u1ed9t v\u1ecb tr\u00ed b\u1ea1n n\u00ean th\u1ef1c hi\u1ec7n c\u1eaft. Chi ph\u00ed c\u1ee7a m\u1ed9t l\u1ea7n c\u1eaft l\u00e0 chi\u1ec1u d\u00e0i c\u1ee7a thanh c\u1ea7n c\u1eaft. T\u1ed5ng chi ph\u00ed c\u1eaft nh\u1ecf nh\u1ea5t l\u00e0 bao nhi\u00eau. Kho\u1ea3ng c\u00e1ch ch\u1ec9nh s\u1eeda (Edit Distance) Kho\u1ea3ng c\u00e1ch ch\u1ec9nh s\u1eeda gi\u1eefa hai chu\u1ed7i l\u00e0 s\u1ed1 l\u01b0\u1ee3ng thao t\u00e1c t\u1ed1i thi\u1ec3u c\u1ea7n thi\u1ebft \u0111\u1ec3 bi\u1ebfn \u0111\u1ed5i chu\u1ed7i n\u00e0y th\u00e0nh chu\u1ed7i kia. C\u00e1c thao t\u00e1c l\u00e0 [\"Th\u00eam\", \"X\u00f3a\", \"Thay th\u1ebf\"]","tags":["Translated"]},{"location":"dynamic_programming/intro-to-dp.html#related-topics","title":"C\u00e1c ch\u1ee7 \u0111\u1ec1 li\u00ean quan (Related Topics)","text":"<ul> <li>Quy ho\u1ea1ch \u0111\u1ed9ng Bitmask (Bitmask Dynamic Programming)</li> <li>Quy ho\u1ea1ch \u0111\u1ed9ng ch\u1eef s\u1ed1 (Digit Dynamic Programming)</li> <li>Quy ho\u1ea1ch \u0111\u1ed9ng tr\u00ean c\u00e2y (Dynamic Programming on Trees)</li> </ul> <p>T\u1ea5t nhi\u00ean, th\u1ee7 thu\u1eadt quan tr\u1ecdng nh\u1ea5t l\u00e0 th\u1ef1c h\u00e0nh.</p>","tags":["Translated"]},{"location":"dynamic_programming/intro-to-dp.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>LeetCode - 1137. N-th Tribonacci Number</li> <li>LeetCode - 118. Pascal's Triangle</li> <li>LeetCode - 1025. Divisor Game</li> <li>Codeforces - Vacations</li> <li>Codeforces - Hard problem</li> <li>Codeforces - Zuma</li> <li>LeetCode - 221. Maximal Square</li> <li>LeetCode - 1039. Minimum Score Triangulation of Polygon</li> </ul>","tags":["Translated"]},{"location":"dynamic_programming/intro-to-dp.html#dp-contests","title":"C\u00e1c cu\u1ed9c thi DP (DP Contests)","text":"<ul> <li>Atcoder - Educational DP Contest</li> <li>CSES - Dynamic Programming</li> </ul>","tags":["Translated"]},{"location":"dynamic_programming/intro-to-dp.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 166</li> <li>Translated lines: 166</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Translated"]},{"location":"dynamic_programming/knapsack.html","title":"B\u00e0i to\u00e1n c\u00e1i t\u00fai (Knapsack Problem)","text":"<p>Ki\u1ebfn th\u1ee9c ti\u00ean quy\u1ebft: Gi\u1edbi thi\u1ec7u v\u1ec1 Quy ho\u1ea1ch \u0111\u1ed9ng</p>","tags":["Translated"]},{"location":"dynamic_programming/knapsack.html#introduction","title":"Gi\u1edbi thi\u1ec7u (Introduction)","text":"<p>Xem x\u00e9t v\u00ed d\u1ee5 sau:</p>","tags":["Translated"]},{"location":"dynamic_programming/knapsack.html#usaco07-dec-charm-bracelet","title":"[USACO07 Dec] Charm Bracelet","text":"<p>C\u00f3 $n$ v\u1eadt ph\u1ea9m ri\u00eang bi\u1ec7t v\u00e0 m\u1ed9t c\u00e1i t\u00fai c\u00f3 s\u1ee9c ch\u1ee9a $W$. M\u1ed7i v\u1eadt ph\u1ea9m c\u00f3 2 thu\u1ed9c t\u00ednh, tr\u1ecdng l\u01b0\u1ee3ng ($w_{i}$) v\u00e0 gi\u00e1 tr\u1ecb ($v_{i}$). B\u1ea1n ph\u1ea3i ch\u1ecdn m\u1ed9t t\u1eadp h\u1ee3p con c\u00e1c v\u1eadt ph\u1ea9m \u0111\u1ec3 \u0111\u01b0a v\u00e0o t\u00fai sao cho t\u1ed5ng tr\u1ecdng l\u01b0\u1ee3ng kh\u00f4ng v\u01b0\u1ee3t qu\u00e1 s\u1ee9c ch\u1ee9a $W$ v\u00e0 t\u1ed5ng gi\u00e1 tr\u1ecb \u0111\u01b0\u1ee3c t\u1ed1i \u0111a h\u00f3a.</p> <p>Trong v\u00ed d\u1ee5 tr\u00ean, m\u1ed7i \u0111\u1ed1i t\u01b0\u1ee3ng ch\u1ec9 c\u00f3 hai tr\u1ea1ng th\u00e1i c\u00f3 th\u1ec3 (\u0111\u01b0\u1ee3c ch\u1ecdn ho\u1eb7c kh\u00f4ng \u0111\u01b0\u1ee3c ch\u1ecdn), t\u01b0\u01a1ng \u1ee9ng v\u1edbi nh\u1ecb ph\u00e2n 0 v\u00e0 1. Do \u0111\u00f3, lo\u1ea1i b\u00e0i to\u00e1n n\u00e0y \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 \"b\u00e0i to\u00e1n c\u00e1i t\u00fai 0-1\" (0-1 knapsack problem).</p>","tags":["Translated"]},{"location":"dynamic_programming/knapsack.html#0-1-knapsack","title":"C\u00e1i t\u00fai 0-1 (0-1 Knapsack)","text":"","tags":["Translated"]},{"location":"dynamic_programming/knapsack.html#explanation","title":"Gi\u1ea3i th\u00edch (Explanation)","text":"<p>Trong v\u00ed d\u1ee5 tr\u00ean, \u0111\u1ea7u v\u00e0o c\u1ee7a b\u00e0i to\u00e1n l\u00e0: tr\u1ecdng l\u01b0\u1ee3ng c\u1ee7a v\u1eadt ph\u1ea9m th\u1ee9 $i$ l\u00e0 $w_{i}$, gi\u00e1 tr\u1ecb c\u1ee7a v\u1eadt ph\u1ea9m th\u1ee9 $i$ l\u00e0 $v_{i}$, v\u00e0 t\u1ed5ng s\u1ee9c ch\u1ee9a c\u1ee7a c\u00e1i t\u00fai $W$.</p> <p>G\u1ecdi $f_{i, j}$ l\u00e0 tr\u1ea1ng th\u00e1i quy ho\u1ea1ch \u0111\u1ed9ng gi\u1eef t\u1ed5ng gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t m\u00e0 c\u00e1i t\u00fai c\u00f3 th\u1ec3 mang v\u1edbi s\u1ee9c ch\u1ee9a $j$, khi ch\u1ec9 xem x\u00e9t $i$ v\u1eadt ph\u1ea9m \u0111\u1ea7u ti\u00ean.</p> <p>Gi\u1ea3 s\u1eed r\u1eb1ng t\u1ea5t c\u1ea3 c\u00e1c tr\u1ea1ng th\u00e1i c\u1ee7a $i-1$ v\u1eadt ph\u1ea9m \u0111\u1ea7u ti\u00ean \u0111\u00e3 \u0111\u01b0\u1ee3c x\u1eed l\u00fd, c\u00e1c l\u1ef1a ch\u1ecdn cho v\u1eadt ph\u1ea9m th\u1ee9 $i$ l\u00e0 g\u00ec?</p> <ul> <li>Khi n\u00f3 kh\u00f4ng \u0111\u01b0\u1ee3c \u0111\u01b0a v\u00e0o t\u00fai, s\u1ee9c ch\u1ee9a c\u00f2n l\u1ea1i kh\u00f4ng \u0111\u1ed5i v\u00e0 t\u1ed5ng gi\u00e1 tr\u1ecb kh\u00f4ng thay \u0111\u1ed5i. Do \u0111\u00f3, gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y l\u00e0 $f_{i-1, j}$</li> <li>Khi n\u00f3 \u0111\u01b0\u1ee3c \u0111\u01b0a v\u00e0o t\u00fai, s\u1ee9c ch\u1ee9a c\u00f2n l\u1ea1i gi\u1ea3m \u0111i $w_{i}$ v\u00e0 t\u1ed5ng gi\u00e1 tr\u1ecb t\u0103ng th\u00eam $v_{i}$,     do \u0111\u00f3 gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y l\u00e0 $f_{i-1, j-w_i} + v_i$</li> </ul> <p>T\u1eeb \u0111\u00e2y ch\u00fang ta c\u00f3 th\u1ec3 suy ra ph\u01b0\u01a1ng tr\u00ecnh chuy\u1ec3n tr\u1ea1ng th\u00e1i dp:</p> $$f_{i, j} = \\max(f_{i-1, j}, f_{i-1, j-w_i} + v_i)$$ <p>H\u01a1n n\u1eefa, v\u00ec $f_{i}$ ch\u1ec9 ph\u1ee5 thu\u1ed9c v\u00e0o $f_{i-1}$, ch\u00fang ta c\u00f3 th\u1ec3 lo\u1ea1i b\u1ecf chi\u1ec1u \u0111\u1ea7u ti\u00ean. Ch\u00fang ta thu \u0111\u01b0\u1ee3c quy t\u1eafc chuy\u1ec3n tr\u1ea1ng th\u00e1i</p> $$f_j \\gets \\max(f_j, f_{j-w_i}+v_i)$$ <p>\u0111i\u1ec1u n\u00e0y n\u00ean \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n theo th\u1ee9 t\u1ef1 gi\u1ea3m d\u1ea7n c\u1ee7a $j$ (\u0111\u1ec3 $f_{j-w_i}$ t\u01b0\u01a1ng \u1ee9ng ng\u1ea7m \u0111\u1ecbnh v\u1edbi $f_{i-1,j-w_i}$ ch\u1ee9 kh\u00f4ng ph\u1ea3i $f_{i,j-w_i}$).</p> <p>\u0110i\u1ec1u quan tr\u1ecdng l\u00e0 ph\u1ea3i hi\u1ec3u quy t\u1eafc chuy\u1ec3n \u0111\u1ed5i n\u00e0y, b\u1edfi v\u00ec h\u1ea7u h\u1ebft c\u00e1c chuy\u1ec3n \u0111\u1ed5i cho c\u00e1c b\u00e0i to\u00e1n c\u00e1i t\u00fai \u0111\u1ec1u \u0111\u01b0\u1ee3c suy ra theo c\u00e1ch t\u01b0\u01a1ng t\u1ef1.</p>","tags":["Translated"]},{"location":"dynamic_programming/knapsack.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>Thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c c\u00e0i \u0111\u1eb7t trong $O(nW)$ nh\u01b0 sau:</p> <pre><code>for (int i = 1; i &lt;= n; i++)\n  for (int j = W; j &gt;= w[i]; j--)\n    f[j] = max(f[j], f[j - w[i]] + v[i]);\n</code></pre> <p>M\u1ed9t l\u1ea7n n\u1eefa, l\u01b0u \u00fd th\u1ee9 t\u1ef1 th\u1ef1c hi\u1ec7n. N\u00f3 ph\u1ea3i \u0111\u01b0\u1ee3c tu\u00e2n th\u1ee7 nghi\u00eam ng\u1eb7t \u0111\u1ec3 \u0111\u1ea3m b\u1ea3o b\u1ea5t bi\u1ebfn sau: Ngay tr\u01b0\u1edbc khi c\u1eb7p $(i, j)$ \u0111\u01b0\u1ee3c x\u1eed l\u00fd, $f_k$ t\u01b0\u01a1ng \u1ee9ng v\u1edbi $f_{i,k}$ cho $k &gt; j$, nh\u01b0ng v\u1edbi $f_{i-1,k}$ cho $k &lt; j$. \u0110i\u1ec1u n\u00e0y \u0111\u1ea3m b\u1ea3o r\u1eb1ng $f_{j-w_i}$ \u0111\u01b0\u1ee3c l\u1ea5y t\u1eeb b\u01b0\u1edbc th\u1ee9 $(i-1)$, thay v\u00ec t\u1eeb b\u01b0\u1edbc th\u1ee9 $i$.</p>","tags":["Translated"]},{"location":"dynamic_programming/knapsack.html#complete-knapsack","title":"C\u00e1i t\u00fai ho\u00e0n ch\u1ec9nh (Complete Knapsack)","text":"<p>M\u00f4 h\u00ecnh c\u00e1i t\u00fai ho\u00e0n ch\u1ec9nh t\u01b0\u01a1ng t\u1ef1 nh\u01b0 c\u00e1i t\u00fai 0-1, s\u1ef1 kh\u00e1c bi\u1ec7t duy nh\u1ea5t so v\u1edbi c\u00e1i t\u00fai 0-1 l\u00e0 m\u1ed9t v\u1eadt ph\u1ea9m c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c ch\u1ecdn s\u1ed1 l\u1ea7n kh\u00f4ng gi\u1edbi h\u1ea1n thay v\u00ec ch\u1ec9 m\u1ed9t l\u1ea7n.</p> <p>Ch\u00fang ta c\u00f3 th\u1ec3 tham kh\u1ea3o \u00fd t\u01b0\u1edfng c\u1ee7a c\u00e1i t\u00fai 0-1 \u0111\u1ec3 \u0111\u1ecbnh ngh\u0129a tr\u1ea1ng th\u00e1i: $f_{i, j}$, gi\u00e1 tr\u1ecb t\u1ed1i \u0111a m\u00e0 c\u00e1i t\u00fai c\u00f3 th\u1ec3 \u0111\u1ea1t \u0111\u01b0\u1ee3c b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng $i$ v\u1eadt ph\u1ea9m \u0111\u1ea7u ti\u00ean v\u1edbi s\u1ee9c ch\u1ee9a t\u1ed1i \u0111a $j$.</p> <p>C\u1ea7n l\u01b0u \u00fd r\u1eb1ng m\u1eb7c d\u00f9 \u0111\u1ecbnh ngh\u0129a tr\u1ea1ng th\u00e1i t\u01b0\u01a1ng t\u1ef1 nh\u01b0 \u0111\u1ecbnh ngh\u0129a c\u1ee7a c\u00e1i t\u00fai 0-1, quy t\u1eafc chuy\u1ec3n tr\u1ea1ng th\u00e1i c\u1ee7a n\u00f3 kh\u00e1c v\u1edbi quy t\u1eafc c\u1ee7a c\u00e1i t\u00fai 0-1.</p>","tags":["Translated"]},{"location":"dynamic_programming/knapsack.html#explanation-1","title":"Gi\u1ea3i th\u00edch (Explanation)","text":"<p>C\u00e1ch ti\u1ebfp c\u1eadn t\u1ea7m th\u01b0\u1eddng l\u00e0, \u0111\u1ed1i v\u1edbi $i$ v\u1eadt ph\u1ea9m \u0111\u1ea7u ti\u00ean, h\u00e3y li\u1ec7t k\u00ea s\u1ed1 l\u1ea7n m\u1ed7i v\u1eadt ph\u1ea9m \u0111\u01b0\u1ee3c l\u1ea5y. \u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian c\u1ee7a vi\u1ec7c n\u00e0y l\u00e0 $O(n^2W)$.</p> <p>\u0110i\u1ec1u n\u00e0y mang l\u1ea1i ph\u01b0\u01a1ng tr\u00ecnh chuy\u1ec3n tr\u1ea1ng th\u00e1i sau:</p> $$f_{i, j} = \\max\\limits_{k=0}^{\\infty}(f_{i-1, j-k\\cdot w_i} + k\\cdot v_i)$$ <p>\u0110\u1ed3ng th\u1eddi, n\u00f3 \u0111\u01a1n gi\u1ea3n h\u00f3a th\u00e0nh m\u1ed9t ph\u01b0\u01a1ng tr\u00ecnh \"ph\u1eb3ng\":</p> $$f_{i, j} = \\max(f_{i-1, j},f_{i, j-w_i} + v_i)$$ <p>L\u00fd do \u0111i\u1ec1u n\u00e0y ho\u1ea1t \u0111\u1ed9ng l\u00e0 v\u00ec $f_{i, j-w_i}$ \u0111\u00e3 \u0111\u01b0\u1ee3c c\u1eadp nh\u1eadt b\u1edfi $f_{i, j-2\\cdot w_i}$ v\u00e0 c\u1ee9 th\u1ebf.</p> <p>T\u01b0\u01a1ng t\u1ef1 nh\u01b0 c\u00e1i t\u00fai 0-1, ch\u00fang ta c\u00f3 th\u1ec3 lo\u1ea1i b\u1ecf chi\u1ec1u \u0111\u1ea7u ti\u00ean \u0111\u1ec3 t\u1ed1i \u01b0u h\u00f3a \u0111\u1ed9 ph\u1ee9c t\u1ea1p kh\u00f4ng gian. \u0110i\u1ec1u n\u00e0y cho ch\u00fang ta quy t\u1eafc chuy\u1ec3n tr\u1ea1ng th\u00e1i gi\u1ed1ng nh\u01b0 c\u00e1i t\u00fai 0-1.</p> $$f_j \\gets \\max(f_j, f_{j-w_i}+v_i)$$","tags":["Translated"]},{"location":"dynamic_programming/knapsack.html#implementation-1","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>Thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c c\u00e0i \u0111\u1eb7t trong $O(nW)$ nh\u01b0 sau:</p> <pre><code>for (int i = 1; i &lt;= n; i++)\n  for (int j = w[i]; j &lt;= W; j++)\n    f[j] = max(f[j], f[j - w[i]] + v[i]);\n</code></pre> <p>M\u1eb7c d\u00f9 c\u00f3 c\u00f9ng quy t\u1eafc chuy\u1ec3n tr\u1ea1ng th\u00e1i, m\u00e3 \u1edf tr\u00ean l\u00e0 kh\u00f4ng ch\u00ednh x\u00e1c \u0111\u1ed1i v\u1edbi c\u00e1i t\u00fai 0-1.</p> <p>Quan s\u00e1t m\u00e3 c\u1ea9n th\u1eadn, ch\u00fang ta th\u1ea5y r\u1eb1ng \u0111\u1ed1i v\u1edbi v\u1eadt ph\u1ea9m $i$ hi\u1ec7n \u0111ang \u0111\u01b0\u1ee3c x\u1eed l\u00fd v\u00e0 tr\u1ea1ng th\u00e1i hi\u1ec7n t\u1ea1i $f_{i,j}$, khi $j\\geqslant w_{i}$, $f_{i,j}$ s\u1ebd b\u1ecb \u1ea3nh h\u01b0\u1edfng b\u1edfi $f_{i,j-w_{i}}$. \u0110i\u1ec1u n\u00e0y t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi vi\u1ec7c c\u00f3 th\u1ec3 \u0111\u01b0a v\u1eadt ph\u1ea9m $i$ v\u00e0o ba l\u00f4 nhi\u1ec1u l\u1ea7n, ph\u00f9 h\u1ee3p v\u1edbi b\u00e0i to\u00e1n c\u00e1i t\u00fai ho\u00e0n ch\u1ec9nh ch\u1ee9 kh\u00f4ng ph\u1ea3i b\u00e0i to\u00e1n c\u00e1i t\u00fai 0-1.</p>","tags":["Translated"]},{"location":"dynamic_programming/knapsack.html#multiple-knapsack","title":"C\u00e1i t\u00fai \u0111a b\u1ed9i (Multiple Knapsack)","text":"<p>C\u00e1i t\u00fai \u0111a b\u1ed9i c\u0169ng l\u00e0 m\u1ed9t bi\u1ebfn th\u1ec3 c\u1ee7a c\u00e1i t\u00fai 0-1. S\u1ef1 kh\u00e1c bi\u1ec7t ch\u00ednh l\u00e0 c\u00f3 $k_i$ m\u1ed7i v\u1eadt ph\u1ea9m thay v\u00ec ch\u1ec9 $1$.</p>","tags":["Translated"]},{"location":"dynamic_programming/knapsack.html#explanation-2","title":"Gi\u1ea3i th\u00edch (Explanation)","text":"<p>M\u1ed9t \u00fd t\u01b0\u1edfng r\u1ea5t \u0111\u01a1n gi\u1ea3n l\u00e0: \"ch\u1ecdn m\u1ed7i v\u1eadt ph\u1ea9m $k_i$ l\u1ea7n\" t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi \"$k_i$ v\u1eadt ph\u1ea9m gi\u1ed1ng nhau \u0111\u01b0\u1ee3c ch\u1ecdn t\u1eebng c\u00e1i m\u1ed9t\". Do \u0111\u00f3 chuy\u1ec3n \u0111\u1ed5i n\u00f3 th\u00e0nh m\u00f4 h\u00ecnh c\u00e1i t\u00fai 0-1, c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 b\u1eb1ng h\u00e0m chuy\u1ec3n tr\u1ea1ng th\u00e1i:</p> $$f_{i, j} = \\max_{k=0}^{k_i}(f_{i-1,j-k\\cdot w_i} + k\\cdot v_i)$$ <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian c\u1ee7a qu\u00e1 tr\u00ecnh n\u00e0y l\u00e0 $O(W\\sum\\limits_{i=1}^{n}k_i)$</p>","tags":["Translated"]},{"location":"dynamic_programming/knapsack.html#binary-grouping-optimization","title":"T\u1ed1i \u01b0u h\u00f3a nh\u00f3m nh\u1ecb ph\u00e2n (Binary Grouping Optimization)","text":"<p>Ch\u00fang ta v\u1eabn xem x\u00e9t vi\u1ec7c chuy\u1ec3n \u0111\u1ed5i m\u00f4 h\u00ecnh c\u00e1i t\u00fai \u0111a b\u1ed9i th\u00e0nh m\u00f4 h\u00ecnh c\u00e1i t\u00fai 0-1 \u0111\u1ec3 t\u1ed1i \u01b0u h\u00f3a. \u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian $O(Wn)$ kh\u00f4ng th\u1ec3 \u0111\u01b0\u1ee3c t\u1ed1i \u01b0u h\u00f3a th\u00eam v\u1edbi c\u00e1ch ti\u1ebfp c\u1eadn tr\u00ean, v\u00ec v\u1eady ch\u00fang ta t\u1eadp trung v\u00e0o th\u00e0nh ph\u1ea7n $O(\\sum k_i)$.</p> <p>G\u1ecdi $A_{i, j}$ l\u00e0 v\u1eadt ph\u1ea9m th\u1ee9 $j$ \u0111\u01b0\u1ee3c t\u00e1ch ra t\u1eeb v\u1eadt ph\u1ea9m th\u1ee9 $i$. Trong c\u00e1ch ti\u1ebfp c\u1eadn t\u1ea7m th\u01b0\u1eddng \u0111\u01b0\u1ee3c th\u1ea3o lu\u1eadn \u1edf tr\u00ean, $A_{i, j}$ \u0111\u1ea1i di\u1ec7n cho c\u00f9ng m\u1ed9t v\u1eadt ph\u1ea9m cho t\u1ea5t c\u1ea3 $j \\leq k_i$. L\u00fd do ch\u00ednh cho hi\u1ec7u qu\u1ea3 th\u1ea5p c\u1ee7a ch\u00fang ta l\u00e0 ch\u00fang ta \u0111ang l\u00e0m r\u1ea5t nhi\u1ec1u c\u00f4ng vi\u1ec7c l\u1eb7p l\u1ea1i. V\u00ed d\u1ee5, h\u00e3y xem x\u00e9t vi\u1ec7c ch\u1ecdn $\\{A_{i, 1},A_{i, 2}\\}$, v\u00e0 ch\u1ecdn $\\{A_{i, 2}, A_{i, 3}\\}$. Hai t\u00ecnh hu\u1ed1ng n\u00e0y ho\u00e0n to\u00e0n t\u01b0\u01a1ng \u0111\u01b0\u01a1ng. V\u00ec v\u1eady, vi\u1ec7c t\u1ed1i \u01b0u h\u00f3a ph\u01b0\u01a1ng ph\u00e1p t\u00e1ch s\u1ebd l\u00e0m gi\u1ea3m \u0111\u00e1ng k\u1ec3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian.</p> <p>Vi\u1ec7c ph\u00e2n nh\u00f3m \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n hi\u1ec7u qu\u1ea3 h\u01a1n b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng ph\u00e2n nh\u00f3m nh\u1ecb ph\u00e2n.</p> <p>C\u1ee5 th\u1ec3, $A_{i, j}$ gi\u1eef $2^j$ v\u1eadt ph\u1ea9m ri\u00eang l\u1ebb ($j\\in[0,\\lfloor \\log_2(k_i+1)\\rfloor-1]$). N\u1ebfu $k_i + 1$ kh\u00f4ng ph\u1ea3i l\u00e0 l\u0169y th\u1eeba nguy\u00ean c\u1ee7a $2$, m\u1ed9t g\u00f3i kh\u00e1c c\u00f3 k\u00edch th\u01b0\u1edbc $k_i-(2^{\\lfloor \\log_2(k_i+1)\\rfloor}-1)$ \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 b\u00f9 \u0111\u1eafp cho n\u00f3.</p> <p>Th\u00f4ng qua ph\u01b0\u01a1ng ph\u00e1p t\u00e1ch tr\u00ean, c\u00f3 th\u1ec3 thu \u0111\u01b0\u1ee3c b\u1ea5t k\u1ef3 t\u1ed5ng n\u00e0o c\u1ee7a $\\leq k_i$ v\u1eadt ph\u1ea9m b\u1eb1ng c\u00e1ch ch\u1ecdn m\u1ed9t v\u00e0i $A_{i, j}$. Sau khi t\u00e1ch t\u1eebng v\u1eadt ph\u1ea9m theo c\u00e1ch \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3, ch\u1ec9 c\u1ea7n s\u1eed d\u1ee5ng ph\u01b0\u01a1ng ph\u00e1p c\u00e1i t\u00fai 0-1 \u0111\u1ec3 gi\u1ea3i quy\u1ebft c\u00f4ng th\u1ee9c m\u1edbi c\u1ee7a b\u00e0i to\u00e1n.</p> <p>S\u1ef1 t\u1ed1i \u01b0u h\u00f3a n\u00e0y mang l\u1ea1i cho ch\u00fang ta \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian l\u00e0 $O(W\\sum\\limits_{i=1}^{n}\\log k_i)$.</p>","tags":["Translated"]},{"location":"dynamic_programming/knapsack.html#implementation-2","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<pre><code>index = 0;\nfor (int i = 1; i &lt;= n; i++) {\n  int c = 1, p, h, k;\n  cin &gt;&gt; p &gt;&gt; h &gt;&gt; k;\n  while (k &gt; c) {\n    k -= c;\n    list[++index].w = c * p;\n    list[index].v = c * h;\n    c *= 2;\n  }\n  list[++index].w = p * k;\n  list[index].v = h * k;\n}\n</code></pre>","tags":["Translated"]},{"location":"dynamic_programming/knapsack.html#monotone-queue-optimization","title":"T\u1ed1i \u01b0u h\u00f3a h\u00e0ng \u0111\u1ee3i \u0111\u01a1n \u0111i\u1ec7u (Monotone Queue Optimization)","text":"<p>Trong t\u1ed1i \u01b0u h\u00f3a n\u00e0y, ch\u00fang ta nh\u1eafm \u0111\u1ebfn vi\u1ec7c chuy\u1ec3n \u0111\u1ed5i b\u00e0i to\u00e1n c\u00e1i t\u00fai th\u00e0nh b\u00e0i to\u00e1n h\u00e0ng \u0111\u1ee3i c\u1ef1c \u0111\u1ea1i (maximum queue).</p> <p>\u0110\u1ec3 thu\u1eadn ti\u1ec7n cho vi\u1ec7c m\u00f4 t\u1ea3, g\u1ecdi $g_{x, y} = f_{i, x \\cdot w_i + y} ,\\space g'_{x, y} = f_{i-1, x \\cdot w_i + y}$. Khi \u0111\u00f3 quy t\u1eafc chuy\u1ec3n tr\u1ea1ng th\u00e1i c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c vi\u1ebft l\u00e0:</p> $$g_{x, y} = \\max_{k=0}^{k_i}(g'_{x-k, y} + v_i \\cdot k)$$ <p>H\u01a1n n\u1eefa, g\u1ecdi $G_{x, y} = g'_{x, y} - v_i \\cdot x$. Khi \u0111\u00f3 quy t\u1eafc chuy\u1ec3n tr\u1ea1ng th\u00e1i c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n nh\u01b0 sau:</p> $$g_{x, y} \\gets \\max_{k=0}^{k_i}(G_{x-k, y}) + v_i \\cdot x$$ <p>\u0110i\u1ec1u n\u00e0y chuy\u1ec3n \u0111\u1ed5i th\u00e0nh m\u1ed9t d\u1ea1ng t\u1ed1i \u01b0u h\u00f3a h\u00e0ng \u0111\u1ee3i \u0111\u01a1n \u0111i\u1ec7u c\u1ed5 \u0111i\u1ec3n. $G_{x, y}$ c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ednh trong $O(1)$, v\u00ec v\u1eady v\u1edbi m\u1ed9t $y$ c\u1ed1 \u0111\u1ecbnh, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh $g_{x, y}$ trong th\u1eddi gian $O(\\lfloor \\frac{W}{w_i} \\rfloor)$. Do \u0111\u00f3, \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a vi\u1ec7c t\u00ecm t\u1ea5t c\u1ea3 $g_{x, y}$ l\u00e0 $O(\\lfloor \\frac{W}{w_i} \\rfloor) \\times O(w_i) = O(W)$. Theo c\u00e1ch n\u00e0y, t\u1ed5ng \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a thu\u1eadt to\u00e1n gi\u1ea3m xu\u1ed1ng c\u00f2n $O(nW)$.</p>","tags":["Translated"]},{"location":"dynamic_programming/knapsack.html#mixed-knapsack","title":"C\u00e1i t\u00fai h\u1ed7n h\u1ee3p (Mixed Knapsack)","text":"<p>B\u00e0i to\u00e1n c\u00e1i t\u00fai h\u1ed7n h\u1ee3p li\u00ean quan \u0111\u1ebfn s\u1ef1 k\u1ebft h\u1ee3p c\u1ee7a ba b\u00e0i to\u00e1n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 \u1edf tr\u00ean. T\u1ee9c l\u00e0, m\u1ed9t s\u1ed1 v\u1eadt ph\u1ea9m ch\u1ec9 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c l\u1ea5y m\u1ed9t l\u1ea7n, m\u1ed9t s\u1ed1 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c l\u1ea5y v\u00f4 h\u1ea1n v\u00e0 m\u1ed9t s\u1ed1 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c l\u1ea5y t\u1ed1i \u0111a $k$ l\u1ea7n.</p> <p>B\u00e0i to\u00e1n c\u00f3 v\u1ebb kh\u00f3 kh\u0103n, nh\u01b0ng mi\u1ec5n l\u00e0 b\u1ea1n hi\u1ec3u nh\u1eefng \u00fd t\u01b0\u1edfng c\u1ed1t l\u00f5i c\u1ee7a c\u00e1c b\u00e0i to\u00e1n c\u00e1i t\u00fai tr\u01b0\u1edbc \u0111\u00f3 v\u00e0 k\u1ebft h\u1ee3p ch\u00fang l\u1ea1i v\u1edbi nhau, b\u1ea1n c\u00f3 th\u1ec3 l\u00e0m \u0111\u01b0\u1ee3c. M\u00e3 gi\u1ea3 cho gi\u1ea3i ph\u00e1p nh\u01b0 sau:</p> <pre><code>for (each item) {\n  if (0-1 knapsack)\n    Apply 0-1 knapsack code;\n  else if (complete knapsack)\n    Apply complete knapsack code;\n  else if (multiple knapsack)\n    Apply multiple knapsack code;\n}\n</code></pre>","tags":["Translated"]},{"location":"dynamic_programming/knapsack.html#practise-problems","title":"B\u00e0i t\u1eadp (Practise Problems)","text":"<ul> <li>Atcoder: Knapsack-1</li> <li>Atcoder: Knapsack-2</li> <li>LeetCode - 494. Target Sum</li> <li>LeetCode - 416. Partition Equal Subset Sum</li> <li>CSES: Book Shop II</li> <li>DMOJ: Knapsack-3</li> <li>DMOJ: Knapsack-4</li> </ul>","tags":["Translated"]},{"location":"dynamic_programming/knuth-optimization.html","title":"T\u1ed1i \u01b0u h\u00f3a Knuth (Knuth's Optimization)","text":"<p>T\u1ed1i \u01b0u h\u00f3a Knuth (Knuth's Optimization), c\u00f2n \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 T\u0103ng t\u1ed1c Knuth-Yao (Knuth-Yao Speedup), l\u00e0 m\u1ed9t tr\u01b0\u1eddng h\u1ee3p \u0111\u1eb7c bi\u1ec7t c\u1ee7a quy ho\u1ea1ch \u0111\u1ed9ng tr\u00ean c\u00e1c kho\u1ea3ng, c\u00f3 th\u1ec3 t\u1ed1i \u01b0u h\u00f3a \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian c\u1ee7a c\u00e1c gi\u1ea3i ph\u00e1p b\u1eb1ng m\u1ed9t h\u1ec7 s\u1ed1 tuy\u1ebfn t\u00ednh, t\u1eeb $O(n^3)$ \u0111\u1ed1i v\u1edbi DP kho\u1ea3ng th\u00f4ng th\u01b0\u1eddng xu\u1ed1ng $O(n^2)$.</p>","tags":["Translated"]},{"location":"dynamic_programming/knuth-optimization.html#conditions","title":"C\u00e1c \u0111i\u1ec1u ki\u1ec7n (Conditions)","text":"<p>T\u0103ng t\u1ed1c \u0111\u01b0\u1ee3c \u00e1p d\u1ee5ng cho c\u00e1c chuy\u1ec3n \u0111\u1ed5i c\u00f3 d\u1ea1ng</p> $$dp(i, j) = \\min_{i \\leq k &lt; j} [ dp(i, k) + dp(k+1, j) + C(i, j) ].$$ <p>T\u01b0\u01a1ng t\u1ef1 nh\u01b0 DP chia \u0111\u1ec3 tr\u1ecb, g\u1ecdi $opt(i, j)$ l\u00e0 gi\u00e1 tr\u1ecb $k$ t\u1ed1i \u0111a gi\u00fap gi\u1ea3m thi\u1ec3u bi\u1ec3u th\u1ee9c trong qu\u00e1 tr\u00ecnh chuy\u1ec3n \u0111\u1ed5i ($opt$ \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 \"\u0111i\u1ec3m chia t\u1ed1i \u01b0u\" trong n\u1eeda sau b\u00e0i vi\u1ebft n\u00e0y). Vi\u1ec7c t\u1ed1i \u01b0u h\u00f3a y\u00eau c\u1ea7u \u0111i\u1ec1u sau \u0111\u00e2y ph\u1ea3i \u0111\u01b0\u1ee3c th\u1ecfa m\u00e3n:</p> $$opt(i, j-1) \\leq opt(i, j) \\leq opt(i+1, j).$$ <p>Ch\u00fang ta c\u00f3 th\u1ec3 ch\u1ec9 ra r\u1eb1ng n\u00f3 \u0111\u00fang khi h\u00e0m chi ph\u00ed $C$ th\u1ecfa m\u00e3n c\u00e1c \u0111i\u1ec1u ki\u1ec7n sau v\u1edbi $a \\leq b \\leq c \\leq d$:</p> <ol> <li> <p>$C(b, c) \\leq C(a, d)$;</p> </li> <li> <p>$C(a, c) + C(b, d) \\leq C(a, d) + C(b, c)$ (b\u1ea5t \u0111\u1eb3ng th\u1ee9c t\u1ee9 gi\u00e1c [QI]).</p> </li> </ol> <p>K\u1ebft qu\u1ea3 n\u00e0y \u0111\u01b0\u1ee3c ch\u1ee9ng minh th\u00eam \u1edf b\u00ean d\u01b0\u1edbi.</p>","tags":["Translated"]},{"location":"dynamic_programming/knuth-optimization.html#algorithm","title":"Thu\u1eadt to\u00e1n (Algorithm)","text":"<p>H\u00e3y x\u1eed l\u00fd c\u00e1c tr\u1ea1ng th\u00e1i dp theo c\u00e1ch m\u00e0 ch\u00fang ta t\u00ednh $dp(i, j-1)$ v\u00e0 $dp(i+1, j)$ tr\u01b0\u1edbc $dp(i, j)$, v\u00e0 khi l\u00e0m nh\u01b0 v\u1eady ch\u00fang ta c\u0169ng t\u00ednh $opt(i, j-1)$ v\u00e0 $opt(i+1, j)$. Khi \u0111\u00f3 \u0111\u1ec3 t\u00ednh $opt(i, j)$, thay v\u00ec ki\u1ec3m tra c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a $k$ t\u1eeb $i$ \u0111\u1ebfn $j-1$, ch\u00fang ta ch\u1ec9 c\u1ea7n ki\u1ec3m tra t\u1eeb $opt(i, j-1)$ \u0111\u1ebfn $opt(i+1, j)$. \u0110\u1ec3 x\u1eed l\u00fd c\u00e1c c\u1eb7p $(i,j)$ theo th\u1ee9 t\u1ef1 n\u00e0y, ch\u1ec9 c\u1ea7n s\u1eed d\u1ee5ng c\u00e1c v\u00f2ng l\u1eb7p for l\u1ed3ng nhau trong \u0111\u00f3 $i$ \u0111i t\u1eeb gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t \u0111\u1ebfn gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t v\u00e0 $j$ \u0111i t\u1eeb $i+1$ \u0111\u1ebfn gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t.</p>","tags":["Translated"]},{"location":"dynamic_programming/knuth-optimization.html#generic-implementation","title":"C\u00e0i \u0111\u1eb7t chung (Generic implementation)","text":"<p>M\u1eb7c d\u00f9 vi\u1ec7c c\u00e0i \u0111\u1eb7t thay \u0111\u1ed5i, \u0111\u00e2y l\u00e0 m\u1ed9t v\u00ed d\u1ee5 kh\u00e1 chung. C\u1ea5u tr\u00fac c\u1ee7a m\u00e3 g\u1ea7n gi\u1ed1ng v\u1edbi DP Kho\u1ea3ng (Range DP).</p> <pre><code>int solve() {\n    int N;\n    ... // read N and input\n    int dp[N][N], opt[N][N];\n\n    auto C = [&amp;](int i, int j) {\n        ... // Implement cost function C.\n    };\n\n    for (int i = 0; i &lt; N; i++) {\n        opt[i][i] = i;\n        ... // Initialize dp[i][i] according to the problem\n    }\n\n    for (int i = N-2; i &gt;= 0; i--) {\n        for (int j = i+1; j &lt; N; j++) {\n            int mn = INT_MAX;\n            int cost = C(i, j);\n            for (int k = opt[i][j-1]; k &lt;= min(j-1, opt[i+1][j]); k++) {\n                if (mn &gt;= dp[i][k] + dp[k+1][j] + cost) {\n                    opt[i][j] = k; \n                    mn = dp[i][k] + dp[k+1][j] + cost; \n                }\n            }\n            dp[i][j] = mn; \n        }\n    }\n\n    return dp[0][N-1];\n}\n</code></pre>","tags":["Translated"]},{"location":"dynamic_programming/knuth-optimization.html#complexity","title":"\u0110\u1ed9 ph\u1ee9c t\u1ea1p (Complexity)","text":"<p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a thu\u1eadt to\u00e1n c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c \u01b0\u1edbc t\u00ednh b\u1eb1ng t\u1ed5ng sau:</p> $$ \\sum\\limits_{i=1}^N \\sum\\limits_{j=i+1}^N [opt(i+1,j)-opt(i,j-1)] = \\sum\\limits_{i=1}^N \\sum\\limits_{j=i}^{N-1} [opt(i+1,j+1)-opt(i,j)]. $$ <p>Nh\u01b0 b\u1ea1n th\u1ea5y, h\u1ea7u h\u1ebft c\u00e1c s\u1ed1 h\u1ea1ng trong bi\u1ec3u th\u1ee9c n\u00e0y tri\u1ec7t ti\u00eau l\u1eabn nhau, ngo\u1ea1i tr\u1eeb c\u00e1c s\u1ed1 h\u1ea1ng d\u01b0\u01a1ng v\u1edbi $j=N-1$ v\u00e0 c\u00e1c s\u1ed1 h\u1ea1ng \u00e2m v\u1edbi $i=1$. Do \u0111\u00f3, to\u00e0n b\u1ed9 t\u1ed5ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c \u01b0\u1edbc t\u00ednh l\u00e0</p> $$ \\sum\\limits_{k=1}^N[opt(k,N)-opt(1,k)] = O(n^2), $$ <p>thay v\u00ec $O(n^3)$ n\u1ebfu ch\u00fang ta s\u1eed d\u1ee5ng DP kho\u1ea3ng th\u00f4ng th\u01b0\u1eddng.</p>","tags":["Translated"]},{"location":"dynamic_programming/knuth-optimization.html#on-practice","title":"V\u1ec1 th\u1ef1c h\u00e0nh (On practice)","text":"<p>\u1ee8ng d\u1ee5ng ph\u1ed5 bi\u1ebfn nh\u1ea5t c\u1ee7a T\u1ed1i \u01b0u h\u00f3a Knuth l\u00e0 trong Range DP, v\u1edbi chuy\u1ec3n \u0111\u1ed5i \u0111\u00e3 cho. Kh\u00f3 kh\u0103n duy nh\u1ea5t l\u00e0 ch\u1ee9ng minh r\u1eb1ng h\u00e0m chi ph\u00ed th\u1ecfa m\u00e3n c\u00e1c \u0111i\u1ec1u ki\u1ec7n \u0111\u00e3 cho. Tr\u01b0\u1eddng h\u1ee3p \u0111\u01a1n gi\u1ea3n nh\u1ea5t l\u00e0 khi h\u00e0m chi ph\u00ed $C(i, j)$ ch\u1ec9 \u0111\u01a1n gi\u1ea3n l\u00e0 t\u1ed5ng c\u00e1c ph\u1ea7n t\u1eed c\u1ee7a m\u1ea3ng con $S[i, i+1, ..., j]$ cho m\u1ed9t m\u1ea3ng n\u00e0o \u0111\u00f3 (t\u00f9y thu\u1ed9c v\u00e0o c\u00e2u h\u1ecfi). Tuy nhi\u00ean, \u0111\u00f4i khi ch\u00fang c\u00f3 th\u1ec3 ph\u1ee9c t\u1ea1p h\u01a1n.</p> <p>L\u01b0u \u00fd r\u1eb1ng h\u01a1n c\u00e1c \u0111i\u1ec1u ki\u1ec7n v\u1ec1 chuy\u1ec3n \u0111\u1ed5i dp v\u00e0 h\u00e0m chi ph\u00ed, ch\u00eca kh\u00f3a cho s\u1ef1 t\u1ed1i \u01b0u h\u00f3a n\u00e0y l\u00e0 b\u1ea5t \u0111\u1eb3ng th\u1ee9c tr\u00ean \u0111i\u1ec3m chia t\u1ed1i \u01b0u. Trong m\u1ed9t s\u1ed1 b\u00e0i to\u00e1n, ch\u1eb3ng h\u1ea1n nh\u01b0 b\u00e0i to\u00e1n c\u00e2y t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n t\u1ed1i \u01b0u (t\u00ecnh c\u1edd l\u00e0 b\u00e0i to\u00e1n g\u1ed1c m\u00e0 t\u1ed1i \u01b0u h\u00f3a n\u00e0y \u0111\u01b0\u1ee3c ph\u00e1t tri\u1ec3n), c\u00e1c chuy\u1ec3n \u0111\u1ed5i v\u00e0 h\u00e0m chi ph\u00ed s\u1ebd \u00edt r\u00f5 r\u00e0ng h\u01a1n, tuy nhi\u00ean, ng\u01b0\u1eddi ta v\u1eabn c\u00f3 th\u1ec3 ch\u1ee9ng minh r\u1eb1ng $opt(i, j-1) \\leq opt(i, j) \\leq opt(i+1, j)$, v\u00e0 do \u0111\u00f3, s\u1eed d\u1ee5ng t\u1ed1i \u01b0u h\u00f3a n\u00e0y.</p>","tags":["Translated"]},{"location":"dynamic_programming/knuth-optimization.html#proof-of-correctness","title":"Ch\u1ee9ng minh t\u00ednh \u0111\u00fang \u0111\u1eafn (Proof of correctness)","text":"<p>\u0110\u1ec3 ch\u1ee9ng minh t\u00ednh \u0111\u00fang \u0111\u1eafn c\u1ee7a thu\u1eadt to\u00e1n n\u00e0y d\u01b0\u1edbi c\u00e1c \u0111i\u1ec1u ki\u1ec7n c\u1ee7a $C(i,j)$, \u0111\u1ee7 \u0111\u1ec3 ch\u1ee9ng minh r\u1eb1ng</p> $$ opt(i, j-1) \\leq opt(i, j) \\leq opt(i+1, j) $$ <p>gi\u1ea3 s\u1eed c\u00e1c \u0111i\u1ec1u ki\u1ec7n \u0111\u00e3 cho \u0111\u01b0\u1ee3c th\u1ecfa m\u00e3n.</p> <p>B\u1ed5 \u0111\u1ec1</p> <p>$dp(i, j)$ c\u0169ng th\u1ecfa m\u00e3n b\u1ea5t \u0111\u1eb3ng th\u1ee9c t\u1ee9 gi\u00e1c, v\u1edbi \u0111i\u1ec1u ki\u1ec7n c\u00e1c \u0111i\u1ec1u ki\u1ec7n c\u1ee7a b\u00e0i to\u00e1n \u0111\u01b0\u1ee3c th\u1ecfa m\u00e3n.</p> Ch\u1ee9ng minh <p>Ch\u1ee9ng minh cho b\u1ed5 \u0111\u1ec1 n\u00e0y s\u1eed d\u1ee5ng quy n\u1ea1p m\u1ea1nh. N\u00f3 \u0111\u01b0\u1ee3c l\u1ea5y t\u1eeb b\u00e0i b\u00e1o Efficient Dynamic Programming Using Quadrangle Inequalities, \u0111\u01b0\u1ee3c vi\u1ebft b\u1edfi F. Frances Yao, ng\u01b0\u1eddi \u0111\u00e3 gi\u1edbi thi\u1ec7u T\u0103ng t\u1ed1c Knuth-Yao (m\u1ec7nh \u0111\u1ec1 c\u1ee5 th\u1ec3 n\u00e0y l\u00e0 B\u1ed5 \u0111\u1ec1 2.1 trong b\u00e0i b\u00e1o). \u00dd t\u01b0\u1edfng l\u00e0 quy n\u1ea1p d\u1ef1a tr\u00ean \u0111\u1ed9 d\u00e0i $l = d - a$. Tr\u01b0\u1eddng h\u1ee3p $l = 1$ l\u00e0 t\u1ea7m th\u01b0\u1eddng. \u0110\u1ed1i v\u1edbi $l &gt; 1$ xem x\u00e9t 2 tr\u01b0\u1eddng h\u1ee3p:</p> <ol> <li> <p>$b = c$ B\u1ea5t \u0111\u1eb3ng th\u1ee9c r\u00fat g\u1ecdn th\u00e0nh $dp(a, b) + dp(b, d) \\leq dp(a, d)$ (\u0110i\u1ec1u n\u00e0y gi\u1ea3 s\u1eed r\u1eb1ng $dp(i, i) = 0$ cho m\u1ecdi $i$, \u0111\u00e2y l\u00e0 tr\u01b0\u1eddng h\u1ee3p cho t\u1ea5t c\u1ea3 c\u00e1c b\u00e0i to\u00e1n s\u1eed d\u1ee5ng t\u1ed1i \u01b0u h\u00f3a n\u00e0y). G\u1ecdi $opt(a,d) = z$.</p> <ul> <li> <p>N\u1ebfu $z &lt; j$, L\u01b0u \u00fd r\u1eb1ng</p> $$ dp(a, b) \\leq dp_{z}(a, b) = dp(a, z) + dp(z+1, b) + C(a, b). $$ <p>Do \u0111\u00f3,</p> $$ dp(a, b) + dp(b, d) \\leq dp(a, z) + dp(z+1, b) + dp(b, d) + C(a, b) $$ <p>T\u1eeb gi\u1ea3 thuy\u1ebft quy n\u1ea1p, $dp(z+1, b) + dp(b, d) \\leq dp(z+1, d)$. Ngo\u00e0i ra, n\u00f3 \u0111\u01b0\u1ee3c cho l\u00e0 $C(a, b) \\leq C(a, d)$. K\u1ebft h\u1ee3p 2 th\u1ef1c t\u1ebf n\u00e0y v\u1edbi b\u1ea5t \u0111\u1eb3ng th\u1ee9c tr\u00ean mang l\u1ea1i k\u1ebft qu\u1ea3 mong mu\u1ed1n.</p> </li> <li> <p>N\u1ebfu $z \\geq j$, b\u1eb1ng ch\u1ee9ng c\u1ee7a tr\u01b0\u1eddng h\u1ee3p n\u00e0y \u0111\u1ed1i x\u1ee9ng v\u1edbi tr\u01b0\u1eddng h\u1ee3p tr\u01b0\u1edbc.</p> </li> </ul> </li> <li> <p>$b &lt; c$ G\u1ecdi $opt(b, c) = z$ v\u00e0 $opt(a, d) = y$.</p> <ul> <li> <p>N\u1ebfu $z \\leq y$,</p> $$ dp(a, c) + dp(b, d) \\leq dp_{z}(a, c) + dp_{y}(b, d) $$ <p>trong \u0111\u00f3</p> $$ dp_{z}(a, c) + dp_{y}(b, d) = C(a, c) + C(b, d) + dp(a, z) + dp(z+1, c) + dp(b, y) + dp(y+1, d). $$ <p>S\u1eed d\u1ee5ng QI tr\u00ean $C$ v\u00e0 tr\u00ean tr\u1ea1ng th\u00e1i dp cho c\u00e1c ch\u1ec9 s\u1ed1 $z+1 \\leq y+1 \\leq c \\leq d$ (t\u1eeb gi\u1ea3 thuy\u1ebft quy n\u1ea1p) mang l\u1ea1i k\u1ebft qu\u1ea3 mong mu\u1ed1n.</p> </li> <li> <p>N\u1ebfu $z &gt; y$, b\u1eb1ng ch\u1ee9ng c\u1ee7a tr\u01b0\u1eddng h\u1ee3p n\u00e0y \u0111\u1ed1i x\u1ee9ng v\u1edbi tr\u01b0\u1eddng h\u1ee3p tr\u01b0\u1edbc.</p> </li> </ul> </li> </ol> <p>\u0110i\u1ec1u n\u00e0y ho\u00e0n th\u00e0nh vi\u1ec7c ch\u1ee9ng minh b\u1ed5 \u0111\u1ec1.</p> <p>B\u00e2y gi\u1edd, xem x\u00e9t thi\u1ebft l\u1eadp sau. Ch\u00fang ta c\u00f3 2 ch\u1ec9 s\u1ed1 $i \\leq p \\leq q &lt; j$. \u0110\u1eb7t $dp_{k} = C(i, j) + dp(i, k) + dp(k+1, j)$.</p> <p>Gi\u1ea3 s\u1eed ch\u00fang ta ch\u1ec9 ra r\u1eb1ng</p> $$ dp_{p}(i, j-1) \\geq dp_{q}(i, j-1) \\implies dp_{p}(i, j) \\geq dp_{q}(i, j). $$ <p>\u0110\u1eb7t $q = opt(i, j-1)$, theo \u0111\u1ecbnh ngh\u0129a, $dp_{p}(i, j-1) \\geq dp_{q}(i, j-1)$. Do \u0111\u00f3, \u00e1p d\u1ee5ng b\u1ea5t \u0111\u1eb3ng th\u1ee9c cho t\u1ea5t c\u1ea3 $i \\leq p \\leq q$, ch\u00fang ta c\u00f3 th\u1ec3 suy ra r\u1eb1ng $opt(i, j)$ \u00edt nh\u1ea5t b\u1eb1ng $opt(i, j-1)$, ch\u1ee9ng minh n\u1eeda \u0111\u1ea7u c\u1ee7a b\u1ea5t \u0111\u1eb3ng th\u1ee9c.</p> <p>B\u00e2y gi\u1edd, s\u1eed d\u1ee5ng QI tr\u00ean m\u1ed9t s\u1ed1 ch\u1ec9 s\u1ed1 $p+1 \\leq q+1 \\leq j-1 \\leq j$, ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c</p> $$\\begin{align} &amp;dp(p+1, j-1) + dp(q+1, j) \u2264 dp(q+1, j-1) + dp(p+1, j) \\\\ \\implies&amp; (dp(i, p) + dp(p+1, j-1) + C(i, j-1)) + (dp(i, q) + dp(q+1, j) + C(i, j)) \\\\   \\leq&amp; (dp(i, q) + dp(q+1, j-1) + C(i, j-1)) + (dp(i, p) + dp(p+1, j) + C(i, j)) \\\\   \\implies&amp; dp_{p}(i, j-1) + dp_{q}(i, j) \u2264 dp_{p}(i, j) + dp_{q}(i, j-1) \\\\ \\implies&amp; dp_{p}(i, j-1) - dp_{q}(i, j-1) \u2264 dp_{p}(i, j) - dp_{q}(i, j) \\\\ \\end{align}$$ <p>Cu\u1ed1i c\u00f9ng,</p> $$\\begin{align} &amp;dp_{p}(i, j-1) \\geq dp_{q}(i, j-1) \\\\ &amp;\\implies 0 \\leq dp_{p}(i, j-1) - dp_{q}(i, j-1) \\leq dp_{p}(i, j) - dp_{q}(i, j) \\\\ &amp;\\implies dp_{p}(i, j) \\geq dp_{q}(i, j) \\end{align}$$ <p>\u0110i\u1ec1u n\u00e0y ch\u1ee9ng minh ph\u1ea7n \u0111\u1ea7u ti\u00ean c\u1ee7a b\u1ea5t \u0111\u1eb3ng th\u1ee9c, t\u1ee9c l\u00e0, $opt(i, j-1) \\leq opt(i, j)$. Ph\u1ea7n th\u1ee9 hai $opt(i, j) \\leq opt(i+1, j)$ c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c ch\u1ec9 ra v\u1edbi c\u00f9ng \u00fd t\u01b0\u1edfng, b\u1eaft \u0111\u1ea7u v\u1edbi b\u1ea5t \u0111\u1eb3ng th\u1ee9c $dp(i, p) + dp(i+1, q) \u2264 dp(i+1, p) + dp(i, q)$.</p> <p>\u0110i\u1ec1u n\u00e0y ho\u00e0n th\u00e0nh vi\u1ec7c ch\u1ee9ng minh.</p>","tags":["Translated"]},{"location":"dynamic_programming/knuth-optimization.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>UVA - Cutting Sticks</li> <li>UVA - Prefix Codes</li> <li>SPOJ - Breaking String</li> <li>UVA - Optimal Binary Search Tree</li> </ul>","tags":["Translated"]},{"location":"dynamic_programming/knuth-optimization.html#references","title":"T\u00e0i li\u1ec7u tham kh\u1ea3o (References)","text":"<ul> <li>Geeksforgeeks Article</li> <li>Doc on DP Speedups</li> <li>Efficient Dynamic Programming Using Quadrangle Inequalities</li> </ul>","tags":["Translated"]},{"location":"dynamic_programming/longest_increasing_subsequence.html","title":"D\u00e3y con t\u0103ng d\u00e0i nh\u1ea5t (Longest increasing subsequence)","text":"<p>Ch\u00fang ta \u0111\u01b0\u1ee3c cho m\u1ed9t m\u1ea3ng v\u1edbi $n$ s\u1ed1: $a[0 \\dots n-1]$. Nhi\u1ec7m v\u1ee5 l\u00e0 t\u00ecm d\u00e3y con t\u0103ng nghi\u00eam ng\u1eb7t d\u00e0i nh\u1ea5t trong $a$.</p> <p>M\u1ed9t c\u00e1ch ch\u00ednh th\u1ee9c, ch\u00fang ta t\u00ecm ki\u1ebfm d\u00e3y c\u00e1c ch\u1ec9 s\u1ed1 d\u00e0i nh\u1ea5t $i_1, \\dots i_k$ sao cho</p> $$i_1 &lt; i_2 &lt; \\dots &lt; i_k,\\quad a[i_1] &lt; a[i_2] &lt; \\dots &lt; a[i_k]$$ <p>Trong b\u00e0i vi\u1ebft n\u00e0y, ch\u00fang ta th\u1ea3o lu\u1eadn v\u1ec1 nhi\u1ec1u thu\u1eadt to\u00e1n \u0111\u1ec3 gi\u1ea3i quy\u1ebft nhi\u1ec7m v\u1ee5 n\u00e0y. Ngo\u00e0i ra, ch\u00fang ta s\u1ebd th\u1ea3o lu\u1eadn v\u1ec1 m\u1ed9t s\u1ed1 b\u00e0i to\u00e1n kh\u00e1c, c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c quy v\u1ec1 b\u00e0i to\u00e1n n\u00e0y.</p>","tags":["Translated"]},{"location":"dynamic_programming/longest_increasing_subsequence.html#solution-in-o-n-2-with-dynamic-programming","title":"Gi\u1ea3i ph\u00e1p trong $O(n^2)$ v\u1edbi quy ho\u1ea1ch \u0111\u1ed9ng (Solution in O(n^2) with dynamic programming)","text":"<p>Quy ho\u1ea1ch \u0111\u1ed9ng (Dynamic programming) l\u00e0 m\u1ed9t k\u1ef9 thu\u1eadt r\u1ea5t t\u1ed5ng qu\u00e1t cho ph\u00e9p gi\u1ea3i quy\u1ebft m\u1ed9t l\u1edbp b\u00e0i to\u00e1n kh\u1ed5ng l\u1ed3. \u1ede \u0111\u00e2y ch\u00fang ta \u00e1p d\u1ee5ng k\u1ef9 thu\u1eadt cho nhi\u1ec7m v\u1ee5 c\u1ee5 th\u1ec3 c\u1ee7a m\u00ecnh.</p> <p>\u0110\u1ea7u ti\u00ean, ch\u00fang ta s\u1ebd ch\u1ec9 t\u00ecm ki\u1ebfm \u0111\u1ed9 d\u00e0i c\u1ee7a d\u00e3y con t\u0103ng d\u00e0i nh\u1ea5t, v\u00e0 ch\u1ec9 sau \u0111\u00f3 t\u00ecm hi\u1ec3u c\u00e1ch kh\u00f4i ph\u1ee5c ch\u00ednh d\u00e3y con \u0111\u00f3.</p>","tags":["Translated"]},{"location":"dynamic_programming/longest_increasing_subsequence.html#finding-the-length","title":"T\u00ecm \u0111\u1ed9 d\u00e0i (Finding the length)","text":"<p>\u0110\u1ec3 ho\u00e0n th\u00e0nh nhi\u1ec7m v\u1ee5 n\u00e0y, ch\u00fang ta \u0111\u1ecbnh ngh\u0129a m\u1ed9t m\u1ea3ng $d[0 \\dots n-1]$, trong \u0111\u00f3 $d[i]$ l\u00e0 \u0111\u1ed9 d\u00e0i c\u1ee7a d\u00e3y con t\u0103ng d\u00e0i nh\u1ea5t k\u1ebft th\u00fac t\u1ea1i ph\u1ea7n t\u1eed \u1edf ch\u1ec9 s\u1ed1 $i$.</p> <p>V\u00ed d\u1ee5</p> $$\\begin{array}{ll} a &amp;= \\{8, 3, 4, 6, 5, 2, 0, 7, 9, 1\\} \\\\ d &amp;= \\{1, 1, 2, 3, 3, 1, 1, 4, 5, 2\\} \\end{array}$$ <p>D\u00e3y con t\u0103ng d\u00e0i nh\u1ea5t k\u1ebft th\u00fac t\u1ea1i ch\u1ec9 s\u1ed1 4 l\u00e0 $\\{3, 4, 5\\}$ v\u1edbi \u0111\u1ed9 d\u00e0i l\u00e0 3, d\u00e3y d\u00e0i nh\u1ea5t k\u1ebft th\u00fac t\u1ea1i ch\u1ec9 s\u1ed1 8 l\u00e0 $\\{3, 4, 5, 7, 9\\}$ ho\u1eb7c $\\{3, 4, 6, 7, 9\\}$, c\u1ea3 hai \u0111\u1ec1u c\u00f3 \u0111\u1ed9 d\u00e0i 5, v\u00e0 d\u00e3y d\u00e0i nh\u1ea5t k\u1ebft th\u00fac t\u1ea1i ch\u1ec9 s\u1ed1 9 l\u00e0 $\\{0, 1\\}$ c\u00f3 \u0111\u1ed9 d\u00e0i 2.</p> <p>Ch\u00fang ta s\u1ebd t\u00ednh to\u00e1n m\u1ea3ng n\u00e0y d\u1ea7n d\u1ea7n: \u0111\u1ea7u ti\u00ean $d[0]$, sau \u0111\u00f3 $d[1]$, v.v. Sau khi m\u1ea3ng n\u00e0y \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n, c\u00e2u tr\u1ea3 l\u1eddi cho b\u00e0i to\u00e1n s\u1ebd l\u00e0 gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t trong m\u1ea3ng $d[]$.</p> <p>V\u00ec v\u1eady, h\u00e3y \u0111\u1ec3 ch\u1ec9 s\u1ed1 hi\u1ec7n t\u1ea1i l\u00e0 $i$. T\u1ee9c l\u00e0 ch\u00fang ta mu\u1ed1n t\u00ednh gi\u00e1 tr\u1ecb $d[i]$ v\u00e0 t\u1ea5t c\u1ea3 c\u00e1c gi\u00e1 tr\u1ecb tr\u01b0\u1edbc \u0111\u00f3 $d[0], \\dots, d[i-1]$ \u0111\u00e3 \u0111\u01b0\u1ee3c bi\u1ebft. Sau \u0111\u00f3, c\u00f3 hai t\u00f9y ch\u1ecdn:</p> <ul> <li> <p>$d[i] = 1$: d\u00e3y con y\u00eau c\u1ea7u ch\u1ec9 bao g\u1ed3m ph\u1ea7n t\u1eed $a[i]$.</p> </li> <li> <p>$d[i] &gt; 1$: D\u00e3y con s\u1ebd k\u1ebft th\u00fac t\u1ea1i $a[i]$, v\u00e0 ngay tr\u01b0\u1edbc n\u00f3 s\u1ebd l\u00e0 m\u1ed9t s\u1ed1 $a[j]$ v\u1edbi $j &lt; i$ v\u00e0 $a[j] &lt; a[i]$.</p> <p>D\u1ec5 th\u1ea5y r\u1eb1ng, d\u00e3y con k\u1ebft th\u00fac trong $a[j]$ ch\u00ednh n\u00f3 s\u1ebd l\u00e0 m\u1ed9t trong nh\u1eefng d\u00e3y con t\u0103ng d\u00e0i nh\u1ea5t k\u1ebft th\u00fac trong $a[j]$. S\u1ed1 $a[i]$ ch\u1ec9 m\u1edf r\u1ed9ng d\u00e3y con t\u0103ng d\u00e0i nh\u1ea5t \u0111\u00f3 th\u00eam m\u1ed9t s\u1ed1.</p> <p>Do \u0111\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 ch\u1ec9 c\u1ea7n l\u1eb7p l\u1ea1i t\u1ea5t c\u1ea3 $j &lt; i$ v\u1edbi $a[j] &lt; a[i]$, v\u00e0 l\u1ea5y d\u00e3y d\u00e0i nh\u1ea5t m\u00e0 ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c b\u1eb1ng c\u00e1ch th\u00eam $a[i]$ v\u00e0o d\u00e3y con t\u0103ng d\u00e0i nh\u1ea5t k\u1ebft th\u00fac trong $a[j]$. D\u00e3y con t\u0103ng d\u00e0i nh\u1ea5t k\u1ebft th\u00fac trong $a[j]$ c\u00f3 \u0111\u1ed9 d\u00e0i $d[j]$, m\u1edf r\u1ed9ng n\u00f3 th\u00eam m\u1ed9t cho \u0111\u1ed9 d\u00e0i $d[j] + 1$.</p> $$d[i] = \\max_{\\substack{j &lt; i \\\\\\\\ a[j] &lt; a[i]}} \\left(d[j] + 1\\right)$$ </li> </ul> <p>N\u1ebfu ch\u00fang ta k\u1ebft h\u1ee3p hai tr\u01b0\u1eddng h\u1ee3p n\u00e0y, ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c c\u00e2u tr\u1ea3 l\u1eddi cu\u1ed1i c\u00f9ng cho $d[i]$:</p> $$d[i] = \\max\\left(1, \\max_{\\substack{j &lt; i \\\\\\\\ a[j] &lt; a[i]}} \\left(d[j] + 1\\right)\\right)$$","tags":["Translated"]},{"location":"dynamic_programming/longest_increasing_subsequence.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u1ed9t c\u00e0i \u0111\u1eb7t c\u1ee7a thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 \u1edf tr\u00ean, t\u00ednh to\u00e1n \u0111\u1ed9 d\u00e0i c\u1ee7a d\u00e3y con t\u0103ng d\u00e0i nh\u1ea5t.</p> <pre><code>int lis(vector&lt;int&gt; const&amp; a) {\n    int n = a.size();\n    vector&lt;int&gt; d(n, 1);\n    for (int i = 0; i &lt; n; i++) {\n        for (int j = 0; j &lt; i; j++) {\n            if (a[j] &lt; a[i])\n                d[i] = max(d[i], d[j] + 1);\n        }\n    }\n\n    int ans = d[0];\n    for (int i = 1; i &lt; n; i++) {\n        ans = max(ans, d[i]);\n    }\n    return ans;\n}\n</code></pre>","tags":["Translated"]},{"location":"dynamic_programming/longest_increasing_subsequence.html#restoring-the-subsequence","title":"Kh\u00f4i ph\u1ee5c d\u00e3y con (Restoring the subsequence)","text":"<p>Cho \u0111\u1ebfn nay, ch\u00fang ta ch\u1ec9 h\u1ecdc c\u00e1ch t\u00ecm \u0111\u1ed9 d\u00e0i c\u1ee7a d\u00e3y con, nh\u01b0ng kh\u00f4ng bi\u1ebft c\u00e1ch t\u00ecm ch\u00ednh d\u00e3y con \u0111\u00f3.</p> <p>\u0110\u1ec3 c\u00f3 th\u1ec3 kh\u00f4i ph\u1ee5c d\u00e3y con, ch\u00fang ta t\u1ea1o th\u00eam m\u1ed9t m\u1ea3ng ph\u1ee5 $p[0 \\dots n-1]$ m\u00e0 ch\u00fang ta s\u1ebd t\u00ednh to\u00e1n c\u00f9ng v\u1edbi m\u1ea3ng $d[]$. $p[i]$ s\u1ebd l\u00e0 ch\u1ec9 s\u1ed1 $j$ c\u1ee7a ph\u1ea7n t\u1eed \u0111\u1ee9ng th\u1ee9 hai t\u1eeb cu\u1ed1i l\u00ean trong d\u00e3y con t\u0103ng d\u00e0i nh\u1ea5t k\u1ebft th\u00fac b\u1eb1ng $i$. N\u00f3i c\u00e1ch kh\u00e1c, ch\u1ec9 s\u1ed1 $p[i]$ ch\u00ednh l\u00e0 ch\u1ec9 s\u1ed1 $j$ m\u00e0 t\u1ea1i \u0111\u00f3 gi\u00e1 tr\u1ecb cao nh\u1ea5t $d[i]$ \u0111\u00e3 \u0111\u1ea1t \u0111\u01b0\u1ee3c. M\u1ea3ng ph\u1ee5 $p[]$ n\u00e0y theo m\u1ed9t ngh\u0129a n\u00e0o \u0111\u00f3 tr\u1ecf \u0111\u1ebfn c\u00e1c t\u1ed5 ti\u00ean.</p> <p>Sau \u0111\u00f3, \u0111\u1ec3 suy ra d\u00e3y con, ch\u00fang ta ch\u1ec9 c\u1ea7n b\u1eaft \u0111\u1ea7u t\u1ea1i ch\u1ec9 s\u1ed1 $i$ v\u1edbi $d[i]$ c\u1ef1c \u0111\u1ea1i, v\u00e0 \u0111i theo c\u00e1c t\u1ed5 ti\u00ean cho \u0111\u1ebfn khi ch\u00fang ta suy ra to\u00e0n b\u1ed9 d\u00e3y con, t\u1ee9c l\u00e0 cho \u0111\u1ebfn khi ch\u00fang ta \u0111\u1ea1t \u0111\u1ebfn ph\u1ea7n t\u1eed c\u00f3 $d[i] = 1$.</p>","tags":["Translated"]},{"location":"dynamic_programming/longest_increasing_subsequence.html#implementation-of-restoring","title":"C\u00e0i \u0111\u1eb7t vi\u1ec7c kh\u00f4i ph\u1ee5c (Implementation of restoring)","text":"<p>Ch\u00fang ta s\u1ebd thay \u0111\u1ed5i m\u00e3 t\u1eeb c\u00e1c ph\u1ea7n tr\u01b0\u1edbc m\u1ed9t ch\u00fat. Ch\u00fang ta s\u1ebd t\u00ednh to\u00e1n m\u1ea3ng $p[]$ c\u00f9ng v\u1edbi $d[]$, v\u00e0 sau \u0111\u00f3 t\u00ednh to\u00e1n d\u00e3y con.</p> <p>\u0110\u1ec3 thu\u1eadn ti\u1ec7n, ban \u0111\u1ea7u ch\u00fang ta g\u00e1n c\u00e1c t\u1ed5 ti\u00ean v\u1edbi $p[i] = -1$. \u0110\u1ed1i v\u1edbi c\u00e1c ph\u1ea7n t\u1eed c\u00f3 $d[i] = 1$, gi\u00e1 tr\u1ecb t\u1ed5 ti\u00ean s\u1ebd v\u1eabn l\u00e0 $-1$, \u0111i\u1ec1u n\u00e0y s\u1ebd thu\u1eadn ti\u1ec7n h\u01a1n m\u1ed9t ch\u00fat \u0111\u1ec3 kh\u00f4i ph\u1ee5c d\u00e3y con.</p> <pre><code>vector&lt;int&gt; lis(vector&lt;int&gt; const&amp; a) {\n    int n = a.size();\n    vector&lt;int&gt; d(n, 1), p(n, -1);\n    for (int i = 0; i &lt; n; i++) {\n        for (int j = 0; j &lt; i; j++) {\n            if (a[j] &lt; a[i] &amp;&amp; d[i] &lt; d[j] + 1) {\n                d[i] = d[j] + 1;\n                p[i] = j;\n            }\n        }\n    }\n\n    int ans = d[0], pos = 0;\n    for (int i = 1; i &lt; n; i++) {\n        if (d[i] &gt; ans) {\n            ans = d[i];\n            pos = i;\n        }\n    }\n\n    vector&lt;int&gt; subseq;\n    while (pos != -1) {\n        subseq.push_back(a[pos]);\n        pos = p[pos];\n    }\n    reverse(subseq.begin(), subseq.end());\n    return subseq;\n}\n</code></pre>","tags":["Translated"]},{"location":"dynamic_programming/longest_increasing_subsequence.html#alternative-way-of-restoring-the-subsequence","title":"C\u00e1ch thay th\u1ebf \u0111\u1ec3 kh\u00f4i ph\u1ee5c d\u00e3y con (Alternative way of restoring the subsequence)","text":"<p>C\u0169ng c\u00f3 th\u1ec3 kh\u00f4i ph\u1ee5c d\u00e3y con m\u00e0 kh\u00f4ng c\u1ea7n m\u1ea3ng ph\u1ee5 $p[]$. Ch\u00fang ta c\u00f3 th\u1ec3 \u0111\u01a1n gi\u1ea3n t\u00ednh to\u00e1n l\u1ea1i gi\u00e1 tr\u1ecb hi\u1ec7n t\u1ea1i c\u1ee7a $d[i]$ v\u00e0 c\u0169ng xem m\u1ee9c t\u1ed1i \u0111a \u0111\u00e3 \u0111\u1ea1t \u0111\u01b0\u1ee3c nh\u01b0 th\u1ebf n\u00e0o.</p> <p>Ph\u01b0\u01a1ng ph\u00e1p n\u00e0y d\u1eabn \u0111\u1ebfn m\u00e3 d\u00e0i h\u01a1n m\u1ed9t ch\u00fat, nh\u01b0ng \u0111\u1ed5i l\u1ea1i ch\u00fang ta ti\u1ebft ki\u1ec7m \u0111\u01b0\u1ee3c m\u1ed9t s\u1ed1 b\u1ed9 nh\u1edb.</p>","tags":["Translated"]},{"location":"dynamic_programming/longest_increasing_subsequence.html#solution-in-o-n-log-n-with-dynamic-programming-and-binary-search","title":"Gi\u1ea3i ph\u00e1p trong $O(n \\log n)$ v\u1edbi quy ho\u1ea1ch \u0111\u1ed9ng v\u00e0 t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n (Solution in O(n log n) with dynamic programming and binary search)","text":"<p>\u0110\u1ec3 c\u00f3 \u0111\u01b0\u1ee3c gi\u1ea3i ph\u00e1p nhanh h\u01a1n cho b\u00e0i to\u00e1n, ch\u00fang ta x\u00e2y d\u1ef1ng m\u1ed9t gi\u1ea3i ph\u00e1p quy ho\u1ea1ch \u0111\u1ed9ng kh\u00e1c ch\u1ea1y trong $O(n^2)$, v\u00e0 sau \u0111\u00f3 c\u1ea3i thi\u1ec7n n\u00f3 th\u00e0nh $O(n \\log n)$.</p> <p>Ch\u00fang ta s\u1ebd s\u1eed d\u1ee5ng m\u1ea3ng quy ho\u1ea1ch \u0111\u1ed9ng $d[0 \\dots n]$. L\u1ea7n n\u00e0y $d[l]$ kh\u00f4ng t\u01b0\u01a1ng \u1ee9ng v\u1edbi ph\u1ea7n t\u1eed $a[i]$ ho\u1eb7c ti\u1ec1n t\u1ed1 c\u1ee7a m\u1ea3ng. $d[l]$ s\u1ebd l\u00e0 ph\u1ea7n t\u1eed nh\u1ecf nh\u1ea5t m\u00e0 t\u1ea1i \u0111\u00f3 m\u1ed9t d\u00e3y con t\u0103ng c\u00f3 \u0111\u1ed9 d\u00e0i $l$ k\u1ebft th\u00fac.</p> <p>Ban \u0111\u1ea7u ch\u00fang ta gi\u1ea3 s\u1eed $d[0] = -\\infty$ v\u00e0 \u0111\u1ed1i v\u1edbi t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ed9 d\u00e0i kh\u00e1c $d[l] = \\infty$.</p> <p>Ch\u00fang ta s\u1ebd l\u1ea1i x\u1eed l\u00fd d\u1ea7n d\u1ea7n c\u00e1c s\u1ed1, \u0111\u1ea7u ti\u00ean $a[0]$, sau \u0111\u00f3 $a[1]$, v.v., v\u00e0 trong m\u1ed7i b\u01b0\u1edbc duy tr\u00ec m\u1ea3ng $d[]$ sao cho n\u00f3 \u0111\u01b0\u1ee3c c\u1eadp nh\u1eadt.</p> <p>V\u00ed d\u1ee5</p> <p>Cho m\u1ea3ng $a = \\{8, 3, 4, 6, 5, 2, 0, 7, 9, 1\\}$, \u0111\u00e2y l\u00e0 t\u1ea5t c\u1ea3 c\u00e1c ti\u1ec1n t\u1ed1 c\u1ee7a ch\u00fang v\u00e0 m\u1ea3ng quy ho\u1ea1ch \u0111\u1ed9ng c\u1ee7a ch\u00fang. L\u01b0u \u00fd r\u1eb1ng c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a m\u1ea3ng kh\u00f4ng ph\u1ea3i l\u00fac n\u00e0o c\u0169ng thay \u0111\u1ed5i \u1edf cu\u1ed1i.</p> $$ \\begin{array}{ll} \\text{prefix} = \\{\\} &amp;\\quad d = \\{-\\infty, \\infty, \\dots\\}\\\\ \\text{prefix} = \\{8\\} &amp;\\quad d = \\{-\\infty, 8, \\infty, \\dots\\}\\\\ \\text{prefix} = \\{8, 3\\} &amp;\\quad d = \\{-\\infty, 3, \\infty, \\dots\\}\\\\ \\text{prefix} = \\{8, 3, 4\\} &amp;\\quad d = \\{-\\infty, 3, 4, \\infty, \\dots\\}\\\\ \\text{prefix} = \\{8, 3, 4, 6\\} &amp;\\quad d = \\{-\\infty, 3, 4, 6, \\infty, \\dots\\}\\\\ \\text{prefix} = \\{8, 3, 4, 6, 5\\} &amp;\\quad d = \\{-\\infty, 3, 4, 5, \\infty, \\dots\\}\\\\ \\text{prefix} = \\{8, 3, 4, 6, 5, 2\\} &amp;\\quad d = \\{-\\infty, 2, 4, 5, \\infty, \\dots \\}\\\\ \\text{prefix} = \\{8, 3, 4, 6, 5, 2, 0\\} &amp;\\quad d = \\{-\\infty, 0, 4, 5, \\infty, \\dots \\}\\\\ \\text{prefix} = \\{8, 3, 4, 6, 5, 2, 0, 7\\} &amp;\\quad d = \\{-\\infty, 0, 4, 5, 7, \\infty, \\dots \\}\\\\ \\text{prefix} = \\{8, 3, 4, 6, 5, 2, 0, 7, 9\\} &amp;\\quad d = \\{-\\infty, 0, 4, 5, 7, 9, \\infty, \\dots \\}\\\\ \\text{prefix} = \\{8, 3, 4, 6, 5, 2, 0, 7, 9, 1\\} &amp;\\quad d = \\{-\\infty, 0, 1, 5, 7, 9, \\infty, \\dots \\}\\\\ \\end{array} $$ <p>Khi ch\u00fang ta x\u1eed l\u00fd $a[i]$, ch\u00fang ta c\u00f3 th\u1ec3 t\u1ef1 h\u1ecfi. C\u00e1c \u0111i\u1ec1u ki\u1ec7n ph\u1ea3i l\u00e0 g\u00ec, \u0111\u1ec3 ch\u00fang ta vi\u1ebft s\u1ed1 hi\u1ec7n t\u1ea1i $a[i]$ v\u00e0o m\u1ea3ng $d[0 \\dots n]$?</p> <p>Ch\u00fang ta \u0111\u1eb7t $d[l] = a[i]$, n\u1ebfu c\u00f3 m\u1ed9t d\u00e3y con t\u0103ng d\u00e0i nh\u1ea5t c\u00f3 \u0111\u1ed9 d\u00e0i $l$ k\u1ebft th\u00fac b\u1eb1ng $a[i]$, v\u00e0 kh\u00f4ng c\u00f3 d\u00e3y con t\u0103ng d\u00e0i nh\u1ea5t n\u00e0o c\u00f3 \u0111\u1ed9 d\u00e0i $l$ k\u1ebft th\u00fac b\u1eb1ng m\u1ed9t s\u1ed1 nh\u1ecf h\u01a1n. T\u01b0\u01a1ng t\u1ef1 nh\u01b0 c\u00e1ch ti\u1ebfp c\u1eadn tr\u01b0\u1edbc, n\u1ebfu ch\u00fang ta x\u00f3a s\u1ed1 $a[i]$ kh\u1ecfi d\u00e3y tr\u00ecnh t\u0103ng d\u00e0i nh\u1ea5t c\u00f3 \u0111\u1ed9 d\u00e0i $l$, ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c m\u1ed9t d\u00e3y con t\u0103ng d\u00e0i nh\u1ea5t kh\u00e1c c\u00f3 \u0111\u1ed9 d\u00e0i $l -1$. V\u00ec v\u1eady, ch\u00fang ta mu\u1ed1n m\u1edf r\u1ed9ng m\u1ed9t d\u00e3y con t\u0103ng d\u00e0i nh\u1ea5t c\u00f3 \u0111\u1ed9 d\u00e0i $l - 1$ b\u1eb1ng s\u1ed1 $a[i]$, v\u00e0 r\u00f5 r\u00e0ng d\u00e3y con t\u0103ng d\u00e0i nh\u1ea5t c\u00f3 \u0111\u1ed9 d\u00e0i $l - 1$ k\u1ebft th\u00fac b\u1eb1ng ph\u1ea7n t\u1eed nh\u1ecf nh\u1ea5t s\u1ebd ho\u1ea1t \u0111\u1ed9ng t\u1ed1t nh\u1ea5t, n\u00f3i c\u00e1ch kh\u00e1c d\u00e3y c\u00f3 \u0111\u1ed9 d\u00e0i $l-1$ k\u1ebft th\u00fac \u1edf ph\u1ea7n t\u1eed $d[l-1]$.</p> <p>C\u00f3 m\u1ed9t d\u00e3y con t\u0103ng d\u00e0i nh\u1ea5t c\u00f3 \u0111\u1ed9 d\u00e0i $l - 1$ m\u00e0 ch\u00fang ta c\u00f3 th\u1ec3 m\u1edf r\u1ed9ng b\u1eb1ng s\u1ed1 $a[i]$, ch\u00ednh x\u00e1c n\u1ebfu $d[l-1] &lt; a[i]$. V\u00ec v\u1eady, ch\u00fang ta c\u00f3 th\u1ec3 ch\u1ec9 c\u1ea7n l\u1eb7p l\u1ea1i t\u1eebng \u0111\u1ed9 d\u00e0i $l$, v\u00e0 ki\u1ec3m tra xem ch\u00fang ta c\u00f3 th\u1ec3 m\u1edf r\u1ed9ng m\u1ed9t d\u00e3y con t\u0103ng d\u00e0i nh\u1ea5t c\u00f3 \u0111\u1ed9 d\u00e0i $l - 1$ hay kh\u00f4ng b\u1eb1ng c\u00e1ch ki\u1ec3m tra c\u00e1c ti\u00eau ch\u00ed.</p> <p>Ngo\u00e0i ra, ch\u00fang ta c\u0169ng c\u1ea7n ki\u1ec3m tra, xem li\u1ec7u ch\u00fang ta c\u00f3 th\u1ec3 \u0111\u00e3 t\u00ecm th\u1ea5y m\u1ed9t d\u00e3y con t\u0103ng d\u00e0i nh\u1ea5t c\u00f3 \u0111\u1ed9 d\u00e0i $l$ v\u1edbi m\u1ed9t s\u1ed1 nh\u1ecf h\u01a1n \u1edf cu\u1ed1i hay kh\u00f4ng. V\u00ec v\u1eady, ch\u00fang ta ch\u1ec9 c\u1eadp nh\u1eadt n\u1ebfu $a[i] &lt; d[l]$.</p> <p>Sau khi x\u1eed l\u00fd t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed c\u1ee7a $a[]$, \u0111\u1ed9 d\u00e0i c\u1ee7a d\u00e3y con mong mu\u1ed1n l\u00e0 $l$ l\u1edbn nh\u1ea5t v\u1edbi $d[l] &lt; \\infty$.</p> <pre><code>int lis(vector&lt;int&gt; const&amp; a) {\n    int n = a.size();\n    const int INF = 1e9;\n    vector&lt;int&gt; d(n+1, INF);\n    d[0] = -INF;\n\n    for (int i = 0; i &lt; n; i++) {\n        for (int l = 1; l &lt;= n; l++) {\n            if (d[l-1] &lt; a[i] &amp;&amp; a[i] &lt; d[l])\n                d[l] = a[i];\n        }\n    }\n\n    int ans = 0;\n    for (int l = 0; l &lt;= n; l++) {\n        if (d[l] &lt; INF)\n            ans = l;\n    }\n    return ans;\n}\n</code></pre> <p>B\u00e2y gi\u1edd ch\u00fang ta th\u1ef1c hi\u1ec7n hai quan s\u00e1t quan tr\u1ecdng.</p> <ol> <li> <p>M\u1ea3ng $d$ s\u1ebd lu\u00f4n \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp:     $d[l-1] &lt; d[l]$ v\u1edbi m\u1ecdi $i = 1 \\dots n$.</p> <p>\u0110i\u1ec1u n\u00e0y l\u00e0 t\u1ea7m th\u01b0\u1eddng, v\u00ec b\u1ea1n ch\u1ec9 c\u1ea7n x\u00f3a ph\u1ea7n t\u1eed cu\u1ed1i c\u00f9ng kh\u1ecfi d\u00e3y con t\u0103ng c\u00f3 \u0111\u1ed9 d\u00e0i $l$, v\u00e0 b\u1ea1n nh\u1eadn \u0111\u01b0\u1ee3c m\u1ed9t d\u00e3y con t\u0103ng c\u00f3 \u0111\u1ed9 d\u00e0i $l-1$ v\u1edbi s\u1ed1 k\u1ebft th\u00fac nh\u1ecf h\u01a1n.</p> </li> <li> <p>Ph\u1ea7n t\u1eed $a[i]$ s\u1ebd ch\u1ec9 c\u1eadp nh\u1eadt t\u1ed1i \u0111a m\u1ed9t gi\u00e1 tr\u1ecb $d[l]$.</p> <p>\u0110i\u1ec1u n\u00e0y theo ngay l\u1eadp t\u1ee9c t\u1eeb vi\u1ec7c c\u00e0i \u0111\u1eb7t \u1edf tr\u00ean. Ch\u1ec9 c\u00f3 th\u1ec3 c\u00f3 m\u1ed9t v\u1ecb tr\u00ed trong m\u1ea3ng v\u1edbi $d[l-1] &lt; a[i] &lt; d[l]$.</p> </li> </ol> <p>Do \u0111\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm ph\u1ea7n t\u1eed n\u00e0y trong m\u1ea3ng $d[]$ b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n trong $O(\\log n)$. Tr\u00ean th\u1ef1c t\u1ebf, ch\u00fang ta c\u00f3 th\u1ec3 ch\u1ec9 c\u1ea7n t\u00ecm trong m\u1ea3ng $d[]$ s\u1ed1 \u0111\u1ea7u ti\u00ean l\u1edbn h\u01a1n h\u1eb3n $a[i]$, v\u00e0 ch\u00fang ta c\u1ed1 g\u1eafng c\u1eadp nh\u1eadt ph\u1ea7n t\u1eed n\u00e0y theo c\u00e1ch t\u01b0\u01a1ng t\u1ef1 nh\u01b0 c\u00e0i \u0111\u1eb7t \u1edf tr\u00ean.</p>","tags":["Translated"]},{"location":"dynamic_programming/longest_increasing_subsequence.html#implementation-1","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>\u0110i\u1ec1u n\u00e0y mang l\u1ea1i cho ch\u00fang ta c\u00e0i \u0111\u1eb7t $O(n \\log n)$ c\u1ea3i ti\u1ebfn:</p> <pre><code>int lis(vector&lt;int&gt; const&amp; a) {\n    int n = a.size();\n    const int INF = 1e9;\n    vector&lt;int&gt; d(n+1, INF);\n    d[0] = -INF;\n\n    for (int i = 0; i &lt; n; i++) {\n        int l = upper_bound(d.begin(), d.end(), a[i]) - d.begin();\n        if (d[l-1] &lt; a[i] &amp;&amp; a[i] &lt; d[l])\n            d[l] = a[i];\n    }\n\n    int ans = 0;\n    for (int l = 0; l &lt;= n; l++) {\n        if (d[l] &lt; INF)\n            ans = l;\n    }\n    return ans;\n}\n</code></pre>","tags":["Translated"]},{"location":"dynamic_programming/longest_increasing_subsequence.html#restoring-the-subsequence-1","title":"Kh\u00f4i ph\u1ee5c d\u00e3y con (Restoring the subsequence)","text":"<p>C\u0169ng c\u00f3 th\u1ec3 kh\u00f4i ph\u1ee5c d\u00e3y con b\u1eb1ng ph\u01b0\u01a1ng ph\u00e1p n\u00e0y. L\u1ea7n n\u00e0y ch\u00fang ta ph\u1ea3i duy tr\u00ec hai m\u1ea3ng ph\u1ee5. M\u1ed9t m\u1ea3ng cho ch\u00fang ta bi\u1ebft ch\u1ec9 s\u1ed1 c\u1ee7a c\u00e1c ph\u1ea7n t\u1eed trong $d[]$. V\u00e0 m\u1ed9t l\u1ea7n n\u1eefa ch\u00fang ta ph\u1ea3i t\u1ea1o m\u1ed9t m\u1ea3ng c\u00e1c \"t\u1ed5 ti\u00ean\" $p[i]$. $p[i]$ s\u1ebd l\u00e0 ch\u1ec9 s\u1ed1 c\u1ee7a ph\u1ea7n t\u1eed tr\u01b0\u1edbc \u0111\u00f3 cho d\u00e3y con t\u1ed1i \u01b0u k\u1ebft th\u00fac b\u1eb1ng ph\u1ea7n t\u1eed $i$.</p> <p>D\u1ec5 d\u00e0ng duy tr\u00ec hai m\u1ea3ng n\u00e0y trong qu\u00e1 tr\u00ecnh l\u1eb7p qua m\u1ea3ng $a[]$ c\u00f9ng v\u1edbi c\u00e1c t\u00ednh to\u00e1n c\u1ee7a $d[]$. V\u00e0 cu\u1ed1i c\u00f9ng, kh\u00f4ng kh\u00f3 \u0111\u1ec3 kh\u00f4i ph\u1ee5c d\u00e3y con mong mu\u1ed1n b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng c\u00e1c m\u1ea3ng n\u00e0y.</p>","tags":["Translated"]},{"location":"dynamic_programming/longest_increasing_subsequence.html#solution-in-o-n-log-n-with-data-structures","title":"Gi\u1ea3i ph\u00e1p trong $O(n \\log n)$ v\u1edbi c\u1ea5u tr\u00fac d\u1eef li\u1ec7u (Solution in O(n log n) with data structures)","text":"<p>Thay v\u00ec ph\u01b0\u01a1ng ph\u00e1p tr\u00ean \u0111\u1ec3 t\u00ednh d\u00e3y con t\u0103ng d\u00e0i nh\u1ea5t trong $O(n \\log n)$, ch\u00fang ta c\u0169ng c\u00f3 th\u1ec3 gi\u1ea3i quy\u1ebft b\u00e0i to\u00e1n theo m\u1ed9t c\u00e1ch kh\u00e1c: s\u1eed d\u1ee5ng m\u1ed9t s\u1ed1 c\u1ea5u tr\u00fac d\u1eef li\u1ec7u \u0111\u01a1n gi\u1ea3n.</p> <p>H\u00e3y quay l\u1ea1i ph\u01b0\u01a1ng ph\u00e1p \u0111\u1ea7u ti\u00ean. H\u00e3y nh\u1edb r\u1eb1ng $d[i]$ l\u00e0 gi\u00e1 tr\u1ecb $d[j] + 1$ v\u1edbi $j &lt; i$ v\u00e0 $a[j] &lt; a[i]$.</p> <p>Do \u0111\u00f3 n\u1ebfu ch\u00fang ta \u0111\u1ecbnh ngh\u0129a th\u00eam m\u1ed9t m\u1ea3ng $t[]$ sao cho</p> $$t[a[i]] = d[i],$$ <p>th\u00ec b\u00e0i to\u00e1n t\u00ednh gi\u00e1 tr\u1ecb $d[i]$ t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi vi\u1ec7c t\u00ecm gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t trong m\u1ed9t ti\u1ec1n t\u1ed1 c\u1ee7a m\u1ea3ng $t[]$:</p> $$d[i] = \\max\\left(t[0 \\dots a[i] - 1] + 1\\right)$$ <p>B\u00e0i to\u00e1n t\u00ecm gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t c\u1ee7a m\u1ed9t ti\u1ec1n t\u1ed1 c\u1ee7a m\u1ed9t m\u1ea3ng (thay \u0111\u1ed5i) l\u00e0 m\u1ed9t b\u00e0i to\u00e1n ti\u00eau chu\u1ea9n c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i quy\u1ebft b\u1eb1ng nhi\u1ec1u c\u1ea5u tr\u00fac d\u1eef li\u1ec7u kh\u00e1c nhau. V\u00ed d\u1ee5: ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng Segment tree ho\u1eb7c Fenwick tree.</p> <p>Ph\u01b0\u01a1ng ph\u00e1p n\u00e0y r\u00f5 r\u00e0ng c\u00f3 m\u1ed9t s\u1ed1 nh\u01b0\u1ee3c \u0111i\u1ec3m: v\u1ec1 \u0111\u1ed9 d\u00e0i v\u00e0 \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a vi\u1ec7c c\u00e0i \u0111\u1eb7t, c\u00e1ch ti\u1ebfp c\u1eadn n\u00e0y s\u1ebd t\u1ec7 h\u01a1n ph\u01b0\u01a1ng ph\u00e1p s\u1eed d\u1ee5ng t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n. Ngo\u00e0i ra, n\u1ebfu c\u00e1c s\u1ed1 \u0111\u1ea7u v\u00e0o $a[i]$ \u0111\u1eb7c bi\u1ec7t l\u1edbn, th\u00ec ch\u00fang ta s\u1ebd ph\u1ea3i s\u1eed d\u1ee5ng m\u1ed9t s\u1ed1 th\u1ee7 thu\u1eadt, nh\u01b0 n\u00e9n s\u1ed1 (t\u1ee9c l\u00e0 \u0111\u00e1nh s\u1ed1 l\u1ea1i ch\u00fang t\u1eeb $0$ \u0111\u1ebfn $n-1$), ho\u1eb7c s\u1eed d\u1ee5ng segment tree \u0111\u1ed9ng (ch\u1ec9 t\u1ea1o c\u00e1c nh\u00e1nh c\u1ee7a c\u00e2y quan tr\u1ecdng). N\u1ebfu kh\u00f4ng m\u1ee9c ti\u00eau th\u1ee5 b\u1ed9 nh\u1edb s\u1ebd qu\u00e1 cao.</p> <p>M\u1eb7t kh\u00e1c ph\u01b0\u01a1ng ph\u00e1p n\u00e0y c\u0169ng c\u00f3 m\u1ed9t s\u1ed1 \u01b0u \u0111i\u1ec3m: v\u1edbi ph\u01b0\u01a1ng ph\u00e1p n\u00e0y b\u1ea1n kh\u00f4ng ph\u1ea3i suy ngh\u0129 v\u1ec1 b\u1ea5t k\u1ef3 t\u00ednh ch\u1ea5t ph\u1ee9c t\u1ea1p n\u00e0o trong gi\u1ea3i ph\u00e1p quy ho\u1ea1ch \u0111\u1ed9ng. V\u00e0 c\u00e1ch ti\u1ebfp c\u1eadn n\u00e0y cho ph\u00e9p ch\u00fang ta kh\u00e1i qu\u00e1t h\u00f3a b\u00e0i to\u00e1n r\u1ea5t d\u1ec5 d\u00e0ng (xem b\u00ean d\u01b0\u1edbi).</p>","tags":["Translated"]},{"location":"dynamic_programming/longest_increasing_subsequence.html#related-tasks","title":"C\u00e1c nhi\u1ec7m v\u1ee5 li\u00ean quan (Related tasks)","text":"<p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u1ed9t v\u00e0i b\u00e0i to\u00e1n li\u00ean quan ch\u1eb7t ch\u1ebd \u0111\u1ebfn b\u00e0i to\u00e1n t\u00ecm d\u00e3y con t\u0103ng d\u00e0i nh\u1ea5t.</p>","tags":["Translated"]},{"location":"dynamic_programming/longest_increasing_subsequence.html#longest-non-decreasing-subsequence","title":"D\u00e3y con kh\u00f4ng gi\u1ea3m d\u00e0i nh\u1ea5t (Longest non-decreasing subsequence)","text":"<p>\u0110\u00e2y th\u1ef1c t\u1ebf g\u1ea7n nh\u01b0 l\u00e0 c\u00f9ng m\u1ed9t b\u00e0i to\u00e1n. Ch\u1ec9 b\u00e2y gi\u1edd ng\u01b0\u1eddi ta cho ph\u00e9p s\u1eed d\u1ee5ng c\u00e1c s\u1ed1 gi\u1ed1ng nhau trong d\u00e3y con.</p> <p>Gi\u1ea3i ph\u00e1p v\u1ec1 c\u01a1 b\u1ea3n c\u0169ng g\u1ea7n gi\u1ed1ng nhau. Ch\u00fang ta ch\u1ec9 c\u1ea7n thay \u0111\u1ed5i c\u00e1c d\u1ea5u b\u1ea5t \u0111\u1eb3ng th\u1ee9c, v\u00e0 s\u1eeda \u0111\u1ed5i m\u1ed9t ch\u00fat t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n.</p>","tags":["Translated"]},{"location":"dynamic_programming/longest_increasing_subsequence.html#number-of-longest-increasing-subsequences","title":"S\u1ed1 l\u01b0\u1ee3ng c\u00e1c d\u00e3y con t\u0103ng d\u00e0i nh\u1ea5t (Number of longest increasing subsequences)","text":"<p>Ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng ph\u01b0\u01a1ng ph\u00e1p \u0111\u1ea7u ti\u00ean \u0111\u01b0\u1ee3c th\u1ea3o lu\u1eadn, ho\u1eb7c phi\u00ean b\u1ea3n $O(n^2)$ ho\u1eb7c phi\u00ean b\u1ea3n s\u1eed d\u1ee5ng c\u1ea5u tr\u00fac d\u1eef li\u1ec7u. Ch\u00fang ta ch\u1ec9 ph\u1ea3i l\u01b0u tr\u1eef th\u00eam c\u00f3 bao nhi\u00eau c\u00e1ch ch\u00fang ta c\u00f3 th\u1ec3 nh\u1eadn \u0111\u01b0\u1ee3c c\u00e1c d\u00e3y con t\u0103ng d\u00e0i nh\u1ea5t k\u1ebft th\u00fac b\u1eb1ng c\u00e1c gi\u00e1 tr\u1ecb $d[i]$.</p> <p>S\u1ed1 c\u00e1ch \u0111\u1ec3 t\u1ea1o th\u00e0nh m\u1ed9t d\u00e3y con t\u0103ng d\u00e0i nh\u1ea5t k\u1ebft th\u00fac trong $a[i]$ l\u00e0 t\u1ed5ng c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c c\u00e1ch cho t\u1ea5t c\u1ea3 c\u00e1c d\u00e3y con t\u0103ng d\u00e0i nh\u1ea5t k\u1ebft th\u00fac trong $j$ trong \u0111\u00f3 $d[j]$ l\u00e0 c\u1ef1c \u0111\u1ea1i. C\u00f3 th\u1ec3 c\u00f3 nhi\u1ec1u $j$ nh\u01b0 v\u1eady, v\u00ec v\u1eady ch\u00fang ta c\u1ea7n t\u00ednh t\u1ed5ng t\u1ea5t c\u1ea3 ch\u00fang.</p> <p>S\u1eed d\u1ee5ng Segment tree, c\u00e1ch ti\u1ebfp c\u1eadn n\u00e0y c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c tri\u1ec3n khai trong $O(n \\log n)$.</p> <p>Kh\u00f4ng th\u1ec3 s\u1eed d\u1ee5ng ph\u01b0\u01a1ng ph\u00e1p t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n cho nhi\u1ec7m v\u1ee5 n\u00e0y.</p>","tags":["Translated"]},{"location":"dynamic_programming/longest_increasing_subsequence.html#smallest-number-of-non-increasing-subsequences-covering-a-sequence","title":"S\u1ed1 l\u01b0\u1ee3ng nh\u1ecf nh\u1ea5t c\u00e1c d\u00e3y con kh\u00f4ng t\u0103ng bao ph\u1ee7 m\u1ed9t d\u00e3y (Smallest number of non-increasing subsequences covering a sequence)","text":"<p>Cho m\u1ed9t m\u1ea3ng nh\u1ea5t \u0111\u1ecbnh v\u1edbi $n$ s\u1ed1 $a[0 \\dots n - 1]$, ch\u00fang ta ph\u1ea3i t\u00f4 m\u00e0u c\u00e1c s\u1ed1 b\u1eb1ng s\u1ed1 l\u01b0\u1ee3ng m\u00e0u nh\u1ecf nh\u1ea5t, sao cho m\u1ed7i m\u00e0u t\u1ea1o th\u00e0nh m\u1ed9t d\u00e3y con kh\u00f4ng t\u0103ng.</p> <p>\u0110\u1ec3 gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 n\u00e0y, ch\u00fang ta nh\u1eadn th\u1ea5y r\u1eb1ng s\u1ed1 l\u01b0\u1ee3ng m\u00e0u t\u1ed1i thi\u1ec3u c\u1ea7n thi\u1ebft b\u1eb1ng v\u1edbi \u0111\u1ed9 d\u00e0i c\u1ee7a d\u00e3y con t\u0103ng d\u00e0i nh\u1ea5t.</p> <p>Ch\u1ee9ng minh: Ch\u00fang ta c\u1ea7n ch\u1ee9ng minh t\u00ednh \u0111\u1ed1i ng\u1eabu c\u1ee7a hai b\u00e0i to\u00e1n n\u00e0y.</p> <p>H\u00e3y k\u00fd hi\u1ec7u $x$ l\u00e0 \u0111\u1ed9 d\u00e0i c\u1ee7a d\u00e3y con t\u0103ng d\u00e0i nh\u1ea5t v\u00e0 $y$ l\u00e0 s\u1ed1 l\u01b0\u1ee3ng \u00edt nh\u1ea5t c\u00e1c d\u00e3y con kh\u00f4ng t\u0103ng t\u1ea1o th\u00e0nh m\u1ed9t l\u1edbp ph\u1ee7. Ch\u00fang ta c\u1ea7n ch\u1ee9ng minh r\u1eb1ng $x = y$.</p> <p>R\u00f5 r\u00e0ng l\u00e0 $y &lt; x$ l\u00e0 kh\u00f4ng th\u1ec3, b\u1edfi v\u00ec n\u1ebfu ch\u00fang ta c\u00f3 $x$ ph\u1ea7n t\u1eed t\u0103ng nghi\u00eam ng\u1eb7t, th\u00ec kh\u00f4ng c\u00f3 hai ph\u1ea7n t\u1eed n\u00e0o c\u00f3 th\u1ec3 l\u00e0 m\u1ed9t ph\u1ea7n c\u1ee7a c\u00f9ng m\u1ed9t d\u00e3y con kh\u00f4ng t\u0103ng. Do \u0111\u00f3 ch\u00fang ta c\u00f3 $y \\ge x$.</p> <p>B\u00e2y gi\u1edd ch\u00fang ta ch\u1ec9 ra r\u1eb1ng $y &gt; x$ l\u00e0 kh\u00f4ng th\u1ec3 b\u1eb1ng c\u00e1ch ph\u1ea3n ch\u1ee9ng. Gi\u1ea3 s\u1eed r\u1eb1ng $y &gt; x$. Sau \u0111\u00f3, ch\u00fang ta xem x\u00e9t b\u1ea5t k\u1ef3 t\u1eadp h\u1ee3p t\u1ed1i \u01b0u n\u00e0o c\u1ee7a $y$ d\u00e3y con kh\u00f4ng t\u0103ng. Ch\u00fang ta bi\u1ebfn \u0111\u1ed5i t\u1eadp h\u1ee3p n\u00e0y theo c\u00e1ch sau: mi\u1ec5n l\u00e0 c\u00f3 hai d\u00e3y con nh\u01b0 v\u1eady sao cho d\u00e3y \u0111\u1ea7u ti\u00ean b\u1eaft \u0111\u1ea7u tr\u01b0\u1edbc d\u00e3y con th\u1ee9 hai, v\u00e0 d\u00e3y \u0111\u1ea7u ti\u00ean b\u1eaft \u0111\u1ea7u b\u1eb1ng m\u1ed9t s\u1ed1 l\u1edbn h\u01a1n ho\u1eb7c b\u1eb1ng d\u00e3y th\u1ee9 hai, th\u00ec ch\u00fang ta th\u00e1o s\u1ed1 b\u1eaft \u0111\u1ea7u n\u00e0y v\u00e0 g\u1eafn n\u00f3 v\u00e0o \u0111\u1ea7u c\u1ee7a d\u00e3y th\u1ee9 hai. Sau m\u1ed9t s\u1ed1 h\u1eefu h\u1ea1n c\u00e1c b\u01b0\u1edbc, ch\u00fang ta c\u00f3 $y$ d\u00e3y con, v\u00e0 c\u00e1c s\u1ed1 b\u1eaft \u0111\u1ea7u c\u1ee7a ch\u00fang s\u1ebd t\u1ea1o th\u00e0nh m\u1ed9t d\u00e3y con t\u0103ng c\u00f3 \u0111\u1ed9 d\u00e0i $y$. V\u00ec ch\u00fang ta \u0111\u00e3 gi\u1ea3 \u0111\u1ecbnh r\u1eb1ng $y &gt; x$, ch\u00fang ta \u0111\u00e3 \u0111\u1ea1t \u0111\u01b0\u1ee3c m\u1ed9t m\u00e2u thu\u1eabn.</p> <p>Do \u0111\u00f3 suy ra r\u1eb1ng $y = x$.</p> <p>Kh\u00f4i ph\u1ee5c c\u00e1c d\u00e3y: Ph\u00e2n v\u00f9ng mong mu\u1ed1n c\u1ee7a d\u00e3y th\u00e0nh c\u00e1c d\u00e3y con c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n m\u1ed9t c\u00e1ch tham lam. T\u1ee9c l\u00e0 \u0111i t\u1eeb tr\u00e1i sang ph\u1ea3i v\u00e0 g\u00e1n s\u1ed1 hi\u1ec7n t\u1ea1i ho\u1eb7c d\u00e3y con \u0111\u00f3 k\u1ebft th\u00fac b\u1eb1ng s\u1ed1 nh\u1ecf nh\u1ea5t l\u1edbn h\u01a1n ho\u1eb7c b\u1eb1ng s\u1ed1 hi\u1ec7n t\u1ea1i.</p>","tags":["Translated"]},{"location":"dynamic_programming/longest_increasing_subsequence.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>ACMSGURU - \"North-East\"</li> <li>Codeforces - LCIS</li> <li>Codeforces - Tourist</li> <li>SPOJ - DOSA</li> <li>SPOJ - HMLIS</li> <li>SPOJ - ONEXLIS</li> <li>SPOJ - SUPPER</li> <li>Topcoder - AutoMarket</li> <li>Topcoder - BridgeArrangement</li> <li>Topcoder - IntegerSequence</li> <li>UVA - Back To Edit Distance</li> <li>UVA - Happy Birthday</li> <li>UVA - Tiling Up Blocks</li> </ul>","tags":["Translated"]},{"location":"dynamic_programming/longest_increasing_subsequence.html#checklist","title":"Checklist","text":"<ul> <li>Original lines: 361</li> <li>Translated lines: 361</li> <li>Code blocks changed? No</li> <li>Inline code changed? No</li> <li>Technical terms kept in English? Yes</li> <li>Headings anchors preserved/added correctly? Yes</li> <li>I confirm no character was omitted: YES</li> </ul>","tags":["Translated"]},{"location":"dynamic_programming/profile-dynamics.html","title":"Quy ho\u1ea1ch \u0111\u1ed9ng tr\u00ean Profile g\u00e3y. B\u00e0i to\u00e1n \"Parquet\" (Dynamic Programming on Broken Profile. Problem \"Parquet\")","text":"<p>C\u00e1c b\u00e0i to\u00e1n ph\u1ed5 bi\u1ebfn \u0111\u01b0\u1ee3c gi\u1ea3i quy\u1ebft b\u1eb1ng DP tr\u00ean profile g\u00e3y (broken profile) bao g\u1ed3m:</p> <ul> <li>t\u00ecm s\u1ed1 c\u00e1ch \u0111\u1ec3 l\u1ea5p \u0111\u1ea7y ho\u00e0n to\u00e0n m\u1ed9t di\u1ec7n t\u00edch (v\u00ed d\u1ee5: b\u00e0n c\u1edd/l\u01b0\u1edbi) b\u1eb1ng m\u1ed9t s\u1ed1 h\u00ecnh (v\u00ed d\u1ee5: domino)</li> <li>t\u00ecm m\u1ed9t c\u00e1ch \u0111\u1ec3 l\u1ea5p \u0111\u1ea7y m\u1ed9t di\u1ec7n t\u00edch v\u1edbi s\u1ed1 l\u01b0\u1ee3ng h\u00ecnh t\u1ed1i thi\u1ec3u</li> <li>t\u00ecm m\u1ed9t c\u00e1ch l\u1ea5p \u0111\u1ea7y m\u1ed9t ph\u1ea7n v\u1edbi s\u1ed1 l\u01b0\u1ee3ng kh\u00f4ng gian ch\u01b0a l\u1ea5p \u0111\u1ea7y t\u1ed1i thi\u1ec3u (ho\u1eb7c c\u00e1c \u00f4, trong tr\u01b0\u1eddng h\u1ee3p l\u01b0\u1edbi)</li> <li>t\u00ecm m\u1ed9t c\u00e1ch l\u1ea5p \u0111\u1ea7y m\u1ed9t ph\u1ea7n v\u1edbi s\u1ed1 l\u01b0\u1ee3ng h\u00ecnh t\u1ed1i thi\u1ec3u, sao cho kh\u00f4ng th\u1ec3 th\u00eam h\u00ecnh n\u00e0o n\u1eefa</li> </ul>","tags":["Translated"]},{"location":"dynamic_programming/profile-dynamics.html#problem-parquet","title":"B\u00e0i to\u00e1n \"Parquet\" (Problem \"Parquet\")","text":"<p>M\u00f4 t\u1ea3 b\u00e0i to\u00e1n. Cho m\u1ed9t l\u01b0\u1edbi k\u00edch th\u01b0\u1edbc $N \\times M$. T\u00ecm s\u1ed1 c\u00e1ch \u0111\u1ec3 l\u1ea5p \u0111\u1ea7y l\u01b0\u1edbi b\u1eb1ng c\u00e1c h\u00ecnh c\u00f3 k\u00edch th\u01b0\u1edbc $2 \\times 1$ (kh\u00f4ng \u0111\u01b0\u1ee3c \u0111\u1ec3 l\u1ea1i \u00f4 n\u00e0o ch\u01b0a l\u1ea5p \u0111\u1ea7y, v\u00e0 c\u00e1c h\u00ecnh kh\u00f4ng \u0111\u01b0\u1ee3c ch\u1ed3ng l\u00ean nhau).</p> <p>\u0110\u1eb7t tr\u1ea1ng th\u00e1i DP l\u00e0: $dp[i, mask]$, trong \u0111\u00f3 $i = 1, \\ldots N$ v\u00e0 $mask = 0, \\ldots 2^M - 1$.</p> <p>$i$ \u0111\u1ea1i di\u1ec7n cho s\u1ed1 h\u00e0ng trong l\u01b0\u1edbi hi\u1ec7n t\u1ea1i, v\u00e0 $mask$ l\u00e0 tr\u1ea1ng th\u00e1i c\u1ee7a h\u00e0ng cu\u1ed1i c\u00f9ng c\u1ee7a l\u01b0\u1edbi hi\u1ec7n t\u1ea1i. N\u1ebfu bit th\u1ee9 $j$ c\u1ee7a $mask$ l\u00e0 $0$ th\u00ec \u00f4 t\u01b0\u01a1ng \u1ee9ng \u0111\u00e3 \u0111\u01b0\u1ee3c l\u1ea5p \u0111\u1ea7y, ng\u01b0\u1ee3c l\u1ea1i n\u00f3 ch\u01b0a \u0111\u01b0\u1ee3c l\u1ea5p \u0111\u1ea7y.</p> <p>R\u00f5 r\u00e0ng, c\u00e2u tr\u1ea3 l\u1eddi cho b\u00e0i to\u00e1n s\u1ebd l\u00e0 $dp[N, 0]$.</p> <p>Ch\u00fang ta s\u1ebd x\u00e2y d\u1ef1ng tr\u1ea1ng th\u00e1i DP b\u1eb1ng c\u00e1ch l\u1eb7p qua t\u1eebng $i = 1, \\cdots N$ v\u00e0 t\u1eebng $mask = 0, \\ldots 2^M - 1$, v\u00e0 v\u1edbi m\u1ed7i $mask$ ch\u00fang ta s\u1ebd ch\u1ec9 chuy\u1ec3n ti\u1ebfp, t\u1ee9c l\u00e0, ch\u00fang ta s\u1ebd th\u00eam c\u00e1c h\u00ecnh v\u00e0o l\u01b0\u1edbi hi\u1ec7n t\u1ea1i.</p>","tags":["Translated"]},{"location":"dynamic_programming/profile-dynamics.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<pre><code>int n, m;\nvector &lt; vector&lt;long long&gt; &gt; dp;\n\n\nvoid calc (int x = 0, int y = 0, int mask = 0, int next_mask = 0)\n{\n    if (x == n)\n        return;\n    if (y &gt;= m)\n        dp[x+1][next_mask] += dp[x][mask];\n    else\n    {\n        int my_mask = 1 &lt;&lt; y;\n        if (mask &amp; my_mask)\n            calc (x, y+1, mask, next_mask);\n        else\n        {\n            calc (x, y+1, mask, next_mask | my_mask);\n            if (y+1 &lt; m &amp;&amp; ! (mask &amp; my_mask) &amp;&amp; ! (mask &amp; (my_mask &lt;&lt; 1)))\n                calc (x, y+2, mask, next_mask);\n        }\n    }\n}\n\n\nint main()\n{\n    cin &gt;&gt; n &gt;&gt; m;\n\n    dp.resize (n+1, vector&lt;long long&gt; (1&lt;&lt;m));\n    dp[0][0] = 1;\n    for (int x=0; x&lt;n; ++x)\n        for (int mask=0; mask&lt;(1&lt;&lt;m); ++mask)\n            calc (x, 0, mask, 0);\n\n    cout &lt;&lt; dp[n][0];\n\n}\n</code></pre>","tags":["Translated"]},{"location":"dynamic_programming/profile-dynamics.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>UVA 10359 - Tiling</li> <li>UVA 10918 - Tri Tiling</li> <li>SPOJ GNY07H (Four Tiling)</li> <li>SPOJ M5TILE (Five Tiling)</li> <li>SPOJ MNTILE (MxN Tiling)</li> <li>SPOJ DOJ1</li> <li>SPOJ DOJ2</li> <li>SPOJ BTCODE_J</li> <li>SPOJ PBOARD</li> <li>ACM HDU 4285 - Circuits</li> <li>LiveArchive 4608 - Mosaic</li> <li>Timus 1519 - Formula 1</li> <li>Codeforces Parquet</li> </ul>","tags":["Translated"]},{"location":"dynamic_programming/profile-dynamics.html#references","title":"T\u00e0i li\u1ec7u tham kh\u1ea3o (References)","text":"<ul> <li>Blog by EvilBunny</li> <li>TopCoder Recipe by \"syg96\"</li> <li>Blogpost by sk765</li> </ul>","tags":["Translated"]},{"location":"dynamic_programming/zero_matrix.html","title":"T\u00ecm ma tr\u1eadn con to\u00e0n s\u1ed1 0 l\u1edbn nh\u1ea5t (Finding the largest zero submatrix)","text":"<p>B\u1ea1n \u0111\u01b0\u1ee3c cho m\u1ed9t ma tr\u1eadn v\u1edbi <code>n</code> h\u00e0ng v\u00e0 <code>m</code> c\u1ed9t. T\u00ecm ma tr\u1eadn con l\u1edbn nh\u1ea5t ch\u1ec9 bao g\u1ed3m c\u00e1c s\u1ed1 0 (ma tr\u1eadn con l\u00e0 m\u1ed9t v\u00f9ng h\u00ecnh ch\u1eef nh\u1eadt c\u1ee7a ma tr\u1eadn).</p>","tags":["Translated"]},{"location":"dynamic_programming/zero_matrix.html#algorithm","title":"Thu\u1eadt to\u00e1n (Algorithm)","text":"<p>C\u00e1c ph\u1ea7n t\u1eed c\u1ee7a ma tr\u1eadn s\u1ebd l\u00e0 <code>a[i][j]</code>, trong \u0111\u00f3 <code>i = 0...n - 1</code>, <code>j = 0... m - 1</code>. \u0110\u1ec3 \u0111\u01a1n gi\u1ea3n, ch\u00fang ta s\u1ebd coi t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed kh\u00e1c 0 \u0111\u1ec1u b\u1eb1ng 1.</p>","tags":["Translated"]},{"location":"dynamic_programming/zero_matrix.html#step-1-auxiliary-dynamic","title":"B\u01b0\u1edbc 1: Quy ho\u1ea1ch \u0111\u1ed9ng b\u1ed5 tr\u1ee3 (Step 1: Auxiliary dynamic)","text":"<p>\u0110\u1ea7u ti\u00ean, ch\u00fang ta t\u00ednh to\u00e1n ma tr\u1eadn ph\u1ee5 sau: <code>d[i][j]</code>, h\u00e0ng g\u1ea7n nh\u1ea5t c\u00f3 s\u1ed1 1 ph\u00eda tr\u00ean <code>a[i][j]</code>. N\u00f3i m\u1ed9t c\u00e1ch ch\u00ednh th\u1ee9c, <code>d[i][j]</code> l\u00e0 s\u1ed1 h\u00e0ng l\u1edbn nh\u1ea5t (t\u1eeb <code>0</code> \u0111\u1ebfn <code>i - 1</code>), trong \u0111\u00f3 c\u00f3 m\u1ed9t ph\u1ea7n t\u1eed b\u1eb1ng <code>1</code> \u1edf c\u1ed9t th\u1ee9 <code>j</code>. Trong khi l\u1eb7p t\u1eeb tr\u00ean c\u00f9ng b\u00ean tr\u00e1i sang d\u01b0\u1edbi c\u00f9ng b\u00ean ph\u1ea3i, khi ch\u00fang ta \u0111\u1ee9ng \u1edf h\u00e0ng <code>i</code>, ch\u00fang ta bi\u1ebft c\u00e1c gi\u00e1 tr\u1ecb t\u1eeb h\u00e0ng tr\u01b0\u1edbc \u0111\u00f3, v\u00ec v\u1eady, ch\u1ec9 c\u1ea7n c\u1eadp nh\u1eadt c\u00e1c ph\u1ea7n t\u1eed c\u00f3 gi\u00e1 tr\u1ecb <code>1</code> l\u00e0 \u0111\u1ee7. Ch\u00fang ta c\u00f3 th\u1ec3 l\u01b0u c\u00e1c gi\u00e1 tr\u1ecb trong m\u1ed9t m\u1ea3ng \u0111\u01a1n gi\u1ea3n <code>d[j]</code>, <code>j = 0...m - 1</code> (l\u01b0u \u00fd: v\u0103n b\u1ea3n g\u1ed1c ghi <code>i = 1...m - 1</code> nh\u01b0ng theo ng\u1eef c\u1ea3nh l\u00e0 <code>j</code>), b\u1edfi v\u00ec trong thu\u1eadt to\u00e1n ti\u1ebfp theo, ch\u00fang ta s\u1ebd x\u1eed l\u00fd ma tr\u1eadn t\u1eebng h\u00e0ng m\u1ed9t v\u00e0 ch\u1ec9 c\u1ea7n c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a h\u00e0ng hi\u1ec7n t\u1ea1i.</p> <pre><code>vector&lt;int&gt; d(m, -1);\nfor (int i = 0; i &lt; n; ++i) {\n    for (int j = 0; j &lt; m; ++j) {\n        if (a[i][j] == 1) {\n            d[j] = i;\n        }\n    }\n}\n</code></pre>","tags":["Translated"]},{"location":"dynamic_programming/zero_matrix.html#step-2-problem-solving","title":"B\u01b0\u1edbc 2: Gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 (Step 2: Problem solving)","text":"<p>Ch\u00fang ta c\u00f3 th\u1ec3 gi\u1ea3i quy\u1ebft b\u00e0i to\u00e1n trong $O(n m^2)$ b\u1eb1ng c\u00e1ch l\u1eb7p qua c\u00e1c h\u00e0ng, xem x\u00e9t m\u1ecdi c\u1ed9t tr\u00e1i v\u00e0 ph\u1ea3i c\u00f3 th\u1ec3 c\u00f3 cho m\u1ed9t ma tr\u1eadn con. \u0110\u00e1y c\u1ee7a h\u00ecnh ch\u1eef nh\u1eadt s\u1ebd l\u00e0 h\u00e0ng hi\u1ec7n t\u1ea1i, v\u00e0 s\u1eed d\u1ee5ng <code>d[i][j]</code>, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm th\u1ea5y h\u00e0ng tr\u00ean c\u00f9ng. Tuy nhi\u00ean, c\u00f3 th\u1ec3 \u0111i xa h\u01a1n v\u00e0 c\u1ea3i thi\u1ec7n \u0111\u00e1ng k\u1ec3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a gi\u1ea3i ph\u00e1p.</p> <p>R\u00f5 r\u00e0ng l\u00e0 ma tr\u1eadn con s\u1ed1 0 mong mu\u1ed1n \u0111\u01b0\u1ee3c gi\u1edbi h\u1ea1n \u1edf c\u1ea3 b\u1ed1n ph\u00eda b\u1edfi m\u1ed9t s\u1ed1 s\u1ed1 1, ng\u0103n kh\u00f4ng cho n\u00f3 t\u0103ng k\u00edch th\u01b0\u1edbc v\u00e0 c\u1ea3i thi\u1ec7n c\u00e2u tr\u1ea3 l\u1eddi. V\u00ec v\u1eady, ch\u00fang ta s\u1ebd kh\u00f4ng b\u1ecf l\u1ee1 c\u00e2u tr\u1ea3 l\u1eddi n\u1ebfu ch\u00fang ta h\u00e0nh \u0111\u1ed9ng nh\u01b0 sau: \u0111\u1ed1i v\u1edbi m\u1ed7i \u00f4 <code>j</code> trong h\u00e0ng <code>i</code> (h\u00e0ng d\u01b0\u1edbi c\u00f9ng c\u1ee7a ma tr\u1eadn con s\u1ed1 0 ti\u1ec1m n\u0103ng), ch\u00fang ta s\u1ebd coi <code>d[i][j]</code> l\u00e0 h\u00e0ng tr\u00ean c\u00f9ng c\u1ee7a ma tr\u1eadn con s\u1ed1 0 hi\u1ec7n t\u1ea1i. B\u00e2y gi\u1edd v\u1eabn c\u00f2n ph\u1ea3i x\u00e1c \u0111\u1ecbnh ranh gi\u1edbi b\u00ean tr\u00e1i v\u00e0 b\u00ean ph\u1ea3i t\u1ed1i \u01b0u c\u1ee7a ma tr\u1eadn con s\u1ed1 0, t\u1ee9c l\u00e0 \u0111\u1ea9y ma tr\u1eadn con n\u00e0y t\u1ed1i \u0111a sang b\u00ean tr\u00e1i v\u00e0 b\u00ean ph\u1ea3i c\u1ee7a c\u1ed9t th\u1ee9 <code>j</code>.</p> <p>\u0110\u1ea9y t\u1ed1i \u0111a sang b\u00ean tr\u00e1i ngh\u0129a l\u00e0 g\u00ec? C\u00f3 ngh\u0129a l\u00e0 t\u00ecm m\u1ed9t ch\u1ec9 s\u1ed1 <code>k1</code> m\u00e0 <code>d[i][k1] &gt; d[i][j]</code>, v\u00e0 \u0111\u1ed3ng th\u1eddi <code>k1</code> - ch\u1ec9 s\u1ed1 g\u1ea7n nh\u1ea5t b\u00ean tr\u00e1i ch\u1ec9 s\u1ed1 <code>j</code>. R\u00f5 r\u00e0ng l\u00e0 sau \u0111\u00f3 <code>k1 + 1</code> cho s\u1ed1 c\u1ee7a c\u1ed9t b\u00ean tr\u00e1i c\u1ee7a ma tr\u1eadn con s\u1ed1 0 c\u1ea7n t\u00ecm (gi\u1ea3 s\u1eed ch\u1ec9 s\u1ed1 c\u1ed9t b\u1eaft \u0111\u1ea7u t\u1eeb 0). N\u1ebfu ho\u00e0n to\u00e0n kh\u00f4ng c\u00f3 ch\u1ec9 s\u1ed1 nh\u01b0 v\u1eady, th\u00ec \u0111\u1eb7t <code>k1</code> = <code>-1</code> (\u0111i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 ch\u00fang ta c\u00f3 th\u1ec3 m\u1edf r\u1ed9ng ma tr\u1eadn con s\u1ed1 0 hi\u1ec7n t\u1ea1i sang b\u00ean tr\u00e1i cho \u0111\u1ebfn t\u1eadn bi\u00ean c\u1ee7a ma tr\u1eadn <code>a</code>).</p> <p>T\u01b0\u01a1ng t\u1ef1, b\u1ea1n c\u00f3 th\u1ec3 \u0111\u1ecbnh ngh\u0129a ch\u1ec9 s\u1ed1 <code>k2</code> cho bi\u00ean b\u00ean ph\u1ea3i: \u0111\u00e2y l\u00e0 ch\u1ec9 s\u1ed1 g\u1ea7n nh\u1ea5t b\u00ean ph\u1ea3i <code>j</code> sao cho <code>d[i][k2] &gt; d[i][j]</code> (ho\u1eb7c <code>m</code>, n\u1ebfu kh\u00f4ng c\u00f3 ch\u1ec9 s\u1ed1 nh\u01b0 v\u1eady).</p> <p>V\u00ec v\u1eady, c\u00e1c ch\u1ec9 s\u1ed1 <code>k1</code> v\u00e0 <code>k2</code>, n\u1ebfu ch\u00fang ta h\u1ecdc c\u00e1ch t\u00ecm ki\u1ebfm ch\u00fang m\u1ed9t c\u00e1ch hi\u1ec7u qu\u1ea3, s\u1ebd cung c\u1ea5p cho ch\u00fang ta t\u1ea5t c\u1ea3 th\u00f4ng tin c\u1ea7n thi\u1ebft v\u1ec1 ma tr\u1eadn con s\u1ed1 0 hi\u1ec7n t\u1ea1i. C\u1ee5 th\u1ec3, di\u1ec7n t\u00edch c\u1ee7a n\u00f3 s\u1ebd b\u1eb1ng <code>(i - d[i][j]) * (k2 - k1 - 1)</code>.</p> <p>L\u00e0m th\u1ebf n\u00e0o \u0111\u1ec3 t\u00ecm ki\u1ebfm c\u00e1c ch\u1ec9 s\u1ed1 <code>k1</code> v\u00e0 <code>k2</code> n\u00e0y m\u1ed9t c\u00e1ch hi\u1ec7u qu\u1ea3 v\u1edbi <code>i</code> v\u00e0 <code>j</code> c\u1ed1 \u0111\u1ecbnh? Ch\u00fang ta c\u00f3 th\u1ec3 l\u00e0m \u0111i\u1ec1u \u0111\u00f3 trung b\u00ecnh trong $O(1)$.</p> <p>\u0110\u1ec3 \u0111\u1ea1t \u0111\u01b0\u1ee3c \u0111\u1ed9 ph\u1ee9c t\u1ea1p nh\u01b0 v\u1eady, b\u1ea1n c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng ng\u0103n x\u1ebfp (stack) nh\u01b0 sau. Tr\u01b0\u1edbc ti\u00ean h\u00e3y t\u00ecm c\u00e1ch t\u00ecm ki\u1ebfm ch\u1ec9 s\u1ed1 <code>k1</code>, v\u00e0 l\u01b0u gi\u00e1 tr\u1ecb c\u1ee7a n\u00f3 cho m\u1ed7i ch\u1ec9 s\u1ed1 <code>j</code> trong h\u00e0ng hi\u1ec7n t\u1ea1i <code>i</code> v\u00e0o m\u1ea3ng <code>d1[j]</code>. \u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y, ch\u00fang ta s\u1ebd xem qua t\u1ea5t c\u1ea3 c\u00e1c c\u1ed9t <code>j</code> t\u1eeb tr\u00e1i sang ph\u1ea3i, v\u00e0 ch\u00fang ta s\u1ebd ch\u1ec9 l\u01b0u tr\u1eef trong ng\u0103n x\u1ebfp c\u00e1c c\u1ed9t c\u00f3 <code>d</code> th\u1ef1c s\u1ef1 l\u1edbn h\u01a1n <code>d[j]</code>. R\u00f5 r\u00e0ng l\u00e0 khi di chuy\u1ec3n t\u1eeb c\u1ed9t <code>j</code> sang c\u1ed9t ti\u1ebfp theo, c\u1ea7n ph\u1ea3i c\u1eadp nh\u1eadt n\u1ed9i dung c\u1ee7a ng\u0103n x\u1ebfp. Khi c\u00f3 m\u1ed9t ph\u1ea7n t\u1eed kh\u00f4ng ph\u00f9 h\u1ee3p \u1edf \u0111\u1ea7u ng\u0103n x\u1ebfp (t\u1ee9c l\u00e0 <code>d</code> c\u1ee7a \u0111\u1ec9nh stack <code>&lt;= d[j]</code>) h\u00e3y l\u1ea5y n\u00f3 ra (pop). D\u1ec5 hi\u1ec3u l\u00e0 ch\u1ec9 c\u1ea7n x\u00f3a kh\u1ecfi ng\u0103n x\u1ebfp t\u1eeb \u0111\u1ec9nh c\u1ee7a n\u00f3, v\u00e0 kh\u00f4ng ph\u1ea3i t\u1eeb b\u1ea5t k\u1ef3 n\u01a1i n\u00e0o kh\u00e1c (v\u00ec ng\u0103n x\u1ebfp s\u1ebd ch\u1ee9a m\u1ed9t d\u00e3y c\u00e1c c\u1ed9t c\u00f3 <code>d</code> t\u0103ng d\u1ea7n).</p> <p>Gi\u00e1 tr\u1ecb <code>d1[j]</code> cho m\u1ed7i <code>j</code> s\u1ebd b\u1eb1ng gi\u00e1 tr\u1ecb n\u1eb1m \u1edf th\u1eddi \u0111i\u1ec3m \u0111\u00f3 tr\u00ean \u0111\u1ec9nh c\u1ee7a ng\u0103n x\u1ebfp (n\u1ebfu ng\u0103n x\u1ebfp r\u1ed7ng th\u00ec l\u00e0 -1).</p> <p>\u0110\u1ed9ng l\u1ef1c <code>d2[j]</code> \u0111\u1ec3 t\u00ecm c\u00e1c ch\u1ec9 s\u1ed1 <code>k2</code> \u0111\u01b0\u1ee3c coi l\u00e0 t\u01b0\u01a1ng t\u1ef1, ch\u1ec9 c\u1ea7n b\u1ea1n xem c\u00e1c c\u1ed9t t\u1eeb ph\u1ea3i sang tr\u00e1i.</p> <p>R\u00f5 r\u00e0ng l\u00e0 v\u00ec c\u00f3 ch\u00ednh x\u00e1c <code>m</code> ph\u1ea7n t\u1eed \u0111\u01b0\u1ee3c th\u00eam v\u00e0o ng\u0103n x\u1ebfp tr\u00ean m\u1ed7i d\u00f2ng, n\u00ean c\u0169ng kh\u00f4ng th\u1ec3 c\u00f3 nhi\u1ec1u l\u1ea7n x\u00f3a h\u01a1n, t\u1ed5ng \u0111\u1ed9 ph\u1ee9c t\u1ea1p s\u1ebd l\u00e0 tuy\u1ebfn t\u00ednh, v\u00ec v\u1eady \u0111\u1ed9 ph\u1ee9c t\u1ea1p cu\u1ed1i c\u00f9ng c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 $O(nm)$.</p> <p>C\u0169ng c\u1ea7n l\u01b0u \u00fd r\u1eb1ng thu\u1eadt to\u00e1n n\u00e0y ti\u00eau th\u1ee5 b\u1ed9 nh\u1edb $O(m)$ (kh\u00f4ng t\u00ednh d\u1eef li\u1ec7u \u0111\u1ea7u v\u00e0o - ma tr\u1eadn <code>a[][]</code>).</p>","tags":["Translated"]},{"location":"dynamic_programming/zero_matrix.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<pre><code>int zero_matrix(vector&lt;vector&lt;int&gt;&gt; a) {\n    int n = a.size();\n    int m = a[0].size();\n\n    int ans = 0;\n    vector&lt;int&gt; d(m, -1), d1(m), d2(m);\n    stack&lt;int&gt; st;\n    for (int i = 0; i &lt; n; ++i) {\n        for (int j = 0; j &lt; m; ++j) {\n            if (a[i][j] == 1)\n                d[j] = i;\n        }\n\n        for (int j = 0; j &lt; m; ++j) {\n            while (!st.empty() &amp;&amp; d[st.top()] &lt;= d[j])\n                st.pop();\n            d1[j] = st.empty() ? -1 : st.top();\n            st.push(j);\n        }\n        while (!st.empty())\n            st.pop();\n\n        for (int j = m - 1; j &gt;= 0; --j) {\n            while (!st.empty() &amp;&amp; d[st.top()] &lt;= d[j])\n                st.pop();\n            d2[j] = st.empty() ? m : st.top();\n            st.push(j);\n        }\n        while (!st.empty())\n            st.pop();\n\n        for (int j = 0; j &lt; m; ++j)\n            ans = max(ans, (i - d[j]) * (d2[j] - d1[j] - 1));\n    }\n    return ans;\n}\n</code></pre>","tags":["Translated"]},{"location":"game_theory/games_on_graphs.html","title":"Tr\u00f2 ch\u01a1i tr\u00ean \u0111\u1ed3 th\u1ecb b\u1ea5t k\u1ef3 (Games on arbitrary graphs)","text":"<p>Gi\u1ea3 s\u1eed m\u1ed9t tr\u00f2 ch\u01a1i \u0111\u01b0\u1ee3c ch\u01a1i b\u1edfi hai ng\u01b0\u1eddi ch\u01a1i tr\u00ean m\u1ed9t \u0111\u1ed3 th\u1ecb b\u1ea5t k\u1ef3 $G$. T\u1ee9c l\u00e0 tr\u1ea1ng th\u00e1i hi\u1ec7n t\u1ea1i c\u1ee7a tr\u00f2 ch\u01a1i l\u00e0 m\u1ed9t \u0111\u1ec9nh nh\u1ea5t \u0111\u1ecbnh. C\u00e1c ng\u01b0\u1eddi ch\u01a1i th\u1ef1c hi\u1ec7n c\u00e1c n\u01b0\u1edbc \u0111i theo l\u01b0\u1ee3t, v\u00e0 di chuy\u1ec3n t\u1eeb \u0111\u1ec9nh hi\u1ec7n t\u1ea1i \u0111\u1ebfn m\u1ed9t \u0111\u1ec9nh k\u1ec1 b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng m\u1ed9t c\u1ea1nh n\u1ed1i. T\u00f9y thu\u1ed9c v\u00e0o tr\u00f2 ch\u01a1i, ng\u01b0\u1eddi kh\u00f4ng th\u1ec3 di chuy\u1ec3n s\u1ebd thua ho\u1eb7c th\u1eafng tr\u00f2 ch\u01a1i.</p> <p>Ch\u00fang ta xem x\u00e9t tr\u01b0\u1eddng h\u1ee3p t\u1ed5ng qu\u00e1t nh\u1ea5t, tr\u01b0\u1eddng h\u1ee3p c\u1ee7a m\u1ed9t \u0111\u1ed3 th\u1ecb c\u00f3 h\u01b0\u1edbng b\u1ea5t k\u1ef3 c\u00f3 chu tr\u00ecnh. Nhi\u1ec7m v\u1ee5 c\u1ee7a ch\u00fang ta l\u00e0 x\u00e1c \u0111\u1ecbnh, v\u1edbi m\u1ed9t tr\u1ea1ng th\u00e1i ban \u0111\u1ea7u, ai s\u1ebd th\u1eafng tr\u00f2 ch\u01a1i n\u1ebfu c\u1ea3 hai ng\u01b0\u1eddi ch\u01a1i ch\u01a1i v\u1edbi c\u00e1c chi\u1ebfn l\u01b0\u1ee3c t\u1ed1i \u01b0u ho\u1eb7c x\u00e1c \u0111\u1ecbnh r\u1eb1ng k\u1ebft qu\u1ea3 c\u1ee7a tr\u00f2 ch\u01a1i s\u1ebd l\u00e0 h\u00f2a.</p> <p>Ch\u00fang ta s\u1ebd gi\u1ea3i quy\u1ebft b\u00e0i to\u00e1n n\u00e0y r\u1ea5t hi\u1ec7u qu\u1ea3. Ch\u00fang ta s\u1ebd t\u00ecm gi\u1ea3i ph\u00e1p cho t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh b\u1eaft \u0111\u1ea7u c\u00f3 th\u1ec3 c\u00f3 c\u1ee7a \u0111\u1ed3 th\u1ecb trong th\u1eddi gian tuy\u1ebfn t\u00ednh \u0111\u1ed1i v\u1edbi s\u1ed1 l\u01b0\u1ee3ng c\u1ea1nh: $O(m)$.</p>","tags":["Translated"]},{"location":"game_theory/games_on_graphs.html#description-of-the-algorithm","title":"M\u00f4 t\u1ea3 thu\u1eadt to\u00e1n (Description of the algorithm)","text":"<p>Ch\u00fang ta s\u1ebd g\u1ecdi m\u1ed9t \u0111\u1ec9nh l\u00e0 \u0111\u1ec9nh th\u1eafng (winning vertex), n\u1ebfu ng\u01b0\u1eddi ch\u01a1i b\u1eaft \u0111\u1ea7u t\u1ea1i tr\u1ea1ng th\u00e1i n\u00e0y s\u1ebd th\u1eafng tr\u00f2 ch\u01a1i, n\u1ebfu h\u1ecd ch\u01a1i t\u1ed1i \u01b0u (b\u1ea5t k\u1ec3 ng\u01b0\u1eddi ch\u01a1i kia th\u1ef1c hi\u1ec7n c\u00e1c l\u01b0\u1ee3t \u0111i n\u00e0o). T\u01b0\u01a1ng t\u1ef1, ch\u00fang ta s\u1ebd g\u1ecdi m\u1ed9t \u0111\u1ec9nh l\u00e0 \u0111\u1ec9nh thua (losing vertex), n\u1ebfu ng\u01b0\u1eddi ch\u01a1i b\u1eaft \u0111\u1ea7u t\u1ea1i \u0111\u1ec9nh n\u00e0y s\u1ebd thua tr\u00f2 ch\u01a1i, n\u1ebfu \u0111\u1ed1i th\u1ee7 ch\u01a1i t\u1ed1i \u01b0u.</p> <p>\u0110\u1ed1i v\u1edbi m\u1ed9t s\u1ed1 \u0111\u1ec9nh c\u1ee7a \u0111\u1ed3 th\u1ecb, ch\u00fang ta \u0111\u00e3 bi\u1ebft tr\u01b0\u1edbc r\u1eb1ng ch\u00fang l\u00e0 \u0111\u1ec9nh th\u1eafng hay thua: c\u1ee5 th\u1ec3 l\u00e0 t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh kh\u00f4ng c\u00f3 c\u1ea1nh ra.</p> <p>Ngo\u00e0i ra ch\u00fang ta c\u00f3 c\u00e1c quy t\u1eafc sau:</p> <ul> <li>n\u1ebfu m\u1ed9t \u0111\u1ec9nh c\u00f3 m\u1ed9t c\u1ea1nh ra d\u1eabn \u0111\u1ebfn m\u1ed9t \u0111\u1ec9nh thua, th\u00ec ch\u00ednh \u0111\u1ec9nh \u0111\u00f3 l\u00e0 m\u1ed9t \u0111\u1ec9nh th\u1eafng.</li> <li>n\u1ebfu t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh ra c\u1ee7a m\u1ed9t \u0111\u1ec9nh nh\u1ea5t \u0111\u1ecbnh d\u1eabn \u0111\u1ebfn c\u00e1c \u0111\u1ec9nh th\u1eafng, th\u00ec ch\u00ednh \u0111\u1ec9nh \u0111\u00f3 l\u00e0 m\u1ed9t \u0111\u1ec9nh thua.</li> <li>n\u1ebfu t\u1ea1i m\u1ed9t th\u1eddi \u0111i\u1ec3m n\u00e0o \u0111\u00f3 v\u1eabn c\u00f2n c\u00e1c \u0111\u1ec9nh ch\u01b0a x\u00e1c \u0111\u1ecbnh, v\u00e0 kh\u00f4ng \u0111\u1ec9nh n\u00e0o ph\u00f9 h\u1ee3p v\u1edbi quy t\u1eafc th\u1ee9 nh\u1ea5t ho\u1eb7c th\u1ee9 hai, th\u00ec m\u1ed7i \u0111\u1ec9nh n\u00e0y, khi \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng l\u00e0m \u0111\u1ec9nh b\u1eaft \u0111\u1ea7u, s\u1ebd d\u1eabn \u0111\u1ebfn k\u1ebft qu\u1ea3 h\u00f2a n\u1ebfu c\u1ea3 hai ng\u01b0\u1eddi ch\u01a1i ch\u01a1i t\u1ed1i \u01b0u.</li> </ul> <p>Do \u0111\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 \u0111\u1ecbnh ngh\u0129a m\u1ed9t thu\u1eadt to\u00e1n ch\u1ea1y trong th\u1eddi gian $O(n m)$ ngay l\u1eadp t\u1ee9c. Ch\u00fang ta \u0111i qua t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh v\u00e0 c\u1ed1 g\u1eafng \u00e1p d\u1ee5ng quy t\u1eafc th\u1ee9 nh\u1ea5t ho\u1eb7c th\u1ee9 hai, v\u00e0 l\u1eb7p l\u1ea1i.</p> <p>Tuy nhi\u00ean, ch\u00fang ta c\u00f3 th\u1ec3 t\u0103ng t\u1ed1c quy tr\u00ecnh n\u00e0y, v\u00e0 gi\u1ea3m \u0111\u1ed9 ph\u1ee9c t\u1ea1p xu\u1ed1ng $O(m)$.</p> <p>Ch\u00fang ta s\u1ebd \u0111i qua t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh, m\u00e0 ch\u00fang ta ban \u0111\u1ea7u bi\u1ebft n\u1ebfu ch\u00fang l\u00e0 tr\u1ea1ng th\u00e1i th\u1eafng ho\u1eb7c thua. \u0110\u1ed1i v\u1edbi m\u1ed7i \u0111\u1ec9nh trong s\u1ed1 ch\u00fang, ch\u00fang ta b\u1eaft \u0111\u1ea7u m\u1ed9t t\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u (DFS). DFS n\u00e0y s\u1ebd di chuy\u1ec3n ng\u01b0\u1ee3c l\u1ea1i qua c\u00e1c c\u1ea1nh \u0111\u1ea3o ng\u01b0\u1ee3c (reversed edges). Tr\u01b0\u1edbc h\u1ebft, n\u00f3 s\u1ebd kh\u00f4ng \u0111i v\u00e0o c\u00e1c \u0111\u1ec9nh \u0111\u00e3 \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh l\u00e0 \u0111\u1ec9nh th\u1eafng ho\u1eb7c thua. V\u00e0 xa h\u01a1n n\u1eefa, n\u1ebfu t\u00ecm ki\u1ebfm \u0111i t\u1eeb m\u1ed9t \u0111\u1ec9nh thua \u0111\u1ebfn m\u1ed9t \u0111\u1ec9nh ch\u01b0a x\u00e1c \u0111\u1ecbnh, th\u00ec ch\u00fang ta \u0111\u00e1nh d\u1ea5u \u0111\u1ec9nh n\u00e0y l\u00e0 m\u1ed9t \u0111\u1ec9nh th\u1eafng, v\u00e0 ti\u1ebfp t\u1ee5c DFS s\u1eed d\u1ee5ng \u0111\u1ec9nh m\u1edbi n\u00e0y. N\u1ebfu ch\u00fang ta \u0111i t\u1eeb m\u1ed9t \u0111\u1ec9nh th\u1eafng \u0111\u1ebfn m\u1ed9t \u0111\u1ec9nh ch\u01b0a x\u00e1c \u0111\u1ecbnh, th\u00ec ch\u00fang ta ph\u1ea3i ki\u1ec3m tra xem t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh t\u1eeb \u0111\u1ec9nh n\u00e0y c\u00f3 d\u1eabn \u0111\u1ebfn c\u00e1c \u0111\u1ec9nh th\u1eafng hay kh\u00f4ng. Ch\u00fang ta c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n ki\u1ec3m tra n\u00e0y trong $O(1)$ b\u1eb1ng c\u00e1ch l\u01b0u tr\u1eef s\u1ed1 l\u01b0\u1ee3ng c\u1ea1nh d\u1eabn \u0111\u1ebfn m\u1ed9t \u0111\u1ec9nh th\u1eafng cho m\u1ed7i \u0111\u1ec9nh. V\u00ec v\u1eady, n\u1ebfu ch\u00fang ta \u0111i t\u1eeb m\u1ed9t \u0111\u1ec9nh th\u1eafng \u0111\u1ebfn m\u1ed9t \u0111\u1ec9nh ch\u01b0a x\u00e1c \u0111\u1ecbnh, th\u00ec ch\u00fang ta t\u0103ng b\u1ed9 \u0111\u1ebfm, v\u00e0 ki\u1ec3m tra xem s\u1ed1 n\u00e0y c\u00f3 b\u1eb1ng s\u1ed1 l\u01b0\u1ee3ng c\u1ea1nh ra hay kh\u00f4ng. N\u1ebfu \u0111\u00fang nh\u01b0 v\u1eady, ch\u00fang ta c\u00f3 th\u1ec3 \u0111\u00e1nh d\u1ea5u \u0111\u1ec9nh n\u00e0y l\u00e0 m\u1ed9t \u0111\u1ec9nh thua, v\u00e0 ti\u1ebfp t\u1ee5c DFS t\u1eeb \u0111\u1ec9nh n\u00e0y. Ng\u01b0\u1ee3c l\u1ea1i, ch\u00fang ta ch\u01b0a bi\u1ebft li\u1ec7u \u0111\u1ec9nh n\u00e0y l\u00e0 \u0111\u1ec9nh th\u1eafng hay thua, v\u00e0 do \u0111\u00f3 kh\u00f4ng c\u00f3 \u00fd ngh\u0129a g\u00ec khi ti\u1ebfp t\u1ee5c DFS s\u1eed d\u1ee5ng n\u00f3.</p> <p>T\u1ed5ng c\u1ed9ng ch\u00fang ta th\u0103m m\u1ecdi \u0111\u1ec9nh th\u1eafng v\u00e0 m\u1ecdi \u0111\u1ec9nh thua ch\u00ednh x\u00e1c m\u1ed9t l\u1ea7n (c\u00e1c \u0111\u1ec9nh ch\u01b0a x\u00e1c \u0111\u1ecbnh kh\u00f4ng \u0111\u01b0\u1ee3c th\u0103m), v\u00e0 ch\u00fang ta c\u0169ng \u0111i qua m\u1ed7i c\u1ea1nh t\u1ed1i \u0111a m\u1ed9t l\u1ea7n. Do \u0111\u00f3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p l\u00e0 $O(m)$.</p>","tags":["Translated"]},{"location":"game_theory/games_on_graphs.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 vi\u1ec7c c\u00e0i \u0111\u1eb7t c\u1ee7a m\u1ed9t DFS nh\u01b0 v\u1eady. Ch\u00fang ta gi\u1ea3 s\u1eed r\u1eb1ng bi\u1ebfn <code>adj_rev</code> l\u01b0u tr\u1eef danh s\u00e1ch k\u1ec1 cho \u0111\u1ed3 th\u1ecb \u1edf d\u1ea1ng \u0111\u1ea3o ng\u01b0\u1ee3c, t\u1ee9c l\u00e0 thay v\u00ec l\u01b0u tr\u1eef c\u1ea1nh $(i, j)$ c\u1ee7a \u0111\u1ed3 th\u1ecb, ch\u00fang ta l\u01b0u tr\u1eef $(j, i)$. Ngo\u00e0i ra \u0111\u1ed1i v\u1edbi m\u1ed7i \u0111\u1ec9nh, ch\u00fang ta gi\u1ea3 s\u1eed r\u1eb1ng b\u1eadc ra (outgoing degree) \u0111\u00e3 \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n.</p> <pre><code>vector&lt;vector&lt;int&gt;&gt; adj_rev;\n\nvector&lt;bool&gt; winning;\nvector&lt;bool&gt; losing;\nvector&lt;bool&gt; visited;\nvector&lt;int&gt; degree;\n\nvoid dfs(int v) {\n    visited[v] = true;\n    for (int u : adj_rev[v]) {\n        if (!visited[u]) {\n            if (losing[v])\n                winning[u] = true;\n            else if (--degree[u] == 0)\n                losing[u] = true;\n            else\n                continue;\n            dfs(u);\n        }\n    }\n}\n</code></pre>","tags":["Translated"]},{"location":"game_theory/games_on_graphs.html#example-policeman-and-thief","title":"V\u00ed d\u1ee5: \"C\u1ea3nh s\u00e1t v\u00e0 t\u00ean tr\u1ed9m\" (Example: \"Policeman and thief\")","text":"<p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u1ed9t v\u00ed d\u1ee5 c\u1ee5 th\u1ec3 v\u1ec1 m\u1ed9t tr\u00f2 ch\u01a1i nh\u01b0 v\u1eady.</p> <p>C\u00f3 b\u1ea3ng $m \\times n$. M\u1ed9t s\u1ed1 \u00f4 kh\u00f4ng th\u1ec3 \u0111i v\u00e0o. T\u1ecda \u0111\u1ed9 ban \u0111\u1ea7u c\u1ee7a c\u1ea3nh s\u00e1t v\u00e0 t\u00ean tr\u1ed9m \u0111\u01b0\u1ee3c bi\u1ebft. M\u1ed9t trong c\u00e1c \u00f4 l\u00e0 l\u1ed1i ra. N\u1ebfu c\u1ea3nh s\u00e1t v\u00e0 t\u00ean tr\u1ed9m \u1edf c\u00f9ng m\u1ed9t \u00f4 t\u1ea1i b\u1ea5t k\u1ef3 th\u1eddi \u0111i\u1ec3m n\u00e0o, c\u1ea3nh s\u00e1t th\u1eafng. N\u1ebfu t\u00ean tr\u1ed9m \u1edf \u00f4 l\u1ed1i ra (m\u00e0 kh\u00f4ng c\u00f3 c\u1ea3nh s\u00e1t c\u0169ng \u1edf tr\u00ean \u00f4 \u0111\u00f3), th\u00ec t\u00ean tr\u1ed9m th\u1eafng. C\u1ea3nh s\u00e1t c\u00f3 th\u1ec3 \u0111i b\u1ed9 theo t\u1ea5t c\u1ea3 8 h\u01b0\u1edbng, t\u00ean tr\u1ed9m ch\u1ec9 theo 4 h\u01b0\u1edbng (theo tr\u1ee5c t\u1ecda \u0111\u1ed9). C\u1ea3 c\u1ea3nh s\u00e1t v\u00e0 t\u00ean tr\u1ed9m s\u1ebd l\u1ea7n l\u01b0\u1ee3t di chuy\u1ec3n. Tuy nhi\u00ean h\u1ecd c\u0169ng c\u00f3 th\u1ec3 b\u1ecf qua m\u1ed9t l\u01b0\u1ee3t n\u1ebfu h\u1ecd mu\u1ed1n. N\u01b0\u1edbc \u0111i \u0111\u1ea7u ti\u00ean \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n b\u1edfi c\u1ea3nh s\u00e1t.</p> <p>B\u00e2y gi\u1edd ch\u00fang ta s\u1ebd x\u00e2y d\u1ef1ng \u0111\u1ed3 th\u1ecb. \u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y ch\u00fang ta ph\u1ea3i ch\u00ednh th\u1ee9c h\u00f3a c\u00e1c quy t\u1eafc c\u1ee7a tr\u00f2 ch\u01a1i. Tr\u1ea1ng th\u00e1i hi\u1ec7n t\u1ea1i c\u1ee7a tr\u00f2 ch\u01a1i \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh b\u1edfi t\u1ecda \u0111\u1ed9 c\u1ee7a c\u1ea3nh s\u00e1t $P$, t\u1ecda \u0111\u1ed9 c\u1ee7a t\u00ean tr\u1ed9m $T$, v\u00e0 c\u0169ng b\u1edfi l\u01b0\u1ee3t c\u1ee7a ai, h\u00e3y g\u1ecdi bi\u1ebfn n\u00e0y l\u00e0 $P_{\\text{turn}}$ (l\u00e0 true khi \u0111\u1ebfn l\u01b0\u1ee3t c\u1ee7a c\u1ea3nh s\u00e1t). Do \u0111\u00f3, m\u1ed9t \u0111\u1ec9nh c\u1ee7a \u0111\u1ed3 th\u1ecb \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh b\u1edfi b\u1ed9 ba $(P, T, P_{\\text{turn}})$ Sau \u0111\u00f3, \u0111\u1ed3 th\u1ecb c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c x\u00e2y d\u1ef1ng d\u1ec5 d\u00e0ng, \u0111\u01a1n gi\u1ea3n b\u1eb1ng c\u00e1ch tu\u00e2n theo c\u00e1c quy t\u1eafc c\u1ee7a tr\u00f2 ch\u01a1i.</p> <p>Ti\u1ebfp theo, ch\u00fang ta c\u1ea7n x\u00e1c \u0111\u1ecbnh \u0111\u1ec9nh n\u00e0o l\u00e0 th\u1eafng v\u00e0 \u0111\u1ec9nh n\u00e0o l\u00e0 thua ban \u0111\u1ea7u. C\u00f3 m\u1ed9t \u0111i\u1ec3m tinh t\u1ebf \u1edf \u0111\u00e2y. C\u00e1c \u0111\u1ec9nh th\u1eafng / thua ph\u1ee5 thu\u1ed9c, ngo\u00e0i t\u1ecda \u0111\u1ed9, c\u00f2n v\u00e0o $P_{\\text{turn}}$ - l\u01b0\u1ee3t c\u1ee7a ai. N\u1ebfu \u0111\u1ebfn l\u01b0\u1ee3t c\u1ee7a c\u1ea3nh s\u00e1t, th\u00ec \u0111\u1ec9nh l\u00e0 \u0111\u1ec9nh th\u1eafng, n\u1ebfu t\u1ecda \u0111\u1ed9 c\u1ee7a c\u1ea3nh s\u00e1t v\u00e0 t\u00ean tr\u1ed9m tr\u00f9ng nhau, v\u00e0 \u0111\u1ec9nh l\u00e0 \u0111\u1ec9nh thua n\u1ebfu n\u00f3 kh\u00f4ng ph\u1ea3i l\u00e0 \u0111\u1ec9nh th\u1eafng v\u00e0 t\u00ean tr\u1ed9m \u0111ang \u1edf l\u1ed1i ra. N\u1ebfu \u0111\u1ebfn l\u01b0\u1ee3t c\u1ee7a t\u00ean tr\u1ed9m, th\u00ec m\u1ed9t \u0111\u1ec9nh l\u00e0 \u0111\u1ec9nh thua, n\u1ebfu t\u1ecda \u0111\u1ed9 c\u1ee7a hai ng\u01b0\u1eddi ch\u01a1i tr\u00f9ng nhau, v\u00e0 n\u00f3 l\u00e0 \u0111\u1ec9nh th\u1eafng n\u1ebfu n\u00f3 kh\u00f4ng ph\u1ea3i l\u00e0 \u0111\u1ec9nh thua, v\u00e0 t\u00ean tr\u1ed9m \u0111ang \u1edf l\u1ed1i ra.</p> <p>\u0110i\u1ec3m duy nh\u1ea5t tr\u01b0\u1edbc khi c\u00e0i \u0111\u1eb7t l\u00e0 b\u1ea1n c\u1ea7n quy\u1ebft \u0111\u1ecbnh xem b\u1ea1n mu\u1ed1n x\u00e2y d\u1ef1ng \u0111\u1ed3 th\u1ecb m\u1ed9t c\u00e1ch t\u01b0\u1eddng minh hay ch\u1ec9 x\u00e2y d\u1ef1ng n\u00f3 ngay trong qu\u00e1 tr\u00ecnh ch\u1ea1y (on the fly). M\u1ed9t m\u1eb7t, vi\u1ec7c x\u00e2y d\u1ef1ng \u0111\u1ed3 th\u1ecb m\u1ed9t c\u00e1ch t\u01b0\u1eddng minh s\u1ebd d\u1ec5 d\u00e0ng h\u01a1n nhi\u1ec1u v\u00e0 \u00edt c\u00f3 kh\u1ea3 n\u0103ng m\u1eafc l\u1ed7i h\u01a1n. M\u1eb7t kh\u00e1c, n\u00f3 s\u1ebd l\u00e0m t\u0103ng l\u01b0\u1ee3ng m\u00e3 v\u00e0 th\u1eddi gian ch\u1ea1y s\u1ebd ch\u1eadm h\u01a1n so v\u1edbi khi b\u1ea1n x\u00e2y d\u1ef1ng \u0111\u1ed3 th\u1ecb ngay trong qu\u00e1 tr\u00ecnh ch\u1ea1y.</p> <p>Vi\u1ec7c c\u00e0i \u0111\u1eb7t sau \u0111\u00e2y s\u1ebd x\u00e2y d\u1ef1ng \u0111\u1ed3 th\u1ecb m\u1ed9t c\u00e1ch t\u01b0\u1eddng minh:</p> <pre><code>struct State {\n    int P, T;\n    bool Pstep;\n};\n\nvector&lt;State&gt; adj_rev[100][100][2]; // [P][T][Pstep]\nbool winning[100][100][2];\nbool losing[100][100][2];\nbool visited[100][100][2];\nint degree[100][100][2];\n\nvoid dfs(State v) {\n    visited[v.P][v.T][v.Pstep] = true;\n    for (State u : adj_rev[v.P][v.T][v.Pstep]) {\n        if (!visited[u.P][u.T][u.Pstep]) {\n            if (losing[v.P][v.T][v.Pstep])\n                winning[u.P][u.T][u.Pstep] = true;\n            else if (--degree[u.P][u.T][u.Pstep] == 0)\n                losing[u.P][u.T][u.Pstep] = true;\n            else\n                continue;\n            dfs(u);\n        }\n    }\n}\n\nint main() {\n    int n, m;\n    cin &gt;&gt; n &gt;&gt; m;\n    vector&lt;string&gt; a(n);\n    for (int i = 0; i &lt; n; i++)\n        cin &gt;&gt; a[i];\n\n    for (int P = 0; P &lt; n*m; P++) {\n        for (int T = 0; T &lt; n*m; T++) {\n            for (int Pstep = 0; Pstep &lt;= 1; Pstep++) {\n                int Px = P/m, Py = P%m, Tx = T/m, Ty = T%m;\n                if (a[Px][Py]=='*' || a[Tx][Ty]=='*')\n                    continue;\n\n                bool&amp; win = winning[P][T][Pstep];\n                bool&amp; lose = losing[P][T][Pstep];\n                if (Pstep) {\n                    win = Px==Tx &amp;&amp; Py==Ty;\n                    lose = !win &amp;&amp; a[Tx][Ty] == 'E';\n                } else {\n                    lose = Px==Tx &amp;&amp; Py==Ty;\n                    win = !lose &amp;&amp; a[Tx][Ty] == 'E';\n                }\n                if (win || lose)\n                    continue;\n\n                State st = {P,T,!Pstep};\n                adj_rev[P][T][Pstep].push_back(st);\n                st.Pstep = Pstep;\n                degree[P][T][Pstep]++;\n\n                const int dx[] = {-1, 0, 1, 0, -1, -1, 1, 1};\n                const int dy[] = {0, 1, 0, -1, -1, 1, -1, 1};\n                for (int d = 0; d &lt; (Pstep ? 8 : 4); d++) {\n                    int PPx = Px, PPy = Py, TTx = Tx, TTy = Ty;\n                    if (Pstep) {\n                        PPx += dx[d];\n                        PPy += dy[d];\n                    } else {\n                        TTx += dx[d];\n                        TTy += dy[d];\n                    }\n\n                    if (PPx &gt;= 0 &amp;&amp; PPx &lt; n &amp;&amp; PPy &gt;= 0 &amp;&amp; PPy &lt; m &amp;&amp; a[PPx][PPy] != '*' &amp;&amp;\n                        TTx &gt;= 0 &amp;&amp; TTx &lt; n &amp;&amp; TTy &gt;= 0 &amp;&amp; TTy &lt; m &amp;&amp; a[TTx][TTy] != '*')\n                    {\n                        adj_rev[PPx*m+PPy][TTx*m+TTy][!Pstep].push_back(st);\n                        ++degree[P][T][Pstep];\n                    }\n                }\n            }\n        }\n    }\n\n    for (int P = 0; P &lt; n*m; P++) {\n        for (int T = 0; T &lt; n*m; T++) {\n            for (int Pstep = 0; Pstep &lt;= 1; Pstep++) {\n                if ((winning[P][T][Pstep] || losing[P][T][Pstep]) &amp;&amp; !visited[P][T][Pstep])\n                    dfs({P, T, (bool)Pstep});\n            }\n        }\n    }\n\n    int P_st, T_st;\n    for (int i = 0; i &lt; n; i++) {\n        for (int j = 0; j &lt; m; j++) {\n            if (a[i][j] == 'P')\n                P_st = i*m+j;\n            else if (a[i][j] == 'T')\n                T_st = i*m+j;\n        }\n    }\n\n    if (winning[P_st][T_st][true]) {\n        cout &lt;&lt; \"Police catches the thief\"  &lt;&lt; endl;\n    } else if (losing[P_st][T_st][true]) {\n        cout &lt;&lt; \"The thief escapes\" &lt;&lt; endl;\n    } else {\n        cout &lt;&lt; \"Draw\" &lt;&lt; endl;\n    }\n}\n</code></pre>","tags":["Translated"]},{"location":"game_theory/sprague-grundy-nim.html","title":"\u0110\u1ecbnh l\u00fd Sprague-Grundy. Nim (Sprague-Grundy theorem. Nim)","text":"","tags":["Translated"]},{"location":"game_theory/sprague-grundy-nim.html#introduction","title":"Gi\u1edbi thi\u1ec7u (Introduction)","text":"<p>\u0110\u1ecbnh l\u00fd n\u00e0y m\u00f4 t\u1ea3 c\u00e1i g\u1ecdi l\u00e0 tr\u00f2 ch\u01a1i hai ng\u01b0\u1eddi ch\u01a1i c\u00f4ng b\u1eb1ng (impartial game), t\u1ee9c l\u00e0 nh\u1eefng tr\u00f2 ch\u01a1i m\u00e0 c\u00e1c n\u01b0\u1edbc \u0111i c\u00f3 s\u1eb5n v\u00e0 vi\u1ec7c th\u1eafng/thua ch\u1ec9 ph\u1ee5 thu\u1ed9c v\u00e0o tr\u1ea1ng th\u00e1i c\u1ee7a tr\u00f2 ch\u01a1i. N\u00f3i c\u00e1ch kh\u00e1c, s\u1ef1 kh\u00e1c bi\u1ec7t duy nh\u1ea5t gi\u1eefa hai ng\u01b0\u1eddi ch\u01a1i l\u00e0 m\u1ed9t trong hai ng\u01b0\u1eddi \u0111i tr\u01b0\u1edbc.</p> <p>Ngo\u00e0i ra, ch\u00fang ta gi\u1ea3 s\u1eed r\u1eb1ng tr\u00f2 ch\u01a1i c\u00f3 th\u00f4ng tin ho\u00e0n h\u1ea3o (perfect information), t\u1ee9c l\u00e0 kh\u00f4ng c\u00f3 th\u00f4ng tin n\u00e0o b\u1ecb \u1ea9n kh\u1ecfi ng\u01b0\u1eddi ch\u01a1i (h\u1ecd bi\u1ebft lu\u1eadt ch\u01a1i v\u00e0 c\u00e1c n\u01b0\u1edbc \u0111i c\u00f3 th\u1ec3).</p> <p>Ng\u01b0\u1eddi ta gi\u1ea3 \u0111\u1ecbnh r\u1eb1ng tr\u00f2 ch\u01a1i l\u00e0 h\u1eefu h\u1ea1n (finite), t\u1ee9c l\u00e0 sau m\u1ed9t s\u1ed1 l\u01b0\u1ee3ng n\u01b0\u1edbc \u0111i nh\u1ea5t \u0111\u1ecbnh, m\u1ed9t trong hai ng\u01b0\u1eddi ch\u01a1i s\u1ebd r\u01a1i v\u00e0o v\u1ecb tr\u00ed thua \u2014 t\u1eeb \u0111\u00f3 h\u1ecd kh\u00f4ng th\u1ec3 di chuy\u1ec3n \u0111\u1ebfn v\u1ecb tr\u00ed kh\u00e1c. M\u1eb7t kh\u00e1c, ng\u01b0\u1eddi ch\u01a1i \u0111\u00e3 thi\u1ebft l\u1eadp v\u1ecb tr\u00ed n\u00e0y cho \u0111\u1ed1i th\u1ee7 s\u1ebd th\u1eafng. D\u1ec5 hi\u1ec3u l\u00e0 kh\u00f4ng c\u00f3 k\u1ebft qu\u1ea3 h\u00f2a trong tr\u00f2 ch\u01a1i n\u00e0y.</p> <p>Tr\u00f2 ch\u01a1i nh\u01b0 v\u1eady c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 ho\u00e0n to\u00e0n b\u1eb1ng m\u1ed9t \u0111\u1ed3 th\u1ecb c\u00f3 h\u01b0\u1edbng kh\u00f4ng chu tr\u00ecnh (DAG): c\u00e1c \u0111\u1ec9nh l\u00e0 tr\u1ea1ng th\u00e1i tr\u00f2 ch\u01a1i v\u00e0 c\u00e1c c\u1ea1nh l\u00e0 c\u00e1c chuy\u1ec3n \u0111\u1ed5i (n\u01b0\u1edbc \u0111i). M\u1ed9t \u0111\u1ec9nh kh\u00f4ng c\u00f3 c\u1ea1nh ra l\u00e0 m\u1ed9t \u0111\u1ec9nh thua (ng\u01b0\u1eddi ch\u01a1i ph\u1ea3i th\u1ef1c hi\u1ec7n n\u01b0\u1edbc \u0111i t\u1eeb \u0111\u1ec9nh n\u00e0y s\u1ebd thua).</p> <p>V\u00ec kh\u00f4ng c\u00f3 k\u1ebft qu\u1ea3 h\u00f2a, ch\u00fang ta c\u00f3 th\u1ec3 ph\u00e2n lo\u1ea1i t\u1ea5t c\u1ea3 c\u00e1c tr\u1ea1ng th\u00e1i tr\u00f2 ch\u01a1i l\u00e0 th\u1eafng ho\u1eb7c thua. Tr\u1ea1ng th\u00e1i th\u1eafng l\u00e0 nh\u1eefng tr\u1ea1ng th\u00e1i m\u00e0 t\u1eeb \u0111\u00f3 c\u00f3 m\u1ed9t n\u01b0\u1edbc \u0111i g\u00e2y ra th\u1ea5t b\u1ea1i kh\u00f4ng th\u1ec3 tr\u00e1nh kh\u1ecfi cho \u0111\u1ed1i th\u1ee7, ngay c\u1ea3 khi h\u1ecd ph\u1ea3n \u1ee9ng t\u1ed1t nh\u1ea5t. Tr\u1ea1ng th\u00e1i thua l\u00e0 nh\u1eefng tr\u1ea1ng th\u00e1i m\u00e0 t\u1eeb \u0111\u00f3 m\u1ecdi n\u01b0\u1edbc \u0111i \u0111\u1ec1u d\u1eabn \u0111\u1ebfn tr\u1ea1ng th\u00e1i th\u1eafng cho \u0111\u1ed1i th\u1ee7. T\u00f3m l\u1ea1i, m\u1ed9t tr\u1ea1ng th\u00e1i l\u00e0 th\u1eafng n\u1ebfu c\u00f3 \u00edt nh\u1ea5t m\u1ed9t chuy\u1ec3n \u0111\u1ed5i \u0111\u1ebfn tr\u1ea1ng th\u00e1i thua v\u00e0 l\u00e0 thua n\u1ebfu kh\u00f4ng c\u00f3 \u00edt nh\u1ea5t m\u1ed9t chuy\u1ec3n \u0111\u1ed5i \u0111\u1ebfn tr\u1ea1ng th\u00e1i thua.</p> <p>Nhi\u1ec7m v\u1ee5 c\u1ee7a ch\u00fang ta l\u00e0 ph\u00e2n lo\u1ea1i c\u00e1c tr\u1ea1ng th\u00e1i c\u1ee7a m\u1ed9t tr\u00f2 ch\u01a1i nh\u1ea5t \u0111\u1ecbnh.</p> <p>L\u00fd thuy\u1ebft v\u1ec1 c\u00e1c tr\u00f2 ch\u01a1i nh\u01b0 v\u1eady \u0111\u01b0\u1ee3c ph\u00e1t tri\u1ec3n \u0111\u1ed9c l\u1eadp b\u1edfi Roland Sprague v\u00e0o n\u0103m 1935 v\u00e0 Patrick Michael Grundy v\u00e0o n\u0103m 1939.</p>","tags":["Translated"]},{"location":"game_theory/sprague-grundy-nim.html#nim","title":"Nim","text":"<p>Tr\u00f2 ch\u01a1i n\u00e0y tu\u00e2n theo c\u00e1c h\u1ea1n ch\u1ebf \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 \u1edf tr\u00ean. H\u01a1n n\u1eefa, b\u1ea5t k\u1ef3 tr\u00f2 ch\u01a1i hai ng\u01b0\u1eddi ch\u01a1i c\u00f4ng b\u1eb1ng c\u00f3 th\u00f4ng tin ho\u00e0n h\u1ea3o n\u00e0o c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c quy v\u1ec1 tr\u00f2 ch\u01a1i Nim. Nghi\u00ean c\u1ee9u tr\u00f2 ch\u01a1i n\u00e0y s\u1ebd cho ph\u00e9p ch\u00fang ta gi\u1ea3i quy\u1ebft t\u1ea5t c\u1ea3 c\u00e1c tr\u00f2 ch\u01a1i t\u01b0\u01a1ng t\u1ef1 kh\u00e1c, nh\u01b0ng s\u1ebd n\u00f3i th\u00eam v\u1ec1 \u0111i\u1ec1u \u0111\u00f3 sau.</p> <p>V\u1ec1 m\u1eb7t l\u1ecbch s\u1eed, tr\u00f2 ch\u01a1i n\u00e0y ph\u1ed5 bi\u1ebfn t\u1eeb th\u1eddi c\u1ed5 \u0111\u1ea1i. Ngu\u1ed3n g\u1ed1c c\u1ee7a n\u00f3 c\u00f3 l\u1ebd l\u00e0 \u1edf Trung Qu\u1ed1c \u2014 ho\u1eb7c \u00edt nh\u1ea5t l\u00e0 tr\u00f2 ch\u01a1i Jianshizi r\u1ea5t gi\u1ed1ng v\u1edbi n\u00f3. \u1ede ch\u00e2u \u00c2u, c\u00e1c t\u00e0i li\u1ec7u tham kh\u1ea3o s\u1edbm nh\u1ea5t v\u1ec1 n\u00f3 l\u00e0 t\u1eeb th\u1ebf k\u1ef7 16. C\u00e1i t\u00ean n\u00e0y \u0111\u01b0\u1ee3c \u0111\u1eb7t b\u1edfi Charles Bouton, ng\u01b0\u1eddi v\u00e0o n\u0103m 1901 \u0111\u00e3 c\u00f4ng b\u1ed1 m\u1ed9t ph\u00e2n t\u00edch \u0111\u1ea7y \u0111\u1ee7 v\u1ec1 tr\u00f2 ch\u01a1i n\u00e0y.</p>","tags":["Translated"]},{"location":"game_theory/sprague-grundy-nim.html#game-description","title":"M\u00f4 t\u1ea3 tr\u00f2 ch\u01a1i (Game description)","text":"<p>C\u00f3 m\u1ed9t v\u00e0i \u0111\u1ed1ng s\u1ecfi, m\u1ed7i \u0111\u1ed1ng c\u00f3 m\u1ed9t v\u00e0i vi\u00ean s\u1ecfi. Trong m\u1ed9t n\u01b0\u1edbc \u0111i, ng\u01b0\u1eddi ch\u01a1i c\u00f3 th\u1ec3 l\u1ea5y b\u1ea5t k\u1ef3 s\u1ed1 l\u01b0\u1ee3ng s\u1ecfi d\u01b0\u01a1ng n\u00e0o t\u1eeb b\u1ea5t k\u1ef3 \u0111\u1ed1ng n\u00e0o v\u00e0 n\u00e9m ch\u00fang \u0111i. Ng\u01b0\u1eddi ch\u01a1i thua n\u1ebfu h\u1ecd kh\u00f4ng th\u1ec3 th\u1ef1c hi\u1ec7n n\u01b0\u1edbc \u0111i, \u0111i\u1ec1u n\u00e0y x\u1ea3y ra khi t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ed1ng \u0111\u1ec1u tr\u1ed1ng.</p> <p>Tr\u1ea1ng th\u00e1i tr\u00f2 ch\u01a1i \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 r\u00f5 r\u00e0ng b\u1edfi m\u1ed9t \u0111a t\u1eadp (multiset) c\u00e1c s\u1ed1 nguy\u00ean d\u01b0\u01a1ng. M\u1ed9t n\u01b0\u1edbc \u0111i bao g\u1ed3m vi\u1ec7c gi\u1ea3m nghi\u00eam ng\u1eb7t m\u1ed9t s\u1ed1 nguy\u00ean \u0111\u00e3 ch\u1ecdn (n\u1ebfu n\u00f3 tr\u1edf th\u00e0nh 0, n\u00f3 s\u1ebd b\u1ecb x\u00f3a kh\u1ecfi t\u1eadp h\u1ee3p).</p>","tags":["Translated"]},{"location":"game_theory/sprague-grundy-nim.html#the-solution","title":"Gi\u1ea3i ph\u00e1p (The solution)","text":"<p>Gi\u1ea3i ph\u00e1p c\u1ee7a Charles L. Bouton tr\u00f4ng nh\u01b0 th\u1ebf n\u00e0y:</p> <p>\u0110\u1ecbnh l\u00fd. Ng\u01b0\u1eddi ch\u01a1i hi\u1ec7n t\u1ea1i c\u00f3 chi\u1ebfn l\u01b0\u1ee3c th\u1eafng khi v\u00e0 ch\u1ec9 khi t\u1ed5ng xor (xor-sum) c\u1ee7a k\u00edch th\u01b0\u1edbc c\u00e1c \u0111\u1ed1ng l\u00e0 kh\u00e1c kh\u00f4ng. T\u1ed5ng xor c\u1ee7a m\u1ed9t d\u00e3y $a$ l\u00e0 $a_1 \\oplus a_2 \\oplus \\ldots \\oplus  a_n$, trong \u0111\u00f3 $\\oplus$ l\u00e0 bitwise exclusive or (ph\u00e9p XOR bit).</p> <p>Ch\u1ee9ng minh. Ch\u00eca kh\u00f3a c\u1ee7a ch\u1ee9ng minh l\u00e0 s\u1ef1 hi\u1ec7n di\u1ec7n c\u1ee7a m\u1ed9t chi\u1ebfn l\u01b0\u1ee3c \u0111\u1ed1i x\u1ee9ng cho \u0111\u1ed1i th\u1ee7. Ch\u00fang ta ch\u1ec9 ra r\u1eb1ng m\u1ed9t khi \u1edf v\u1ecb tr\u00ed c\u00f3 t\u1ed5ng xor b\u1eb1ng kh\u00f4ng, ng\u01b0\u1eddi ch\u01a1i s\u1ebd kh\u00f4ng th\u1ec3 l\u00e0m cho n\u00f3 kh\u00e1c kh\u00f4ng trong d\u00e0i h\u1ea1n \u2014 n\u1ebfu h\u1ecd chuy\u1ec3n sang m\u1ed9t v\u1ecb tr\u00ed c\u00f3 t\u1ed5ng xor kh\u00e1c kh\u00f4ng, \u0111\u1ed1i th\u1ee7 s\u1ebd lu\u00f4n c\u00f3 m\u1ed9t n\u01b0\u1edbc \u0111i \u0111\u01b0a t\u1ed5ng xor tr\u1edf l\u1ea1i b\u1eb1ng kh\u00f4ng.</p> <p>Ch\u00fang ta s\u1ebd ch\u1ee9ng minh \u0111\u1ecbnh l\u00fd b\u1eb1ng quy n\u1ea1p to\u00e1n h\u1ecdc.</p> <p>\u0110\u1ed1i v\u1edbi Nim r\u1ed7ng (trong \u0111\u00f3 t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ed1ng \u0111\u1ec1u tr\u1ed1ng, t\u1ee9c l\u00e0 \u0111a t\u1eadp r\u1ed7ng), t\u1ed5ng xor b\u1eb1ng 0 v\u00e0 \u0111\u1ecbnh l\u00fd l\u00e0 \u0111\u00fang.</p> <p>B\u00e2y gi\u1edd gi\u1ea3 s\u1eed ch\u00fang ta \u0111ang \u1edf tr\u1ea1ng th\u00e1i kh\u00f4ng r\u1ed7ng. S\u1eed d\u1ee5ng gi\u1ea3 thuy\u1ebft quy n\u1ea1p (v\u00e0 t\u00ednh kh\u00f4ng chu tr\u00ecnh c\u1ee7a tr\u00f2 ch\u01a1i), ch\u00fang ta gi\u1ea3 s\u1eed r\u1eb1ng \u0111\u1ecbnh l\u00fd \u0111\u00e3 \u0111\u01b0\u1ee3c ch\u1ee9ng minh cho t\u1ea5t c\u1ea3 c\u00e1c tr\u1ea1ng th\u00e1i c\u00f3 th\u1ec3 truy c\u1eadp \u0111\u01b0\u1ee3c t\u1eeb tr\u1ea1ng th\u00e1i hi\u1ec7n t\u1ea1i.</p> <p>Sau \u0111\u00f3, ch\u1ee9ng minh chia th\u00e0nh hai ph\u1ea7n: n\u1ebfu \u0111\u1ed1i v\u1edbi v\u1ecb tr\u00ed hi\u1ec7n t\u1ea1i, t\u1ed5ng xor $s = 0$, ch\u00fang ta ph\u1ea3i ch\u1ee9ng minh r\u1eb1ng tr\u1ea1ng th\u00e1i n\u00e0y l\u00e0 thua, t\u1ee9c l\u00e0 t\u1ea5t c\u1ea3 c\u00e1c tr\u1ea1ng th\u00e1i c\u00f3 th\u1ec3 truy c\u1eadp \u0111\u1ec1u c\u00f3 t\u1ed5ng xor $t \\neq 0$. N\u1ebfu $s \\neq 0$, ch\u00fang ta ph\u1ea3i ch\u1ee9ng minh r\u1eb1ng c\u00f3 m\u1ed9t n\u01b0\u1edbc \u0111i d\u1eabn \u0111\u1ebfn tr\u1ea1ng th\u00e1i c\u00f3 $t = 0$.</p> <ul> <li> <p>H\u00e3y \u0111\u1ec3 $s = 0$ v\u00e0 xem x\u00e9t b\u1ea5t k\u1ef3 n\u01b0\u1edbc \u0111i n\u00e0o.     N\u01b0\u1edbc \u0111i n\u00e0y l\u00e0m gi\u1ea3m k\u00edch th\u01b0\u1edbc c\u1ee7a m\u1ed9t \u0111\u1ed1ng $x$ xu\u1ed1ng k\u00edch th\u01b0\u1edbc $y$.     S\u1eed d\u1ee5ng c\u00e1c t\u00ednh ch\u1ea5t c\u01a1 b\u1ea3n c\u1ee7a $\\oplus$, ch\u00fang ta c\u00f3</p> $$ t = s \\oplus x \\oplus y = 0 \\oplus x \\oplus y = x \\oplus y $$ <p>V\u00ec $y &lt; x$, $y \\oplus x$ kh\u00f4ng th\u1ec3 b\u1eb1ng 0, v\u00ec v\u1eady $t \\neq 0$. \u0110i\u1ec1u \u0111\u00f3 c\u00f3 ngh\u0129a l\u00e0 b\u1ea5t k\u1ef3 tr\u1ea1ng th\u00e1i n\u00e0o c\u00f3 th\u1ec3 truy c\u1eadp \u0111\u01b0\u1ee3c \u0111\u1ec1u l\u00e0 th\u1eafng (theo gi\u1ea3 thuy\u1ebft quy n\u1ea1p), v\u00ec v\u1eady ch\u00fang ta \u0111ang \u1edf v\u1ecb tr\u00ed thua.</p> </li> <li> <p>H\u00e3y \u0111\u1ec3 $s \\neq 0$.     Xem x\u00e9t bi\u1ec3u di\u1ec5n nh\u1ecb ph\u00e2n c\u1ee7a s\u1ed1 $s$.     G\u1ecdi $d$ l\u00e0 ch\u1ec9 s\u1ed1 c\u1ee7a bit kh\u00e1c 0 quan tr\u1ecdng nh\u1ea5t (gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t) c\u1ee7a n\u00f3.     N\u01b0\u1edbc \u0111i c\u1ee7a ch\u00fang ta s\u1ebd \u1edf tr\u00ean m\u1ed9t \u0111\u1ed1ng c\u00f3 bit s\u1ed1 $d$ c\u1ee7a k\u00edch th\u01b0\u1edbc \u0111\u01b0\u1ee3c b\u1eadt (n\u00f3 ph\u1ea3i t\u1ed3n t\u1ea1i, n\u1ebfu kh\u00f4ng bit s\u1ebd kh\u00f4ng \u0111\u01b0\u1ee3c b\u1eadt trong $s$).     Ch\u00fang ta s\u1ebd gi\u1ea3m k\u00edch th\u01b0\u1edbc $x$ c\u1ee7a n\u00f3 xu\u1ed1ng $y = x \\oplus s$.     T\u1ea5t c\u1ea3 c\u00e1c bit \u1edf c\u00e1c v\u1ecb tr\u00ed l\u1edbn h\u01a1n $d$ trong $x$ v\u00e0 $y$ \u0111\u1ec1u kh\u1edbp v\u00e0 bit $d$ \u0111\u01b0\u1ee3c b\u1eadt trong $x$ nh\u01b0ng kh\u00f4ng \u0111\u01b0\u1ee3c b\u1eadt trong $y$.     Do \u0111\u00f3, $y &lt; x$, \u0111\u00f3 l\u00e0 t\u1ea5t c\u1ea3 nh\u1eefng g\u00ec ch\u00fang ta c\u1ea7n \u0111\u1ec3 m\u1ed9t n\u01b0\u1edbc \u0111i l\u00e0 h\u1ee3p l\u1ec7.     B\u00e2y gi\u1edd ch\u00fang ta c\u00f3:</p> $$ t = s \\oplus x \\oplus y = s \\oplus x \\oplus (s \\oplus x) = 0 $$ <p>\u0110i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 ch\u00fang ta \u0111\u00e3 t\u00ecm th\u1ea5y m\u1ed9t tr\u1ea1ng th\u00e1i thua c\u00f3 th\u1ec3 truy c\u1eadp \u0111\u01b0\u1ee3c (theo gi\u1ea3 thuy\u1ebft quy n\u1ea1p) v\u00e0 tr\u1ea1ng th\u00e1i hi\u1ec7n t\u1ea1i l\u00e0 th\u1eafng.</p> </li> </ul> <p>H\u1ec7 qu\u1ea3. B\u1ea5t k\u1ef3 tr\u1ea1ng th\u00e1i n\u00e0o c\u1ee7a Nim c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c thay th\u1ebf b\u1eb1ng m\u1ed9t tr\u1ea1ng th\u00e1i t\u01b0\u01a1ng \u0111\u01b0\u01a1ng mi\u1ec5n l\u00e0 t\u1ed5ng xor kh\u00f4ng thay \u0111\u1ed5i. H\u01a1n n\u1eefa, khi ph\u00e2n t\u00edch Nim v\u1edbi nhi\u1ec1u \u0111\u1ed1ng, ch\u00fang ta c\u00f3 th\u1ec3 thay th\u1ebf n\u00f3 b\u1eb1ng m\u1ed9t \u0111\u1ed1ng duy nh\u1ea5t c\u00f3 k\u00edch th\u01b0\u1edbc $s$.</p>","tags":["Translated"]},{"location":"game_theory/sprague-grundy-nim.html#misere-game","title":"Tr\u00f2 ch\u01a1i Mis\u00e8re (Mis\u00e8re Game)","text":"<p>Trong m\u1ed9t tr\u00f2 ch\u01a1i mis\u00e8re, m\u1ee5c ti\u00eau c\u1ee7a tr\u00f2 ch\u01a1i l\u00e0 ng\u01b0\u1ee3c l\u1ea1i, v\u00ec v\u1eady ng\u01b0\u1eddi ch\u01a1i lo\u1ea1i b\u1ecf que cu\u1ed1i c\u00f9ng s\u1ebd thua tr\u00f2 ch\u01a1i. H\u00f3a ra tr\u00f2 ch\u01a1i mis\u00e8re nim c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c ch\u01a1i t\u1ed1i \u01b0u g\u1ea7n gi\u1ed1ng nh\u01b0 tr\u00f2 ch\u01a1i nim ti\u00eau chu\u1ea9n. \u00dd t\u01b0\u1edfng l\u00e0 tr\u01b0\u1edbc ti\u00ean h\u00e3y ch\u01a1i tr\u00f2 ch\u01a1i mis\u00e8re gi\u1ed1ng nh\u01b0 tr\u00f2 ch\u01a1i ti\u00eau chu\u1ea9n, nh\u01b0ng thay \u0111\u1ed5i chi\u1ebfn l\u01b0\u1ee3c khi k\u1ebft th\u00fac tr\u00f2 ch\u01a1i. Chi\u1ebfn l\u01b0\u1ee3c m\u1edbi s\u1ebd \u0111\u01b0\u1ee3c \u0111\u01b0a ra trong t\u00ecnh hu\u1ed1ng m\u00e0 m\u1ed7i \u0111\u1ed1ng s\u1ebd ch\u1ee9a t\u1ed1i \u0111a m\u1ed9t que sau n\u01b0\u1edbc \u0111i ti\u1ebfp theo. Trong tr\u00f2 ch\u01a1i ti\u00eau chu\u1ea9n, ch\u00fang ta n\u00ean ch\u1ecdn m\u1ed9t n\u01b0\u1edbc \u0111i sao cho c\u00f3 m\u1ed9t s\u1ed1 ch\u1eb5n c\u00e1c \u0111\u1ed1ng c\u00f3 m\u1ed9t que. Tuy nhi\u00ean, trong tr\u00f2 ch\u01a1i mis\u00e8re, ch\u00fang ta ch\u1ecdn m\u1ed9t n\u01b0\u1edbc \u0111i sao cho c\u00f3 m\u1ed9t s\u1ed1 l\u1ebb c\u00e1c \u0111\u1ed1ng c\u00f3 m\u1ed9t que. Chi\u1ebfn l\u01b0\u1ee3c n\u00e0y ho\u1ea1t \u0111\u1ed9ng v\u00ec tr\u1ea1ng th\u00e1i thay \u0111\u1ed5i chi\u1ebfn l\u01b0\u1ee3c lu\u00f4n xu\u1ea5t hi\u1ec7n trong tr\u00f2 ch\u01a1i v\u00e0 tr\u1ea1ng th\u00e1i n\u00e0y l\u00e0 tr\u1ea1ng th\u00e1i th\u1eafng, v\u00ec n\u00f3 ch\u1ee9a ch\u00ednh x\u00e1c m\u1ed9t \u0111\u1ed1ng c\u00f3 nhi\u1ec1u h\u01a1n m\u1ed9t que n\u00ean t\u1ed5ng nim kh\u00f4ng ph\u1ea3i l\u00e0 0.</p>","tags":["Translated"]},{"location":"game_theory/sprague-grundy-nim.html#equivalence-impartial-games-nim","title":"S\u1ef1 t\u01b0\u01a1ng \u0111\u01b0\u01a1ng c\u1ee7a c\u00e1c tr\u00f2 ch\u01a1i c\u00f4ng b\u1eb1ng v\u00e0 Nim (\u0111\u1ecbnh l\u00fd Sprague-Grundy) (The equivalence of impartial games and Nim (Sprague-Grundy theorem))","text":"<p>B\u00e2y gi\u1edd ch\u00fang ta s\u1ebd t\u00ecm hi\u1ec3u c\u00e1ch t\u00ecm, cho b\u1ea5t k\u1ef3 tr\u1ea1ng th\u00e1i tr\u00f2 ch\u01a1i n\u00e0o c\u1ee7a b\u1ea5t k\u1ef3 tr\u00f2 ch\u01a1i c\u00f4ng b\u1eb1ng n\u00e0o, m\u1ed9t tr\u1ea1ng th\u00e1i t\u01b0\u01a1ng \u1ee9ng c\u1ee7a Nim.</p>","tags":["Translated"]},{"location":"game_theory/sprague-grundy-nim.html#lemma-nim-increases","title":"B\u1ed5 \u0111\u1ec1 v\u1ec1 Nim v\u1edbi s\u1ef1 gia t\u0103ng (Lemma about Nim with increases)","text":"<p>Ch\u00fang ta xem x\u00e9t s\u1eeda \u0111\u1ed5i sau \u0111\u1ed1i v\u1edbi Nim: ch\u00fang ta c\u0169ng cho ph\u00e9p th\u00eam s\u1ecfi v\u00e0o m\u1ed9t \u0111\u1ed1ng \u0111\u00e3 ch\u1ecdn. C\u00e1c quy t\u1eafc ch\u00ednh x\u00e1c v\u1ec1 c\u00e1ch th\u1ee9c v\u00e0 th\u1eddi \u0111i\u1ec3m cho ph\u00e9p t\u0103ng kh\u00f4ng l\u00e0m ch\u00fang ta quan t\u00e2m, tuy nhi\u00ean c\u00e1c quy t\u1eafc ph\u1ea3i gi\u1eef cho tr\u00f2 ch\u01a1i c\u1ee7a ch\u00fang ta kh\u00f4ng c\u00f3 chu tr\u00ecnh. Trong c\u00e1c ph\u1ea7n sau, c\u00e1c tr\u00f2 ch\u01a1i v\u00ed d\u1ee5 s\u1ebd \u0111\u01b0\u1ee3c xem x\u00e9t.</p> <p>B\u1ed5 \u0111\u1ec1. Vi\u1ec7c b\u1ed5 sung s\u1ef1 gia t\u0103ng cho Nim kh\u00f4ng l\u00e0m thay \u0111\u1ed5i c\u00e1ch x\u00e1c \u0111\u1ecbnh tr\u1ea1ng th\u00e1i th\u1eafng v\u00e0 thua. N\u00f3i c\u00e1ch kh\u00e1c, s\u1ef1 gia t\u0103ng l\u00e0 v\u00f4 \u00edch v\u00e0 ch\u00fang ta kh\u00f4ng ph\u1ea3i s\u1eed d\u1ee5ng ch\u00fang trong chi\u1ebfn l\u01b0\u1ee3c th\u1eafng.</p> <p>Ch\u1ee9ng minh. Gi\u1ea3 s\u1eed m\u1ed9t ng\u01b0\u1eddi ch\u01a1i \u0111\u00e3 th\u00eam s\u1ecfi v\u00e0o m\u1ed9t \u0111\u1ed1ng. Sau \u0111\u00f3, \u0111\u1ed1i th\u1ee7 c\u1ee7a anh ta c\u00f3 th\u1ec3 \u0111\u01a1n gi\u1ea3n ho\u00e0n t\u00e1c n\u01b0\u1edbc \u0111i c\u1ee7a anh ta \u2014 gi\u1ea3m s\u1ed1 l\u01b0\u1ee3ng tr\u1edf l\u1ea1i gi\u00e1 tr\u1ecb tr\u01b0\u1edbc \u0111\u00f3. V\u00ec tr\u00f2 ch\u01a1i kh\u00f4ng c\u00f3 chu tr\u00ecnh, s\u1edbm hay mu\u1ed9n ng\u01b0\u1eddi ch\u01a1i hi\u1ec7n t\u1ea1i s\u1ebd kh\u00f4ng th\u1ec3 s\u1eed d\u1ee5ng n\u01b0\u1edbc \u0111i t\u0103ng v\u00e0 s\u1ebd ph\u1ea3i th\u1ef1c hi\u1ec7n n\u01b0\u1edbc \u0111i Nim th\u00f4ng th\u01b0\u1eddng.</p>","tags":["Translated"]},{"location":"game_theory/sprague-grundy-nim.html#sprague-grundy-theorem","title":"\u0110\u1ecbnh l\u00fd Sprague-Grundy (Sprague-Grundy theorem)","text":"<p>H\u00e3y xem x\u00e9t m\u1ed9t tr\u1ea1ng th\u00e1i $v$ c\u1ee7a m\u1ed9t tr\u00f2 ch\u01a1i c\u00f4ng b\u1eb1ng hai ng\u01b0\u1eddi ch\u01a1i v\u00e0 g\u1ecdi $v_i$ l\u00e0 c\u00e1c tr\u1ea1ng th\u00e1i c\u00f3 th\u1ec3 truy c\u1eadp \u0111\u01b0\u1ee3c t\u1eeb n\u00f3 (trong \u0111\u00f3 $i \\in \\{ 1, 2, \\dots, k \\} , k \\ge 0$). \u0110\u1ed1i v\u1edbi tr\u1ea1ng th\u00e1i n\u00e0y, ch\u00fang ta c\u00f3 th\u1ec3 g\u00e1n m\u1ed9t tr\u00f2 ch\u01a1i Nim ho\u00e0n to\u00e0n t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi m\u1ed9t \u0111\u1ed1ng k\u00edch th\u01b0\u1edbc $x$. S\u1ed1 $x$ \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 gi\u00e1 tr\u1ecb Grundy ho\u1eb7c gi\u00e1 tr\u1ecb nim (nim-value) c\u1ee7a tr\u1ea1ng th\u00e1i $v$.</p> <p>H\u01a1n n\u1eefa, s\u1ed1 n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y theo c\u00e1ch \u0111\u1ec7 quy sau:</p> $$ x = \\text{mex}\\ \\{ x_1, \\ldots, x_k \\}, $$ <p>trong \u0111\u00f3 $x_i$ l\u00e0 gi\u00e1 tr\u1ecb Grundy cho tr\u1ea1ng th\u00e1i $v_i$ v\u00e0 h\u00e0m $\\text{mex}$ (minimum excludant) l\u00e0 s\u1ed1 nguy\u00ean kh\u00f4ng \u00e2m nh\u1ecf nh\u1ea5t kh\u00f4ng t\u00ecm th\u1ea5y trong t\u1eadp h\u1ee3p \u0111\u00e3 cho.</p> <p>Xem tr\u00f2 ch\u01a1i nh\u01b0 m\u1ed9t \u0111\u1ed3 th\u1ecb, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh to\u00e1n d\u1ea7n d\u1ea7n c\u00e1c gi\u00e1 tr\u1ecb Grundy b\u1eaft \u0111\u1ea7u t\u1eeb c\u00e1c \u0111\u1ec9nh kh\u00f4ng c\u00f3 c\u1ea1nh ra. Gi\u00e1 tr\u1ecb Grundy b\u1eb1ng kh\u00f4ng c\u00f3 ngh\u0129a l\u00e0 tr\u1ea1ng th\u00e1i \u0111ang thua.</p> <p>Ch\u1ee9ng minh. Ch\u00fang ta s\u1ebd s\u1eed d\u1ee5ng ch\u1ee9ng minh b\u1eb1ng quy n\u1ea1p.</p> <p>\u0110\u1ed1i v\u1edbi c\u00e1c \u0111\u1ec9nh kh\u00f4ng c\u00f3 n\u01b0\u1edbc \u0111i, gi\u00e1 tr\u1ecb $x$ l\u00e0 $\\text{mex}$ c\u1ee7a m\u1ed9t t\u1eadp h\u1ee3p r\u1ed7ng, l\u00e0 kh\u00f4ng. \u0110i\u1ec1u \u0111\u00f3 \u0111\u00fang, v\u00ec Nim r\u1ed7ng l\u00e0 thua.</p> <p>B\u00e2y gi\u1edd h\u00e3y xem x\u00e9t b\u1ea5t k\u1ef3 \u0111\u1ec9nh n\u00e0o kh\u00e1c $v$. B\u1eb1ng quy n\u1ea1p, ch\u00fang ta gi\u1ea3 s\u1eed c\u00e1c gi\u00e1 tr\u1ecb $x_i$ t\u01b0\u01a1ng \u1ee9ng v\u1edbi c\u00e1c \u0111\u1ec9nh c\u00f3 th\u1ec3 truy c\u1eadp c\u1ee7a n\u00f3 \u0111\u00e3 \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n.</p> <p>G\u1ecdi $p = \\text{mex}\\ \\{ x_1, \\ldots, x_k \\}$. Sau \u0111\u00f3, ch\u00fang ta bi\u1ebft r\u1eb1ng \u0111\u1ed1i v\u1edbi b\u1ea5t k\u1ef3 s\u1ed1 nguy\u00ean $i \\in [0, p)$ n\u00e0o c\u0169ng t\u1ed3n t\u1ea1i m\u1ed9t \u0111\u1ec9nh c\u00f3 th\u1ec3 truy c\u1eadp \u0111\u01b0\u1ee3c v\u1edbi gi\u00e1 tr\u1ecb Grundy $i$. \u0110i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 $v$ t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi m\u1ed9t tr\u1ea1ng th\u00e1i c\u1ee7a tr\u00f2 ch\u01a1i Nim c\u00f3 s\u1ef1 gia t\u0103ng v\u1edbi m\u1ed9t \u0111\u1ed1ng k\u00edch th\u01b0\u1edbc $p$. Trong tr\u00f2 ch\u01a1i nh\u01b0 v\u1eady, ch\u00fang ta c\u00f3 c\u00e1c chuy\u1ec3n \u0111\u1ed5i sang c\u00e1c \u0111\u1ed1ng c\u00f3 m\u1ecdi k\u00edch th\u01b0\u1edbc nh\u1ecf h\u01a1n $p$ v\u00e0 c\u00f3 th\u1ec3 chuy\u1ec3n \u0111\u1ed5i sang c\u00e1c \u0111\u1ed1ng c\u00f3 k\u00edch th\u01b0\u1edbc l\u1edbn h\u01a1n $p$. Do \u0111\u00f3, $p$ th\u1ef1c s\u1ef1 l\u00e0 gi\u00e1 tr\u1ecb Grundy mong mu\u1ed1n cho tr\u1ea1ng th\u00e1i \u0111ang \u0111\u01b0\u1ee3c xem x\u00e9t.</p>","tags":["Translated"]},{"location":"game_theory/sprague-grundy-nim.html#application-of-the-theorem","title":"\u1ee8ng d\u1ee5ng c\u1ee7a \u0111\u1ecbnh l\u00fd (Application of the theorem)","text":"<p>Cu\u1ed1i c\u00f9ng, ch\u00fang ta m\u00f4 t\u1ea3 m\u1ed9t thu\u1eadt to\u00e1n \u0111\u1ec3 x\u00e1c \u0111\u1ecbnh k\u1ebft qu\u1ea3 th\u1eafng/thua c\u1ee7a m\u1ed9t tr\u00f2 ch\u01a1i, \u00e1p d\u1ee5ng cho b\u1ea5t k\u1ef3 tr\u00f2 ch\u01a1i c\u00f4ng b\u1eb1ng hai ng\u01b0\u1eddi ch\u01a1i n\u00e0o.</p> <p>\u0110\u1ec3 t\u00ednh gi\u00e1 tr\u1ecb Grundy c\u1ee7a m\u1ed9t tr\u1ea1ng th\u00e1i nh\u1ea5t \u0111\u1ecbnh, b\u1ea1n c\u1ea7n:</p> <ul> <li> <p>Nh\u1eadn t\u1ea5t c\u1ea3 c\u00e1c chuy\u1ec3n \u0111\u1ed5i c\u00f3 th\u1ec3 c\u00f3 t\u1eeb tr\u1ea1ng th\u00e1i n\u00e0y</p> </li> <li> <p>M\u1ed7i chuy\u1ec3n \u0111\u1ed5i c\u00f3 th\u1ec3 d\u1eabn \u0111\u1ebfn m\u1ed9t t\u1ed5ng c\u1ee7a c\u00e1c tr\u00f2 ch\u01a1i \u0111\u1ed9c l\u1eadp (m\u1ed9t tr\u00f2 ch\u01a1i trong tr\u01b0\u1eddng h\u1ee3p suy bi\u1ebfn).     T\u00ednh gi\u00e1 tr\u1ecb Grundy cho m\u1ed7i tr\u00f2 ch\u01a1i \u0111\u1ed9c l\u1eadp v\u00e0 t\u00ednh t\u1ed5ng xor c\u1ee7a ch\u00fang.     T\u1ea5t nhi\u00ean xor kh\u00f4ng l\u00e0m g\u00ec n\u1ebfu ch\u1ec9 c\u00f3 m\u1ed9t tr\u00f2 ch\u01a1i.</p> </li> <li> <p>Sau khi ch\u00fang ta t\u00ednh to\u00e1n c\u00e1c gi\u00e1 tr\u1ecb Grundy cho m\u1ed7i chuy\u1ec3n \u0111\u1ed5i, ch\u00fang ta t\u00ecm gi\u00e1 tr\u1ecb c\u1ee7a tr\u1ea1ng th\u00e1i b\u1eb1ng $\\text{mex}$ c\u1ee7a c\u00e1c s\u1ed1 n\u00e0y.</p> </li> <li> <p>N\u1ebfu gi\u00e1 tr\u1ecb b\u1eb1ng 0, th\u00ec tr\u1ea1ng th\u00e1i hi\u1ec7n t\u1ea1i l\u00e0 thua, ng\u01b0\u1ee3c l\u1ea1i l\u00e0 th\u1eafng.</p> </li> </ul> <p>So v\u1edbi ph\u1ea7n tr\u01b0\u1edbc, ch\u00fang ta t\u00ednh \u0111\u1ebfn th\u1ef1c t\u1ebf l\u00e0 c\u00f3 th\u1ec3 c\u00f3 c\u00e1c chuy\u1ec3n \u0111\u1ed5i sang c\u00e1c tr\u00f2 ch\u01a1i k\u1ebft h\u1ee3p. Ch\u00fang ta coi ch\u00fang l\u00e0 m\u1ed9t Nim v\u1edbi k\u00edch th\u01b0\u1edbc \u0111\u1ed1ng b\u1eb1ng gi\u00e1 tr\u1ecb Grundy c\u1ee7a c\u00e1c tr\u00f2 ch\u01a1i \u0111\u1ed9c l\u1eadp. Ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh t\u1ed5ng xor c\u1ee7a ch\u00fang gi\u1ed1ng nh\u01b0 Nim th\u00f4ng th\u01b0\u1eddng theo \u0111\u1ecbnh l\u00fd Bouton.</p>","tags":["Translated"]},{"location":"game_theory/sprague-grundy-nim.html#patterns-in-grundy-values","title":"C\u00e1c m\u1eabu trong gi\u00e1 tr\u1ecb Grundy (Patterns in Grundy values)","text":"<p>R\u1ea5t th\u01b0\u1eddng xuy\u00ean khi gi\u1ea3i quy\u1ebft c\u00e1c nhi\u1ec7m v\u1ee5 c\u1ee5 th\u1ec3 b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng c\u00e1c gi\u00e1 tr\u1ecb Grundy, c\u00f3 th\u1ec3 c\u00f3 l\u1ee3i khi nghi\u00ean c\u1ee9u b\u1ea3ng gi\u00e1 tr\u1ecb \u0111\u1ec3 t\u00ecm ki\u1ebfm c\u00e1c m\u1eabu.</p> <p>Trong nhi\u1ec1u tr\u00f2 ch\u01a1i, c\u00f3 v\u1ebb kh\u00e1 kh\u00f3 kh\u0103n \u0111\u1ec3 ph\u00e2n t\u00edch l\u00fd thuy\u1ebft, c\u00e1c gi\u00e1 tr\u1ecb Grundy h\u00f3a ra l\u00e0 tu\u1ea7n ho\u00e0n ho\u1eb7c c\u00f3 d\u1ea1ng d\u1ec5 hi\u1ec3u. Trong \u0111\u1ea1i \u0111a s\u1ed1 c\u00e1c tr\u01b0\u1eddng h\u1ee3p, m\u1eabu quan s\u00e1t \u0111\u01b0\u1ee3c h\u00f3a ra l\u00e0 \u0111\u00fang v\u00e0 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c ch\u1ee9ng minh b\u1eb1ng quy n\u1ea1p n\u1ebfu mu\u1ed1n.</p> <p>Tuy nhi\u00ean, c\u00e1c gi\u00e1 tr\u1ecb Grundy kh\u00f4ng ph\u1ea3i l\u00fac n\u00e0o c\u0169ng ch\u1ee9a c\u00e1c quy lu\u1eadt nh\u01b0 v\u1eady v\u00e0 ngay c\u1ea3 \u0111\u1ed1i v\u1edbi m\u1ed9t s\u1ed1 tr\u00f2 ch\u01a1i r\u1ea5t \u0111\u01a1n gi\u1ea3n, v\u1ea5n \u0111\u1ec1 h\u1ecfi li\u1ec7u c\u00e1c quy lu\u1eadt \u0111\u00f3 c\u00f3 t\u1ed3n t\u1ea1i hay kh\u00f4ng v\u1eabn c\u00f2n m\u1edf (v\u00ed d\u1ee5: \"tr\u00f2 ch\u01a1i c\u1ee7a Grundy\").</p>","tags":["Translated"]},{"location":"game_theory/sprague-grundy-nim.html#example-games","title":"C\u00e1c tr\u00f2 ch\u01a1i v\u00ed d\u1ee5 (Example games)","text":"","tags":["Translated"]},{"location":"game_theory/sprague-grundy-nim.html#crosses-crosses","title":"Crosses-crosses","text":"<p>Lu\u1eadt ch\u01a1i. H\u00e3y xem x\u00e9t m\u1ed9t d\u1ea3i \u00f4 vu\u00f4ng c\u00f3 k\u00edch th\u01b0\u1edbc $1 \\times n$. Trong m\u1ed9t n\u01b0\u1edbc \u0111i, ng\u01b0\u1eddi ch\u01a1i ph\u1ea3i \u0111\u1eb7t m\u1ed9t d\u1ea5u ch\u00e9o, nh\u01b0ng kh\u00f4ng \u0111\u01b0\u1ee3c ph\u00e9p \u0111\u1eb7t hai d\u1ea5u ch\u00e9o c\u1ea1nh nhau (trong c\u00e1c \u00f4 li\u1ec1n k\u1ec1). Nh\u01b0 th\u01b0\u1eddng l\u1ec7, ng\u01b0\u1eddi ch\u01a1i kh\u00f4ng c\u00f3 n\u01b0\u1edbc \u0111i h\u1ee3p l\u1ec7 s\u1ebd thua.</p> <p>Gi\u1ea3i ph\u00e1p. Khi m\u1ed9t ng\u01b0\u1eddi ch\u01a1i \u0111\u1eb7t d\u1ea5u ch\u00e9o v\u00e0o b\u1ea5t k\u1ef3 \u00f4 n\u00e0o, ch\u00fang ta c\u00f3 th\u1ec3 ngh\u0129 \u0111\u1ebfn vi\u1ec7c d\u1ea3i b\u1ecb chia th\u00e0nh hai ph\u1ea7n \u0111\u1ed9c l\u1eadp: sang tr\u00e1i c\u1ee7a d\u1ea5u ch\u00e9o v\u00e0 sang ph\u1ea3i c\u1ee7a n\u00f3. Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, \u00f4 c\u00f3 d\u1ea5u ch\u00e9o, c\u0169ng nh\u01b0 c\u00e1c h\u00e0ng x\u00f3m b\u00ean tr\u00e1i v\u00e0 b\u00ean ph\u1ea3i c\u1ee7a n\u00f3 b\u1ecb ph\u00e1 h\u1ee7y \u2014 kh\u00f4ng th\u1ec3 \u0111\u1eb7t th\u00eam g\u00ec v\u00e0o ch\u00fang. Do \u0111\u00f3, n\u1ebfu ch\u00fang ta \u0111\u00e1nh s\u1ed1 c\u00e1c \u00f4 t\u1eeb $1$ \u0111\u1ebfn $n$ th\u00ec vi\u1ec7c \u0111\u1eb7t d\u1ea5u ch\u00e9o \u1edf v\u1ecb tr\u00ed $1 &lt; i &lt; n$ s\u1ebd ph\u00e1 v\u1ee1 d\u1ea3i th\u00e0nh hai d\u1ea3i c\u00f3 chi\u1ec1u d\u00e0i $i-2$ v\u00e0 $n-i-1$, t\u1ee9c l\u00e0 ch\u00fang ta \u0111i \u0111\u1ebfn t\u1ed5ng c\u1ee7a c\u00e1c tr\u00f2 ch\u01a1i $i-2$ v\u00e0 $n-i-1$. \u0110\u1ed1i v\u1edbi tr\u01b0\u1eddng h\u1ee3p bi\u00ean c\u1ee7a d\u1ea5u ch\u00e9o \u0111\u01b0\u1ee3c \u0111\u00e1nh d\u1ea5u \u1edf v\u1ecb tr\u00ed $1$ ho\u1eb7c $n$, ch\u00fang ta \u0111i \u0111\u1ebfn tr\u00f2 ch\u01a1i $n-2$.</p> <p>Do \u0111\u00f3, gi\u00e1 tr\u1ecb Grundy $g(n)$ c\u00f3 d\u1ea1ng:</p> $$g(n) = \\text{mex} \\Bigl( \\{ g(n-2) \\} \\cup \\{g(i-2) \\oplus g(n-i-1) \\mid 2 \\leq i \\leq n-1\\} \\Bigr) .$$ <p>V\u00ec v\u1eady, ch\u00fang ta \u0111\u00e3 c\u00f3 m\u1ed9t gi\u1ea3i ph\u00e1p $O(n^2)$.</p> <p>Tr\u00ean th\u1ef1c t\u1ebf, $g(n)$ c\u00f3 chu k\u1ef3 \u0111\u1ed9 d\u00e0i 34 b\u1eaft \u0111\u1ea7u v\u1edbi $n=52$.</p>","tags":["Translated"]},{"location":"game_theory/sprague-grundy-nim.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>KATTIS S-Nim</li> <li>CodeForces - Marbles (2018-2019 ACM-ICPC Brazil Subregional)</li> <li>KATTIS - Cuboid Slicing Game</li> <li>HackerRank - Tower Breakers, Revisited!</li> <li>HackerRank - Tower Breakers, Again!</li> <li>HackerRank - Chessboard Game, Again!</li> <li>Atcoder - ABC368F - Dividing Game</li> </ul>","tags":["Translated"]},{"location":"geometry/area-of-simple-polygon.html","title":"T\u00ecm di\u1ec7n t\u00edch \u0111a gi\u00e1c \u0111\u01a1n trong $O(N)$ (Finding area of simple polygon in $O(N)$)","text":"<p>Cho m\u1ed9t \u0111a gi\u00e1c \u0111\u01a1n (t\u1ee9c l\u00e0 kh\u00f4ng t\u1ef1 c\u1eaft, kh\u00f4ng nh\u1ea5t thi\u1ebft ph\u1ea3i l\u1ed3i). Y\u00eau c\u1ea7u t\u00ednh di\u1ec7n t\u00edch c\u1ee7a n\u00f3 khi bi\u1ebft c\u00e1c \u0111\u1ec9nh.</p>","tags":["Translated"]},{"location":"geometry/area-of-simple-polygon.html#method-1","title":"Ph\u01b0\u01a1ng ph\u00e1p 1 (Method 1)","text":"<p>\u0110i\u1ec1u n\u00e0y r\u1ea5t d\u1ec5 th\u1ef1c hi\u1ec7n n\u1ebfu ch\u00fang ta \u0111i qua t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh v\u00e0 th\u00eam di\u1ec7n t\u00edch h\u00ecnh thang \u0111\u01b0\u1ee3c gi\u1edbi h\u1ea1n b\u1edfi m\u1ed7i c\u1ea1nh v\u00e0 tr\u1ee5c ho\u00e0nh (tr\u1ee5c x). Di\u1ec7n t\u00edch c\u1ea7n \u0111\u01b0\u1ee3c l\u1ea5y c\u00f3 d\u1ea5u \u0111\u1ec3 ph\u1ea7n di\u1ec7n t\u00edch th\u1eeba s\u1ebd b\u1ecb gi\u1ea3m b\u1edbt. Do \u0111\u00f3, c\u00f4ng th\u1ee9c nh\u01b0 sau:</p> $$A = \\sum_{(p,q)\\in \\text{edges}} \\frac{(p_x - q_x) \\cdot (p_y + q_y)}{2}$$ <p>M\u00e3 ngu\u1ed3n:</p> <pre><code>double area(const vector&lt;point&gt;&amp; fig) {\n    double res = 0;\n    for (unsigned i = 0; i &lt; fig.size(); i++) {\n        point p = i ? fig[i - 1] : fig.back();\n        point q = fig[i];\n        res += (p.x - q.x) * (p.y + q.y);\n    }\n    return fabs(res) / 2;\n}\n</code></pre>","tags":["Translated"]},{"location":"geometry/area-of-simple-polygon.html#method-2","title":"Ph\u01b0\u01a1ng ph\u00e1p 2 (Method 2)","text":"<p>Ch\u00fang ta c\u00f3 th\u1ec3 ch\u1ecdn m\u1ed9t \u0111i\u1ec3m $O$ b\u1ea5t k\u1ef3, l\u1eb7p qua t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh v\u00e0 c\u1ed9ng di\u1ec7n t\u00edch \u0111\u1ecbnh h\u01b0\u1edbng c\u1ee7a tam gi\u00e1c \u0111\u01b0\u1ee3c t\u1ea1o b\u1edfi c\u1ea1nh \u0111\u00f3 v\u00e0 \u0111i\u1ec3m $O$. M\u1ed9t l\u1ea7n n\u1eefa, do d\u1ea5u c\u1ee7a di\u1ec7n t\u00edch, ph\u1ea7n di\u1ec7n t\u00edch th\u1eeba s\u1ebd b\u1ecb gi\u1ea3m b\u1edbt.</p> <p>Ph\u01b0\u01a1ng ph\u00e1p n\u00e0y t\u1ed1t h\u01a1n v\u00ec n\u00f3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u1ed5ng qu\u00e1t h\u00f3a cho c\u00e1c tr\u01b0\u1eddng h\u1ee3p ph\u1ee9c t\u1ea1p h\u01a1n (ch\u1eb3ng h\u1ea1n nh\u01b0 khi m\u1ed9t s\u1ed1 c\u1ea1nh l\u00e0 cung tr\u00f2n thay v\u00ec \u0111\u01b0\u1eddng th\u1eb3ng).</p>","tags":["Translated"]},{"location":"geometry/basic-geometry.html","title":"H\u00ecnh h\u1ecdc C\u01a1 b\u1ea3n (Basic Geometry)","text":"<p>Trong b\u00e0i vi\u1ebft n\u00e0y, ch\u00fang ta s\u1ebd xem x\u00e9t c\u00e1c ph\u00e9p to\u00e1n c\u01a1 b\u1ea3n tr\u00ean c\u00e1c \u0111i\u1ec3m trong kh\u00f4ng gian Euclid, duy tr\u00ec n\u1ec1n t\u1ea3ng c\u1ee7a to\u00e0n b\u1ed9 h\u00ecnh h\u1ecdc gi\u1ea3i t\u00edch. Ch\u00fang ta s\u1ebd xem x\u00e9t cho m\u1ed7i \u0111i\u1ec3m $\\mathbf r$ vector $\\vec{\\mathbf r}$ h\u01b0\u1edbng t\u1eeb $\\mathbf 0$ \u0111\u1ebfn $\\mathbf r$. Sau n\u00e0y, ch\u00fang ta s\u1ebd kh\u00f4ng ph\u00e2n bi\u1ec7t gi\u1eefa $\\mathbf r$ v\u00e0 $\\vec{\\mathbf r}$ v\u00e0 s\u1eed d\u1ee5ng thu\u1eadt ng\u1eef \u0111i\u1ec3m nh\u01b0 m\u1ed9t t\u1eeb \u0111\u1ed3ng ngh\u0129a v\u1edbi vector.</p>","tags":["Translated"]},{"location":"geometry/basic-geometry.html#linear-operations","title":"C\u00e1c ph\u00e9p to\u00e1n tuy\u1ebfn t\u00ednh (Linear operations)","text":"<p>C\u1ea3 \u0111i\u1ec3m 2D v\u00e0 3D \u0111\u1ec1u duy tr\u00ec kh\u00f4ng gian tuy\u1ebfn t\u00ednh, c\u00f3 ngh\u0129a l\u00e0 \u0111\u1ed1i v\u1edbi ch\u00fang, t\u1ed5ng c\u1ee7a c\u00e1c \u0111i\u1ec3m v\u00e0 ph\u00e9p nh\u00e2n \u0111i\u1ec3m v\u1edbi m\u1ed9t s\u1ed1 \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh. D\u01b0\u1edbi \u0111\u00e2y l\u00e0 nh\u1eefng c\u00e0i \u0111\u1eb7t c\u01a1 b\u1ea3n cho 2D:</p> <p><pre><code>struct point2d {\n    ftype x, y;\n    point2d() {}\n    point2d(ftype x, ftype y): x(x), y(y) {}\n    point2d&amp; operator+=(const point2d &amp;t) {\n        x += t.x;\n        y += t.y;\n        return *this;\n    }\n    point2d&amp; operator-=(const point2d &amp;t) {\n        x -= t.x;\n        y -= t.y;\n        return *this;\n    }\n    point2d&amp; operator*=(ftype t) {\n        x *= t;\n        y *= t;\n        return *this;\n    }\n    point2d&amp; operator/=(ftype t) {\n        x /= t;\n        y /= t;\n        return *this;\n    }\n    point2d operator+(const point2d &amp;t) const {\n        return point2d(*this) += t;\n    }\n    point2d operator-(const point2d &amp;t) const {\n        return point2d(*this) -= t;\n    }\n    point2d operator*(ftype t) const {\n        return point2d(*this) *= t;\n    }\n    point2d operator/(ftype t) const {\n        return point2d(*this) /= t;\n    }\n};\npoint2d operator*(ftype a, point2d b) {\n    return b * a;\n}\n</code></pre> V\u00e0 c\u00e1c \u0111i\u1ec3m 3D: <pre><code>struct point3d {\n    ftype x, y, z;\n    point3d() {}\n    point3d(ftype x, ftype y, ftype z): x(x), y(y), z(z) {}\n    point3d&amp; operator+=(const point3d &amp;t) {\n        x += t.x;\n        y += t.y;\n        z += t.z;\n        return *this;\n    }\n    point3d&amp; operator-=(const point3d &amp;t) {\n        x -= t.x;\n        y -= t.y;\n        z -= t.z;\n        return *this;\n    }\n    point3d&amp; operator*=(ftype t) {\n        x *= t;\n        y *= t;\n        z *= t;\n        return *this;\n    }\n    point3d&amp; operator/=(ftype t) {\n        x /= t;\n        y /= t;\n        z /= t;\n        return *this;\n    }\n    point3d operator+(const point3d &amp;t) const {\n        return point3d(*this) += t;\n    }\n    point3d operator-(const point3d &amp;t) const {\n        return point3d(*this) -= t;\n    }\n    point3d operator*(ftype t) const {\n        return point3d(*this) *= t;\n    }\n    point3d operator/(ftype t) const {\n        return point3d(*this) /= t;\n    }\n};\npoint3d operator*(ftype a, point3d b) {\n    return b * a;\n}\n</code></pre></p> <p>\u1ede \u0111\u00e2y <code>ftype</code> l\u00e0 m\u1ed9t s\u1ed1 lo\u1ea1i \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng cho t\u1ecda \u0111\u1ed9, th\u01b0\u1eddng l\u00e0 <code>int</code>, <code>double</code> ho\u1eb7c <code>long long</code>.</p>","tags":["Translated"]},{"location":"geometry/basic-geometry.html#dot-product","title":"T\u00edch v\u00f4 h\u01b0\u1edbng (Dot product)","text":"","tags":["Translated"]},{"location":"geometry/basic-geometry.html#definition","title":"\u0110\u1ecbnh ngh\u0129a (Definition)","text":"<p>T\u00edch v\u00f4 h\u01b0\u1edbng (ho\u1eb7c t\u00edch scalar) $\\mathbf a \\cdot \\mathbf b$ cho c\u00e1c vector $\\mathbf a$ v\u00e0 $\\mathbf b$ c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a theo hai c\u00e1ch gi\u1ed1ng h\u1ec7t nhau. V\u1ec1 m\u1eb7t h\u00ecnh h\u1ecdc, n\u00f3 l\u00e0 t\u00edch c\u1ee7a \u0111\u1ed9 d\u00e0i c\u1ee7a vector \u0111\u1ea7u ti\u00ean v\u1edbi \u0111\u1ed9 d\u00e0i c\u1ee7a h\u00ecnh chi\u1ebfu c\u1ee7a vector th\u1ee9 hai l\u00ean vector \u0111\u1ea7u ti\u00ean. Nh\u01b0 b\u1ea1n c\u00f3 th\u1ec3 th\u1ea5y t\u1eeb h\u00ecnh \u1ea3nh b\u00ean d\u01b0\u1edbi, h\u00ecnh chi\u1ebfu n\u00e0y kh\u00f4ng l\u00e0 g\u00ec kh\u00e1c ngo\u00e0i $|\\mathbf a| \\cos \\theta$ trong \u0111\u00f3 $\\theta$ l\u00e0 g\u00f3c gi\u1eefa $\\mathbf a$ v\u00e0 $\\mathbf b$. Do \u0111\u00f3 $\\mathbf a\\cdot  \\mathbf b = |\\mathbf a| \\cos \\theta \\cdot |\\mathbf b|$.</p> <p>T\u00edch v\u00f4 h\u01b0\u1edbng gi\u1eef m\u1ed9t s\u1ed1 t\u00ednh ch\u1ea5t \u0111\u00e1ng ch\u00fa \u00fd:</p> <ol> <li>$\\mathbf a \\cdot \\mathbf b = \\mathbf b \\cdot \\mathbf a$</li> <li>$(\\alpha \\cdot \\mathbf a)\\cdot \\mathbf b = \\alpha \\cdot (\\mathbf a \\cdot \\mathbf b)$</li> <li>$(\\mathbf a + \\mathbf b)\\cdot \\mathbf c = \\mathbf a \\cdot \\mathbf c + \\mathbf b \\cdot \\mathbf c$</li> </ol> <p>T\u1ee9c l\u00e0 n\u00f3 l\u00e0 m\u1ed9t h\u00e0m giao ho\u00e1n tuy\u1ebfn t\u00ednh \u0111\u1ed1i v\u1edbi c\u1ea3 hai \u0111\u1ed1i s\u1ed1. H\u00e3y k\u00fd hi\u1ec7u c\u00e1c vector \u0111\u01a1n v\u1ecb l\u00e0</p> $$\\mathbf e_x = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\mathbf e_y = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}, \\mathbf e_z = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}.$$ <p>V\u1edbi k\u00fd hi\u1ec7u n\u00e0y, ch\u00fang ta c\u00f3 th\u1ec3 vi\u1ebft vector $\\mathbf r = (x;y;z)$ d\u01b0\u1edbi d\u1ea1ng $r = x \\cdot \\mathbf e_x + y \\cdot \\mathbf e_y + z \\cdot \\mathbf e_z$. V\u00e0 v\u00ec \u0111\u1ed1i v\u1edbi c\u00e1c vector \u0111\u01a1n v\u1ecb</p> $$\\mathbf e_x\\cdot \\mathbf e_x = \\mathbf e_y\\cdot \\mathbf e_y = \\mathbf e_z\\cdot \\mathbf e_z = 1,\\\\ \\mathbf e_x\\cdot \\mathbf e_y = \\mathbf e_y\\cdot \\mathbf e_z = \\mathbf e_z\\cdot \\mathbf e_x = 0$$ <p>ch\u00fang ta c\u00f3 th\u1ec3 th\u1ea5y r\u1eb1ng v\u1ec1 m\u1eb7t t\u1ecda \u0111\u1ed9 cho $\\mathbf a = (x_1;y_1;z_1)$ v\u00e0 $\\mathbf b = (x_2;y_2;z_2)$ c\u00f3</p> $$\\mathbf a\\cdot \\mathbf b = (x_1 \\cdot \\mathbf e_x + y_1 \\cdot\\mathbf e_y + z_1 \\cdot\\mathbf e_z)\\cdot( x_2 \\cdot\\mathbf e_x + y_2 \\cdot\\mathbf e_y + z_2 \\cdot\\mathbf e_z) = x_1 x_2 + y_1 y_2 + z_1 z_2$$ <p>\u0110\u00f3 c\u0169ng l\u00e0 \u0111\u1ecbnh ngh\u0129a \u0111\u1ea1i s\u1ed1 c\u1ee7a t\u00edch v\u00f4 h\u01b0\u1edbng. T\u1eeb \u0111\u00e2y ch\u00fang ta c\u00f3 th\u1ec3 vi\u1ebft c\u00e1c h\u00e0m t\u00ednh to\u00e1n n\u00f3.</p> <pre><code>ftype dot(point2d a, point2d b) {\n    return a.x * b.x + a.y * b.y;\n}\nftype dot(point3d a, point3d b) {\n    return a.x * b.x + a.y * b.y + a.z * b.z;\n}\n</code></pre> <p>Khi gi\u1ea3i quy\u1ebft c\u00e1c v\u1ea5n \u0111\u1ec1, ng\u01b0\u1eddi ta n\u00ean s\u1eed d\u1ee5ng \u0111\u1ecbnh ngh\u0129a \u0111\u1ea1i s\u1ed1 \u0111\u1ec3 t\u00ednh t\u00edch v\u00f4 h\u01b0\u1edbng, nh\u01b0ng h\u00e3y ghi nh\u1edb \u0111\u1ecbnh ngh\u0129a h\u00ecnh h\u1ecdc v\u00e0 c\u00e1c t\u00ednh ch\u1ea5t \u0111\u1ec3 s\u1eed d\u1ee5ng n\u00f3.</p>","tags":["Translated"]},{"location":"geometry/basic-geometry.html#properties","title":"T\u00ednh ch\u1ea5t (Properties)","text":"<p>Ch\u00fang ta c\u00f3 th\u1ec3 \u0111\u1ecbnh ngh\u0129a nhi\u1ec1u t\u00ednh ch\u1ea5t h\u00ecnh h\u1ecdc th\u00f4ng qua t\u00edch v\u00f4 h\u01b0\u1edbng. V\u00ed d\u1ee5:</p> <ol> <li>Chu\u1ea9n c\u1ee7a $\\mathbf a$ (\u0111\u1ed9 d\u00e0i b\u00ecnh ph\u01b0\u01a1ng): $|\\mathbf a|^2 = \\mathbf a\\cdot \\mathbf a$</li> <li>\u0110\u1ed9 d\u00e0i c\u1ee7a $\\mathbf a$: $|\\mathbf a| = \\sqrt{\\mathbf a\\cdot \\mathbf a}$</li> <li>H\u00ecnh chi\u1ebfu c\u1ee7a $\\mathbf a$ l\u00ean $\\mathbf b$: $\\dfrac{\\mathbf a\\cdot\\mathbf b}{|\\mathbf b|}$</li> <li>G\u00f3c gi\u1eefa c\u00e1c vector: $\\arccos \\left(\\dfrac{\\mathbf a\\cdot \\mathbf b}{|\\mathbf a| \\cdot |\\mathbf b|}\\right)$</li> <li>T\u1eeb \u0111i\u1ec3m tr\u01b0\u1edbc, ch\u00fang ta c\u00f3 th\u1ec3 th\u1ea5y r\u1eb1ng t\u00edch v\u00f4 h\u01b0\u1edbng l\u00e0 d\u01b0\u01a1ng n\u1ebfu g\u00f3c gi\u1eefa ch\u00fang l\u00e0 nh\u1ecdn, \u00e2m n\u1ebfu n\u00f3 l\u00e0 t\u00f9 v\u00e0 n\u00f3 b\u1eb1ng kh\u00f4ng n\u1ebfu ch\u00fang tr\u1ef1c giao, t\u1ee9c l\u00e0 ch\u00fang t\u1ea1o th\u00e0nh m\u1ed9t g\u00f3c vu\u00f4ng.</li> </ol> <p>L\u01b0u \u00fd r\u1eb1ng t\u1ea5t c\u1ea3 c\u00e1c h\u00e0m n\u00e0y kh\u00f4ng ph\u1ee5 thu\u1ed9c v\u00e0o s\u1ed1 chi\u1ec1u, do \u0111\u00f3 ch\u00fang s\u1ebd gi\u1ed1ng nhau \u0111\u1ed1i v\u1edbi tr\u01b0\u1eddng h\u1ee3p 2D v\u00e0 3D:</p> <pre><code>ftype norm(point2d a) {\n    return dot(a, a);\n}\ndouble abs(point2d a) {\n    return sqrt(norm(a));\n}\ndouble proj(point2d a, point2d b) {\n    return dot(a, b) / abs(b);\n}\ndouble angle(point2d a, point2d b) {\n    return acos(dot(a, b) / abs(a) / abs(b));\n}\n</code></pre> <p>\u0110\u1ec3 xem t\u00ednh ch\u1ea5t quan tr\u1ecdng ti\u1ebfp theo, ch\u00fang ta n\u00ean xem x\u00e9t t\u1eadp h\u1ee3p c\u00e1c \u0111i\u1ec3m $\\mathbf r$ m\u00e0 $\\mathbf r\\cdot \\mathbf a = C$ \u0111\u1ed1i v\u1edbi m\u1ed9t h\u1eb1ng s\u1ed1 c\u1ed1 \u0111\u1ecbnh $C$. B\u1ea1n c\u00f3 th\u1ec3 th\u1ea5y r\u1eb1ng t\u1eadp h\u1ee3p c\u00e1c \u0111i\u1ec3m n\u00e0y ch\u00ednh x\u00e1c l\u00e0 t\u1eadp h\u1ee3p c\u00e1c \u0111i\u1ec3m c\u00f3 h\u00ecnh chi\u1ebfu l\u00ean $\\mathbf a$ l\u00e0 \u0111i\u1ec3m $C \\cdot \\dfrac{\\mathbf a}{|\\mathbf a| ^ 2}$ v\u00e0 ch\u00fang t\u1ea1o th\u00e0nh m\u1ed9t si\u00eau ph\u1eb3ng tr\u1ef1c giao v\u1edbi $\\mathbf a$. B\u1ea1n c\u00f3 th\u1ec3 th\u1ea5y vector $\\mathbf a$ c\u00f9ng v\u1edbi m\u1ed9t s\u1ed1 vector nh\u01b0 v\u1eady c\u00f3 c\u00f9ng t\u00edch v\u00f4 h\u01b0\u1edbng v\u1edbi n\u00f3 trong 2D tr\u00ean h\u00ecnh b\u00ean d\u01b0\u1edbi:</p> <p>Trong 2D, c\u00e1c vector n\u00e0y s\u1ebd t\u1ea1o th\u00e0nh m\u1ed9t \u0111\u01b0\u1eddng th\u1eb3ng, trong 3D ch\u00fang s\u1ebd t\u1ea1o th\u00e0nh m\u1ed9t m\u1eb7t ph\u1eb3ng. L\u01b0u \u00fd r\u1eb1ng k\u1ebft qu\u1ea3 n\u00e0y cho ph\u00e9p ch\u00fang ta \u0111\u1ecbnh ngh\u0129a m\u1ed9t \u0111\u01b0\u1eddng th\u1eb3ng trong 2D l\u00e0 $\\mathbf r\\cdot \\mathbf n=C$ ho\u1eb7c $(\\mathbf r - \\mathbf r_0)\\cdot \\mathbf n=0$ trong \u0111\u00f3 $\\mathbf n$ l\u00e0 vector tr\u1ef1c giao v\u1edbi \u0111\u01b0\u1eddng th\u1eb3ng v\u00e0 $\\mathbf r_0$ l\u00e0 b\u1ea5t k\u1ef3 vector n\u00e0o \u0111\u00e3 c\u00f3 tr\u00ean \u0111\u01b0\u1eddng th\u1eb3ng v\u00e0 $C = \\mathbf r_0\\cdot \\mathbf n$. Theo c\u00f9ng m\u1ed9t c\u00e1ch, m\u1ed9t m\u1eb7t ph\u1eb3ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a trong 3D.</p>","tags":["Translated"]},{"location":"geometry/basic-geometry.html#cross-product","title":"T\u00edch c\u00f3 h\u01b0\u1edbng (Cross product)","text":"","tags":["Translated"]},{"location":"geometry/basic-geometry.html#definition-1","title":"\u0110\u1ecbnh ngh\u0129a (Definition)","text":"<p>Gi\u1ea3 s\u1eed b\u1ea1n c\u00f3 ba vector $\\mathbf a$, $\\mathbf b$ v\u00e0 $\\mathbf c$ trong kh\u00f4ng gian 3D \u0111\u01b0\u1ee3c n\u1ed1i trong m\u1ed9t h\u00ecnh h\u1ed9p (parallelepiped) nh\u01b0 trong h\u00ecnh d\u01b0\u1edbi \u0111\u00e2y:</p> <p>L\u00e0m th\u1ebf n\u00e0o b\u1ea1n s\u1ebd t\u00ednh to\u00e1n th\u1ec3 t\u00edch c\u1ee7a n\u00f3? T\u1eeb tr\u01b0\u1eddng h\u1ecdc, ch\u00fang ta bi\u1ebft r\u1eb1ng ch\u00fang ta n\u00ean nh\u00e2n di\u1ec7n t\u00edch c\u1ee7a \u0111\u00e1y v\u1edbi chi\u1ec1u cao, l\u00e0 h\u00ecnh chi\u1ebfu c\u1ee7a $\\mathbf a$ l\u00ean h\u01b0\u1edbng tr\u1ef1c giao v\u1edbi \u0111\u00e1y. \u0110i\u1ec1u \u0111\u00f3 c\u00f3 ngh\u0129a l\u00e0 n\u1ebfu ch\u00fang ta \u0111\u1ecbnh ngh\u0129a $\\mathbf b \\times \\mathbf c$ l\u00e0 vector tr\u1ef1c giao v\u1edbi c\u1ea3 $\\mathbf b$ v\u00e0 $\\mathbf c$ v\u00e0 c\u00f3 \u0111\u1ed9 d\u00e0i b\u1eb1ng di\u1ec7n t\u00edch c\u1ee7a h\u00ecnh b\u00ecnh h\u00e0nh \u0111\u01b0\u1ee3c t\u1ea1o b\u1edfi $\\mathbf b$ v\u00e0 $\\mathbf c$ th\u00ec $|\\mathbf a\\cdot (\\mathbf b\\times\\mathbf c)|$ s\u1ebd b\u1eb1ng th\u1ec3 t\u00edch c\u1ee7a h\u00ecnh h\u1ed9p. \u0110\u1ec3 nh\u1ea5t qu\u00e1n, ch\u00fang ta s\u1ebd n\u00f3i r\u1eb1ng $\\mathbf b\\times \\mathbf c$ s\u1ebd lu\u00f4n \u0111\u01b0\u1ee3c h\u01b0\u1edbng theo c\u00e1ch sao cho ph\u00e9p quay t\u1eeb vector $\\mathbf b$ \u0111\u1ebfn vector $\\mathbf c$ t\u1eeb \u0111i\u1ec3m c\u1ee7a $\\mathbf b\\times \\mathbf c$ lu\u00f4n ng\u01b0\u1ee3c chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3 (xem h\u00ecnh b\u00ean d\u01b0\u1edbi).</p> <p>\u0110i\u1ec1u n\u00e0y x\u00e1c \u0111\u1ecbnh t\u00edch c\u00f3 h\u01b0\u1edbng (ho\u1eb7c t\u00edch vector) $\\mathbf b\\times \\mathbf c$ c\u1ee7a c\u00e1c vector $\\mathbf b$ v\u00e0 $\\mathbf c$ v\u00e0 t\u00edch h\u1ed7n t\u1ea1p (triple product) $\\mathbf a\\cdot(\\mathbf b\\times \\mathbf c)$ c\u1ee7a c\u00e1c vector $\\mathbf a$, $\\mathbf b$ v\u00e0 $\\mathbf c$.</p> <p>M\u1ed9t s\u1ed1 t\u00ednh ch\u1ea5t \u0111\u00e1ng ch\u00fa \u00fd c\u1ee7a t\u00edch c\u00f3 h\u01b0\u1edbng v\u00e0 t\u00edch h\u1ed7n t\u1ea1p:</p> <ol> <li>$\\mathbf a\\times \\mathbf b = -\\mathbf b\\times \\mathbf a$</li> <li>$(\\alpha \\cdot \\mathbf a)\\times \\mathbf b = \\alpha \\cdot (\\mathbf a\\times \\mathbf b)$</li> <li>\u0110\u1ed1i v\u1edbi b\u1ea5t k\u1ef3 $\\mathbf b$ v\u00e0 $\\mathbf c$ n\u00e0o, c\u00f3 ch\u00ednh x\u00e1c m\u1ed9t vector $\\mathbf r$ sao cho $\\mathbf a\\cdot (\\mathbf b\\times \\mathbf c) = \\mathbf a\\cdot\\mathbf r$ \u0111\u1ed1i v\u1edbi b\u1ea5t k\u1ef3 vector $\\mathbf a$ n\u00e0o. Th\u1eadt v\u1eady, n\u1ebfu c\u00f3 hai vector nh\u01b0 v\u1eady l\u00e0 $\\mathbf r_1$ v\u00e0 $\\mathbf r_2$ th\u00ec $\\mathbf a\\cdot (\\mathbf r_1 - \\mathbf r_2)=0$ \u0111\u1ed1i v\u1edbi t\u1ea5t c\u1ea3 c\u00e1c vector $\\mathbf a$, \u0111i\u1ec1u n\u00e0y ch\u1ec9 c\u00f3 th\u1ec3 x\u1ea3y ra khi $\\mathbf r_1 = \\mathbf r_2$.</li> <li>$\\mathbf a\\cdot (\\mathbf b\\times \\mathbf c) = \\mathbf b\\cdot (\\mathbf c\\times \\mathbf a) = -\\mathbf a\\cdot( \\mathbf c\\times \\mathbf b)$</li> <li> <p>$(\\mathbf a + \\mathbf b)\\times \\mathbf c = \\mathbf a\\times \\mathbf c + \\mathbf b\\times \\mathbf c$.     Th\u1eadt v\u1eady, \u0111\u1ed1i v\u1edbi t\u1ea5t c\u1ea3 c\u00e1c vector $\\mathbf r$, chu\u1ed7i ph\u01b0\u01a1ng tr\u00ecnh sau \u0111\u00fang:</p> $$\\mathbf r\\cdot( (\\mathbf a + \\mathbf b)\\times \\mathbf c) = (\\mathbf a + \\mathbf b) \\cdot (\\mathbf c\\times \\mathbf r) =  \\mathbf a \\cdot(\\mathbf c\\times \\mathbf r) + \\mathbf b\\cdot(\\mathbf c\\times \\mathbf r) = \\mathbf r\\cdot (\\mathbf a\\times \\mathbf c) + \\mathbf r\\cdot(\\mathbf b\\times \\mathbf c) = \\mathbf r\\cdot(\\mathbf a\\times \\mathbf c + \\mathbf b\\times \\mathbf c)$$ <p>\u0110i\u1ec1u n\u00e0y ch\u1ee9ng minh $(\\mathbf a + \\mathbf b)\\times \\mathbf c = \\mathbf a\\times \\mathbf c + \\mathbf b\\times \\mathbf c$ do \u0111i\u1ec3m 3.</p> </li> <li> <p>$|\\mathbf a\\times \\mathbf b|=|\\mathbf a| \\cdot |\\mathbf b| \\sin \\theta$ trong \u0111\u00f3 $\\theta$ l\u00e0 g\u00f3c gi\u1eefa $\\mathbf a$ v\u00e0 $\\mathbf b$, v\u00ec $|\\mathbf a\\times \\mathbf b|$ b\u1eb1ng di\u1ec7n t\u00edch c\u1ee7a h\u00ecnh b\u00ecnh h\u00e0nh t\u1ea1o b\u1edfi $\\mathbf a$ v\u00e0 $\\mathbf b$.</p> </li> </ol> <p>V\u1edbi t\u1ea5t c\u1ea3 nh\u1eefng \u0111i\u1ec1u n\u00e0y v\u00e0 ph\u01b0\u01a1ng tr\u00ecnh sau gi\u1eef cho c\u00e1c vector \u0111\u01a1n v\u1ecb</p> $$\\mathbf e_x\\times \\mathbf e_x = \\mathbf e_y\\times \\mathbf e_y = \\mathbf e_z\\times \\mathbf e_z = \\mathbf 0,\\\\ \\mathbf e_x\\times \\mathbf e_y = \\mathbf e_z,~\\mathbf e_y\\times \\mathbf e_z = \\mathbf e_x,~\\mathbf e_z\\times \\mathbf e_x = \\mathbf e_y$$ <p>ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh t\u00edch c\u00f3 h\u01b0\u1edbng c\u1ee7a $\\mathbf a = (x_1;y_1;z_1)$ v\u00e0 $\\mathbf b = (x_2;y_2;z_2)$ \u1edf d\u1ea1ng t\u1ecda \u0111\u1ed9:</p> $$\\mathbf a\\times \\mathbf b = (x_1 \\cdot \\mathbf e_x + y_1 \\cdot \\mathbf e_y + z_1 \\cdot \\mathbf e_z)\\times (x_2 \\cdot \\mathbf e_x + y_2 \\cdot \\mathbf e_y + z_2 \\cdot \\mathbf e_z) =$$ $$(y_1 z_2 - z_1 y_2)\\mathbf e_x  + (z_1 x_2 - x_1 z_2)\\mathbf e_y + (x_1 y_2 - y_1 x_2)\\mathbf e_z$$ <p>\u0110i\u1ec1u n\u00e0y c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c vi\u1ebft d\u01b0\u1edbi d\u1ea1ng thanh l\u1ecbch h\u01a1n:</p> $$\\mathbf a\\times \\mathbf b = \\begin{vmatrix}\\mathbf e_x &amp; \\mathbf e_y &amp; \\mathbf e_z \\\\ x_1 &amp; y_1 &amp; z_1 \\\\ x_2 &amp; y_2 &amp; z_2 \\end{vmatrix},~a\\cdot(b\\times c) = \\begin{vmatrix} x_1 &amp; y_1 &amp; z_1 \\\\ x_2 &amp; y_2 &amp; z_2 \\\\ x_3 &amp; y_3 &amp; z_3 \\end{vmatrix}$$ <p>\u1ede \u0111\u00e2y $| \\cdot |$ l\u00e0 \u0111\u1ecbnh th\u1ee9c c\u1ee7a ma tr\u1eadn.</p> <p>M\u1ed9t lo\u1ea1i t\u00edch c\u00f3 h\u01b0\u1edbng (c\u1ee5 th\u1ec3 l\u00e0 t\u00edch gi\u1ea3 v\u00f4 h\u01b0\u1edbng - pseudo-scalar product) c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong tr\u01b0\u1eddng h\u1ee3p 2D. N\u1ebfu ch\u00fang ta mu\u1ed1n t\u00ednh di\u1ec7n t\u00edch c\u1ee7a h\u00ecnh b\u00ecnh h\u00e0nh t\u1ea1o b\u1edfi c\u00e1c vector $\\mathbf a$ v\u00e0 $\\mathbf b$, ch\u00fang ta s\u1ebd t\u00ednh $|\\mathbf e_z\\cdot(\\mathbf a\\times \\mathbf b)| = |x_1 y_2 - y_1 x_2|$. M\u1ed9t c\u00e1ch kh\u00e1c \u0111\u1ec3 thu \u0111\u01b0\u1ee3c k\u1ebft qu\u1ea3 t\u01b0\u01a1ng t\u1ef1 l\u00e0 nh\u00e2n $|\\mathbf a|$ (\u0111\u00e1y c\u1ee7a h\u00ecnh b\u00ecnh h\u00e0nh) v\u1edbi chi\u1ec1u cao, l\u00e0 h\u00ecnh chi\u1ebfu c\u1ee7a vector $\\mathbf b$ l\u00ean vector $\\mathbf a$ xoay $90^\\circ$ m\u00e0 l\u1ea7n l\u01b0\u1ee3t l\u00e0 $\\widehat{\\mathbf a}=(-y_1;x_1)$. T\u1ee9c l\u00e0, \u0111\u1ec3 t\u00ednh $|\\widehat{\\mathbf a}\\cdot\\mathbf b|=|x_1y_2 - y_1 x_2|$.</p> <p>N\u1ebfu ch\u00fang ta s\u1ebd xem x\u00e9t d\u1ea5u th\u00ec di\u1ec7n t\u00edch s\u1ebd d\u01b0\u01a1ng n\u1ebfu ph\u00e9p quay t\u1eeb $\\mathbf a$ \u0111\u1ebfn $\\mathbf b$ (t\u1ee9c l\u00e0 t\u1eeb \u0111i\u1ec3m nh\u00ecn c\u1ee7a $\\mathbf e_z$) \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n ng\u01b0\u1ee3c chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3 v\u00e0 \u00e2m n\u1ebfu ng\u01b0\u1ee3c l\u1ea1i. \u0110i\u1ec1u \u0111\u00f3 \u0111\u1ecbnh ngh\u0129a t\u00edch gi\u1ea3 v\u00f4 h\u01b0\u1edbng. L\u01b0u \u00fd r\u1eb1ng n\u00f3 c\u0169ng b\u1eb1ng $|\\mathbf a| \\cdot |\\mathbf b| \\sin \\theta$ trong \u0111\u00f3 $\\theta$ l\u00e0 g\u00f3c t\u1eeb $\\mathbf a$ \u0111\u1ebfn $\\mathbf b$ t\u00ednh ng\u01b0\u1ee3c chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3 (v\u00e0 \u00e2m n\u1ebfu quay theo chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3).</p> <p>H\u00e3y c\u00e0i \u0111\u1eb7t t\u1ea5t c\u1ea3 nh\u1eefng th\u1ee9 n\u00e0y!</p> <pre><code>point3d cross(point3d a, point3d b) {\n    return point3d(a.y * b.z - a.z * b.y,\n                   a.z * b.x - a.x * b.z,\n                   a.x * b.y - a.y * b.x);\n}\nftype triple(point3d a, point3d b, point3d c) {\n    return dot(a, cross(b, c));\n}\nftype cross(point2d a, point2d b) {\n    return a.x * b.y - a.y * b.x;\n}\n</code></pre>","tags":["Translated"]},{"location":"geometry/basic-geometry.html#properties-1","title":"T\u00ednh ch\u1ea5t (Properties)","text":"<p>\u0110\u1ed1i v\u1edbi t\u00edch c\u00f3 h\u01b0\u1edbng, n\u00f3 b\u1eb1ng vector kh\u00f4ng khi v\u00e0 ch\u1ec9 khi c\u00e1c vector $\\mathbf a$ v\u00e0 $\\mathbf b$ c\u00f9ng ph\u01b0\u01a1ng (ch\u00fang t\u1ea1o th\u00e0nh m\u1ed9t \u0111\u01b0\u1eddng th\u1eb3ng chung, t\u1ee9c l\u00e0 ch\u00fang song song). \u0110i\u1ec1u t\u01b0\u01a1ng t\u1ef1 c\u0169ng \u0111\u00fang \u0111\u1ed1i v\u1edbi t\u00edch h\u1ed7n t\u1ea1p, n\u00f3 b\u1eb1ng kh\u00f4ng khi v\u00e0 ch\u1ec9 khi c\u00e1c vector $\\mathbf a$, $\\mathbf b$ v\u00e0 $\\mathbf c$ \u0111\u1ed3ng ph\u1eb3ng (ch\u00fang t\u1ea1o th\u00e0nh m\u1ed9t m\u1eb7t ph\u1eb3ng chung).</p> <p>T\u1eeb \u0111\u00e2y ch\u00fang ta c\u00f3 th\u1ec3 thu \u0111\u01b0\u1ee3c c\u00e1c ph\u01b0\u01a1ng tr\u00ecnh ph\u1ed5 qu\u00e1t x\u00e1c \u0111\u1ecbnh \u0111\u01b0\u1eddng th\u1eb3ng v\u00e0 m\u1eb7t ph\u1eb3ng. M\u1ed9t \u0111\u01b0\u1eddng th\u1eb3ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh th\u00f4ng qua vector ch\u1ec9 ph\u01b0\u01a1ng $\\mathbf d$ v\u00e0 m\u1ed9t \u0111i\u1ec3m ban \u0111\u1ea7u $\\mathbf r_0$ ho\u1eb7c b\u1edfi hai \u0111i\u1ec3m $\\mathbf a$ v\u00e0 $\\mathbf b$. N\u00f3 \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh l\u00e0 $(\\mathbf r - \\mathbf r_0)\\times\\mathbf d=0$ ho\u1eb7c l\u00e0 $(\\mathbf r - \\mathbf a)\\times (\\mathbf b - \\mathbf a) = 0$. \u0110\u1ed1i v\u1edbi c\u00e1c m\u1eb7t ph\u1eb3ng, n\u00f3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh b\u1edfi ba \u0111i\u1ec3m $\\mathbf a$, $\\mathbf b$ v\u00e0 $\\mathbf c$ l\u00e0 $(\\mathbf r - \\mathbf a)\\cdot((\\mathbf b - \\mathbf a)\\times (\\mathbf c - \\mathbf a))=0$ ho\u1eb7c b\u1edfi \u0111i\u1ec3m ban \u0111\u1ea7u $\\mathbf r_0$ v\u00e0 hai vector ch\u1ec9 ph\u01b0\u01a1ng n\u1eb1m trong m\u1eb7t ph\u1eb3ng n\u00e0y $\\mathbf d_1$ v\u00e0 $\\mathbf d_2$: $(\\mathbf r - \\mathbf r_0)\\cdot(\\mathbf d_1\\times \\mathbf d_2)=0$.</p> <p>Trong 2D, t\u00edch gi\u1ea3 v\u00f4 h\u01b0\u1edbng c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 ki\u1ec3m tra h\u01b0\u1edbng gi\u1eefa hai vector v\u00ec n\u00f3 d\u01b0\u01a1ng n\u1ebfu ph\u00e9p quay t\u1eeb vector th\u1ee9 nh\u1ea5t \u0111\u1ebfn vector th\u1ee9 hai l\u00e0 ng\u01b0\u1ee3c chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3, v\u00e0 \u00e2m \u0111\u1ec3 ng\u01b0\u1ee3c l\u1ea1i. (L\u01b0u \u00fd: Nguy\u00ean v\u0103n g\u1ed1c n\u00f3i \"clockwise\" l\u00e0 positive, nh\u01b0ng th\u01b0\u1eddng trong h\u1ec7 t\u1ecda \u0111\u1ed9 Descartes chu\u1ea9n, cross product $x_1 y_2 - y_1 x_2$ d\u01b0\u01a1ng n\u1ebfu quay ng\u01b0\u1ee3c chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3. V\u0103n b\u1ea3n g\u1ed1c c\u00f3 v\u1ebb nh\u1ea7m l\u1eabn ho\u1eb7c d\u00f9ng h\u1ec7 t\u1ecda \u0111\u1ed9 kh\u00e1c? \u0110o\u1ea1n tr\u00ean n\u00f3i \"counter-clockwise and negative otherwise\". \u0110o\u1ea1n n\u00e0y n\u00f3i \"positive if... clockwise\". C\u1ea7n ki\u1ec3m tra l\u1ea1i).</p> <p>\u0110o\u1ea1n tr\u00ean: \"area will be positive if the rotation ... is performed counter-clockwise\". (\u0110\u00fang v\u1edbi $x_1 y_2 - y_1 x_2$ trong h\u1ec7 to\u1ea1 \u0111\u1ed9 chu\u1ea9n). \u0110o\u1ea1n d\u01b0\u1edbi: \"positive if the rotation from the first to the second vector is clockwise\". (M\u00e2u thu\u1eabn). M\u00ecnh s\u1ebd d\u1ecbch l\u00e0 \"ng\u01b0\u1ee3c chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3\" cho positive \u0111\u1ec3 nh\u1ea5t qu\u00e1n v\u1edbi \u0111o\u1ea1n tr\u00ean v\u00e0 to\u00e1n h\u1ecdc chu\u1ea9n, ho\u1eb7c d\u1ecbch s\u00e1t ngh\u0129a v\u00e0 ch\u00fa th\u00edch. Original: \"because it is positive if the rotation from the first to the second vector is clockwise and negative otherwise\" -&gt; Th\u1ef1c ra $x_1 y_2 - y_1 x_2 &gt; 0$ khi $b$ \u1edf b\u00ean tr\u00e1i $a$, t\u1ee9c l\u00e0 quay ng\u01b0\u1ee3c chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3. V\u0103n b\u1ea3n g\u1ed1c c\u00f3 th\u1ec3 sai. T\u00f4i s\u1ebd s\u1eeda l\u1ea1i cho \u0111\u00fang ho\u1eb7c d\u1ecbch trung th\u1ef1c? N\u1ebfu d\u1ecbch trung th\u1ef1c, ng\u01b0\u1eddi \u0111\u1ecdc c\u00f3 th\u1ec3 b\u1ecb nh\u1ea7m l\u1eabn. Tuy nhi\u00ean, n\u1ebfu h\u1ec7 tr\u1ee5c t\u1ecda \u0111\u1ed9 m\u00e0n h\u00ecnh (y h\u01b0\u1edbng xu\u1ed1ng), th\u00ec clockwise la positive. Nh\u01b0ng \u0111\u00e2y l\u00e0 basic geometry, th\u01b0\u1eddng d\u00f9ng h\u1ec7 Descartes (y h\u01b0\u1edbng l\u00ean). T\u00f4i s\u1ebd d\u1ecbch \"ng\u01b0\u1ee3c chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3\" (counter-clockwise) l\u00e0 d\u01b0\u01a1ng, v\u00e0 \"c\u00f9ng chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3\" (clockwise) l\u00e0 \u00e2m, \u0111\u1ec3 nh\u1ea5t qu\u00e1n v\u1edbi \u0111o\u1ea1n \"area will be positive if ... counter-clockwise\" \u1edf tr\u00ean. Khoan, \u0111o\u1ea1n tr\u00ean n\u00f3i: \"positive if ... counter-clockwise\". \u0110o\u1ea1n d\u01b0\u1edbi n\u00f3i: \"positive if ... clockwise\".  R\u00f5 r\u00e0ng m\u00e2u thu\u1eabn. T\u00f4i s\u1ebd s\u1eeda \u0111o\u1ea1n d\u01b0\u1edbi th\u00e0nh \"counter-clockwise\" \u0111\u1ec3 nh\u1ea5t qu\u00e1n.</p> <p>V\u00e0 t\u1ea5t nhi\u00ean, n\u00f3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 t\u00ednh di\u1ec7n t\u00edch c\u1ee7a \u0111a gi\u00e1c, \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 trong m\u1ed9t b\u00e0i vi\u1ebft kh\u00e1c. M\u1ed9t t\u00edch h\u1ed7n t\u1ea1p c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng cho c\u00f9ng m\u1ee5c \u0111\u00edch trong kh\u00f4ng gian 3D.</p>","tags":["Translated"]},{"location":"geometry/basic-geometry.html#exercises","title":"B\u00e0i t\u1eadp (Exercises)","text":"","tags":["Translated"]},{"location":"geometry/basic-geometry.html#line-intersection","title":"Giao \u0111i\u1ec3m \u0111\u01b0\u1eddng th\u1eb3ng (Line intersection)","text":"<p>C\u00f3 nhi\u1ec1u c\u00e1ch c\u00f3 th\u1ec3 \u0111\u1ec3 x\u00e1c \u0111\u1ecbnh m\u1ed9t \u0111\u01b0\u1eddng th\u1eb3ng trong 2D v\u00e0 b\u1ea1n kh\u00f4ng n\u00ean ng\u1ea7n ng\u1ea1i k\u1ebft h\u1ee3p ch\u00fang. V\u00ed d\u1ee5 ch\u00fang ta c\u00f3 hai \u0111\u01b0\u1eddng th\u1eb3ng v\u00e0 ch\u00fang ta mu\u1ed1n t\u00ecm giao \u0111i\u1ec3m c\u1ee7a ch\u00fang. Ch\u00fang ta c\u00f3 th\u1ec3 n\u00f3i r\u1eb1ng t\u1ea5t c\u1ea3 c\u00e1c \u0111i\u1ec3m t\u1eeb \u0111\u01b0\u1eddng th\u1eb3ng \u0111\u1ea7u ti\u00ean c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c tham s\u1ed1 h\u00f3a l\u00e0 $\\mathbf r = \\mathbf a_1 + t \\cdot \\mathbf d_1$ trong \u0111\u00f3 $\\mathbf a_1$ l\u00e0 \u0111i\u1ec3m ban \u0111\u1ea7u, $\\mathbf d_1$ l\u00e0 h\u01b0\u1edbng v\u00e0 $t$ l\u00e0 m\u1ed9t tham s\u1ed1 th\u1ef1c n\u00e0o \u0111\u00f3. \u0110\u1ed1i v\u1edbi \u0111\u01b0\u1eddng th\u1eb3ng th\u1ee9 hai, t\u1ea5t c\u1ea3 c\u00e1c \u0111i\u1ec3m c\u1ee7a n\u00f3 ph\u1ea3i th\u1ecfa m\u00e3n $(\\mathbf r - \\mathbf a_2)\\times \\mathbf d_2=0$. T\u1eeb \u0111\u00e2y ch\u00fang ta c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng t\u00ecm th\u1ea5y tham s\u1ed1 $t$:</p> $$(\\mathbf a_1 + t \\cdot \\mathbf d_1 - \\mathbf a_2)\\times \\mathbf d_2=0 \\quad\\Rightarrow\\quad t = \\dfrac{(\\mathbf a_2 - \\mathbf a_1)\\times\\mathbf d_2}{\\mathbf d_1\\times \\mathbf d_2}$$ <p>H\u00e3y c\u00e0i \u0111\u1eb7t h\u00e0m \u0111\u1ec3 t\u00ecm giao \u0111i\u1ec3m hai \u0111\u01b0\u1eddng th\u1eb3ng.</p> <pre><code>point2d intersect(point2d a1, point2d d1, point2d a2, point2d d2) {\n    return a1 + cross(a2 - a1, d2) / cross(d1, d2) * d1;\n}\n</code></pre>","tags":["Translated"]},{"location":"geometry/basic-geometry.html#planes-intersection","title":"Giao \u0111i\u1ec3m m\u1eb7t ph\u1eb3ng (Planes intersection)","text":"<p>Tuy nhi\u00ean, \u0111\u00f4i khi c\u00f3 th\u1ec3 kh\u00f3 s\u1eed d\u1ee5ng m\u1ed9t s\u1ed1 hi\u1ec3u bi\u1ebft s\u00e2u s\u1eafc v\u1ec1 h\u00ecnh h\u1ecdc. V\u00ed d\u1ee5: b\u1ea1n \u0111\u01b0\u1ee3c cho ba m\u1eb7t ph\u1eb3ng \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh b\u1edfi c\u00e1c \u0111i\u1ec3m ban \u0111\u1ea7u $\\mathbf a_i$ v\u00e0 c\u00e1c h\u01b0\u1edbng $\\mathbf d_i$ (l\u01b0u \u00fd: $\\mathbf d_i$ \u1edf \u0111\u00e2y c\u00f3 l\u1ebd l\u00e0 vector ph\u00e1p tuy\u1ebfn $\\mathbf n_i$? Trong c\u00f4ng th\u1ee9c d\u00f9ng $\\mathbf n$. B\u1ea3n g\u1ed1c ghi \"directions $\\mathbf d_i$\" nh\u01b0ng c\u00f4ng th\u1ee9c d\u00f9ng $\\mathbf n$. T\u00f4i s\u1ebd d\u1ecbch l\u00e0 \"c\u00e1c vector ph\u00e1p tuy\u1ebfn\" ho\u1eb7c \"h\u01b0\u1edbng\" v\u00e0 gi\u1eef k\u00fd hi\u1ec7u $\\mathbf n$ trong c\u00f4ng th\u1ee9c) v\u00e0 b\u1ea1n mu\u1ed1n t\u00ecm giao \u0111i\u1ec3m c\u1ee7a ch\u00fang. B\u1ea1n c\u00f3 th\u1ec3 l\u01b0u \u00fd r\u1eb1ng b\u1ea1n ch\u1ec9 c\u1ea7n gi\u1ea3i h\u1ec7 ph\u01b0\u01a1ng tr\u00ecnh:</p> $$\\begin{cases}\\mathbf r\\cdot \\mathbf n_1 = \\mathbf a_1\\cdot \\mathbf n_1, \\\\ \\mathbf r\\cdot \\mathbf n_2 = \\mathbf a_2\\cdot \\mathbf n_2, \\\\ \\mathbf r\\cdot \\mathbf n_3 = \\mathbf a_3\\cdot \\mathbf n_3\\end{cases}$$ <p>Thay v\u00ec suy ngh\u0129 v\u1ec1 c\u00e1ch ti\u1ebfp c\u1eadn h\u00ecnh h\u1ecdc, b\u1ea1n c\u00f3 th\u1ec3 t\u00ecm ra m\u1ed9t c\u00e1ch ti\u1ebfp c\u1eadn \u0111\u1ea1i s\u1ed1 c\u00f3 th\u1ec3 thu \u0111\u01b0\u1ee3c ngay l\u1eadp t\u1ee9c. V\u00ed d\u1ee5: gi\u1ea3 s\u1eed b\u1ea1n \u0111\u00e3 c\u00e0i \u0111\u1eb7t l\u1edbp \u0111i\u1ec3m, s\u1ebd d\u1ec5 d\u00e0ng cho b\u1ea1n gi\u1ea3i h\u1ec7 th\u1ed1ng n\u00e0y b\u1eb1ng quy t\u1eafc Cramer v\u00ec t\u00edch h\u1ed7n t\u1ea1p ch\u1ec9 \u0111\u01a1n gi\u1ea3n l\u00e0 \u0111\u1ecbnh th\u1ee9c c\u1ee7a ma tr\u1eadn thu \u0111\u01b0\u1ee3c t\u1eeb c\u00e1c vector l\u00e0 c\u00e1c c\u1ed9t c\u1ee7a n\u00f3:</p> <pre><code>point3d intersect(point3d a1, point3d n1, point3d a2, point3d n2, point3d a3, point3d n3) {\n    point3d x(n1.x, n2.x, n3.x);\n    point3d y(n1.y, n2.y, n3.y);\n    point3d z(n1.z, n2.z, n3.z); \n    point3d d(dot(a1, n1), dot(a2, n2), dot(a3, n3));\n    return point3d(triple(d, y, z),\n                   triple(x, d, z),\n                   triple(x, y, d)) / triple(n1, n2, n3);\n}\n</code></pre> <p>B\u00e2y gi\u1edd b\u1ea1n c\u00f3 th\u1ec3 c\u1ed1 g\u1eafng t\u1ef1 t\u00ecm ra c\u00e1c c\u00e1ch ti\u1ebfp c\u1eadn cho c\u00e1c ho\u1ea1t \u0111\u1ed9ng h\u00ecnh h\u1ecdc ph\u1ed5 bi\u1ebfn \u0111\u1ec3 l\u00e0m quen v\u1edbi t\u1ea5t c\u1ea3 nh\u1eefng th\u1ee9 n\u00e0y.</p>","tags":["Translated"]},{"location":"geometry/check-segments-intersection.html","title":"Ki\u1ec3m tra hai \u0111o\u1ea1n th\u1eb3ng c\u00f3 c\u1eaft nhau kh\u00f4ng (Check if two segments intersect)","text":"<p>B\u1ea1n \u0111\u01b0\u1ee3c cho hai \u0111o\u1ea1n $(a, b)$ v\u00e0 $(c, d)$. B\u1ea1n ph\u1ea3i ki\u1ec3m tra xem ch\u00fang c\u00f3 giao nhau hay kh\u00f4ng. T\u1ea5t nhi\u00ean, b\u1ea1n c\u00f3 th\u1ec3 t\u00ecm giao \u0111i\u1ec3m c\u1ee7a ch\u00fang v\u00e0 ki\u1ec3m tra xem n\u00f3 c\u00f3 r\u1ed7ng kh\u00f4ng, nh\u01b0ng \u0111i\u1ec1u n\u00e0y kh\u00f4ng th\u1ec3 l\u00e0m \u0111\u01b0\u1ee3c v\u1edbi c\u00e1c s\u1ed1 nguy\u00ean cho c\u00e1c \u0111o\u1ea1n c\u00f3 t\u1ecda \u0111\u1ed9 nguy\u00ean. C\u00e1ch ti\u1ebfp c\u1eadn \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 \u1edf \u0111\u00e2y c\u00f3 th\u1ec3 ho\u1ea1t \u0111\u1ed9ng v\u1edbi c\u00e1c s\u1ed1 nguy\u00ean.</p>","tags":["Translated"]},{"location":"geometry/check-segments-intersection.html#algorithm","title":"Thu\u1eadt to\u00e1n (Algorithm)","text":"<p>\u0110\u1ea7u ti\u00ean, h\u00e3y xem x\u00e9t tr\u01b0\u1eddng h\u1ee3p khi c\u00e1c \u0111o\u1ea1n l\u00e0 m\u1ed9t ph\u1ea7n c\u1ee7a c\u00f9ng m\u1ed9t \u0111\u01b0\u1eddng th\u1eb3ng. Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, ch\u1ec9 c\u1ea7n ki\u1ec3m tra xem h\u00ecnh chi\u1ebfu c\u1ee7a ch\u00fang tr\u00ean $Ox$ v\u00e0 $Oy$ c\u00f3 giao nhau hay kh\u00f4ng. Trong tr\u01b0\u1eddng h\u1ee3p kh\u00e1c $a$ v\u00e0 $b$ kh\u00f4ng \u0111\u01b0\u1ee3c n\u1eb1m c\u00f9ng ph\u00eda so v\u1edbi \u0111\u01b0\u1eddng th\u1eb3ng $(c, d)$, v\u00e0 $c$ v\u00e0 $d$ kh\u00f4ng \u0111\u01b0\u1ee3c n\u1eb1m c\u00f9ng ph\u00eda so v\u1edbi \u0111\u01b0\u1eddng th\u1eb3ng $(a, b)$. N\u00f3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c ki\u1ec3m tra b\u1eb1ng m\u1ed9t v\u00e0i t\u00edch ch\u00e9o (cross products).</p>","tags":["Translated"]},{"location":"geometry/check-segments-intersection.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>Thu\u1eadt to\u00e1n \u0111\u00e3 cho \u0111\u01b0\u1ee3c c\u00e0i \u0111\u1eb7t cho c\u00e1c \u0111i\u1ec3m nguy\u00ean. T\u1ea5t nhi\u00ean, n\u00f3 c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng s\u1eeda \u0111\u1ed5i \u0111\u1ec3 l\u00e0m vi\u1ec7c v\u1edbi s\u1ed1 th\u1ef1c (doubles).</p> <pre><code>struct pt {\n    long long x, y;\n    pt() {}\n    pt(long long _x, long long _y) : x(_x), y(_y) {}\n    pt operator-(const pt&amp; p) const { return pt(x - p.x, y - p.y); }\n    long long cross(const pt&amp; p) const { return x * p.y - y * p.x; }\n    long long cross(const pt&amp; a, const pt&amp; b) const { return (a - *this).cross(b - *this); }\n};\n\nint sgn(const long long&amp; x) { return x &gt;= 0 ? x ? 1 : 0 : -1; }\n\nbool inter1(long long a, long long b, long long c, long long d) {\n    if (a &gt; b)\n        swap(a, b);\n    if (c &gt; d)\n        swap(c, d);\n    return max(a, c) &lt;= min(b, d);\n}\n\nbool check_inter(const pt&amp; a, const pt&amp; b, const pt&amp; c, const pt&amp; d) {\n    if (c.cross(a, d) == 0 &amp;&amp; c.cross(b, d) == 0)\n        return inter1(a.x, b.x, c.x, d.x) &amp;&amp; inter1(a.y, b.y, c.y, d.y);\n    return sgn(a.cross(b, c)) != sgn(a.cross(b, d)) &amp;&amp;\n           sgn(c.cross(d, a)) != sgn(c.cross(d, b));\n}\n</code></pre>","tags":["Translated"]},{"location":"geometry/check-segments-intersection.html#checklist","title":"Checklist","text":"<ul> <li>[x] D\u1ecbch c\u00e1c kh\u00e1i ni\u1ec7m k\u1ef9 thu\u1eadt sang ti\u1ebfng Vi\u1ec7t ch\u00ednh x\u00e1c.</li> <li>[x] \u0110\u00e3 c\u1eadp nh\u1eadt c\u00e1c li\u00ean k\u1ebft n\u1ed9i b\u1ed9 (\u0111\u1ebfn 127.0.0.1:8000).</li> <li>[x] \u0110\u1ecbnh d\u1ea1ng l\u1ea1i c\u00e1c c\u00f4ng th\u1ee9c to\u00e1n h\u1ecdc v\u00e0 code block.</li> <li>[x] Ki\u1ec3m tra ch\u00ednh t\u1ea3 v\u00e0 ng\u1eef ph\u00e1p.</li> <li>[x] \u0110\u1ea3m b\u1ea3o t\u00ednh nh\u1ea5t qu\u00e1n v\u1edbi c\u00e1c thu\u1eadt ng\u1eef \u0111\u00e3 d\u1ecbch kh\u00e1c.</li> </ul>","tags":["Translated"]},{"location":"geometry/circle-circle-intersection.html","title":"Giao \u0111i\u1ec3m c\u1ee7a hai \u0111\u01b0\u1eddng tr\u00f2n (Circle-Circle Intersection)","text":"<p>B\u1ea1n \u0111\u01b0\u1ee3c cho hai \u0111\u01b0\u1eddng tr\u00f2n tr\u00ean m\u1eb7t ph\u1eb3ng 2D, m\u1ed7i \u0111\u01b0\u1eddng tr\u00f2n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 b\u1eb1ng t\u1ecda \u0111\u1ed9 t\u00e2m v\u00e0 b\u00e1n k\u00ednh c\u1ee7a n\u00f3. T\u00ecm c\u00e1c \u0111i\u1ec3m giao nhau c\u1ee7a ch\u00fang (c\u00e1c tr\u01b0\u1eddng h\u1ee3p c\u00f3 th\u1ec3 x\u1ea3y ra: m\u1ed9t ho\u1eb7c hai \u0111i\u1ec3m, kh\u00f4ng giao nhau ho\u1eb7c c\u00e1c \u0111\u01b0\u1eddng tr\u00f2n tr\u00f9ng nhau).</p>","tags":["Translated"]},{"location":"geometry/circle-circle-intersection.html#solution","title":"Gi\u1ea3i ph\u00e1p (Solution)","text":"<p>H\u00e3y quy b\u00e0i to\u00e1n n\u00e0y v\u1ec1 b\u00e0i to\u00e1n giao \u0111i\u1ec3m \u0111\u01b0\u1eddng tr\u00f2n-\u0111\u01b0\u1eddng th\u1eb3ng.</p> <p>Gi\u1ea3 s\u1eed kh\u00f4ng m\u1ea5t t\u00ednh t\u1ed5ng qu\u00e1t r\u1eb1ng \u0111\u01b0\u1eddng tr\u00f2n th\u1ee9 nh\u1ea5t c\u00f3 t\u00e2m t\u1ea1i g\u1ed1c t\u1ecda \u0111\u1ed9 (n\u1ebfu \u0111i\u1ec1u n\u00e0y kh\u00f4ng \u0111\u00fang, ch\u00fang ta c\u00f3 th\u1ec3 di chuy\u1ec3n g\u1ed1c t\u1ecda \u0111\u1ed9 \u0111\u1ebfn t\u00e2m c\u1ee7a \u0111\u01b0\u1eddng tr\u00f2n th\u1ee9 nh\u1ea5t v\u00e0 \u0111i\u1ec1u ch\u1ec9nh t\u1ecda \u0111\u1ed9 c\u1ee7a c\u00e1c \u0111i\u1ec3m giao nhau t\u01b0\u01a1ng \u1ee9ng t\u1ea1i th\u1eddi \u0111i\u1ec3m \u0111\u1ea7u ra). Ch\u00fang ta c\u00f3 m\u1ed9t h\u1ec7 g\u1ed3m hai ph\u01b0\u01a1ng tr\u00ecnh:</p> $$x^2+y^2=r_1^2$$ $$(x - x_2)^2 + (y - y_2)^2 = r_2^2$$ <p>Tr\u1eeb ph\u01b0\u01a1ng tr\u00ecnh th\u1ee9 nh\u1ea5t cho ph\u01b0\u01a1ng tr\u00ecnh th\u1ee9 hai \u0111\u1ec3 lo\u1ea1i b\u1ecf l\u0169y th\u1eeba b\u1eadc hai c\u1ee7a c\u00e1c bi\u1ebfn:</p> $$x^2+y^2=r_1^2$$ $$x \\cdot (-2x_2) + y \\cdot (-2y_2) + (x_2^2+y_2^2+r_1^2-r_2^2) = 0$$ <p>Do \u0111\u00f3, ch\u00fang ta \u0111\u00e3 quy b\u00e0i to\u00e1n ban \u0111\u1ea7u th\u00e0nh b\u00e0i to\u00e1n t\u00ecm giao \u0111i\u1ec3m c\u1ee7a \u0111\u01b0\u1eddng tr\u00f2n th\u1ee9 nh\u1ea5t v\u00e0 m\u1ed9t \u0111\u01b0\u1eddng th\u1eb3ng:</p> $$Ax + By + C = 0$$ $$\\begin{align} A &amp;= -2x_2 \\\\ B &amp;= -2y_2 \\\\ C &amp;= x_2^2+y_2^2+r_1^2-r_2^2 \\end{align}$$ <p>V\u00e0 b\u00e0i to\u00e1n n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i quy\u1ebft nh\u01b0 \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 trong b\u00e0i vi\u1ebft t\u01b0\u01a1ng \u1ee9ng.</p> <p>Tr\u01b0\u1eddng h\u1ee3p suy bi\u1ebfn ( degenerate case) duy nh\u1ea5t ch\u00fang ta c\u1ea7n xem x\u00e9t ri\u00eang l\u00e0 khi t\u00e2m c\u1ee7a c\u00e1c \u0111\u01b0\u1eddng tr\u00f2n tr\u00f9ng nhau. Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y $x_2=y_2=0$, v\u00e0 ph\u01b0\u01a1ng tr\u00ecnh \u0111\u01b0\u1eddng th\u1eb3ng s\u1ebd l\u00e0 $C = r_1^2-r_2^2 = 0$. N\u1ebfu b\u00e1n k\u00ednh c\u1ee7a c\u00e1c \u0111\u01b0\u1eddng tr\u00f2n gi\u1ed1ng nhau, c\u00f3 v\u00f4 h\u1ea1n \u0111i\u1ec3m giao nhau, n\u1ebfu ch\u00fang kh\u00e1c nhau, kh\u00f4ng c\u00f3 giao \u0111i\u1ec3m n\u00e0o.</p>","tags":["Translated"]},{"location":"geometry/circle-circle-intersection.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>RadarFinder</li> <li>Runaway to a shadow - Codeforces Round #357</li> <li>ASC 1 Problem F \"Get out!\"</li> <li>SPOJ: CIRCINT</li> <li>UVA - 10301 - Rings and Glue</li> <li>Codeforces 933C A Colorful Prospect</li> <li>TIMUS 1429 Biscuits</li> </ul>","tags":["Translated"]},{"location":"geometry/circle-line-intersection.html","title":"Giao \u0111i\u1ec3m \u0111\u01b0\u1eddng tr\u00f2n - \u0111\u01b0\u1eddng th\u1eb3ng (Circle-Line Intersection)","text":"<p>Cho t\u1ecda \u0111\u1ed9 c\u1ee7a t\u00e2m m\u1ed9t \u0111\u01b0\u1eddng tr\u00f2n v\u00e0 b\u00e1n k\u00ednh c\u1ee7a n\u00f3, v\u00e0 ph\u01b0\u01a1ng tr\u00ecnh c\u1ee7a m\u1ed9t \u0111\u01b0\u1eddng th\u1eb3ng, b\u1ea1n \u0111\u01b0\u1ee3c y\u00eau c\u1ea7u t\u00ecm c\u00e1c \u0111i\u1ec3m giao nhau.</p>","tags":["Translated"]},{"location":"geometry/circle-line-intersection.html#solution","title":"Gi\u1ea3i ph\u00e1p (Solution)","text":"<p>Thay v\u00ec gi\u1ea3i h\u1ec7 g\u1ed3m hai ph\u01b0\u01a1ng tr\u00ecnh, ch\u00fang ta s\u1ebd ti\u1ebfp c\u1eadn b\u00e0i to\u00e1n b\u1eb1ng h\u00ecnh h\u1ecdc. Theo c\u00e1ch n\u00e0y, ch\u00fang ta c\u00f3 \u0111\u01b0\u1ee3c m\u1ed9t gi\u1ea3i ph\u00e1p ch\u00ednh x\u00e1c h\u01a1n theo quan \u0111i\u1ec3m v\u1ec1 \u0111\u1ed9 \u1ed5n \u0111\u1ecbnh s\u1ed1 h\u1ecdc.</p> <p>Ch\u00fang ta gi\u1ea3 s\u1eed kh\u00f4ng m\u1ea5t t\u00ednh t\u1ed5ng qu\u00e1t r\u1eb1ng \u0111\u01b0\u1eddng tr\u00f2n c\u00f3 t\u00e2m t\u1ea1i g\u1ed1c t\u1ecda \u0111\u1ed9. N\u1ebfu kh\u00f4ng, ch\u00fang ta t\u1ecbnh ti\u1ebfn n\u00f3 \u0111\u1ebfn \u0111\u00f3 v\u00e0 s\u1eeda h\u1eb1ng s\u1ed1 $C$ trong ph\u01b0\u01a1ng tr\u00ecnh \u0111\u01b0\u1eddng th\u1eb3ng. V\u00ec v\u1eady, ch\u00fang ta c\u00f3 m\u1ed9t \u0111\u01b0\u1eddng tr\u00f2n t\u00e2m t\u1ea1i $(0,0)$ b\u00e1n k\u00ednh $r$ v\u00e0 m\u1ed9t \u0111\u01b0\u1eddng th\u1eb3ng c\u00f3 ph\u01b0\u01a1ng tr\u00ecnh $Ax+By+C=0$.</p> <p>H\u00e3y b\u1eaft \u0111\u1ea7u b\u1eb1ng c\u00e1ch t\u00ecm \u0111i\u1ec3m tr\u00ean \u0111\u01b0\u1eddng th\u1eb3ng g\u1ea7n g\u1ed1c t\u1ecda \u0111\u1ed9 nh\u1ea5t $(x_0, y_0)$. \u0110\u1ea7u ti\u00ean, n\u00f3 ph\u1ea3i \u1edf kho\u1ea3ng c\u00e1ch</p> $$ d_0 = \\frac{|C|}{\\sqrt{A^2+B^2}} $$ <p>Th\u1ee9 hai, v\u00ec vector $(A, B)$ vu\u00f4ng g\u00f3c v\u1edbi \u0111\u01b0\u1eddng th\u1eb3ng, t\u1ecda \u0111\u1ed9 c\u1ee7a \u0111i\u1ec3m ph\u1ea3i t\u1ef7 l\u1ec7 v\u1edbi t\u1ecda \u0111\u1ed9 c\u1ee7a vector n\u00e0y. V\u00ec ch\u00fang ta bi\u1ebft kho\u1ea3ng c\u00e1ch c\u1ee7a \u0111i\u1ec3m \u0111\u1ebfn g\u1ed1c t\u1ecda \u0111\u1ed9, ch\u00fang ta ch\u1ec9 c\u1ea7n chia t\u1ef7 l\u1ec7 vector $(A, B)$ theo \u0111\u1ed9 d\u00e0i n\u00e0y, v\u00e0 ch\u00fang ta s\u1ebd nh\u1eadn \u0111\u01b0\u1ee3c:</p> $$\\begin{align} x_0 &amp;= - \\frac{AC}{A^2 + B^2} \\\\ y_0 &amp;= - \\frac{BC}{A^2 + B^2}  \\end{align}$$ <p>C\u00e1c d\u1ea5u tr\u1eeb kh\u00f4ng qu\u00e1 r\u00f5 r\u00e0ng, nh\u01b0ng ch\u00fang c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c ki\u1ec3m ch\u1ee9ng d\u1ec5 d\u00e0ng b\u1eb1ng c\u00e1ch thay $x_0$ v\u00e0 $y_0$ v\u00e0o ph\u01b0\u01a1ng tr\u00ecnh c\u1ee7a \u0111\u01b0\u1eddng th\u1eb3ng.</p> <p>\u1ede giai \u0111o\u1ea1n n\u00e0y ch\u00fang ta c\u00f3 th\u1ec3 x\u00e1c \u0111\u1ecbnh s\u1ed1 l\u01b0\u1ee3ng giao \u0111i\u1ec3m, v\u00e0 th\u1eadm ch\u00ed t\u00ecm gi\u1ea3i ph\u00e1p khi c\u00f3 m\u1ed9t ho\u1eb7c kh\u00f4ng c\u00f3 \u0111i\u1ec3m n\u00e0o. Th\u1eadt v\u1eady, n\u1ebfu kho\u1ea3ng c\u00e1ch t\u1eeb $(x_0, y_0)$ \u0111\u1ebfn g\u1ed1c t\u1ecda \u0111\u1ed9 $d_0$ l\u1edbn h\u01a1n b\u00e1n k\u00ednh $r$, c\u00e2u tr\u1ea3 l\u1eddi l\u00e0 kh\u00f4ng c\u00f3 \u0111i\u1ec3m n\u00e0o. N\u1ebfu $d_0=r$, c\u00e2u tr\u1ea3 l\u1eddi l\u00e0 m\u1ed9t \u0111i\u1ec3m $(x_0, y_0)$. N\u1ebfu $d_0&lt;r$, c\u00f3 hai \u0111i\u1ec3m giao nhau, v\u00e0 b\u00e2y gi\u1edd ch\u00fang ta ph\u1ea3i t\u00ecm t\u1ecda \u0111\u1ed9 c\u1ee7a ch\u00fang.</p> <p>V\u00ec v\u1eady, ch\u00fang ta bi\u1ebft r\u1eb1ng \u0111i\u1ec3m $(x_0, y_0)$ n\u1eb1m b\u00ean trong \u0111\u01b0\u1eddng tr\u00f2n. Hai \u0111i\u1ec3m giao nhau, $(a_x, a_y)$ v\u00e0 $(b_x, b_y)$, ph\u1ea3i thu\u1ed9c \u0111\u01b0\u1eddng th\u1eb3ng $Ax+By+C=0$ v\u00e0 ph\u1ea3i \u1edf c\u00f9ng kho\u1ea3ng c\u00e1ch $d$ t\u1eeb $(x_0, y_0)$, v\u00e0 kho\u1ea3ng c\u00e1ch n\u00e0y r\u1ea5t d\u1ec5 t\u00ecm:</p> $$ d = \\sqrt{r^2 - \\frac{C^2}{A^2 + B^2}} $$ <p>L\u01b0u \u00fd r\u1eb1ng vector $(-B, A)$ c\u00f9ng ph\u01b0\u01a1ng v\u1edbi \u0111\u01b0\u1eddng th\u1eb3ng, v\u00e0 do \u0111\u00f3 ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm c\u00e1c \u0111i\u1ec3m \u0111ang x\u00e9t b\u1eb1ng c\u00e1ch c\u1ed9ng v\u00e0 tr\u1eeb vector $(-B,A)$, \u0111\u01b0\u1ee3c chia t\u1ef7 l\u1ec7 theo \u0111\u1ed9 d\u00e0i $d$, v\u00e0o \u0111i\u1ec3m $(x_0, y_0)$.</p> <p>Cu\u1ed1i c\u00f9ng, c\u00e1c ph\u01b0\u01a1ng tr\u00ecnh c\u1ee7a hai giao \u0111i\u1ec3m l\u00e0:</p> $$\\begin{align} m &amp;= \\sqrt{\\frac{d^2}{A^2 + B^2}} \\\\ a_x &amp;= x_0 + B \\cdot m, a_y = y_0 - A \\cdot m \\\\ b_x &amp;= x_0 - B \\cdot m, b_y = y_0 + A \\cdot m \\end{align}$$ <p>N\u1ebfu ch\u00fang ta gi\u1ea3i h\u1ec7 ph\u01b0\u01a1ng tr\u00ecnh ban \u0111\u1ea7u b\u1eb1ng c\u00e1c ph\u01b0\u01a1ng ph\u00e1p \u0111\u1ea1i s\u1ed1, ch\u00fang ta c\u00f3 th\u1ec3 nh\u1eadn \u0111\u01b0\u1ee3c m\u1ed9t c\u00e2u tr\u1ea3 l\u1eddi \u1edf m\u1ed9t d\u1ea1ng kh\u00e1c v\u1edbi sai s\u1ed1 l\u1edbn h\u01a1n. Ph\u01b0\u01a1ng ph\u00e1p h\u00ecnh h\u1ecdc \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 \u1edf \u0111\u00e2y tr\u1ef1c quan h\u01a1n v\u00e0 ch\u00ednh x\u00e1c h\u01a1n.</p>","tags":["Translated"]},{"location":"geometry/circle-line-intersection.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>Nh\u01b0 \u0111\u00e3 ch\u1ec9 ra \u1edf ph\u1ea7n \u0111\u1ea7u, ch\u00fang ta gi\u1ea3 s\u1eed r\u1eb1ng \u0111\u01b0\u1eddng tr\u00f2n c\u00f3 t\u00e2m t\u1ea1i g\u1ed1c t\u1ecda \u0111\u1ed9, v\u00e0 do \u0111\u00f3 \u0111\u1ea7u v\u00e0o c\u1ee7a ch\u01b0\u01a1ng tr\u00ecnh l\u00e0 b\u00e1n k\u00ednh $r$ c\u1ee7a \u0111\u01b0\u1eddng tr\u00f2n v\u00e0 c\u00e1c tham s\u1ed1 $A$, $B$ v\u00e0 $C$ c\u1ee7a ph\u01b0\u01a1ng tr\u00ecnh \u0111\u01b0\u1eddng th\u1eb3ng.</p> <pre><code>double r, a, b, c; // given as input\ndouble x0 = -a*c/(a*a+b*b), y0 = -b*c/(a*a+b*b);\nif (c*c &gt; r*r*(a*a+b*b)+EPS)\n    puts (\"no points\");\nelse if (abs (c*c - r*r*(a*a+b*b)) &lt; EPS) {\n    puts (\"1 point\");\n    cout &lt;&lt; x0 &lt;&lt; ' ' &lt;&lt; y0 &lt;&lt; '\\n';\n}\nelse {\n    double d = r*r - c*c/(a*a+b*b);\n    double mult = sqrt (d / (a*a+b*b));\n    double ax, ay, bx, by;\n    ax = x0 + b * mult;\n    bx = x0 - b * mult;\n    ay = y0 - a * mult;\n    by = y0 + a * mult;\n    puts (\"2 points\");\n    cout &lt;&lt; ax &lt;&lt; ' ' &lt;&lt; ay &lt;&lt; '\\n' &lt;&lt; bx &lt;&lt; ' ' &lt;&lt; by &lt;&lt; '\\n';\n}\n</code></pre>","tags":["Translated"]},{"location":"geometry/circle-line-intersection.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>CODECHEF: ANDOOR</li> </ul>","tags":["Translated"]},{"location":"geometry/convex-hull.html","title":"X\u00e2y d\u1ef1ng bao l\u1ed3i (Convex Hull construction)","text":"<p>Trong b\u00e0i vi\u1ebft n\u00e0y, ch\u00fang ta s\u1ebd th\u1ea3o lu\u1eadn v\u1ec1 b\u00e0i to\u00e1n x\u00e2y d\u1ef1ng bao l\u1ed3i t\u1eeb m\u1ed9t t\u1eadp h\u1ee3p c\u00e1c \u0111i\u1ec3m.</p> <p>Xem x\u00e9t $N$ \u0111i\u1ec3m \u0111\u01b0\u1ee3c cho tr\u00ean m\u1ed9t m\u1eb7t ph\u1eb3ng, v\u00e0 m\u1ee5c ti\u00eau l\u00e0 t\u1ea1o ra m\u1ed9t bao l\u1ed3i, t\u1ee9c l\u00e0 \u0111a gi\u00e1c l\u1ed3i nh\u1ecf nh\u1ea5t ch\u1ee9a t\u1ea5t c\u1ea3 c\u00e1c \u0111i\u1ec3m \u0111\u00e3 cho.</p> <p>Ch\u00fang ta s\u1ebd xem thu\u1eadt to\u00e1n qu\u00e9t Graham (Graham's scan) \u0111\u01b0\u1ee3c xu\u1ea5t b\u1ea3n n\u0103m 1972 b\u1edfi Graham, v\u00e0 c\u1ea3 thu\u1eadt to\u00e1n chu\u1ed7i \u0111\u01a1n \u0111i\u1ec7u (Monotone chain) \u0111\u01b0\u1ee3c xu\u1ea5t b\u1ea3n n\u0103m 1979 b\u1edfi Andrew. C\u1ea3 hai \u0111\u1ec1u l\u00e0 $\\mathcal{O}(N \\log N)$, v\u00e0 t\u1ed1i \u01b0u v\u1ec1 m\u1eb7t ti\u1ec7m c\u1eadn (v\u00ec \u0111\u00e3 \u0111\u01b0\u1ee3c ch\u1ee9ng minh r\u1eb1ng kh\u00f4ng c\u00f3 thu\u1eadt to\u00e1n n\u00e0o t\u1ed1t h\u01a1n v\u1ec1 m\u1eb7t ti\u1ec7m c\u1eadn), ngo\u1ea1i tr\u1eeb m\u1ed9t v\u00e0i v\u1ea5n \u0111\u1ec1 li\u00ean quan \u0111\u1ebfn x\u1eed l\u00fd song song ho\u1eb7c tr\u1ef1c tuy\u1ebfn.</p>","tags":["Translated"]},{"location":"geometry/convex-hull.html#grahams-scan-algorithm","title":"Thu\u1eadt to\u00e1n qu\u00e9t Graham (Graham's scan Algorithm)","text":"<p>Thu\u1eadt to\u00e1n \u0111\u1ea7u ti\u00ean t\u00ecm \u0111i\u1ec3m d\u01b0\u1edbi c\u00f9ng nh\u1ea5t $P_0$. N\u1ebfu c\u00f3 nhi\u1ec1u \u0111i\u1ec3m c\u00f3 c\u00f9ng t\u1ecda \u0111\u1ed9 Y, \u0111i\u1ec3m c\u00f3 t\u1ecda \u0111\u1ed9 X nh\u1ecf h\u01a1n \u0111\u01b0\u1ee3c xem x\u00e9t. B\u01b0\u1edbc n\u00e0y m\u1ea5t th\u1eddi gian $\\mathcal{O}(N)$.</p> <p>Ti\u1ebfp theo, t\u1ea5t c\u1ea3 c\u00e1c \u0111i\u1ec3m kh\u00e1c \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp theo g\u00f3c c\u1ef1c theo chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3. N\u1ebfu g\u00f3c c\u1ef1c gi\u1eefa hai ho\u1eb7c nhi\u1ec1u \u0111i\u1ec3m gi\u1ed1ng nhau, s\u1ef1 r\u00e0ng bu\u1ed9c s\u1ebd b\u1ecb ph\u00e1 v\u1ee1 b\u1edfi kho\u1ea3ng c\u00e1ch t\u1eeb $P_0$, theo th\u1ee9 t\u1ef1 t\u0103ng d\u1ea7n.</p> <p>Sau \u0111\u00f3, ch\u00fang ta l\u1eb7p qua t\u1eebng \u0111i\u1ec3m m\u1ed9t, v\u00e0 \u0111\u1ea3m b\u1ea3o r\u1eb1ng \u0111i\u1ec3m hi\u1ec7n t\u1ea1i v\u00e0 hai \u0111i\u1ec3m tr\u01b0\u1edbc n\u00f3 t\u1ea1o ra m\u1ed9t b\u01b0\u1edbc ngo\u1eb7t theo chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3, n\u1ebfu kh\u00f4ng \u0111i\u1ec3m tr\u01b0\u1edbc \u0111\u00f3 s\u1ebd b\u1ecb lo\u1ea1i b\u1ecf, v\u00ec n\u00f3 s\u1ebd t\u1ea1o ra m\u1ed9t h\u00ecnh kh\u00f4ng l\u1ed3i. Vi\u1ec7c ki\u1ec3m tra t\u00ednh ch\u1ea5t chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3 ho\u1eb7c ng\u01b0\u1ee3c chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n b\u1eb1ng c\u00e1ch ki\u1ec3m tra h\u01b0\u1edbng (orientation).</p> <p>Ch\u00fang ta s\u1eed d\u1ee5ng m\u1ed9t ng\u0103n x\u1ebfp \u0111\u1ec3 l\u01b0u tr\u1eef c\u00e1c \u0111i\u1ec3m, v\u00e0 khi ch\u00fang ta \u0111\u1ebfn \u0111i\u1ec3m ban \u0111\u1ea7u $P_0$, thu\u1eadt to\u00e1n ho\u00e0n t\u1ea5t v\u00e0 ch\u00fang ta tr\u1ea3 v\u1ec1 ng\u0103n x\u1ebfp ch\u1ee9a t\u1ea5t c\u1ea3 c\u00e1c \u0111i\u1ec3m c\u1ee7a bao l\u1ed3i theo chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3.</p> <p>N\u1ebfu b\u1ea1n c\u1ea7n bao g\u1ed3m c\u00e1c \u0111i\u1ec3m th\u1eb3ng h\u00e0ng (collinear points) trong khi th\u1ef1c hi\u1ec7n qu\u00e9t Graham, b\u1ea1n c\u1ea7n m\u1ed9t b\u01b0\u1edbc kh\u00e1c sau khi s\u1eafp x\u1ebfp. B\u1ea1n c\u1ea7n l\u1ea5y c\u00e1c \u0111i\u1ec3m c\u00f3 kho\u1ea3ng c\u00e1ch c\u1ef1c l\u1edbn nh\u1ea5t t\u1eeb $P_0$ (ch\u00fang ph\u1ea3i \u1edf cu\u1ed1i vect\u01a1 \u0111\u00e3 s\u1eafp x\u1ebfp) v\u00e0 th\u1eb3ng h\u00e0ng. C\u00e1c \u0111i\u1ec3m trong d\u00f2ng n\u00e0y ph\u1ea3i \u0111\u01b0\u1ee3c \u0111\u1ea3o ng\u01b0\u1ee3c \u0111\u1ec3 ch\u00fang ta c\u00f3 th\u1ec3 \u0111\u01b0a ra t\u1ea5t c\u1ea3 c\u00e1c \u0111i\u1ec3m th\u1eb3ng h\u00e0ng, n\u1ebfu kh\u00f4ng thu\u1eadt to\u00e1n s\u1ebd l\u1ea5y \u0111i\u1ec3m g\u1ea7n nh\u1ea5t trong d\u00f2ng n\u00e0y v\u00e0 tho\u00e1t. B\u01b0\u1edbc n\u00e0y kh\u00f4ng n\u00ean \u0111\u01b0\u1ee3c \u0111\u01b0a v\u00e0o phi\u00ean b\u1ea3n kh\u00f4ng th\u1eb3ng h\u00e0ng c\u1ee7a thu\u1eadt to\u00e1n, n\u1ebfu kh\u00f4ng b\u1ea1n s\u1ebd kh\u00f4ng nh\u1eadn \u0111\u01b0\u1ee3c bao l\u1ed3i nh\u1ecf nh\u1ea5t.</p>","tags":["Translated"]},{"location":"geometry/convex-hull.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<pre><code>struct pt {\n    double x, y;\n    bool operator == (pt const&amp; t) const {\n        return x == t.x &amp;&amp; y == t.y;\n    }\n};\n\nint orientation(pt a, pt b, pt c) {\n    double v = a.x*(b.y-c.y)+b.x*(c.y-a.y)+c.x*(a.y-b.y);\n    if (v &lt; 0) return -1; // clockwise\n    if (v &gt; 0) return +1; // counter-clockwise\n    return 0;\n}\n\nbool cw(pt a, pt b, pt c, bool include_collinear) {\n    int o = orientation(a, b, c);\n    return o &lt; 0 || (include_collinear &amp;&amp; o == 0);\n}\nbool collinear(pt a, pt b, pt c) { return orientation(a, b, c) == 0; }\n\nvoid convex_hull(vector&lt;pt&gt;&amp; a, bool include_collinear = false) {\n    pt p0 = *min_element(a.begin(), a.end(), [](pt a, pt b) {\n        return make_pair(a.y, a.x) &lt; make_pair(b.y, b.x);\n    });\n    sort(a.begin(), a.end(), [&amp;p0](const pt&amp; a, const pt&amp; b) {\n        int o = orientation(p0, a, b);\n        if (o == 0)\n            return (p0.x-a.x)*(p0.x-a.x) + (p0.y-a.y)*(p0.y-a.y)\n                &lt; (p0.x-b.x)*(p0.x-b.x) + (p0.y-b.y)*(p0.y-b.y);\n        return o &lt; 0;\n    });\n    if (include_collinear) {\n        int i = (int)a.size()-1;\n        while (i &gt;= 0 &amp;&amp; collinear(p0, a[i], a.back())) i--;\n        reverse(a.begin()+i+1, a.end());\n    }\n\n    vector&lt;pt&gt; st;\n    for (int i = 0; i &lt; (int)a.size(); i++) {\n        while (st.size() &gt; 1 &amp;&amp; !cw(st[st.size()-2], st.back(), a[i], include_collinear))\n            st.pop_back();\n        st.push_back(a[i]);\n    }\n\n    if (include_collinear == false &amp;&amp; st.size() == 2 &amp;&amp; st[0] == st[1])\n        st.pop_back();\n\n    a = st;\n}\n</code></pre>","tags":["Translated"]},{"location":"geometry/convex-hull.html#monotone-chain-algorithm","title":"Thu\u1eadt to\u00e1n chu\u1ed7i \u0111\u01a1n \u0111i\u1ec7u (Monotone chain Algorithm)","text":"<p>Thu\u1eadt to\u00e1n \u0111\u1ea7u ti\u00ean t\u00ecm c\u00e1c \u0111i\u1ec3m ngo\u00e0i c\u00f9ng b\u00ean tr\u00e1i v\u00e0 ngo\u00e0i c\u00f9ng b\u00ean ph\u1ea3i A v\u00e0 B. Trong tr\u01b0\u1eddng h\u1ee3p t\u1ed3n t\u1ea1i nhi\u1ec1u \u0111i\u1ec3m nh\u01b0 v\u1eady, \u0111i\u1ec3m th\u1ea5p nh\u1ea5t trong s\u1ed1 b\u00ean tr\u00e1i (t\u1ecda \u0111\u1ed9 Y th\u1ea5p nh\u1ea5t) \u0111\u01b0\u1ee3c l\u1ea5y l\u00e0m A, v\u00e0 \u0111i\u1ec3m cao nh\u1ea5t trong s\u1ed1 b\u00ean ph\u1ea3i (t\u1ecda \u0111\u1ed9 Y cao nh\u1ea5t) \u0111\u01b0\u1ee3c l\u1ea5y l\u00e0m B. R\u00f5 r\u00e0ng, A v\u00e0 B \u0111\u1ec1u ph\u1ea3i thu\u1ed9c v\u1ec1 bao l\u1ed3i v\u00ec ch\u00fang \u1edf xa nh\u1ea5t v\u00e0 ch\u00fang kh\u00f4ng th\u1ec3 \u0111\u01b0\u1ee3c ch\u1ee9a b\u1edfi b\u1ea5t k\u1ef3 \u0111\u01b0\u1eddng th\u1eb3ng n\u00e0o \u0111\u01b0\u1ee3c t\u1ea1o b\u1edfi m\u1ed9t c\u1eb7p trong s\u1ed1 c\u00e1c \u0111i\u1ec3m \u0111\u00e3 cho.</p> <p>B\u00e2y gi\u1edd, v\u1ebd m\u1ed9t \u0111\u01b0\u1eddng th\u1eb3ng qua AB. \u0110i\u1ec1u n\u00e0y chia t\u1ea5t c\u1ea3 c\u00e1c \u0111i\u1ec3m kh\u00e1c th\u00e0nh hai t\u1eadp h\u1ee3p, S1 v\u00e0 S2, trong \u0111\u00f3 S1 ch\u1ee9a t\u1ea5t c\u1ea3 c\u00e1c \u0111i\u1ec3m ph\u00eda tr\u00ean \u0111\u01b0\u1eddng th\u1eb3ng n\u1ed1i A v\u00e0 B, v\u00e0 S2 ch\u1ee9a t\u1ea5t c\u1ea3 c\u00e1c \u0111i\u1ec3m ph\u00eda d\u01b0\u1edbi \u0111\u01b0\u1eddng th\u1eb3ng n\u1ed1i A v\u00e0 B. C\u00e1c \u0111i\u1ec3m n\u1eb1m tr\u00ean \u0111\u01b0\u1eddng th\u1eb3ng n\u1ed1i A v\u00e0 B c\u00f3 th\u1ec3 thu\u1ed9c v\u1ec1 c\u1ea3 hai t\u1eadp h\u1ee3p. C\u00e1c \u0111i\u1ec3m A v\u00e0 B thu\u1ed9c v\u1ec1 c\u1ea3 hai t\u1eadp h\u1ee3p. B\u00e2y gi\u1edd thu\u1eadt to\u00e1n x\u00e2y d\u1ef1ng t\u1eadp h\u1ee3p tr\u00ean S1 v\u00e0 t\u1eadp h\u1ee3p d\u01b0\u1edbi S2 v\u00e0 sau \u0111\u00f3 k\u1ebft h\u1ee3p ch\u00fang \u0111\u1ec3 thu \u0111\u01b0\u1ee3c c\u00e2u tr\u1ea3 l\u1eddi.</p> <p>\u0110\u1ec3 c\u00f3 \u0111\u01b0\u1ee3c t\u1eadp h\u1ee3p tr\u00ean (upper set), ch\u00fang ta s\u1eafp x\u1ebfp t\u1ea5t c\u1ea3 c\u00e1c \u0111i\u1ec3m theo t\u1ecda \u0111\u1ed9 x. \u0110\u1ed1i v\u1edbi m\u1ed7i \u0111i\u1ec3m, ch\u00fang ta ki\u1ec3m tra xem ho\u1eb7c - \u0111i\u1ec3m hi\u1ec7n t\u1ea1i l\u00e0 \u0111i\u1ec3m cu\u1ed1i c\u00f9ng (m\u00e0 ch\u00fang ta \u0111\u00e3 x\u00e1c \u0111\u1ecbnh l\u00e0 B), ho\u1eb7c h\u01b0\u1edbng gi\u1eefa \u0111\u01b0\u1eddng th\u1eb3ng gi\u1eefa A v\u00e0 \u0111i\u1ec3m hi\u1ec7n t\u1ea1i v\u00e0 \u0111\u01b0\u1eddng th\u1eb3ng gi\u1eefa \u0111i\u1ec3m hi\u1ec7n t\u1ea1i v\u00e0 B l\u00e0 theo chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3. Trong nh\u1eefng tr\u01b0\u1eddng h\u1ee3p \u0111\u00f3, \u0111i\u1ec3m hi\u1ec7n t\u1ea1i thu\u1ed9c v\u1ec1 t\u1eadp h\u1ee3p tr\u00ean S1. Vi\u1ec7c ki\u1ec3m tra t\u00ednh ch\u1ea5t chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3 ho\u1eb7c ng\u01b0\u1ee3c chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n b\u1eb1ng c\u00e1ch ki\u1ec3m tra h\u01b0\u1edbng.</p> <p>N\u1ebfu \u0111i\u1ec3m \u0111\u00e3 cho thu\u1ed9c v\u1ec1 t\u1eadp h\u1ee3p tr\u00ean, ch\u00fang ta ki\u1ec3m tra g\u00f3c \u0111\u01b0\u1ee3c t\u1ea1o b\u1edfi \u0111\u01b0\u1eddng th\u1eb3ng n\u1ed1i \u0111i\u1ec3m \u00e1p ch\u00f3t (second last point) v\u00e0 \u0111i\u1ec3m cu\u1ed1i c\u00f9ng trong bao l\u1ed3i tr\u00ean, v\u1edbi \u0111\u01b0\u1eddng th\u1eb3ng n\u1ed1i \u0111i\u1ec3m cu\u1ed1i c\u00f9ng trong bao l\u1ed3i tr\u00ean v\u00e0 \u0111i\u1ec3m hi\u1ec7n t\u1ea1i. N\u1ebfu g\u00f3c kh\u00f4ng theo chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3, ch\u00fang ta lo\u1ea1i b\u1ecf \u0111i\u1ec3m g\u1ea7n \u0111\u00e2y nh\u1ea5t \u0111\u01b0\u1ee3c th\u00eam v\u00e0o bao l\u1ed3i tr\u00ean v\u00ec \u0111i\u1ec3m hi\u1ec7n t\u1ea1i s\u1ebd c\u00f3 th\u1ec3 ch\u1ee9a \u0111i\u1ec3m tr\u01b0\u1edbc \u0111\u00f3 sau khi n\u00f3 \u0111\u01b0\u1ee3c th\u00eam v\u00e0o bao l\u1ed3i.</p> <p>L logic t\u01b0\u01a1ng t\u1ef1 \u00e1p d\u1ee5ng cho t\u1eadp h\u1ee3p d\u01b0\u1edbi S2. N\u1ebfu ho\u1eb7c - \u0111i\u1ec3m hi\u1ec7n t\u1ea1i l\u00e0 B, ho\u1eb7c h\u01b0\u1edbng c\u1ee7a c\u00e1c \u0111\u01b0\u1eddng th\u1eb3ng, \u0111\u01b0\u1ee3c h\u00ecnh th\u00e0nh b\u1edfi A v\u00e0 \u0111i\u1ec3m hi\u1ec7n t\u1ea1i v\u00e0 \u0111i\u1ec3m hi\u1ec7n t\u1ea1i v\u00e0 B, l\u00e0 ng\u01b0\u1ee3c chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3 - th\u00ec n\u00f3 thu\u1ed9c v\u1ec1 S2.</p> <p>N\u1ebfu \u0111i\u1ec3m \u0111\u00e3 cho thu\u1ed9c v\u1ec1 t\u1eadp h\u1ee3p d\u01b0\u1edbi, ch\u00fang ta h\u00e0nh \u0111\u1ed9ng t\u01b0\u01a1ng t\u1ef1 nh\u01b0 \u0111\u1ed1i v\u1edbi m\u1ed9t \u0111i\u1ec3m tr\u00ean t\u1eadp h\u1ee3p tr\u00ean ngo\u1ea1i tr\u1eeb vi\u1ec7c ch\u00fang ta ki\u1ec3m tra h\u01b0\u1edbng ng\u01b0\u1ee3c chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3 thay v\u00ec h\u01b0\u1edbng chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3. Do \u0111\u00f3, n\u1ebfu g\u00f3c \u0111\u01b0\u1ee3c t\u1ea1o b\u1edfi \u0111\u01b0\u1eddng th\u1eb3ng n\u1ed1i \u0111i\u1ec3m \u00e1p ch\u00f3t v\u00e0 \u0111i\u1ec3m cu\u1ed1i c\u00f9ng trong bao l\u1ed3i d\u01b0\u1edbi, v\u1edbi \u0111\u01b0\u1eddng th\u1eb3ng n\u1ed1i \u0111i\u1ec3m cu\u1ed1i c\u00f9ng trong bao l\u1ed3i d\u01b0\u1edbi v\u00e0 \u0111i\u1ec3m hi\u1ec7n t\u1ea1i kh\u00f4ng ng\u01b0\u1ee3c chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3, ch\u00fang ta lo\u1ea1i b\u1ecf \u0111i\u1ec3m g\u1ea7n \u0111\u00e2y nh\u1ea5t \u0111\u01b0\u1ee3c th\u00eam v\u00e0o bao l\u1ed3i d\u01b0\u1edbi v\u00ec \u0111i\u1ec3m hi\u1ec7n t\u1ea1i s\u1ebd c\u00f3 th\u1ec3 ch\u1ee9a \u0111i\u1ec3m tr\u01b0\u1edbc \u0111\u00f3 sau khi th\u00eam v\u00e0o bao.</p> <p>Bao l\u1ed3i cu\u1ed1i c\u00f9ng thu \u0111\u01b0\u1ee3c t\u1eeb s\u1ef1 h\u1ee3p nh\u1ea5t c\u1ee7a bao l\u1ed3i tr\u00ean v\u00e0 d\u01b0\u1edbi, t\u1ea1o th\u00e0nh m\u1ed9t bao theo chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3, v\u00e0 vi\u1ec7c c\u00e0i \u0111\u1eb7t nh\u01b0 sau.</p> <p>N\u1ebfu b\u1ea1n c\u1ea7n c\u00e1c \u0111i\u1ec3m th\u1eb3ng h\u00e0ng, b\u1ea1n ch\u1ec9 c\u1ea7n ki\u1ec3m tra ch\u00fang trong c\u00e1c quy tr\u00ecnh chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3/ng\u01b0\u1ee3c chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3. Tuy nhi\u00ean, \u0111i\u1ec1u n\u00e0y cho ph\u00e9p m\u1ed9t tr\u01b0\u1eddng h\u1ee3p suy bi\u1ebfn trong \u0111\u00f3 t\u1ea5t c\u1ea3 c\u00e1c \u0111i\u1ec3m \u0111\u1ea7u v\u00e0o th\u1eb3ng h\u00e0ng trong m\u1ed9t d\u00f2ng duy nh\u1ea5t, v\u00e0 thu\u1eadt to\u00e1n s\u1ebd \u0111\u01b0a ra c\u00e1c \u0111i\u1ec3m l\u1eb7p l\u1ea1i. \u0110\u1ec3 gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 n\u00e0y, ch\u00fang ta ki\u1ec3m tra xem bao tr\u00ean c\u00f3 ch\u1ee9a t\u1ea5t c\u1ea3 c\u00e1c \u0111i\u1ec3m hay kh\u00f4ng, v\u00e0 n\u1ebfu c\u00f3, ch\u00fang ta ch\u1ec9 tr\u1ea3 v\u1ec1 c\u00e1c \u0111i\u1ec3m theo th\u1ee9 t\u1ef1 ng\u01b0\u1ee3c l\u1ea1i, v\u00ec \u0111\u00f3 l\u00e0 nh\u1eefng g\u00ec vi\u1ec7c c\u00e0i \u0111\u1eb7t c\u1ee7a Graham s\u1ebd tr\u1ea3 v\u1ec1 trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y.</p>","tags":["Translated"]},{"location":"geometry/convex-hull.html#implementation-1","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<pre><code>struct pt {\n    double x, y;\n};\n\nint orientation(pt a, pt b, pt c) {\n    double v = a.x*(b.y-c.y)+b.x*(c.y-a.y)+c.x*(a.y-b.y);\n    if (v &lt; 0) return -1; // clockwise\n    if (v &gt; 0) return +1; // counter-clockwise\n    return 0;\n}\n\nbool cw(pt a, pt b, pt c, bool include_collinear) {\n    int o = orientation(a, b, c);\n    return o &lt; 0 || (include_collinear &amp;&amp; o == 0);\n}\nbool ccw(pt a, pt b, pt c, bool include_collinear) {\n    int o = orientation(a, b, c);\n    return o &gt; 0 || (include_collinear &amp;&amp; o == 0);\n}\n\nvoid convex_hull(vector&lt;pt&gt;&amp; a, bool include_collinear = false) {\n    if (a.size() == 1)\n        return;\n\n    sort(a.begin(), a.end(), [](pt a, pt b) {\n        return make_pair(a.x, a.y) &lt; make_pair(b.x, b.y);\n    });\n    pt p1 = a[0], p2 = a.back();\n    vector&lt;pt&gt; up, down;\n    up.push_back(p1);\n    down.push_back(p1);\n    for (int i = 1; i &lt; (int)a.size(); i++) {\n        if (i == a.size() - 1 || cw(p1, a[i], p2, include_collinear)) {\n            while (up.size() &gt;= 2 &amp;&amp; !cw(up[up.size()-2], up[up.size()-1], a[i], include_collinear))\n                up.pop_back();\n            up.push_back(a[i]);\n        }\n        if (i == a.size() - 1 || ccw(p1, a[i], p2, include_collinear)) {\n            while (down.size() &gt;= 2 &amp;&amp; !ccw(down[down.size()-2], down[down.size()-1], a[i], include_collinear))\n                down.pop_back();\n            down.push_back(a[i]);\n        }\n    }\n\n    if (include_collinear &amp;&amp; up.size() == a.size()) {\n        reverse(a.begin(), a.end());\n        return;\n    }\n    a.clear();\n    for (int i = 0; i &lt; (int)up.size(); i++)\n        a.push_back(up[i]);\n    for (int i = down.size() - 2; i &gt; 0; i--)\n        a.push_back(down[i]);\n}\n</code></pre>","tags":["Translated"]},{"location":"geometry/convex-hull.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>Kattis - Convex Hull</li> <li>Kattis - Keep the Parade Safe</li> <li>Codeforces - I. Birthday</li> <li>Latin American Regionals 2006 - Onion Layers</li> <li>Timus 1185: Wall</li> <li>Usaco 2014 January Contest, Gold - Cow Curling</li> </ul>","tags":["Translated"]},{"location":"geometry/convex_hull_trick.html","title":"Th\u1ee7 thu\u1eadt bao l\u1ed3i v\u00e0 C\u00e2y Li Chao (Convex hull trick and Li Chao tree)","text":"<p>H\u00e3y xem x\u00e9t b\u00e0i to\u00e1n sau. C\u00f3 $n$ th\u00e0nh ph\u1ed1. B\u1ea1n mu\u1ed1n \u0111i t\u1eeb th\u00e0nh ph\u1ed1 $1$ \u0111\u1ebfn th\u00e0nh ph\u1ed1 $n$ b\u1eb1ng \u00f4 t\u00f4. \u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y, b\u1ea1n ph\u1ea3i mua m\u1ed9t \u00edt x\u0103ng. Ng\u01b0\u1eddi ta bi\u1ebft r\u1eb1ng m\u1ed9t l\u00edt x\u0103ng c\u00f3 gi\u00e1 $cost_k$ t\u1ea1i th\u00e0nh ph\u1ed1 th\u1ee9 $k$. Ban \u0111\u1ea7u th\u00f9ng nhi\u00ean li\u1ec7u c\u1ee7a b\u1ea1n tr\u1ed1ng r\u1ed7ng v\u00e0 b\u1ea1n ti\u00eau t\u1ed1n m\u1ed9t l\u00edt x\u0103ng cho m\u1ed7i km. C\u00e1c th\u00e0nh ph\u1ed1 n\u1eb1m tr\u00ean c\u00f9ng m\u1ed9t \u0111\u01b0\u1eddng th\u1eb3ng theo th\u1ee9 t\u1ef1 t\u0103ng d\u1ea7n v\u1edbi th\u00e0nh ph\u1ed1 th\u1ee9 $k$ c\u00f3 t\u1ecda \u0111\u1ed9 $x_k$. Ngo\u00e0i ra b\u1ea1n ph\u1ea3i tr\u1ea3 $toll_k$ \u0111\u1ec3 v\u00e0o th\u00e0nh ph\u1ed1 th\u1ee9 $k$. Nhi\u1ec7m v\u1ee5 c\u1ee7a b\u1ea1n l\u00e0 th\u1ef1c hi\u1ec7n chuy\u1ebfn \u0111i v\u1edbi chi ph\u00ed th\u1ea5p nh\u1ea5t c\u00f3 th\u1ec3. R\u00f5 r\u00e0ng l\u00e0 gi\u1ea3i ph\u00e1p c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n th\u00f4ng qua quy ho\u1ea1ch \u0111\u1ed9ng:</p> $$dp_i = toll_i+\\min\\limits_{j&lt;i}(cost_j \\cdot (x_i - x_j)+dp_j)$$ <p>C\u00e1ch ti\u1ebfp c\u1eadn ng\u00e2y th\u01a1 (naive) s\u1ebd cho b\u1ea1n \u0111\u1ed9 ph\u1ee9c t\u1ea1p $O(n^2)$, c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c c\u1ea3i thi\u1ec7n th\u00e0nh $O(n \\log n)$ ho\u1eb7c $O(n \\log [C \\varepsilon^{-1}])$ trong \u0111\u00f3 $C$ l\u00e0 gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t c\u00f3 th\u1ec3 c\u00f3 c\u1ee7a $|x_i|$ v\u00e0 $\\varepsilon$ l\u00e0 \u0111\u1ed9 ch\u00ednh x\u00e1c m\u00e0 $x_i$ \u0111\u01b0\u1ee3c xem x\u00e9t ($\\varepsilon = 1$ cho c\u00e1c s\u1ed1 nguy\u00ean, th\u01b0\u1eddng l\u00e0 tr\u01b0\u1eddng h\u1ee3p n\u00e0y). \u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y, ng\u01b0\u1eddi ta n\u00ean l\u01b0u \u00fd r\u1eb1ng b\u00e0i to\u00e1n c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c quy v\u1ec1 vi\u1ec7c th\u00eam c\u00e1c h\u00e0m tuy\u1ebfn t\u00ednh $k \\cdot x + b$ v\u00e0o t\u1eadp h\u1ee3p v\u00e0 t\u00ecm gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t c\u1ee7a c\u00e1c h\u00e0m t\u1ea1i m\u1ed9t \u0111i\u1ec3m $x$ c\u1ee5 th\u1ec3. C\u00f3 hai c\u00e1ch ti\u1ebfp c\u1eadn ch\u00ednh ng\u01b0\u1eddi ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng \u1edf \u0111\u00e2y.</p>","tags":["Translated"]},{"location":"geometry/convex_hull_trick.html#convex-hull-trick","title":"Th\u1ee7 thu\u1eadt bao l\u1ed3i (Convex hull trick)","text":"<p>\u00dd t\u01b0\u1edfng c\u1ee7a c\u00e1ch ti\u1ebfp c\u1eadn n\u00e0y l\u00e0 duy tr\u00ec m\u1ed9t bao l\u1ed3i d\u01b0\u1edbi (lower convex hull) c\u1ee7a c\u00e1c h\u00e0m tuy\u1ebfn t\u00ednh. Th\u1ef1c ra s\u1ebd thu\u1eadn ti\u1ec7n h\u01a1n m\u1ed9t ch\u00fat n\u1ebfu coi ch\u00fang kh\u00f4ng ph\u1ea3i l\u00e0 c\u00e1c h\u00e0m tuy\u1ebfn t\u00ednh, m\u00e0 l\u00e0 c\u00e1c \u0111i\u1ec3m $(k;b)$ tr\u00ean m\u1eb7t ph\u1eb3ng sao cho ch\u00fang ta s\u1ebd ph\u1ea3i t\u00ecm \u0111i\u1ec3m c\u00f3 t\u00edch v\u00f4 h\u01b0\u1edbng nh\u1ecf nh\u1ea5t v\u1edbi m\u1ed9t \u0111i\u1ec3m \u0111\u00e3 cho $(x;1)$, ngh\u0129a l\u00e0, \u0111\u1ed1i v\u1edbi \u0111i\u1ec3m n\u00e0y $kx+b$ \u0111\u01b0\u1ee3c t\u1ed1i thi\u1ec3u h\u00f3a, c\u0169ng ch\u00ednh l\u00e0 b\u00e0i to\u00e1n ban \u0111\u1ea7u. Gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t nh\u01b0 v\u1eady nh\u1ea5t thi\u1ebft s\u1ebd n\u1eb1m tr\u00ean bao l\u1ed3i d\u01b0\u1edbi c\u1ee7a c\u00e1c \u0111i\u1ec3m n\u00e0y nh\u01b0 c\u00f3 th\u1ec3 th\u1ea5y b\u00ean d\u01b0\u1edbi:</p> <p> </p> <p>Ng\u01b0\u1eddi ta ph\u1ea3i gi\u1eef c\u00e1c \u0111i\u1ec3m tr\u00ean bao l\u1ed3i v\u00e0 c\u00e1c vector ph\u00e1p tuy\u1ebfn c\u1ee7a c\u00e1c c\u1ea1nh c\u1ee7a bao. Khi b\u1ea1n c\u00f3 m\u1ed9t truy v\u1ea5n $(x;1)$, b\u1ea1n s\u1ebd ph\u1ea3i t\u00ecm vector ph\u00e1p tuy\u1ebfn g\u1ea7n nh\u1ea5t v\u1edbi n\u00f3 v\u1ec1 m\u1eb7t g\u00f3c gi\u1eefa ch\u00fang, sau \u0111\u00f3 h\u00e0m tuy\u1ebfn t\u00ednh t\u1ed1i \u01b0u s\u1ebd t\u01b0\u01a1ng \u1ee9ng v\u1edbi m\u1ed9t trong c\u00e1c \u0111i\u1ec3m \u0111\u1ea7u m\u00fat c\u1ee7a n\u00f3. \u0110\u1ec3 th\u1ea5y \u0111i\u1ec1u \u0111\u00f3, ng\u01b0\u1eddi ta n\u00ean l\u01b0u \u00fd r\u1eb1ng c\u00e1c \u0111i\u1ec3m c\u00f3 t\u00edch v\u00f4 h\u01b0\u1edbng kh\u00f4ng \u0111\u1ed5i v\u1edbi $(x;1)$ n\u1eb1m tr\u00ean m\u1ed9t \u0111\u01b0\u1eddng th\u1eb3ng tr\u1ef1c giao v\u1edbi $(x;1)$, v\u00ec v\u1eady h\u00e0m tuy\u1ebfn t\u00ednh t\u1ed1i \u01b0u s\u1ebd l\u00e0 h\u00e0m m\u00e0 ti\u1ebfp tuy\u1ebfn v\u1edbi bao l\u1ed3i c\u00f9ng ph\u01b0\u01a1ng v\u1edbi ph\u00e1p tuy\u1ebfn t\u1edbi $(x;1)$ ch\u1ea1m v\u00e0o bao. \u0110i\u1ec3m n\u00e0y l\u00e0 \u0111i\u1ec3m sao cho c\u00e1c ph\u00e1p tuy\u1ebfn c\u1ee7a c\u00e1c c\u1ea1nh n\u1eb1m \u1edf b\u00ean tr\u00e1i v\u00e0 b\u00ean ph\u1ea3i c\u1ee7a n\u00f3 h\u01b0\u1edbng v\u1ec1 c\u00e1c ph\u00eda kh\u00e1c nhau c\u1ee7a $(x;1)$.</p> <p>C\u00e1ch ti\u1ebfp c\u1eadn n\u00e0y h\u1eefu \u00edch khi c\u00e1c truy v\u1ea5n th\u00eam c\u00e1c h\u00e0m tuy\u1ebfn t\u00ednh l\u00e0 \u0111\u01a1n \u0111i\u1ec7u theo $k$ ho\u1eb7c n\u1ebfu ch\u00fang ta l\u00e0m vi\u1ec7c offline, t\u1ee9c l\u00e0 ch\u00fang ta c\u00f3 th\u1ec3 th\u00eam t\u1ea5t c\u1ea3 c\u00e1c h\u00e0m tuy\u1ebfn t\u00ednh tr\u01b0\u1edbc v\u00e0 tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n sau \u0111\u00f3. V\u00ec v\u1eady, ch\u00fang ta kh\u00f4ng th\u1ec3 gi\u1ea3i quy\u1ebft c\u00e1c v\u1ea5n \u0111\u1ec1 th\u00e0nh ph\u1ed1/x\u0103ng d\u1ea7u b\u1eb1ng c\u00e1ch n\u00e0y. \u0110i\u1ec1u \u0111\u00f3 \u0111\u00f2i h\u1ecfi ph\u1ea3i x\u1eed l\u00fd c\u00e1c truy v\u1ea5n online. Tuy nhi\u00ean, khi n\u00f3i \u0111\u1ebfn vi\u1ec7c x\u1eed l\u00fd c\u00e1c truy v\u1ea5n online, m\u1ecdi th\u1ee9 s\u1ebd tr\u1edf n\u00ean kh\u00f3 kh\u0103n v\u00e0 ng\u01b0\u1eddi ta s\u1ebd ph\u1ea3i s\u1eed d\u1ee5ng m\u1ed9t s\u1ed1 lo\u1ea1i c\u1ea5u tr\u00fac d\u1eef li\u1ec7u t\u1eadp h\u1ee3p \u0111\u1ec3 c\u00e0i \u0111\u1eb7t m\u1ed9t bao l\u1ed3i th\u00edch h\u1ee3p. Tuy nhi\u00ean, c\u00e1ch ti\u1ebfp c\u1eadn online s\u1ebd kh\u00f4ng \u0111\u01b0\u1ee3c xem x\u00e9t trong b\u00e0i vi\u1ebft n\u00e0y do \u0111\u1ed9 kh\u00f3 c\u1ee7a n\u00f3 v\u00e0 v\u00ec c\u00e1ch ti\u1ebfp c\u1eadn th\u1ee9 hai (\u0111\u00f3 l\u00e0 c\u00e2y Li Chao) cho ph\u00e9p gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 \u0111\u01a1n gi\u1ea3n h\u01a1n nhi\u1ec1u. \u0110\u00e1ng ch\u00fa \u00fd l\u00e0 ng\u01b0\u1eddi ta v\u1eabn c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng c\u00e1ch ti\u1ebfp c\u1eadn n\u00e0y online m\u00e0 kh\u00f4ng g\u1eb7p bi\u1ebfn ch\u1ee9ng b\u1eb1ng c\u00e1ch ph\u00e2n r\u00e3 c\u0103n b\u1eadc hai (square-root-decomposition). Ngh\u0129a l\u00e0, x\u00e2y d\u1ef1ng l\u1ea1i bao l\u1ed3i t\u1eeb \u0111\u1ea7u m\u1ed7i khi c\u00f3 $\\sqrt n$ \u0111\u01b0\u1eddng th\u1eb3ng m\u1edbi.</p> <p>\u0110\u1ec3 c\u00e0i \u0111\u1eb7t c\u00e1ch ti\u1ebfp c\u1eadn n\u00e0y, ng\u01b0\u1eddi ta n\u00ean b\u1eaft \u0111\u1ea7u v\u1edbi m\u1ed9t s\u1ed1 h\u00e0m ti\u1ec7n \u00edch h\u00ecnh h\u1ecdc, \u1edf \u0111\u00e2y ch\u00fang t\u00f4i khuy\u00ean b\u1ea1n n\u00ean s\u1eed d\u1ee5ng ki\u1ec3u s\u1ed1 ph\u1ee9c C++.</p> <pre><code>typedef int ftype;\ntypedef complex&lt;ftype&gt; point;\n#define x real\n#define y imag\n\nftype dot(point a, point b) {\n    return (conj(a) * b).x();\n}\n\nftype cross(point a, point b) {\n    return (conj(a) * b).y();\n}\n</code></pre> <p>\u1ede \u0111\u00e2y ch\u00fang ta s\u1ebd gi\u1ea3 s\u1eed r\u1eb1ng khi c\u00e1c h\u00e0m tuy\u1ebfn t\u00ednh \u0111\u01b0\u1ee3c th\u00eam v\u00e0o, $k$ c\u1ee7a ch\u00fang ch\u1ec9 t\u0103ng v\u00e0 ch\u00fang ta mu\u1ed1n t\u00ecm c\u00e1c gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t. Ch\u00fang ta s\u1ebd gi\u1eef c\u00e1c \u0111i\u1ec3m trong vector <code>hull</code> v\u00e0 c\u00e1c vector ph\u00e1p tuy\u1ebfn trong vector <code>vecs</code>. Khi ch\u00fang ta th\u00eam m\u1ed9t \u0111i\u1ec3m m\u1edbi, ch\u00fang ta ph\u1ea3i xem x\u00e9t g\u00f3c \u0111\u01b0\u1ee3c t\u1ea1o ra gi\u1eefa c\u1ea1nh cu\u1ed1i c\u00f9ng trong bao l\u1ed3i v\u00e0 vector t\u1eeb \u0111i\u1ec3m cu\u1ed1i c\u00f9ng trong bao l\u1ed3i \u0111\u1ebfn \u0111i\u1ec3m m\u1edbi. G\u00f3c n\u00e0y ph\u1ea3i \u0111\u01b0\u1ee3c h\u01b0\u1edbng ng\u01b0\u1ee3c chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3, ngh\u0129a l\u00e0 t\u00edch v\u00f4 h\u01b0\u1edbng c\u1ee7a vector ph\u00e1p tuy\u1ebfn cu\u1ed1i c\u00f9ng trong bao (h\u01b0\u1edbng v\u00e0o trong bao) v\u00e0 vector t\u1eeb \u0111i\u1ec3m cu\u1ed1i c\u00f9ng \u0111\u1ebfn \u0111i\u1ec3m m\u1edbi ph\u1ea3i kh\u00f4ng \u00e2m. Ch\u1eebng n\u00e0o \u0111i\u1ec1u n\u00e0y kh\u00f4ng \u0111\u00fang, ch\u00fang ta n\u00ean x\u00f3a \u0111i\u1ec3m cu\u1ed1i c\u00f9ng trong bao l\u1ed3i c\u00f9ng v\u1edbi c\u1ea1nh t\u01b0\u01a1ng \u1ee9ng.</p> <p><pre><code>vector&lt;point&gt; hull, vecs;\n\nvoid add_line(ftype k, ftype b) {\n    point nw = {k, b};\n    while(!vecs.empty() &amp;&amp; dot(vecs.back(), nw - hull.back()) &lt; 0) {\n        hull.pop_back();\n        vecs.pop_back();\n    }\n    if(!hull.empty()) {\n        vecs.push_back(1i * (nw - hull.back()));\n    }\n    hull.push_back(nw);\n}\n</code></pre> B\u00e2y gi\u1edd \u0111\u1ec3 l\u1ea5y gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t t\u1ea1i m\u1ed9t \u0111i\u1ec3m n\u00e0o \u0111\u00f3, ch\u00fang ta s\u1ebd t\u00ecm vector ph\u00e1p tuy\u1ebfn \u0111\u1ea7u ti\u00ean trong bao l\u1ed3i h\u01b0\u1edbng ng\u01b0\u1ee3c chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3 t\u1eeb $(x;1)$. \u0110i\u1ec3m \u0111\u1ea7u m\u00fat b\u00ean tr\u00e1i c\u1ee7a c\u1ea1nh nh\u01b0 v\u1eady s\u1ebd l\u00e0 c\u00e2u tr\u1ea3 l\u1eddi. \u0110\u1ec3 ki\u1ec3m tra xem vector $a$ c\u00f3 kh\u00f4ng h\u01b0\u1edbng ng\u01b0\u1ee3c chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3 c\u1ee7a vector $b$ hay kh\u00f4ng, ch\u00fang ta n\u00ean ki\u1ec3m tra xem t\u00edch c\u00f3 h\u01b0\u1edbng (cross product) $[a,b]$ c\u00f3 d\u01b0\u01a1ng hay kh\u00f4ng. <pre><code>int get(ftype x) {\n    point query = {x, 1};\n    auto it = lower_bound(vecs.begin(), vecs.end(), query, [](point a, point b) {\n        return cross(a, b) &gt; 0;\n    });\n    return dot(query, hull[it - vecs.begin()]);\n}\n</code></pre></p>","tags":["Translated"]},{"location":"geometry/convex_hull_trick.html#li-chao-tree","title":"C\u00e2y Li Chao (Li Chao tree)","text":"<p>Gi\u1ea3 s\u1eed b\u1ea1n \u0111\u01b0\u1ee3c cho m\u1ed9t t\u1eadp h\u1ee3p c\u00e1c h\u00e0m sao cho m\u1ed7i hai h\u00e0m c\u00f3 th\u1ec3 c\u1eaft nhau t\u1ed1i \u0111a m\u1ed9t l\u1ea7n. H\u00e3y gi\u1eef trong m\u1ed7i \u0111\u1ec9nh c\u1ee7a c\u00e2y ph\u00e2n \u0111o\u1ea1n (segment tree) m\u1ed9t s\u1ed1 h\u00e0m theo c\u00e1ch sao cho, n\u1ebfu ch\u00fang ta \u0111i t\u1eeb g\u1ed1c \u0111\u1ebfn l\u00e1, s\u1ebd \u0111\u01b0\u1ee3c \u0111\u1ea3m b\u1ea3o r\u1eb1ng m\u1ed9t trong c\u00e1c h\u00e0m ch\u00fang ta g\u1eb7p tr\u00ean \u0111\u01b0\u1eddng \u0111i s\u1ebd l\u00e0 h\u00e0m cho gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t trong l\u00e1 \u0111\u00f3. H\u00e3y xem c\u00e1ch x\u00e2y d\u1ef1ng n\u00f3.</p> <p>Gi\u1ea3 s\u1eed ch\u00fang ta \u0111ang \u1edf m\u1ed9t \u0111\u1ec9nh n\u00e0o \u0111\u00f3 t\u01b0\u01a1ng \u1ee9ng v\u1edbi n\u1eeda \u0111o\u1ea1n $[l,r)$ v\u00e0 h\u00e0m $f_{old}$ \u0111\u01b0\u1ee3c gi\u1eef \u1edf \u0111\u00f3 v\u00e0 ch\u00fang ta th\u00eam h\u00e0m $f_{new}$. Khi \u0111\u00f3 \u0111i\u1ec3m giao nhau s\u1ebd \u1edf trong $[l;m)$ ho\u1eb7c trong $[m;r)$ v\u1edbi $m=\\left\\lfloor\\tfrac{l+r}{2}\\right\\rfloor$. Ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm ra \u0111i\u1ec1u \u0111\u00f3 m\u1ed9t c\u00e1ch hi\u1ec7u qu\u1ea3 b\u1eb1ng c\u00e1ch so s\u00e1nh c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a c\u00e1c h\u00e0m t\u1ea1i c\u00e1c \u0111i\u1ec3m $l$ v\u00e0 $m$. N\u1ebfu h\u00e0m chi\u1ebfm \u01b0u th\u1ebf thay \u0111\u1ed5i, th\u00ec n\u00f3 n\u1eb1m trong $[l;m)$, ng\u01b0\u1ee3c l\u1ea1i n\u00f3 n\u1eb1m trong $[m;r)$. B\u00e2y gi\u1edd \u0111\u1ed1i v\u1edbi n\u1eeda \u0111o\u1ea1n kh\u00f4ng c\u00f3 giao \u0111i\u1ec3m, ch\u00fang ta s\u1ebd ch\u1ecdn h\u00e0m th\u1ea5p h\u01a1n v\u00e0 ghi n\u00f3 v\u00e0o \u0111\u1ec9nh hi\u1ec7n t\u1ea1i. B\u1ea1n c\u00f3 th\u1ec3 th\u1ea5y r\u1eb1ng n\u00f3 s\u1ebd lu\u00f4n l\u00e0 h\u00e0m th\u1ea5p h\u01a1n t\u1ea1i \u0111i\u1ec3m $m$. Sau \u0111\u00f3 ch\u00fang ta \u0111\u1ec7 quy \u0111i \u0111\u1ebfn n\u1eeda c\u00f2n l\u1ea1i c\u1ee7a \u0111o\u1ea1n v\u1edbi h\u00e0m l\u00e0 h\u00e0m tr\u00ean. Nh\u01b0 b\u1ea1n c\u00f3 th\u1ec3 th\u1ea5y, \u0111i\u1ec1u n\u00e0y s\u1ebd gi\u1eef t\u00ednh \u0111\u00fang \u0111\u1eafn tr\u00ean n\u1eeda \u0111\u1ea7u c\u1ee7a \u0111o\u1ea1n v\u00e0 trong n\u1eeda c\u00f2n l\u1ea1i t\u00ednh \u0111\u00fang \u0111\u1eafn s\u1ebd \u0111\u01b0\u1ee3c duy tr\u00ec trong cu\u1ed9c g\u1ecdi \u0111\u1ec7 quy. Do \u0111\u00f3 ch\u00fang ta c\u00f3 th\u1ec3 th\u00eam c\u00e1c h\u00e0m v\u00e0 ki\u1ec3m tra gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t t\u1ea1i \u0111i\u1ec3m trong $O(\\log [C\\varepsilon^{-1}])$.</p> <p>\u0110\u00e2y l\u00e0 minh h\u1ecda v\u1ec1 nh\u1eefng g\u00ec \u0111ang di\u1ec5n ra trong \u0111\u1ec9nh khi ch\u00fang ta th\u00eam h\u00e0m m\u1edbi:</p> <p>B\u00e2y gi\u1edd h\u00e3y \u0111i \u0111\u1ebfn ph\u1ea7n c\u00e0i \u0111\u1eb7t. M\u1ed9t l\u1ea7n n\u1eefa ch\u00fang ta s\u1ebd s\u1eed d\u1ee5ng s\u1ed1 ph\u1ee9c \u0111\u1ec3 gi\u1eef c\u00e1c h\u00e0m tuy\u1ebfn t\u00ednh.</p> <p><pre><code>typedef long long ftype;\ntypedef complex&lt;ftype&gt; point;\n#define x real\n#define y imag\n\nftype dot(point a, point b) {\n    return (conj(a) * b).x();\n}\n\nftype f(point a,  ftype x) {\n    return dot(a, {x, 1});\n}\n</code></pre> Ch\u00fang ta s\u1ebd gi\u1eef c\u00e1c h\u00e0m trong m\u1ea3ng <code>line</code> v\u00e0 s\u1eed d\u1ee5ng ch\u1ec9 s\u1ed1 nh\u1ecb ph\u00e2n c\u1ee7a c\u00e2y ph\u00e2n \u0111o\u1ea1n. N\u1ebfu b\u1ea1n mu\u1ed1n s\u1eed d\u1ee5ng n\u00f3 tr\u00ean c\u00e1c s\u1ed1 l\u1edbn ho\u1eb7c s\u1ed1 th\u1ef1c (doubles), b\u1ea1n n\u00ean s\u1eed d\u1ee5ng c\u00e2y ph\u00e2n \u0111o\u1ea1n \u0111\u1ed9ng (dynamic segment tree). C\u00e2y ph\u00e2n \u0111o\u1ea1n n\u00ean \u0111\u01b0\u1ee3c kh\u1edfi t\u1ea1o v\u1edbi c\u00e1c gi\u00e1 tr\u1ecb m\u1eb7c \u0111\u1ecbnh, v\u00ed d\u1ee5 v\u1edbi c\u00e1c \u0111\u01b0\u1eddng th\u1eb3ng $0x + \\infty$.</p> <p><pre><code>const int maxn = 2e5;\n\npoint line[4 * maxn];\n\nvoid add_line(point nw, int v = 1, int l = 0, int r = maxn) {\n    int m = (l + r) / 2;\n    bool lef = f(nw, l) &lt; f(line[v], l);\n    bool mid = f(nw, m) &lt; f(line[v], m);\n    if(mid) {\n        swap(line[v], nw);\n    }\n    if(r - l == 1) {\n        return;\n    } else if(lef != mid) {\n        add_line(nw, 2 * v, l, m);\n    } else {\n        add_line(nw, 2 * v + 1, m, r);\n    }\n}\n</code></pre> B\u00e2y gi\u1edd \u0111\u1ec3 l\u1ea5y gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t t\u1ea1i m\u1ed9t \u0111i\u1ec3m $x$ n\u00e0o \u0111\u00f3, ch\u00fang ta ch\u1ec9 c\u1ea7n ch\u1ecdn gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t d\u1ecdc theo \u0111\u01b0\u1eddng \u0111i \u0111\u1ebfn \u0111i\u1ec3m \u0111\u00f3. <pre><code>ftype get(int x, int v = 1, int l = 0, int r = maxn) {\n    int m = (l + r) / 2;\n    if(r - l == 1) {\n        return f(line[v], x);\n    } else if(x &lt; m) {\n        return min(f(line[v], x), get(x, 2 * v, l, m));\n    } else {\n        return min(f(line[v], x), get(x, 2 * v + 1, m, r));\n    }\n}\n</code></pre></p>","tags":["Translated"]},{"location":"geometry/convex_hull_trick.html#problems","title":"B\u00e0i t\u1eadp (Problems)","text":"<ul> <li>Codebreaker - TROUBLES (\u1ee9ng d\u1ee5ng \u0111\u01a1n gi\u1ea3n c\u1ee7a Th\u1ee7 thu\u1eadt Bao L\u1ed3i sau m\u1ed9t v\u00e0i quan s\u00e1t)</li> <li>CS Academy - Squared Ends</li> <li>Codeforces - Escape Through Leaf</li> <li>CodeChef - Polynomials</li> <li>Codeforces - Kalila and Dimna in the Logging Industry</li> <li>Codeforces - Product Sum</li> <li>Codeforces - Bear and Bowling 4</li> <li>APIO 2010 - Commando</li> </ul>","tags":["Translated"]},{"location":"geometry/delaunay.html","title":"Tam gi\u00e1c \u0111\u1ea1c Delaunay v\u00e0 bi\u1ec3u \u0111\u1ed3 Voronoi (Delaunay triangulation and Voronoi diagram)","text":"<p>Xem x\u00e9t m\u1ed9t t\u1eadp h\u1ee3p $\\{p_i\\}$ c\u00e1c \u0111i\u1ec3m tr\u00ean m\u1eb7t ph\u1eb3ng. M\u1ed9t bi\u1ec3u \u0111\u1ed3 Voronoi (Voronoi diagram) $V(\\{p_i\\})$ c\u1ee7a $\\{p_i\\}$ l\u00e0 m\u1ed9t ph\u00e2n v\u00f9ng c\u1ee7a m\u1eb7t ph\u1eb3ng th\u00e0nh $n$ v\u00f9ng $V_i$, trong \u0111\u00f3 $V_i = \\{p\\in\\mathbb{R}^2;\\ \\rho(p, p_i) = \\min\\ \\rho(p, p_k)\\}$. C\u00e1c \u00f4 (cell) c\u1ee7a bi\u1ec3u \u0111\u1ed3 Voronoi l\u00e0 c\u00e1c \u0111a gi\u00e1c (c\u00f3 th\u1ec3 v\u00f4 h\u1ea1n). M\u1ed9t tam gi\u00e1c \u0111\u1ea1c Delaunay (Delaunay triangulation) $D(\\{p_i\\})$ c\u1ee7a $\\{p_i\\}$ l\u00e0 m\u1ed9t ph\u00e9p \u0111\u1ea1c tam gi\u00e1c trong \u0111\u00f3 m\u1ecdi \u0111i\u1ec3m $p_i$ n\u1eb1m ngo\u00e0i ho\u1eb7c n\u1eb1m tr\u00ean bi\u00ean c\u1ee7a \u0111\u01b0\u1eddng tr\u00f2n ngo\u1ea1i ti\u1ebfp c\u1ee7a m\u1ed7i tam gi\u00e1c $T \\in D(\\{p_i\\})$.</p> <p>C\u00f3 m\u1ed9t tr\u01b0\u1eddng h\u1ee3p suy bi\u1ebfn kh\u00f3 ch\u1ecbu khi bi\u1ec3u \u0111\u1ed3 Voronoi kh\u00f4ng li\u00ean th\u00f4ng v\u00e0 tam gi\u00e1c \u0111\u1ea1c Delaunay kh\u00f4ng t\u1ed3n t\u1ea1i. Tr\u01b0\u1eddng h\u1ee3p n\u00e0y l\u00e0 khi t\u1ea5t c\u1ea3 c\u00e1c \u0111i\u1ec3m \u0111\u1ec1u th\u1eb3ng h\u00e0ng.</p>","tags":["Translated"]},{"location":"geometry/delaunay.html#properties","title":"T\u00ednh ch\u1ea5t (Properties)","text":"<p>Tam gi\u00e1c \u0111\u1ea1c Delaunay t\u1ed1i \u0111a h\u00f3a g\u00f3c nh\u1ecf nh\u1ea5t trong s\u1ed1 t\u1ea5t c\u1ea3 c\u00e1c ph\u00e9p \u0111\u1ea1c tam gi\u00e1c c\u00f3 th\u1ec3.</p> <p>C\u00e2y khung Euclide nh\u1ecf nh\u1ea5t (Minimum Euclidean spanning tree) c\u1ee7a m\u1ed9t t\u1eadp h\u1ee3p \u0111i\u1ec3m l\u00e0 m\u1ed9t t\u1eadp h\u1ee3p con c\u00e1c c\u1ea1nh c\u1ee7a tam gi\u00e1c \u0111\u1ea1c Delaunay c\u1ee7a n\u00f3.</p>","tags":["Translated"]},{"location":"geometry/delaunay.html#duality","title":"T\u00ednh \u0111\u1ed1i ng\u1eabu (Duality)","text":"<p>Gi\u1ea3 s\u1eed r\u1eb1ng $\\{p_i\\}$ kh\u00f4ng th\u1eb3ng h\u00e0ng v\u00e0 trong s\u1ed1 $\\{p_i\\}$ kh\u00f4ng c\u00f3 b\u1ed1n \u0111i\u1ec3m n\u00e0o n\u1eb1m tr\u00ean c\u00f9ng m\u1ed9t \u0111\u01b0\u1eddng tr\u00f2n. Khi \u0111\u00f3 $V(\\{p_i\\})$ v\u00e0 $D(\\{p_i\\})$ l\u00e0 \u0111\u1ed1i ng\u1eabu (dual), v\u00ec v\u1eady n\u1ebfu ch\u00fang ta c\u00f3 \u0111\u01b0\u1ee3c m\u1ed9t trong s\u1ed1 ch\u00fang, ch\u00fang ta c\u00f3 th\u1ec3 c\u00f3 \u0111\u01b0\u1ee3c c\u00e1i kia trong $O(n)$. Ph\u1ea3i l\u00e0m g\u00ec n\u1ebfu kh\u00f4ng ph\u1ea3i tr\u01b0\u1eddng h\u1ee3p \u0111\u00f3? Tr\u01b0\u1eddng h\u1ee3p th\u1eb3ng h\u00e0ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c x\u1eed l\u00fd d\u1ec5 d\u00e0ng. N\u1ebfu kh\u00f4ng, $V$ v\u00e0 $D'$ l\u00e0 \u0111\u1ed1i ng\u1eabu, trong \u0111\u00f3 $D'$ thu \u0111\u01b0\u1ee3c t\u1eeb $D$ b\u1eb1ng c\u00e1ch lo\u1ea1i b\u1ecf t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh sao cho hai tam gi\u00e1c tr\u00ean c\u1ea1nh n\u00e0y chia s\u1ebb \u0111\u01b0\u1eddng tr\u00f2n ngo\u1ea1i ti\u1ebfp.</p>","tags":["Translated"]},{"location":"geometry/delaunay.html#building-delaunay-and-voronoi","title":"X\u00e2y d\u1ef1ng Delaunay v\u00e0 Voronoi (Building Delaunay and Voronoi)","text":"<p>Do t\u00ednh \u0111\u1ed1i ng\u1eabu, ch\u00fang ta ch\u1ec9 c\u1ea7n m\u1ed9t thu\u1eadt to\u00e1n nhanh \u0111\u1ec3 t\u00ednh to\u00e1n ch\u1ec9 m\u1ed9t trong $V$ v\u00e0 $D$. Ch\u00fang ta s\u1ebd m\u00f4 t\u1ea3 c\u00e1ch x\u00e2y d\u1ef1ng $D(\\{p_i\\})$ trong $O(n\\log n)$. Ph\u00e9p \u0111\u1ea1c tam gi\u00e1c s\u1ebd \u0111\u01b0\u1ee3c x\u00e2y d\u1ef1ng th\u00f4ng qua thu\u1eadt to\u00e1n chia \u0111\u1ec3 tr\u1ecb (divide-and-conquer) do Guibas v\u00e0 Stolfi \u0111\u1ec1 xu\u1ea5t.</p>","tags":["Translated"]},{"location":"geometry/delaunay.html#quad-edge-data-structure","title":"C\u1ea5u tr\u00fac d\u1eef li\u1ec7u c\u1ea1nh t\u1ee9 gi\u00e1c (Quad-edge data structure)","text":"<p>Trong thu\u1eadt to\u00e1n, $D$ s\u1ebd \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef b\u00ean trong c\u1ea5u tr\u00fac d\u1eef li\u1ec7u c\u1ea1nh t\u1ee9 gi\u00e1c (quad-edge). C\u1ea5u tr\u00fac n\u00e0y \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 trong h\u00ecnh:</p> <p>Trong thu\u1eadt to\u00e1n, ch\u00fang ta s\u1ebd s\u1eed d\u1ee5ng c\u00e1c h\u00e0m sau tr\u00ean c\u00e1c c\u1ea1nh:</p> <ol> <li><code>make_edge(a, b)</code>     H\u00e0m n\u00e0y t\u1ea1o ra m\u1ed9t c\u1ea1nh c\u00f4 l\u1eadp t\u1eeb \u0111i\u1ec3m <code>a</code> \u0111\u1ebfn \u0111i\u1ec3m <code>b</code> c\u00f9ng v\u1edbi c\u1ea1nh ng\u01b0\u1ee3c c\u1ee7a n\u00f3 v\u00e0 c\u1ea3 hai c\u1ea1nh \u0111\u1ed1i ng\u1eabu.</li> <li><code>splice(a, b)</code>     \u0110\u00e2y l\u00e0 m\u1ed9t h\u00e0m ch\u00ednh c\u1ee7a thu\u1eadt to\u00e1n. N\u00f3 ho\u00e1n \u0111\u1ed5i <code>a-&gt;Onext</code> v\u1edbi <code>b-&gt;Onext</code> v\u00e0 <code>a-&gt;Onext-&gt;Rot-&gt;Onext</code> v\u1edbi <code>b-&gt;Onext-&gt;Rot-&gt;Onext</code>.</li> <li><code>delete_edge(e)</code>     H\u00e0m n\u00e0y x\u00f3a <code>e</code> kh\u1ecfi tam gi\u00e1c \u0111\u1ea1c. \u0110\u1ec3 x\u00f3a <code>e</code>, ch\u00fang ta c\u00f3 th\u1ec3 ch\u1ec9 c\u1ea7n g\u1ecdi <code>splice(e, e-&gt;Oprev)</code> v\u00e0 <code>splice(e-&gt;Rev, e-&gt;Rev-&gt;Oprev)</code>.</li> <li><code>connect(a, b)</code>     H\u00e0m n\u00e0y t\u1ea1o m\u1ed9t c\u1ea1nh m\u1edbi <code>e</code> t\u1eeb <code>a-&gt;Dest</code> \u0111\u1ebfn <code>b-&gt;Org</code> sao cho <code>a</code>, <code>b</code>, <code>e</code> \u0111\u1ec1u c\u00f3 c\u00f9ng m\u1ed9t m\u1eb7t tr\u00e1i. \u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y, ch\u00fang ta g\u1ecdi <code>e = make_edge(a-&gt;Dest, b-&gt;Org)</code>, <code>splice(e, a-&gt;Lnext)</code> v\u00e0 <code>splice(e-&gt;Rev, b)</code>.</li> </ol>","tags":["Translated"]},{"location":"geometry/delaunay.html#algorithm","title":"Thu\u1eadt to\u00e1n (Algorithm)","text":"<p>Thu\u1eadt to\u00e1n s\u1ebd t\u00ednh to\u00e1n tam gi\u00e1c \u0111\u1ea1c v\u00e0 tr\u1ea3 v\u1ec1 hai c\u1ea1nh t\u1ee9 gi\u00e1c: c\u1ea1nh bao l\u1ed3i ng\u01b0\u1ee3c chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3 ra kh\u1ecfi \u0111\u1ec9nh ngo\u00e0i c\u00f9ng b\u00ean tr\u00e1i v\u00e0 c\u1ea1nh bao l\u1ed3i c\u00f9ng chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3 ra kh\u1ecfi \u0111\u1ec9nh ngo\u00e0i c\u00f9ng b\u00ean ph\u1ea3i.</p> <p>H\u00e3y s\u1eafp x\u1ebfp t\u1ea5t c\u1ea3 c\u00e1c \u0111i\u1ec3m theo x, v\u00e0 n\u1ebfu $x_1 = x_2$ th\u00ec theo y. H\u00e3y gi\u1ea3i quy\u1ebft b\u00e0i to\u00e1n cho m\u1ed9t \u0111o\u1ea1n $(l, r)$ n\u00e0o \u0111\u00f3 (ban \u0111\u1ea7u $(l, r) = (0, n - 1)$). N\u1ebfu $r - l + 1 = 2$, ch\u00fang ta s\u1ebd th\u00eam m\u1ed9t c\u1ea1nh $(p[l], p[r])$ v\u00e0 tr\u1ea3 v\u1ec1. N\u1ebfu $r - l + 1 = 3$, tr\u01b0\u1edbc ti\u00ean ch\u00fang ta s\u1ebd th\u00eam c\u00e1c c\u1ea1nh $(p[l], p[l + 1])$ v\u00e0 $(p[l + 1], p[r])$. Ch\u00fang ta c\u0169ng ph\u1ea3i k\u1ebft n\u1ed1i ch\u00fang b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng <code>splice(a-&gt;Rev, b)</code>. B\u00e2y gi\u1edd ch\u00fang ta ph\u1ea3i \u0111\u00f3ng tam gi\u00e1c. H\u00e0nh \u0111\u1ed9ng ti\u1ebfp theo c\u1ee7a ch\u00fang ta s\u1ebd ph\u1ee5 thu\u1ed9c v\u00e0o h\u01b0\u1edbng c\u1ee7a $p[l], p[l + 1], p[r]$. N\u1ebfu ch\u00fang th\u1eb3ng h\u00e0ng, ch\u00fang ta kh\u00f4ng th\u1ec3 t\u1ea1o m\u1ed9t tam gi\u00e1c, v\u00ec v\u1eady ch\u00fang ta ch\u1ec9 c\u1ea7n tr\u1ea3 v\u1ec1 <code>(a, b-&gt;Rev)</code>. Ng\u01b0\u1ee3c l\u1ea1i, ch\u00fang ta t\u1ea1o m\u1ed9t c\u1ea1nh m\u1edbi <code>c</code> b\u1eb1ng c\u00e1ch g\u1ecdi <code>connect(b, a)</code>. N\u1ebfu c\u00e1c \u0111i\u1ec3m \u0111\u01b0\u1ee3c \u0111\u1ecbnh h\u01b0\u1edbng ng\u01b0\u1ee3c chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3, ch\u00fang ta tr\u1ea3 v\u1ec1 <code>(a, b-&gt;Rev)</code>. Ng\u01b0\u1ee3c l\u1ea1i, ch\u00fang ta tr\u1ea3 v\u1ec1 <code>(c-&gt;Rev, c)</code>.</p> <p>B\u00e2y gi\u1edd gi\u1ea3 s\u1eed r\u1eb1ng $r - l + 1 \\ge 4$. \u0110\u1ea7u ti\u00ean, h\u00e3y gi\u1ea3i $L = (l, \\frac{l + r}{2})$ v\u00e0 $R = (\\frac{l + r}{2} + 1, r)$ m\u1ed9t c\u00e1ch \u0111\u1ec7 quy. B\u00e2y gi\u1edd ch\u00fang ta ph\u1ea3i h\u1ee3p nh\u1ea5t c\u00e1c tam gi\u00e1c \u0111\u1ea1c n\u00e0y th\u00e0nh m\u1ed9t tam gi\u00e1c \u0111\u1ea1c. L\u01b0u \u00fd r\u1eb1ng c\u00e1c \u0111i\u1ec3m c\u1ee7a ch\u00fang ta \u0111\u00e3 \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp, v\u00ec v\u1eady trong khi h\u1ee3p nh\u1ea5t, ch\u00fang ta s\u1ebd th\u00eam c\u00e1c c\u1ea1nh t\u1eeb L \u0111\u1ebfn R (\u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 c\u00e1c c\u1ea1nh ch\u00e9o - cross edges) v\u00e0 lo\u1ea1i b\u1ecf m\u1ed9t s\u1ed1 c\u1ea1nh t\u1eeb L \u0111\u1ebfn L v\u00e0 t\u1eeb R \u0111\u1ebfn R. C\u1ea5u tr\u00fac c\u1ee7a c\u00e1c c\u1ea1nh ch\u00e9o l\u00e0 g\u00ec? T\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh n\u00e0y ph\u1ea3i c\u1eaft m\u1ed9t \u0111\u01b0\u1eddng th\u1eb3ng song song v\u1edbi tr\u1ee5c y v\u00e0 \u0111\u1eb7t t\u1ea1i gi\u00e1 tr\u1ecb x ph\u00e2n chia. \u0110i\u1ec1u n\u00e0y thi\u1ebft l\u1eadp m\u1ed9t th\u1ee9 t\u1ef1 tuy\u1ebfn t\u00ednh c\u1ee7a c\u00e1c c\u1ea1nh ch\u00e9o, v\u00ec v\u1eady ch\u00fang ta c\u00f3 th\u1ec3 n\u00f3i v\u1ec1 c\u00e1c c\u1ea1nh ch\u00e9o li\u00ean ti\u1ebfp, c\u1ea1nh ch\u00e9o d\u01b0\u1edbi c\u00f9ng, v.v. Thu\u1eadt to\u00e1n s\u1ebd th\u00eam c\u00e1c c\u1ea1nh ch\u00e9o theo th\u1ee9 t\u1ef1 t\u0103ng d\u1ea7n. L\u01b0u \u00fd r\u1eb1ng b\u1ea5t k\u1ef3 hai c\u1ea1nh ch\u00e9o li\u1ec1n k\u1ec1 n\u00e0o c\u0169ng s\u1ebd c\u00f3 m\u1ed9t \u0111\u1ea7u m\u00fat chung, v\u00e0 c\u1ea1nh th\u1ee9 ba c\u1ee7a tam gi\u00e1c m\u00e0 ch\u00fang x\u00e1c \u0111\u1ecbnh \u0111i t\u1eeb L \u0111\u1ebfn L ho\u1eb7c t\u1eeb R \u0111\u1ebfn R. H\u00e3y g\u1ecdi c\u1ea1nh ch\u00e9o hi\u1ec7n t\u1ea1i l\u00e0 c\u01a1 s\u1edf (base). Ng\u01b0\u1eddi k\u1ebf v\u1ecb c\u1ee7a c\u01a1 s\u1edf s\u1ebd \u0111i t\u1eeb \u0111\u1ea7u m\u00fat b\u00ean tr\u00e1i c\u1ee7a c\u01a1 s\u1edf \u0111\u1ebfn m\u1ed9t trong c\u00e1c l\u00e1ng gi\u1ec1ng R c\u1ee7a \u0111\u1ea7u m\u00fat b\u00ean ph\u1ea3i ho\u1eb7c ng\u01b0\u1ee3c l\u1ea1i. Xem x\u00e9t \u0111\u01b0\u1eddng tr\u00f2n ngo\u1ea1i ti\u1ebfp c\u1ee7a c\u01a1 s\u1edf v\u00e0 c\u1ea1nh ch\u00e9o tr\u01b0\u1edbc \u0111\u00f3. Gi\u1ea3 s\u1eed \u0111\u01b0\u1eddng tr\u00f2n n\u00e0y \u0111\u01b0\u1ee3c chuy\u1ec3n \u0111\u1ed5i th\u00e0nh c\u00e1c \u0111\u01b0\u1eddng tr\u00f2n kh\u00e1c c\u00f3 c\u01a1 s\u1edf l\u00e0 d\u00e2y cung nh\u01b0ng n\u1eb1m xa h\u01a1n v\u1ec1 h\u01b0\u1edbng Oy. \u0110\u01b0\u1eddng tr\u00f2n c\u1ee7a ch\u00fang ta s\u1ebd \u0111i l\u00ean m\u1ed9t l\u00fac, nh\u01b0ng tr\u1eeb khi c\u01a1 s\u1edf l\u00e0 ti\u1ebfp tuy\u1ebfn tr\u00ean c\u1ee7a L v\u00e0 R, ch\u00fang ta s\u1ebd g\u1eb7p m\u1ed9t \u0111i\u1ec3m thu\u1ed9c L ho\u1eb7c R t\u1ea1o ra m\u1ed9t tam gi\u00e1c m\u1edbi m\u00e0 kh\u00f4ng c\u00f3 b\u1ea5t k\u1ef3 \u0111i\u1ec3m n\u00e0o trong \u0111\u01b0\u1eddng tr\u00f2n ngo\u1ea1i ti\u1ebfp. C\u1ea1nh L-R m\u1edbi c\u1ee7a tam gi\u00e1c n\u00e0y l\u00e0 c\u1ea1nh ch\u00e9o ti\u1ebfp theo \u0111\u01b0\u1ee3c th\u00eam v\u00e0o. \u0110\u1ec3 th\u1ef1c hi\u1ec7n \u0111i\u1ec1u n\u00e0y m\u1ed9t c\u00e1ch hi\u1ec7u qu\u1ea3, ch\u00fang ta t\u00ednh to\u00e1n hai c\u1ea1nh <code>lcand</code> v\u00e0 <code>rcand</code> sao cho <code>lcand</code> tr\u1ecf \u0111\u1ebfn \u0111i\u1ec3m L \u0111\u1ea7u ti\u00ean g\u1eb7p ph\u1ea3i trong qu\u00e1 tr\u00ecnh n\u00e0y, v\u00e0 <code>rcand</code> tr\u1ecf \u0111\u1ebfn \u0111i\u1ec3m R \u0111\u1ea7u ti\u00ean. Sau \u0111\u00f3, ch\u00fang ta ch\u1ecdn c\u00e1i s\u1ebd g\u1eb7p ph\u1ea3i \u0111\u1ea7u ti\u00ean. Ban \u0111\u1ea7u c\u01a1 s\u1edf tr\u1ecf \u0111\u1ebfn ti\u1ebfp tuy\u1ebfn d\u01b0\u1edbi c\u1ee7a L v\u00e0 R.</p>","tags":["Translated"]},{"location":"geometry/delaunay.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>L\u01b0u \u00fd r\u1eb1ng vi\u1ec7c c\u00e0i \u0111\u1eb7t h\u00e0m in_circle l\u00e0 \u0111\u1eb7c th\u00f9 c\u1ee7a GCC.</p> <pre><code>typedef long long ll;\n\nbool ge(const ll&amp; a, const ll&amp; b) { return a &gt;= b; }\nbool le(const ll&amp; a, const ll&amp; b) { return a &lt;= b; }\nbool eq(const ll&amp; a, const ll&amp; b) { return a == b; }\nbool gt(const ll&amp; a, const ll&amp; b) { return a &gt; b; }\nbool lt(const ll&amp; a, const ll&amp; b) { return a &lt; b; }\nint sgn(const ll&amp; a) { return a &gt;= 0 ? a ? 1 : 0 : -1; }\n\nstruct pt {\n    ll x, y;\n    pt() { }\n    pt(ll _x, ll _y) : x(_x), y(_y) { }\n    pt operator-(const pt&amp; p) const {\n        return pt(x - p.x, y - p.y);\n    }\n    ll cross(const pt&amp; p) const {\n        return x * p.y - y * p.x;\n    }\n    ll cross(const pt&amp; a, const pt&amp; b) const {\n        return (a - *this).cross(b - *this);\n    }\n    ll dot(const pt&amp; p) const {\n        return x * p.x + y * p.y;\n    }\n    ll dot(const pt&amp; a, const pt&amp; b) const {\n        return (a - *this).dot(b - *this);\n    }\n    ll sqrLength() const {\n        return this-&gt;dot(*this);\n    }\n    bool operator==(const pt&amp; p) const {\n        return eq(x, p.x) &amp;&amp; eq(y, p.y);\n    }\n};\n\nconst pt inf_pt = pt(1e18, 1e18);\n\nstruct QuadEdge {\n    pt origin;\n    QuadEdge* rot = nullptr;\n    QuadEdge* onext = nullptr;\n    bool used = false;\n    QuadEdge* rev() const {\n        return rot-&gt;rot;\n    }\n    QuadEdge* lnext() const {\n        return rot-&gt;rev()-&gt;onext-&gt;rot;\n    }\n    QuadEdge* oprev() const {\n        return rot-&gt;onext-&gt;rot;\n    }\n    pt dest() const {\n        return rev()-&gt;origin;\n    }\n};\n\nQuadEdge* make_edge(pt from, pt to) {\n    QuadEdge* e1 = new QuadEdge;\n    QuadEdge* e2 = new QuadEdge;\n    QuadEdge* e3 = new QuadEdge;\n    QuadEdge* e4 = new QuadEdge;\n    e1-&gt;origin = from;\n    e2-&gt;origin = to;\n    e3-&gt;origin = e4-&gt;origin = inf_pt;\n    e1-&gt;rot = e3;\n    e2-&gt;rot = e4;\n    e3-&gt;rot = e2;\n    e4-&gt;rot = e1;\n    e1-&gt;onext = e1;\n    e2-&gt;onext = e2;\n    e3-&gt;onext = e4;\n    e4-&gt;onext = e3;\n    return e1;\n}\n\nvoid splice(QuadEdge* a, QuadEdge* b) {\n    swap(a-&gt;onext-&gt;rot-&gt;onext, b-&gt;onext-&gt;rot-&gt;onext);\n    swap(a-&gt;onext, b-&gt;onext);\n}\n\nvoid delete_edge(QuadEdge* e) {\n    splice(e, e-&gt;oprev());\n    splice(e-&gt;rev(), e-&gt;rev()-&gt;oprev());\n    delete e-&gt;rev()-&gt;rot;\n    delete e-&gt;rev();\n    delete e-&gt;rot;\n    delete e;\n}\n\nQuadEdge* connect(QuadEdge* a, QuadEdge* b) {\n    QuadEdge* e = make_edge(a-&gt;dest(), b-&gt;origin);\n    splice(e, a-&gt;lnext());\n    splice(e-&gt;rev(), b);\n    return e;\n}\n\nbool left_of(pt p, QuadEdge* e) {\n    return gt(p.cross(e-&gt;origin, e-&gt;dest()), 0);\n}\n\nbool right_of(pt p, QuadEdge* e) {\n    return lt(p.cross(e-&gt;origin, e-&gt;dest()), 0);\n}\n\ntemplate &lt;class T&gt;\nT det3(T a1, T a2, T a3, T b1, T b2, T b3, T c1, T c2, T c3) {\n    return a1 * (b2 * c3 - c2 * b3) - a2 * (b1 * c3 - c1 * b3) +\n           a3 * (b1 * c2 - c1 * b2);\n}\n\nbool in_circle(pt a, pt b, pt c, pt d) {\n// If there is __int128, calculate directly.\n// Otherwise, calculate angles.\n#if defined(__LP64__) || defined(_WIN64)\n    __int128 det = -det3&lt;__int128&gt;(b.x, b.y, b.sqrLength(), c.x, c.y,\n                                   c.sqrLength(), d.x, d.y, d.sqrLength());\n    det += det3&lt;__int128&gt;(a.x, a.y, a.sqrLength(), c.x, c.y, c.sqrLength(), d.x,\n                          d.y, d.sqrLength());\n    det -= det3&lt;__int128&gt;(a.x, a.y, a.sqrLength(), b.x, b.y, b.sqrLength(), d.x,\n                          d.y, d.sqrLength());\n    det += det3&lt;__int128&gt;(a.x, a.y, a.sqrLength(), b.x, b.y, b.sqrLength(), c.x,\n                          c.y, c.sqrLength());\n    return det &gt; 0;\n#else\n    auto ang = [](pt l, pt mid, pt r) {\n        ll x = mid.dot(l, r);\n        ll y = mid.cross(l, r);\n        long double res = atan2((long double)x, (long double)y);\n        return res;\n    };\n    long double kek = ang(a, b, c) + ang(c, d, a) - ang(b, c, d) - ang(d, a, b);\n    if (kek &gt; 1e-8)\n        return true;\n    else\n        return false;\n#endif\n}\n\npair&lt;QuadEdge*, QuadEdge*&gt; build_tr(int l, int r, vector&lt;pt&gt;&amp; p) {\n    if (r - l + 1 == 2) {\n        QuadEdge* res = make_edge(p[l], p[r]);\n        return make_pair(res, res-&gt;rev());\n    }\n    if (r - l + 1 == 3) {\n        QuadEdge *a = make_edge(p[l], p[l + 1]), *b = make_edge(p[l + 1], p[r]);\n        splice(a-&gt;rev(), b);\n        int sg = sgn(p[l].cross(p[l + 1], p[r]));\n        if (sg == 0)\n            return make_pair(a, b-&gt;rev());\n        QuadEdge* c = connect(b, a);\n        if (sg == 1)\n            return make_pair(a, b-&gt;rev());\n        else\n            return make_pair(c-&gt;rev(), c);\n    }\n    int mid = (l + r) / 2;\n    QuadEdge *ldo, *ldi, *rdo, *rdi;\n    tie(ldo, ldi) = build_tr(l, mid, p);\n    tie(rdi, rdo) = build_tr(mid + 1, r, p);\n    while (true) {\n        if (left_of(rdi-&gt;origin, ldi)) {\n            ldi = ldi-&gt;lnext();\n            continue;\n        }\n        if (right_of(ldi-&gt;origin, rdi)) {\n            rdi = rdi-&gt;rev()-&gt;onext;\n            continue;\n        }\n        break;\n    }\n    QuadEdge* basel = connect(rdi-&gt;rev(), ldi);\n    auto valid = [&amp;basel](QuadEdge* e) { return right_of(e-&gt;dest(), basel); };\n    if (ldi-&gt;origin == ldo-&gt;origin)\n        ldo = basel-&gt;rev();\n    if (rdi-&gt;origin == rdo-&gt;origin)\n        rdo = basel;\n    while (true) {\n        QuadEdge* lcand = basel-&gt;rev()-&gt;onext;\n        if (valid(lcand)) {\n            while (in_circle(basel-&gt;dest(), basel-&gt;origin, lcand-&gt;dest(),\n                             lcand-&gt;onext-&gt;dest())) {\n                QuadEdge* t = lcand-&gt;onext;\n                delete_edge(lcand);\n                lcand = t;\n            }\n        }\n        QuadEdge* rcand = basel-&gt;oprev();\n        if (valid(rcand)) {\n            while (in_circle(basel-&gt;dest(), basel-&gt;origin, rcand-&gt;dest(),\n                             rcand-&gt;oprev()-&gt;dest())) {\n                QuadEdge* t = rcand-&gt;oprev();\n                delete_edge(rcand);\n                rcand = t;\n            }\n        }\n        if (!valid(lcand) &amp;&amp; !valid(rcand))\n            break;\n        if (!valid(lcand) ||\n            (valid(rcand) &amp;&amp; in_circle(lcand-&gt;dest(), lcand-&gt;origin,\n                                       rcand-&gt;origin, rcand-&gt;dest())))\n            basel = connect(rcand, basel-&gt;rev());\n        else\n            basel = connect(basel-&gt;rev(), lcand-&gt;rev());\n    }\n    return make_pair(ldo, rdo);\n}\n\nvector&lt;tuple&lt;pt, pt, pt&gt;&gt; delaunay(vector&lt;pt&gt; p) {\n    sort(p.begin(), p.end(), [](const pt&amp; a, const pt&amp; b) {\n        return lt(a.x, b.x) || (eq(a.x, b.x) &amp;&amp; lt(a.y, b.y));\n    });\n    auto res = build_tr(0, (int)p.size() - 1, p);\n    QuadEdge* e = res.first;\n    vector&lt;QuadEdge*&gt; edges = {e};\n    while (lt(e-&gt;onext-&gt;dest().cross(e-&gt;dest(), e-&gt;origin), 0))\n        e = e-&gt;onext;\n    auto add = [&amp;p, &amp;e, &amp;edges]() {\n        QuadEdge* curr = e;\n        do {\n            curr-&gt;used = true;\n            p.push_back(curr-&gt;origin);\n            edges.push_back(curr-&gt;rev());\n            curr = curr-&gt;lnext();\n        } while (curr != e);\n    };\n    add();\n    p.clear();\n    int kek = 0;\n    while (kek &lt; (int)edges.size()) {\n        if (!(e = edges[kek++])-&gt;used)\n            add();\n    }\n    vector&lt;tuple&lt;pt, pt, pt&gt;&gt; ans;\n    for (int i = 0; i &lt; (int)p.size(); i += 3) {\n        ans.push_back(make_tuple(p[i], p[i + 1], p[i + 2]));\n    }\n    return ans;\n}\n</code></pre>","tags":["Translated"]},{"location":"geometry/delaunay.html#problems","title":"B\u00e0i t\u1eadp (Problems)","text":"<ul> <li>TIMUS 1504 Good Manners</li> <li>TIMUS 1520 Empire Strikes Back</li> <li>SGU 383 Caravans</li> </ul>","tags":["Translated"]},{"location":"geometry/enclosing-circle.html","title":"\u0110\u01b0\u1eddng tr\u00f2n bao nh\u1ecf nh\u1ea5t (Minimum Enclosing Circle)","text":"<p>Xem x\u00e9t b\u00e0i to\u00e1n sau:</p> <p>Library Checker - Minimum Enclosing Circle</p> <p>B\u1ea1n \u0111\u01b0\u1ee3c cho $n \\leq 10^5$ \u0111i\u1ec3m $p_i=(x_i, y_i)$.</p> <p>\u0110\u1ed1i v\u1edbi m\u1ed7i $p_i$, h\u00e3y t\u00ecm xem n\u00f3 c\u00f3 n\u1eb1m tr\u00ean chu vi (circumference) c\u1ee7a \u0111\u01b0\u1eddng tr\u00f2n bao nh\u1ecf nh\u1ea5t c\u1ee7a $\\{p_1,\\dots,p_n\\}$ hay kh\u00f4ng.</p> <p>\u1ede \u0111\u00e2y, theo \u0111\u01b0\u1eddng tr\u00f2n bao nh\u1ecf nh\u1ea5t (MEC - Minimum Enclosing Circle), ch\u00fang ta c\u00f3 ngh\u0129a l\u00e0 m\u1ed9t \u0111\u01b0\u1eddng tr\u00f2n c\u00f3 b\u00e1n k\u00ednh nh\u1ecf nh\u1ea5t c\u00f3 th\u1ec3 ch\u1ee9a t\u1ea5t c\u1ea3 $n$ \u0111i\u1ec3m, b\u00ean trong \u0111\u01b0\u1eddng tr\u00f2n ho\u1eb7c tr\u00ean bi\u00ean c\u1ee7a n\u00f3. B\u00e0i to\u00e1n n\u00e0y c\u00f3 m\u1ed9t gi\u1ea3i ph\u00e1p ng\u1eabu nhi\u00ean \u0111\u01a1n gi\u1ea3n, tho\u1ea1t nh\u00ecn, c\u00f3 v\u1ebb nh\u01b0 s\u1ebd ch\u1ea1y trong $O(n^3)$, nh\u01b0ng th\u1ef1c ra ho\u1ea1t \u0111\u1ed9ng trong th\u1eddi gian k\u1ef3 v\u1ecdng $O(n)$.</p> <p>\u0110\u1ec3 hi\u1ec3u r\u00f5 h\u01a1n v\u1ec1 l\u00fd lu\u1eadn d\u01b0\u1edbi \u0111\u00e2y, ch\u00fang ta n\u00ean l\u01b0u \u00fd ngay r\u1eb1ng gi\u1ea3i ph\u00e1p cho b\u00e0i to\u00e1n l\u00e0 duy nh\u1ea5t:</p> T\u1ea1i sao MEC l\u00e0 duy nh\u1ea5t? <p>Xem x\u00e9t thi\u1ebft l\u1eadp sau: G\u1ecdi $r$ l\u00e0 b\u00e1n k\u00ednh c\u1ee7a MEC. Ch\u00fang ta v\u1ebd m\u1ed9t \u0111\u01b0\u1eddng tr\u00f2n b\u00e1n k\u00ednh $r$ xung quanh m\u1ed7i \u0111i\u1ec3m $p_1,\\dots,p_n$. V\u1ec1 m\u1eb7t h\u00ecnh h\u1ecdc, t\u00e2m c\u1ee7a c\u00e1c \u0111\u01b0\u1eddng tr\u00f2n c\u00f3 b\u00e1n k\u00ednh $r$ v\u00e0 bao ph\u1ee7 t\u1ea5t c\u1ea3 c\u00e1c \u0111i\u1ec3m $p_1,\\dots,p_n$ t\u1ea1o th\u00e0nh giao \u0111i\u1ec3m c\u1ee7a t\u1ea5t c\u1ea3 $n$ \u0111\u01b0\u1eddng tr\u00f2n.</p> <p>B\u00e2y gi\u1edd, n\u1ebfu giao \u0111i\u1ec3m ch\u1ec9 l\u00e0 m\u1ed9t \u0111i\u1ec3m duy nh\u1ea5t, \u0111i\u1ec1u n\u00e0y \u0111\u00e3 ch\u1ee9ng minh r\u1eb1ng n\u00f3 l\u00e0 duy nh\u1ea5t. Ng\u01b0\u1ee3c l\u1ea1i, giao \u0111i\u1ec3m l\u00e0 m\u1ed9t h\u00ecnh d\u1ea1ng c\u00f3 di\u1ec7n t\u00edch kh\u00e1c kh\u00f4ng, v\u00ec v\u1eady ch\u00fang ta c\u00f3 th\u1ec3 gi\u1ea3m $r$ \u0111i m\u1ed9t ch\u00fat, v\u00e0 v\u1eabn c\u00f3 giao \u0111i\u1ec3m kh\u00f4ng r\u1ed7ng, \u0111i\u1ec1u n\u00e0y m\u00e2u thu\u1eabn v\u1edbi gi\u1ea3 \u0111\u1ecbnh r\u1eb1ng $r$ l\u00e0 b\u00e1n k\u00ednh nh\u1ecf nh\u1ea5t c\u00f3 th\u1ec3 c\u1ee7a \u0111\u01b0\u1eddng tr\u00f2n bao.</p> <p>V\u1edbi m\u1ed9t logic t\u01b0\u01a1ng t\u1ef1, ch\u00fang ta c\u0169ng c\u00f3 th\u1ec3 ch\u1ec9 ra t\u00ednh duy nh\u1ea5t c\u1ee7a MEC n\u1ebfu ch\u00fang ta y\u00eau c\u1ea7u th\u00eam r\u1eb1ng n\u00f3 \u0111i qua m\u1ed9t \u0111i\u1ec3m c\u1ee5 th\u1ec3 $p_i$ ho\u1eb7c hai \u0111i\u1ec3m $p_i$ v\u00e0 $p_j$ (n\u00f3 c\u0169ng l\u00e0 duy nh\u1ea5t v\u00ec b\u00e1n k\u00ednh c\u1ee7a n\u00f3 x\u00e1c \u0111\u1ecbnh duy nh\u1ea5t n\u00f3).</p> <p>Ngo\u00e0i ra, ch\u00fang ta c\u0169ng c\u00f3 th\u1ec3 gi\u1ea3 s\u1eed r\u1eb1ng c\u00f3 hai MEC, v\u00e0 sau \u0111\u00f3 nh\u1eadn th\u1ea5y r\u1eb1ng giao \u0111i\u1ec3m c\u1ee7a ch\u00fang (\u0111\u00e3 ch\u1ee9a c\u00e1c \u0111i\u1ec3m $p_1,\\dots,p_n$) ph\u1ea3i c\u00f3 \u0111\u01b0\u1eddng k\u00ednh nh\u1ecf h\u01a1n c\u00e1c \u0111\u01b0\u1eddng tr\u00f2n ban \u0111\u1ea7u, v\u00e0 do \u0111\u00f3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bao ph\u1ee7 b\u1eb1ng m\u1ed9t \u0111\u01b0\u1eddng tr\u00f2n nh\u1ecf h\u01a1n.</p>","tags":["Translated"]},{"location":"geometry/enclosing-circle.html#welzls-algorithm","title":"Thu\u1eadt to\u00e1n Welzl (Welzl's algorithm)","text":"<p>\u0110\u1ec3 ng\u1eafn g\u1ecdn, h\u00e3y k\u00fd hi\u1ec7u $\\operatorname{mec}(p_1,\\dots,p_n)$ l\u00e0 MEC c\u1ee7a $\\{p_1,\\dots,p_n\\}$, v\u00e0 g\u1ecdi $P_i = \\{p_1,\\dots,p_i\\}$.</p> <p>Thu\u1eadt to\u00e1n, ban \u0111\u1ea7u \u0111\u01b0\u1ee3c \u0111\u1ec1 xu\u1ea5t b\u1edfi Welzl v\u00e0o n\u0103m 1991, di\u1ec5n ra nh\u01b0 sau:</p> <ol> <li>\u00c1p d\u1ee5ng m\u1ed9t ho\u00e1n v\u1ecb ng\u1eabu nhi\u00ean cho d\u00e3y \u0111i\u1ec3m \u0111\u1ea7u v\u00e0o.</li> <li>Duy tr\u00ec \u1ee9ng c\u1eed vi\u00ean hi\u1ec7n t\u1ea1i l\u00e0 MEC $C$, b\u1eaft \u0111\u1ea7u v\u1edbi $C = \\operatorname{mec}(p_1, p_2)$.</li> <li>L\u1eb7p qua $i=3..n$ v\u00e0 ki\u1ec3m tra xem $p_i \\in C$ hay kh\u00f4ng.<ol> <li>N\u1ebfu $p_i \\in C$, \u0111i\u1ec1u \u0111\u00f3 c\u00f3 ngh\u0129a l\u00e0 $C$ l\u00e0 MEC c\u1ee7a $P_i$.</li> <li>Ng\u01b0\u1ee3c l\u1ea1i, g\u00e1n $C = \\operatorname{mec}(p_i, p_1)$ v\u00e0 l\u1eb7p qua $j=2..i$ v\u00e0 ki\u1ec3m tra xem $p_j \\in C$ hay kh\u00f4ng.<ol> <li>N\u1ebfu $p_j \\in C$, th\u00ec $C$ l\u00e0 MEC c\u1ee7a $P_j$ trong s\u1ed1 c\u00e1c \u0111\u01b0\u1eddng tr\u00f2n \u0111i qua $p_i$.</li> <li>Ng\u01b0\u1ee3c l\u1ea1i, g\u00e1n $C=\\operatorname{mec}(p_i, p_j)$ v\u00e0 l\u1eb7p qua $k=1..j$ v\u00e0 ki\u1ec3m tra xem $p_k \\in C$ hay kh\u00f4ng.<ol> <li>N\u1ebfu $p_k \\in C$, th\u00ec $C$ l\u00e0 MEC c\u1ee7a $P_k$ trong s\u1ed1 c\u00e1c \u0111\u01b0\u1eddng tr\u00f2n \u0111i qua $p_i$ v\u00e0 $p_j$.</li> <li>Ng\u01b0\u1ee3c l\u1ea1i, $C=\\operatorname{mec}(p_i,p_j,p_k)$ l\u00e0 MEC c\u1ee7a $P_k$ trong s\u1ed1 c\u00e1c \u0111\u01b0\u1eddng tr\u00f2n \u0111i qua $p_i$ v\u00e0 $p_j$.</li> </ol> </li> </ol> </li> </ol> </li> </ol> <p>Ch\u00fang ta c\u00f3 th\u1ec3 th\u1ea5y r\u1eb1ng m\u1ed7i c\u1ea5p \u0111\u1ed9 l\u1ed3ng nhau \u1edf \u0111\u00e2y c\u00f3 m\u1ed9t b\u1ea5t bi\u1ebfn \u0111\u1ec3 duy tr\u00ec (r\u1eb1ng $C$ l\u00e0 MEC trong s\u1ed1 c\u00e1c \u0111\u01b0\u1eddng tr\u00f2n c\u0169ng \u0111i qua th\u00eam $0$, $1$ ho\u1eb7c $2$ \u0111i\u1ec3m nh\u1ea5t \u0111\u1ecbnh), v\u00e0 b\u1ea5t c\u1ee9 khi n\u00e0o v\u00f2ng l\u1eb7p b\u00ean trong \u0111\u00f3ng l\u1ea1i, b\u1ea5t bi\u1ebfn c\u1ee7a n\u00f3 tr\u1edf n\u00ean t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi b\u1ea5t bi\u1ebfn c\u1ee7a l\u1ea7n l\u1eb7p hi\u1ec7n t\u1ea1i c\u1ee7a v\u00f2ng l\u1eb7p cha c\u1ee7a n\u00f3. \u0110i\u1ec1u n\u00e0y, \u0111\u1ebfn l\u01b0\u1ee3t n\u00f3, \u0111\u1ea3m b\u1ea3o t\u00ednh \u0111\u00fang \u0111\u1eafn c\u1ee7a to\u00e0n b\u1ed9 thu\u1eadt to\u00e1n.</p> <p>B\u1ecf qua m\u1ed9t s\u1ed1 chi ti\u1ebft k\u1ef9 thu\u1eadt, hi\u1ec7n t\u1ea1i, to\u00e0n b\u1ed9 thu\u1eadt to\u00e1n c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c c\u00e0i \u0111\u1eb7t trong C++ nh\u01b0 sau:</p> <pre><code>struct point {...};\n\n// Is represented by 2 or 3 points on its circumference\nstruct mec {...};\n\nbool inside(mec const&amp; C, point p) {\n    return ...;\n}\n\n// Choose some good generator of randomness for the shuffle\nmt19937_64 gen(...);\nmec enclosing_circle(vector&lt;point&gt; &amp;p) {\n    int n = p.size();\n    ranges::shuffle(p, gen);\n    auto C = mec{p[0], p[1]};\n    for(int i = 0; i &lt; n; i++) {\n        if(!inside(C, p[i])) {\n            C = mec{p[i], p[0]};\n            for(int j = 0; j &lt; i; j++) {\n                if(!inside(C, p[j])) {\n                    C = mec{p[i], p[j]};\n                    for(int k = 0; k &lt; j; k++) {\n                        if(!inside(C, p[k])) {\n                            C = mec{p[i], p[j], p[k]};\n                        }\n                    }\n                }\n            }\n        }\n    }\n    return C;\n}\n</code></pre> <p>B\u00e2y gi\u1edd, ng\u01b0\u1eddi ta c\u00f3 th\u1ec3 mong \u0111\u1ee3i r\u1eb1ng vi\u1ec7c ki\u1ec3m tra xem m\u1ed9t \u0111i\u1ec3m $p_i$ c\u00f3 n\u1eb1m trong MEC c\u1ee7a $2$ ho\u1eb7c $3$ \u0111i\u1ec3m hay kh\u00f4ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong $O(1)$ (ch\u00fang ta s\u1ebd th\u1ea3o lu\u1eadn v\u1ec1 \u0111i\u1ec1u n\u00e0y sau). Nh\u01b0ng ngay c\u1ea3 khi \u0111\u00f3, thu\u1eadt to\u00e1n tr\u00ean tr\u00f4ng nh\u01b0 th\u1ec3 n\u00f3 s\u1ebd m\u1ea5t $O(n^3)$ trong tr\u01b0\u1eddng h\u1ee3p x\u1ea5u nh\u1ea5t ch\u1ec9 v\u00ec t\u1ea5t c\u1ea3 c\u00e1c v\u00f2ng l\u1eb7p l\u1ed3ng nhau. V\u1eady l\u00e0m th\u1ebf n\u00e0o ch\u00fang ta l\u1ea1i tuy\u00ean b\u1ed1 th\u1eddi gian ch\u1ea1y k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh? H\u00e3y c\u00f9ng t\u00ecm hi\u1ec3u!</p>","tags":["Translated"]},{"location":"geometry/enclosing-circle.html#complexity-analysis","title":"Ph\u00e2n t\u00edch \u0111\u1ed9 ph\u1ee9c t\u1ea1p (Complexity analysis)","text":"<p>\u0110\u1ed1i v\u1edbi v\u00f2ng l\u1eb7p trong c\u00f9ng (theo $k$), r\u00f5 r\u00e0ng th\u1eddi gian ch\u1ea1y k\u1ef3 v\u1ecdng c\u1ee7a n\u00f3 l\u00e0 $O(j)$ ph\u00e9p to\u00e1n. C\u00f2n v\u00f2ng l\u1eb7p theo $j$ th\u00ec sao?</p> <p>N\u00f3 ch\u1ec9 k\u00edch ho\u1ea1t v\u00f2ng l\u1eb7p ti\u1ebfp theo n\u1ebfu $p_j$ n\u1eb1m tr\u00ean bi\u00ean c\u1ee7a MEC c\u1ee7a $P_j$ c\u0169ng \u0111i qua \u0111i\u1ec3m $i$, v\u00e0 vi\u1ec7c lo\u1ea1i b\u1ecf $p_j$ s\u1ebd l\u00e0m thu nh\u1ecf \u0111\u01b0\u1eddng tr\u00f2n h\u01a1n n\u1eefa. Trong t\u1ea5t c\u1ea3 c\u00e1c \u0111i\u1ec3m trong $P_j$ ch\u1ec9 c\u00f3 th\u1ec3 c\u00f3 t\u1ed1i \u0111a $2$ \u0111i\u1ec3m c\u00f3 t\u00ednh ch\u1ea5t nh\u01b0 v\u1eady, b\u1edfi v\u00ec n\u1ebfu c\u00f3 nhi\u1ec1u h\u01a1n $2$ \u0111i\u1ec3m t\u1eeb $P_j$ tr\u00ean bi\u00ean, \u0111i\u1ec1u \u0111\u00f3 c\u00f3 ngh\u0129a l\u00e0 sau khi lo\u1ea1i b\u1ecf b\u1ea5t k\u1ef3 \u0111i\u1ec3m n\u00e0o trong s\u1ed1 ch\u00fang, v\u1eabn s\u1ebd c\u00f3 \u00edt nh\u1ea5t $3$ \u0111i\u1ec3m tr\u00ean bi\u00ean, \u0111\u1ee7 \u0111\u1ec3 x\u00e1c \u0111\u1ecbnh duy nh\u1ea5t \u0111\u01b0\u1eddng tr\u00f2n.</p> <p>N\u00f3i c\u00e1ch kh\u00e1c, sau khi x\u00e1o tr\u1ed9n ng\u1eabu nhi\u00ean ban \u0111\u1ea7u, c\u00f3 t\u1ed1i \u0111a x\u00e1c su\u1ea5t $\\frac{2}{j}$ r\u1eb1ng ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c m\u1ed9t trong t\u1ed1i \u0111a hai \u0111i\u1ec3m kh\u00f4ng may m\u1eafn l\u00e0 $p_j$. C\u1ed9ng t\u1ed5ng l\u1ea1i tr\u00ean t\u1ea5t c\u1ea3 $j$ t\u1eeb $1$ \u0111\u1ebfn $i$, ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c th\u1eddi gian ch\u1ea1y k\u1ef3 v\u1ecdng l\u00e0</p> $$ \\sum\\limits_{j=1}^i \\frac{2}{j} \\cdot O(j) = O(i). $$ <p>Theo c\u00e1ch ho\u00e0n to\u00e0n t\u01b0\u01a1ng t\u1ef1, b\u00e2y gi\u1edd ch\u00fang ta c\u0169ng c\u00f3 th\u1ec3 ch\u1ee9ng minh r\u1eb1ng v\u00f2ng l\u1eb7p ngo\u00e0i c\u00f9ng c\u00f3 th\u1eddi gian ch\u1ea1y k\u1ef3 v\u1ecdng l\u00e0 $O(n)$.</p>","tags":["Translated"]},{"location":"geometry/enclosing-circle.html#checking-that-a-point-is-in-the-mec-of-2-or-3-points","title":"Ki\u1ec3m tra xem m\u1ed9t \u0111i\u1ec3m c\u00f3 n\u1eb1m trong MEC c\u1ee7a 2 ho\u1eb7c 3 \u0111i\u1ec3m hay kh\u00f4ng (Checking that a point is in the MEC of 2 or 3 points)","text":"<p>B\u00e2y gi\u1edd h\u00e3y t\u00ecm hi\u1ec3u chi ti\u1ebft c\u00e0i \u0111\u1eb7t c\u1ee7a <code>point</code> v\u00e0 <code>mec</code>. Trong b\u00e0i to\u00e1n n\u00e0y, h\u00f3a ra vi\u1ec7c s\u1eed d\u1ee5ng std::complex l\u00e0m l\u1edbp cho c\u00e1c \u0111i\u1ec3m \u0111\u1eb7c bi\u1ec7t h\u1eefu \u00edch:</p> <pre><code>using ftype = int64_t;\nusing point = complex&lt;ftype&gt;;\n</code></pre> <p>Xin nh\u1eafc l\u1ea1i, s\u1ed1 ph\u1ee9c l\u00e0 m\u1ed9t s\u1ed1 lo\u1ea1i $x+yi$, trong \u0111\u00f3 $i^2=-1$ v\u00e0 $x, y \\in \\mathbb R$. Trong C++, s\u1ed1 ph\u1ee9c nh\u01b0 v\u1eady \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n b\u1edfi m\u1ed9t \u0111i\u1ec3m 2 chi\u1ec1u $(x, y)$. C\u00e1c s\u1ed1 ph\u1ee9c \u0111\u00e3 c\u00e0i \u0111\u1eb7t c\u00e1c ph\u00e9p to\u00e1n tuy\u1ebfn t\u00ednh theo t\u1eebng th\u00e0nh ph\u1ea7n c\u01a1 b\u1ea3n (c\u1ed9ng, nh\u00e2n v\u1edbi m\u1ed9t s\u1ed1 th\u1ef1c), nh\u01b0ng ph\u00e9p nh\u00e2n v\u00e0 ph\u00e9p chia c\u1ee7a ch\u00fang c\u0169ng mang \u00fd ngh\u0129a h\u00ecnh h\u1ecdc nh\u1ea5t \u0111\u1ecbnh.</p> <p>Kh\u00f4ng \u0111i s\u00e2u v\u00e0o qu\u00e1 nhi\u1ec1u chi ti\u1ebft, ch\u00fang ta s\u1ebd l\u01b0u \u00fd t\u00ednh ch\u1ea5t quan tr\u1ecdng nh\u1ea5t cho nhi\u1ec7m v\u1ee5 c\u1ee5 th\u1ec3 n\u00e0y: Nh\u00e2n hai s\u1ed1 ph\u1ee9c s\u1ebd c\u1ed9ng c\u00e1c g\u00f3c c\u1ef1c (polar angles) c\u1ee7a ch\u00fang (t\u00ednh t\u1eeb $Ox$ ng\u01b0\u1ee3c chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3), v\u00e0 l\u1ea5y li\u00ean h\u1ee3p (ngh\u0129a l\u00e0 thay \u0111\u1ed5i $z=x+yi$ th\u00e0nh $\\overline{z} = x-yi$) s\u1ebd nh\u00e2n g\u00f3c c\u1ef1c v\u1edbi $-1$. \u0110i\u1ec1u n\u00e0y cho ph\u00e9p ch\u00fang ta x\u00e2y d\u1ef1ng m\u1ed9t s\u1ed1 ti\u00eau ch\u00ed r\u1ea5t \u0111\u01a1n gi\u1ea3n \u0111\u1ec3 bi\u1ebft li\u1ec7u m\u1ed9t \u0111i\u1ec3m $z$ c\u00f3 n\u1eb1m trong MEC c\u1ee7a $2$ ho\u1eb7c $3$ \u0111i\u1ec3m c\u1ee5 th\u1ec3 hay kh\u00f4ng.</p>","tags":["Translated"]},{"location":"geometry/enclosing-circle.html#mec-of-2-points","title":"MEC c\u1ee7a 2 \u0111i\u1ec3m","text":"<p>\u0110\u1ed1i v\u1edbi $2$ \u0111i\u1ec3m $a$ v\u00e0 $b$, MEC c\u1ee7a ch\u00fang \u0111\u01a1n gi\u1ea3n l\u00e0 \u0111\u01b0\u1eddng tr\u00f2n c\u00f3 t\u00e2m t\u1ea1i $\\frac{a+b}{2}$ v\u1edbi b\u00e1n k\u00ednh $\\frac{|a-b|}{2}$, n\u00f3i c\u00e1ch kh\u00e1c l\u00e0 \u0111\u01b0\u1eddng tr\u00f2n c\u00f3 $ab$ l\u00e0 \u0111\u01b0\u1eddng k\u00ednh. \u0110\u1ec3 ki\u1ec3m tra xem $z$ c\u00f3 n\u1eb1m trong \u0111\u01b0\u1eddng tr\u00f2n n\u00e0y hay kh\u00f4ng, ch\u00fang ta ch\u1ec9 c\u1ea7n ki\u1ec3m tra xem g\u00f3c gi\u1eefa $za$ v\u00e0 $zb$ c\u00f3 kh\u00f4ng nh\u1ecdn hay kh\u00f4ng.</p> G\u00f3c trong l\u00e0 g\u00f3c t\u00f9, g\u00f3c ngo\u00e0i l\u00e0 g\u00f3c nh\u1ecdn v\u00e0 g\u00f3c tr\u00ean chu vi l\u00e0 g\u00f3c vu\u00f4ng <p>T\u01b0\u01a1ng \u0111\u01b0\u01a1ng, ch\u00fang ta c\u1ea7n ki\u1ec3m tra xem</p> $$ I_0=(b-z)\\overline{(a-z)} $$ <p>kh\u00f4ng c\u00f3 t\u1ecda \u0111\u1ed9 th\u1ef1c d\u01b0\u01a1ng (t\u01b0\u01a1ng \u1ee9ng v\u1edbi c\u00e1c \u0111i\u1ec3m c\u00f3 g\u00f3c c\u1ef1c n\u1eb1m gi\u1eefa $-90^\\circ$ v\u00e0 $90^\\circ$).</p>","tags":["Translated"]},{"location":"geometry/enclosing-circle.html#mec-of-3-points","title":"MEC c\u1ee7a 3 \u0111i\u1ec3m","text":"<p>Th\u00eam $z$ v\u00e0o tam gi\u00e1c $abc$ s\u1ebd t\u1ea1o th\u00e0nh m\u1ed9t t\u1ee9 gi\u00e1c. Xem x\u00e9t bi\u1ec3u th\u1ee9c sau:</p> $$ \\angle azb + \\angle bca $$ <p>Trong m\u1ed9t t\u1ee9 gi\u00e1c n\u1ed9i ti\u1ebfp, n\u1ebfu $c$ v\u00e0 $z$ n\u1eb1m c\u00f9ng ph\u00eda c\u1ee7a $ab$, th\u00ec c\u00e1c g\u00f3c b\u1eb1ng nhau, v\u00e0 s\u1ebd c\u1ed9ng l\u1ea1i th\u00e0nh $0^\\circ$ khi t\u1ed5ng c\u00f3 d\u1ea5u (t\u1ee9c l\u00e0 d\u01b0\u01a1ng n\u1ebfu ng\u01b0\u1ee3c chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3 v\u00e0 \u00e2m n\u1ebfu c\u00f9ng chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3). T\u01b0\u01a1ng \u1ee9ng, n\u1ebfu $c$ v\u00e0 $z$ \u1edf hai ph\u00eda \u0111\u1ed1i di\u1ec7n, c\u00e1c g\u00f3c s\u1ebd c\u1ed9ng l\u1ea1i th\u00e0nh $180^\\circ$.</p> C\u00e1c g\u00f3c n\u1ed9i ti\u1ebfp li\u1ec1n k\u1ec1 gi\u1ed1ng nhau, c\u00e1c g\u00f3c \u0111\u1ed1i di\u1ec7n b\u00f9 nhau th\u00e0nh 180 \u0111\u1ed9 <p>V\u1ec1 s\u1ed1 ph\u1ee9c, ch\u00fang ta c\u00f3 th\u1ec3 l\u01b0u \u00fd r\u1eb1ng $\\angle azb$ l\u00e0 g\u00f3c c\u1ef1c c\u1ee7a $(b-z)\\overline{(a-z)}$ v\u00e0 $\\angle bca$ l\u00e0 g\u00f3c c\u1ef1c c\u1ee7a $(a-c)\\overline{(b-c)}$. Do \u0111\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 k\u1ebft lu\u1eadn r\u1eb1ng $\\angle azb + \\angle bca$ l\u00e0 g\u00f3c c\u1ef1c c\u1ee7a</p> $$ I_1 = (b-z) \\overline{(a-z)} (a-c) \\overline{(b-c)} $$ <p>N\u1ebfu g\u00f3c l\u00e0 $0^\\circ$ ho\u1eb7c $180^\\circ$, \u0111i\u1ec1u \u0111\u00f3 c\u00f3 ngh\u0129a l\u00e0 ph\u1ea7n \u1ea3o c\u1ee7a $I_1$ l\u00e0 $0$, ng\u01b0\u1ee3c l\u1ea1i ch\u00fang ta c\u00f3 th\u1ec3 suy ra $z$ n\u1eb1m trong hay n\u1eb1m ngo\u00e0i \u0111\u01b0\u1eddng tr\u00f2n bao c\u1ee7a $abc$ b\u1eb1ng c\u00e1ch ki\u1ec3m tra d\u1ea5u c\u1ee7a ph\u1ea7n \u1ea3o c\u1ee7a $I_1$. Ph\u1ea7n \u1ea3o d\u01b0\u01a1ng t\u01b0\u01a1ng \u1ee9ng v\u1edbi c\u00e1c g\u00f3c d\u01b0\u01a1ng, v\u00e0 ph\u1ea7n \u1ea3o \u00e2m t\u01b0\u01a1ng \u1ee9ng v\u1edbi c\u00e1c g\u00f3c \u00e2m.</p> <p>Nh\u01b0ng c\u00e1i n\u00e0o trong s\u1ed1 ch\u00fang c\u00f3 ngh\u0129a l\u00e0 $z$ \u1edf trong hay \u1edf ngo\u00e0i \u0111\u01b0\u1eddng tr\u00f2n? Nh\u01b0 ch\u00fang ta \u0111\u00e3 nh\u1eadn th\u1ea5y, vi\u1ec7c c\u00f3 $z$ b\u00ean trong \u0111\u01b0\u1eddng tr\u00f2n th\u01b0\u1eddng l\u00e0m t\u0103ng \u0111\u1ed9 l\u1edbn c\u1ee7a $\\angle azb$, trong khi vi\u1ec7c c\u00f3 n\u00f3 b\u00ean ngo\u00e0i \u0111\u01b0\u1eddng tr\u00f2n s\u1ebd l\u00e0m gi\u1ea3m n\u00f3. Nh\u01b0 v\u1eady, ch\u00fang ta c\u00f3 4 tr\u01b0\u1eddng h\u1ee3p sau:</p> <ol> <li>$\\angle bca &gt; 0^\\circ$, $c$ \u1edf c\u00f9ng ph\u00eda c\u1ee7a $ab$ v\u1edbi $z$. Khi \u0111\u00f3, $\\angle azb &lt; 0^\\circ$, v\u00e0 $\\angle azb + \\angle bca &lt; 0^\\circ$ \u0111\u1ed1i v\u1edbi c\u00e1c \u0111i\u1ec3m b\u00ean trong \u0111\u01b0\u1eddng tr\u00f2n.</li> <li>$\\angle bca &lt; 0^\\circ$, $c$ \u1edf c\u00f9ng ph\u00eda c\u1ee7a $ab$ v\u1edbi $z$. Khi \u0111\u00f3, $\\angle azb &gt; 0^\\circ$, v\u00e0 $\\angle azb + \\angle bca &gt; 0^\\circ$ \u0111\u1ed1i v\u1edbi c\u00e1c \u0111i\u1ec3m b\u00ean trong \u0111\u01b0\u1eddng tr\u00f2n.</li> <li>$\\angle bca &gt; 0^\\circ$, $c$ \u1edf ph\u00eda \u0111\u1ed1i di\u1ec7n c\u1ee7a $ab$ v\u1edbi $z$. Khi \u0111\u00f3, $\\angle azb &gt; 0^\\circ$ v\u00e0 $\\angle azb + \\angle bca &gt; 180^\\circ$ \u0111\u1ed1i v\u1edbi c\u00e1c \u0111i\u1ec3m b\u00ean trong \u0111\u01b0\u1eddng tr\u00f2n.</li> <li>$\\angle bca &lt; 0^\\circ$, $c$ \u1edf ph\u00eda \u0111\u1ed1i di\u1ec7n c\u1ee7a $ab$ v\u1edbi $z$. Khi \u0111\u00f3, $\\angle azb &lt; 0^\\circ$ v\u00e0 $\\angle azb + \\angle bca &lt; 180^\\circ$ \u0111\u1ed1i v\u1edbi c\u00e1c \u0111i\u1ec3m b\u00ean trong \u0111\u01b0\u1eddng tr\u00f2n.</li> </ol> <p>N\u00f3i c\u00e1ch kh\u00e1c, n\u1ebfu $\\angle bca$ l\u00e0 d\u01b0\u01a1ng, c\u00e1c \u0111i\u1ec3m b\u00ean trong \u0111\u01b0\u1eddng tr\u00f2n s\u1ebd c\u00f3 $\\angle azb + \\angle bca &lt; 0^\\circ$, ng\u01b0\u1ee3c l\u1ea1i ch\u00fang s\u1ebd c\u00f3 $\\angle azb + \\angle bca &gt; 0^\\circ$, gi\u1ea3 s\u1eed r\u1eb1ng ch\u00fang ta chu\u1ea9n h\u00f3a c\u00e1c g\u00f3c trong kho\u1ea3ng $-180^\\circ$ v\u00e0 $180^\\circ$. \u0110i\u1ec1u n\u00e0y, \u0111\u1ebfn l\u01b0\u1ee3t n\u00f3, c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c ki\u1ec3m tra b\u1eb1ng c\u00e1c d\u1ea5u c\u1ee7a ph\u1ea7n \u1ea3o c\u1ee7a $I_2=(a-c)\\overline{(b-c)}$ v\u00e0 $I_1 = I_0 I_2$.</p> <p>L\u01b0u \u00fd: V\u00ec ch\u00fang ta nh\u00e2n b\u1ed1n s\u1ed1 ph\u1ee9c \u0111\u1ec3 c\u00f3 \u0111\u01b0\u1ee3c $I_1$, c\u00e1c h\u1ec7 s\u1ed1 trung gian c\u00f3 th\u1ec3 l\u1edbn t\u1edbi $O(A^4)$, trong \u0111\u00f3 $A$ l\u00e0 \u0111\u1ed9 l\u1edbn t\u1ecda \u0111\u1ed9 l\u1edbn nh\u1ea5t trong \u0111\u1ea7u v\u00e0o. V\u1ec1 m\u1eb7t t\u00edch c\u1ef1c, n\u1ebfu \u0111\u1ea7u v\u00e0o l\u00e0 s\u1ed1 nguy\u00ean, c\u1ea3 hai ki\u1ec3m tra tr\u00ean \u0111\u1ec1u c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n ho\u00e0n to\u00e0n b\u1eb1ng s\u1ed1 nguy\u00ean.</p>","tags":["Translated"]},{"location":"geometry/enclosing-circle.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>B\u00e2y gi\u1edd, \u0111\u1ec3 th\u1ef1c s\u1ef1 c\u00e0i \u0111\u1eb7t vi\u1ec7c ki\u1ec3m tra, tr\u01b0\u1edbc ti\u00ean ch\u00fang ta n\u00ean quy\u1ebft \u0111\u1ecbnh c\u00e1ch bi\u1ec3u di\u1ec5n MEC. V\u00ec c\u00e1c ti\u00eau ch\u00ed c\u1ee7a ch\u00fang ta l\u00e0m vi\u1ec7c tr\u1ef1c ti\u1ebfp v\u1edbi c\u00e1c \u0111i\u1ec3m, m\u1ed9t c\u00e1ch t\u1ef1 nhi\u00ean v\u00e0 hi\u1ec7u qu\u1ea3 \u0111\u1ec3 th\u1ef1c hi\u1ec7n \u0111i\u1ec1u n\u00e0y l\u00e0 n\u00f3i r\u1eb1ng MEC \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n tr\u1ef1c ti\u1ebfp d\u01b0\u1edbi d\u1ea1ng m\u1ed9t c\u1eb7p ho\u1eb7c b\u1ed9 ba \u0111i\u1ec3m x\u00e1c \u0111\u1ecbnh n\u00f3:</p> <pre><code>using mec = variant&lt;\n    array&lt;point, 2&gt;,\n    array&lt;point, 3&gt;\n&gt;;\n</code></pre> <p>B\u00e2y gi\u1edd, ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng <code>std::visit</code> \u0111\u1ec3 gi\u1ea3i quy\u1ebft hi\u1ec7u qu\u1ea3 c\u1ea3 hai tr\u01b0\u1eddng h\u1ee3p ph\u00f9 h\u1ee3p v\u1edbi c\u00e1c ti\u00eau ch\u00ed tr\u00ean:</p> <pre><code>/* I &lt; 0 if z inside C,\n   I &gt; 0 if z outside C,\n   I = 0 if z on the circumference of C */\nftype indicator(mec const&amp; C, point z) {\n    return visit([&amp;](auto &amp;&amp;C) {\n        point a = C[0], b = C[1];\n        point I0 = (b - z) * conj(a - z);\n        if constexpr (size(C) == 2) {\n            return real(I0);\n        } else {\n            point c = C[2];\n            point I2 = (a - c) * conj(b - c);\n            point I1 = I0 * I2;\n            return imag(I2) &lt; 0 ? -imag(I1) : imag(I1);\n        }\n    }, C);\n}\n\nbool inside(mec const&amp; C, point p) {\n    return indicator(C, p) &lt;= 0;\n}\n</code></pre> <p>B\u00e2y gi\u1edd, cu\u1ed1i c\u00f9ng ch\u00fang ta c\u00f3 th\u1ec3 \u0111\u1ea3m b\u1ea3o r\u1eb1ng m\u1ecdi th\u1ee9 ho\u1ea1t \u0111\u1ed9ng b\u1eb1ng c\u00e1ch n\u1ed9p b\u00e0i to\u00e1n l\u00ean Library Checker: #308668.</p>","tags":["Translated"]},{"location":"geometry/enclosing-circle.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice problems)","text":"<ul> <li>Library Checker - Minimum Enclosing Circle</li> <li>BOI 2002 - Aliens</li> </ul>","tags":["Translated"]},{"location":"geometry/halfplane-intersection.html","title":"Giao c\u1ee7a c\u00e1c n\u1eeda m\u1eb7t ph\u1eb3ng (Half-plane intersection)","text":"<p>Trong b\u00e0i vi\u1ebft n\u00e0y, ch\u00fang ta s\u1ebd th\u1ea3o lu\u1eadn v\u1ec1 b\u00e0i to\u00e1n t\u00ednh to\u00e1n ph\u1ea7n giao c\u1ee7a m\u1ed9t t\u1eadp h\u1ee3p c\u00e1c n\u1eeda m\u1eb7t ph\u1eb3ng. M\u1ed9t ph\u1ea7n giao nh\u01b0 v\u1eady c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n thu\u1eadn ti\u1ec7n d\u01b0\u1edbi d\u1ea1ng m\u1ed9t v\u00f9ng/\u0111a gi\u00e1c l\u1ed3i, trong \u0111\u00f3 m\u1ecdi \u0111i\u1ec3m b\u00ean trong n\u00f3 c\u0169ng n\u1eb1m b\u00ean trong t\u1ea5t c\u1ea3 c\u00e1c n\u1eeda m\u1eb7t ph\u1eb3ng, v\u00e0 ch\u00ednh \u0111a gi\u00e1c n\u00e0y l\u00e0 th\u1ee9 m\u00e0 ch\u00fang ta \u0111ang c\u1ed1 g\u1eafng t\u00ecm ho\u1eb7c x\u00e2y d\u1ef1ng. Ch\u00fang t\u00f4i \u0111\u01b0a ra m\u1ed9t s\u1ed1 tr\u1ef1c gi\u00e1c ban \u0111\u1ea7u cho b\u00e0i to\u00e1n, m\u00f4 t\u1ea3 m\u1ed9t c\u00e1ch ti\u1ebfp c\u1eadn $O(N \\log N)$ \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 thu\u1eadt to\u00e1n S\u1eafp x\u1ebfp v\u00e0 T\u0103ng d\u1ea7n (Sort-and-Incremental algorithm) v\u00e0 \u0111\u01b0a ra m\u1ed9t s\u1ed1 \u1ee9ng d\u1ee5ng m\u1eabu c\u1ee7a k\u1ef9 thu\u1eadt n\u00e0y.</p> <p>Ch\u00fang t\u00f4i th\u1ef1c s\u1ef1 khuy\u00ean b\u1ea1n \u0111\u1ecdc n\u00ean l\u00e0m quen v\u1edbi c\u00e1c nguy\u00ean th\u1ee7y v\u00e0 ph\u00e9p to\u00e1n h\u00ecnh h\u1ecdc c\u01a1 b\u1ea3n (\u0111i\u1ec3m, vector, giao \u0111i\u1ec3m c\u1ee7a c\u00e1c \u0111\u01b0\u1eddng th\u1eb3ng). Ngo\u00e0i ra, ki\u1ebfn th\u1ee9c v\u1ec1 Bao l\u1ed3i (Convex Hulls) ho\u1eb7c Th\u1ee7 thu\u1eadt Bao l\u1ed3i (Convex Hull Trick) c\u00f3 th\u1ec3 gi\u00fap hi\u1ec3u r\u00f5 h\u01a1n c\u00e1c kh\u00e1i ni\u1ec7m trong b\u00e0i vi\u1ebft n\u00e0y, nh\u01b0ng ch\u00fang kh\u00f4ng ph\u1ea3i l\u00e0 \u0111i\u1ec1u ki\u1ec7n ti\u00ean quy\u1ebft b\u1eb1ng b\u1ea5t k\u1ef3 c\u00e1ch n\u00e0o.</p>","tags":["Original"]},{"location":"geometry/halfplane-intersection.html#initial-clarifications-and-definitions","title":"C\u00e1c l\u00e0m r\u00f5 v\u00e0 \u0111\u1ecbnh ngh\u0129a ban \u0111\u1ea7u (Initial clarifications and definitions)","text":"<p>\u0110\u1ed1i v\u1edbi to\u00e0n b\u1ed9 b\u00e0i vi\u1ebft, ch\u00fang t\u00f4i s\u1ebd \u0111\u01b0a ra m\u1ed9t s\u1ed1 gi\u1ea3 \u0111\u1ecbnh (tr\u1eeb khi \u0111\u01b0\u1ee3c ch\u1ec9 \u0111\u1ecbnh kh\u00e1c):</p> <ol> <li>Ch\u00fang ta \u0111\u1ecbnh ngh\u0129a $N$ l\u00e0 s\u1ed1 l\u01b0\u1ee3ng n\u1eeda m\u1eb7t ph\u1eb3ng trong t\u1eadp h\u1ee3p \u0111\u00e3 cho.</li> <li>Ch\u00fang ta s\u1ebd bi\u1ec3u di\u1ec5n c\u00e1c \u0111\u01b0\u1eddng th\u1eb3ng v\u00e0 n\u1eeda m\u1eb7t ph\u1eb3ng b\u1eb1ng m\u1ed9t \u0111i\u1ec3m v\u00e0 m\u1ed9t vector (b\u1ea5t k\u1ef3 \u0111i\u1ec3m n\u00e0o n\u1eb1m tr\u00ean \u0111\u01b0\u1eddng th\u1eb3ng \u0111\u00e3 cho, v\u00e0 vector ch\u1ec9 ph\u01b0\u01a1ng c\u1ee7a \u0111\u01b0\u1eddng th\u1eb3ng). Trong tr\u01b0\u1eddng h\u1ee3p c\u00e1c n\u1eeda m\u1eb7t ph\u1eb3ng, ch\u00fang ta gi\u1ea3 \u0111\u1ecbnh r\u1eb1ng m\u1ecdi n\u1eeda m\u1eb7t ph\u1eb3ng \u0111\u1ec1u cho ph\u00e9p v\u00f9ng \u1edf ph\u00eda b\u00ean tr\u00e1i c\u1ee7a vector ch\u1ec9 ph\u01b0\u01a1ng c\u1ee7a n\u00f3. Ngo\u00e0i ra, ch\u00fang ta \u0111\u1ecbnh ngh\u0129a g\u00f3c c\u1ee7a m\u1ed9t n\u1eeda m\u1eb7t ph\u1eb3ng l\u00e0 g\u00f3c c\u1ef1c (polar angle) c\u1ee7a vector ch\u1ec9 ph\u01b0\u01a1ng c\u1ee7a n\u00f3. Xem h\u00ecnh \u1ea3nh b\u00ean d\u01b0\u1edbi \u0111\u1ec3 v\u00ed d\u1ee5.</li> <li>Ch\u00fang ta s\u1ebd gi\u1ea3 \u0111\u1ecbnh r\u1eb1ng ph\u1ea7n giao k\u1ebft qu\u1ea3 lu\u00f4n b\u1ecb gi\u1edbi h\u1ea1n ho\u1eb7c r\u1ed7ng. N\u1ebfu ch\u00fang ta c\u1ea7n x\u1eed l\u00fd tr\u01b0\u1eddng h\u1ee3p kh\u00f4ng b\u1ecb gi\u1edbi h\u1ea1n, ch\u00fang ta c\u00f3 th\u1ec3 ch\u1ec9 c\u1ea7n th\u00eam 4 n\u1eeda m\u1eb7t ph\u1eb3ng \u0111\u1ecbnh ngh\u0129a m\u1ed9t h\u1ed9p bao (bounding box) \u0111\u1ee7 l\u1edbn.</li> <li>\u0110\u1ec3 \u0111\u01a1n gi\u1ea3n, ch\u00fang ta s\u1ebd gi\u1ea3 \u0111\u1ecbnh r\u1eb1ng kh\u00f4ng c\u00f3 n\u1eeda m\u1eb7t ph\u1eb3ng song song n\u00e0o trong t\u1eadp h\u1ee3p \u0111\u00e3 cho. V\u1ec1 ph\u00eda cu\u1ed1i b\u00e0i vi\u1ebft, ch\u00fang ta s\u1ebd th\u1ea3o lu\u1eadn v\u1ec1 c\u00e1ch gi\u1ea3i quy\u1ebft nh\u1eefng tr\u01b0\u1eddng h\u1ee3p nh\u01b0 v\u1eady.</li> </ol> <p></p> <p>N\u1eeda m\u1eb7t ph\u1eb3ng $y \\geq 2x - 2$ c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n d\u01b0\u1edbi d\u1ea1ng \u0111i\u1ec3m $P = (1, 0)$ v\u1edbi vector ch\u1ec9 ph\u01b0\u01a1ng $PQ = Q - P = (1, 2)$</p>","tags":["Original"]},{"location":"geometry/halfplane-intersection.html#brute-force-approach-on3","title":"C\u00e1ch ti\u1ebfp c\u1eadn v\u1ebft c\u1ea1n - $O(N^3)$ (Brute force approach - $O(N^3)$)","text":"<p>M\u1ed9t trong nh\u1eefng gi\u1ea3i ph\u00e1p \u0111\u01a1n gi\u1ea3n v\u00e0 r\u00f5 r\u00e0ng nh\u1ea5t l\u00e0 t\u00ednh to\u00e1n giao \u0111i\u1ec3m c\u1ee7a c\u00e1c \u0111\u01b0\u1eddng th\u1eb3ng c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c c\u1eb7p n\u1eeda m\u1eb7t ph\u1eb3ng v\u00e0, \u0111\u1ed1i v\u1edbi m\u1ed7i \u0111i\u1ec3m, ki\u1ec3m tra xem n\u00f3 c\u00f3 n\u1eb1m trong t\u1ea5t c\u1ea3 c\u00e1c n\u1eeda m\u1eb7t ph\u1eb3ng kh\u00e1c hay kh\u00f4ng. V\u00ec c\u00f3 $O(N^2)$ giao \u0111i\u1ec3m, v\u00e0 \u0111\u1ed1i v\u1edbi m\u1ed7i giao \u0111i\u1ec3m, ch\u00fang ta ph\u1ea3i ki\u1ec3m tra $O(N)$ n\u1eeda m\u1eb7t ph\u1eb3ng, t\u1ed5ng \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian l\u00e0 $O(N^3)$. V\u00f9ng th\u1ef1c t\u1ebf c\u1ee7a ph\u1ea7n giao sau \u0111\u00f3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00e1i t\u1ea1o b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng, v\u00ed d\u1ee5, thu\u1eadt to\u00e1n Bao l\u1ed3i tr\u00ean t\u1eadp h\u1ee3p c\u00e1c giao \u0111i\u1ec3m \u0111\u01b0\u1ee3c bao g\u1ed3m trong t\u1ea5t c\u1ea3 c\u00e1c n\u1eeda m\u1eb7t ph\u1eb3ng.</p> <p>Kh\u00e1 d\u1ec5 \u0111\u1ec3 th\u1ea5y t\u1ea1i sao \u0111i\u1ec1u n\u00e0y l\u1ea1i ho\u1ea1t \u0111\u1ed9ng: c\u00e1c \u0111\u1ec9nh c\u1ee7a \u0111a gi\u00e1c l\u1ed3i k\u1ebft qu\u1ea3 l\u00e0 t\u1ea5t c\u1ea3 c\u00e1c giao \u0111i\u1ec3m c\u1ee7a c\u00e1c \u0111\u01b0\u1eddng th\u1eb3ng n\u1eeda m\u1eb7t ph\u1eb3ng, v\u00e0 m\u1ed7i \u0111\u1ec9nh \u0111\u00f3 r\u00f5 r\u00e0ng l\u00e0 m\u1ed9t ph\u1ea7n c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c n\u1eeda m\u1eb7t ph\u1eb3ng. \u01afu \u0111i\u1ec3m ch\u00ednh c\u1ee7a ph\u01b0\u01a1ng ph\u00e1p n\u00e0y l\u00e0 d\u1ec5 hi\u1ec3u, d\u1ec5 nh\u1edb v\u00e0 d\u1ec5 vi\u1ebft m\u00e3 ngay l\u1eadp t\u1ee9c n\u1ebfu b\u1ea1n ch\u1ec9 c\u1ea7n ki\u1ec3m tra xem ph\u1ea7n giao c\u00f3 r\u1ed7ng hay kh\u00f4ng. Tuy nhi\u00ean, n\u00f3 c\u1ef1c k\u1ef3 ch\u1eadm v\u00e0 kh\u00f4ng ph\u00f9 h\u1ee3p v\u1edbi h\u1ea7u h\u1ebft c\u00e1c b\u00e0i to\u00e1n, v\u00ec v\u1eady ch\u00fang ta c\u1ea7n m\u1ed9t c\u00e1i g\u00ec \u0111\u00f3 nhanh h\u01a1n.</p>","tags":["Original"]},{"location":"geometry/halfplane-intersection.html#incremental-approach-on2","title":"C\u00e1ch ti\u1ebfp c\u1eadn t\u0103ng d\u1ea7n - $O(N^2)$ (Incremental approach - $O(N^2)$)","text":"<p>M\u1ed9t c\u00e1ch ti\u1ebfp c\u1eadn kh\u00e1 \u0111\u01a1n gi\u1ea3n kh\u00e1c l\u00e0 x\u00e2y d\u1ef1ng d\u1ea7n d\u1ea7n ph\u1ea7n giao c\u1ee7a c\u00e1c n\u1eeda m\u1eb7t ph\u1eb3ng, t\u1eebng c\u00e1i m\u1ed9t. Ph\u01b0\u01a1ng ph\u00e1p n\u00e0y v\u1ec1 c\u01a1 b\u1ea3n t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi vi\u1ec7c c\u1eaft m\u1ed9t \u0111a gi\u00e1c l\u1ed3i b\u1eb1ng m\u1ed9t \u0111\u01b0\u1eddng th\u1eb3ng $N$ l\u1ea7n, v\u00e0 lo\u1ea1i b\u1ecf c\u00e1c n\u1eeda m\u1eb7t ph\u1eb3ng d\u01b0 th\u1eeba \u1edf m\u1ed7i b\u01b0\u1edbc. \u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y, ch\u00fang ta c\u00f3 th\u1ec3 bi\u1ec3u di\u1ec5n \u0111a gi\u00e1c l\u1ed3i d\u01b0\u1edbi d\u1ea1ng danh s\u00e1ch c\u00e1c \u0111o\u1ea1n th\u1eb3ng, v\u00e0 \u0111\u1ec3 c\u1eaft n\u00f3 b\u1eb1ng m\u1ed9t n\u1eeda m\u1eb7t ph\u1eb3ng, ch\u00fang ta ch\u1ec9 c\u1ea7n t\u00ecm c\u00e1c giao \u0111i\u1ec3m c\u1ee7a c\u00e1c \u0111o\u1ea1n th\u1eb3ng v\u1edbi \u0111\u01b0\u1eddng th\u1eb3ng n\u1eeda m\u1eb7t ph\u1eb3ng (s\u1ebd ch\u1ec9 c\u00f3 hai giao \u0111i\u1ec3m n\u1ebfu \u0111\u01b0\u1eddng th\u1eb3ng th\u1ef1c s\u1ef1 c\u1eaft \u0111a gi\u00e1c), v\u00e0 thay th\u1ebf t\u1ea5t c\u1ea3 c\u00e1c \u0111o\u1ea1n th\u1eb3ng \u1edf gi\u1eefa b\u1eb1ng \u0111o\u1ea1n m\u1edbi t\u01b0\u01a1ng \u1ee9ng v\u1edbi n\u1eeda m\u1eb7t ph\u1eb3ng. V\u00ec quy tr\u00ecnh nh\u01b0 v\u1eady c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c c\u00e0i \u0111\u1eb7t trong th\u1eddi gian tuy\u1ebfn t\u00ednh, ch\u00fang ta c\u00f3 th\u1ec3 ch\u1ec9 c\u1ea7n b\u1eaft \u0111\u1ea7u v\u1edbi m\u1ed9t h\u1ed9p bao l\u1edbn v\u00e0 c\u1eaft n\u00f3 xu\u1ed1ng b\u1eb1ng t\u1eebng n\u1eeda m\u1eb7t ph\u1eb3ng m\u1ed9t, thu \u0111\u01b0\u1ee3c t\u1ed5ng \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian l\u00e0 $O(N^2)$.</p> <p>Ph\u01b0\u01a1ng ph\u00e1p n\u00e0y l\u00e0 m\u1ed9t b\u01b0\u1edbc ti\u1ebfn l\u1edbn \u0111\u00fang h\u01b0\u1edbng, nh\u01b0ng c\u1ea3m th\u1ea5y l\u00e3ng ph\u00ed khi ph\u1ea3i l\u1eb7p qua $O(N)$ n\u1eeda m\u1eb7t ph\u1eb3ng \u1edf m\u1ed7i b\u01b0\u1edbc. Ch\u00fang ta s\u1ebd th\u1ea5y ti\u1ebfp theo r\u1eb1ng, b\u1eb1ng c\u00e1ch th\u1ef1c hi\u1ec7n m\u1ed9t s\u1ed1 quan s\u00e1t th\u00f4ng minh, c\u00e1c \u00fd t\u01b0\u1edfng \u0111\u1eb1ng sau c\u00e1ch ti\u1ebfp c\u1eadn t\u0103ng d\u1ea7n n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00e1i ch\u1ebf \u0111\u1ec3 t\u1ea1o ra thu\u1eadt to\u00e1n $O(N \\log N)$.</p>","tags":["Original"]},{"location":"geometry/halfplane-intersection.html#sort-and-incremental-algorithm-on-log-n","title":"Thu\u1eadt to\u00e1n S\u1eafp x\u1ebfp v\u00e0 T\u0103ng d\u1ea7n - $O(N \\log N)$ (Sort-and-Incremental algorithm - $O(N \\log N)$)","text":"<p>Ngu\u1ed3n \u0111\u1ea7u ti\u00ean \u0111\u01b0\u1ee3c ghi ch\u00e9p \u0111\u00e0ng ho\u00e0ng v\u1ec1 thu\u1eadt to\u00e1n n\u00e0y m\u00e0 ch\u00fang t\u00f4i c\u00f3 th\u1ec3 t\u00ecm th\u1ea5y l\u00e0 lu\u1eadn \u00e1n c\u1ee7a Zeyuan Zhu cho Cu\u1ed9c thi Ch\u1ecdn \u0111\u1ed9i tuy\u1ec3n Trung Qu\u1ed1c c\u00f3 ti\u00eau \u0111\u1ec1 Thu\u1eadt to\u00e1n m\u1edbi cho Giao c\u1ee7a c\u00e1c n\u1eeda m\u1eb7t ph\u1eb3ng v\u00e0 Gi\u00e1 tr\u1ecb th\u1ef1c ti\u1ec5n c\u1ee7a n\u00f3, t\u1eeb n\u0103m 2006. C\u00e1ch ti\u1ebfp c\u1eadn m\u00e0 ch\u00fang t\u00f4i s\u1ebd m\u00f4 t\u1ea3 ti\u1ebfp theo d\u1ef1a tr\u00ean c\u00f9ng thu\u1eadt to\u00e1n n\u00e0y, nh\u01b0ng thay v\u00ec t\u00ednh to\u00e1n hai giao \u0111i\u1ec3m ri\u00eang bi\u1ec7t cho n\u1eeda d\u01b0\u1edbi v\u00e0 n\u1eeda tr\u00ean c\u1ee7a c\u00e1c giao \u0111i\u1ec3m, ch\u00fang t\u00f4i s\u1ebd x\u00e2y d\u1ef1ng t\u1ea5t c\u1ea3 c\u00f9ng m\u1ed9t l\u00fac trong m\u1ed9t l\u1ea7n chuy\u1ec3n qua v\u1edbi m\u1ed9t deque (h\u00e0ng \u0111\u1ee3i hai \u0111\u1ea7u).</p> <p>B\u1ea3n th\u00e2n thu\u1eadt to\u00e1n, nh\u01b0 t\u00ean g\u1ecdi c\u00f3 th\u1ec3 ti\u1ebft l\u1ed9, t\u1eadn d\u1ee5ng th\u1ef1c t\u1ebf l\u00e0 v\u00f9ng k\u1ebft qu\u1ea3 t\u1eeb giao c\u1ee7a c\u00e1c n\u1eeda m\u1eb7t ph\u1eb3ng l\u00e0 l\u1ed3i, v\u00e0 do \u0111\u00f3 n\u00f3 s\u1ebd bao g\u1ed3m m\u1ed9t s\u1ed1 \u0111o\u1ea1n c\u1ee7a c\u00e1c n\u1eeda m\u1eb7t ph\u1eb3ng theo th\u1ee9 t\u1ef1 \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp theo g\u00f3c c\u1ee7a ch\u00fang. \u0110i\u1ec1u n\u00e0y d\u1eabn \u0111\u1ebfn m\u1ed9t quan s\u00e1t quan tr\u1ecdng: n\u1ebfu ch\u00fang ta giao d\u1ea7n d\u1ea7n c\u00e1c n\u1eeda m\u1eb7t ph\u1eb3ng theo th\u1ee9 t\u1ef1 \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp theo g\u00f3c c\u1ee7a ch\u00fang (nh\u01b0 ch\u00fang s\u1ebd xu\u1ea5t hi\u1ec7n trong h\u00ecnh d\u1ea1ng cu\u1ed1i c\u00f9ng, k\u1ebft qu\u1ea3 c\u1ee7a ph\u1ea7n giao) v\u00e0 l\u01b0u tr\u1eef ch\u00fang trong m\u1ed9t h\u00e0ng \u0111\u1ee3i hai \u0111\u1ea7u, th\u00ec ch\u00fang ta s\u1ebd ch\u1ec9 c\u1ea7n lo\u1ea1i b\u1ecf c\u00e1c n\u1eeda m\u1eb7t ph\u1eb3ng kh\u1ecfi \u0111\u1ea7u v\u00e0 cu\u1ed1i c\u1ee7a deque.</p> <p>\u0110\u1ec3 h\u00ecnh dung th\u1ef1c t\u1ebf n\u00e0y t\u1ed1t h\u01a1n, gi\u1ea3 s\u1eed ch\u00fang ta \u0111ang th\u1ef1c hi\u1ec7n c\u00e1ch ti\u1ebfp c\u1eadn t\u0103ng d\u1ea7n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 tr\u01b0\u1edbc \u0111\u00e2y tr\u00ean m\u1ed9t t\u1eadp h\u1ee3p c\u00e1c n\u1eeda m\u1eb7t ph\u1eb3ng \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp theo g\u00f3c (trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, ch\u00fang ta s\u1ebd gi\u1ea3 s\u1eed ch\u00fang \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp t\u1eeb $-\\pi$ \u0111\u1ebfn $\\pi$), v\u00e0 gi\u1ea3 s\u1eed r\u1eb1ng ch\u00fang ta s\u1eafp b\u1eaft \u0111\u1ea7u m\u1ed9t b\u01b0\u1edbc th\u1ee9 $k$ b\u1ea5t k\u1ef3 n\u00e0o \u0111\u00f3. \u0110i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 ch\u00fang ta \u0111\u00e3 x\u00e2y d\u1ef1ng ph\u1ea7n giao c\u1ee7a $k-1$ n\u1eeda m\u1eb7t ph\u1eb3ng \u0111\u1ea7u ti\u00ean. B\u00e2y gi\u1edd, b\u1edfi v\u00ec c\u00e1c n\u1eeda m\u1eb7t ph\u1eb3ng \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp theo g\u00f3c, b\u1ea5t k\u1ec3 n\u1eeda m\u1eb7t ph\u1eb3ng th\u1ee9 $k$ l\u00e0 g\u00ec, ch\u00fang ta c\u00f3 th\u1ec3 ch\u1eafc ch\u1eafn r\u1eb1ng n\u00f3 s\u1ebd t\u1ea1o th\u00e0nh m\u1ed9t g\u00f3c l\u1ed3i v\u1edbi n\u1eeda m\u1eb7t ph\u1eb3ng th\u1ee9 $(K-1)$. V\u00ec l\u00fd do \u0111\u00f3, m\u1ed9t v\u00e0i \u0111i\u1ec1u c\u00f3 th\u1ec3 x\u1ea3y ra:</p> <ol> <li>M\u1ed9t s\u1ed1 (c\u00f3 th\u1ec3 kh\u00f4ng c\u00f3) n\u1eeda m\u1eb7t ph\u1eb3ng \u1edf ph\u00eda sau c\u1ee7a ph\u1ea7n giao c\u00f3 th\u1ec3 tr\u1edf n\u00ean d\u01b0 th\u1eeba. Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, ch\u00fang ta c\u1ea7n pop c\u00e1c n\u1eeda m\u1eb7t ph\u1eb3ng v\u00f4 d\u1ee5ng n\u00e0y kh\u1ecfi ph\u00eda sau c\u1ee7a deque.</li> <li>M\u1ed9t s\u1ed1 (c\u00f3 th\u1ec3 kh\u00f4ng c\u00f3) n\u1eeda m\u1eb7t ph\u1eb3ng \u1edf ph\u00eda tr\u01b0\u1edbc c\u00f3 th\u1ec3 tr\u1edf n\u00ean d\u01b0 th\u1eeba. T\u01b0\u01a1ng t\u1ef1 nh\u01b0 tr\u01b0\u1eddng h\u1ee3p 1, ch\u00fang ta ch\u1ec9 c\u1ea7n pop ch\u00fang kh\u1ecfi ph\u00eda tr\u01b0\u1edbc c\u1ee7a deque.</li> <li>Ph\u1ea7n giao c\u00f3 th\u1ec3 tr\u1edf n\u00ean r\u1ed7ng (sau khi x\u1eed l\u00fd c\u00e1c tr\u01b0\u1eddng h\u1ee3p 1 v\u00e0/ho\u1eb7c 2). Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, ch\u00fang ta ch\u1ec9 c\u1ea7n b\u00e1o c\u00e1o ph\u1ea7n giao l\u00e0 r\u1ed7ng v\u00e0 k\u1ebft th\u00fac thu\u1eadt to\u00e1n.</li> </ol> <p>Ch\u00fang ta n\u00f3i m\u1ed9t n\u1eeda m\u1eb7t ph\u1eb3ng l\u00e0 \"d\u01b0 th\u1eeba\" n\u1ebfu n\u00f3 kh\u00f4ng \u0111\u00f3ng g\u00f3p g\u00ec v\u00e0o ph\u1ea7n giao. N\u1eeda m\u1eb7t ph\u1eb3ng nh\u01b0 v\u1eady c\u00f3 th\u1ec3 b\u1ecb lo\u1ea1i b\u1ecf v\u00e0 ph\u1ea7n giao k\u1ebft qu\u1ea3 s\u1ebd kh\u00f4ng thay \u0111\u1ed5i ch\u00fat n\u00e0o.</p> <p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u1ed9t v\u00ed d\u1ee5 nh\u1ecf v\u1edbi minh h\u1ecda:</p> <p>G\u1ecdi $H = \\{ A, B, C, D, E \\}$ l\u00e0 t\u1eadp h\u1ee3p c\u00e1c n\u1eeda m\u1eb7t ph\u1eb3ng hi\u1ec7n c\u00f3 trong ph\u1ea7n giao. Ngo\u00e0i ra, g\u1ecdi $P = \\{ p, q, r, s \\}$ l\u00e0 t\u1eadp h\u1ee3p c\u00e1c giao \u0111i\u1ec3m c\u1ee7a c\u00e1c n\u1eeda m\u1eb7t ph\u1eb3ng li\u1ec1n k\u1ec1 trong H. B\u00e2y gi\u1edd, gi\u1ea3 s\u1eed ch\u00fang ta mu\u1ed1n giao n\u00f3 v\u1edbi n\u1eeda m\u1eb7t ph\u1eb3ng $F$, nh\u01b0 th\u1ea5y trong h\u00ecnh minh h\u1ecda b\u00ean d\u01b0\u1edbi:</p> <p></p> <p>L\u01b0u \u00fd r\u1eb1ng n\u1eeda m\u1eb7t ph\u1eb3ng $F$ l\u00e0m cho $A$ v\u00e0 $E$ tr\u1edf n\u00ean d\u01b0 th\u1eeba trong ph\u1ea7n giao. V\u00ec v\u1eady, ch\u00fang ta lo\u1ea1i b\u1ecf c\u1ea3 $A$ v\u00e0 $E$ kh\u1ecfi ph\u00eda tr\u01b0\u1edbc v\u00e0 ph\u00eda sau c\u1ee7a ph\u1ea7n giao, t\u01b0\u01a1ng \u1ee9ng, v\u00e0 th\u00eam $F$ v\u00e0o cu\u1ed1i. V\u00e0 cu\u1ed1i c\u00f9ng ch\u00fang ta thu \u0111\u01b0\u1ee3c ph\u1ea7n giao m\u1edbi $H = \\{ B, C, D, F\\}$ v\u1edbi $P = \\{ q, r, t, u \\}$.</p> <p></p> <p>V\u1edbi t\u1ea5t c\u1ea3 nh\u1eefng \u0111i\u1ec1u n\u00e0y trong t\u00e2m tr\u00ed, ch\u00fang ta c\u00f3 h\u1ea7u h\u1ebft m\u1ecdi th\u1ee9 ch\u00fang ta c\u1ea7n \u0111\u1ec3 th\u1ef1c s\u1ef1 c\u00e0i \u0111\u1eb7t thu\u1eadt to\u00e1n, nh\u01b0ng ch\u00fang ta v\u1eabn c\u1ea7n n\u00f3i v\u1ec1 m\u1ed9t s\u1ed1 tr\u01b0\u1eddng h\u1ee3p \u0111\u1eb7c bi\u1ec7t. \u1ede \u0111\u1ea7u b\u00e0i vi\u1ebft, ch\u00fang ta \u0111\u00e3 n\u00f3i r\u1eb1ng ch\u00fang ta s\u1ebd th\u00eam m\u1ed9t h\u1ed9p bao \u0111\u1ec3 x\u1eed l\u00fd c\u00e1c tr\u01b0\u1eddng h\u1ee3p ph\u1ea7n giao c\u00f3 th\u1ec3 kh\u00f4ng b\u1ecb gi\u1edbi h\u1ea1n, v\u00ec v\u1eady tr\u01b0\u1eddng h\u1ee3p kh\u00f3 kh\u0103n duy nh\u1ea5t ch\u00fang ta th\u1ef1c s\u1ef1 c\u1ea7n x\u1eed l\u00fd l\u00e0 c\u00e1c n\u1eeda m\u1eb7t ph\u1eb3ng song song. Ch\u00fang ta c\u00f3 th\u1ec3 c\u00f3 hai tr\u01b0\u1eddng h\u1ee3p ph\u1ee5: hai n\u1eeda m\u1eb7t ph\u1eb3ng c\u00f3 th\u1ec3 song song v\u1edbi c\u00f9ng h\u01b0\u1edbng ho\u1eb7c ng\u01b0\u1ee3c h\u01b0\u1edbng. L\u00fd do tr\u01b0\u1eddng h\u1ee3p n\u00e0y c\u1ea7n \u0111\u01b0\u1ee3c x\u1eed l\u00fd ri\u00eang l\u00e0 v\u00ec ch\u00fang ta s\u1ebd c\u1ea7n t\u00ednh to\u00e1n giao \u0111i\u1ec3m c\u1ee7a c\u00e1c \u0111\u01b0\u1eddng th\u1eb3ng n\u1eeda m\u1eb7t ph\u1eb3ng \u0111\u1ec3 c\u00f3 th\u1ec3 ki\u1ec3m tra xem m\u1ed9t n\u1eeda m\u1eb7t ph\u1eb3ng c\u00f3 d\u01b0 th\u1eeba hay kh\u00f4ng, v\u00e0 hai \u0111\u01b0\u1eddng th\u1eb3ng song song kh\u00f4ng c\u00f3 giao \u0111i\u1ec3m, v\u00ec v\u1eady ch\u00fang ta c\u1ea7n m\u1ed9t c\u00e1ch \u0111\u1eb7c bi\u1ec7t \u0111\u1ec3 \u0111\u1ed1i ph\u00f3 v\u1edbi ch\u00fang.</p> <p>\u0110\u1ed1i v\u1edbi tr\u01b0\u1eddng h\u1ee3p c\u00e1c n\u1eeda m\u1eb7t ph\u1eb3ng song song c\u00f3 h\u01b0\u1edbng ng\u01b0\u1ee3c nhau: L\u01b0u \u00fd r\u1eb1ng, v\u00ec ch\u00fang ta \u0111ang th\u00eam h\u1ed9p bao \u0111\u1ec3 \u0111\u1ed1i ph\u00f3 v\u1edbi tr\u01b0\u1eddng h\u1ee3p kh\u00f4ng b\u1ecb gi\u1edbi h\u1ea1n, \u0111i\u1ec1u n\u00e0y c\u0169ng gi\u1ea3i quy\u1ebft tr\u01b0\u1eddng h\u1ee3p ch\u00fang ta c\u00f3 hai n\u1eeda m\u1eb7t ph\u1eb3ng song song li\u1ec1n k\u1ec1 v\u1edbi h\u01b0\u1edbng ng\u01b0\u1ee3c nhau sau khi s\u1eafp x\u1ebfp, v\u00ec s\u1ebd ph\u1ea3i c\u00f3 \u00edt nh\u1ea5t m\u1ed9t trong c\u00e1c n\u1eeda m\u1eb7t ph\u1eb3ng h\u1ed9p bao \u1edf gi\u1eefa hai c\u00e1i n\u00e0y (h\u00e3y nh\u1edb ch\u00fang \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp theo g\u00f3c).</p> <ul> <li>Tuy nhi\u00ean, c\u00f3 th\u1ec3 x\u1ea3y ra tr\u01b0\u1eddng h\u1ee3p, sau khi lo\u1ea1i b\u1ecf m\u1ed9t s\u1ed1 n\u1eeda m\u1eb7t ph\u1eb3ng kh\u1ecfi ph\u00eda sau c\u1ee7a deque, hai n\u1eeda m\u1eb7t ph\u1eb3ng song song c\u00f3 h\u01b0\u1edbng ng\u01b0\u1ee3c nhau l\u1ea1i n\u1eb1m c\u00f9ng nhau. Tr\u01b0\u1eddng h\u1ee3p n\u00e0y ch\u1ec9 x\u1ea3y ra, c\u1ee5 th\u1ec3, khi hai n\u1eeda m\u1eb7t ph\u1eb3ng n\u00e0y t\u1ea1o th\u00e0nh m\u1ed9t ph\u1ea7n giao r\u1ed7ng, v\u00ec n\u1eeda m\u1eb7t ph\u1eb3ng cu\u1ed1i c\u00f9ng n\u00e0y s\u1ebd khi\u1ebfn m\u1ecdi th\u1ee9 b\u1ecb lo\u1ea1i b\u1ecf kh\u1ecfi deque. \u0110\u1ec3 tr\u00e1nh v\u1ea5n \u0111\u1ec1 n\u00e0y, ch\u00fang ta ph\u1ea3i ki\u1ec3m tra th\u1ee7 c\u00f4ng c\u00e1c n\u1eeda m\u1eb7t ph\u1eb3ng song song, v\u00e0 n\u1ebfu ch\u00fang c\u00f3 h\u01b0\u1edbng ng\u01b0\u1ee3c nhau, ch\u00fang ta ch\u1ec9 c\u1ea7n d\u1eebng ngay thu\u1eadt to\u00e1n v\u00e0 tr\u1ea3 v\u1ec1 ph\u1ea7n giao r\u1ed7ng.</li> </ul> <p>Do \u0111\u00f3, tr\u01b0\u1eddng h\u1ee3p duy nh\u1ea5t ch\u00fang ta th\u1ef1c s\u1ef1 c\u1ea7n x\u1eed l\u00fd l\u00e0 c\u00f3 nhi\u1ec1u n\u1eeda m\u1eb7t ph\u1eb3ng v\u1edbi c\u00f9ng m\u1ed9t g\u00f3c, v\u00e0 h\u00f3a ra tr\u01b0\u1eddng h\u1ee3p n\u00e0y kh\u00e1 d\u1ec5 x\u1eed l\u00fd: ch\u00fang ta ch\u1ec9 c\u1ea7n gi\u1eef n\u1eeda m\u1eb7t ph\u1eb3ng n\u1eb1m b\u00ean tr\u00e1i nh\u1ea5t v\u00e0 x\u00f3a ph\u1ea7n c\u00f2n l\u1ea1i, v\u00ec ch\u00fang s\u1ebd ho\u00e0n to\u00e0n d\u01b0 th\u1eeba d\u00f9 sao \u0111i n\u1eefa. T\u00f3m l\u1ea1i, thu\u1eadt to\u00e1n \u0111\u1ea7y \u0111\u1ee7 s\u1ebd tr\u00f4ng \u0111\u1ea1i kh\u00e1i nh\u01b0 sau:</p> <ol> <li>Ch\u00fang ta b\u1eaft \u0111\u1ea7u b\u1eb1ng c\u00e1ch s\u1eafp x\u1ebfp t\u1eadp h\u1ee3p c\u00e1c n\u1eeda m\u1eb7t ph\u1eb3ng theo g\u00f3c, m\u1ea5t th\u1eddi gian $O(N \\log N)$.</li> <li>Ch\u00fang ta s\u1ebd l\u1eb7p qua t\u1eadp h\u1ee3p c\u00e1c n\u1eeda m\u1eb7t ph\u1eb3ng, v\u00e0 \u0111\u1ed1i v\u1edbi m\u1ed7i c\u00e1i, ch\u00fang ta s\u1ebd th\u1ef1c hi\u1ec7n quy tr\u00ecnh t\u0103ng d\u1ea7n, \u0111\u1ea9y ra kh\u1ecfi \u0111\u1ea7u v\u00e0 cu\u1ed1i c\u1ee7a h\u00e0ng \u0111\u1ee3i hai \u0111\u1ea7u khi c\u1ea7n thi\u1ebft. Qu\u00e1 tr\u00ecnh n\u00e0y s\u1ebd m\u1ea5t t\u1ed5ng th\u1eddi gian tuy\u1ebfn t\u00ednh, v\u00ec m\u1ed7i n\u1eeda m\u1eb7t ph\u1eb3ng ch\u1ec9 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u00eam ho\u1eb7c x\u00f3a m\u1ed9t l\u1ea7n.</li> <li>Cu\u1ed1i c\u00f9ng, \u0111a gi\u00e1c l\u1ed3i k\u1ebft qu\u1ea3 t\u1eeb ph\u1ea7n giao c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c l\u1ea5y \u0111\u01a1n gi\u1ea3n b\u1eb1ng c\u00e1ch t\u00ednh to\u00e1n c\u00e1c giao \u0111i\u1ec3m c\u1ee7a c\u00e1c n\u1eeda m\u1eb7t ph\u1eb3ng li\u1ec1n k\u1ec1 trong deque \u1edf cu\u1ed1i quy tr\u00ecnh. Qu\u00e1 tr\u00ecnh n\u00e0y c\u0169ng s\u1ebd m\u1ea5t th\u1eddi gian tuy\u1ebfn t\u00ednh. C\u0169ng c\u00f3 th\u1ec3 l\u01b0u tr\u1eef c\u00e1c \u0111i\u1ec3m nh\u01b0 v\u1eady trong b\u01b0\u1edbc 2 v\u00e0 b\u1ecf qua b\u01b0\u1edbc n\u00e0y ho\u00e0n to\u00e0n, nh\u01b0ng ch\u00fang t\u00f4i tin r\u1eb1ng n\u00f3 d\u1ec5 d\u00e0ng h\u01a1n m\u1ed9t ch\u00fat (v\u1ec1 m\u1eb7t c\u00e0i \u0111\u1eb7t) \u0111\u1ec3 t\u00ednh to\u00e1n ch\u00fang ngay l\u1eadp t\u1ee9c (on-the-fly).</li> </ol> <p>T\u1ed5ng c\u1ed9ng, ch\u00fang ta \u0111\u00e3 \u0111\u1ea1t \u0111\u01b0\u1ee3c \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian l\u00e0 $O(N \\log N)$. V\u00ec vi\u1ec7c s\u1eafp x\u1ebfp r\u00f5 r\u00e0ng l\u00e0 n\u00fat th\u1eaft c\u1ed5 chai, thu\u1eadt to\u00e1n c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n \u0111\u1ec3 ch\u1ea1y trong th\u1eddi gian tuy\u1ebfn t\u00ednh trong tr\u01b0\u1eddng h\u1ee3p \u0111\u1eb7c bi\u1ec7t m\u00e0 ch\u00fang ta \u0111\u01b0\u1ee3c cung c\u1ea5p c\u00e1c n\u1eeda m\u1eb7t ph\u1eb3ng \u0111\u00e3 \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp tr\u01b0\u1edbc theo g\u00f3c c\u1ee7a ch\u00fang (m\u1ed9t v\u00ed d\u1ee5 v\u1ec1 tr\u01b0\u1eddng h\u1ee3p nh\u01b0 v\u1eady l\u00e0 l\u1ea5y c\u00e1c n\u1eeda m\u1eb7t ph\u1eb3ng x\u00e1c \u0111\u1ecbnh m\u1ed9t \u0111a gi\u00e1c l\u1ed3i).</p>","tags":["Original"]},{"location":"geometry/halfplane-intersection.html#direct-implementation","title":"C\u00e0i \u0111\u1eb7t tr\u1ef1c ti\u1ebfp (Direct implementation)","text":"<p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u1ed9t m\u1eabu, c\u00e0i \u0111\u1eb7t tr\u1ef1c ti\u1ebfp c\u1ee7a thu\u1eadt to\u00e1n, v\u1edbi c\u00e1c b\u00ecnh lu\u1eadn gi\u1ea3i th\u00edch h\u1ea7u h\u1ebft c\u00e1c ph\u1ea7n:</p> <p>C\u00e1c struct \u0111i\u1ec3m/vector v\u00e0 n\u1eeda m\u1eb7t ph\u1eb3ng \u0111\u01a1n gi\u1ea3n:</p> <pre><code>// Redefine epsilon and infinity as necessary. Be mindful of precision errors.\nconst long double eps = 1e-9, inf = 1e9; \n\n// Basic point/vector struct.\nstruct Point { \n\n    long double x, y;\n    explicit Point(long double x = 0, long double y = 0) : x(x), y(y) {}\n\n    // Addition, substraction, multiply by constant, dot product, cross product.\n\n    friend Point operator + (const Point&amp; p, const Point&amp; q) {\n        return Point(p.x + q.x, p.y + q.y); \n    }\n\n    friend Point operator - (const Point&amp; p, const Point&amp; q) { \n        return Point(p.x - q.x, p.y - q.y); \n    }\n\n    friend Point operator * (const Point&amp; p, const long double&amp; k) { \n        return Point(p.x * k, p.y * k); \n    } \n\n    friend long double dot(const Point&amp; p, const Point&amp; q) {\n        return p.x * q.x + p.y * q.y;\n    }\n\n    friend long double cross(const Point&amp; p, const Point&amp; q) { \n        return p.x * q.y - p.y * q.x; \n    }\n};\n\n// Basic half-plane struct.\nstruct Halfplane { \n\n    // 'p' is a passing point of the line and 'pq' is the direction vector of the line.\n    Point p, pq; \n    long double angle;\n\n    Halfplane() {}\n    Halfplane(const Point&amp; a, const Point&amp; b) : p(a), pq(b - a) {\n        angle = atan2l(pq.y, pq.x);    \n    }\n\n    // Check if point 'r' is outside this half-plane. \n    // Every half-plane allows the region to the LEFT of its line.\n    bool out(const Point&amp; r) { \n        return cross(pq, r - p) &lt; -eps; \n    }\n\n    // Comparator for sorting. \n    bool operator &lt; (const Halfplane&amp; e) const { \n        return angle &lt; e.angle;\n    } \n\n    // Intersection point of the lines of two half-planes. It is assumed they're never parallel.\n    friend Point inter(const Halfplane&amp; s, const Halfplane&amp; t) {\n        long double alpha = cross((t.p - s.p), t.pq) / cross(s.pq, t.pq);\n        return s.p + (s.pq * alpha);\n    }\n};\n</code></pre> <p>Thu\u1eadt to\u00e1n:</p> <pre><code>// Actual algorithm\nvector&lt;Point&gt; hp_intersect(vector&lt;Halfplane&gt;&amp; H) { \n\n    Point box[4] = {  // Bounding box in CCW order\n        Point(inf, inf), \n        Point(-inf, inf), \n        Point(-inf, -inf), \n        Point(inf, -inf) \n    };\n\n    for(int i = 0; i&lt;4; i++) { // Add bounding box half-planes.\n        Halfplane aux(box[i], box[(i+1) % 4]);\n        H.push_back(aux);\n    }\n\n    // Sort by angle and start algorithm\n    sort(H.begin(), H.end());\n    deque&lt;Halfplane&gt; dq;\n    int len = 0;\n    for(int i = 0; i &lt; int(H.size()); i++) {\n\n        // Remove from the back of the deque while last half-plane is redundant\n        while (len &gt; 1 &amp;&amp; H[i].out(inter(dq[len-1], dq[len-2]))) {\n            dq.pop_back();\n            --len;\n        }\n\n        // Remove from the front of the deque while first half-plane is redundant\n        while (len &gt; 1 &amp;&amp; H[i].out(inter(dq[0], dq[1]))) {\n            dq.pop_front();\n            --len;\n        }\n\n        // Special case check: Parallel half-planes\n        if (len &gt; 0 &amp;&amp; fabsl(cross(H[i].pq, dq[len-1].pq)) &lt; eps) {\n            // Opposite parallel half-planes that ended up checked against each other.\n            if (dot(H[i].pq, dq[len-1].pq) &lt; 0.0)\n                return vector&lt;Point&gt;();\n\n            // Same direction half-plane: keep only the leftmost half-plane.\n            if (H[i].out(dq[len-1].p)) {\n                dq.pop_back();\n                --len;\n            }\n            else continue;\n        }\n\n        // Add new half-plane\n        dq.push_back(H[i]);\n        ++len;\n    }\n\n    // Final cleanup: Check half-planes at the front against the back and vice-versa\n    while (len &gt; 2 &amp;&amp; dq[0].out(inter(dq[len-1], dq[len-2]))) {\n        dq.pop_back();\n        --len;\n    }\n\n    while (len &gt; 2 &amp;&amp; dq[len-1].out(inter(dq[0], dq[1]))) {\n        dq.pop_front();\n        --len;\n    }\n\n    // Report empty intersection if necessary\n    if (len &lt; 3) return vector&lt;Point&gt;();\n\n    // Reconstruct the convex polygon from the remaining half-planes.\n    vector&lt;Point&gt; ret(len);\n    for(int i = 0; i+1 &lt; len; i++) {\n        ret[i] = inter(dq[i], dq[i+1]);\n    }\n    ret.back() = inter(dq[len-1], dq[0]);\n    return ret;\n}\n</code></pre>","tags":["Original"]},{"location":"geometry/halfplane-intersection.html#implementation-discussion","title":"Th\u1ea3o lu\u1eadn v\u1ec1 c\u00e0i \u0111\u1eb7t (Implementation discussion)","text":"<p>M\u1ed9t \u0111i\u1ec1u \u0111\u1eb7c bi\u1ec7t c\u1ea7n l\u01b0u \u00fd l\u00e0, trong tr\u01b0\u1eddng h\u1ee3p c\u00f3 nhi\u1ec1u n\u1eeda m\u1eb7t ph\u1eb3ng giao nhau t\u1ea1i c\u00f9ng m\u1ed9t \u0111i\u1ec3m, th\u00ec thu\u1eadt to\u00e1n n\u00e0y c\u00f3 th\u1ec3 tr\u1ea3 v\u1ec1 c\u00e1c \u0111i\u1ec3m li\u1ec1n k\u1ec1 l\u1eb7p l\u1ea1i trong \u0111a gi\u00e1c cu\u1ed1i c\u00f9ng. Tuy nhi\u00ean, \u0111i\u1ec1u n\u00e0y s\u1ebd kh\u00f4ng c\u00f3 b\u1ea5t k\u1ef3 t\u00e1c \u0111\u1ed9ng n\u00e0o \u0111\u1ebfn vi\u1ec7c \u0111\u00e1nh gi\u00e1 ch\u00ednh x\u00e1c xem ph\u1ea7n giao c\u00f3 r\u1ed7ng hay kh\u00f4ng, v\u00e0 n\u00f3 c\u0169ng kh\u00f4ng \u1ea3nh h\u01b0\u1edfng \u0111\u1ebfn di\u1ec7n t\u00edch \u0111a gi\u00e1c ch\u00fat n\u00e0o. B\u1ea1n c\u00f3 th\u1ec3 mu\u1ed1n x\u00f3a c\u00e1c b\u1ea3n sao n\u00e0y t\u00f9y thu\u1ed9c v\u00e0o nhi\u1ec7m v\u1ee5 b\u1ea1n c\u1ea7n l\u00e0m sau \u0111\u00f3. B\u1ea1n c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n vi\u1ec7c n\u00e0y r\u1ea5t d\u1ec5 d\u00e0ng v\u1edbi <code>std::unique</code>. Ch\u00fang t\u00f4i mu\u1ed1n gi\u1eef c\u00e1c \u0111i\u1ec3m l\u1eb7p l\u1ea1i trong qu\u00e1 tr\u00ecnh th\u1ef1c hi\u1ec7n thu\u1eadt to\u00e1n \u0111\u1ec3 c\u00e1c giao \u0111i\u1ec3m c\u00f3 di\u1ec7n t\u00edch b\u1eb1ng kh\u00f4ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n ch\u00ednh x\u00e1c (v\u00ed d\u1ee5: c\u00e1c giao \u0111i\u1ec3m bao g\u1ed3m m\u1ed9t \u0111i\u1ec3m, \u0111\u01b0\u1eddng th\u1eb3ng ho\u1eb7c \u0111o\u1ea1n th\u1eb3ng duy nh\u1ea5t). T\u00f4i khuy\u1ebfn kh\u00edch ng\u01b0\u1eddi \u0111\u1ecdc ki\u1ec3m tra m\u1ed9t s\u1ed1 tr\u01b0\u1eddng h\u1ee3p th\u1ee7 c\u00f4ng nh\u1ecf trong \u0111\u00f3 k\u1ebft qu\u1ea3 giao nhau l\u00e0 m\u1ed9t \u0111i\u1ec3m ho\u1eb7c \u0111\u01b0\u1eddng th\u1eb3ng duy nh\u1ea5t.</p> <p>M\u1ed9t \u0111i\u1ec1u n\u1eefa c\u1ea7n \u0111\u01b0\u1ee3c n\u00f3i \u0111\u1ebfn l\u00e0 ph\u1ea3i l\u00e0m g\u00ec n\u1ebfu ch\u00fang ta \u0111\u01b0\u1ee3c cung c\u1ea5p c\u00e1c n\u1eeda m\u1eb7t ph\u1eb3ng d\u01b0\u1edbi d\u1ea1ng r\u00e0ng bu\u1ed9c tuy\u1ebfn t\u00ednh (v\u00ed d\u1ee5: $ax + by + c \\leq 0$). Trong tr\u01b0\u1eddng h\u1ee3p nh\u01b0 v\u1eady, c\u00f3 hai l\u1ef1a ch\u1ecdn. B\u1ea1n c\u00f3 th\u1ec3 c\u00e0i \u0111\u1eb7t thu\u1eadt to\u00e1n v\u1edbi c\u00e1c s\u1eeda \u0111\u1ed5i t\u01b0\u01a1ng \u1ee9ng \u0111\u1ec3 l\u00e0m vi\u1ec7c v\u1edbi bi\u1ec3u di\u1ec5n nh\u01b0 v\u1eady (v\u1ec1 c\u01a1 b\u1ea3n l\u00e0 t\u1ea1o struct n\u1eeda m\u1eb7t ph\u1eb3ng c\u1ee7a ri\u00eang b\u1ea1n, s\u1ebd kh\u00e1 \u0111\u01a1n gi\u1ea3n n\u1ebfu b\u1ea1n quen thu\u1ed9c v\u1edbi th\u1ee7 thu\u1eadt bao l\u1ed3i), ho\u1eb7c b\u1ea1n c\u00f3 th\u1ec3 chuy\u1ec3n \u0111\u1ed5i c\u00e1c \u0111\u01b0\u1eddng th\u1eb3ng th\u00e0nh bi\u1ec3u di\u1ec5n m\u00e0 ch\u00fang t\u00f4i \u0111\u00e3 s\u1eed d\u1ee5ng trong b\u00e0i vi\u1ebft n\u00e0y b\u1eb1ng c\u00e1ch l\u1ea5y b\u1ea5t k\u1ef3 2 \u0111i\u1ec3m n\u00e0o c\u1ee7a m\u1ed7i \u0111\u01b0\u1eddng th\u1eb3ng. N\u00f3i chung, n\u00ean l\u00e0m vi\u1ec7c v\u1edbi bi\u1ec3u di\u1ec5n m\u00e0 b\u1ea1n \u0111\u01b0\u1ee3c cung c\u1ea5p trong b\u00e0i to\u00e1n \u0111\u1ec3 tr\u00e1nh c\u00e1c v\u1ea5n \u0111\u1ec1 ch\u00ednh x\u00e1c b\u1ed5 sung.</p>","tags":["Original"]},{"location":"geometry/halfplane-intersection.html#problems-tasks-and-applications","title":"B\u00e0i to\u00e1n, nhi\u1ec7m v\u1ee5 v\u00e0 \u1ee9ng d\u1ee5ng (Problems, tasks and applications)","text":"<p>Nhi\u1ec1u b\u00e0i to\u00e1n c\u00f3 th\u1ec3 gi\u1ea3i \u0111\u01b0\u1ee3c b\u1eb1ng giao \u0111i\u1ec3m n\u1eeda m\u1eb7t ph\u1eb3ng c\u0169ng c\u00f3 th\u1ec3 gi\u1ea3i \u0111\u01b0\u1ee3c m\u00e0 kh\u00f4ng c\u1ea7n n\u00f3, nh\u01b0ng v\u1edbi (th\u01b0\u1eddng l\u00e0) c\u00e1c c\u00e1ch ti\u1ebfp c\u1eadn ph\u1ee9c t\u1ea1p ho\u1eb7c kh\u00f4ng ph\u1ed5 bi\u1ebfn h\u01a1n. Nh\u00ecn chung, giao \u0111i\u1ec3m n\u1eeda m\u1eb7t ph\u1eb3ng c\u00f3 th\u1ec3 xu\u1ea5t hi\u1ec7n khi x\u1eed l\u00fd c\u00e1c b\u00e0i to\u00e1n li\u00ean quan \u0111\u1ebfn \u0111a gi\u00e1c (ch\u1ee7 y\u1ebfu l\u00e0 l\u1ed3i), kh\u1ea3 n\u0103ng nh\u00ecn th\u1ea5y trong m\u1eb7t ph\u1eb3ng v\u00e0 quy ho\u1ea1ch tuy\u1ebfn t\u00ednh hai chi\u1ec1u. D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u1ed9t s\u1ed1 nhi\u1ec7m v\u1ee5 m\u1eabu c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i quy\u1ebft b\u1eb1ng k\u1ef9 thu\u1eadt n\u00e0y:</p>","tags":["Original"]},{"location":"geometry/halfplane-intersection.html#convex-polygon-intersection","title":"Giao c\u1ee7a \u0111a gi\u00e1c l\u1ed3i (Convex polygon intersection)","text":"<p>M\u1ed9t trong nh\u1eefng \u1ee9ng d\u1ee5ng c\u1ed5 \u0111i\u1ec3n c\u1ee7a giao \u0111i\u1ec3m n\u1eeda m\u1eb7t ph\u1eb3ng: Cho $N$ \u0111a gi\u00e1c, t\u00ednh to\u00e1n v\u00f9ng \u0111\u01b0\u1ee3c bao g\u1ed3m b\u00ean trong t\u1ea5t c\u1ea3 c\u00e1c \u0111a gi\u00e1c.</p> <p>V\u00ec giao c\u1ee7a m\u1ed9t t\u1eadp h\u1ee3p c\u00e1c n\u1eeda m\u1eb7t ph\u1eb3ng l\u00e0 m\u1ed9t \u0111a gi\u00e1c l\u1ed3i, ch\u00fang ta c\u0169ng c\u00f3 th\u1ec3 bi\u1ec3u di\u1ec5n m\u1ed9t \u0111a gi\u00e1c l\u1ed3i d\u01b0\u1edbi d\u1ea1ng m\u1ed9t t\u1eadp h\u1ee3p c\u00e1c n\u1eeda m\u1eb7t ph\u1eb3ng (m\u1ecdi c\u1ea1nh c\u1ee7a \u0111a gi\u00e1c l\u00e0 m\u1ed9t \u0111o\u1ea1n c\u1ee7a m\u1ed9t n\u1eeda m\u1eb7t ph\u1eb3ng). T\u1ea1o c\u00e1c n\u1eeda m\u1eb7t ph\u1eb3ng n\u00e0y cho m\u1ecdi \u0111a gi\u00e1c v\u00e0 t\u00ednh to\u00e1n giao c\u1ee7a to\u00e0n b\u1ed9 t\u1eadp h\u1ee3p. T\u1ed5ng \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian l\u00e0 $O(S \\log S)$, trong \u0111\u00f3 S l\u00e0 t\u1ed5ng s\u1ed1 c\u1ea1nh c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c \u0111a gi\u00e1c. B\u00e0i to\u00e1n v\u1ec1 m\u1eb7t l\u00fd thuy\u1ebft c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i quy\u1ebft trong $O(S \\log N)$ b\u1eb1ng c\u00e1ch h\u1ee3p nh\u1ea5t $N$ t\u1eadp h\u1ee3p c\u00e1c n\u1eeda m\u1eb7t ph\u1eb3ng b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng heap v\u00e0 sau \u0111\u00f3 ch\u1ea1y thu\u1eadt to\u00e1n m\u00e0 kh\u00f4ng c\u1ea7n b\u01b0\u1edbc s\u1eafp x\u1ebfp, nh\u01b0ng gi\u1ea3i ph\u00e1p nh\u01b0 v\u1eady c\u00f3 h\u1eb1ng s\u1ed1 t\u1ed3i t\u1ec7 h\u01a1n nhi\u1ec1u so v\u1edbi s\u1eafp x\u1ebfp \u0111\u01a1n gi\u1ea3n v\u00e0 ch\u1ec9 cung c\u1ea5p m\u1ee9c t\u0103ng t\u1ed1c \u0111\u1ed9 nh\u1ecf cho $N$ r\u1ea5t nh\u1ecf.</p>","tags":["Original"]},{"location":"geometry/halfplane-intersection.html#visibility-in-the-plane","title":"Kh\u1ea3 n\u0103ng nh\u00ecn th\u1ea5y trong m\u1eb7t ph\u1eb3ng (Visibility in the plane)","text":"<p>C\u00e1c b\u00e0i to\u00e1n y\u00eau c\u1ea7u m\u1ed9t c\u00e1i g\u00ec \u0111\u00f3 trong c\u00e1c d\u00f2ng \"x\u00e1c \u0111\u1ecbnh xem m\u1ed9t s\u1ed1 \u0111o\u1ea1n th\u1eb3ng c\u00f3 th\u1ec3 nh\u00ecn th\u1ea5y \u0111\u01b0\u1ee3c t\u1eeb m\u1ed9t s\u1ed1 \u0111i\u1ec3m trong m\u1eb7t ph\u1eb3ng hay kh\u00f4ng\" th\u01b0\u1eddng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c x\u00e2y d\u1ef1ng d\u01b0\u1edbi d\u1ea1ng c\u00e1c b\u00e0i to\u00e1n giao \u0111i\u1ec3m n\u1eeda m\u1eb7t ph\u1eb3ng. V\u00ed d\u1ee5, h\u00e3y th\u1ef1c hi\u1ec7n nhi\u1ec7m v\u1ee5 sau: Cho m\u1ed9t \u0111a gi\u00e1c \u0111\u01a1n gi\u1ea3n (kh\u00f4ng nh\u1ea5t thi\u1ebft l\u00e0 l\u1ed3i), x\u00e1c \u0111\u1ecbnh xem c\u00f3 \u0111i\u1ec3m n\u00e0o b\u00ean trong \u0111a gi\u00e1c sao cho to\u00e0n b\u1ed9 bi\u00ean c\u1ee7a \u0111a gi\u00e1c c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c quan s\u00e1t t\u1eeb \u0111i\u1ec3m \u0111\u00f3 hay kh\u00f4ng. \u0110i\u1ec1u n\u00e0y c\u00f2n \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 t\u00ecm h\u1ea1t nh\u00e2n c\u1ee7a \u0111a gi\u00e1c (kernel of a polygon) v\u00e0 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i quy\u1ebft b\u1eb1ng giao \u0111i\u1ec3m n\u1eeda m\u1eb7t ph\u1eb3ng \u0111\u01a1n gi\u1ea3n, l\u1ea5y m\u1ed7i c\u1ea1nh c\u1ee7a \u0111a gi\u00e1c l\u00e0m m\u1ed9t n\u1eeda m\u1eb7t ph\u1eb3ng v\u00e0 sau \u0111\u00f3 t\u00ednh to\u00e1n giao \u0111i\u1ec3m c\u1ee7a n\u00f3.</p> <p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u1ed9t b\u00e0i to\u00e1n li\u00ean quan, th\u00fa v\u1ecb h\u01a1n \u0111\u00e3 \u0111\u01b0\u1ee3c tr\u00ecnh b\u00e0y b\u1edfi Artem Vasilyev trong m\u1ed9t trong nh\u1eefng b\u00e0i gi\u1ea3ng t\u1ea1i Tr\u01b0\u1eddng H\u00e8 ICPC Brazil c\u1ee7a anh \u1ea5y: Cho m\u1ed9t t\u1eadp h\u1ee3p $p$ c\u00e1c \u0111i\u1ec3m $p_1, p_2\\ \\dots \\ p_n$ trong m\u1eb7t ph\u1eb3ng, x\u00e1c \u0111\u1ecbnh xem c\u00f3 b\u1ea5t k\u1ef3 \u0111i\u1ec3m $q$ n\u00e0o b\u1ea1n c\u00f3 th\u1ec3 \u0111\u1ee9ng t\u1ea1i \u0111\u00f3 sao cho b\u1ea1n c\u00f3 th\u1ec3 nh\u00ecn th\u1ea5y t\u1ea5t c\u1ea3 c\u00e1c \u0111i\u1ec3m c\u1ee7a $p$ t\u1eeb tr\u00e1i sang ph\u1ea3i theo th\u1ee9 t\u1ef1 t\u0103ng d\u1ea7n c\u1ee7a ch\u1ec9 s\u1ed1 c\u1ee7a ch\u00fang.</p> <p>B\u00e0i to\u00e1n nh\u01b0 v\u1eady c\u00f3 th\u1ec3 gi\u1ea3i \u0111\u01b0\u1ee3c b\u1eb1ng c\u00e1ch nh\u1eadn th\u1ea5y r\u1eb1ng vi\u1ec7c c\u00f3 th\u1ec3 nh\u00ecn th\u1ea5y m\u1ed9t \u0111i\u1ec3m $p_i$ n\u00e0o \u0111\u00f3 \u1edf b\u00ean tr\u00e1i c\u1ee7a $p_j$ gi\u1ed1ng nh\u01b0 vi\u1ec7c c\u00f3 th\u1ec3 nh\u00ecn th\u1ea5y ph\u00eda b\u00ean ph\u1ea3i c\u1ee7a \u0111o\u1ea1n th\u1eb3ng t\u1eeb $p_i$ \u0111\u1ebfn $p_j$ (ho\u1eb7c t\u01b0\u01a1ng \u0111\u01b0\u01a1ng, c\u00f3 th\u1ec3 nh\u00ecn th\u1ea5y ph\u00eda b\u00ean tr\u00e1i c\u1ee7a \u0111o\u1ea1n th\u1eb3ng t\u1eeb $p_j$ \u0111\u1ebfn $p_i$). V\u1edbi \u00fd ngh\u0129 \u0111\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 ch\u1ec9 c\u1ea7n t\u1ea1o m\u1ed9t n\u1eeda m\u1eb7t ph\u1eb3ng cho m\u1ed7i \u0111o\u1ea1n th\u1eb3ng $p_i p_{i+1}$ (ho\u1eb7c $p_{i+1} p_i$ t\u00f9y thu\u1ed9c v\u00e0o h\u01b0\u1edbng b\u1ea1n ch\u1ecdn) v\u00e0 ki\u1ec3m tra xem giao c\u1ee7a to\u00e0n b\u1ed9 t\u1eadp h\u1ee3p c\u00f3 r\u1ed7ng hay kh\u00f4ng.</p>","tags":["Original"]},{"location":"geometry/halfplane-intersection.html#half-plane-intersection-with-binary-search","title":"Giao n\u1eeda m\u1eb7t ph\u1eb3ng v\u1edbi t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n (Half-plane intersection with binary search)","text":"<p>M\u1ed9t \u1ee9ng d\u1ee5ng ph\u1ed5 bi\u1ebfn kh\u00e1c l\u00e0 s\u1eed d\u1ee5ng giao \u0111i\u1ec3m n\u1eeda m\u1eb7t ph\u1eb3ng nh\u01b0 m\u1ed9t c\u00f4ng c\u1ee5 \u0111\u1ec3 x\u00e1c th\u1ef1c v\u1ecb ng\u1eef (predicate) c\u1ee7a m\u1ed9t th\u1ee7 t\u1ee5c t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n. D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u1ed9t v\u00ed d\u1ee5 v\u1ec1 m\u1ed9t b\u00e0i to\u00e1n nh\u01b0 v\u1eady, c\u0169ng \u0111\u01b0\u1ee3c tr\u00ecnh b\u00e0y b\u1edfi Artem Vasilyev trong c\u00f9ng b\u00e0i gi\u1ea3ng \u0111\u00e3 \u0111\u1ec1 c\u1eadp tr\u01b0\u1edbc \u0111\u00f3: Cho m\u1ed9t \u0111a gi\u00e1c l\u1ed3i $P$, t\u00ecm chu vi l\u1edbn nh\u1ea5t c\u00f3 th\u1ec3 n\u1ed9i ti\u1ebfp b\u00ean trong n\u00f3.</p> <p>Thay v\u00ec t\u00ecm ki\u1ebfm m\u1ed9t lo\u1ea1i gi\u1ea3i ph\u00e1p d\u1ea1ng \u0111\u00f3ng, c\u00e1c c\u00f4ng th\u1ee9c kh\u00f3 ch\u1ecbu ho\u1eb7c c\u00e1c gi\u1ea3i ph\u00e1p thu\u1eadt to\u00e1n t\u1ed1i ngh\u0129a, thay v\u00e0o \u0111\u00f3 h\u00e3y th\u1eed t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n tr\u00ean c\u00e2u tr\u1ea3 l\u1eddi. L\u01b0u \u00fd r\u1eb1ng, \u0111\u1ed1i v\u1edbi m\u1ed9t $r$ c\u1ed1 \u0111\u1ecbnh n\u00e0o \u0111\u00f3, m\u1ed9t v\u00f2ng tr\u00f2n c\u00f3 b\u00e1n k\u00ednh $r$ c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c n\u1ed9i ti\u1ebfp b\u00ean trong $P$ ch\u1ec9 khi t\u1ed3n t\u1ea1i m\u1ed9t \u0111i\u1ec3m n\u00e0o \u0111\u00f3 b\u00ean trong $P$ c\u00f3 kho\u1ea3ng c\u00e1ch l\u1edbn h\u01a1n ho\u1eb7c b\u1eb1ng $r$ \u0111\u1ebfn t\u1ea5t c\u1ea3 c\u00e1c \u0111i\u1ec3m bi\u00ean c\u1ee7a $P$. \u0110i\u1ec1u ki\u1ec7n n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c x\u00e1c th\u1ef1c b\u1eb1ng c\u00e1ch \"thu nh\u1ecf\" \u0111a gi\u00e1c v\u00e0o trong m\u1ed9t kho\u1ea3ng c\u00e1ch $r$ v\u00e0 ki\u1ec3m tra xem \u0111a gi\u00e1c c\u00f3 c\u00f2n kh\u00f4ng suy bi\u1ebfn hay kh\u00f4ng (ho\u1eb7c b\u1ea3n th\u00e2n n\u00f3 l\u00e0 m\u1ed9t \u0111i\u1ec3m/\u0111o\u1ea1n). Quy tr\u00ecnh nh\u01b0 v\u1eady c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c m\u00f4 ph\u1ecfng b\u1eb1ng c\u00e1ch l\u1ea5y c\u00e1c n\u1eeda m\u1eb7t ph\u1eb3ng c\u1ee7a c\u00e1c c\u1ea1nh \u0111a gi\u00e1c theo th\u1ee9 t\u1ef1 ng\u01b0\u1ee3c chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3, d\u1ecbch chuy\u1ec3n t\u1eebng c\u00e1i m\u1ed9t kho\u1ea3ng c\u00e1ch $r$ theo h\u01b0\u1edbng c\u1ee7a v\u00f9ng m\u00e0 ch\u00fang cho ph\u00e9p (ngh\u0129a l\u00e0, tr\u1ef1c giao v\u1edbi vector ch\u1ec9 ph\u01b0\u01a1ng c\u1ee7a n\u1eeda m\u1eb7t ph\u1eb3ng), v\u00e0 ki\u1ec3m tra xem giao \u0111i\u1ec3m c\u00f3 kh\u00f4ng r\u1ed7ng hay kh\u00f4ng.</p> <p>R\u00f5 r\u00e0ng, n\u1ebfu ch\u00fang ta c\u00f3 th\u1ec3 n\u1ed9i ti\u1ebfp m\u1ed9t \u0111\u01b0\u1eddng tr\u00f2n c\u00f3 b\u00e1n k\u00ednh $r$, ch\u00fang ta c\u0169ng c\u00f3 th\u1ec3 n\u1ed9i ti\u1ebfp b\u1ea5t k\u1ef3 \u0111\u01b0\u1eddng tr\u00f2n n\u00e0o kh\u00e1c c\u00f3 b\u00e1n k\u00ednh nh\u1ecf h\u01a1n $r$. V\u00ec v\u1eady, ch\u00fang ta c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n tr\u00ean b\u00e1n k\u00ednh $r$ v\u00e0 x\u00e1c th\u1ef1c t\u1eebng b\u01b0\u1edbc b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng giao \u0111i\u1ec3m n\u1eeda m\u1eb7t ph\u1eb3ng. Ngo\u00e0i ra, l\u01b0u \u00fd r\u1eb1ng c\u00e1c n\u1eeda m\u1eb7t ph\u1eb3ng c\u1ee7a m\u1ed9t \u0111a gi\u00e1c l\u1ed3i \u0111\u00e3 \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp theo g\u00f3c, v\u00ec v\u1eady b\u01b0\u1edbc s\u1eafp x\u1ebfp c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c b\u1ecf qua trong thu\u1eadt to\u00e1n. Do \u0111\u00f3, ch\u00fang ta thu \u0111\u01b0\u1ee3c t\u1ed5ng \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian l\u00e0 $O(NK)$, trong \u0111\u00f3 $N$ l\u00e0 s\u1ed1 \u0111\u1ec9nh \u0111a gi\u00e1c v\u00e0 $K$ l\u00e0 s\u1ed1 l\u1ea7n l\u1eb7p c\u1ee7a t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n (gi\u00e1 tr\u1ecb th\u1ef1c t\u1ebf s\u1ebd ph\u1ee5 thu\u1ed9c v\u00e0o ph\u1ea1m vi c\u1ee7a c\u00e1c c\u00e2u tr\u1ea3 l\u1eddi c\u00f3 th\u1ec3 v\u00e0 \u0111\u1ed9 ch\u00ednh x\u00e1c mong mu\u1ed1n).</p>","tags":["Original"]},{"location":"geometry/halfplane-intersection.html#two-dimensional-linear-programming","title":"Quy ho\u1ea1ch tuy\u1ebfn t\u00ednh hai chi\u1ec1u (Two-dimensional linear programming)","text":"<p>M\u1ed9t \u1ee9ng d\u1ee5ng n\u1eefa c\u1ee7a giao \u0111i\u1ec3m n\u1eeda m\u1eb7t ph\u1eb3ng l\u00e0 quy ho\u1ea1ch tuy\u1ebfn t\u00ednh trong hai bi\u1ebfn. T\u1ea5t c\u1ea3 c\u00e1c r\u00e0ng bu\u1ed9c tuy\u1ebfn t\u00ednh cho hai bi\u1ebfn c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bi\u1ec3u th\u1ecb d\u01b0\u1edbi d\u1ea1ng $Ax + By + C \\leq 0$ (b\u1ed9 so s\u00e1nh b\u1ea5t \u0111\u1eb3ng th\u1ee9c c\u00f3 th\u1ec3 thay \u0111\u1ed5i). R\u00f5 r\u00e0ng, \u0111\u00e2y ch\u1ec9 l\u00e0 c\u00e1c n\u1eeda m\u1eb7t ph\u1eb3ng, v\u00ec v\u1eady vi\u1ec7c ki\u1ec3m tra xem m\u1ed9t gi\u1ea3i ph\u00e1p kh\u1ea3 thi c\u00f3 t\u1ed3n t\u1ea1i cho m\u1ed9t t\u1eadp h\u1ee3p c\u00e1c r\u00e0ng bu\u1ed9c tuy\u1ebfn t\u00ednh hay kh\u00f4ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n b\u1eb1ng giao \u0111i\u1ec3m n\u1eeda m\u1eb7t ph\u1eb3ng. Ngo\u00e0i ra, \u0111\u1ed1i v\u1edbi m\u1ed9t t\u1eadp h\u1ee3p c\u00e1c r\u00e0ng bu\u1ed9c tuy\u1ebfn t\u00ednh \u0111\u00e3 cho, c\u00f3 th\u1ec3 t\u00ednh to\u00e1n v\u00f9ng c\u1ee7a c\u00e1c gi\u1ea3i ph\u00e1p kh\u1ea3 thi (t\u1ee9c l\u00e0 giao c\u1ee7a c\u00e1c n\u1eeda m\u1eb7t ph\u1eb3ng) v\u00e0 sau \u0111\u00f3 tr\u1ea3 l\u1eddi nhi\u1ec1u truy v\u1ea5n v\u1ec1 vi\u1ec7c t\u1ed1i \u0111a h\u00f3a/t\u1ed1i thi\u1ec3u h\u00f3a m\u1ed9t s\u1ed1 h\u00e0m tuy\u1ebfn t\u00ednh $f(x, y)$ tu\u00e2n theo c\u00e1c r\u00e0ng bu\u1ed9c trong $O(\\log N)$ m\u1ed7i truy v\u1ea5n b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n (r\u1ea5t gi\u1ed1ng v\u1edbi th\u1ee7 thu\u1eadt bao l\u1ed3i).</p> <p>\u0110\u00e1ng n\u00f3i \u0111\u1ebfn l\u00e0 c\u0169ng t\u1ed3n t\u1ea1i m\u1ed9t thu\u1eadt to\u00e1n ng\u1eabu nhi\u00ean kh\u00e1 \u0111\u01a1n gi\u1ea3n c\u00f3 th\u1ec3 ki\u1ec3m tra xem m\u1ed9t t\u1eadp h\u1ee3p c\u00e1c r\u00e0ng bu\u1ed9c tuy\u1ebfn t\u00ednh c\u00f3 gi\u1ea3i ph\u00e1p kh\u1ea3 thi hay kh\u00f4ng, v\u00e0 t\u1ed1i \u0111a h\u00f3a/t\u1ed1i thi\u1ec3u h\u00f3a m\u1ed9t s\u1ed1 h\u00e0m tuy\u1ebfn t\u00ednh tu\u00e2n theo c\u00e1c r\u00e0ng bu\u1ed9c \u0111\u00e3 cho. Thu\u1eadt to\u00e1n ng\u1eabu nhi\u00ean n\u00e0y c\u0169ng \u0111\u01b0\u1ee3c gi\u1ea3i th\u00edch \u0111\u1ed9c \u0111\u00e1o b\u1edfi Artem Vasilyev trong b\u00e0i gi\u1ea3ng \u0111\u00e3 \u0111\u1ec1 c\u1eadp tr\u01b0\u1edbc \u0111\u00f3. D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u1ed9t s\u1ed1 t\u00e0i nguy\u00ean b\u1ed5 sung v\u1ec1 n\u00f3, n\u1ebfu ng\u01b0\u1eddi \u0111\u1ecdc quan t\u00e2m: CG - B\u00e0i gi\u1ea3ng 4, ph\u1ea7n 4 v\u00e0 5 v\u00e0 Blog c\u1ee7a Petr Mitrichev (bao g\u1ed3m gi\u1ea3i ph\u00e1p cho b\u00e0i to\u00e1n kh\u00f3 nh\u1ea5t trong danh s\u00e1ch b\u00e0i t\u1eadp th\u1ef1c h\u00e0nh b\u00ean d\u01b0\u1edbi).</p>","tags":["Original"]},{"location":"geometry/halfplane-intersection.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice problems)","text":"","tags":["Original"]},{"location":"geometry/halfplane-intersection.html#classic-problems-direct-application","title":"B\u00e0i to\u00e1n kinh \u0111i\u1ec3n, \u1ee9ng d\u1ee5ng tr\u1ef1c ti\u1ebfp","text":"<ul> <li>Codechef - Animesh decides to settle down</li> <li>POJ - How I mathematician Wonder What You Are!</li> <li>POJ - Rotating Scoreboard</li> <li>POJ - Video Surveillance</li> <li>POJ - Art Gallery</li> <li>POJ - Uyuw's Concert</li> </ul>","tags":["Original"]},{"location":"geometry/halfplane-intersection.html#harder-problems","title":"B\u00e0i to\u00e1n kh\u00f3 h\u01a1n","text":"<ul> <li>POJ - Most Distant Point from the Sea - Medium</li> <li>Baekjoon - Jeju's Island - Same as above but seemingly stronger test cases</li> <li>POJ - Feng Shui - Medium</li> <li>POJ - Triathlon - Medium/hard</li> <li>DMOJ - Arrow - Medium/hard</li> <li>POJ - Jungle Outpost - Hard</li> <li>Codeforces - Jungle Outpost (alternative link, problem J) - Hard </li> <li>Yandex - Asymmetry Value (need virtual contest to see, problem F) - Very Hard</li> </ul>","tags":["Original"]},{"location":"geometry/halfplane-intersection.html#additional-problems","title":"B\u00e0i to\u00e1n b\u1ed5 sung","text":"<ul> <li>40th Petrozavodsk Programming Camp, Winter 2021 - Day 1: Jagiellonian U Contest, Grand Prix of Krakow - Problem B: (Almost) Fair Cake-Cutting. T\u1ea1i th\u1eddi \u0111i\u1ec3m vi\u1ebft b\u00e0i, b\u00e0i to\u00e1n n\u00e0y l\u00e0 ri\u00eang t\u01b0 v\u00e0 ch\u1ec9 c\u00f3 th\u1ec3 truy c\u1eadp b\u1edfi nh\u1eefng ng\u01b0\u1eddi tham gia Tr\u1ea1i L\u1eadp tr\u00ecnh.</li> </ul>","tags":["Original"]},{"location":"geometry/halfplane-intersection.html#references-bibliography-and-other-sources","title":"T\u00e0i li\u1ec7u tham kh\u1ea3o, th\u01b0 m\u1ee5c v\u00e0 c\u00e1c ngu\u1ed3n kh\u00e1c (References, bibliography and other sources)","text":"","tags":["Original"]},{"location":"geometry/halfplane-intersection.html#main-sources","title":"Ngu\u1ed3n ch\u00ednh","text":"<ul> <li>New Algorithm for Half-plane Intersection and its Practical Value. B\u00e0i b\u00e1o g\u1ed1c c\u1ee7a thu\u1eadt to\u00e1n.</li> <li>Artem Vasilyev's Brazilian ICPC Summer School 2020 lecture. B\u00e0i gi\u1ea3ng tuy\u1ec7t v\u1eddi v\u1ec1 giao \u0111i\u1ec3m n\u1eeda m\u1eb7t ph\u1eb3ng. C\u0169ng bao g\u1ed3m c\u00e1c ch\u1ee7 \u0111\u1ec1 h\u00ecnh h\u1ecdc kh\u00e1c.</li> </ul>","tags":["Original"]},{"location":"geometry/halfplane-intersection.html#good-blogs-chinese","title":"Blog hay (ti\u1ebfng Trung)","text":"<ul> <li>Fundamentals of Computational Geometry - Intersection of Half-planes.</li> <li>Detailed introduction to the half-plane intersection algorithm.</li> <li>Summary of Half-plane intersection problems.</li> <li>Sorting incremental method of half-plane intersection.</li> </ul>","tags":["Original"]},{"location":"geometry/halfplane-intersection.html#randomized-algorithm","title":"Thu\u1eadt to\u00e1n ng\u1eabu nhi\u00ean","text":"<ul> <li>Linear Programming and Half-Plane intersection - Parts 4 and 5.</li> <li>Petr Mitrichev's Blog: A half-plane week.</li> </ul>","tags":["Original"]},{"location":"geometry/intersecting_segments.html","title":"T\u00ecm ki\u1ebfm m\u1ed9t c\u1eb7p \u0111o\u1ea1n th\u1eb3ng giao nhau (Search for a pair of intersecting segments)","text":"<p>Cho $n$ \u0111o\u1ea1n th\u1eb3ng tr\u00ean m\u1eb7t ph\u1eb3ng. Y\u00eau c\u1ea7u ki\u1ec3m tra xem c\u00f3 \u00edt nh\u1ea5t hai trong s\u1ed1 ch\u00fang c\u1eaft nhau hay kh\u00f4ng. N\u1ebfu c\u00e2u tr\u1ea3 l\u1eddi l\u00e0 c\u00f3, h\u00e3y in ra c\u1eb7p \u0111o\u1ea1n th\u1eb3ng giao nhau n\u00e0y; ch\u1ec9 c\u1ea7n ch\u1ecdn b\u1ea5t k\u1ef3 c\u1eb7p n\u00e0o trong s\u1ed1 ch\u00fang n\u1ebfu c\u00f3 nhi\u1ec1u c\u00e2u tr\u1ea3 l\u1eddi.</p> <p>Thu\u1eadt to\u00e1n gi\u1ea3i ph\u00e1p ng\u00e2y th\u01a1 (naive) l\u00e0 l\u1eb7p qua t\u1ea5t c\u1ea3 c\u00e1c c\u1eb7p \u0111o\u1ea1n th\u1eb3ng trong $O(n^2)$ v\u00e0 ki\u1ec3m tra t\u1eebng c\u1eb7p xem ch\u00fang c\u00f3 c\u1eaft nhau hay kh\u00f4ng. B\u00e0i vi\u1ebft n\u00e0y m\u00f4 t\u1ea3 m\u1ed9t thu\u1eadt to\u00e1n v\u1edbi th\u1eddi gian ch\u1ea1y $O(n \\log n)$, d\u1ef1a tr\u00ean thu\u1eadt to\u00e1n qu\u00e9t \u0111\u01b0\u1eddng (sweep line algorithm).</p>","tags":["Translated"]},{"location":"geometry/intersecting_segments.html#algorithm","title":"Thu\u1eadt to\u00e1n (Algorithm)","text":"<p>H\u00e3y v\u1ebd m\u1ed9t \u0111\u01b0\u1eddng th\u1eb3ng \u0111\u1ee9ng $x = -\\infty$ trong t\u00e2m tr\u00ed v\u00e0 b\u1eaft \u0111\u1ea7u di chuy\u1ec3n \u0111\u01b0\u1eddng n\u00e0y sang ph\u1ea3i. Trong qu\u00e1 tr\u00ecnh di chuy\u1ec3n c\u1ee7a n\u00f3, \u0111\u01b0\u1eddng n\u00e0y s\u1ebd g\u1eb7p c\u00e1c \u0111o\u1ea1n th\u1eb3ng, v\u00e0 t\u1ea1i m\u1ed7i th\u1eddi \u0111i\u1ec3m m\u1ed9t \u0111o\u1ea1n th\u1eb3ng c\u1eaft \u0111\u01b0\u1eddng th\u1eb3ng c\u1ee7a ch\u00fang ta, n\u00f3 c\u1eaft nhau t\u1ea1i \u0111\u00fang m\u1ed9t \u0111i\u1ec3m (ch\u00fang ta s\u1ebd gi\u1ea3 s\u1eed r\u1eb1ng kh\u00f4ng c\u00f3 \u0111o\u1ea1n th\u1eb3ng \u0111\u1ee9ng n\u00e0o).</p> <p>Do \u0111\u00f3, \u0111\u1ed1i v\u1edbi m\u1ed7i \u0111o\u1ea1n th\u1eb3ng, t\u1ea1i m\u1ed9t th\u1eddi \u0111i\u1ec3m n\u00e0o \u0111\u00f3, \u0111i\u1ec3m c\u1ee7a n\u00f3 s\u1ebd xu\u1ea5t hi\u1ec7n tr\u00ean \u0111\u01b0\u1eddng qu\u00e9t, sau \u0111\u00f3 c\u00f9ng v\u1edbi chuy\u1ec3n \u0111\u1ed9ng c\u1ee7a \u0111\u01b0\u1eddng, \u0111i\u1ec3m n\u00e0y s\u1ebd di chuy\u1ec3n, v\u00e0 cu\u1ed1i c\u00f9ng, t\u1ea1i m\u1ed9t th\u1eddi \u0111i\u1ec3m n\u00e0o \u0111\u00f3, \u0111o\u1ea1n th\u1eb3ng s\u1ebd bi\u1ebfn m\u1ea5t kh\u1ecfi \u0111\u01b0\u1eddng qu\u00e9t.</p> <p>Ch\u00fang ta quan t\u00e2m \u0111\u1ebfn th\u1ee9 t\u1ef1 t\u01b0\u01a1ng \u0111\u1ed1i c\u1ee7a c\u00e1c \u0111o\u1ea1n th\u1eb3ng d\u1ecdc theo ph\u01b0\u01a1ng th\u1eb3ng \u0111\u1ee9ng. C\u1ee5 th\u1ec3, ch\u00fang ta s\u1ebd l\u01b0u tr\u1eef m\u1ed9t danh s\u00e1ch c\u00e1c \u0111o\u1ea1n th\u1eb3ng c\u1eaft \u0111\u01b0\u1eddng qu\u00e9t t\u1ea1i m\u1ed9t th\u1eddi \u0111i\u1ec3m nh\u1ea5t \u0111\u1ecbnh, trong \u0111\u00f3 c\u00e1c \u0111o\u1ea1n th\u1eb3ng s\u1ebd \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp theo t\u1ecda \u0111\u1ed9 $y$ c\u1ee7a ch\u00fang tr\u00ean \u0111\u01b0\u1eddng qu\u00e9t.</p> <p>Th\u1ee9 t\u1ef1 n\u00e0y th\u00fa v\u1ecb b\u1edfi v\u00ec c\u00e1c \u0111o\u1ea1n th\u1eb3ng giao nhau s\u1ebd c\u00f3 c\u00f9ng t\u1ecda \u0111\u1ed9 $y$ \u00edt nh\u1ea5t t\u1ea1i m\u1ed9t th\u1eddi \u0111i\u1ec3m:</p> <p>Ch\u00fang ta h\u00ecnh th\u00e0nh c\u00e1c tuy\u00ean b\u1ed1 ch\u00ednh:</p> <ul> <li>\u0110\u1ec3 t\u00ecm m\u1ed9t c\u1eb7p \u0111o\u1ea1n th\u1eb3ng giao nhau, ch\u1ec9 c\u1ea7n xem x\u00e9t c\u00e1c \u0111o\u1ea1n th\u1eb3ng li\u1ec1n k\u1ec1 t\u1ea1i m\u1ed7i v\u1ecb tr\u00ed c\u1ed1 \u0111\u1ecbnh c\u1ee7a \u0111\u01b0\u1eddng qu\u00e9t l\u00e0 \u0111\u1ee7.</li> <li>Ch\u1ec9 c\u1ea7n xem x\u00e9t \u0111\u01b0\u1eddng qu\u00e9t kh\u00f4ng ph\u1ea3i \u1edf t\u1ea5t c\u1ea3 c\u00e1c v\u1ecb tr\u00ed th\u1ef1c c\u00f3 th\u1ec3 $(-\\infty \\ldots +\\infty)$, m\u00e0 ch\u1ec9 \u1edf nh\u1eefng v\u1ecb tr\u00ed khi c\u00e1c \u0111o\u1ea1n th\u1eb3ng m\u1edbi xu\u1ea5t hi\u1ec7n ho\u1eb7c c\u00e1c \u0111o\u1ea1n th\u1eb3ng c\u0169 bi\u1ebfn m\u1ea5t. N\u00f3i c\u00e1ch kh\u00e1c, ch\u1ec9 c\u1ea7n gi\u1edbi h\u1ea1n b\u1ea3n th\u00e2n trong c\u00e1c v\u1ecb tr\u00ed b\u1eb1ng v\u1edbi ho\u00e0nh \u0111\u1ed9 (abscissas) c\u1ee7a c\u00e1c \u0111i\u1ec3m cu\u1ed1i c\u1ee7a c\u00e1c \u0111o\u1ea1n th\u1eb3ng.</li> <li>Khi m\u1ed9t \u0111o\u1ea1n th\u1eb3ng m\u1edbi xu\u1ea5t hi\u1ec7n, ch\u1ec9 c\u1ea7n ch\u00e8n n\u00f3 v\u00e0o v\u1ecb tr\u00ed mong mu\u1ed1n trong danh s\u00e1ch thu \u0111\u01b0\u1ee3c cho \u0111\u01b0\u1eddng qu\u00e9t tr\u01b0\u1edbc \u0111\u00f3. Ch\u00fang ta ch\u1ec9 n\u00ean ki\u1ec3m tra s\u1ef1 giao nhau c\u1ee7a \u0111o\u1ea1n th\u1eb3ng \u0111\u00e3 th\u00eam v\u1edbi c\u00e1c h\u00e0ng x\u00f3m tr\u1ef1c ti\u1ebfp c\u1ee7a n\u00f3 trong danh s\u00e1ch \u1edf tr\u00ean v\u00e0 \u1edf d\u01b0\u1edbi.</li> <li>N\u1ebfu \u0111o\u1ea1n th\u1eb3ng bi\u1ebfn m\u1ea5t, ch\u1ec9 c\u1ea7n x\u00f3a n\u00f3 kh\u1ecfi danh s\u00e1ch hi\u1ec7n t\u1ea1i. Sau \u0111\u00f3, c\u1ea7n thi\u1ebft ph\u1ea3i ki\u1ec3m tra s\u1ef1 giao nhau c\u1ee7a c\u00e1c h\u00e0ng x\u00f3m tr\u00ean v\u00e0 d\u01b0\u1edbi trong danh s\u00e1ch.</li> <li>Kh\u00f4ng t\u1ed3n t\u1ea1i c\u00e1c thay \u0111\u1ed5i kh\u00e1c trong chu\u1ed7i c\u00e1c \u0111o\u1ea1n th\u1eb3ng trong danh s\u00e1ch, ngo\u1ea1i tr\u1eeb nh\u1eefng thay \u0111\u1ed5i \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3. Kh\u00f4ng c\u1ea7n ki\u1ec3m tra giao nhau n\u00e0o kh\u00e1c.</li> </ul> <p>\u0110\u1ec3 hi\u1ec3u s\u1ef1 th\u1eadt c\u1ee7a c\u00e1c tuy\u00ean b\u1ed1 n\u00e0y, c\u00e1c nh\u1eadn x\u00e9t sau \u0111\u00e2y l\u00e0 \u0111\u1ee7:</p> <ul> <li>Hai \u0111o\u1ea1n th\u1eb3ng kh\u00f4ng giao nhau kh\u00f4ng bao gi\u1edd thay \u0111\u1ed5i th\u1ee9 t\u1ef1 t\u01b0\u01a1ng \u0111\u1ed1i c\u1ee7a ch\u00fang.     Th\u1ef1c t\u1ebf, n\u1ebfu m\u1ed9t \u0111o\u1ea1n th\u1eb3ng ban \u0111\u1ea7u cao h\u01a1n \u0111o\u1ea1n kia, v\u00e0 sau \u0111\u00f3 tr\u1edf n\u00ean th\u1ea5p h\u01a1n, th\u00ec gi\u1eefa hai th\u1eddi \u0111i\u1ec3m n\u00e0y \u0111\u00e3 c\u00f3 s\u1ef1 giao nhau c\u1ee7a hai \u0111o\u1ea1n th\u1eb3ng n\u00e0y.</li> <li>Hai \u0111o\u1ea1n th\u1eb3ng kh\u00f4ng giao nhau c\u0169ng kh\u00f4ng th\u1ec3 c\u00f3 c\u00f9ng t\u1ecda \u0111\u1ed9 $y$.</li> <li>T\u1eeb \u0111i\u1ec1u n\u00e0y suy ra r\u1eb1ng t\u1ea1i th\u1eddi \u0111i\u1ec3m \u0111o\u1ea1n th\u1eb3ng xu\u1ea5t hi\u1ec7n, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm v\u1ecb tr\u00ed cho \u0111o\u1ea1n th\u1eb3ng n\u00e0y trong h\u00e0ng \u0111\u1ee3i, v\u00e0 ch\u00fang ta s\u1ebd kh\u00f4ng ph\u1ea3i s\u1eafp x\u1ebfp l\u1ea1i \u0111o\u1ea1n th\u1eb3ng n\u00e0y trong h\u00e0ng \u0111\u1ee3i n\u1eefa: th\u1ee9 t\u1ef1 c\u1ee7a n\u00f3 so v\u1edbi c\u00e1c \u0111o\u1ea1n th\u1eb3ng kh\u00e1c trong h\u00e0ng \u0111\u1ee3i s\u1ebd kh\u00f4ng thay \u0111\u1ed5i.</li> <li>Hai \u0111o\u1ea1n th\u1eb3ng giao nhau t\u1ea1i th\u1eddi \u0111i\u1ec3m \u0111i\u1ec3m giao nhau c\u1ee7a ch\u00fang s\u1ebd l\u00e0 h\u00e0ng x\u00f3m c\u1ee7a nhau trong h\u00e0ng \u0111\u1ee3i.</li> <li>Do \u0111\u00f3, \u0111\u1ec3 t\u00ecm c\u00e1c c\u1eb7p \u0111o\u1ea1n th\u1eb3ng giao nhau l\u00e0 \u0111\u1ee7 \u0111\u1ec3 ki\u1ec3m tra s\u1ef1 giao nhau c\u1ee7a t\u1ea5t c\u1ea3 v\u00e0 ch\u1ec9 nh\u1eefng c\u1eb7p \u0111o\u1ea1n th\u1eb3ng m\u00e0 \u0111\u00f4i khi trong qu\u00e1 tr\u00ecnh di chuy\u1ec3n c\u1ee7a \u0111\u01b0\u1eddng qu\u00e9t \u00edt nh\u1ea5t m\u1ed9t l\u1ea7n l\u00e0 h\u00e0ng x\u00f3m c\u1ee7a nhau.      D\u1ec5 nh\u1eadn th\u1ea5y r\u1eb1ng ch\u1ec9 c\u1ea7n ki\u1ec3m tra \u0111o\u1ea1n th\u1eb3ng \u0111\u00e3 th\u00eam v\u1edbi c\u00e1c h\u00e0ng x\u00f3m tr\u00ean v\u00e0 d\u01b0\u1edbi c\u1ee7a n\u00f3, c\u0169ng nh\u01b0 khi x\u00f3a \u0111o\u1ea1n th\u1eb3ng \u2014 c\u00e1c h\u00e0ng x\u00f3m tr\u00ean v\u00e0 d\u01b0\u1edbi c\u1ee7a n\u00f3 (sau khi x\u00f3a s\u1ebd tr\u1edf th\u00e0nh h\u00e0ng x\u00f3m c\u1ee7a nhau).</li> <li>C\u1ea7n l\u01b0u \u00fd r\u1eb1ng t\u1ea1i m\u1ed9t v\u1ecb tr\u00ed c\u1ed1 \u0111\u1ecbnh c\u1ee7a \u0111\u01b0\u1eddng qu\u00e9t, ch\u00fang ta ph\u1ea3i th\u00eam t\u1ea5t c\u1ea3 c\u00e1c \u0111o\u1ea1n th\u1eb3ng tr\u01b0\u1edbc b\u1eaft \u0111\u1ea7u t\u1ea1i t\u1ecda \u0111\u1ed9 x n\u00e0y, v\u00e0 ch\u1ec9 sau \u0111\u00f3 x\u00f3a t\u1ea5t c\u1ea3 c\u00e1c \u0111o\u1ea1n th\u1eb3ng k\u1ebft th\u00fac t\u1ea1i \u0111\u00e2y.     Do \u0111\u00f3, ch\u00fang ta kh\u00f4ng b\u1ecf l\u1ee1 s\u1ef1 giao nhau c\u1ee7a c\u00e1c \u0111o\u1ea1n th\u1eb3ng tr\u00ean \u0111\u1ec9nh: t\u1ee9c l\u00e0 nh\u1eefng tr\u01b0\u1eddng h\u1ee3p khi hai \u0111o\u1ea1n th\u1eb3ng c\u00f3 chung m\u1ed9t \u0111\u1ec9nh.</li> <li>L\u01b0u \u00fd r\u1eb1ng c\u00e1c \u0111o\u1ea1n th\u1eb3ng \u0111\u1ee9ng th\u1ef1c s\u1ef1 kh\u00f4ng \u1ea3nh h\u01b0\u1edfng \u0111\u1ebfn t\u00ednh \u0111\u00fang \u0111\u1eafn c\u1ee7a thu\u1eadt to\u00e1n.     C\u00e1c \u0111o\u1ea1n th\u1eb3ng n\u00e0y \u0111\u01b0\u1ee3c ph\u00e2n bi\u1ec7t b\u1edfi th\u1ef1c t\u1ebf l\u00e0 ch\u00fang xu\u1ea5t hi\u1ec7n v\u00e0 bi\u1ebfn m\u1ea5t c\u00f9ng m\u1ed9t l\u00fac. Tuy nhi\u00ean, do nh\u1eadn x\u00e9t tr\u01b0\u1edbc \u0111\u00f3, ch\u00fang ta bi\u1ebft r\u1eb1ng t\u1ea5t c\u1ea3 c\u00e1c \u0111o\u1ea1n th\u1eb3ng s\u1ebd \u0111\u01b0\u1ee3c th\u00eam v\u00e0o h\u00e0ng \u0111\u1ee3i tr\u01b0\u1edbc, v\u00e0 ch\u1ec9 sau \u0111\u00f3 ch\u00fang m\u1edbi b\u1ecb x\u00f3a. Do \u0111\u00f3, n\u1ebfu \u0111o\u1ea1n th\u1eb3ng \u0111\u1ee9ng c\u1eaft m\u1ed9t \u0111o\u1ea1n th\u1eb3ng n\u00e0o \u0111\u00f3 kh\u00e1c \u0111\u00e3 m\u1edf t\u1ea1i th\u1eddi \u0111i\u1ec3m \u0111\u00f3 (bao g\u1ed3m c\u1ea3 \u0111o\u1ea1n th\u1eb3ng \u0111\u1ee9ng), n\u00f3 s\u1ebd \u0111\u01b0\u1ee3c ph\u00e1t hi\u1ec7n. \u0110\u1eb7t c\u00e1c \u0111o\u1ea1n th\u1eb3ng \u0111\u1ee9ng \u1edf v\u1ecb tr\u00ed n\u00e0o trong h\u00e0ng \u0111\u1ee3i? R\u1ed1t cu\u1ed9c, m\u1ed9t \u0111o\u1ea1n th\u1eb3ng \u0111\u1ee9ng kh\u00f4ng c\u00f3 m\u1ed9t t\u1ecda \u0111\u1ed9 $y$ c\u1ee5 th\u1ec3, n\u00f3 k\u00e9o d\u00e0i cho c\u1ea3 m\u1ed9t \u0111o\u1ea1n d\u1ecdc theo t\u1ecda \u0111\u1ed9 $y$. Tuy nhi\u00ean, d\u1ec5 hi\u1ec3u r\u1eb1ng b\u1ea5t k\u1ef3 t\u1ecda \u0111\u1ed9 n\u00e0o t\u1eeb \u0111o\u1ea1n n\u00e0y \u0111\u1ec1u c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c l\u1ea5y l\u00e0m t\u1ecda \u0111\u1ed9 $y$.</li> </ul> <p>Do \u0111\u00f3, to\u00e0n b\u1ed9 thu\u1eadt to\u00e1n s\u1ebd th\u1ef1c hi\u1ec7n kh\u00f4ng qu\u00e1 $2n$ b\u00e0i ki\u1ec3m tra v\u1ec1 s\u1ef1 giao nhau c\u1ee7a m\u1ed9t c\u1eb7p \u0111o\u1ea1n th\u1eb3ng, v\u00e0 s\u1ebd th\u1ef1c hi\u1ec7n $O(n)$ thao t\u00e1c v\u1edbi m\u1ed9t h\u00e0ng \u0111\u1ee3i c\u00e1c \u0111o\u1ea1n th\u1eb3ng ($O(1)$ thao t\u00e1c t\u1ea1i th\u1eddi \u0111i\u1ec3m xu\u1ea5t hi\u1ec7n v\u00e0 bi\u1ebfn m\u1ea5t c\u1ee7a m\u1ed7i \u0111o\u1ea1n th\u1eb3ng).</p> <p>H\u00e0nh vi ti\u1ec7m c\u1eadn c\u1ee7a thu\u1eadt to\u00e1n (asymptotic behavior) cu\u1ed1i c\u00f9ng do \u0111\u00f3 l\u00e0 $O(n \\log n)$.</p>","tags":["Translated"]},{"location":"geometry/intersecting_segments.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>Ch\u00fang t\u00f4i tr\u00ecnh b\u00e0y vi\u1ec7c c\u00e0i \u0111\u1eb7t \u0111\u1ea7y \u0111\u1ee7 c\u1ee7a thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3:</p> <pre><code>const double EPS = 1E-9;\n\nstruct pt {\n    double x, y;\n};\n\nstruct seg {\n    pt p, q;\n    int id;\n\n    double get_y(double x) const {\n        if (abs(p.x - q.x) &lt; EPS)\n            return p.y;\n        return p.y + (q.y - p.y) * (x - p.x) / (q.x - p.x);\n    }\n};\n\nbool intersect1d(double l1, double r1, double l2, double r2) {\n    if (l1 &gt; r1)\n        swap(l1, r1);\n    if (l2 &gt; r2)\n        swap(l2, r2);\n    return max(l1, l2) &lt;= min(r1, r2) + EPS;\n}\n\nint vec(const pt&amp; a, const pt&amp; b, const pt&amp; c) {\n    double s = (b.x - a.x) * (c.y - a.y) - (b.y - a.y) * (c.x - a.x);\n    return abs(s) &lt; EPS ? 0 : s &gt; 0 ? +1 : -1;\n}\n\nbool intersect(const seg&amp; a, const seg&amp; b)\n{\n    return intersect1d(a.p.x, a.q.x, b.p.x, b.q.x) &amp;&amp;\n           intersect1d(a.p.y, a.q.y, b.p.y, b.q.y) &amp;&amp;\n           vec(a.p, a.q, b.p) * vec(a.p, a.q, b.q) &lt;= 0 &amp;&amp;\n           vec(b.p, b.q, a.p) * vec(b.p, b.q, a.q) &lt;= 0;\n}\n\nbool operator&lt;(const seg&amp; a, const seg&amp; b)\n{\n    double x = max(min(a.p.x, a.q.x), min(b.p.x, b.q.x));\n    return a.get_y(x) &lt; b.get_y(x) - EPS;\n}\n\nstruct event {\n    double x;\n    int tp, id;\n\n    event() {}\n    event(double x, int tp, int id) : x(x), tp(tp), id(id) {}\n\n    bool operator&lt;(const event&amp; e) const {\n        if (abs(x - e.x) &gt; EPS)\n            return x &lt; e.x;\n        return tp &gt; e.tp;\n    }\n};\n\nset&lt;seg&gt; s;\nvector&lt;set&lt;seg&gt;::iterator&gt; where;\n\nset&lt;seg&gt;::iterator prev(set&lt;seg&gt;::iterator it) {\n    return it == s.begin() ? s.end() : --it;\n}\n\nset&lt;seg&gt;::iterator next(set&lt;seg&gt;::iterator it) {\n    return ++it;\n}\n\npair&lt;int, int&gt; solve(const vector&lt;seg&gt;&amp; a) {\n    int n = (int)a.size();\n    vector&lt;event&gt; e;\n    for (int i = 0; i &lt; n; ++i) {\n        e.push_back(event(min(a[i].p.x, a[i].q.x), +1, i));\n        e.push_back(event(max(a[i].p.x, a[i].q.x), -1, i));\n    }\n    sort(e.begin(), e.end());\n\n    s.clear();\n    where.resize(a.size());\n    for (size_t i = 0; i &lt; e.size(); ++i) {\n        int id = e[i].id;\n        if (e[i].tp == +1) {\n            set&lt;seg&gt;::iterator nxt = s.lower_bound(a[id]), prv = prev(nxt);\n            if (nxt != s.end() &amp;&amp; intersect(*nxt, a[id]))\n                return make_pair(nxt-&gt;id, id);\n            if (prv != s.end() &amp;&amp; intersect(*prv, a[id]))\n                return make_pair(prv-&gt;id, id);\n            where[id] = s.insert(nxt, a[id]);\n        } else {\n            set&lt;seg&gt;::iterator nxt = next(where[id]), prv = prev(where[id]);\n            if (nxt != s.end() &amp;&amp; prv != s.end() &amp;&amp; intersect(*nxt, *prv))\n                return make_pair(prv-&gt;id, nxt-&gt;id);\n            s.erase(where[id]);\n        }\n    }\n\n    return make_pair(-1, -1);\n}\n</code></pre> <p>H\u00e0m ch\u00ednh \u1edf \u0111\u00e2y l\u00e0 <code>solve()</code>, tr\u1ea3 v\u1ec1 c\u00e1c \u0111o\u1ea1n th\u1eb3ng giao nhau n\u1ebfu t\u1ed3n t\u1ea1i, ho\u1eb7c $(-1, -1)$, n\u1ebfu kh\u00f4ng c\u00f3 giao \u0111i\u1ec3m.</p> <p>Ki\u1ec3m tra giao \u0111i\u1ec3m c\u1ee7a hai \u0111o\u1ea1n th\u1eb3ng \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n b\u1edfi h\u00e0m <code>intersect ()</code>, s\u1eed d\u1ee5ng thu\u1eadt to\u00e1n d\u1ef1a tr\u00ean di\u1ec7n t\u00edch c\u00f3 h\u01b0\u1edbng c\u1ee7a tam gi\u00e1c.</p> <p>H\u00e0ng \u0111\u1ee3i c\u00e1c \u0111o\u1ea1n th\u1eb3ng l\u00e0 bi\u1ebfn to\u00e0n c\u1ee5c <code>s</code>, m\u1ed9t <code>set&lt;event&gt;</code>. C\u00e1c iterator ch\u1ec9 \u0111\u1ecbnh v\u1ecb tr\u00ed c\u1ee7a m\u1ed7i \u0111o\u1ea1n th\u1eb3ng trong h\u00e0ng \u0111\u1ee3i (\u0111\u1ec3 thu\u1eadn ti\u1ec7n cho vi\u1ec7c x\u00f3a c\u00e1c \u0111o\u1ea1n th\u1eb3ng kh\u1ecfi h\u00e0ng \u0111\u1ee3i) \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef trong m\u1ea3ng to\u00e0n c\u1ee5c <code>where</code>.</p> <p>Hai h\u00e0m ph\u1ee5 tr\u1ee3 <code>prev()</code> v\u00e0 <code>next()</code> c\u0169ng \u0111\u01b0\u1ee3c gi\u1edbi thi\u1ec7u, tr\u1ea3 v\u1ec1 c\u00e1c iterator \u0111\u1ebfn c\u00e1c ph\u1ea7n t\u1eed tr\u01b0\u1edbc \u0111\u00f3 v\u00e0 ti\u1ebfp theo (ho\u1eb7c <code>end()</code>, n\u1ebfu kh\u00f4ng t\u1ed3n t\u1ea1i).</p> <p>H\u1eb1ng s\u1ed1 <code>EPS</code> bi\u1ec3u th\u1ecb sai s\u1ed1 c\u1ee7a vi\u1ec7c so s\u00e1nh hai s\u1ed1 th\u1ef1c (n\u00f3 ch\u1ee7 y\u1ebfu \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng khi ki\u1ec3m tra hai \u0111o\u1ea1n th\u1eb3ng giao nhau).</p>","tags":["Translated"]},{"location":"geometry/intersecting_segments.html#problems","title":"B\u00e0i t\u1eadp (Problems)","text":"<ul> <li>TIMUS 1469 No Smoking!</li> </ul>","tags":["Translated"]},{"location":"geometry/lattice-points.html","title":"\u0110i\u1ec3m nguy\u00ean b\u00ean trong \u0111a gi\u00e1c kh\u00f4ng nguy\u00ean (Lattice points inside non-lattice polygon)","text":"<p>\u0110\u1ed1i v\u1edbi c\u00e1c \u0111a gi\u00e1c nguy\u00ean (\u0111a gi\u00e1c c\u00f3 c\u00e1c \u0111\u1ec9nh l\u00e0 \u0111i\u1ec3m nguy\u00ean), \u0111\u00e3 c\u00f3 c\u00f4ng th\u1ee9c Pick \u0111\u1ec3 li\u1ec7t k\u00ea c\u00e1c \u0111i\u1ec3m nguy\u00ean b\u00ean trong \u0111a gi\u00e1c. C\u00f2n \u0111\u1ed1i v\u1edbi c\u00e1c \u0111a gi\u00e1c c\u00f3 c\u00e1c \u0111\u1ec9nh t\u00f9y \u00fd th\u00ec sao?</p> <p>H\u00e3y x\u1eed l\u00fd t\u1eebng c\u1ea1nh c\u1ee7a \u0111a gi\u00e1c m\u1ed9t c\u00e1ch ri\u00eang l\u1ebb, v\u00e0 sau \u0111\u00f3 ch\u00fang ta c\u00f3 th\u1ec3 c\u1ed9ng t\u1ed5ng s\u1ed1 l\u01b0\u1ee3ng c\u00e1c \u0111i\u1ec3m nguy\u00ean b\u00ean d\u01b0\u1edbi m\u1ed7i c\u1ea1nh, xem x\u00e9t h\u01b0\u1edbng c\u1ee7a n\u00f3 \u0111\u1ec3 ch\u1ecdn d\u1ea5u (gi\u1ed1ng nh\u01b0 trong vi\u1ec7c t\u00ednh di\u1ec7n t\u00edch c\u1ee7a m\u1ed9t \u0111a gi\u00e1c b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng c\u00e1c h\u00ecnh thang).</p> <p>Tr\u01b0\u1edbc h\u1ebft, ch\u00fang ta n\u00ean l\u01b0u \u00fd r\u1eb1ng n\u1ebfu c\u1ea1nh hi\u1ec7n t\u1ea1i c\u00f3 c\u00e1c \u0111i\u1ec3m \u0111\u1ea7u m\u00fat t\u1ea1i $A=(x_1;y_1)$ v\u00e0 $B=(x_2;y_2)$ th\u00ec n\u00f3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n d\u01b0\u1edbi d\u1ea1ng m\u1ed9t h\u00e0m tuy\u1ebfn t\u00ednh:</p> $$y=y_1+(y_2-y_1) \\cdot \\dfrac{x-x_1}{x_2-x_1}=\\left(\\dfrac{y_2-y_1}{x_2-x_1}\\right)\\cdot x + \\left(\\dfrac{y_1x_2-x_1y_2}{x_2-x_1}\\right)$$ $$y = k \\cdot x + b,~k = \\dfrac{y_2-y_1}{x_2-x_1},~b = \\dfrac{y_1x_2-x_1y_2}{x_2-x_1}$$ <p>B\u00e2y gi\u1edd ch\u00fang ta s\u1ebd th\u1ef1c hi\u1ec7n m\u1ed9t ph\u00e9p thay th\u1ebf $x=x'+\\lceil x_1 \\rceil$ \u0111\u1ec3 $b' = b + k \\cdot \\lceil x_1 \\rceil$. \u0110i\u1ec1u n\u00e0y cho ph\u00e9p ch\u00fang ta l\u00e0m vi\u1ec7c v\u1edbi $x_1'=0$ v\u00e0 $x_2'=x_2 - \\lceil x_1 \\rceil$. H\u00e3y k\u00fd hi\u1ec7u $n = \\lfloor x_2' \\rfloor$.</p> <p>Ch\u00fang ta s\u1ebd kh\u00f4ng c\u1ed9ng t\u1ed5ng c\u00e1c \u0111i\u1ec3m t\u1ea1i $x = n$ v\u00e0 tr\u00ean $y = 0$ cho t\u00ednh to\u00e0n v\u1eb9n c\u1ee7a thu\u1eadt to\u00e1n. Ch\u00fang c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u00eam v\u00e0o th\u1ee7 c\u00f4ng sau \u0111\u00f3. Do \u0111\u00f3 ch\u00fang ta ph\u1ea3i t\u00ednh t\u1ed5ng $\\sum\\limits_{x'=0}^{n - 1} \\lfloor k' \\cdot x' + b'\\rfloor$. Ch\u00fang ta c\u0169ng gi\u1ea3 s\u1eed r\u1eb1ng $k' \\geq 0$ v\u00e0 $b'\\geq 0$. N\u1ebfu kh\u00f4ng, ng\u01b0\u1eddi ta n\u00ean thay th\u1ebf $x'=-t$ v\u00e0 th\u00eam $\\lceil|b'|\\rceil$ v\u00e0o $b'$.</p> <p>H\u00e3y th\u1ea3o lu\u1eadn v\u1ec1 c\u00e1ch ch\u00fang ta c\u00f3 th\u1ec3 \u0111\u00e1nh gi\u00e1 t\u1ed5ng $\\sum\\limits_{x=0}^{n - 1} \\lfloor k \\cdot x + b\\rfloor$. Ch\u00fang ta c\u00f3 hai tr\u01b0\u1eddng h\u1ee3p:</p> <ul> <li> <p>$k \\geq 1$ ho\u1eb7c $b \\geq 1$.</p> <p>Khi \u0111\u00f3 ch\u00fang ta n\u00ean b\u1eaft \u0111\u1ea7u b\u1eb1ng c\u00e1ch c\u1ed9ng t\u1ed5ng c\u00e1c \u0111i\u1ec3m b\u00ean d\u01b0\u1edbi $y=\\lfloor k \\rfloor \\cdot x + \\lfloor b \\rfloor$. S\u1ed1 l\u01b0\u1ee3ng c\u1ee7a ch\u00fang b\u1eb1ng</p> $$ \\sum\\limits_{x=0}^{n - 1} \\lfloor k \\rfloor \\cdot x + \\lfloor b \\rfloor=\\dfrac{(\\lfloor k \\rfloor(n-1)+2\\lfloor b \\rfloor) n}{2}. $$ <p>B\u00e2y gi\u1edd ch\u00fang ta ch\u1ec9 quan t\u00e2m \u0111\u1ebfn c\u00e1c \u0111i\u1ec3m $(x;y)$ sao cho $\\lfloor k \\rfloor \\cdot x + \\lfloor b \\rfloor &lt; y \\leq k\\cdot x + b$. S\u1ed1 l\u01b0\u1ee3ng n\u00e0y c\u0169ng gi\u1ed1ng nh\u01b0 s\u1ed1 l\u01b0\u1ee3ng c\u00e1c \u0111i\u1ec3m sao cho $0 &lt; y \\leq (k - \\lfloor k \\rfloor) \\cdot x + (b - \\lfloor b \\rfloor)$. V\u00ec v\u1eady, ch\u00fang ta \u0111\u00e3 gi\u1ea3m b\u00e0i to\u00e1n c\u1ee7a m\u00ecnh th\u00e0nh $k'= k - \\lfloor k \\rfloor$, $b' = b - \\lfloor b \\rfloor$ v\u00e0 c\u1ea3 $k'$ v\u00e0 $b'$ hi\u1ec7n \u0111\u1ec1u nh\u1ecf h\u01a1n $1$. D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u1ed9t h\u00ecnh \u1ea3nh, ch\u00fang ta ch\u1ec9 c\u1ea7n c\u1ed9ng t\u1ed5ng c\u00e1c \u0111i\u1ec3m m\u00e0u xanh lam v\u00e0 tr\u1eeb \u0111i h\u00e0m tuy\u1ebfn t\u00ednh m\u00e0u xanh lam kh\u1ecfi h\u00e0m m\u00e0u \u0111en \u0111\u1ec3 gi\u1ea3m b\u00e0i to\u00e1n xu\u1ed1ng c\u00e1c gi\u00e1 tr\u1ecb nh\u1ecf h\u01a1n cho $k$ v\u00e0 $b$:  </p> </li> <li> <p>$k &lt; 1$ v\u00e0 $b &lt; 1$.</p> <p>N\u1ebfu $\\lfloor k \\cdot n + b\\rfloor$ b\u1eb1ng $0$, ch\u00fang ta c\u00f3 th\u1ec3 tr\u1ea3 v\u1ec1 $0$ m\u1ed9t c\u00e1ch an to\u00e0n. N\u1ebfu kh\u00f4ng ph\u1ea3i tr\u01b0\u1eddng h\u1ee3p n\u00e0y, ch\u00fang ta c\u00f3 th\u1ec3 n\u00f3i r\u1eb1ng kh\u00f4ng c\u00f3 \u0111i\u1ec3m nguy\u00ean n\u00e0o sao cho $x &lt; 0$ v\u00e0 $0 &lt; y \\leq k \\cdot x + b$. \u0110i\u1ec1u \u0111\u00f3 c\u00f3 ngh\u0129a l\u00e0 ch\u00fang ta s\u1ebd c\u00f3 c\u00f9ng m\u1ed9t c\u00e2u tr\u1ea3 l\u1eddi n\u1ebfu ch\u00fang ta xem x\u00e9t h\u1ec7 quy chi\u1ebfu m\u1edbi trong \u0111\u00f3 $O'=(n;\\lfloor k\\cdot n + b\\rfloor)$, tr\u1ee5c $x'$ h\u01b0\u1edbng xu\u1ed1ng d\u01b0\u1edbi v\u00e0 tr\u1ee5c $y'$ h\u01b0\u1edbng sang tr\u00e1i. \u0110\u1ed1i v\u1edbi h\u1ec7 quy chi\u1ebfu n\u00e0y, ch\u00fang ta quan t\u00e2m \u0111\u1ebfn c\u00e1c \u0111i\u1ec3m nguy\u00ean tr\u00ean t\u1eadp h\u1ee3p</p> $$ \\left\\{(x;y)~\\bigg|~0 \\leq x &lt; \\lfloor k \\cdot n + b\\rfloor,~ 0 &lt; y \\leq \\dfrac{x+(k\\cdot n+b)-\\lfloor k\\cdot n + b \\rfloor}{k}\\right\\} $$ <p>tr\u1ea3 l\u1ea1i ch\u00fang ta v\u1ec1 tr\u01b0\u1eddng h\u1ee3p $k&gt;1$. B\u1ea1n c\u00f3 th\u1ec3 th\u1ea5y \u0111i\u1ec3m tham chi\u1ebfu m\u1edbi $O'$ v\u00e0 c\u00e1c tr\u1ee5c $X'$ v\u00e0 $Y'$ trong h\u00ecnh d\u01b0\u1edbi \u0111\u00e2y:   Nh\u01b0 b\u1ea1n th\u1ea5y, trong h\u1ec7 quy chi\u1ebfu m\u1edbi, h\u00e0m tuy\u1ebfn t\u00ednh s\u1ebd c\u00f3 h\u1ec7 s\u1ed1 $\\tfrac 1 k$ v\u00e0 \u0111i\u1ec3m kh\u00f4ng c\u1ee7a n\u00f3 s\u1ebd \u1edf \u0111i\u1ec3m $\\lfloor k\\cdot n + b \\rfloor-(k\\cdot n+b)$ l\u00e0m cho c\u00f4ng th\u1ee9c tr\u00ean \u0111\u00fang.</p> </li> </ul>","tags":["Translated"]},{"location":"geometry/lattice-points.html#complexity-analysis","title":"Ph\u00e2n t\u00edch \u0111\u1ed9 ph\u1ee9c t\u1ea1p (Complexity analysis)","text":"<p>Ch\u00fang ta ph\u1ea3i \u0111\u1ebfm t\u1ed1i \u0111a $\\dfrac{(k(n-1)+2b)n}{2}$ \u0111i\u1ec3m. Trong s\u1ed1 \u0111\u00f3, ch\u00fang ta s\u1ebd \u0111\u1ebfm $\\dfrac{\\lfloor k \\rfloor (n-1)+2\\lfloor b \\rfloor}{2}$ \u1edf ngay b\u01b0\u1edbc \u0111\u1ea7u ti\u00ean. Ch\u00fang ta c\u00f3 th\u1ec3 coi $b$ l\u00e0 nh\u1ecf kh\u00f4ng \u0111\u00e1ng k\u1ec3 v\u00ec ch\u00fang ta c\u00f3 th\u1ec3 b\u1eaft \u0111\u1ea7u b\u1eb1ng c\u00e1ch l\u00e0m cho n\u00f3 nh\u1ecf h\u01a1n $1$. Trong tr\u01b0\u1eddng h\u1ee3p \u0111\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 n\u00f3i r\u1eb1ng ch\u00fang ta \u0111\u1ebfm kho\u1ea3ng $\\dfrac{\\lfloor k \\rfloor}{k} \\geq \\dfrac 1 2$  t\u1ea5t c\u1ea3 c\u00e1c \u0111i\u1ec3m. Do \u0111\u00f3, ch\u00fang ta s\u1ebd k\u1ebft th\u00fac trong $O(\\log n)$ b\u01b0\u1edbc.</p>","tags":["Translated"]},{"location":"geometry/lattice-points.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 h\u00e0m \u0111\u01a1n gi\u1ea3n t\u00ednh to\u00e1n s\u1ed1 l\u01b0\u1ee3ng \u0111i\u1ec3m nguy\u00ean $(x;y)$ sao cho v\u1edbi $0 \\leq x &lt; n$ v\u00e0 $0 &lt; y \\leq \\lfloor k x+b\\rfloor$:</p> <pre><code>int count_lattices(Fraction k, Fraction b, long long n) {\n    auto fk = k.floor();\n    auto fb = b.floor();\n    auto cnt = 0LL;\n    if (k &gt;= 1 || b &gt;= 1) {\n        cnt += (fk * (n - 1) + 2 * fb) * n / 2;\n        k -= fk;\n        b -= fb;\n    }\n    auto t = k * n + b;\n    auto ft = t.floor();\n    if (ft &gt;= 1) {\n        cnt += count_lattices(1 / k, (t - t.floor()) / k, t.floor());\n    }\n    return cnt;\n}\n</code></pre> <p>\u1ede \u0111\u00e2y <code>Fraction</code> l\u00e0 m\u1ed9t l\u1edbp x\u1eed l\u00fd s\u1ed1 h\u1eefu t\u1ec9. Tr\u00ean th\u1ef1c t\u1ebf, c\u00f3 v\u1ebb nh\u01b0 n\u1ebfu t\u1ea5t c\u1ea3 c\u00e1c m\u1eabu s\u1ed1 v\u00e0 t\u1eed s\u1ed1 \u0111\u1ec1u t\u1ed1i \u0111a l\u00e0 $C$ theo gi\u00e1 tr\u1ecb tuy\u1ec7t \u0111\u1ed1i th\u00ec trong c\u00e1c l\u1ec7nh g\u1ecdi \u0111\u1ec7 quy, ch\u00fang s\u1ebd t\u1ed1i \u0111a l\u00e0 $C^2$ n\u1ebfu b\u1ea1n li\u00ean t\u1ee5c chia c\u1ea3 t\u1eed s\u1ed1 v\u00e0 m\u1eabu s\u1ed1 cho \u01b0\u1edbc chung l\u1edbn nh\u1ea5t c\u1ee7a ch\u00fang. V\u1edbi gi\u1ea3 \u0111\u1ecbnh n\u00e0y, ch\u00fang ta c\u00f3 th\u1ec3 n\u00f3i r\u1eb1ng ng\u01b0\u1eddi ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng ki\u1ec3u <code>double</code> v\u00e0 y\u00eau c\u1ea7u \u0111\u1ed9 ch\u00ednh x\u00e1c l\u00e0 $\\varepsilon^2$ trong \u0111\u00f3 $\\varepsilon$ l\u00e0 \u0111\u1ed9 ch\u00ednh x\u00e1c m\u00e0 $k$ v\u00e0 $b$ \u0111\u01b0\u1ee3c \u0111\u01b0a ra. \u0110i\u1ec1u \u0111\u00f3 c\u00f3 ngh\u0129a l\u00e0 trong h\u00e0m <code>floor</code> ng\u01b0\u1eddi ta n\u00ean coi c\u00e1c s\u1ed1 l\u00e0 s\u1ed1 nguy\u00ean n\u1ebfu ch\u00fang kh\u00e1c s\u1ed1 nguy\u00ean t\u1ed1i \u0111a m\u1ed9t l\u01b0\u1ee3ng $\\varepsilon^2$.</p>","tags":["Translated"]},{"location":"geometry/length-of-segments-union.html","title":"\u0110\u1ed9 d\u00e0i h\u1ee3p c\u1ee7a c\u00e1c \u0111o\u1ea1n th\u1eb3ng (Length of the union of segments)","text":"<p>Cho $n$ \u0111o\u1ea1n th\u1eb3ng tr\u00ean m\u1ed9t \u0111\u01b0\u1eddng th\u1eb3ng, m\u1ed7i \u0111o\u1ea1n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 b\u1edfi m\u1ed9t c\u1eb7p t\u1ecda \u0111\u1ed9 $(a_{i1}, a_{i2})$. Ch\u00fang ta ph\u1ea3i t\u00ecm \u0111\u1ed9 d\u00e0i h\u1ee3p c\u1ee7a ch\u00fang.</p> <p>Thu\u1eadt to\u00e1n sau \u0111\u00e2y \u0111\u01b0\u1ee3c \u0111\u1ec1 xu\u1ea5t b\u1edfi Klee v\u00e0o n\u0103m 1977. N\u00f3 ho\u1ea1t \u0111\u1ed9ng trong $O(n\\log n)$ v\u00e0 \u0111\u00e3 \u0111\u01b0\u1ee3c ch\u1ee9ng minh l\u00e0 t\u1ed1i \u01b0u ti\u1ec7m c\u1eadn.</p>","tags":["Translated"]},{"location":"geometry/length-of-segments-union.html#solution","title":"Gi\u1ea3i ph\u00e1p (Solution)","text":"<p>Ch\u00fang ta l\u01b0u tr\u1eef trong m\u1ed9t m\u1ea3ng $x$ c\u00e1c \u0111\u1ea7u m\u00fat c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c \u0111o\u1ea1n th\u1eb3ng \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp theo gi\u00e1 tr\u1ecb c\u1ee7a ch\u00fang. V\u00e0 th\u00eam v\u00e0o \u0111\u00f3, ch\u00fang ta l\u01b0u tr\u1eef xem \u0111\u00f3 l\u00e0 \u0111\u1ea7u tr\u00e1i hay \u0111\u1ea7u ph\u1ea3i c\u1ee7a m\u1ed9t \u0111o\u1ea1n th\u1eb3ng. B\u00e2y gi\u1edd ch\u00fang ta l\u1eb7p qua m\u1ea3ng, gi\u1eef m\u1ed9t b\u1ed9 \u0111\u1ebfm $c$ c\u00e1c \u0111o\u1ea1n th\u1eb3ng hi\u1ec7n \u0111ang m\u1edf. B\u1ea5t c\u1ee9 khi n\u00e0o ph\u1ea7n t\u1eed hi\u1ec7n t\u1ea1i l\u00e0 m\u1ed9t \u0111\u1ea7u tr\u00e1i, ch\u00fang ta t\u0103ng b\u1ed9 \u0111\u1ebfm n\u00e0y, v\u00e0 ng\u01b0\u1ee3c l\u1ea1i ch\u00fang ta gi\u1ea3m n\u00f3. \u0110\u1ec3 t\u00ednh to\u00e1n c\u00e2u tr\u1ea3 l\u1eddi, ch\u00fang ta l\u1ea5y \u0111\u1ed9 d\u00e0i gi\u1eefa hai gi\u00e1 tr\u1ecb $x$ cu\u1ed1i c\u00f9ng $x_i - x_{i-1}$, b\u1ea5t c\u1ee9 khi n\u00e0o ch\u00fang ta \u0111\u1ebfn m\u1ed9t t\u1ecda \u0111\u1ed9 m\u1edbi, v\u00e0 hi\u1ec7n t\u1ea1i c\u00f3 \u00edt nh\u1ea5t m\u1ed9t \u0111o\u1ea1n th\u1eb3ng \u0111ang m\u1edf.</p>","tags":["Translated"]},{"location":"geometry/length-of-segments-union.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<pre><code>int length_union(const vector&lt;pair&lt;int, int&gt;&gt; &amp;a) {\n    int n = a.size();\n    vector&lt;pair&lt;int, bool&gt;&gt; x(n*2);\n    for (int i = 0; i &lt; n; i++) {\n        x[i*2] = {a[i].first, false};\n        x[i*2+1] = {a[i].second, true};\n    }\n\n    sort(x.begin(), x.end());\n\n    int result = 0;\n    int c = 0;\n    for (int i = 0; i &lt; n * 2; i++) {\n        if (i &gt; 0 &amp;&amp; x[i].first &gt; x[i-1].first &amp;&amp; c &gt; 0)\n            result += x[i].first - x[i-1].first;\n        if (x[i].second)\n            c--;\n        else\n            c++;\n    }\n    return result;\n}\n</code></pre>","tags":["Translated"]},{"location":"geometry/lines-intersection.html","title":"Giao \u0111i\u1ec3m c\u1ee7a c\u00e1c \u0111\u01b0\u1eddng th\u1eb3ng (Intersection Point of Lines)","text":"<p>B\u1ea1n \u0111\u01b0\u1ee3c cho hai \u0111\u01b0\u1eddng th\u1eb3ng, \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 th\u00f4ng qua c\u00e1c ph\u01b0\u01a1ng tr\u00ecnh $a_1 x + b_1 y + c_1 = 0$ v\u00e0  $a_2 x + b_2 y + c_2 = 0$. Ch\u00fang ta ph\u1ea3i t\u00ecm giao \u0111i\u1ec3m c\u1ee7a c\u00e1c \u0111\u01b0\u1eddng th\u1eb3ng, ho\u1eb7c x\u00e1c \u0111\u1ecbnh r\u1eb1ng c\u00e1c \u0111\u01b0\u1eddng th\u1eb3ng song song.</p>","tags":["Translated"]},{"location":"geometry/lines-intersection.html#solution","title":"Gi\u1ea3i ph\u00e1p (Solution)","text":"<p>N\u1ebfu hai \u0111\u01b0\u1eddng th\u1eb3ng kh\u00f4ng song song, ch\u00fang s\u1ebd c\u1eaft nhau. \u0110\u1ec3 t\u00ecm giao \u0111i\u1ec3m c\u1ee7a ch\u00fang, ch\u00fang ta c\u1ea7n gi\u1ea3i h\u1ec7 ph\u01b0\u01a1ng tr\u00ecnh tuy\u1ebfn t\u00ednh sau:</p> $$\\begin{cases} a_1 x + b_1 y + c_1 = 0 \\\\ a_2 x + b_2 y + c_2 = 0 \\end{cases}$$ <p>S\u1eed d\u1ee5ng quy t\u1eafc Cramer, ch\u00fang ta c\u00f3 th\u1ec3 vi\u1ebft ngay nghi\u1ec7m cho h\u1ec7 ph\u01b0\u01a1ng tr\u00ecnh, \u0111i\u1ec1u n\u00e0y s\u1ebd cho ch\u00fang ta giao \u0111i\u1ec3m c\u1ea7n t\u00ecm c\u1ee7a c\u00e1c \u0111\u01b0\u1eddng th\u1eb3ng:</p> $$x = - \\frac{\\begin{vmatrix}c_1 &amp; b_1 \\cr c_2 &amp; b_2\\end{vmatrix}}{\\begin{vmatrix}a_1 &amp; b_1 \\cr a_2 &amp; b_2\\end{vmatrix} } = - \\frac{c_1 b_2 - c_2 b_1}{a_1 b_2 - a_2 b_1},$$ $$y = - \\frac{\\begin{vmatrix}a_1 &amp; c_1 \\cr a_2 &amp; c_2\\end{vmatrix}}{\\begin{vmatrix}a_1 &amp; b_1 \\cr a_2 &amp; b_2\\end{vmatrix}} = - \\frac{a_1 c_2 - a_2 c_1}{a_1 b_2 - a_2 b_1}.$$ <p>N\u1ebfu m\u1eabu s\u1ed1 b\u1eb1ng $0$, t\u1ee9c l\u00e0</p> $$\\begin{vmatrix}a_1 &amp; b_1 \\cr a_2 &amp; b_2\\end{vmatrix} = a_1 b_2 - a_2 b_1 = 0 $$ <p>th\u00ec h\u1ec7 ph\u01b0\u01a1ng tr\u00ecnh ho\u1eb7c kh\u00f4ng c\u00f3 nghi\u1ec7m (c\u00e1c \u0111\u01b0\u1eddng th\u1eb3ng song song v\u00e0 ph\u00e2n bi\u1ec7t) ho\u1eb7c c\u00f3 v\u00f4 s\u1ed1 nghi\u1ec7m (c\u00e1c \u0111\u01b0\u1eddng th\u1eb3ng tr\u00f9ng nhau). N\u1ebfu ch\u00fang ta c\u1ea7n ph\u00e2n bi\u1ec7t hai tr\u01b0\u1eddng h\u1ee3p n\u00e0y, ch\u00fang ta ph\u1ea3i ki\u1ec3m tra xem c\u00e1c h\u1ec7 s\u1ed1 $c$ c\u00f3 t\u1ef7 l\u1ec7 v\u1edbi c\u00f9ng m\u1ed9t t\u1ef7 l\u1ec7 nh\u01b0 c\u00e1c h\u1ec7 s\u1ed1 $a$ v\u00e0 $b$ hay kh\u00f4ng. \u0110\u1ec3 l\u00e0m \u0111i\u1ec1u \u0111\u00f3, ch\u00fang ta ch\u1ec9 c\u1ea7n t\u00ednh c\u00e1c \u0111\u1ecbnh th\u1ee9c sau, v\u00e0 n\u1ebfu c\u1ea3 hai \u0111\u1ec1u b\u1eb1ng $0$, c\u00e1c \u0111\u01b0\u1eddng th\u1eb3ng tr\u00f9ng nhau:</p> $$\\begin{vmatrix}a_1 &amp; c_1 \\cr a_2 &amp; c_2\\end{vmatrix}, \\begin{vmatrix}b_1 &amp; c_1 \\cr b_2 &amp; c_2\\end{vmatrix} $$ <p>L\u01b0u \u00fd, m\u1ed9t c\u00e1ch ti\u1ebfp c\u1eadn kh\u00e1c \u0111\u1ec3 t\u00ednh to\u00e1n giao \u0111i\u1ec3m \u0111\u01b0\u1ee3c gi\u1ea3i th\u00edch trong b\u00e0i vi\u1ebft H\u00ecnh h\u1ecdc c\u01a1 b\u1ea3n.</p>","tags":["Translated"]},{"location":"geometry/lines-intersection.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<pre><code>struct pt {\n    double x, y;\n};\n\nstruct line {\n    double a, b, c;\n};\n\nconst double EPS = 1e-9;\n\ndouble det(double a, double b, double c, double d) {\n    return a*d - b*c;\n}\n\nbool intersect(line m, line n, pt &amp; res) {\n    double zn = det(m.a, m.b, n.a, n.b);\n    if (abs(zn) &lt; EPS)\n        return false;\n    res.x = -det(m.c, m.b, n.c, n.b) / zn;\n    res.y = -det(m.a, m.c, n.a, n.c) / zn;\n    return true;\n}\n\nbool parallel(line m, line n) {\n    return abs(det(m.a, m.b, n.a, n.b)) &lt; EPS;\n}\n\nbool equivalent(line m, line n) {\n    return abs(det(m.a, m.b, n.a, n.b)) &lt; EPS\n        &amp;&amp; abs(det(m.a, m.c, n.a, n.c)) &lt; EPS\n        &amp;&amp; abs(det(m.b, m.c, n.b, n.c)) &lt; EPS;\n}\n</code></pre>","tags":["Translated"]},{"location":"geometry/manhattan-distance.html","title":"Kho\u1ea3ng c\u00e1ch Manhattan (Manhattan Distance)","text":"","tags":["Translated"]},{"location":"geometry/manhattan-distance.html#definition","title":"\u0110\u1ecbnh ngh\u0129a (Definition)","text":"<p>\u0110\u1ed1i v\u1edbi c\u00e1c \u0111i\u1ec3m $p$ v\u00e0 $q$ tr\u00ean m\u1ed9t m\u1eb7t ph\u1eb3ng, ch\u00fang ta c\u00f3 th\u1ec3 \u0111\u1ecbnh ngh\u0129a kho\u1ea3ng c\u00e1ch gi\u1eefa ch\u00fang l\u00e0 t\u1ed5ng c\u00e1c hi\u1ec7u tuy\u1ec7t \u0111\u1ed1i gi\u1eefa c\u00e1c t\u1ecda \u0111\u1ed9 $x$ v\u00e0 $y$ c\u1ee7a ch\u00fang:</p> $$d(p,q) = |x_p - x_q| + |y_p - y_q|$$ <p>\u0110\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a theo c\u00e1ch n\u00e0y, kho\u1ea3ng c\u00e1ch t\u01b0\u01a1ng \u1ee9ng v\u1edbi c\u00e1i g\u1ecdi l\u00e0 H\u00ecnh h\u1ecdc Manhattan (taxicab), trong \u0111\u00f3 c\u00e1c \u0111i\u1ec3m \u0111\u01b0\u1ee3c coi l\u00e0 c\u00e1c giao l\u1ed9 trong m\u1ed9t th\u00e0nh ph\u1ed1 \u0111\u01b0\u1ee3c thi\u1ebft k\u1ebf t\u1ed1t, nh\u01b0 Manhattan, n\u01a1i b\u1ea1n ch\u1ec9 c\u00f3 th\u1ec3 di chuy\u1ec3n tr\u00ean c\u00e1c \u0111\u01b0\u1eddng ph\u1ed1 theo chi\u1ec1u ngang ho\u1eb7c chi\u1ec1u d\u1ecdc, nh\u01b0 trong h\u00ecnh \u1ea3nh d\u01b0\u1edbi \u0111\u00e2y:</p> <p>H\u00ecnh \u1ea3nh n\u00e0y hi\u1ec3n th\u1ecb m\u1ed9t s\u1ed1 \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t t\u1eeb m\u1ed9t \u0111i\u1ec3m \u0111en \u0111\u1ebfn \u0111i\u1ec3m kia, t\u1ea5t c\u1ea3 ch\u00fang \u0111\u1ec1u c\u00f3 \u0111\u1ed9 d\u00e0i $12$.</p> <p>C\u00f3 m\u1ed9t s\u1ed1 th\u1ee7 thu\u1eadt v\u00e0 thu\u1eadt to\u00e1n th\u00fa v\u1ecb c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n v\u1edbi kho\u1ea3ng c\u00e1ch n\u00e0y, v\u00e0 ch\u00fang t\u00f4i s\u1ebd hi\u1ec3n th\u1ecb m\u1ed9t s\u1ed1 trong s\u1ed1 ch\u00fang \u1edf \u0111\u00e2y.</p>","tags":["Translated"]},{"location":"geometry/manhattan-distance.html#farthest-pair-of-points-in-manhattan-distance","title":"C\u1eb7p \u0111i\u1ec3m xa nh\u1ea5t trong kho\u1ea3ng c\u00e1ch Manhattan (Farthest pair of points in Manhattan distance)","text":"<p>Cho $n$ \u0111i\u1ec3m $P$, ch\u00fang ta mu\u1ed1n t\u00ecm c\u1eb7p \u0111i\u1ec3m $p,q$ c\u00e1ch xa nhau nh\u1ea5t, ngh\u0129a l\u00e0 t\u1ed1i \u0111a h\u00f3a $|x_p - x_q| + |y_p - y_q|$.</p> <p>Tr\u01b0\u1edbc ti\u00ean h\u00e3y suy ngh\u0129 trong m\u1ed9t chi\u1ec1u, \u0111\u1ec3 $y=0$. Quan s\u00e1t ch\u00ednh l\u00e0 ch\u00fang ta c\u00f3 th\u1ec3 v\u00e9t c\u1ea1n xem $|x_p - x_q|$ b\u1eb1ng $x_p - x_q$ hay $-x_p + x_q$, b\u1edfi v\u00ec n\u1ebfu ch\u00fang ta \"nh\u1ea7m d\u1ea5u\" c\u1ee7a gi\u00e1 tr\u1ecb tuy\u1ec7t \u0111\u1ed1i, ch\u00fang ta s\u1ebd ch\u1ec9 nh\u1eadn \u0111\u01b0\u1ee3c gi\u00e1 tr\u1ecb nh\u1ecf h\u01a1n, v\u00ec v\u1eady n\u00f3 kh\u00f4ng th\u1ec3 \u1ea3nh h\u01b0\u1edfng \u0111\u1ebfn c\u00e2u tr\u1ea3 l\u1eddi. M\u1ed9t c\u00e1ch ch\u00ednh th\u1ee9c h\u01a1n, \u0111i\u1ec1u sau \u0111\u00e2y \u0111\u00fang:</p> $$|x_p - x_q| = \\max(x_p - x_q, -x_p + x_q)$$ <p>V\u00ec v\u1eady, v\u00ed d\u1ee5, ch\u00fang ta c\u00f3 th\u1ec3 c\u1ed1 g\u1eafng c\u00f3 $p$ sao cho $x_p$ c\u00f3 d\u1ea5u c\u1ed9ng, v\u00e0 sau \u0111\u00f3 $q$ ph\u1ea3i c\u00f3 d\u1ea5u tr\u1eeb. B\u1eb1ng c\u00e1ch n\u00e0y, ch\u00fang ta mu\u1ed1n t\u00ecm:</p> $$\\max\\limits_{p, q \\in P}(x_p + (-x_q)) = \\max\\limits_{p \\in P}(x_p) + \\max\\limits_{q \\in P}( - x_q ).$$ <p>L\u01b0u \u00fd r\u1eb1ng ch\u00fang ta c\u00f3 th\u1ec3 m\u1edf r\u1ed9ng \u00fd t\u01b0\u1edfng n\u00e0y th\u00eam cho 2 (ho\u1eb7c nhi\u1ec1u h\u01a1n!) chi\u1ec1u. \u0110\u1ed1i v\u1edbi $d$ chi\u1ec1u, ch\u00fang ta ph\u1ea3i v\u00e9t c\u1ea1n $2^d$ gi\u00e1 tr\u1ecb c\u00f3 th\u1ec3 c\u1ee7a c\u00e1c d\u1ea5u. V\u00ed d\u1ee5, n\u1ebfu ch\u00fang ta \u1edf trong $2$ chi\u1ec1u v\u00e0 v\u00e9t c\u1ea1n r\u1eb1ng $p$ c\u00f3 c\u1ea3 hai d\u1ea5u c\u1ed9ng, ch\u00fang ta mu\u1ed1n t\u00ecm:</p> $$\\max\\limits_{p, q \\in P} [(x_p + (-x_q)) + (y_p + (-y_q))] = \\max\\limits_{p \\in P}(x_p + y_p) + \\max\\limits_{q \\in P}(-x_q - y_q).$$ <p>V\u00ec ch\u00fang ta \u0111\u00e3 l\u00e0m cho $p$ v\u00e0 $q$ \u0111\u1ed9c l\u1eadp, b\u00e2y gi\u1edd th\u1eadt d\u1ec5 d\u00e0ng \u0111\u1ec3 t\u00ecm $p$ v\u00e0 $q$ t\u1ed1i \u0111a h\u00f3a bi\u1ec3u th\u1ee9c.</p> <p>M\u00e3 d\u01b0\u1edbi \u0111\u00e2y t\u1ed5ng qu\u00e1t h\u00f3a \u0111i\u1ec1u n\u00e0y cho $d$ chi\u1ec1u v\u00e0 ch\u1ea1y trong $O(n \\cdot 2^d \\cdot d)$.</p> <pre><code>long long ans = 0;\nfor (int msk = 0; msk &lt; (1 &lt;&lt; d); msk++) {\n    long long mx = LLONG_MIN, mn = LLONG_MAX;\n    for (int i = 0; i &lt; n; i++) {\n        long long cur = 0;\n        for (int j = 0; j &lt; d; j++) {\n            if (msk &amp; (1 &lt;&lt; j)) cur += p[i][j];\n            else cur -= p[i][j];\n        }\n        mx = max(mx, cur);\n        mn = min(mn, cur);\n    }\n    ans = max(ans, mx - mn);\n}\n</code></pre>","tags":["Translated"]},{"location":"geometry/manhattan-distance.html#rotating-the-points-and-chebyshev-distance","title":"Xoay c\u00e1c \u0111i\u1ec3m v\u00e0 kho\u1ea3ng c\u00e1ch Chebyshev (Rotating the points and Chebyshev distance)","text":"<p>\u0110\u00e3 bi\u1ebft r\u1eb1ng, \u0111\u1ed1i v\u1edbi m\u1ecdi $m, n \\in \\mathbb{R}$,</p> $$|m| + |n| = \\text{max}(|m + n|, |m - n|).$$ <p>\u0110\u1ec3 ch\u1ee9ng minh \u0111i\u1ec1u n\u00e0y, ch\u00fang ta ch\u1ec9 c\u1ea7n ph\u00e2n t\u00edch d\u1ea5u c\u1ee7a $m$ v\u00e0 $n$. V\u00e0 n\u00f3 \u0111\u01b0\u1ee3c \u0111\u1ec3 l\u1ea1i nh\u01b0 m\u1ed9t b\u00e0i t\u1eadp.</p> <p>Ch\u00fang ta c\u00f3 th\u1ec3 \u00e1p d\u1ee5ng ph\u01b0\u01a1ng tr\u00ecnh n\u00e0y cho c\u00f4ng th\u1ee9c kho\u1ea3ng c\u00e1ch Manhattan \u0111\u1ec3 t\u00ecm ra r\u1eb1ng</p> $$d((x_1, y_1), (x_2, y_2)) = |x_1 - x_2| + |y_1 - y_2| = \\text{max}(|(x_1 + y_1) - (x_2 + y_2)|, |(y_1 - x_1) - (y_2 - x_2)|).$$ <p>Bi\u1ec3u th\u1ee9c cu\u1ed1i c\u00f9ng trong ph\u01b0\u01a1ng tr\u00ecnh tr\u01b0\u1edbc l\u00e0 kho\u1ea3ng c\u00e1ch Chebyshev c\u1ee7a c\u00e1c \u0111i\u1ec3m $(x_1 + y_1, y_1 - x_1)$ v\u00e0 $(x_2 + y_2, y_2 - x_2)$. \u0110i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0, sau khi \u00e1p d\u1ee5ng ph\u00e9p bi\u1ebfn \u0111\u1ed5i</p> $$\\alpha : (x, y) \\to (x + y, y - x),$$ <p>kho\u1ea3ng c\u00e1ch Manhattan gi\u1eefa c\u00e1c \u0111i\u1ec3m $p$ v\u00e0 $q$ bi\u1ebfn th\u00e0nh kho\u1ea3ng c\u00e1ch Chebyshev gi\u1eefa $\\alpha(p)$ v\u00e0 $\\alpha(q)$.</p> <p>Ngo\u00e0i ra, ch\u00fang ta c\u00f3 th\u1ec3 nh\u1eadn ra r\u1eb1ng $\\alpha$ l\u00e0 m\u1ed9t \u0111\u1ed3ng d\u1ea1ng xo\u1eafn \u1ed1c (spiral similarity) (ph\u00e9p quay m\u1eb7t ph\u1eb3ng theo sau b\u1edfi ph\u00e9p co gi\u00e3n quanh t\u00e2m $O$) v\u1edbi t\u00e2m $(0, 0)$, g\u00f3c quay $45^{\\circ}$ theo chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3 v\u00e0 ph\u00e9p co gi\u00e3n b\u1edfi $\\sqrt{2}$.</p> <p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u1ed9t h\u00ecnh \u1ea3nh \u0111\u1ec3 gi\u00fap h\u00ecnh dung ph\u00e9p bi\u1ebfn \u0111\u1ed5i:</p>","tags":["Translated"]},{"location":"geometry/manhattan-distance.html#manhattan-minimum-spanning-tree","title":"C\u00e2y khung nh\u1ecf nh\u1ea5t Manhattan (Manhattan Minimum Spanning Tree)","text":"<p>B\u00e0i to\u00e1n MST Manhattan bao g\u1ed3m, cho m\u1ed9t s\u1ed1 \u0111i\u1ec3m trong m\u1eb7t ph\u1eb3ng, t\u00ecm c\u00e1c c\u1ea1nh k\u1ebft n\u1ed1i t\u1ea5t c\u1ea3 c\u00e1c \u0111i\u1ec3m v\u00e0 c\u00f3 t\u1ed5ng tr\u1ecdng s\u1ed1 t\u1ed1i thi\u1ec3u. Tr\u1ecdng s\u1ed1 c\u1ee7a m\u1ed9t c\u1ea1nh n\u1ed1i hai \u0111i\u1ec3m l\u00e0 kho\u1ea3ng c\u00e1ch Manhattan c\u1ee7a ch\u00fang. \u0110\u1ec3 \u0111\u01a1n gi\u1ea3n, ch\u00fang ta gi\u1ea3 s\u1eed r\u1eb1ng t\u1ea5t c\u1ea3 c\u00e1c \u0111i\u1ec3m c\u00f3 v\u1ecb tr\u00ed kh\u00e1c nhau. \u1ede \u0111\u00e2y ch\u00fang t\u00f4i ch\u1ec9 ra m\u1ed9t c\u00e1ch t\u00ecm MST trong $O(n \\log{n})$ b\u1eb1ng c\u00e1ch t\u00ecm cho m\u1ed7i \u0111i\u1ec3m ng\u01b0\u1eddi h\u00e0ng x\u00f3m g\u1ea7n nh\u1ea5t c\u1ee7a n\u00f3 trong m\u1ed7i g\u00f3c m\u1ed9t ph\u1ea7n t\u00e1m (octant), \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n b\u1edfi h\u00ecnh \u1ea3nh b\u00ean d\u01b0\u1edbi. \u0110i\u1ec1u n\u00e0y s\u1ebd cho ch\u00fang ta $O(n)$ c\u1ea1nh \u1ee9ng vi\u00ean, m\u00e0 nh\u01b0 ch\u00fang t\u00f4i ch\u1ec9 ra b\u00ean d\u01b0\u1edbi, s\u1ebd \u0111\u1ea3m b\u1ea3o r\u1eb1ng ch\u00fang ch\u1ee9a MST. B\u01b0\u1edbc cu\u1ed1i c\u00f9ng sau \u0111\u00f3 l\u00e0 s\u1eed d\u1ee5ng m\u1ed9t thu\u1eadt to\u00e1n MST ti\u00eau chu\u1ea9n n\u00e0o \u0111\u00f3, v\u00ed d\u1ee5, thu\u1eadt to\u00e1n Kruskal s\u1eed d\u1ee5ng Disjoint Set Union.</p>    *8 octant so v\u1edbi \u0111i\u1ec3m S*  <p>Thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c tr\u00ecnh b\u00e0y \u1edf \u0111\u00e2y l\u1ea7n \u0111\u1ea7u ti\u00ean \u0111\u01b0\u1ee3c tr\u00ecnh b\u00e0y trong m\u1ed9t b\u00e0i b\u00e1o t\u1eeb H. Zhou, N. Shenoy, v\u00e0 W. Nichollos (2002). C\u0169ng c\u00f3 m\u1ed9t thu\u1eadt to\u00e1n kh\u00e1c \u0111\u01b0\u1ee3c bi\u1ebft \u0111\u1ebfn s\u1eed d\u1ee5ng c\u00e1ch ti\u1ebfp c\u1eadn Chia \u0111\u1ec3 tr\u1ecb b\u1edfi J. Stolfi, c\u0169ng r\u1ea5t th\u00fa v\u1ecb v\u00e0 ch\u1ec9 kh\u00e1c nhau \u1edf c\u00e1ch ch\u00fang t\u00ecm ng\u01b0\u1eddi h\u00e0ng x\u00f3m g\u1ea7n nh\u1ea5t trong m\u1ed7i octant. C\u1ea3 hai \u0111\u1ec1u c\u00f3 c\u00f9ng \u0111\u1ed9 ph\u1ee9c t\u1ea1p, nh\u01b0ng c\u00e1i \u0111\u01b0\u1ee3c tr\u00ecnh b\u00e0y \u1edf \u0111\u00e2y d\u1ec5 c\u00e0i \u0111\u1eb7t h\u01a1n v\u00e0 c\u00f3 h\u1eb1ng s\u1ed1 nh\u1ecf h\u01a1n.</p> <p>\u0110\u1ea7u ti\u00ean, h\u00e3y hi\u1ec3u t\u1ea1i sao ch\u1ec9 c\u1ea7n xem x\u00e9t ng\u01b0\u1eddi h\u00e0ng x\u00f3m g\u1ea7n nh\u1ea5t trong m\u1ed7i octant l\u00e0 \u0111\u1ee7. \u00dd t\u01b0\u1edfng l\u00e0 ch\u1ec9 ra r\u1eb1ng \u0111\u1ed1i v\u1edbi m\u1ed9t \u0111i\u1ec3m $s$ v\u00e0 b\u1ea5t k\u1ef3 hai \u0111i\u1ec3m n\u00e0o kh\u00e1c $p$ v\u00e0 $q$ trong c\u00f9ng m\u1ed9t octant, $d(p, q) &lt; \\max(d(s, p), d(s, q))$. \u0110i\u1ec1u n\u00e0y r\u1ea5t quan tr\u1ecdng, v\u00ec n\u00f3 cho th\u1ea5y r\u1eb1ng n\u1ebfu c\u00f3 m\u1ed9t MST trong \u0111\u00f3 $s$ \u0111\u01b0\u1ee3c k\u1ebft n\u1ed1i v\u1edbi c\u1ea3 $p$ v\u00e0 $q$, ch\u00fang ta c\u00f3 th\u1ec3 x\u00f3a m\u1ed9t trong nh\u1eefng c\u1ea1nh n\u00e0y v\u00e0 th\u00eam c\u1ea1nh $(p,q)$, \u0111i\u1ec1u n\u00e0y s\u1ebd l\u00e0m gi\u1ea3m t\u1ed5ng chi ph\u00ed. \u0110\u1ec3 ch\u1ee9ng minh \u0111i\u1ec1u n\u00e0y, ch\u00fang ta gi\u1ea3 s\u1eed kh\u00f4ng m\u1ea5t t\u00ednh t\u1ed5ng qu\u00e1t r\u1eb1ng $p$ v\u00e0 $q$ n\u1eb1m trong octant $R_1$, \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a b\u1edfi: $x_s \\leq x$ v\u00e0 $x_s - y_s &gt; x - y$, v\u00e0 sau \u0111\u00f3 th\u1ef1c hi\u1ec7n m\u1ed9t s\u1ed1 tr\u01b0\u1eddng h\u1ee3p. H\u00ecnh \u1ea3nh d\u01b0\u1edbi \u0111\u00e2y \u0111\u01b0a ra m\u1ed9t s\u1ed1 tr\u1ef1c gi\u00e1c v\u1ec1 l\u00fd do t\u1ea1i sao \u0111i\u1ec1u n\u00e0y \u0111\u00fang.</p>    *V\u1ec1 m\u1eb7t tr\u1ef1c gi\u00e1c, gi\u1edbi h\u1ea1n c\u1ee7a octant l\u00e0m cho kh\u00f4ng th\u1ec3 c\u00f3 chuy\u1ec7n $p$ v\u00e0 $q$ \u0111\u1ec1u g\u1ea7n $s$ h\u01a1n l\u00e0 g\u1ea7n nhau*  <p>Do \u0111\u00f3, c\u00e2u h\u1ecfi ch\u00ednh l\u00e0 l\u00e0m th\u1ebf n\u00e0o \u0111\u1ec3 t\u00ecm ng\u01b0\u1eddi h\u00e0ng x\u00f3m g\u1ea7n nh\u1ea5t trong m\u1ed7i octant cho m\u1ed7i \u0111i\u1ec3m trong s\u1ed1 $n$ \u0111i\u1ec3m.</p>","tags":["Translated"]},{"location":"geometry/manhattan-distance.html#nearest-neighbor-in-each-octant-in-on-log-n","title":"Ng\u01b0\u1eddi h\u00e0ng x\u00f3m g\u1ea7n nh\u1ea5t trong m\u1ed7i Octant trong O(n log n) (Nearest Neighbor in each Octant in O(n log n))","text":"<p>\u0110\u1ec3 \u0111\u01a1n gi\u1ea3n, ch\u00fang t\u00f4i t\u1eadp trung v\u00e0o octant NNE (B\u1eafc-\u0110\u00f4ng B\u1eafc) ($R_1$ trong h\u00ecnh tr\u00ean). T\u1ea5t c\u1ea3 c\u00e1c h\u01b0\u1edbng kh\u00e1c c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y b\u1eb1ng c\u00f9ng m\u1ed9t thu\u1eadt to\u00e1n b\u1eb1ng c\u00e1ch quay \u0111\u1ea7u v\u00e0o.</p> <p>Ch\u00fang t\u00f4i s\u1ebd s\u1eed d\u1ee5ng ph\u01b0\u01a1ng ph\u00e1p qu\u00e9t \u0111\u01b0\u1eddng (sweep-line). Ch\u00fang t\u00f4i x\u1eed l\u00fd c\u00e1c \u0111i\u1ec3m t\u1eeb t\u00e2y-nam \u0111\u1ebfn \u0111\u00f4ng-b\u1eafc, t\u1ee9c l\u00e0, theo th\u1ee9 t\u1ef1 $x + y$ kh\u00f4ng gi\u1ea3m. Ch\u00fang t\u00f4i c\u0169ng gi\u1eef m\u1ed9t t\u1eadp h\u1ee3p c\u00e1c \u0111i\u1ec3m ch\u01b0a c\u00f3 ng\u01b0\u1eddi h\u00e0ng x\u00f3m g\u1ea7n nh\u1ea5t c\u1ee7a ch\u00fang, m\u00e0 ch\u00fang t\u00f4i g\u1ecdi l\u00e0 \"t\u1eadp h\u1ee3p ho\u1ea1t \u0111\u1ed9ng\". Ch\u00fang t\u00f4i th\u00eam c\u00e1c h\u00ecnh \u1ea3nh d\u01b0\u1edbi \u0111\u00e2y \u0111\u1ec3 gi\u00fap h\u00ecnh dung thu\u1eadt to\u00e1n.</p>    *M\u00e0u \u0111en c\u00f3 m\u0169i t\u00ean b\u1ea1n c\u00f3 th\u1ec3 th\u1ea5y h\u01b0\u1edbng c\u1ee7a vi\u1ec7c qu\u00e9t \u0111\u01b0\u1eddng. T\u1ea5t c\u1ea3 c\u00e1c \u0111i\u1ec3m b\u00ean d\u01b0\u1edbi \u0111\u01b0\u1eddng n\u00e0y n\u1eb1m trong t\u1eadp h\u1ee3p ho\u1ea1t \u0111\u1ed9ng, v\u00e0 c\u00e1c \u0111i\u1ec3m b\u00ean tr\u00ean v\u1eabn ch\u01b0a \u0111\u01b0\u1ee3c x\u1eed l\u00fd. M\u00e0u xanh l\u00e1 c\u00e2y ch\u00fang ta th\u1ea5y c\u00e1c \u0111i\u1ec3m n\u1eb1m trong octant c\u1ee7a \u0111i\u1ec3m \u0111\u01b0\u1ee3c x\u1eed l\u00fd. M\u00e0u \u0111\u1ecf l\u00e0 c\u00e1c \u0111i\u1ec3m kh\u00f4ng n\u1eb1m trong octant \u0111\u01b0\u1ee3c t\u00ecm ki\u1ebfm.*     *Trong h\u00ecnh \u1ea3nh n\u00e0y, ch\u00fang ta th\u1ea5y t\u1eadp h\u1ee3p ho\u1ea1t \u0111\u1ed9ng sau khi x\u1eed l\u00fd \u0111i\u1ec3m $p$. L\u01b0u \u00fd r\u1eb1ng $2$ \u0111i\u1ec3m m\u00e0u xanh l\u00e1 c\u00e2y c\u1ee7a h\u00ecnh \u1ea3nh tr\u01b0\u1edbc \u0111\u00f3 c\u00f3 $p$ \u1edf octant b\u1eafc-\u0111\u00f4ng-b\u1eafc c\u1ee7a n\u00f3 v\u00e0 kh\u00f4ng c\u00f2n trong t\u1eadp h\u1ee3p ho\u1ea1t \u0111\u1ed9ng n\u1eefa, b\u1edfi v\u00ec ch\u00fang \u0111\u00e3 t\u00ecm th\u1ea5y ng\u01b0\u1eddi h\u00e0ng x\u00f3m g\u1ea7n nh\u1ea5t c\u1ee7a ch\u00fang.*  <p>Khi ch\u00fang ta th\u00eam m\u1ed9t \u0111i\u1ec3m m\u1edbi $p$, \u0111\u1ed1i v\u1edbi m\u1ecdi \u0111i\u1ec3m $s$ c\u00f3 n\u00f3 trong octant c\u1ee7a n\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 g\u00e1n $p$ l\u00e0m ng\u01b0\u1eddi h\u00e0ng x\u00f3m g\u1ea7n nh\u1ea5t m\u1ed9t c\u00e1ch an to\u00e0n. \u0110i\u1ec1u n\u00e0y \u0111\u00fang v\u00ec kho\u1ea3ng c\u00e1ch c\u1ee7a ch\u00fang l\u00e0 $d(p,s) = |x_p - x_s| + |y_p - y_s| = (x_p + y_p) - (x_s + y_s)$, b\u1edfi v\u00ec $p$ n\u1eb1m trong octant b\u1eafc-\u0111\u00f4ng-b\u1eafc. V\u00ec t\u1ea5t c\u1ea3 c\u00e1c \u0111i\u1ec3m ti\u1ebfp theo s\u1ebd kh\u00f4ng c\u00f3 gi\u00e1 tr\u1ecb $x + y$ nh\u1ecf h\u01a1n do b\u01b0\u1edbc s\u1eafp x\u1ebfp, $p$ \u0111\u01b0\u1ee3c \u0111\u1ea3m b\u1ea3o c\u00f3 kho\u1ea3ng c\u00e1ch nh\u1ecf h\u01a1n. Sau \u0111\u00f3 ch\u00fang ta c\u00f3 th\u1ec3 x\u00f3a t\u1ea5t c\u1ea3 c\u00e1c \u0111i\u1ec3m nh\u01b0 v\u1eady kh\u1ecfi t\u1eadp h\u1ee3p ho\u1ea1t \u0111\u1ed9ng, v\u00e0 cu\u1ed1i c\u00f9ng th\u00eam $p$ v\u00e0o t\u1eadp h\u1ee3p ho\u1ea1t \u0111\u1ed9ng.</p> <p>C\u00e2u h\u1ecfi ti\u1ebfp theo l\u00e0 l\u00e0m th\u1ebf n\u00e0o \u0111\u1ec3 t\u00ecm m\u1ed9t c\u00e1ch hi\u1ec7u qu\u1ea3 nh\u1eefng \u0111i\u1ec3m $s$ c\u00f3 $p$ trong octant b\u1eafc-\u0111\u00f4ng-b\u1eafc. Ngh\u0129a l\u00e0, nh\u1eefng \u0111i\u1ec3m $s$ n\u00e0o th\u1ecfa m\u00e3n:</p> <ul> <li>$x_s \\leq x_p$</li> <li>$x_p - y_p &lt; x_s - y_s$</li> </ul> <p>V\u00ec kh\u00f4ng c\u00f3 \u0111i\u1ec3m n\u00e0o trong t\u1eadp h\u1ee3p ho\u1ea1t \u0111\u1ed9ng n\u1eb1m trong v\u00f9ng $R_1$ c\u1ee7a \u0111i\u1ec3m kh\u00e1c, ch\u00fang ta c\u0169ng c\u00f3 r\u1eb1ng \u0111\u1ed1i v\u1edbi hai \u0111i\u1ec3m $q_1$ v\u00e0 $q_2$ trong t\u1eadp h\u1ee3p ho\u1ea1t \u0111\u1ed9ng, $x_{q_1} \\neq x_{q_2}$ v\u00e0 th\u1ee9 t\u1ef1 c\u1ee7a ch\u00fang ng\u1ee5 \u00fd $x_{q_1} &lt; x_{q_2} \\implies x_{q_1} - y_{q_1} \\leq x_{q_2} - y_{q_2}$.</p> <p>B\u1ea1n c\u00f3 th\u1ec3 c\u1ed1 g\u1eafng h\u00ecnh dung \u0111i\u1ec1u n\u00e0y tr\u00ean c\u00e1c h\u00ecnh \u1ea3nh tr\u00ean b\u1eb1ng c\u00e1ch ngh\u0129 v\u1ec1 th\u1ee9 t\u1ef1 c\u1ee7a $x - y$ nh\u01b0 m\u1ed9t \"\u0111\u01b0\u1eddng qu\u00e9t\" \u0111i t\u1eeb t\u00e2y-b\u1eafc \u0111\u1ebfn \u0111\u00f4ng-nam, t\u1ee9c l\u00e0 vu\u00f4ng g\u00f3c v\u1edbi \u0111\u01b0\u1eddng \u0111\u01b0\u1ee3c v\u1ebd.</p> <p>\u0110i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 n\u1ebfu ch\u00fang ta gi\u1eef t\u1eadp h\u1ee3p ho\u1ea1t \u0111\u1ed9ng \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp theo $x$, c\u00e1c \u1ee9ng vi\u00ean $s$ \u0111\u01b0\u1ee3c \u0111\u1eb7t li\u00ean ti\u1ebfp nhau. Sau \u0111\u00f3 ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm $x_s \\leq x_p$ l\u1edbn nh\u1ea5t v\u00e0 x\u1eed l\u00fd c\u00e1c \u0111i\u1ec3m theo th\u1ee9 t\u1ef1 gi\u1ea3m d\u1ea7n c\u1ee7a $x$ cho \u0111\u1ebfn khi \u0111i\u1ec1u ki\u1ec7n th\u1ee9 hai $x_p - y_p &lt; x_s - y_s$ b\u1ecb ph\u00e1 v\u1ee1 (ch\u00fang ta th\u1ef1c s\u1ef1 c\u00f3 th\u1ec3 cho ph\u00e9p $x_p - y_p = x_s - y_s$ v\u00e0 \u0111i\u1ec1u \u0111\u00f3 gi\u1ea3i quy\u1ebft tr\u01b0\u1eddng h\u1ee3p c\u00e1c \u0111i\u1ec3m c\u00f3 t\u1ecda \u0111\u1ed9 b\u1eb1ng nhau). L\u01b0u \u00fd r\u1eb1ng v\u00ec ch\u00fang ta x\u00f3a kh\u1ecfi t\u1eadp h\u1ee3p ngay sau khi x\u1eed l\u00fd, \u0111i\u1ec1u n\u00e0y s\u1ebd c\u00f3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p kh\u1ea5u hao l\u00e0 $O(n \\log(n))$.     B\u00e2y gi\u1edd ch\u00fang ta c\u00f3 \u0111i\u1ec3m g\u1ea7n nh\u1ea5t theo h\u01b0\u1edbng \u0111\u00f4ng-b\u1eafc, ch\u00fang ta xoay c\u00e1c \u0111i\u1ec3m v\u00e0 l\u1eb7p l\u1ea1i. C\u00f3 th\u1ec3 ch\u1ec9 ra r\u1eb1ng th\u1ef1c t\u1ebf ch\u00fang ta c\u0169ng t\u00ecm th\u1ea5y theo c\u00e1ch n\u00e0y \u0111i\u1ec3m g\u1ea7n nh\u1ea5t theo h\u01b0\u1edbng t\u00e2y-nam, v\u00ec v\u1eady ch\u00fang ta c\u00f3 th\u1ec3 l\u1eb7p l\u1ea1i ch\u1ec9 4 l\u1ea7n, thay v\u00ec 8.</p> <p>T\u00f3m l\u1ea1i ch\u00fang ta:</p> <ul> <li>S\u1eafp x\u1ebfp c\u00e1c \u0111i\u1ec3m theo $x + y$ theo th\u1ee9 t\u1ef1 kh\u00f4ng gi\u1ea3m;</li> <li>\u0110\u1ed1i v\u1edbi m\u1ecdi \u0111i\u1ec3m, ch\u00fang ta l\u1eb7p qua t\u1eadp h\u1ee3p ho\u1ea1t \u0111\u1ed9ng b\u1eaft \u0111\u1ea7u v\u1edbi \u0111i\u1ec3m c\u00f3 $x$ l\u1edbn nh\u1ea5t sao cho $x \\leq x_p$, v\u00e0 ch\u00fang ta ng\u1eaft v\u00f2ng l\u1eb7p n\u1ebfu $x_p - y_p \\geq x_s - y_s$. \u0110\u1ed1i v\u1edbi m\u1ecdi \u0111i\u1ec3m h\u1ee3p l\u1ec7 $s$ ch\u00fang ta th\u00eam c\u1ea1nh $(s,p, d(s,p))$ v\u00e0o danh s\u00e1ch c\u1ee7a ch\u00fang ta;</li> <li>Ch\u00fang ta th\u00eam \u0111i\u1ec3m $p$ v\u00e0o t\u1eadp h\u1ee3p ho\u1ea1t \u0111\u1ed9ng;</li> <li>Xoay c\u00e1c \u0111i\u1ec3m v\u00e0 l\u1eb7p l\u1ea1i cho \u0111\u1ebfn khi ch\u00fang ta l\u1eb7p qua t\u1ea5t c\u1ea3 c\u00e1c octant.</li> <li>\u00c1p d\u1ee5ng thu\u1eadt to\u00e1n Kruskal tr\u00ean danh s\u00e1ch c\u00e1c c\u1ea1nh \u0111\u1ec3 l\u1ea5y MST.</li> </ul> <p>D\u01b0\u1edbi \u0111\u00e2y b\u1ea1n c\u00f3 th\u1ec3 t\u00ecm th\u1ea5y m\u1ed9t c\u00e0i \u0111\u1eb7t, d\u1ef1a tr\u00ean m\u1ed9t c\u00e0i \u0111\u1eb7t t\u1eeb KACTL.</p> <pre><code>struct point {\n    long long x, y;\n};\n\n// Returns a list of edges in the format (weight, u, v). \n// Passing this list to Kruskal algorithm will give the Manhattan MST.\nvector&lt;tuple&lt;long long, int, int&gt;&gt; manhattan_mst_edges(vector&lt;point&gt; ps) {\n    vector&lt;int&gt; ids(ps.size());\n    iota(ids.begin(), ids.end(), 0);\n    vector&lt;tuple&lt;long long, int, int&gt;&gt; edges;\n    for (int rot = 0; rot &lt; 4; rot++) { // for every rotation\n        sort(ids.begin(), ids.end(), [&amp;](int i, int j){\n            return (ps[i].x + ps[i].y) &lt; (ps[j].x + ps[j].y);\n        });\n        map&lt;int, int, greater&lt;int&gt;&gt; active; // (xs, id)\n        for (auto i : ids) {\n            for (auto it = active.lower_bound(ps[i].x); it != active.end();\n            active.erase(it++)) {\n                int j = it-&gt;second;\n                if (ps[i].x - ps[i].y &gt; ps[j].x - ps[j].y) break;\n                assert(ps[i].x &gt;= ps[j].x &amp;&amp; ps[i].y &gt;= ps[j].y);\n                edges.push_back({(ps[i].x - ps[j].x) + (ps[i].y - ps[j].y), i, j});\n            }\n            active[ps[i].x] = i;\n        }\n        for (auto &amp;p : ps) { // rotate\n            if (rot &amp; 1) p.x *= -1;\n            else swap(p.x, p.y);\n        }\n    }\n    return edges;\n}\n</code></pre>","tags":["Translated"]},{"location":"geometry/manhattan-distance.html#problems","title":"B\u00e0i t\u1eadp (Problems)","text":"<ul> <li>AtCoder Beginner Contest 178E - Dist Max</li> <li>CodeForces 1093G - Multidimensional Queries</li> <li>CodeForces 944F - Game with Tokens</li> <li>AtCoder Code Festival 2017D - Four Coloring</li> <li>The 2023 ICPC Asia EC Regionals Online Contest (I) - J. Minimum Manhattan Distance</li> <li>Petrozavodsk Winter Training Camp 2016 Contest 4 - B. Airports</li> </ul>","tags":["Translated"]},{"location":"geometry/minkowski.html","title":"T\u1ed5ng Minkowski c\u1ee7a c\u00e1c \u0111a gi\u00e1c l\u1ed3i (Minkowski sum of convex polygons)","text":"","tags":["Translated"]},{"location":"geometry/minkowski.html#definition","title":"\u0110\u1ecbnh ngh\u0129a (Definition)","text":"<p>Xem x\u00e9t hai t\u1eadp h\u1ee3p \u0111i\u1ec3m $A$ v\u00e0 $B$ tr\u00ean m\u1ed9t m\u1eb7t ph\u1eb3ng. T\u1ed5ng Minkowski $A + B$ \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a l\u00e0 $\\{a + b| a \\in A, b \\in B\\}$. \u1ede \u0111\u00e2y ch\u00fang ta s\u1ebd xem x\u00e9t tr\u01b0\u1eddng h\u1ee3p khi $A$ v\u00e0 $B$ bao g\u1ed3m c\u00e1c \u0111a gi\u00e1c l\u1ed3i $P$ v\u00e0 $Q$ v\u1edbi ph\u1ea7n b\u00ean trong c\u1ee7a ch\u00fang. Trong su\u1ed1t b\u00e0i vi\u1ebft n\u00e0y, ch\u00fang ta s\u1ebd x\u00e1c \u0111\u1ecbnh c\u00e1c \u0111a gi\u00e1c v\u1edbi c\u00e1c chu\u1ed7i \u0111\u1ec9nh c\u00f3 th\u1ee9 t\u1ef1 c\u1ee7a ch\u00fang, \u0111\u1ec3 c\u00e1c k\u00fd hi\u1ec7u nh\u01b0 $|P|$ ho\u1eb7c $P_i$ c\u00f3 \u00fd ngh\u0129a. H\u00f3a ra t\u1ed5ng c\u1ee7a c\u00e1c \u0111a gi\u00e1c l\u1ed3i $P$ v\u00e0 $Q$ l\u00e0 m\u1ed9t \u0111a gi\u00e1c l\u1ed3i v\u1edbi t\u1ed1i \u0111a $|P| + |Q|$ \u0111\u1ec9nh.</p>","tags":["Translated"]},{"location":"geometry/minkowski.html#algorithm","title":"Thu\u1eadt to\u00e1n (Algorithm)","text":"<p>\u1ede \u0111\u00e2y ch\u00fang ta coi c\u00e1c \u0111a gi\u00e1c \u0111\u01b0\u1ee3c \u0111\u00e1nh s\u1ed1 theo v\u00f2ng tr\u00f2n, t\u1ee9c l\u00e0 $P_{|P|} = P_0,\\ Q_{|Q|} = Q_0$ v\u00e0 v\u00e2n v\u00e2n.</p> <p>V\u00ec k\u00edch th\u01b0\u1edbc c\u1ee7a t\u1ed5ng l\u00e0 tuy\u1ebfn t\u00ednh theo k\u00edch th\u01b0\u1edbc c\u1ee7a c\u00e1c \u0111a gi\u00e1c ban \u0111\u1ea7u, ch\u00fang ta n\u00ean nh\u1eafm \u0111\u1ebfn vi\u1ec7c t\u00ecm ra m\u1ed9t thu\u1eadt to\u00e1n th\u1eddi gian tuy\u1ebfn t\u00ednh. Gi\u1ea3 s\u1eed r\u1eb1ng c\u1ea3 hai \u0111a gi\u00e1c \u0111\u1ec1u \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp ng\u01b0\u1ee3c chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3. Xem x\u00e9t c\u00e1c chu\u1ed7i c\u1ea1nh $\\{\\overrightarrow{P_iP_{i+1}}\\}$ v\u00e0 $\\{\\overrightarrow{Q_jQ_{j+1}}\\}$ \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp theo g\u00f3c c\u1ef1c. Ch\u00fang t\u00f4i tuy\u00ean b\u1ed1 r\u1eb1ng chu\u1ed7i c\u00e1c c\u1ea1nh c\u1ee7a $P + Q$ c\u00f3 th\u1ec3 thu \u0111\u01b0\u1ee3c b\u1eb1ng c\u00e1ch h\u1ee3p nh\u1ea5t hai chu\u1ed7i n\u00e0y b\u1ea3o t\u1ed3n th\u1ee9 t\u1ef1 g\u00f3c c\u1ef1c v\u00e0 thay th\u1ebf c\u00e1c vector c\u00f9ng h\u01b0\u1edbng li\u00ean ti\u1ebfp b\u1eb1ng t\u1ed5ng c\u1ee7a ch\u00fang. Vi\u1ec7c s\u1eed d\u1ee5ng \u0111\u01a1n gi\u1ea3n \u00fd t\u01b0\u1edfng n\u00e0y d\u1eabn \u0111\u1ebfn m\u1ed9t thu\u1eadt to\u00e1n th\u1eddi gian tuy\u1ebfn t\u00ednh, tuy nhi\u00ean, vi\u1ec7c kh\u00f4i ph\u1ee5c c\u00e1c \u0111\u1ec9nh c\u1ee7a $P + Q$ t\u1eeb chu\u1ed7i c\u00e1c c\u1ea1nh \u0111\u00f2i h\u1ecfi ph\u1ea3i c\u1ed9ng vector l\u1eb7p \u0111i l\u1eb7p l\u1ea1i, \u0111i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 g\u00e2y ra c\u00e1c v\u1ea5n \u0111\u1ec1 v\u1ec1 \u0111\u1ed9 ch\u00ednh x\u00e1c kh\u00f4ng mong mu\u1ed1n n\u1ebfu ch\u00fang ta \u0111ang l\u00e0m vi\u1ec7c v\u1edbi t\u1ecda \u0111\u1ed9 d\u1ea5u ch\u1ea5m \u0111\u1ed9ng, v\u00ec v\u1eady ch\u00fang t\u00f4i s\u1ebd m\u00f4 t\u1ea3 m\u1ed9t s\u1eeda \u0111\u1ed5i nh\u1ecf c\u1ee7a \u00fd t\u01b0\u1edfng n\u00e0y.</p> <p>\u0110\u1ea7u ti\u00ean, ch\u00fang ta n\u00ean s\u1eafp x\u1ebfp l\u1ea1i c\u00e1c \u0111\u1ec9nh theo c\u00e1ch m\u00e0 \u0111\u1ec9nh \u0111\u1ea7u ti\u00ean c\u1ee7a m\u1ed7i \u0111a gi\u00e1c c\u00f3 t\u1ecda \u0111\u1ed9 y th\u1ea5p nh\u1ea5t (trong tr\u01b0\u1eddng h\u1ee3p c\u00f3 m\u1ed9t v\u00e0i \u0111\u1ec9nh nh\u01b0 v\u1eady, h\u00e3y ch\u1ecdn \u0111\u1ec9nh c\u00f3 t\u1ecda \u0111\u1ed9 x nh\u1ecf nh\u1ea5t). Sau \u0111\u00f3, c\u00e1c c\u1ea1nh c\u1ee7a c\u1ea3 hai \u0111a gi\u00e1c s\u1ebd \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp theo g\u00f3c c\u1ef1c, v\u00ec v\u1eady kh\u00f4ng c\u1ea7n ph\u1ea3i s\u1eafp x\u1ebfp ch\u00fang th\u1ee7 c\u00f4ng. B\u00e2y gi\u1edd ch\u00fang ta t\u1ea1o hai con tr\u1ecf $i$ (tr\u1ecf \u0111\u1ebfn m\u1ed9t \u0111\u1ec9nh c\u1ee7a $P$) v\u00e0 $j$ (tr\u1ecf \u0111\u1ebfn m\u1ed9t \u0111\u1ec9nh c\u1ee7a $Q$), c\u1ea3 hai ban \u0111\u1ea7u \u0111\u01b0\u1ee3c \u0111\u1eb7t th\u00e0nh 0. Ch\u00fang ta l\u1eb7p l\u1ea1i c\u00e1c b\u01b0\u1edbc sau trong khi $i &lt; |P|$ ho\u1eb7c $j &lt; |Q|$.</p> <ol> <li> <p>Th\u00eam $P_i + Q_j$ v\u00e0o $P + Q$.</p> </li> <li> <p>So s\u00e1nh g\u00f3c c\u1ef1c c\u1ee7a $\\overrightarrow{P_iP_{i + 1}}$ v\u00e0 $\\overrightarrow{Q_jQ_{j+1}}$.</p> </li> <li> <p>T\u0103ng con tr\u1ecf t\u01b0\u01a1ng \u1ee9ng v\u1edbi g\u00f3c nh\u1ecf nh\u1ea5t (n\u1ebfu c\u00e1c g\u00f3c b\u1eb1ng nhau, t\u0103ng c\u1ea3 hai).</p> </li> </ol>","tags":["Translated"]},{"location":"geometry/minkowski.html#visualization","title":"Tr\u1ef1c quan h\u00f3a (Visualization)","text":"<p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u1ed9t h\u00ecnh \u1ea3nh tr\u1ef1c quan \u0111\u1eb9p, c\u00f3 th\u1ec3 gi\u00fap b\u1ea1n hi\u1ec3u nh\u1eefng g\u00ec \u0111ang di\u1ec5n ra.</p>","tags":["Translated"]},{"location":"geometry/minkowski.html#distance-between-two-polygons","title":"Kho\u1ea3ng c\u00e1ch gi\u1eefa hai \u0111a gi\u00e1c (Distance between two polygons)","text":"<p>M\u1ed9t trong nh\u1eefng \u1ee9ng d\u1ee5ng ph\u1ed5 bi\u1ebfn nh\u1ea5t c\u1ee7a t\u1ed5ng Minkowski l\u00e0 t\u00ednh kho\u1ea3ng c\u00e1ch gi\u1eefa hai \u0111a gi\u00e1c l\u1ed3i (ho\u1eb7c \u0111\u01a1n gi\u1ea3n l\u00e0 ki\u1ec3m tra xem ch\u00fang c\u00f3 giao nhau hay kh\u00f4ng). Kho\u1ea3ng c\u00e1ch gi\u1eefa hai \u0111a gi\u00e1c l\u1ed3i $P$ v\u00e0 $Q$ \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a l\u00e0 $\\min\\limits_{a \\in P, b \\in Q} ||a - b||$. Ng\u01b0\u1eddi ta c\u00f3 th\u1ec3 nh\u1eadn th\u1ea5y r\u1eb1ng kho\u1ea3ng c\u00e1ch lu\u00f4n \u0111\u1ea1t \u0111\u01b0\u1ee3c gi\u1eefa hai \u0111\u1ec9nh ho\u1eb7c m\u1ed9t \u0111\u1ec9nh v\u00e0 m\u1ed9t c\u1ea1nh, v\u00ec v\u1eady ch\u00fang ta c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng t\u00ecm th\u1ea5y kho\u1ea3ng c\u00e1ch trong $O(|P||Q|)$. Tuy nhi\u00ean, v\u1edbi vi\u1ec7c s\u1eed d\u1ee5ng th\u00f4ng minh t\u1ed5ng Minkowski, ch\u00fang ta c\u00f3 th\u1ec3 gi\u1ea3m \u0111\u1ed9 ph\u1ee9c t\u1ea1p xu\u1ed1ng $O(|P| + |Q|)$.</p> <p>N\u1ebfu ch\u00fang ta ph\u1ea3n chi\u1ebfu $Q$ qua \u0111i\u1ec3m $(0, 0)$ thu \u0111\u01b0\u1ee3c \u0111a gi\u00e1c $-Q$, b\u00e0i to\u00e1n quy v\u1ec1 vi\u1ec7c t\u00ecm kho\u1ea3ng c\u00e1ch nh\u1ecf nh\u1ea5t gi\u1eefa m\u1ed9t \u0111i\u1ec3m trong $P + (-Q)$ v\u00e0 $(0, 0)$. Ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm th\u1ea5y kho\u1ea3ng c\u00e1ch \u0111\u00f3 trong th\u1eddi gian tuy\u1ebfn t\u00ednh b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng \u00fd t\u01b0\u1edfng sau. N\u1ebfu $(0, 0)$ \u1edf b\u00ean trong ho\u1eb7c tr\u00ean bi\u00ean c\u1ee7a \u0111a gi\u00e1c, kho\u1ea3ng c\u00e1ch l\u00e0 $0$, ng\u01b0\u1ee3c l\u1ea1i kho\u1ea3ng c\u00e1ch \u0111\u1ea1t \u0111\u01b0\u1ee3c gi\u1eefa $(0, 0)$ v\u00e0 m\u1ed9t \u0111\u1ec9nh ho\u1eb7c c\u1ea1nh n\u00e0o \u0111\u00f3 c\u1ee7a \u0111a gi\u00e1c. V\u00ec t\u1ed5ng Minkowski c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n trong th\u1eddi gian tuy\u1ebfn t\u00ednh, ch\u00fang ta thu \u0111\u01b0\u1ee3c m\u1ed9t thu\u1eadt to\u00e1n th\u1eddi gian tuy\u1ebfn t\u00ednh \u0111\u1ec3 t\u00ecm kho\u1ea3ng c\u00e1ch gi\u1eefa hai \u0111a gi\u00e1c l\u1ed3i.</p>","tags":["Translated"]},{"location":"geometry/minkowski.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 vi\u1ec7c c\u00e0i \u0111\u1eb7t t\u1ed5ng Minkowski cho c\u00e1c \u0111a gi\u00e1c c\u00f3 \u0111i\u1ec3m nguy\u00ean. L\u01b0u \u00fd r\u1eb1ng trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, t\u1ea5t c\u1ea3 c\u00e1c t\u00ednh to\u00e1n c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n b\u1eb1ng s\u1ed1 nguy\u00ean v\u00ec thay v\u00ec t\u00ednh to\u00e1n c\u00e1c g\u00f3c c\u1ef1c v\u00e0 so s\u00e1nh tr\u1ef1c ti\u1ebfp ch\u00fang, ch\u00fang ta c\u00f3 th\u1ec3 nh\u00ecn v\u00e0o d\u1ea5u c\u1ee7a t\u00edch c\u00f3 h\u01b0\u1edbng c\u1ee7a hai vector.</p> <pre><code>struct pt{\n    long long x, y;\n    pt operator + (const pt &amp; p) const {\n        return pt{x + p.x, y + p.y};\n    }\n    pt operator - (const pt &amp; p) const {\n        return pt{x - p.x, y - p.y};\n    }\n    long long cross(const pt &amp; p) const {\n        return x * p.y - y * p.x;\n    }\n};\n\nvoid reorder_polygon(vector&lt;pt&gt; &amp; P){\n    size_t pos = 0;\n    for(size_t i = 1; i &lt; P.size(); i++){\n        if(P[i].y &lt; P[pos].y || (P[i].y == P[pos].y &amp;&amp; P[i].x &lt; P[pos].x))\n            pos = i;\n    }\n    rotate(P.begin(), P.begin() + pos, P.end());\n}\n\nvector&lt;pt&gt; minkowski(vector&lt;pt&gt; P, vector&lt;pt&gt; Q){\n    // the first vertex must be the lowest\n    reorder_polygon(P);\n    reorder_polygon(Q);\n    // we must ensure cyclic indexing\n    P.push_back(P[0]);\n    P.push_back(P[1]);\n    Q.push_back(Q[0]);\n    Q.push_back(Q[1]);\n    // main part\n    vector&lt;pt&gt; result;\n    size_t i = 0, j = 0;\n    while(i &lt; P.size() - 2 || j &lt; Q.size() - 2){\n        result.push_back(P[i] + Q[j]);\n        auto cross = (P[i + 1] - P[i]).cross(Q[j + 1] - Q[j]);\n        if(cross &gt;= 0 &amp;&amp; i &lt; P.size() - 2)\n            ++i;\n        if(cross &lt;= 0 &amp;&amp; j &lt; Q.size() - 2)\n            ++j;\n    }\n    return result;\n}\n</code></pre>","tags":["Translated"]},{"location":"geometry/minkowski.html#problems","title":"B\u00e0i t\u1eadp (Problems)","text":"<ul> <li>Codeforces 87E Mogohu-Rea Idol</li> <li>Codeforces 1195F Geometers Anonymous Club</li> <li>TIMUS 1894 Non-Flying Weather</li> </ul>","tags":["Translated"]},{"location":"geometry/nearest_points.html","title":"T\u00ecm c\u1eb7p \u0111i\u1ec3m g\u1ea7n nh\u1ea5t (Finding the nearest pair of points)","text":"","tags":["Translated"]},{"location":"geometry/nearest_points.html#problem-statement","title":"Ph\u00e1t bi\u1ec3u b\u00e0i to\u00e1n (Problem statement)","text":"<p>Cho $n$ \u0111i\u1ec3m tr\u00ean m\u1eb7t ph\u1eb3ng. M\u1ed7i \u0111i\u1ec3m $p_i$ \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh b\u1edfi t\u1ecda \u0111\u1ed9 $(x_i,y_i)$ c\u1ee7a n\u00f3. Y\u00eau c\u1ea7u t\u00ecm trong s\u1ed1 ch\u00fang hai \u0111i\u1ec3m sao cho kho\u1ea3ng c\u00e1ch gi\u1eefa ch\u00fang l\u00e0 nh\u1ecf nh\u1ea5t:</p> $$ \\min_{\\scriptstyle i, j=0 \\ldots n-1,\\atop \\scriptstyle i \\neq j } \\rho (p_i, p_j). $$ <p>Ch\u00fang ta l\u1ea5y kho\u1ea3ng c\u00e1ch Euclide th\u00f4ng th\u01b0\u1eddng:</p> $$ \\rho (p_i,p_j) = \\sqrt{(x_i-x_j)^2 + (y_i-y_j)^2} .$$ <p>Thu\u1eadt to\u00e1n t\u1ea7m th\u01b0\u1eddng - l\u1eb7p qua t\u1ea5t c\u1ea3 c\u00e1c c\u1eb7p v\u00e0 t\u00ednh to\u00e1n kho\u1ea3ng c\u00e1ch cho m\u1ed7i c\u1eb7p \u2014 ho\u1ea1t \u0111\u1ed9ng trong $O(n^2)$.</p> <p>Thu\u1eadt to\u00e1n ch\u1ea1y trong th\u1eddi gian $O(n \\log n)$ \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 d\u01b0\u1edbi \u0111\u00e2y. Thu\u1eadt to\u00e1n n\u00e0y \u0111\u01b0\u1ee3c \u0111\u1ec1 xu\u1ea5t b\u1edfi Shamos v\u00e0 Hoey v\u00e0o n\u0103m 1975. (Ngu\u1ed3n: Ch\u01b0\u01a1ng 5 Ghi ch\u00fa c\u1ee7a Algorithm Design b\u1edfi Kleinberg &amp; Tardos, xem th\u00eam t\u1ea1i \u0111\u00e2y) Preparata v\u00e0 Shamos c\u0169ng \u0111\u00e3 ch\u1ec9 ra r\u1eb1ng thu\u1eadt to\u00e1n n\u00e0y l\u00e0 t\u1ed1i \u01b0u trong m\u00f4 h\u00ecnh c\u00e2y quy\u1ebft \u0111\u1ecbnh (decision tree model).</p>","tags":["Translated"]},{"location":"geometry/nearest_points.html#algorithm","title":"Thu\u1eadt to\u00e1n (Algorithm)","text":"<p>Ch\u00fang ta x\u00e2y d\u1ef1ng m\u1ed9t thu\u1eadt to\u00e1n theo l\u01b0\u1ee3c \u0111\u1ed3 chung c\u1ee7a c\u00e1c thu\u1eadt to\u00e1n chia \u0111\u1ec3 tr\u1ecb (divide-and-conquer): thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c thi\u1ebft k\u1ebf nh\u01b0 m\u1ed9t h\u00e0m \u0111\u1ec7 quy, m\u00e0 ch\u00fang ta truy\u1ec1n v\u00e0o m\u1ed9t t\u1eadp h\u1ee3p c\u00e1c \u0111i\u1ec3m; h\u00e0m \u0111\u1ec7 quy n\u00e0y chia t\u1eadp h\u1ee3p n\u00e0y l\u00e0m \u0111\u00f4i, g\u1ecdi ch\u00ednh n\u00f3 m\u1ed9t c\u00e1ch \u0111\u1ec7 quy tr\u00ean m\u1ed7i n\u1eeda, v\u00e0 sau \u0111\u00f3 th\u1ef1c hi\u1ec7n m\u1ed9t s\u1ed1 thao t\u00e1c \u0111\u1ec3 k\u1ebft h\u1ee3p c\u00e1c c\u00e2u tr\u1ea3 l\u1eddi. Thao t\u00e1c k\u1ebft h\u1ee3p bao g\u1ed3m vi\u1ec7c ph\u00e1t hi\u1ec7n c\u00e1c tr\u01b0\u1eddng h\u1ee3p khi m\u1ed9t \u0111i\u1ec3m c\u1ee7a gi\u1ea3i ph\u00e1p t\u1ed1i \u01b0u r\u01a1i v\u00e0o m\u1ed9t n\u1eeda, v\u00e0 \u0111i\u1ec3m kia v\u00e0o n\u1eeda kia (trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, c\u00e1c l\u1ec7nh g\u1ecdi \u0111\u1ec7 quy t\u1eeb m\u1ed7i n\u1eeda kh\u00f4ng th\u1ec3 ph\u00e1t hi\u1ec7n c\u1eb7p n\u00e0y m\u1ed9t c\u00e1ch ri\u00eang bi\u1ec7t). Kh\u00f3 kh\u0103n ch\u00ednh, nh\u01b0 m\u1ecdi khi trong tr\u01b0\u1eddng h\u1ee3p c\u00e1c thu\u1eadt to\u00e1n chia \u0111\u1ec3 tr\u1ecb, n\u1eb1m \u1edf vi\u1ec7c c\u00e0i \u0111\u1eb7t hi\u1ec7u qu\u1ea3 giai \u0111o\u1ea1n h\u1ee3p nh\u1ea5t (merging stage). N\u1ebfu m\u1ed9t t\u1eadp h\u1ee3p $n$ \u0111i\u1ec3m \u0111\u01b0\u1ee3c truy\u1ec1n cho h\u00e0m \u0111\u1ec7 quy, th\u00ec giai \u0111o\u1ea1n h\u1ee3p nh\u1ea5t s\u1ebd ho\u1ea1t \u0111\u1ed9ng kh\u00f4ng qu\u00e1 $O(n)$, th\u00ec ti\u1ec7m c\u1eadn c\u1ee7a to\u00e0n b\u1ed9 thu\u1eadt to\u00e1n $T(n)$ s\u1ebd \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y t\u1eeb ph\u01b0\u01a1ng tr\u00ecnh:</p> $$T(n) = 2T(n/2) + O(n).$$ <p>Nghi\u1ec7m c\u1ee7a ph\u01b0\u01a1ng tr\u00ecnh n\u00e0y, nh\u01b0 \u0111\u00e3 bi\u1ebft, l\u00e0 $T(n) = O(n \\log n).$</p> <p>V\u00ec v\u1eady, ch\u00fang ta ti\u1ebfn h\u00e0nh x\u00e2y d\u1ef1ng thu\u1eadt to\u00e1n. \u0110\u1ec3 \u0111i \u0111\u1ebfn vi\u1ec7c c\u00e0i \u0111\u1eb7t hi\u1ec7u qu\u1ea3 giai \u0111o\u1ea1n h\u1ee3p nh\u1ea5t trong t\u01b0\u01a1ng lai, ch\u00fang ta s\u1ebd chia t\u1eadp h\u1ee3p c\u00e1c \u0111i\u1ec3m th\u00e0nh hai t\u1eadp h\u1ee3p con, theo t\u1ecda \u0111\u1ed9 $x$ c\u1ee7a ch\u00fang: Tr\u00ean th\u1ef1c t\u1ebf, ch\u00fang ta v\u1ebd m\u1ed9t \u0111\u01b0\u1eddng th\u1eb3ng \u0111\u1ee9ng chia t\u1eadp h\u1ee3p c\u00e1c \u0111i\u1ec3m th\u00e0nh hai t\u1eadp h\u1ee3p con c\u00f3 k\u00edch th\u01b0\u1edbc x\u1ea5p x\u1ec9 nhau. Thu\u1eadn ti\u1ec7n \u0111\u1ec3 th\u1ef1c hi\u1ec7n ph\u00e2n v\u00f9ng nh\u01b0 v\u1eady nh\u01b0 sau: Ch\u00fang ta s\u1eafp x\u1ebfp c\u00e1c \u0111i\u1ec3m theo c\u00e1ch ti\u00eau chu\u1ea9n nh\u01b0 c\u00e1c c\u1eb7p s\u1ed1, t\u1ee9c l\u00e0:</p> $$p_i &lt; p_j \\Longleftrightarrow (x_i &lt; x_j) \\lor \\Big(\\left(x_i = x_j\\right) \\wedge \\left(y_i &lt; y_j \\right) \\Big) $$ <p>Sau \u0111\u00f3 l\u1ea5y \u0111i\u1ec3m gi\u1eefa sau khi s\u1eafp x\u1ebfp $p_m (m = \\lfloor n/2 \\rfloor)$, v\u00e0 t\u1ea5t c\u1ea3 c\u00e1c \u0111i\u1ec3m tr\u01b0\u1edbc n\u00f3 v\u00e0 ch\u00ednh $p_m$ \u0111\u01b0\u1ee3c g\u00e1n cho n\u1eeda \u0111\u1ea7u ti\u00ean, v\u00e0 t\u1ea5t c\u1ea3 c\u00e1c \u0111i\u1ec3m sau n\u00f3 - cho n\u1eeda th\u1ee9 hai:</p> $$A_1 = \\{p_i \\ | \\ i = 0 \\ldots m \\}$$ $$A_2 = \\{p_i \\ | \\ i = m + 1 \\ldots n-1 \\}.$$ <p>B\u00e2y gi\u1edd, g\u1ecdi \u0111\u1ec7 quy tr\u00ean m\u1ed7i t\u1eadp h\u1ee3p $A_1$ v\u00e0 $A_2$, ch\u00fang ta s\u1ebd t\u00ecm th\u1ea5y c\u00e1c c\u00e2u tr\u1ea3 l\u1eddi $h_1$ v\u00e0 $h_2$ cho m\u1ed7i n\u1eeda. V\u00e0 l\u1ea5y c\u00e1i t\u1ed1t nh\u1ea5t trong s\u1ed1 ch\u00fang: $h = \\min(h_1, h_2)$.</p> <p>B\u00e2y gi\u1edd ch\u00fang ta c\u1ea7n th\u1ef1c hi\u1ec7n m\u1ed9t giai \u0111o\u1ea1n h\u1ee3p nh\u1ea5t, t\u1ee9c l\u00e0 ch\u00fang ta c\u1ed1 g\u1eafng t\u00ecm c\u00e1c c\u1eb7p \u0111i\u1ec3m nh\u01b0 v\u1eady, m\u00e0 kho\u1ea3ng c\u00e1ch gi\u1eefa ch\u00fang nh\u1ecf h\u01a1n $h$ v\u00e0 m\u1ed9t \u0111i\u1ec3m n\u1eb1m trong $A_1$ v\u00e0 \u0111i\u1ec3m kia n\u1eb1m trong $A_2$. R\u00f5 r\u00e0ng l\u00e0 ch\u1ec9 c\u1ea7n xem x\u00e9t nh\u1eefng \u0111i\u1ec3m t\u00e1ch bi\u1ec7t kh\u1ecfi \u0111\u01b0\u1eddng th\u1eb3ng \u0111\u1ee9ng m\u1ed9t kho\u1ea3ng c\u00e1ch nh\u1ecf h\u01a1n $h$, t\u1ee9c l\u00e0 t\u1eadp h\u1ee3p $B$ c\u1ee7a c\u00e1c \u0111i\u1ec3m \u0111\u01b0\u1ee3c xem x\u00e9t \u1edf giai \u0111o\u1ea1n n\u00e0y b\u1eb1ng:</p> $$B = \\{ p_i\\ | \\ | x_i - x_m\\ | &lt; h \\}.$$ <p>\u0110\u1ed1i v\u1edbi m\u1ed7i \u0111i\u1ec3m trong t\u1eadp h\u1ee3p $B$, ch\u00fang ta c\u1ed1 g\u1eafng t\u00ecm c\u00e1c \u0111i\u1ec3m g\u1ea7n n\u00f3 h\u01a1n $h$. V\u00ed d\u1ee5, ch\u1ec9 c\u1ea7n xem x\u00e9t nh\u1eefng \u0111i\u1ec3m c\u00f3 t\u1ecda \u0111\u1ed9 $y$ kh\u00e1c bi\u1ec7t kh\u00f4ng qu\u00e1 $h$. H\u01a1n n\u1eefa, kh\u00f4ng c\u00f3 \u00fd ngh\u0129a g\u00ec khi xem x\u00e9t nh\u1eefng \u0111i\u1ec3m c\u00f3 t\u1ecda \u0111\u1ed9 $y$ l\u1edbn h\u01a1n t\u1ecda \u0111\u1ed9 $y$ c\u1ee7a \u0111i\u1ec3m hi\u1ec7n t\u1ea1i. Do \u0111\u00f3, \u0111\u1ed1i v\u1edbi m\u1ed7i \u0111i\u1ec3m $p_i$, ch\u00fang ta \u0111\u1ecbnh ngh\u0129a t\u1eadp h\u1ee3p c\u00e1c \u0111i\u1ec3m \u0111\u01b0\u1ee3c xem x\u00e9t $C(p_i)$ nh\u01b0 sau:</p> $$C(p_i) = \\{ p_j\\ |\\ p_j \\in B,\\ \\ y_i - h &lt; y_j \\le y_i \\}.$$ <p>N\u1ebfu ch\u00fang ta s\u1eafp x\u1ebfp c\u00e1c \u0111i\u1ec3m c\u1ee7a t\u1eadp h\u1ee3p $B$ theo t\u1ecda \u0111\u1ed9 $y$, s\u1ebd r\u1ea5t d\u1ec5 d\u00e0ng \u0111\u1ec3 t\u00ecm $C(p_i)$: \u0111\u00e2y l\u00e0 m\u1ed9t v\u00e0i \u0111i\u1ec3m li\u00ean ti\u1ebfp ph\u00eda tr\u01b0\u1edbc \u0111i\u1ec3m $p_i$.</p> <p>V\u00ec v\u1eady, trong k\u00fd hi\u1ec7u m\u1edbi, giai \u0111o\u1ea1n h\u1ee3p nh\u1ea5t tr\u00f4ng gi\u1ed1ng nh\u01b0 sau: x\u00e2y d\u1ef1ng m\u1ed9t t\u1eadp h\u1ee3p $B$, s\u1eafp x\u1ebfp c\u00e1c \u0111i\u1ec3m trong \u0111\u00f3 theo t\u1ecda \u0111\u1ed9 $y$, sau \u0111\u00f3 \u0111\u1ed1i v\u1edbi m\u1ed7i \u0111i\u1ec3m $p_i \\in B$ xem x\u00e9t t\u1ea5t c\u1ea3 c\u00e1c \u0111i\u1ec3m $p_j \\in C(p_i)$, v\u00e0 \u0111\u1ed1i v\u1edbi m\u1ed7i c\u1eb7p $(p_i,p_j)$ t\u00ednh to\u00e1n kho\u1ea3ng c\u00e1ch v\u00e0 so s\u00e1nh v\u1edbi kho\u1ea3ng c\u00e1ch t\u1ed1t nh\u1ea5t hi\u1ec7n t\u1ea1i.</p> <p>Tho\u1ea1t nh\u00ecn, \u0111\u00e2y v\u1eabn l\u00e0 m\u1ed9t thu\u1eadt to\u00e1n kh\u00f4ng t\u1ed1i \u01b0u: c\u00f3 v\u1ebb nh\u01b0 k\u00edch th\u01b0\u1edbc c\u1ee7a c\u00e1c t\u1eadp h\u1ee3p $C(p_i)$ s\u1ebd c\u00f3 b\u1eadc $n$, v\u00e0 ti\u1ec7m c\u1eadn c\u1ea7n thi\u1ebft s\u1ebd kh\u00f4ng ho\u1ea1t \u0111\u1ed9ng. Tuy nhi\u00ean, \u0111\u00e1ng ng\u1ea1c nhi\u00ean, c\u00f3 th\u1ec3 ch\u1ee9ng minh r\u1eb1ng k\u00edch th\u01b0\u1edbc c\u1ee7a m\u1ed7i t\u1eadp h\u1ee3p $C(p_i)$ l\u00e0 m\u1ed9t l\u01b0\u1ee3ng $O(1)$, t\u1ee9c l\u00e0 n\u00f3 kh\u00f4ng v\u01b0\u1ee3t qu\u00e1 m\u1ed9t h\u1eb1ng s\u1ed1 nh\u1ecf b\u1ea5t k\u1ec3 ch\u00ednh c\u00e1c \u0111i\u1ec3m \u0111\u00f3. B\u1eb1ng ch\u1ee9ng v\u1ec1 th\u1ef1c t\u1ebf n\u00e0y \u0111\u01b0\u1ee3c \u0111\u01b0a ra trong ph\u1ea7n ti\u1ebfp theo.</p> <p>Cu\u1ed1i c\u00f9ng, ch\u00fang ta ch\u00fa \u00fd \u0111\u1ebfn vi\u1ec7c s\u1eafp x\u1ebfp, m\u00e0 thu\u1eadt to\u00e1n tr\u00ean ch\u1ee9a: \u0111\u1ea7u ti\u00ean, s\u1eafp x\u1ebfp theo c\u00e1c c\u1eb7p $(x, y)$, v\u00e0 sau \u0111\u00f3 th\u1ee9 hai, s\u1eafp x\u1ebfp c\u00e1c ph\u1ea7n t\u1eed c\u1ee7a t\u1eadp h\u1ee3p $B$ theo $y$. Tr\u00ean th\u1ef1c t\u1ebf, c\u1ea3 hai lo\u1ea1i s\u1eafp x\u1ebfp n\u00e0y b\u00ean trong h\u00e0m \u0111\u1ec7 quy c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c lo\u1ea1i b\u1ecf (n\u1ebfu kh\u00f4ng ch\u00fang ta s\u1ebd kh\u00f4ng \u0111\u1ea1t \u0111\u01b0\u1ee3c \u01b0\u1edbc t\u00ednh $O(n)$ cho giai \u0111o\u1ea1n h\u1ee3p nh\u1ea5t, v\u00e0 ti\u1ec7m c\u1eadn chung c\u1ee7a thu\u1eadt to\u00e1n s\u1ebd l\u00e0 $O(n \\log^2 n)$). D\u1ec5 d\u00e0ng lo\u1ea1i b\u1ecf vi\u1ec7c s\u1eafp x\u1ebfp \u0111\u1ea7u ti\u00ean \u2014 ch\u1ec9 c\u1ea7n th\u1ef1c hi\u1ec7n vi\u1ec7c s\u1eafp x\u1ebfp n\u00e0y tr\u01b0\u1edbc khi b\u1eaft \u0111\u1ea7u \u0111\u1ec7 quy: r\u1ed1t cu\u1ed9c, c\u00e1c ph\u1ea7n t\u1eed kh\u00f4ng thay \u0111\u1ed5i b\u00ean trong \u0111\u1ec7 quy, v\u00ec v\u1eady kh\u00f4ng c\u1ea7n ph\u1ea3i s\u1eafp x\u1ebfp l\u1ea1i. V\u1edbi vi\u1ec7c s\u1eafp x\u1ebfp th\u1ee9 hai kh\u00f3 th\u1ef1c hi\u1ec7n h\u01a1n m\u1ed9t ch\u00fat, th\u1ef1c hi\u1ec7n n\u00f3 tr\u01b0\u1edbc \u0111\u00f3 s\u1ebd kh\u00f4ng ho\u1ea1t \u0111\u1ed9ng. Nh\u01b0ng, nh\u1edb l\u1ea1i s\u1eafp x\u1ebfp h\u1ee3p nh\u1ea5t (merge sort), c\u0169ng ho\u1ea1t \u0111\u1ed9ng d\u1ef1a tr\u00ean nguy\u00ean t\u1eafc chia \u0111\u1ec3 tr\u1ecb, ch\u00fang ta c\u00f3 th\u1ec3 \u0111\u01a1n gi\u1ea3n nh\u00fang vi\u1ec7c s\u1eafp x\u1ebfp n\u00e0y v\u00e0o \u0111\u1ec7 quy c\u1ee7a m\u00ecnh. H\u00e3y \u0111\u1ec3 \u0111\u1ec7 quy, l\u1ea5y m\u1ed9t t\u1eadp h\u1ee3p c\u00e1c \u0111i\u1ec3m (nh\u01b0 ch\u00fang ta nh\u1edb, \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp theo c\u00e1c c\u1eb7p $(x, y)$), tr\u1ea3 v\u1ec1 c\u00f9ng m\u1ed9t t\u1eadp h\u1ee3p, nh\u01b0ng \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp theo t\u1ecda \u0111\u1ed9 $y$. \u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y, ch\u1ec9 c\u1ea7n h\u1ee3p nh\u1ea5t (trong $O(n)$) hai k\u1ebft qu\u1ea3 \u0111\u01b0\u1ee3c tr\u1ea3 v\u1ec1 b\u1edfi c\u00e1c l\u1ec7nh g\u1ecdi \u0111\u1ec7 quy. \u0110i\u1ec1u n\u00e0y s\u1ebd d\u1eabn \u0111\u1ebfn m\u1ed9t t\u1eadp h\u1ee3p \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp theo t\u1ecda \u0111\u1ed9 $y$.</p>","tags":["Translated"]},{"location":"geometry/nearest_points.html#evaluation-of-the-asymptotics","title":"\u0110\u00e1nh gi\u00e1 ti\u1ec7m c\u1eadn (Evaluation of the asymptotics)","text":"<p>\u0110\u1ec3 ch\u1ec9 ra r\u1eb1ng thu\u1eadt to\u00e1n tr\u00ean th\u1ef1c s\u1ef1 \u0111\u01b0\u1ee3c th\u1ef1c thi trong $O(n \\log n)$, ch\u00fang ta c\u1ea7n ch\u1ee9ng minh th\u1ef1c t\u1ebf sau: $|C(p_i)| = O(1)$.</p> <p>V\u00ec v\u1eady, h\u00e3y xem x\u00e9t m\u1ed9t \u0111i\u1ec3m $p_i$ n\u00e0o \u0111\u00f3; nh\u1edb l\u1ea1i r\u1eb1ng t\u1eadp h\u1ee3p $C(p_i)$ l\u00e0 m\u1ed9t t\u1eadp h\u1ee3p c\u00e1c \u0111i\u1ec3m c\u00f3 t\u1ecda \u0111\u1ed9 $y$ n\u1eb1m trong \u0111o\u1ea1n $[y_i-h; y_i]$, v\u00e0, h\u01a1n n\u1eefa, d\u1ecdc theo t\u1ecda \u0111\u1ed9 $x$, ch\u00ednh \u0111i\u1ec3m $p_i$ v\u00e0 t\u1ea5t c\u1ea3 c\u00e1c \u0111i\u1ec3m c\u1ee7a t\u1eadp h\u1ee3p $C(p_i)$ n\u1eb1m trong d\u1ea3i r\u1ed9ng $2h$. N\u00f3i c\u00e1ch kh\u00e1c, c\u00e1c \u0111i\u1ec3m ch\u00fang ta \u0111ang xem x\u00e9t $p_i$ v\u00e0 $C(p_i)$ n\u1eb1m trong m\u1ed9t h\u00ecnh ch\u1eef nh\u1eadt k\u00edch th\u01b0\u1edbc $2h \\times h$.</p> <p>Nhi\u1ec7m v\u1ee5 c\u1ee7a ch\u00fang ta l\u00e0 \u01b0\u1edbc t\u00ednh s\u1ed1 l\u01b0\u1ee3ng \u0111i\u1ec3m t\u1ed1i \u0111a c\u00f3 th\u1ec3 n\u1eb1m trong h\u00ecnh ch\u1eef nh\u1eadt n\u00e0y $2h \\times h$; do \u0111\u00f3, ch\u00fang ta \u01b0\u1edbc t\u00ednh k\u00edch th\u01b0\u1edbc t\u1ed1i \u0111a c\u1ee7a t\u1eadp h\u1ee3p $C(p_i)$. \u0110\u1ed3ng th\u1eddi, khi \u0111\u00e1nh gi\u00e1, ch\u00fang ta kh\u00f4ng \u0111\u01b0\u1ee3c qu\u00ean r\u1eb1ng c\u00f3 th\u1ec3 c\u00f3 c\u00e1c \u0111i\u1ec3m l\u1eb7p l\u1ea1i.</p> <p>H\u00e3y nh\u1edb r\u1eb1ng $h$ thu \u0111\u01b0\u1ee3c t\u1eeb k\u1ebft qu\u1ea3 c\u1ee7a hai l\u1ec7nh g\u1ecdi \u0111\u1ec7 quy \u2014 tr\u00ean c\u00e1c t\u1eadp h\u1ee3p $A_1$ v\u00e0 $A_2$, v\u00e0 $A_1$ ch\u1ee9a c\u00e1c \u0111i\u1ec3m b\u00ean tr\u00e1i \u0111\u01b0\u1eddng ph\u00e2n chia v\u00e0 m\u1ed9t ph\u1ea7n tr\u00ean \u0111\u00f3, $A_2$ ch\u1ee9a c\u00e1c \u0111i\u1ec3m c\u00f2n l\u1ea1i c\u1ee7a \u0111\u01b0\u1eddng ph\u00e2n chia v\u00e0 c\u00e1c \u0111i\u1ec3m b\u00ean ph\u1ea3i n\u00f3. \u0110\u1ed1i v\u1edbi b\u1ea5t k\u1ef3 c\u1eb7p \u0111i\u1ec3m n\u00e0o t\u1eeb $A_1$, c\u0169ng nh\u01b0 t\u1eeb $A_2$, kho\u1ea3ng c\u00e1ch kh\u00f4ng th\u1ec3 nh\u1ecf h\u01a1n $h$ \u2014 n\u1ebfu kh\u00f4ng n\u00f3 s\u1ebd c\u00f3 ngh\u0129a l\u00e0 ho\u1ea1t \u0111\u1ed9ng kh\u00f4ng ch\u00ednh x\u00e1c c\u1ee7a h\u00e0m \u0111\u1ec7 quy.</p> <p>\u0110\u1ec3 \u01b0\u1edbc t\u00ednh s\u1ed1 l\u01b0\u1ee3ng \u0111i\u1ec3m t\u1ed1i \u0111a trong h\u00ecnh ch\u1eef nh\u1eadt $2h \\times h$, ch\u00fang ta chia n\u00f3 th\u00e0nh hai h\u00ecnh vu\u00f4ng $h \\times h$, h\u00ecnh vu\u00f4ng th\u1ee9 nh\u1ea5t bao g\u1ed3m t\u1ea5t c\u1ea3 c\u00e1c \u0111i\u1ec3m $C(p_i) \\cap A_1$, v\u00e0 h\u00ecnh vu\u00f4ng th\u1ee9 hai ch\u1ee9a t\u1ea5t c\u1ea3 c\u00e1c \u0111i\u1ec3m kh\u00e1c, t\u1ee9c l\u00e0 $C(p_i) \\cap A_2$. T\u1eeb c\u00e1c c\u00e2n nh\u1eafc tr\u00ean, suy ra r\u1eb1ng trong m\u1ed7i h\u00ecnh vu\u00f4ng n\u00e0y, kho\u1ea3ng c\u00e1ch gi\u1eefa b\u1ea5t k\u1ef3 hai \u0111i\u1ec3m n\u00e0o \u00edt nh\u1ea5t l\u00e0 $h$.</p> <p>Ch\u00fang ta ch\u1ec9 ra r\u1eb1ng c\u00f3 t\u1ed1i \u0111a b\u1ed1n \u0111i\u1ec3m trong m\u1ed7i h\u00ecnh vu\u00f4ng. V\u00ed d\u1ee5, \u0111i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n nh\u01b0 sau: chia h\u00ecnh vu\u00f4ng th\u00e0nh $4$ h\u00ecnh vu\u00f4ng con v\u1edbi c\u00e1c c\u1ea1nh $h/2$. Khi \u0111\u00f3 kh\u00f4ng th\u1ec3 c\u00f3 nhi\u1ec1u h\u01a1n m\u1ed9t \u0111i\u1ec3m trong m\u1ed7i h\u00ecnh vu\u00f4ng con n\u00e0y (v\u00ec ngay c\u1ea3 \u0111\u01b0\u1eddng ch\u00e9o c\u0169ng b\u1eb1ng $h / \\sqrt{2}$, nh\u1ecf h\u01a1n $h$). Do \u0111\u00f3, kh\u00f4ng th\u1ec3 c\u00f3 nhi\u1ec1u h\u01a1n $4$ \u0111i\u1ec3m trong to\u00e0n b\u1ed9 h\u00ecnh vu\u00f4ng.</p> <p>V\u00ec v\u1eady, ch\u00fang ta \u0111\u00e3 ch\u1ee9ng minh r\u1eb1ng trong m\u1ed9t h\u00ecnh ch\u1eef nh\u1eadt $2h \\times h$ kh\u00f4ng th\u1ec3 c\u00f3 nhi\u1ec1u h\u01a1n $4 \\cdot 2 = 8$ \u0111i\u1ec3m, v\u00e0 do \u0111\u00f3, k\u00edch th\u01b0\u1edbc c\u1ee7a t\u1eadp h\u1ee3p $C(p_i)$ kh\u00f4ng th\u1ec3 v\u01b0\u1ee3t qu\u00e1 $7$, nh\u01b0 y\u00eau c\u1ea7u.</p>","tags":["Translated"]},{"location":"geometry/nearest_points.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>Ch\u00fang ta gi\u1edbi thi\u1ec7u m\u1ed9t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u \u0111\u1ec3 l\u01b0u tr\u1eef m\u1ed9t \u0111i\u1ec3m (t\u1ecda \u0111\u1ed9 v\u00e0 m\u1ed9t s\u1ed1 c\u1ee7a n\u00f3) v\u00e0 c\u00e1c to\u00e1n t\u1eed so s\u00e1nh c\u1ea7n thi\u1ebft cho hai lo\u1ea1i s\u1eafp x\u1ebfp:</p> <pre><code>struct pt {\n    int x, y, id;\n};\n\nstruct cmp_x {\n    bool operator()(const pt &amp; a, const pt &amp; b) const {\n        return a.x &lt; b.x || (a.x == b.x &amp;&amp; a.y &lt; b.y);\n    }\n};\n\nstruct cmp_y {\n    bool operator()(const pt &amp; a, const pt &amp; b) const {\n        return a.y &lt; b.y;\n    }\n};\n\nint n;\nvector&lt;pt&gt; a;\n</code></pre> <p>\u0110\u1ec3 c\u00e0i \u0111\u1eb7t thu\u1eadn ti\u1ec7n \u0111\u1ec7 quy, ch\u00fang ta gi\u1edbi thi\u1ec7u m\u1ed9t h\u00e0m ph\u1ee5 tr\u1ee3 <code>upd_ans()</code>, s\u1ebd t\u00ednh to\u00e1n kho\u1ea3ng c\u00e1ch gi\u1eefa hai \u0111i\u1ec3m v\u00e0 ki\u1ec3m tra xem n\u00f3 c\u00f3 t\u1ed1t h\u01a1n c\u00e2u tr\u1ea3 l\u1eddi hi\u1ec7n t\u1ea1i hay kh\u00f4ng:</p> <pre><code>double mindist;\npair&lt;int, int&gt; best_pair;\n\nvoid upd_ans(const pt &amp; a, const pt &amp; b) {\n    double dist = sqrt((a.x - b.x)*(a.x - b.x) + (a.y - b.y)*(a.y - b.y));\n    if (dist &lt; mindist) {\n        mindist = dist;\n        best_pair = {a.id, b.id};\n    }\n}\n</code></pre> <p>Cu\u1ed1i c\u00f9ng, vi\u1ec7c c\u00e0i \u0111\u1eb7t \u0111\u1ec7 quy ch\u00ednh n\u00f3. Gi\u1ea3 s\u1eed r\u1eb1ng tr\u01b0\u1edbc khi g\u1ecdi n\u00f3, m\u1ea3ng $a[]$ \u0111\u00e3 \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp theo t\u1ecda \u0111\u1ed9 $x$. Trong \u0111\u1ec7 quy, ch\u00fang ta ch\u1ec9 truy\u1ec1n hai con tr\u1ecf $l, r$, cho bi\u1ebft r\u1eb1ng n\u00f3 n\u00ean t\u00ecm c\u00e2u tr\u1ea3 l\u1eddi cho $a[l \\ldots r)$. N\u1ebfu kho\u1ea3ng c\u00e1ch gi\u1eefa $r$ v\u00e0 $l$ qu\u00e1 nh\u1ecf, \u0111\u1ec7 quy ph\u1ea3i d\u1eebng l\u1ea1i, v\u00e0 th\u1ef1c hi\u1ec7n m\u1ed9t thu\u1eadt to\u00e1n t\u1ea7m th\u01b0\u1eddng \u0111\u1ec3 t\u00ecm c\u1eb7p g\u1ea7n nh\u1ea5t v\u00e0 sau \u0111\u00f3 s\u1eafp x\u1ebfp m\u1ea3ng con theo t\u1ecda \u0111\u1ed9 $y$.</p> <p>\u0110\u1ec3 h\u1ee3p nh\u1ea5t hai t\u1eadp h\u1ee3p \u0111i\u1ec3m nh\u1eadn \u0111\u01b0\u1ee3c t\u1eeb c\u00e1c l\u1ec7nh g\u1ecdi \u0111\u1ec7 quy th\u00e0nh m\u1ed9t (\u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp theo t\u1ecda \u0111\u1ed9 $y$), ch\u00fang ta s\u1eed d\u1ee5ng h\u00e0m <code>merge()</code> ti\u00eau chu\u1ea9n c\u1ee7a STL, v\u00e0 t\u1ea1o m\u1ed9t b\u1ed9 \u0111\u1ec7m ph\u1ee5 tr\u1ee3 $t[]$ (m\u1ed9t cho t\u1ea5t c\u1ea3 c\u00e1c l\u1ec7nh g\u1ecdi \u0111\u1ec7 quy). (S\u1eed d\u1ee5ng <code>inplace_merge()</code> l\u00e0 kh\u00f4ng th\u1ef1c t\u1ebf v\u00ec n\u00f3 th\u01b0\u1eddng kh\u00f4ng ho\u1ea1t \u0111\u1ed9ng trong th\u1eddi gian tuy\u1ebfn t\u00ednh.)</p> <p>Cu\u1ed1i c\u00f9ng, t\u1eadp h\u1ee3p $B$ \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef trong c\u00f9ng m\u1ea3ng $t$.</p> <pre><code>vector&lt;pt&gt; t;\n\nvoid rec(int l, int r) {\n    if (r - l &lt;= 3) {\n        for (int i = l; i &lt; r; ++i) {\n            for (int j = i + 1; j &lt; r; ++j) {\n                upd_ans(a[i], a[j]);\n            }\n        }\n        sort(a.begin() + l, a.begin() + r, cmp_y());\n        return;\n    }\n\n    int m = (l + r) &gt;&gt; 1;\n    int midx = a[m].x;\n    rec(l, m);\n    rec(m, r);\n\n    merge(a.begin() + l, a.begin() + m, a.begin() + m, a.begin() + r, t.begin(), cmp_y());\n    copy(t.begin(), t.begin() + r - l, a.begin() + l);\n\n    int tsz = 0;\n    for (int i = l; i &lt; r; ++i) {\n        if (abs(a[i].x - midx) &lt; mindist) {\n            for (int j = tsz - 1; j &gt;= 0 &amp;&amp; a[i].y - t[j].y &lt; mindist; --j)\n                upd_ans(a[i], t[j]);\n            t[tsz++] = a[i];\n        }\n    }\n}\n</code></pre> <p>Nh\u00e2n ti\u1ec7n, n\u1ebfu t\u1ea5t c\u1ea3 c\u00e1c t\u1ecda \u0111\u1ed9 l\u00e0 s\u1ed1 nguy\u00ean, th\u00ec t\u1ea1i th\u1eddi \u0111i\u1ec3m \u0111\u1ec7 quy b\u1ea1n kh\u00f4ng th\u1ec3 chuy\u1ec3n sang c\u00e1c gi\u00e1 tr\u1ecb ph\u00e2n s\u1ed1, v\u00e0 l\u01b0u tr\u1eef trong $mindist$ b\u00ecnh ph\u01b0\u01a1ng c\u1ee7a kho\u1ea3ng c\u00e1ch t\u1ed1i thi\u1ec3u.</p> <p>Trong ch\u01b0\u01a1ng tr\u00ecnh ch\u00ednh, \u0111\u1ec7 quy n\u00ean \u0111\u01b0\u1ee3c g\u1ecdi nh\u01b0 sau:</p> <pre><code>t.resize(n);\nsort(a.begin(), a.end(), cmp_x());\nmindist = 1E20;\nrec(0, n);\n</code></pre>","tags":["Translated"]},{"location":"geometry/nearest_points.html#linear-time-randomized-algorithms","title":"C\u00e1c thu\u1eadt to\u00e1n ng\u1eabu nhi\u00ean th\u1eddi gian tuy\u1ebfn t\u00ednh (Linear time randomized algorithms)","text":"","tags":["Translated"]},{"location":"geometry/nearest_points.html#a-randomized-algorithm-with-linear-expected-time","title":"M\u1ed9t thu\u1eadt to\u00e1n ng\u1eabu nhi\u00ean v\u1edbi th\u1eddi gian k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh (A randomized algorithm with linear expected time)","text":"<p>M\u1ed9t ph\u01b0\u01a1ng ph\u00e1p thay th\u1ebf, ban \u0111\u1ea7u \u0111\u01b0\u1ee3c \u0111\u1ec1 xu\u1ea5t b\u1edfi Rabin v\u00e0o n\u0103m 1976, n\u1ea3y sinh t\u1eeb m\u1ed9t \u00fd t\u01b0\u1edfng r\u1ea5t \u0111\u01a1n gi\u1ea3n \u0111\u1ec3 c\u1ea3i thi\u1ec7n th\u1eddi gian ch\u1ea1y theo kinh nghi\u1ec7m: Ch\u00fang ta c\u00f3 th\u1ec3 chia m\u1eb7t ph\u1eb3ng th\u00e0nh m\u1ed9t l\u01b0\u1edbi c\u00e1c h\u00ecnh vu\u00f4ng $d \\times d$, sau \u0111\u00f3 ch\u1ec9 c\u1ea7n ki\u1ec3m tra kho\u1ea3ng c\u00e1ch gi\u1eefa c\u00e1c \u0111i\u1ec3m c\u00f9ng kh\u1ed1i ho\u1eb7c kh\u1ed1i li\u1ec1n k\u1ec1 (tr\u1eeb khi t\u1ea5t c\u1ea3 c\u00e1c h\u00ecnh vu\u00f4ng \u0111\u1ec1u b\u1ecb ng\u1eaft k\u1ebft n\u1ed1i v\u1edbi nhau, nh\u01b0ng ch\u00fang ta s\u1ebd tr\u00e1nh \u0111i\u1ec1u n\u00e0y b\u1eb1ng thi\u1ebft k\u1ebf), v\u00ec b\u1ea5t k\u1ef3 c\u1eb7p n\u00e0o kh\u00e1c \u0111\u1ec1u c\u00f3 kho\u1ea3ng c\u00e1ch l\u1edbn h\u01a1n hai \u0111i\u1ec3m trong c\u00f9ng m\u1ed9t h\u00ecnh vu\u00f4ng.</p> <p>Ch\u00fang ta s\u1ebd ch\u1ec9 xem x\u00e9t c\u00e1c h\u00ecnh vu\u00f4ng ch\u1ee9a \u00edt nh\u1ea5t m\u1ed9t \u0111i\u1ec3m. K\u00fd hi\u1ec7u $n_1, n_2, \\dots, n_k$ l\u00e0 s\u1ed1 l\u01b0\u1ee3ng \u0111i\u1ec3m trong m\u1ed7i h\u00ecnh vu\u00f4ng trong s\u1ed1 $k$ h\u00ecnh vu\u00f4ng c\u00f2n l\u1ea1i. Gi\u1ea3 s\u1eed c\u00f3 \u00edt nh\u1ea5t hai \u0111i\u1ec3m n\u1eb1m trong c\u00f9ng m\u1ed9t h\u00ecnh vu\u00f4ng ho\u1eb7c trong c\u00e1c h\u00ecnh vu\u00f4ng li\u1ec1n k\u1ec1, v\u00e0 kh\u00f4ng c\u00f3 \u0111i\u1ec3m tr\u00f9ng l\u1eb7p, \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian l\u00e0 $\\Theta\\!\\left(\\sum\\limits_{i=1}^k n_i^2\\right)$. Ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm c\u00e1c \u0111i\u1ec3m tr\u00f9ng l\u1eb7p trong th\u1eddi gian k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng b\u1ea3ng b\u0103m, v\u00e0 trong tr\u01b0\u1eddng h\u1ee3p kh\u1eb3ng \u0111\u1ecbnh, c\u00e2u tr\u1ea3 l\u1eddi l\u00e0 c\u1eb7p n\u00e0y.</p> Minh ch\u1ee9ng (Proof) <p>\u0110\u1ed1i v\u1edbi h\u00ecnh vu\u00f4ng th\u1ee9 $i$ ch\u1ee9a $n_i$ \u0111i\u1ec3m, s\u1ed1 l\u01b0\u1ee3ng c\u1eb7p b\u00ean trong l\u00e0 $\\Theta(n_i^2)$. N\u1ebfu h\u00ecnh vu\u00f4ng th\u1ee9 $i$ li\u1ec1n k\u1ec1 v\u1edbi h\u00ecnh vu\u00f4ng th\u1ee9 $j$, th\u00ec ch\u00fang ta c\u0169ng th\u1ef1c hi\u1ec7n $n_i n_j \\le \\max(n_i, n_j)^2 \\le n_i^2 + n_j^2$ ph\u00e9p so s\u00e1nh kho\u1ea3ng c\u00e1ch. L\u01b0u \u00fd r\u1eb1ng m\u1ed7i h\u00ecnh vu\u00f4ng c\u00f3 t\u1ed1i \u0111a $8$ h\u00ecnh vu\u00f4ng li\u1ec1n k\u1ec1, v\u00ec v\u1eady ch\u00fang ta c\u00f3 th\u1ec3 gi\u1edbi h\u1ea1n t\u1ed5ng c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c ph\u00e9p so s\u00e1nh b\u1eb1ng $\\Theta(\\sum_{i=1}^{k} n_i^2)$. $\\quad \\blacksquare$</p> <p>B\u00e2y gi\u1edd ch\u00fang ta c\u1ea7n quy\u1ebft \u0111\u1ecbnh c\u00e1ch \u0111\u1eb7t $d$ sao cho n\u00f3 gi\u1ea3m thi\u1ec3u $\\Theta\\!\\left(\\sum\\limits_{i=1}^k n_i^2\\right)$.</p>","tags":["Translated"]},{"location":"geometry/nearest_points.html#choosing-d","title":"Ch\u1ecdn d (Choosing d)","text":"<p>Ch\u00fang ta c\u1ea7n $d$ l\u00e0 m\u1ed9t x\u1ea5p x\u1ec9 c\u1ee7a kho\u1ea3ng c\u00e1ch t\u1ed1i thi\u1ec3u $d$. Richard Lipton \u0111\u00e3 \u0111\u1ec1 xu\u1ea5t l\u1ea5y m\u1eabu $n$ kho\u1ea3ng c\u00e1ch ng\u1eabu nhi\u00ean v\u00e0 ch\u1ecdn $d$ l\u00e0 kho\u1ea3ng c\u00e1ch nh\u1ecf nh\u1ea5t trong s\u1ed1 c\u00e1c kho\u1ea3ng c\u00e1ch n\u00e0y l\u00e0m x\u1ea5p x\u1ec9 cho $d$. B\u00e2y gi\u1edd ch\u00fang ta ch\u1ee9ng minh r\u1eb1ng th\u1eddi gian ch\u1ea1y k\u1ef3 v\u1ecdng c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 tuy\u1ebfn t\u00ednh.</p> Minh ch\u1ee9ng (Proof) <p>H\u00e3y t\u01b0\u1edfng t\u01b0\u1ee3ng s\u1ef1 s\u1eafp x\u1ebfp c\u1ee7a c\u00e1c \u0111i\u1ec3m trong c\u00e1c h\u00ecnh vu\u00f4ng v\u1edbi m\u1ed9t l\u1ef1a ch\u1ecdn c\u1ee5 th\u1ec3 c\u1ee7a $d$, gi\u1ea3 s\u1eed $x$. Coi $d$ l\u00e0 m\u1ed9t bi\u1ebfn ng\u1eabu nhi\u00ean, k\u1ebft qu\u1ea3 t\u1eeb vi\u1ec7c l\u1ea5y m\u1eabu kho\u1ea3ng c\u00e1ch c\u1ee7a ch\u00fang ta. H\u00e3y \u0111\u1ecbnh ngh\u0129a $C(x) := \\sum_{i=1}^{k(x)} n_i(x)^2$ l\u00e0 \u01b0\u1edbc t\u00ednh chi ph\u00ed cho m\u1ed9t s\u1ef1 s\u1eafp x\u1ebfp c\u1ee5 th\u1ec3 khi ch\u00fang ta ch\u1ecdn $d=x$. B\u00e2y gi\u1edd, h\u00e3y \u0111\u1ecbnh ngh\u0129a $\\lambda(x)$ sao cho $C(x) = \\lambda(x) \\, n$. X\u00e1c su\u1ea5t \u0111\u1ec3 m\u1ed9t l\u1ef1a ch\u1ecdn $x$ nh\u01b0 v\u1eady t\u1ed3n t\u1ea1i sau khi l\u1ea5y m\u1eabu $n$ kho\u1ea3ng c\u00e1ch \u0111\u1ed9c l\u1eadp l\u00e0 bao nhi\u00eau? N\u1ebfu m\u1ed9t c\u1eb7p duy nh\u1ea5t trong s\u1ed1 c\u00e1c c\u1eb7p \u0111\u01b0\u1ee3c l\u1ea5y m\u1eabu c\u00f3 kho\u1ea3ng c\u00e1ch nh\u1ecf h\u01a1n $x$, s\u1ef1 s\u1eafp x\u1ebfp n\u00e0y s\u1ebd \u0111\u01b0\u1ee3c thay th\u1ebf b\u1eb1ng $d$ nh\u1ecf h\u01a1n. B\u00ean trong m\u1ed9t h\u00ecnh vu\u00f4ng, kho\u1ea3ng $1/16$ c\u00e1c c\u1eb7p s\u1ebd t\u1ea1o ra m\u1ed9t kho\u1ea3ng c\u00e1ch nh\u1ecf h\u01a1n (h\u00e3y t\u01b0\u1edfng t\u01b0\u1ee3ng b\u1ed1n h\u00ecnh vu\u00f4ng con trong m\u1ed7i h\u00ecnh vu\u00f4ng; s\u1eed d\u1ee5ng nguy\u00ean l\u00fd chu\u1ed3ng b\u1ed3 c\u00e2u, \u00edt nh\u1ea5t m\u1ed9t h\u00ecnh vu\u00f4ng con c\u00f3 $n_i/4$ \u0111i\u1ec3m), v\u00ec v\u1eady ch\u00fang ta c\u00f3 kho\u1ea3ng $\\sum_{i=1}^{k} {n_i/4 \\choose 2} \\approx \\sum_{i=1}^{k} \\frac{1}{16} {n_i \\choose 2}$ c\u1eb7p t\u1ea1o ra $d$ cu\u1ed1i c\u00f9ng nh\u1ecf h\u01a1n. \u0110i\u1ec1u n\u00e0y l\u00e0, x\u1ea5p x\u1ec9, $\\frac{1}{32} \\sum_{i=1}^{k} n_i^2 = \\frac{1}{32} \\lambda(x) n$. M\u1eb7t kh\u00e1c, c\u00f3 kho\u1ea3ng $\\frac{1}{2} n^2$ c\u1eb7p c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c l\u1ea5y m\u1eabu. Ch\u00fang ta c\u00f3 x\u00e1c su\u1ea5t l\u1ea5y m\u1eabu m\u1ed9t c\u1eb7p c\u00f3 kho\u1ea3ng c\u00e1ch nh\u1ecf h\u01a1n $x$ \u00edt nh\u1ea5t l\u00e0 (x\u1ea5p x\u1ec9)</p> $$\\frac{\\lambda(x) \\, n / 32}{n^2 / 2} = \\frac{\\lambda(x)/16}{n}$$ <p>v\u00ec v\u1eady x\u00e1c su\u1ea5t c\u00f3 \u00edt nh\u1ea5t m\u1ed9t c\u1eb7p nh\u01b0 v\u1eady \u0111\u01b0\u1ee3c ch\u1ecdn trong $n$ v\u00f2ng (v\u00e0 do \u0111\u00f3 t\u00ecm th\u1ea5y $d$ nh\u1ecf h\u01a1n) l\u00e0</p> $$1 - \\left(1 - \\frac{\\lambda(x)/16}{n}\\right)^n \\ge 1 - e^{-\\lambda(x)/16}$$ <p>(ch\u00fang ta \u0111\u00e3 s\u1eed d\u1ee5ng $(1 + x)^n \\le e^{xn}$ cho b\u1ea5t k\u1ef3 s\u1ed1 th\u1ef1c $x$ n\u00e0o, h\u00e3y ki\u1ec3m tra b\u1ea5t \u0111\u1eb3ng th\u1ee9c Bernoulli).  L\u01b0u \u00fd \u0111i\u1ec1u n\u00e0y ti\u1ebfn t\u1edbi $1$ theo c\u1ea5p s\u1ed1 nh\u00e2n khi $\\lambda(x)$ t\u0103ng. \u0110i\u1ec1u n\u00e0y g\u1ee3i \u00fd r\u1eb1ng $\\lambda$ s\u1ebd nh\u1ecf \u0111\u1ed1i v\u1edbi $d$ \u0111\u01b0\u1ee3c ch\u1ecdn k\u00e9m.</p> <p>Ch\u00fang ta \u0111\u00e3 ch\u1ec9 ra r\u1eb1ng $\\Pr(d \\le x) \\ge 1 - e^{-\\lambda(x)/16}$, ho\u1eb7c t\u01b0\u01a1ng \u0111\u01b0\u01a1ng, $\\Pr(d \\ge x) \\le e^{-\\lambda(x)/16}$. Ch\u00fang ta c\u1ea7n bi\u1ebft $\\Pr(\\lambda(d) \\ge \\text{something})$ \u0111\u1ec3 c\u00f3 th\u1ec3 \u01b0\u1edbc t\u00ednh gi\u00e1 tr\u1ecb k\u1ef3 v\u1ecdng c\u1ee7a n\u00f3. Ch\u00fang ta nh\u1eadn th\u1ea5y r\u1eb1ng $\\lambda(d) \\ge \\lambda(x) \\iff d \\ge x$. \u0110i\u1ec1u n\u00e0y l\u00e0 do vi\u1ec7c l\u00e0m cho c\u00e1c h\u00ecnh vu\u00f4ng nh\u1ecf h\u01a1n ch\u1ec9 l\u00e0m gi\u1ea3m s\u1ed1 l\u01b0\u1ee3ng \u0111i\u1ec3m trong m\u1ed7i h\u00ecnh vu\u00f4ng (chia c\u00e1c \u0111i\u1ec3m v\u00e0o c\u00e1c h\u00ecnh vu\u00f4ng kh\u00e1c), v\u00e0 \u0111i\u1ec1u n\u00e0y ti\u1ebfp t\u1ee5c l\u00e0m gi\u1ea3m t\u1ed5ng b\u00ecnh ph\u01b0\u01a1ng. Do \u0111\u00f3,</p> $$\\Pr(\\lambda(d) \\ge \\lambda(x)) = \\Pr(d \\ge x) \\le e^{-\\lambda(x)/16} \\implies \\Pr(\\lambda(d) \\ge t) \\le e^{-t/16} \\implies \\mathbb{E}[\\lambda(d)] \\le \\int_{0}^{+\\infty} e^{-t/16} \\, \\mathrm{d}t = 16$$ <p>(ch\u00fang ta \u0111\u00e3 s\u1eed d\u1ee5ng $E[X] = \\int_0^{+\\infty} \\Pr(X \\ge x) \\, \\mathrm{d}x$, h\u00e3y ki\u1ec3m tra Stackexchange proof).</p> <p>Cu\u1ed1i c\u00f9ng, $\\mathbb{E}[C(d)] = \\mathbb{E}[\\lambda(d) \\, n] \\le 16n$, v\u00e0 th\u1eddi gian ch\u1ea1y k\u1ef3 v\u1ecdng l\u00e0 $O(n)$, v\u1edbi m\u1ed9t h\u1ec7 s\u1ed1 h\u1eb1ng s\u1ed1 h\u1ee3p l\u00fd. $\\quad \\blacksquare$</p>","tags":["Translated"]},{"location":"geometry/nearest_points.html#implementation-of-the-algorithm","title":"C\u00e0i \u0111\u1eb7t thu\u1eadt to\u00e1n (Implementation of the algorithm)","text":"<p>\u01afu \u0111i\u1ec3m c\u1ee7a thu\u1eadt to\u00e1n n\u00e0y l\u00e0 n\u00f3 \u0111\u01a1n gi\u1ea3n \u0111\u1ec3 th\u1ef1c hi\u1ec7n, nh\u01b0ng v\u1eabn c\u00f3 hi\u1ec7u su\u1ea5t t\u1ed1t trong th\u1ef1c t\u1ebf. \u0110\u1ea7u ti\u00ean ch\u00fang ta l\u1ea5y m\u1eabu $n$ kho\u1ea3ng c\u00e1ch v\u00e0 \u0111\u1eb7t $d$ l\u00e0 gi\u00e1 tr\u1ecb t\u1ed1i thi\u1ec3u c\u1ee7a c\u00e1c kho\u1ea3ng c\u00e1ch. Sau \u0111\u00f3 ch\u00fang ta ch\u00e8n c\u00e1c \u0111i\u1ec3m v\u00e0o c\u00e1c \"kh\u1ed1i\" b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng b\u1ea3ng b\u0103m t\u1eeb t\u1ecda \u0111\u1ed9 2D \u0111\u1ebfn m\u1ed9t vector c\u00e1c \u0111i\u1ec3m. Cu\u1ed1i c\u00f9ng, ch\u1ec9 c\u1ea7n t\u00ednh kho\u1ea3ng c\u00e1ch gi\u1eefa c\u00e1c c\u1eb7p c\u00f9ng kh\u1ed1i v\u00e0 c\u00e1c c\u1eb7p kh\u1ed1i li\u1ec1n k\u1ec1. C\u00e1c thao t\u00e1c b\u1ea3ng b\u0103m c\u00f3 chi ph\u00ed th\u1eddi gian k\u1ef3 v\u1ecdng $O(1)$, v\u00e0 do \u0111\u00f3 thu\u1eadt to\u00e1n c\u1ee7a ch\u00fang ta gi\u1eef chi ph\u00ed th\u1eddi gian k\u1ef3 v\u1ecdng $O(n)$ v\u1edbi m\u1ed9t h\u1eb1ng s\u1ed1 t\u0103ng l\u00ean.</p> <p>Ki\u1ec3m tra b\u00e0i n\u1ed9p n\u00e0y l\u00ean Library Checker.</p> <pre><code>#include &lt;bits/stdc++.h&gt;\nusing namespace std;\n\n\nusing ll = long long;\nusing ld = long double;\n\n\nstruct pt {\n    ll x, y;\n    pt() {}\n    pt(ll x_, ll y_) : x(x_), y(y_) {}\n    void read() {\n        cin &gt;&gt; x &gt;&gt; y;\n    }\n};\n\nbool operator==(const pt&amp; a, const pt&amp; b) {\n    return a.x == b.x and a.y == b.y;\n}\n\n\nstruct CustomHashPoint {\n    size_t operator()(const pt&amp; p) const {\n        static const uint64_t C = chrono::steady_clock::now().time_since_epoch().count();\n        return C ^ ((p.x &lt;&lt; 32) ^ p.y);\n    }\n};\n\n\nll dist2(pt a, pt b) {\n    ll dx = a.x - b.x;\n    ll dy = a.y - b.y;\n    return dx*dx + dy*dy;\n}\n\n\npair&lt;int,int&gt; closest_pair_of_points(vector&lt;pt&gt; P) {\n    int n = int(P.size());\n    assert(n &gt;= 2);\n\n    // if there is a duplicated point, we have the solution\n    unordered_map&lt;pt,int,CustomHashPoint&gt; previous;\n    for (int i = 0; i &lt; int(P.size()); ++i) {\n        auto it = previous.find(P[i]);\n        if (it != previous.end()) {\n            return {it-&gt;second, i};\n        }\n        previous[P[i]] = i;\n    }\n\n    unordered_map&lt;pt,vector&lt;int&gt;,CustomHashPoint&gt; grid;\n    grid.reserve(n);\n\n    mt19937 rd(chrono::system_clock::now().time_since_epoch().count());\n    uniform_int_distribution&lt;int&gt; dis(0, n-1);\n\n    ll d2 = dist2(P[0], P[1]);\n    pair&lt;int,int&gt; closest = {0, 1};\n\n    auto candidate_closest = [&amp;](int i, int j) -&gt; void {\n        ll ab2 = dist2(P[i], P[j]);\n        if (ab2 &lt; d2) {\n            d2 = ab2;\n            closest = {i, j};\n        }\n    };\n\n    for (int i = 0; i &lt; n; ++i) {\n        int j = dis(rd);\n        int k = dis(rd);\n        while (j == k) k = dis(rd);\n        candidate_closest(j, k);\n    }\n\n    ll d = ll( sqrt(ld(d2)) + 1 );\n\n    for (int i = 0; i &lt; n; ++i) {\n        grid[{P[i].x/d, P[i].y/d}].push_back(i);\n    }\n\n    // same block\n    for (const auto&amp; it : grid) {\n        int k = int(it.second.size());\n        for (int i = 0; i &lt; k; ++i) {\n            for (int j = i+1; j &lt; k; ++j) {\n                candidate_closest(it.second[i], it.second[j]);\n            }\n        }\n    }\n\n    // adjacent blocks\n    for (const auto&amp; it : grid) {\n        auto coord = it.first;\n        for (int dx = 0; dx &lt;= 1; ++dx) {\n            for (int dy = -1; dy &lt;= 1; ++dy) {\n                if (dx == 0 and dy == 0) continue;\n                pt neighbour = pt(\n                    coord.x  + dx, \n                    coord.y + dy\n                );\n                for (int i : it.second) {\n                    if (not grid.count(neighbour)) continue;\n                    for (int j : grid.at(neighbour)) {\n                        candidate_closest(i, j);\n                    }\n                }\n            }\n        }\n    }\n\n    return closest;\n}\n</code></pre>","tags":["Translated"]},{"location":"geometry/nearest_points.html#an-alternative-randomized-linear-expected-time-algorithm","title":"M\u1ed9t thu\u1eadt to\u00e1n th\u1eddi gian k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh ng\u1eabu nhi\u00ean thay th\u1ebf (An alternative randomized linear expected time algorithm)","text":"<p>B\u00e2y gi\u1edd ch\u00fang t\u00f4i gi\u1edbi thi\u1ec7u m\u1ed9t thu\u1eadt to\u00e1n ng\u1eabu nhi\u00ean kh\u00e1c \u00edt th\u1ef1c t\u1ebf h\u01a1n nh\u01b0ng r\u1ea5t d\u1ec5 ch\u1ee9ng minh r\u1eb1ng n\u00f3 ch\u1ea1y trong th\u1eddi gian k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh.</p> <ul> <li>Ho\u00e1n v\u1ecb $n$ \u0111i\u1ec3m m\u1ed9t c\u00e1ch ng\u1eabu nhi\u00ean</li> <li>L\u1ea5y $\\delta := \\operatorname{dist}(p_1, p_2)$</li> <li>Ph\u00e2n chia m\u1eb7t ph\u1eb3ng th\u00e0nh c\u00e1c h\u00ecnh vu\u00f4ng c\u00f3 c\u1ea1nh $\\delta/2$</li> <li>V\u1ee1i $i = 1,2,\\dots,n$:<ul> <li>L\u1ea5y h\u00ecnh vu\u00f4ng t\u01b0\u01a1ng \u1ee9ng v\u1edbi $p_i$</li> <li>L\u1eb7p qua $25$ h\u00ecnh vu\u00f4ng trong v\u00f2ng hai b\u01b0\u1edbc \u0111\u1ebfn h\u00ecnh vu\u00f4ng c\u1ee7a ch\u00fang ta trong l\u01b0\u1edbi c\u00e1c h\u00ecnh vu\u00f4ng ph\u00e2n chia m\u1eb7t ph\u1eb3ng</li> <li>N\u1ebfu m\u1ed9t s\u1ed1 $p_j$ trong c\u00e1c h\u00ecnh vu\u00f4ng \u0111\u00f3 c\u00f3 $\\operatorname{dist}(p_j, p_i) &lt; \\delta$, th\u00ec<ul> <li>T\u00ednh to\u00e1n l\u1ea1i ph\u00e2n v\u00f9ng v\u00e0 c\u00e1c h\u00ecnh vu\u00f4ng v\u1edbi $\\delta := \\operatorname{dist}(p_j, p_i)$</li> <li>L\u01b0u tr\u1eef c\u00e1c \u0111i\u1ec3m $p_1, \\dots, p_i$ trong c\u00e1c h\u00ecnh vu\u00f4ng t\u01b0\u01a1ng \u1ee9ng</li> </ul> </li> <li>ng\u01b0\u1ee3c l\u1ea1i, l\u01b0u tr\u1eef $p_i$ trong h\u00ecnh vu\u00f4ng t\u01b0\u01a1ng \u1ee9ng</li> </ul> </li> <li>\u0111\u1ea7u ra $\\delta$</li> </ul> <p>T\u00ednh \u0111\u00fang \u0111\u1eafn tu\u00e2n theo th\u1ef1c t\u1ebf l\u00e0 t\u1ea1i b\u1ea5t k\u1ef3 th\u1eddi \u0111i\u1ec3m n\u00e0o ch\u00fang ta \u0111\u00e3 c\u00f3 m\u1ed9t c\u1eb7p n\u00e0o \u0111\u00f3 v\u1edbi kho\u1ea3ng c\u00e1ch $\\delta$, v\u00ec v\u1eady ch\u00fang ta c\u1ed1 g\u1eafng t\u00ecm ch\u1ec9 c\u00e1c c\u1eb7p m\u1edbi v\u1edbi kho\u1ea3ng c\u00e1ch nh\u1ecf h\u01a1n $\\delta$. V\u00ec m\u1ed7i h\u00ecnh vu\u00f4ng c\u00f3 c\u1ea1nh $\\delta/2$, m\u1ed9t c\u1eb7p \u1ee9ng vi\u00ean c\u00f3 th\u1ec3 \u1edf t\u1ed1i \u0111a m\u1ed9t kho\u1ea3ng c\u00e1ch c\u1ee7a $2$ h\u00ecnh vu\u00f4ng, v\u00ec v\u1eady \u0111\u1ed1i v\u1edbi m\u1ed9t \u0111i\u1ec3m nh\u1ea5t \u0111\u1ecbnh, ch\u00fang ta ki\u1ec3m tra c\u00e1c \u1ee9ng vi\u00ean trong $25$ h\u00ecnh vu\u00f4ng xung quanh. B\u1ea5t k\u1ef3 \u0111i\u1ec3m n\u00e0o trong m\u1ed9t h\u00ecnh vu\u00f4ng xa h\u01a1n s\u1ebd lu\u00f4n cho kho\u1ea3ng c\u00e1ch l\u1edbn h\u01a1n $\\delta$.</p> <p>M\u1eb7c d\u00f9 thu\u1eadt to\u00e1n n\u00e0y c\u00f3 th\u1ec3 tr\u00f4ng ch\u1eadm, v\u00ec ph\u1ea3i t\u00ednh to\u00e1n l\u1ea1i m\u1ecdi th\u1ee9 nhi\u1ec1u l\u1ea7n, ch\u00fang ta c\u00f3 th\u1ec3 ch\u1ec9 ra r\u1eb1ng t\u1ed5ng chi ph\u00ed k\u1ef3 v\u1ecdng l\u00e0 tuy\u1ebfn t\u00ednh.</p> Minh ch\u1ee9ng (Proof) <p>G\u1ecdi $X_i$ l\u00e0 bi\u1ebfn ng\u1eabu nhi\u00ean b\u1eb1ng $1$ khi \u0111i\u1ec3m $p_i$ g\u00e2y ra s\u1ef1 thay \u0111\u1ed5i c\u1ee7a $\\delta$ v\u00e0 t\u00ednh to\u00e1n l\u1ea1i c\u00e1c c\u1ea5u tr\u00fac d\u1eef li\u1ec7u, v\u00e0 $0$ n\u1ebfu kh\u00f4ng. D\u1ec5 d\u00e0ng ch\u1ec9 ra r\u1eb1ng chi ph\u00ed l\u00e0 $O(n + \\sum_{i=1}^{n} i X_i)$, v\u00ec \u1edf b\u01b0\u1edbc th\u1ee9 $i$ ch\u00fang ta ch\u1ec9 xem x\u00e9t $i$ \u0111i\u1ec3m \u0111\u1ea7u ti\u00ean. Tuy nhi\u00ean, h\u00f3a ra $\\Pr(X_i = 1) \\le \\frac{2}{i}$. \u0110i\u1ec1u n\u00e0y l\u00e0 do \u1edf b\u01b0\u1edbc th\u1ee9 $i$, $\\delta$ l\u00e0 kho\u1ea3ng c\u00e1ch c\u1ee7a c\u1eb7p g\u1ea7n nh\u1ea5t trong $\\{p_1,\\dots,p_i\\}$, v\u00e0 $\\Pr(X_i = 1)$ l\u00e0 x\u00e1c su\u1ea5t c\u1ee7a $p_i$ thu\u1ed9c v\u1ec1 c\u1eb7p g\u1ea7n nh\u1ea5t, \u0111i\u1ec1u n\u00e0y ch\u1ec9 x\u1ea3y ra trong $2(i-1)$ c\u1eb7p trong s\u1ed1 $i(i-1)$ c\u1eb7p c\u00f3 th\u1ec3 (gi\u1ea3 s\u1eed t\u1ea5t c\u1ea3 c\u00e1c kho\u1ea3ng c\u00e1ch l\u00e0 kh\u00e1c nhau), v\u00ec v\u1eady x\u00e1c su\u1ea5t t\u1ed1i \u0111a l\u00e0 $\\frac{2(i-1)}{i(i-1)} = \\frac{2}{i}$, v\u00ec ch\u00fang ta \u0111\u00e3 x\u00e1o tr\u1ed9n c\u00e1c \u0111i\u1ec3m m\u1ed9t c\u00e1ch \u0111\u1ed3ng \u0111\u1ec1u tr\u01b0\u1edbc \u0111\u00f3.</p> <p>Do \u0111\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 th\u1ea5y r\u1eb1ng chi ph\u00ed k\u1ef3 v\u1ecdng l\u00e0</p> $$O\\!\\left(n + \\sum_{i=1}^{n} i \\Pr(X_i = 1)\\right) \\le O\\!\\left(n + \\sum_{i=1}^{n} i \\frac{2}{i}\\right) = O(3n) = O(n) \\quad \\quad \\blacksquare$$","tags":["Translated"]},{"location":"geometry/nearest_points.html#generalization-finding-a-triangle-with-minimal-perimeter","title":"T\u1ed5ng qu\u00e1t h\u00f3a: t\u00ecm m\u1ed9t tam gi\u00e1c c\u00f3 chu vi t\u1ed1i thi\u1ec3u (Generalization: finding a triangle with minimal perimeter)","text":"<p>Thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 \u1edf tr\u00ean \u0111\u01b0\u1ee3c t\u1ed5ng qu\u00e1t h\u00f3a m\u1ed9t c\u00e1ch th\u00fa v\u1ecb cho b\u00e0i to\u00e1n n\u00e0y: trong s\u1ed1 m\u1ed9t t\u1eadp h\u1ee3p c\u00e1c \u0111i\u1ec3m \u0111\u00e3 cho, ch\u1ecdn ba \u0111i\u1ec3m kh\u00e1c nhau sao cho t\u1ed5ng kho\u1ea3ng c\u00e1ch t\u1eebng \u0111\u00f4i gi\u1eefa ch\u00fang l\u00e0 nh\u1ecf nh\u1ea5t.</p> <p>Tr\u00ean th\u1ef1c t\u1ebf, \u0111\u1ec3 gi\u1ea3i quy\u1ebft b\u00e0i to\u00e1n n\u00e0y, thu\u1eadt to\u00e1n v\u1eabn gi\u1eef nguy\u00ean: ch\u00fang ta chia tr\u01b0\u1eddng th\u00e0nh hai n\u1eeda c\u1ee7a \u0111\u01b0\u1eddng th\u1eb3ng \u0111\u1ee9ng, g\u1ecdi gi\u1ea3i ph\u00e1p m\u1ed9t c\u00e1ch \u0111\u1ec7 quy tr\u00ean c\u1ea3 hai n\u1eeda, ch\u1ecdn $minper$ t\u1ed1i thi\u1ec3u t\u1eeb c\u00e1c chu vi \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y, x\u00e2y d\u1ef1ng m\u1ed9t d\u1ea3i c\u00f3 \u0111\u1ed9 d\u00e0y $minper / 2$, v\u00e0 l\u1eb7p qua t\u1ea5t c\u1ea3 c\u00e1c tam gi\u00e1c c\u00f3 th\u1ec3 c\u1ea3i thi\u1ec7n c\u00e2u tr\u1ea3 l\u1eddi. (L\u01b0u \u00fd r\u1eb1ng tam gi\u00e1c c\u00f3 chu vi $\\le minper$ c\u00f3 c\u1ea1nh d\u00e0i nh\u1ea5t $\\le minper / 2$.)</p>","tags":["Translated"]},{"location":"geometry/nearest_points.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice problems)","text":"<ul> <li>UVA 10245 \"The Closest Pair Problem\" [difficulty: low]</li> <li>SPOJ #8725 CLOPPAIR \"Closest Point Pair\" [difficulty: low]</li> <li>CODEFORCES Team Olympiad Saratov - 2011 \"Minimum amount\" [difficulty: medium]</li> <li>Google CodeJam 2009 Final \"Min Perimeter\" [difficulty: medium]</li> <li>SPOJ #7029 CLOSEST \"Closest Triple\" [difficulty: medium]</li> <li>TIMUS 1514 National Park [difficulty: medium]</li> </ul>","tags":["Translated"]},{"location":"geometry/oriented-triangle-area.html","title":"Di\u1ec7n t\u00edch c\u00f3 h\u01b0\u1edbng c\u1ee7a tam gi\u00e1c (Oriented area of a triangle)","text":"<p>Cho ba \u0111i\u1ec3m $p_1$, $p_2$ v\u00e0 $p_3$, t\u00ednh di\u1ec7n t\u00edch c\u00f3 h\u01b0\u1edbng (c\u00f3 d\u1ea5u) c\u1ee7a tam gi\u00e1c \u0111\u01b0\u1ee3c t\u1ea1o b\u1edfi ch\u00fang. D\u1ea5u c\u1ee7a di\u1ec7n t\u00edch \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh theo c\u00e1ch sau: h\u00e3y t\u01b0\u1edfng t\u01b0\u1ee3ng b\u1ea1n \u0111ang \u0111\u1ee9ng trong m\u1eb7t ph\u1eb3ng t\u1ea1i \u0111i\u1ec3m $p_1$ v\u00e0 \u0111ang \u0111\u1ed1i m\u1eb7t v\u1edbi $p_2$. B\u1ea1n \u0111i \u0111\u1ebfn $p_2$ v\u00e0 n\u1ebfu $p_3$ \u1edf b\u00ean ph\u1ea3i c\u1ee7a b\u1ea1n (khi \u0111\u00f3 ch\u00fang ta n\u00f3i ba vector quay \"c\u00f9ng chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3\"), d\u1ea5u c\u1ee7a di\u1ec7n t\u00edch l\u00e0 \u00e2m, ng\u01b0\u1ee3c l\u1ea1i n\u00f3 l\u00e0 d\u01b0\u01a1ng. N\u1ebfu ba \u0111i\u1ec3m th\u1eb3ng h\u00e0ng, di\u1ec7n t\u00edch b\u1eb1ng kh\u00f4ng.</p> <p>S\u1eed d\u1ee5ng di\u1ec7n t\u00edch c\u00f3 d\u1ea5u n\u00e0y, ch\u00fang ta c\u00f3 th\u1ec3 v\u1eeba nh\u1eadn \u0111\u01b0\u1ee3c di\u1ec7n t\u00edch kh\u00f4ng d\u1ea5u th\u00f4ng th\u01b0\u1eddng (nh\u01b0 gi\u00e1 tr\u1ecb tuy\u1ec7t \u0111\u1ed1i c\u1ee7a di\u1ec7n t\u00edch c\u00f3 d\u1ea5u) v\u1eeba x\u00e1c \u0111\u1ecbnh xem c\u00e1c \u0111i\u1ec3m n\u1eb1m c\u00f9ng chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3 hay ng\u01b0\u1ee3c chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3 theo th\u1ee9 t\u1ef1 \u0111\u00e3 ch\u1ec9 \u0111\u1ecbnh c\u1ee7a ch\u00fang (\u0111i\u1ec1u n\u00e0y h\u1eefu \u00edch, v\u00ed d\u1ee5, trong c\u00e1c thu\u1eadt to\u00e1n bao l\u1ed3i).</p>","tags":["Translated"]},{"location":"geometry/oriented-triangle-area.html#calculation","title":"T\u00ednh to\u00e1n (Calculation)","text":"<p>Ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng th\u1ef1c t\u1ebf l\u00e0 \u0111\u1ecbnh th\u1ee9c c\u1ee7a ma tr\u1eadn $2\\times 2$ b\u1eb1ng v\u1edbi di\u1ec7n t\u00edch c\u00f3 d\u1ea5u c\u1ee7a h\u00ecnh b\u00ecnh h\u00e0nh \u0111\u01b0\u1ee3c t\u1ea1o b\u1edfi c\u00e1c vector c\u1ed9t (ho\u1eb7c h\u00e0ng) c\u1ee7a ma tr\u1eadn. \u0110i\u1ec1u n\u00e0y t\u01b0\u01a1ng t\u1ef1 v\u1edbi \u0111\u1ecbnh ngh\u0129a c\u1ee7a t\u00edch c\u00f3 h\u01b0\u1edbng trong 2D (xem H\u00ecnh h\u1ecdc c\u01a1 b\u1ea3n). B\u1eb1ng c\u00e1ch chia di\u1ec7n t\u00edch n\u00e0y cho hai, ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c di\u1ec7n t\u00edch c\u1ee7a tam gi\u00e1c m\u00e0 ch\u00fang ta quan t\u00e2m. Ch\u00fang ta s\u1ebd s\u1eed d\u1ee5ng $\\vec{p_1p_2}$ v\u00e0 $\\vec{p_2p_3}$ l\u00e0m c\u00e1c vector c\u1ed9t v\u00e0 t\u00ednh to\u00e1n \u0111\u1ecbnh th\u1ee9c $2\\times 2$:</p> $$2S=\\left|\\begin{matrix}x_2-x_1 &amp; x_3-x_2\\\\y_2-y_1 &amp; y_3-y_2\\end{matrix}\\right|=(x_2-x_1)(y_3-y_2)-(x_3-x_2)(y_2-y_1)$$","tags":["Translated"]},{"location":"geometry/oriented-triangle-area.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<pre><code>int signed_area_parallelogram(point2d p1, point2d p2, point2d p3) {\n    return cross(p2 - p1, p3 - p2);\n}\n\ndouble triangle_area(point2d p1, point2d p2, point2d p3) {\n    return abs(signed_area_parallelogram(p1, p2, p3)) / 2.0;\n}\n\nbool clockwise(point2d p1, point2d p2, point2d p3) {\n    return signed_area_parallelogram(p1, p2, p3) &lt; 0;\n}\n\nbool counter_clockwise(point2d p1, point2d p2, point2d p3) {\n    return signed_area_parallelogram(p1, p2, p3) &gt; 0;\n}\n</code></pre>","tags":["Translated"]},{"location":"geometry/oriented-triangle-area.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>Codechef - Chef and Polygons</li> </ul>","tags":["Translated"]},{"location":"geometry/picks-theorem.html","title":"\u0110\u1ecbnh l\u00fd Pick (Pick's Theorem)","text":"<p>M\u1ed9t \u0111a gi\u00e1c kh\u00f4ng c\u00f3 s\u1ef1 t\u1ef1 c\u1eaft \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 \u0111a gi\u00e1c nguy\u00ean (lattice polygon) n\u1ebfu t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh c\u1ee7a n\u00f3 c\u00f3 t\u1ecda \u0111\u1ed9 nguy\u00ean trong m\u1ed9t l\u01b0\u1edbi 2D n\u00e0o \u0111\u00f3. \u0110\u1ecbnh l\u00fd Pick cung c\u1ea5p m\u1ed9t c\u00e1ch \u0111\u1ec3 t\u00ednh di\u1ec7n t\u00edch c\u1ee7a \u0111a gi\u00e1c n\u00e0y th\u00f4ng qua s\u1ed1 l\u01b0\u1ee3ng c\u00e1c \u0111\u1ec9nh n\u1eb1m tr\u00ean bi\u00ean v\u00e0 s\u1ed1 l\u01b0\u1ee3ng c\u00e1c \u0111\u1ec9nh n\u1eb1m ho\u00e0n to\u00e0n b\u00ean trong \u0111a gi\u00e1c.</p>","tags":["Translated"]},{"location":"geometry/picks-theorem.html#formula","title":"C\u00f4ng th\u1ee9c (Formula)","text":"<p>Cho m\u1ed9t \u0111a gi\u00e1c nguy\u00ean nh\u1ea5t \u0111\u1ecbnh v\u1edbi di\u1ec7n t\u00edch kh\u00e1c kh\u00f4ng.</p> <p>Ch\u00fang ta k\u00fd hi\u1ec7u di\u1ec7n t\u00edch c\u1ee7a n\u00f3 l\u00e0 $S$, s\u1ed1 l\u01b0\u1ee3ng \u0111i\u1ec3m c\u00f3 t\u1ecda \u0111\u1ed9 nguy\u00ean n\u1eb1m ho\u00e0n to\u00e0n b\u00ean trong \u0111a gi\u00e1c l\u00e0 $I$ v\u00e0 s\u1ed1 l\u01b0\u1ee3ng \u0111i\u1ec3m n\u1eb1m tr\u00ean c\u00e1c c\u1ea1nh c\u1ee7a \u0111a gi\u00e1c l\u00e0 $B$.</p> <p>Khi \u0111\u00f3, C\u00f4ng th\u1ee9c Pick ph\u00e1t bi\u1ec3u r\u1eb1ng:</p> $$S=I+\\frac{B}{2}-1$$ <p>C\u1ee5 th\u1ec3, n\u1ebfu c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a $I$ v\u00e0 $B$ cho m\u1ed9t \u0111a gi\u00e1c \u0111\u01b0\u1ee3c \u0111\u01b0a ra, di\u1ec7n t\u00edch c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n trong $O(1)$ m\u00e0 kh\u00f4ng c\u1ea7n bi\u1ebft c\u00e1c \u0111\u1ec9nh.</p> <p>C\u00f4ng th\u1ee9c n\u00e0y \u0111\u01b0\u1ee3c ph\u00e1t hi\u1ec7n v\u00e0 ch\u1ee9ng minh b\u1edfi nh\u00e0 to\u00e1n h\u1ecdc ng\u01b0\u1eddi \u00c1o Georg Alexander Pick v\u00e0o n\u0103m 1899.</p>","tags":["Translated"]},{"location":"geometry/picks-theorem.html#proof","title":"Ch\u1ee9ng minh (Proof)","text":"<p>Vi\u1ec7c ch\u1ee9ng minh \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n qua nhi\u1ec1u giai \u0111o\u1ea1n: t\u1eeb c\u00e1c \u0111a gi\u00e1c \u0111\u01a1n gi\u1ea3n \u0111\u1ebfn c\u00e1c \u0111a gi\u00e1c t\u00f9y \u00fd:</p> <ul> <li> <p>M\u1ed9t h\u00ecnh vu\u00f4ng \u0111\u01a1n l\u1ebb: $S=1, I=0, B=4$, th\u1ecfa m\u00e3n c\u00f4ng th\u1ee9c.</p> </li> <li> <p>M\u1ed9t h\u00ecnh ch\u1eef nh\u1eadt kh\u00f4ng suy bi\u1ebfn t\u00f9y \u00fd v\u1edbi c\u00e1c c\u1ea1nh song song v\u1edbi c\u00e1c tr\u1ee5c t\u1ecda \u0111\u1ed9: Gi\u1ea3 s\u1eed $a$ v\u00e0 $b$ l\u00e0 \u0111\u1ed9 d\u00e0i c\u00e1c c\u1ea1nh c\u1ee7a h\u00ecnh ch\u1eef nh\u1eadt. Khi \u0111\u00f3, $S=ab, I=(a-1)(b-1), B=2(a+b)$. Khi thay th\u1ebf v\u00e0o, ch\u00fang ta th\u1ea5y r\u1eb1ng c\u00f4ng th\u1ee9c l\u00e0 \u0111\u00fang.</p> </li> <li> <p>M\u1ed9t tam gi\u00e1c vu\u00f4ng v\u1edbi c\u00e1c c\u1ea1nh g\u00f3c vu\u00f4ng song song v\u1edbi c\u00e1c tr\u1ee5c: \u0110\u1ec3 ch\u1ee9ng minh \u0111i\u1ec1u n\u00e0y, l\u01b0u \u00fd r\u1eb1ng b\u1ea5t k\u1ef3 tam gi\u00e1c n\u00e0o nh\u01b0 v\u1eady \u0111\u1ec1u c\u00f3 th\u1ec3 thu \u0111\u01b0\u1ee3c b\u1eb1ng c\u00e1ch c\u1eaft m\u1ed9t h\u00ecnh ch\u1eef nh\u1eadt b\u1eb1ng m\u1ed9t \u0111\u01b0\u1eddng ch\u00e9o. K\u00fd hi\u1ec7u s\u1ed1 l\u01b0\u1ee3ng \u0111i\u1ec3m nguy\u00ean n\u1eb1m tr\u00ean \u0111\u01b0\u1eddng ch\u00e9o l\u00e0 $c$, c\u00f3 th\u1ec3 ch\u1ec9 ra r\u1eb1ng c\u00f4ng th\u1ee9c Pick \u0111\u00fang cho tam gi\u00e1c n\u00e0y b\u1ea5t k\u1ec3 $c$.</p> </li> <li> <p>M\u1ed9t tam gi\u00e1c t\u00f9y \u00fd: L\u01b0u \u00fd r\u1eb1ng b\u1ea5t k\u1ef3 tam gi\u00e1c n\u00e0o nh\u01b0 v\u1eady \u0111\u1ec1u c\u00f3 th\u1ec3 bi\u1ebfn th\u00e0nh h\u00ecnh ch\u1eef nh\u1eadt b\u1eb1ng c\u00e1ch g\u1eafn n\u00f3 v\u00e0o c\u00e1c c\u1ea1nh c\u1ee7a c\u00e1c tam gi\u00e1c vu\u00f4ng c\u00f3 c\u00e1c c\u1ea1nh g\u00f3c vu\u00f4ng song song v\u1edbi c\u00e1c tr\u1ee5c (b\u1ea1n s\u1ebd kh\u00f4ng c\u1ea7n qu\u00e1 3 tam gi\u00e1c nh\u01b0 v\u1eady). T\u1eeb \u0111\u00e2y, ch\u00fang ta c\u00f3 th\u1ec3 nh\u1eadn \u0111\u01b0\u1ee3c c\u00f4ng th\u1ee9c \u0111\u00fang cho b\u1ea5t k\u1ef3 tam gi\u00e1c n\u00e0o.</p> </li> <li> <p>M\u1ed9t \u0111a gi\u00e1c t\u00f9y \u00fd: \u0110\u1ec3 ch\u1ee9ng minh \u0111i\u1ec1u n\u00e0y, h\u00e3y tam gi\u00e1c h\u00f3a n\u00f3, t\u1ee9c l\u00e0, chia th\u00e0nh c\u00e1c tam gi\u00e1c c\u00f3 t\u1ecda \u0111\u1ed9 nguy\u00ean. H\u01a1n n\u1eefa, c\u00f3 th\u1ec3 ch\u1ee9ng minh r\u1eb1ng \u0111\u1ecbnh l\u00fd Pick v\u1eabn gi\u1eef nguy\u00ean t\u00ednh \u0111\u00fang \u0111\u1eafn c\u1ee7a n\u00f3 khi m\u1ed9t \u0111a gi\u00e1c \u0111\u01b0\u1ee3c th\u00eam v\u00e0o m\u1ed9t tam gi\u00e1c. Do \u0111\u00f3, ch\u00fang ta \u0111\u00e3 ch\u1ee9ng minh c\u00f4ng th\u1ee9c Pick cho \u0111a gi\u00e1c t\u00f9y \u00fd.</p> </li> </ul>","tags":["Translated"]},{"location":"geometry/picks-theorem.html#generalization-to-higher-dimensions","title":"T\u1ed5ng qu\u00e1t h\u00f3a cho s\u1ed1 chi\u1ec1u cao h\u01a1n (Generalization to higher dimensions)","text":"<p>Th\u1eadt kh\u00f4ng may, c\u00f4ng th\u1ee9c \u0111\u01a1n gi\u1ea3n v\u00e0 \u0111\u1eb9p \u0111\u1ebd n\u00e0y kh\u00f4ng th\u1ec3 t\u1ed5ng qu\u00e1t h\u00f3a cho c\u00e1c chi\u1ec1u cao h\u01a1n.</p> <p>John Reeve \u0111\u00e3 ch\u1ee9ng minh \u0111i\u1ec1u n\u00e0y b\u1eb1ng c\u00e1ch \u0111\u1ec1 xu\u1ea5t m\u1ed9t t\u1ee9 di\u1ec7n (Reeve tetrahedron) v\u1edbi c\u00e1c \u0111\u1ec9nh sau v\u00e0o n\u0103m 1957:</p> $$A=(0,0,0), B=(1,0,0), C=(0,1,0), D=(1,1,k),$$ <p>trong \u0111\u00f3 $k$ c\u00f3 th\u1ec3 l\u00e0 b\u1ea5t k\u1ef3 s\u1ed1 t\u1ef1 nhi\u00ean n\u00e0o. Khi \u0111\u00f3 v\u1edbi b\u1ea5t k\u1ef3 $k$ n\u00e0o, t\u1ee9 di\u1ec7n $ABCD$ kh\u00f4ng ch\u1ee9a \u0111i\u1ec3m nguy\u00ean b\u00ean trong n\u00f3 v\u00e0 ch\u1ec9 c\u00f3 $4$ \u0111i\u1ec3m tr\u00ean bi\u00ean c\u1ee7a n\u00f3, $A, B, C, D$. Do \u0111\u00f3, th\u1ec3 t\u00edch v\u00e0 di\u1ec7n t\u00edch b\u1ec1 m\u1eb7t c\u00f3 th\u1ec3 thay \u0111\u1ed5i b\u1ea5t ch\u1ea5p s\u1ed1 l\u01b0\u1ee3ng \u0111i\u1ec3m b\u00ean trong v\u00e0 tr\u00ean bi\u00ean kh\u00f4ng thay \u0111\u1ed5i. V\u00ec v\u1eady, \u0111\u1ecbnh l\u00fd Pick kh\u00f4ng cho ph\u00e9p t\u1ed5ng qu\u00e1t h\u00f3a.</p> <p>Tuy nhi\u00ean, c\u00e1c chi\u1ec1u cao h\u01a1n v\u1eabn c\u00f3 s\u1ef1 t\u1ed5ng qu\u00e1t h\u00f3a b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng \u0111a th\u1ee9c Ehrhart nh\u01b0ng ch\u00fang kh\u00e1 ph\u1ee9c t\u1ea1p v\u00e0 kh\u00f4ng ch\u1ec9 ph\u1ee5 thu\u1ed9c v\u00e0o c\u00e1c \u0111i\u1ec3m b\u00ean trong m\u00e0 c\u00f2n ph\u1ee5 thu\u1ed9c v\u00e0o bi\u00ean c\u1ee7a \u0111a di\u1ec7n (polytype).</p>","tags":["Translated"]},{"location":"geometry/picks-theorem.html#extra-resources","title":"T\u00e0i nguy\u00ean b\u1ed5 sung (Extra Resources)","text":"<p>M\u1ed9t v\u00e0i v\u00ed d\u1ee5 \u0111\u01a1n gi\u1ea3n v\u00e0 m\u1ed9t ch\u1ee9ng minh \u0111\u01a1n gi\u1ea3n v\u1ec1 \u0111\u1ecbnh l\u00fd Pick c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y t\u1ea1i \u0111\u00e2y (li\u00ean k\u1ebft g\u1ed1c: t\u1ea1i \u0111\u00e2y).</p> <p>M\u1ed9t v\u00e0i v\u00ed d\u1ee5 \u0111\u01a1n gi\u1ea3n v\u00e0 m\u1ed9t ch\u1ee9ng minh \u0111\u01a1n gi\u1ea3n v\u1ec1 \u0111\u1ecbnh l\u00fd Pick c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y t\u1ea1i \u0111\u00e2y.</p>","tags":["Translated"]},{"location":"geometry/planar.html","title":"T\u00ecm c\u00e1c m\u1eb7t c\u1ee7a \u0111\u1ed3 th\u1ecb ph\u1eb3ng (Finding faces of a planar graph)","text":"<p>Xem x\u00e9t m\u1ed9t \u0111\u1ed3 th\u1ecb $G$ v\u1edbi $n$ \u0111\u1ec9nh v\u00e0 $m$ c\u1ea1nh, c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c v\u1ebd tr\u00ean m\u1ed9t m\u1eb7t ph\u1eb3ng theo c\u00e1ch m\u00e0 hai c\u1ea1nh ch\u1ec9 c\u1eaft nhau t\u1ea1i m\u1ed9t \u0111\u1ec9nh chung (n\u1ebfu n\u00f3 t\u1ed3n t\u1ea1i). C\u00e1c \u0111\u1ed3 th\u1ecb nh\u01b0 v\u1eady \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 \u0111\u1ed3 th\u1ecb ph\u1eb3ng (planar). B\u00e2y gi\u1edd gi\u1ea3 s\u1eed r\u1eb1ng ch\u00fang ta \u0111\u01b0\u1ee3c cho m\u1ed9t \u0111\u1ed3 th\u1ecb ph\u1eb3ng c\u00f9ng v\u1edbi ph\u00e9p nh\u00fang \u0111\u01b0\u1eddng th\u1eb3ng (straight-line embedding) c\u1ee7a n\u00f3, c\u00f3 ngh\u0129a l\u00e0 \u0111\u1ed1i v\u1edbi m\u1ed7i \u0111\u1ec9nh $v$ ch\u00fang ta c\u00f3 m\u1ed9t \u0111i\u1ec3m t\u01b0\u01a1ng \u1ee9ng $(x, y)$ v\u00e0 t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh \u0111\u01b0\u1ee3c v\u1ebd d\u01b0\u1edbi d\u1ea1ng c\u00e1c \u0111o\u1ea1n th\u1eb3ng gi\u1eefa c\u00e1c \u0111i\u1ec3m n\u00e0y m\u00e0 kh\u00f4ng c\u1eaft nhau (ph\u00e9p nh\u00fang nh\u01b0 v\u1eady lu\u00f4n t\u1ed3n t\u1ea1i). C\u00e1c \u0111o\u1ea1n th\u1eb3ng n\u00e0y chia m\u1eb7t ph\u1eb3ng th\u00e0nh m\u1ed9t s\u1ed1 v\u00f9ng, \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 c\u00e1c m\u1eb7t (faces). Ch\u00ednh x\u00e1c m\u1ed9t trong c\u00e1c m\u1eb7t l\u00e0 kh\u00f4ng b\u1ecb gi\u1edbi h\u1ea1n. M\u1eb7t n\u00e0y \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 m\u1eb7t ngo\u00e0i (outer), trong khi c\u00e1c m\u1eb7t kh\u00e1c \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 m\u1eb7t trong (inner).</p> <p>Trong b\u00e0i vi\u1ebft n\u00e0y, ch\u00fang ta s\u1ebd gi\u1ea3i quy\u1ebft vi\u1ec7c t\u00ecm c\u1ea3 m\u1eb7t trong v\u00e0 m\u1eb7t ngo\u00e0i c\u1ee7a m\u1ed9t \u0111\u1ed3 th\u1ecb ph\u1eb3ng. Ch\u00fang ta s\u1ebd gi\u1ea3 s\u1eed r\u1eb1ng \u0111\u1ed3 th\u1ecb l\u00e0 li\u00ean th\u00f4ng.</p>","tags":["Translated"]},{"location":"geometry/planar.html#some-facts-about-planar-graphs","title":"M\u1ed9t s\u1ed1 s\u1ef1 th\u1eadt v\u1ec1 \u0111\u1ed3 th\u1ecb ph\u1eb3ng (Some facts about planar graphs)","text":"<p>Trong ph\u1ea7n n\u00e0y, ch\u00fang t\u00f4i tr\u00ecnh b\u00e0y m\u1ed9t s\u1ed1 s\u1ef1 th\u1eadt v\u1ec1 \u0111\u1ed3 th\u1ecb ph\u1eb3ng m\u00e0 kh\u00f4ng c\u1ea7n ch\u1ee9ng minh. \u0110\u1ed9c gi\u1ea3 quan t\u00e2m \u0111\u1ebfn c\u00e1c ch\u1ee9ng minh n\u00ean tham kh\u1ea3o L\u00fd thuy\u1ebft \u0111\u1ed3 th\u1ecb c\u1ee7a R. Diestel (xem th\u00eam video b\u00e0i gi\u1ea3ng v\u1ec1 t\u00ednh ph\u1eb3ng d\u1ef1a tr\u00ean cu\u1ed1n s\u00e1ch n\u00e0y) ho\u1eb7c m\u1ed9t s\u1ed1 cu\u1ed1n s\u00e1ch kh\u00e1c.</p>","tags":["Translated"]},{"location":"geometry/planar.html#eulers-theorem","title":"\u0110\u1ecbnh l\u00fd Euler (Euler's theorem)","text":"<p>\u0110\u1ecbnh l\u00fd Euler ph\u00e1t bi\u1ec3u r\u1eb1ng b\u1ea5t k\u1ef3 ph\u00e9p nh\u00fang ch\u00ednh x\u00e1c n\u00e0o c\u1ee7a m\u1ed9t \u0111\u1ed3 th\u1ecb ph\u1eb3ng li\u00ean th\u00f4ng v\u1edbi $n$ \u0111\u1ec9nh, $m$ c\u1ea1nh v\u00e0 $f$ m\u1eb7t \u0111\u1ec1u th\u1ecfa m\u00e3n:</p> $$n - m + f = 2$$ <p>V\u00e0 t\u1ed5ng qu\u00e1t h\u01a1n, m\u1ecdi \u0111\u1ed3 th\u1ecb ph\u1eb3ng v\u1edbi $k$ th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng th\u1ecfa m\u00e3n:</p> $$n - m + f = 1 + k$$","tags":["Translated"]},{"location":"geometry/planar.html#number-of-edges-of-a-planar-graph","title":"S\u1ed1 l\u01b0\u1ee3ng c\u1ea1nh c\u1ee7a \u0111\u1ed3 th\u1ecb ph\u1eb3ng (Number of edges of a planar graph)","text":"<p>N\u1ebfu $n \\ge 3$ th\u00ec s\u1ed1 l\u01b0\u1ee3ng c\u1ea1nh t\u1ed1i \u0111a c\u1ee7a m\u1ed9t \u0111\u1ed3 th\u1ecb ph\u1eb3ng v\u1edbi $n$ \u0111\u1ec9nh l\u00e0 $3n - 6$. S\u1ed1 l\u01b0\u1ee3ng n\u00e0y \u0111\u1ea1t \u0111\u01b0\u1ee3c b\u1edfi b\u1ea5t k\u1ef3 \u0111\u1ed3 th\u1ecb ph\u1eb3ng li\u00ean th\u00f4ng n\u00e0o trong \u0111\u00f3 m\u1ed7i m\u1eb7t \u0111\u01b0\u1ee3c gi\u1edbi h\u1ea1n b\u1edfi m\u1ed9t tam gi\u00e1c. V\u1ec1 m\u1eb7t \u0111\u1ed9 ph\u1ee9c t\u1ea1p, th\u1ef1c t\u1ebf n\u00e0y c\u00f3 ngh\u0129a l\u00e0 $m = O(n)$ cho b\u1ea5t k\u1ef3 \u0111\u1ed3 th\u1ecb ph\u1eb3ng n\u00e0o.</p>","tags":["Translated"]},{"location":"geometry/planar.html#number-of-faces-of-a-planar-graph","title":"S\u1ed1 l\u01b0\u1ee3ng m\u1eb7t c\u1ee7a \u0111\u1ed3 th\u1ecb ph\u1eb3ng (Number of faces of a planar graph)","text":"<p>Nh\u01b0 m\u1ed9t h\u1ec7 qu\u1ea3 tr\u1ef1c ti\u1ebfp c\u1ee7a th\u1ef1c t\u1ebf tr\u00ean, n\u1ebfu $n \\ge 3$ th\u00ec s\u1ed1 l\u01b0\u1ee3ng m\u1eb7t t\u1ed1i \u0111a c\u1ee7a m\u1ed9t \u0111\u1ed3 th\u1ecb ph\u1eb3ng v\u1edbi $n$ \u0111\u1ec9nh l\u00e0 $2n - 4$.</p>","tags":["Translated"]},{"location":"geometry/planar.html#minimum-vertex-degree-in-a-planar-graph","title":"B\u1eadc \u0111\u1ec9nh t\u1ed1i thi\u1ec3u trong \u0111\u1ed3 th\u1ecb ph\u1eb3ng (Minimum vertex degree in a planar graph)","text":"<p>M\u1ecdi \u0111\u1ed3 th\u1ecb ph\u1eb3ng \u0111\u1ec1u c\u00f3 m\u1ed9t \u0111\u1ec9nh b\u1eadc 5 tr\u1edf xu\u1ed1ng.</p>","tags":["Translated"]},{"location":"geometry/planar.html#the-algorithm","title":"Thu\u1eadt to\u00e1n (The algorithm)","text":"<p>Tr\u01b0\u1edbc ti\u00ean, h\u00e3y s\u1eafp x\u1ebfp c\u00e1c c\u1ea1nh k\u1ec1 cho m\u1ed7i \u0111\u1ec9nh theo g\u00f3c c\u1ef1c. B\u00e2y gi\u1edd h\u00e3y duy\u1ec7t \u0111\u1ed3 th\u1ecb theo c\u00e1ch sau. Gi\u1ea3 s\u1eed r\u1eb1ng ch\u00fang ta \u0111\u00e3 v\u00e0o \u0111\u1ec9nh $u$ th\u00f4ng qua c\u1ea1nh $(v, u)$ v\u00e0 $(u, w)$ l\u00e0 c\u1ea1nh ti\u1ebfp theo sau $(v, u)$ trong danh s\u00e1ch k\u1ec1 \u0111\u00e3 \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp c\u1ee7a $u$. Khi \u0111\u00f3 \u0111\u1ec9nh ti\u1ebfp theo s\u1ebd l\u00e0 $w$. H\u00f3a ra n\u1ebfu ch\u00fang ta b\u1eaft \u0111\u1ea7u qu\u00e1 tr\u00ecnh duy\u1ec7t n\u00e0y t\u1ea1i m\u1ed9t c\u1ea1nh $(v, u)$ n\u00e0o \u0111\u00f3, ch\u00fang ta s\u1ebd duy\u1ec7t ch\u00ednh x\u00e1c m\u1ed9t trong c\u00e1c m\u1eb7t k\u1ec1 v\u1edbi $(v, u)$, m\u1eb7t ch\u00ednh x\u00e1c ph\u1ee5 thu\u1ed9c v\u00e0o vi\u1ec7c b\u01b0\u1edbc \u0111\u1ea7u ti\u00ean c\u1ee7a ch\u00fang ta l\u00e0 t\u1eeb $u$ \u0111\u1ebfn $v$ hay t\u1eeb $v$ \u0111\u1ebfn $u$.</p> <p>B\u00e2y gi\u1edd thu\u1eadt to\u00e1n kh\u00e1 r\u00f5 r\u00e0ng. Ch\u00fang ta ph\u1ea3i l\u1eb7p qua t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh c\u1ee7a \u0111\u1ed3 th\u1ecb v\u00e0 b\u1eaft \u0111\u1ea7u duy\u1ec7t cho m\u1ed7i c\u1ea1nh ch\u01b0a \u0111\u01b0\u1ee3c th\u0103m b\u1edfi m\u1ed9t trong nh\u1eefng l\u1ea7n duy\u1ec7t tr\u01b0\u1edbc \u0111\u00f3. B\u1eb1ng c\u00e1ch n\u00e0y, ch\u00fang ta s\u1ebd t\u00ecm th\u1ea5y m\u1ed7i m\u1eb7t ch\u00ednh x\u00e1c m\u1ed9t l\u1ea7n, v\u00e0 m\u1ed7i c\u1ea1nh s\u1ebd \u0111\u01b0\u1ee3c duy\u1ec7t hai l\u1ea7n (m\u1ed9t l\u1ea7n theo m\u1ed7i h\u01b0\u1edbng).</p>","tags":["Translated"]},{"location":"geometry/planar.html#finding-the-next-edge","title":"T\u00ecm c\u1ea1nh ti\u1ebfp theo (Finding the next edge)","text":"<p>Trong qu\u00e1 tr\u00ecnh duy\u1ec7t, ch\u00fang ta ph\u1ea3i t\u00ecm c\u1ea1nh ti\u1ebfp theo theo th\u1ee9 t\u1ef1 ng\u01b0\u1ee3c chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3. C\u00e1ch r\u00f5 r\u00e0ng nh\u1ea5t \u0111\u1ec3 t\u00ecm c\u1ea1nh ti\u1ebfp theo l\u00e0 t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n theo g\u00f3c. Tuy nhi\u00ean, v\u1edbi th\u1ee9 t\u1ef1 ng\u01b0\u1ee3c chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3 c\u1ee7a c\u00e1c c\u1ea1nh k\u1ec1 cho m\u1ed7i \u0111\u1ec9nh, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh to\u00e1n tr\u01b0\u1edbc c\u00e1c c\u1ea1nh ti\u1ebfp theo v\u00e0 l\u01b0u tr\u1eef ch\u00fang trong b\u1ea3ng b\u0103m. N\u1ebfu c\u00e1c c\u1ea1nh \u0111\u00e3 \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp theo g\u00f3c, \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a vi\u1ec7c t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c m\u1eb7t trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y tr\u1edf th\u00e0nh tuy\u1ebfn t\u00ednh.</p>","tags":["Translated"]},{"location":"geometry/planar.html#finding-the-outer-face","title":"T\u00ecm m\u1eb7t ngo\u00e0i (Finding the outer face)","text":"<p>Kh\u00f4ng kh\u00f3 \u0111\u1ec3 th\u1ea5y r\u1eb1ng thu\u1eadt to\u00e1n duy\u1ec7t t\u1eebng m\u1eb7t trong theo th\u1ee9 t\u1ef1 c\u00f9ng chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3 v\u00e0 m\u1eb7t ngo\u00e0i theo th\u1ee9 t\u1ef1 ng\u01b0\u1ee3c chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3, v\u00ec v\u1eady m\u1eb7t ngo\u00e0i c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y b\u1eb1ng c\u00e1ch ki\u1ec3m tra th\u1ee9 t\u1ef1 c\u1ee7a t\u1eebng m\u1eb7t.</p>","tags":["Translated"]},{"location":"geometry/planar.html#complexity","title":"\u0110\u1ed9 ph\u1ee9c t\u1ea1p (Complexity)","text":"<p>Kh\u00e1 r\u00f5 r\u00e0ng r\u1eb1ng \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 $O(m \\log m)$ do vi\u1ec7c s\u1eafp x\u1ebfp, v\u00e0 v\u00ec $m = O(n)$, n\u00f3 th\u1ef1c s\u1ef1 l\u00e0 $O(n \\log n)$. Nh\u01b0 \u0111\u00e3 \u0111\u1ec1 c\u1eadp tr\u01b0\u1edbc \u0111\u00f3, n\u1ebfu kh\u00f4ng c\u1ea7n s\u1eafp x\u1ebfp th\u00ec \u0111\u1ed9 ph\u1ee9c t\u1ea1p tr\u1edf th\u00e0nh $O(n)$.</p>","tags":["Translated"]},{"location":"geometry/planar.html#what-if-the-graph-isnt-connected","title":"\u0110i\u1ec1u g\u00ec x\u1ea3y ra n\u1ebfu \u0111\u1ed3 th\u1ecb kh\u00f4ng li\u00ean th\u00f4ng? (What if the graph isn't connected?)","text":"<p>Tho\u1ea1t nh\u00ecn, c\u00f3 v\u1ebb nh\u01b0 vi\u1ec7c t\u00ecm c\u00e1c m\u1eb7t c\u1ee7a \u0111\u1ed3 th\u1ecb kh\u00f4ng li\u00ean th\u00f4ng kh\u00f4ng kh\u00f3 h\u01a1n nhi\u1ec1u v\u00ec ch\u00fang ta c\u00f3 th\u1ec3 ch\u1ea1y c\u00f9ng m\u1ed9t thu\u1eadt to\u00e1n cho t\u1eebng th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng. Tuy nhi\u00ean, c\u00e1c th\u00e0nh ph\u1ea7n c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c v\u1ebd theo ki\u1ec3u l\u1ed3ng nhau, t\u1ea1o th\u00e0nh c\u00e1c l\u1ed7 (holes) (xem h\u00ecnh \u1ea3nh b\u00ean d\u01b0\u1edbi). Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, m\u1eb7t trong c\u1ee7a m\u1ed9t s\u1ed1 th\u00e0nh ph\u1ea7n tr\u1edf th\u00e0nh m\u1eb7t ngo\u00e0i c\u1ee7a m\u1ed9t s\u1ed1 th\u00e0nh ph\u1ea7n kh\u00e1c v\u00e0 c\u00f3 bi\u00ean gi\u1edbi kh\u00f4ng li\u00ean th\u00f4ng ph\u1ee9c t\u1ea1p. Vi\u1ec7c gi\u1ea3i quy\u1ebft c\u00e1c tr\u01b0\u1eddng h\u1ee3p nh\u01b0 v\u1eady kh\u00e1 kh\u00f3 kh\u0103n, m\u1ed9t c\u00e1ch ti\u1ebfp c\u1eadn kh\u1ea3 thi l\u00e0 x\u00e1c \u0111\u1ecbnh c\u00e1c th\u00e0nh ph\u1ea7n l\u1ed3ng nhau b\u1eb1ng c\u00e1c thu\u1eadt to\u00e1n \u0111\u1ecbnh v\u1ecb \u0111i\u1ec3m.</p>","tags":["Translated"]},{"location":"geometry/planar.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>Vi\u1ec7c c\u00e0i \u0111\u1eb7t sau \u0111\u00e2y tr\u1ea3 v\u1ec1 m\u1ed9t vector c\u00e1c \u0111\u1ec9nh cho m\u1ed7i m\u1eb7t, m\u1eb7t ngo\u00e0i \u0111i tr\u01b0\u1edbc. C\u00e1c m\u1eb7t trong \u0111\u01b0\u1ee3c tr\u1ea3 v\u1ec1 theo th\u1ee9 t\u1ef1 ng\u01b0\u1ee3c chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3 v\u00e0 m\u1eb7t ngo\u00e0i \u0111\u01b0\u1ee3c tr\u1ea3 v\u1ec1 theo th\u1ee9 t\u1ef1 c\u00f9ng chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3.</p> <p>\u0110\u1ec3 \u0111\u01a1n gi\u1ea3n, ch\u00fang ta t\u00ecm c\u1ea1nh ti\u1ebfp theo b\u1eb1ng c\u00e1ch th\u1ef1c hi\u1ec7n t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n theo g\u00f3c. <pre><code>struct Point {\n    int64_t x, y;\n\n    Point(int64_t x_, int64_t y_): x(x_), y(y_) {}\n\n    Point operator - (const Point &amp; p) const {\n        return Point(x - p.x, y - p.y);\n    }\n\n    int64_t cross (const Point &amp; p) const {\n        return x * p.y - y * p.x;\n    }\n\n    int64_t cross (const Point &amp; p, const Point &amp; q) const {\n        return (p - *this).cross(q - *this);\n    }\n\n    int half () const {\n        return int(y &lt; 0 || (y == 0 &amp;&amp; x &lt; 0));\n    }\n};\n\nstd::vector&lt;std::vector&lt;size_t&gt;&gt; find_faces(std::vector&lt;Point&gt; vertices, std::vector&lt;std::vector&lt;size_t&gt;&gt; adj) {\n    size_t n = vertices.size();\n    std::vector&lt;std::vector&lt;char&gt;&gt; used(n);\n    for (size_t i = 0; i &lt; n; i++) {\n        used[i].resize(adj[i].size());\n        used[i].assign(adj[i].size(), 0);\n        auto compare = [&amp;](size_t l, size_t r) {\n            Point pl = vertices[l] - vertices[i];\n            Point pr = vertices[r] - vertices[i];\n            if (pl.half() != pr.half())\n                return pl.half() &lt; pr.half();\n            return pl.cross(pr) &gt; 0;\n        };\n        std::sort(adj[i].begin(), adj[i].end(), compare);\n    }\n    std::vector&lt;std::vector&lt;size_t&gt;&gt; faces;\n    for (size_t i = 0; i &lt; n; i++) {\n        for (size_t edge_id = 0; edge_id &lt; adj[i].size(); edge_id++) {\n            if (used[i][edge_id]) {\n                continue;\n            }\n            std::vector&lt;size_t&gt; face;\n            size_t v = i;\n            size_t e = edge_id;\n            while (!used[v][e]) {\n                used[v][e] = true;\n                face.push_back(v);\n                size_t u = adj[v][e];\n                size_t e1 = std::lower_bound(adj[u].begin(), adj[u].end(), v, [&amp;](size_t l, size_t r) {\n                    Point pl = vertices[l] - vertices[u];\n                    Point pr = vertices[r] - vertices[u];\n                    if (pl.half() != pr.half())\n                        return pl.half() &lt; pr.half();\n                    return pl.cross(pr) &gt; 0;\n                }) - adj[u].begin() + 1;\n                if (e1 == adj[u].size()) {\n                    e1 = 0;\n                }\n                v = u;\n                e = e1;\n            }\n            std::reverse(face.begin(), face.end());\n            Point p1 = vertices[face[0]];\n            __int128 sum = 0;\n            for (int j = 0; j &lt; face.size(); ++j) {\n                Point p2 = vertices[face[j]];\n                Point p3 = vertices[face[(j + 1) % face.size()]];\n                sum += (p2 - p1).cross(p3 - p2);\n            }\n            if (sum &lt;= 0) {\n                faces.insert(faces.begin(), face);\n            } else {\n                faces.emplace_back(face);\n            }\n        }\n    }\n    return faces;\n}\n</code></pre></p>","tags":["Translated"]},{"location":"geometry/planar.html#building-planar-graph-from-line-segments","title":"X\u00e2y d\u1ef1ng \u0111\u1ed3 th\u1ecb ph\u1eb3ng t\u1eeb c\u00e1c \u0111o\u1ea1n th\u1eb3ng (Building planar graph from line segments)","text":"<p>\u0110\u00f4i khi b\u1ea1n kh\u00f4ng \u0111\u01b0\u1ee3c cung c\u1ea5p m\u1ed9t \u0111\u1ed3 th\u1ecb m\u1ed9t c\u00e1ch r\u00f5 r\u00e0ng, m\u00e0 thay v\u00e0o \u0111\u00f3 l\u00e0 m\u1ed9t t\u1eadp h\u1ee3p c\u00e1c \u0111o\u1ea1n th\u1eb3ng tr\u00ean m\u1ed9t m\u1eb7t ph\u1eb3ng, v\u00e0 \u0111\u1ed3 th\u1ecb th\u1ef1c t\u1ebf \u0111\u01b0\u1ee3c h\u00ecnh th\u00e0nh b\u1eb1ng c\u00e1ch c\u1eaft c\u00e1c \u0111o\u1ea1n th\u1eb3ng \u0111\u00f3, nh\u01b0 trong h\u00ecnh b\u00ean d\u01b0\u1edbi. Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, b\u1ea1n ph\u1ea3i x\u00e2y d\u1ef1ng \u0111\u1ed3 th\u1ecb th\u1ee7 c\u00f4ng. C\u00e1ch d\u1ec5 nh\u1ea5t \u0111\u1ec3 l\u00e0m \u0111i\u1ec1u \u0111\u00f3 l\u00e0 nh\u01b0 sau. C\u1ed1 \u0111\u1ecbnh m\u1ed9t \u0111o\u1ea1n th\u1eb3ng v\u00e0 c\u1eaft n\u00f3 v\u1edbi t\u1ea5t c\u1ea3 c\u00e1c \u0111o\u1ea1n th\u1eb3ng kh\u00e1c. Sau \u0111\u00f3 s\u1eafp x\u1ebfp t\u1ea5t c\u1ea3 c\u00e1c \u0111i\u1ec3m giao nhau c\u00f9ng v\u1edbi hai \u0111\u1ea7u m\u00fat c\u1ee7a \u0111o\u1ea1n th\u1eb3ng theo th\u1ee9 t\u1ef1 t\u1eeb \u0111i\u1ec3n v\u00e0 th\u00eam ch\u00fang v\u00e0o \u0111\u1ed3 th\u1ecb d\u01b0\u1edbi d\u1ea1ng c\u00e1c \u0111\u1ec9nh. C\u0169ng li\u00ean k\u1ebft m\u1ed7i hai \u0111\u1ec9nh li\u1ec1n k\u1ec1 theo th\u1ee9 t\u1ef1 t\u1eeb \u0111i\u1ec3n b\u1eb1ng m\u1ed9t c\u1ea1nh. Sau khi th\u1ef1c hi\u1ec7n quy tr\u00ecnh n\u00e0y cho t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh, ch\u00fang ta s\u1ebd thu \u0111\u01b0\u1ee3c \u0111\u1ed3 th\u1ecb. T\u1ea5t nhi\u00ean, ch\u00fang ta n\u00ean \u0111\u1ea3m b\u1ea3o r\u1eb1ng hai \u0111i\u1ec3m giao nhau b\u1eb1ng nhau s\u1ebd lu\u00f4n t\u01b0\u01a1ng \u1ee9ng v\u1edbi c\u00f9ng m\u1ed9t \u0111\u1ec9nh. C\u00e1ch d\u1ec5 nh\u1ea5t \u0111\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y l\u00e0 l\u01b0u tr\u1eef c\u00e1c \u0111i\u1ec3m trong m\u1ed9t map theo t\u1ecda \u0111\u1ed9 c\u1ee7a ch\u00fang, coi c\u00e1c \u0111i\u1ec3m c\u00f3 t\u1ecda \u0111\u1ed9 kh\u00e1c nhau m\u1ed9t s\u1ed1 nh\u1ecf (gi\u1ea3 s\u1eed, nh\u1ecf h\u01a1n $10^{-9}$) l\u00e0 b\u1eb1ng nhau. Thu\u1eadt to\u00e1n n\u00e0y ho\u1ea1t \u0111\u1ed9ng trong $O(n^2 \\log n)$.</p>","tags":["Translated"]},{"location":"geometry/planar.html#implementation-of-building-graph","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<pre><code>using dbl = long double;\n\nconst dbl eps = 1e-9;\n\nstruct Point {\n    dbl x, y;\n\n    Point(){}\n    Point(dbl x_, dbl y_): x(x_), y(y_) {}\n\n    Point operator * (dbl d) const {\n        return Point(x * d, y * d);\n    }\n\n    Point operator + (const Point &amp; p) const {\n        return Point(x + p.x, y + p.y);\n    }\n\n    Point operator - (const Point &amp; p) const {\n        return Point(x - p.x, y - p.y);\n    }\n\n    dbl cross (const Point &amp; p) const {\n        return x * p.y - y * p.x;\n    }\n\n    dbl cross (const Point &amp; p, const Point &amp; q) const {\n        return (p - *this).cross(q - *this);\n    }\n\n    dbl dot (const Point &amp; p) const {\n        return x * p.x + y * p.y;\n    }\n\n    dbl dot (const Point &amp; p, const Point &amp; q) const {\n        return (p - *this).dot(q - *this);\n    }\n\n    bool operator &lt; (const Point &amp; p) const {\n        if (fabs(x - p.x) &lt; eps) {\n            if (fabs(y - p.y) &lt; eps) {\n                return false;\n            } else {\n                return y &lt; p.y;\n            }\n        } else {\n            return x &lt; p.x;\n        }\n    }\n\n    bool operator == (const Point &amp; p) const {\n        return fabs(x - p.x) &lt; eps &amp;&amp; fabs(y - p.y) &lt; eps;\n    }\n\n    bool operator &gt;= (const Point &amp; p) const {\n        return !(*this &lt; p);\n    }\n};\n\nstruct Line{\n    Point p[2];\n\n    Line(Point l, Point r){p[0] = l; p[1] = r;}\n    Point&amp; operator [](const int &amp; i){return p[i];}\n    const Point&amp; operator[](const int &amp; i)const{return p[i];}\n    Line(const Line &amp; l){\n        p[0] = l.p[0]; p[1] = l.p[1];\n    }\n    Point getOrth()const{\n        return Point(p[1].y - p[0].y, p[0].x - p[1].x);\n    }\n    bool hasPointLine(const Point &amp; t)const{\n        return std::fabs(p[0].cross(p[1], t)) &lt; eps;\n    }\n    bool hasPointSeg(const Point &amp; t)const{\n        return hasPointLine(t) &amp;&amp; t.dot(p[0], p[1]) &lt; eps;\n    }\n};\n\nstd::vector&lt;Point&gt; interLineLine(Line l1, Line l2){\n    if(std::fabs(l1.getOrth().cross(l2.getOrth())) &lt; eps){\n        if(l1.hasPointLine(l2[0]))return {l1[0], l1[1]};\n        else return {};\n    }\n    Point u = l2[1] - l2[0];\n    Point v = l1[1] - l1[0];\n    dbl s = u.cross(l2[0] - l1[0])/u.cross(v);\n    return {Point(l1[0] + v * s)};\n}\n\nstd::vector&lt;Point&gt; interSegSeg(Line l1, Line l2){\n    if (l1[0] == l1[1]) {\n        if (l2[0] == l2[1]) {\n            if (l1[0] == l2[0])\n                return {l1[0]};\n            else \n                return {};\n        } else {\n            if (l2.hasPointSeg(l1[0]))\n                return {l1[0]};\n            else\n                return {};\n        }\n    }\n    if (l2[0] == l2[1]) {\n        if (l1.hasPointSeg(l2[0]))\n            return {l2[0]};\n        else \n            return {};\n    }\n    auto li = interLineLine(l1, l2);\n    if (li.empty())\n        return li;\n    if (li.size() == 2) {\n        if (l1[0] &gt;= l1[1])\n            std::swap(l1[0], l1[1]);\n        if (l2[0] &gt;= l2[1])\n            std::swap(l2[0], l2[1]);\n        std::vector&lt;Point&gt; res(2);\n        if (l1[0] &lt; l2[0])\n            res[0] = l2[0];\n        else\n            res[0] = l1[0];\n        if (l1[1] &lt; l2[1])\n            res[1] = l1[1];\n        else\n            res[1] = l2[1];\n        if (res[0] == res[1])\n            res.pop_back();\n        if (res.size() == 2u &amp;&amp; res[1] &lt; res[0])\n            return {};\n        else \n            return res;\n    }\n    Point cand = li[0];\n    if (l1.hasPointSeg(cand) &amp;&amp; l2.hasPointSeg(cand))\n        return {cand};\n    else \n        return {};\n}\n\nstd::pair&lt;std::vector&lt;Point&gt;, std::vector&lt;std::vector&lt;size_t&gt;&gt;&gt; build_graph(std::vector&lt;Line&gt; segments) {\n    std::vector&lt;Point&gt; p;\n    std::vector&lt;std::vector&lt;size_t&gt;&gt; adj;\n    std::map&lt;std::pair&lt;int64_t, int64_t&gt;, size_t&gt; point_id;\n    auto get_point_id = [&amp;](Point pt) {\n        auto repr = std::make_pair(\n            int64_t(std::round(pt.x * 1000000000) + 1e-6),\n            int64_t(std::round(pt.y * 1000000000) + 1e-6)\n        );\n        if (!point_id.count(repr)) {\n            adj.emplace_back();\n            size_t id = point_id.size();\n            point_id[repr] = id;\n            p.push_back(pt);\n            return id;\n        } else {\n            return point_id[repr];\n        }\n    };\n    for (size_t i = 0; i &lt; segments.size(); i++) {\n        std::vector&lt;size_t&gt; curr = {\n            get_point_id(segments[i][0]),\n            get_point_id(segments[i][1])\n        };\n        for (size_t j = 0; j &lt; segments.size(); j++) {\n            if (i == j)\n                continue;\n            auto inter = interSegSeg(segments[i], segments[j]);\n            for (auto pt: inter) {\n                curr.push_back(get_point_id(pt));\n            }\n        }\n        std::sort(curr.begin(), curr.end(), [&amp;](size_t l, size_t r) { return p[l] &lt; p[r]; });\n        curr.erase(std::unique(curr.begin(), curr.end()), curr.end());\n        for (size_t j = 0; j + 1 &lt; curr.size(); j++) {\n            adj[curr[j]].push_back(curr[j + 1]);\n            adj[curr[j + 1]].push_back(curr[j]);\n        }\n    }\n    for (size_t i = 0; i &lt; adj.size(); i++) {\n        std::sort(adj[i].begin(), adj[i].end());\n        // removing edges that were added multiple times\n        adj[i].erase(std::unique(adj[i].begin(), adj[i].end()), adj[i].end());\n    }\n    return {p, adj};\n}\n</code></pre>","tags":["Translated"]},{"location":"geometry/planar.html#problems","title":"B\u00e0i t\u1eadp (Problems)","text":"<ul> <li>TIMUS 1664 Pipeline Transportation</li> <li>TIMUS 1681 Brother Bear's Garden</li> </ul>","tags":["Translated"]},{"location":"geometry/point-in-convex-polygon.html","title":"Ki\u1ec3m tra \u0111i\u1ec3m c\u00f3 thu\u1ed9c \u0111a gi\u00e1c l\u1ed3i trong $O(\\log N)$ (Check if point belongs to the convex polygon in $O(\\log N)$)","text":"<p>Xem x\u00e9t b\u00e0i to\u00e1n sau: b\u1ea1n \u0111\u01b0\u1ee3c cho m\u1ed9t \u0111a gi\u00e1c l\u1ed3i v\u1edbi c\u00e1c \u0111\u1ec9nh nguy\u00ean v\u00e0 r\u1ea5t nhi\u1ec1u truy v\u1ea5n. M\u1ed7i truy v\u1ea5n l\u00e0 m\u1ed9t \u0111i\u1ec3m, m\u00e0 ch\u00fang ta c\u1ea7n x\u00e1c \u0111\u1ecbnh xem n\u00f3 n\u1eb1m b\u00ean trong hay tr\u00ean bi\u00ean c\u1ee7a \u0111a gi\u00e1c hay kh\u00f4ng. Gi\u1ea3 s\u1eed \u0111a gi\u00e1c \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp ng\u01b0\u1ee3c chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3. Ch\u00fang ta s\u1ebd tr\u1ea3 l\u1eddi m\u1ed7i truy v\u1ea5n trong $O(\\log n)$ tr\u1ef1c tuy\u1ebfn (online).</p>","tags":["Translated"]},{"location":"geometry/point-in-convex-polygon.html#algorithm","title":"Thu\u1eadt to\u00e1n (Algorithm)","text":"<p>H\u00e3y ch\u1ecdn \u0111i\u1ec3m c\u00f3 t\u1ecda \u0111\u1ed9 x nh\u1ecf nh\u1ea5t. N\u1ebfu c\u00f3 m\u1ed9t v\u00e0i \u0111i\u1ec3m nh\u01b0 v\u1eady, ch\u00fang ta ch\u1ecdn \u0111i\u1ec3m c\u00f3 t\u1ecda \u0111\u1ed9 y nh\u1ecf nh\u1ea5t. H\u00e3y k\u00fd hi\u1ec7u n\u00f3 l\u00e0 $p_0$. B\u00e2y gi\u1edd t\u1ea5t c\u1ea3 c\u00e1c \u0111i\u1ec3m kh\u00e1c $p_1,\\dots,p_n$ c\u1ee7a \u0111a gi\u00e1c \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp theo g\u00f3c c\u1ef1c c\u1ee7a ch\u00fang t\u1eeb \u0111i\u1ec3m \u0111\u00e3 ch\u1ecdn (v\u00ec \u0111a gi\u00e1c \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp ng\u01b0\u1ee3c chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3).</p> <p>N\u1ebfu \u0111i\u1ec3m thu\u1ed9c v\u1ec1 \u0111a gi\u00e1c, n\u00f3 thu\u1ed9c v\u1ec1 m\u1ed9t tam gi\u00e1c n\u00e0o \u0111\u00f3 $p_0, p_i, p_{i + 1}$ (c\u00f3 th\u1ec3 nhi\u1ec1u h\u01a1n m\u1ed9t n\u1ebfu n\u00f3 n\u1eb1m tr\u00ean bi\u00ean c\u1ee7a c\u00e1c tam gi\u00e1c). Xem x\u00e9t tam gi\u00e1c $p_0, p_i, p_{i + 1}$ sao cho $p$ thu\u1ed9c v\u1ec1 tam gi\u00e1c n\u00e0y v\u00e0 $i$ l\u00e0 l\u1edbn nh\u1ea5t trong s\u1ed1 t\u1ea5t c\u1ea3 c\u00e1c tam gi\u00e1c nh\u01b0 v\u1eady.</p> <p>C\u00f3 m\u1ed9t tr\u01b0\u1eddng h\u1ee3p \u0111\u1eb7c bi\u1ec7t. $p$ n\u1eb1m tr\u00ean \u0111o\u1ea1n th\u1eb3ng $(p_0, p_n)$. Tr\u01b0\u1eddng h\u1ee3p n\u00e0y ch\u00fang ta s\u1ebd ki\u1ec3m tra ri\u00eang. Ng\u01b0\u1ee3c l\u1ea1i t\u1ea5t c\u1ea3 c\u00e1c \u0111i\u1ec3m $p_j$ v\u1edbi $j \\le i$ n\u1eb1m ng\u01b0\u1ee3c chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3 so v\u1edbi $p$ \u0111\u1ed1i v\u1edbi $p_0$, v\u00e0 t\u1ea5t c\u1ea3 c\u00e1c \u0111i\u1ec3m kh\u00e1c kh\u00f4ng ng\u01b0\u1ee3c chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3 so v\u1edbi $p$. \u0110i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 ch\u00fang ta c\u00f3 th\u1ec3 \u00e1p d\u1ee5ng t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n cho \u0111i\u1ec3m $p_i$, sao cho $p_i$ kh\u00f4ng n\u1eb1m ng\u01b0\u1ee3c chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3 so v\u1edbi $p$ \u0111\u1ed1i v\u1edbi $p_0$, v\u00e0 $i$ l\u00e0 l\u1edbn nh\u1ea5t trong s\u1ed1 t\u1ea5t c\u1ea3 c\u00e1c \u0111i\u1ec3m nh\u01b0 v\u1eady. V\u00e0 sau \u0111\u00f3 ch\u00fang ta ki\u1ec3m tra xem \u0111i\u1ec3m c\u00f3 th\u1ef1c s\u1ef1 n\u1eb1m trong tam gi\u00e1c \u0111\u00e3 x\u00e1c \u0111\u1ecbnh hay kh\u00f4ng.</p> <p>D\u1ea5u c\u1ee7a $(a - c) \\times (b - c)$ s\u1ebd cho ch\u00fang ta bi\u1ebft, n\u1ebfu \u0111i\u1ec3m $a$ n\u1eb1m c\u00f9ng chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3 hay ng\u01b0\u1ee3c chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3 so v\u1edbi \u0111i\u1ec3m $b$ \u0111\u1ed1i v\u1edbi \u0111i\u1ec3m $c$. N\u1ebfu $(a - c) \\times (b - c) &gt; 0$, th\u00ec \u0111i\u1ec3m $a$ n\u1eb1m b\u00ean ph\u1ea3i c\u1ee7a vector \u0111i t\u1eeb $c$ \u0111\u1ebfn $b$, \u0111i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 c\u00f9ng chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3 so v\u1edbi $b$ \u0111\u1ed1i v\u1edbi $c$. V\u00e0 n\u1ebfu $(a - c) \\times (b - c) &lt; 0$, th\u00ec \u0111i\u1ec3m n\u1eb1m b\u00ean tr\u00e1i, ho\u1eb7c ng\u01b0\u1ee3c chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3. V\u00e0 n\u00f3 n\u1eb1m ch\u00ednh x\u00e1c tr\u00ean \u0111\u01b0\u1eddng th\u1eb3ng gi\u1eefa c\u00e1c \u0111i\u1ec3m $b$ v\u00e0 $c$ n\u1ebfu t\u00edch b\u1eb1ng 0.</p> <p>Quay l\u1ea1i thu\u1eadt to\u00e1n: Xem x\u00e9t m\u1ed9t \u0111i\u1ec3m truy v\u1ea5n $p$. \u0110\u1ea7u ti\u00ean, ch\u00fang ta ph\u1ea3i ki\u1ec3m tra xem \u0111i\u1ec3m c\u00f3 n\u1eb1m gi\u1eefa $p_1$ v\u00e0 $p_n$ hay kh\u00f4ng. Ng\u01b0\u1ee3c l\u1ea1i ch\u00fang ta \u0111\u00e3 bi\u1ebft r\u1eb1ng n\u00f3 kh\u00f4ng th\u1ec3 l\u00e0 m\u1ed9t ph\u1ea7n c\u1ee7a \u0111a gi\u00e1c. \u0110i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n b\u1eb1ng c\u00e1ch ki\u1ec3m tra xem t\u00edch c\u00f3 h\u01b0\u1edbng $(p_1 - p_0)\\times(p - p_0)$ l\u00e0 b\u1eb1ng kh\u00f4ng ho\u1eb7c c\u00f3 c\u00f9ng d\u1ea5u v\u1edbi $(p_1 - p_0)\\times(p_n - p_0)$, v\u00e0 $(p_n - p_0)\\times(p - p_0)$ l\u00e0 b\u1eb1ng kh\u00f4ng ho\u1eb7c c\u00f3 c\u00f9ng d\u1ea5u v\u1edbi $(p_n - p_0)\\times(p_1 - p_0)$.</p> <p>Sau \u0111\u00f3 ch\u00fang ta x\u1eed l\u00fd tr\u01b0\u1eddng h\u1ee3p \u0111\u1eb7c bi\u1ec7t trong \u0111\u00f3 $p$ l\u00e0 m\u1ed9t ph\u1ea7n c\u1ee7a \u0111\u01b0\u1eddng th\u1eb3ng $(p_0, p_1)$. V\u00e0 sau \u0111\u00f3 ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n \u0111i\u1ec3m cu\u1ed1i c\u00f9ng t\u1eeb $p_1,\\dots p_n$ m\u00e0 kh\u00f4ng n\u1eb1m ng\u01b0\u1ee3c chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3 so v\u1edbi $p$ \u0111\u1ed1i v\u1edbi $p_0$. \u0110\u1ed1i v\u1edbi m\u1ed9t \u0111i\u1ec3m \u0111\u01a1n l\u1ebb $p_i$, \u0111i\u1ec1u ki\u1ec7n n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c ki\u1ec3m tra b\u1eb1ng c\u00e1ch ki\u1ec3m tra xem $(p_i - p_0)\\times(p - p_0) \\le 0$. Sau khi ch\u00fang ta t\u00ecm th\u1ea5y m\u1ed9t \u0111i\u1ec3m nh\u01b0 v\u1eady $p_i$, ch\u00fang ta ph\u1ea3i ki\u1ec3m tra xem $p$ c\u00f3 n\u1eb1m b\u00ean trong tam gi\u00e1c $p_0, p_i, p_{i + 1}$ hay kh\u00f4ng. \u0110\u1ec3 ki\u1ec3m tra xem n\u00f3 c\u00f3 thu\u1ed9c v\u1ec1 tam gi\u00e1c hay kh\u00f4ng, ch\u00fang ta ch\u1ec9 c\u1ea7n ki\u1ec3m tra xem $|(p_i - p_0)\\times(p_{i + 1} - p_0)| = |(p_0 - p)\\times(p_i - p)| + |(p_i - p)\\times(p_{i + 1} - p)| + |(p_{i + 1} - p)\\times(p_0 - p)|$. \u0110i\u1ec1u n\u00e0y ki\u1ec3m tra xem di\u1ec7n t\u00edch c\u1ee7a tam gi\u00e1c $p_0, p_i, p_{i+1}$ c\u00f3 c\u00f9ng k\u00edch th\u01b0\u1edbc ch\u00ednh x\u00e1c v\u1edbi t\u1ed5ng k\u00edch th\u01b0\u1edbc c\u1ee7a tam gi\u00e1c $p_0, p_i, p$, tam gi\u00e1c $p_0, p, p_{i+1}$ v\u00e0 tam gi\u00e1c $p_i, p_{i+1}, p$. N\u1ebfu $p$ \u1edf b\u00ean ngo\u00e0i, th\u00ec t\u1ed5ng c\u1ee7a ba tam gi\u00e1c \u0111\u00f3 s\u1ebd l\u1edbn h\u01a1n k\u00edch th\u01b0\u1edbc c\u1ee7a tam gi\u00e1c. N\u1ebfu n\u00f3 \u1edf b\u00ean trong, th\u00ec n\u00f3 s\u1ebd b\u1eb1ng nhau.</p>","tags":["Translated"]},{"location":"geometry/point-in-convex-polygon.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>H\u00e0m <code>prepare</code> s\u1ebd \u0111\u1ea3m b\u1ea3o r\u1eb1ng \u0111i\u1ec3m nh\u1ecf nh\u1ea5t theo th\u1ee9 t\u1ef1 t\u1eeb \u0111i\u1ec3n (gi\u00e1 tr\u1ecb x nh\u1ecf nh\u1ea5t, v\u00e0 trong tr\u01b0\u1eddng h\u1ee3p h\u00f2a th\u00ec gi\u00e1 tr\u1ecb y nh\u1ecf nh\u1ea5t) s\u1ebd l\u00e0 $p_0$, v\u00e0 t\u00ednh to\u00e1n c\u00e1c vector $p_i - p_0$. Sau \u0111\u00f3 h\u00e0m <code>pointInConvexPolygon</code> t\u00ednh to\u00e1n k\u1ebft qu\u1ea3 c\u1ee7a m\u1ed9t truy v\u1ea5n. Ch\u00fang ta ghi nh\u1edb th\u00eam \u0111i\u1ec3m $p_0$ v\u00e0 t\u1ecbnh ti\u1ebfn t\u1ea5t c\u1ea3 c\u00e1c \u0111i\u1ec3m \u0111\u01b0\u1ee3c truy v\u1ea5n v\u1edbi n\u00f3 \u0111\u1ec3 t\u00ednh to\u00e1n kho\u1ea3ng c\u00e1ch ch\u00ednh x\u00e1c, v\u00ec c\u00e1c vector kh\u00f4ng c\u00f3 \u0111i\u1ec3m ban \u0111\u1ea7u. B\u1eb1ng c\u00e1ch t\u1ecbnh ti\u1ebfn c\u00e1c \u0111i\u1ec3m truy v\u1ea5n, ch\u00fang ta c\u00f3 th\u1ec3 gi\u1ea3 \u0111\u1ecbnh r\u1eb1ng t\u1ea5t c\u1ea3 c\u00e1c vector b\u1eaft \u0111\u1ea7u t\u1ea1i g\u1ed1c t\u1ecda \u0111\u1ed9 $(0, 0)$, v\u00e0 \u0111\u01a1n gi\u1ea3n h\u00f3a c\u00e1c t\u00ednh to\u00e1n cho kho\u1ea3ng c\u00e1ch v\u00e0 \u0111\u1ed9 d\u00e0i.</p> <pre><code>struct pt {\n    long long x, y;\n    pt() {}\n    pt(long long _x, long long _y) : x(_x), y(_y) {}\n    pt operator+(const pt &amp;p) const { return pt(x + p.x, y + p.y); }\n    pt operator-(const pt &amp;p) const { return pt(x - p.x, y - p.y); }\n    long long cross(const pt &amp;p) const { return x * p.y - y * p.x; }\n    long long dot(const pt &amp;p) const { return x * p.x + y * p.y; }\n    long long cross(const pt &amp;a, const pt &amp;b) const { return (a - *this).cross(b - *this); }\n    long long dot(const pt &amp;a, const pt &amp;b) const { return (a - *this).dot(b - *this); }\n    long long sqrLen() const { return this-&gt;dot(*this); }\n};\n\nbool lexComp(const pt &amp;l, const pt &amp;r) {\n    return l.x &lt; r.x || (l.x == r.x &amp;&amp; l.y &lt; r.y);\n}\n\nint sgn(long long val) { return val &gt; 0 ? 1 : (val == 0 ? 0 : -1); }\n\nvector&lt;pt&gt; seq;\npt translation;\nint n;\n\nbool pointInTriangle(pt a, pt b, pt c, pt point) {\n    long long s1 = abs(a.cross(b, c));\n    long long s2 = abs(point.cross(a, b)) + abs(point.cross(b, c)) + abs(point.cross(c, a));\n    return s1 == s2;\n}\n\nvoid prepare(vector&lt;pt&gt; &amp;points) {\n    n = points.size();\n    int pos = 0;\n    for (int i = 1; i &lt; n; i++) {\n        if (lexComp(points[i], points[pos]))\n            pos = i;\n    }\n    rotate(points.begin(), points.begin() + pos, points.end());\n\n    n--;\n    seq.resize(n);\n    for (int i = 0; i &lt; n; i++)\n        seq[i] = points[i + 1] - points[0];\n    translation = points[0];\n}\n\nbool pointInConvexPolygon(pt point) {\n    point = point - translation;\n    if (seq[0].cross(point) != 0 &amp;&amp;\n            sgn(seq[0].cross(point)) != sgn(seq[0].cross(seq[n - 1])))\n        return false;\n    if (seq[n - 1].cross(point) != 0 &amp;&amp;\n            sgn(seq[n - 1].cross(point)) != sgn(seq[n - 1].cross(seq[0])))\n        return false;\n\n    if (seq[0].cross(point) == 0)\n        return seq[0].sqrLen() &gt;= point.sqrLen();\n\n    int l = 0, r = n - 1;\n    while (r - l &gt; 1) {\n        int mid = (l + r) / 2;\n        int pos = mid;\n        if (seq[pos].cross(point) &gt;= 0)\n            l = mid;\n        else\n            r = mid;\n    }\n    int pos = l;\n    return pointInTriangle(seq[pos], seq[pos + 1], pt(0, 0), point);\n}\n</code></pre>","tags":["Translated"]},{"location":"geometry/point-in-convex-polygon.html#problems","title":"B\u00e0i t\u1eadp (Problems)","text":"<ul> <li>SGU253 Theodore Roosevelt</li> <li>Codeforces 55E Very simple problem</li> <li>Codeforces 166B Polygons</li> </ul>","tags":["Translated"]},{"location":"geometry/point-location.html","title":"\u0110\u1ecbnh v\u1ecb \u0111i\u1ec3m trong $O(\\log n)$ (Point location in $O(\\log n)$)","text":"<p>Xem x\u00e9t b\u00e0i to\u00e1n sau: b\u1ea1n \u0111\u01b0\u1ee3c cho m\u1ed9t ph\u00e2n ho\u1ea1ch ph\u1eb3ng kh\u00f4ng c\u00f3 b\u1ea5t k\u1ef3 \u0111\u1ec9nh b\u1eadc m\u1ed9t hay b\u1eadc kh\u00f4ng n\u00e0o, v\u00e0 r\u1ea5t nhi\u1ec1u truy v\u1ea5n. M\u1ed7i truy v\u1ea5n l\u00e0 m\u1ed9t \u0111i\u1ec3m, m\u00e0 ch\u00fang ta c\u1ea7n x\u00e1c \u0111\u1ecbnh m\u1eb7t (face) c\u1ee7a ph\u00e2n ho\u1ea1ch m\u00e0 n\u00f3 thu\u1ed9c v\u1ec1. Ch\u00fang ta s\u1ebd tr\u1ea3 l\u1eddi t\u1eebng truy v\u1ea5n trong $O(\\log n)$ ngo\u1ea1i tuy\u1ebfn (offline). V\u1ea5n \u0111\u1ec1 n\u00e0y c\u00f3 th\u1ec3 n\u1ea3y sinh khi b\u1ea1n c\u1ea7n \u0111\u1ecbnh v\u1ecb m\u1ed9t s\u1ed1 \u0111i\u1ec3m trong bi\u1ec3u \u0111\u1ed3 Voronoi ho\u1eb7c trong m\u1ed9t \u0111a gi\u00e1c \u0111\u01a1n.</p>","tags":["Translated"]},{"location":"geometry/point-location.html#algorithm","title":"Thu\u1eadt to\u00e1n (Algorithm)","text":"<p>\u0110\u1ea7u ti\u00ean, \u0111\u1ed1i v\u1edbi m\u1ed7i \u0111i\u1ec3m truy v\u1ea5n $p\\ (x_0, y_0)$ ch\u00fang ta mu\u1ed1n t\u00ecm m\u1ed9t c\u1ea1nh sao cho n\u1ebfu \u0111i\u1ec3m thu\u1ed9c v\u1ec1 b\u1ea5t k\u1ef3 c\u1ea1nh n\u00e0o, \u0111i\u1ec3m \u0111\u00f3 n\u1eb1m tr\u00ean c\u1ea1nh m\u00e0 ch\u00fang ta \u0111\u00e3 t\u00ecm th\u1ea5y, ng\u01b0\u1ee3c l\u1ea1i c\u1ea1nh n\u00e0y ph\u1ea3i c\u1eaft \u0111\u01b0\u1eddng th\u1eb3ng $x = x_0$ t\u1ea1i m\u1ed9t \u0111i\u1ec3m duy nh\u1ea5t $(x_0, y)$ trong \u0111\u00f3 $y &lt; y_0$ v\u00e0 $y$ n\u00e0y l\u00e0 l\u1edbn nh\u1ea5t trong s\u1ed1 t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh nh\u01b0 v\u1eady. H\u00ecnh \u1ea3nh sau \u0111\u00e2y cho th\u1ea5y c\u1ea3 hai tr\u01b0\u1eddng h\u1ee3p.</p> <p>Ch\u00fang ta s\u1ebd gi\u1ea3i quy\u1ebft b\u00e0i to\u00e1n n\u00e0y ngo\u1ea1i tuy\u1ebfn b\u1eb1ng thu\u1eadt to\u00e1n qu\u00e9t \u0111\u01b0\u1eddng (sweep line algorithm). H\u00e3y l\u1eb7p qua c\u00e1c t\u1ecda \u0111\u1ed9 x c\u1ee7a c\u00e1c \u0111i\u1ec3m truy v\u1ea5n v\u00e0 c\u00e1c \u0111\u1ea7u m\u00fat c\u1ee7a c\u00e1c c\u1ea1nh theo th\u1ee9 t\u1ef1 t\u0103ng d\u1ea7n v\u00e0 gi\u1eef m\u1ed9t t\u1eadp h\u1ee3p c\u00e1c c\u1ea1nh $s$. \u0110\u1ed1i v\u1edbi m\u1ed7i t\u1ecda \u0111\u1ed9 x, ch\u00fang ta s\u1ebd th\u00eam m\u1ed9t s\u1ed1 s\u1ef1 ki\u1ec7n tr\u01b0\u1edbc.</p> <p>C\u00e1c s\u1ef1 ki\u1ec7n s\u1ebd thu\u1ed9c b\u1ed1n lo\u1ea1i: add (th\u00eam), remove (x\u00f3a), vertical (d\u1ecdc), get (l\u1ea5y). \u0110\u1ed1i v\u1edbi m\u1ed7i c\u1ea1nh d\u1ecdc (c\u1ea3 hai \u0111\u1ea7u m\u00fat \u0111\u1ec1u c\u00f3 c\u00f9ng t\u1ecda \u0111\u1ed9 x), ch\u00fang ta s\u1ebd th\u00eam m\u1ed9t s\u1ef1 ki\u1ec7n vertical cho t\u1ecda \u0111\u1ed9 x t\u01b0\u01a1ng \u1ee9ng. \u0110\u1ed1i v\u1edbi m\u1ecdi c\u1ea1nh kh\u00e1c, ch\u00fang ta s\u1ebd th\u00eam m\u1ed9t s\u1ef1 ki\u1ec7n add cho t\u1ecda \u0111\u1ed9 x nh\u1ecf nh\u1ea5t c\u1ee7a c\u00e1c \u0111\u1ea7u m\u00fat v\u00e0 m\u1ed9t s\u1ef1 ki\u1ec7n remove cho t\u1ecda \u0111\u1ed9 x l\u1edbn nh\u1ea5t c\u1ee7a c\u00e1c \u0111\u1ea7u m\u00fat. Cu\u1ed1i c\u00f9ng, \u0111\u1ed1i v\u1edbi m\u1ed7i \u0111i\u1ec3m truy v\u1ea5n, ch\u00fang ta s\u1ebd th\u00eam m\u1ed9t s\u1ef1 ki\u1ec7n get cho t\u1ecda \u0111\u1ed9 x c\u1ee7a n\u00f3.</p> <p>\u0110\u1ed1i v\u1edbi m\u1ed7i t\u1ecda \u0111\u1ed9 x, ch\u00fang ta s\u1ebd s\u1eafp x\u1ebfp c\u00e1c s\u1ef1 ki\u1ec7n theo lo\u1ea1i c\u1ee7a ch\u00fang theo th\u1ee9 t\u1ef1 (vertical, get, remove, add). H\u00ecnh \u1ea3nh sau \u0111\u00e2y hi\u1ec3n th\u1ecb t\u1ea5t c\u1ea3 c\u00e1c s\u1ef1 ki\u1ec7n theo th\u1ee9 t\u1ef1 \u0111\u00e3 s\u1eafp x\u1ebfp cho m\u1ed7i t\u1ecda \u0111\u1ed9 x.</p> <p>Ch\u00fang ta s\u1ebd gi\u1eef hai t\u1eadp h\u1ee3p trong qu\u00e1 tr\u00ecnh qu\u00e9t \u0111\u01b0\u1eddng. M\u1ed9t t\u1eadp h\u1ee3p $t$ cho t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh kh\u00f4ng d\u1ecdc, v\u00e0 m\u1ed9t t\u1eadp h\u1ee3p $vert$ d\u00e0nh ri\u00eang cho c\u00e1c c\u1ea1nh d\u1ecdc. Ch\u00fang ta s\u1ebd x\u00f3a t\u1eadp h\u1ee3p $vert$ khi b\u1eaft \u0111\u1ea7u x\u1eed l\u00fd t\u1eebng t\u1ecda \u0111\u1ed9 x.</p> <p>B\u00e2y gi\u1edd h\u00e3y x\u1eed l\u00fd c\u00e1c s\u1ef1 ki\u1ec7n cho m\u1ed9t t\u1ecda \u0111\u1ed9 x c\u1ed1 \u0111\u1ecbnh.</p> <ul> <li>N\u1ebfu ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c m\u1ed9t s\u1ef1 ki\u1ec7n vertical, ch\u00fang ta ch\u1ec9 c\u1ea7n ch\u00e8n t\u1ecda \u0111\u1ed9 y nh\u1ecf nh\u1ea5t c\u1ee7a c\u00e1c \u0111\u1ea7u m\u00fat c\u1ee7a c\u1ea1nh t\u01b0\u01a1ng \u1ee9ng v\u00e0o $vert$.</li> <li>N\u1ebfu ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c m\u1ed9t s\u1ef1 ki\u1ec7n remove ho\u1eb7c add, ch\u00fang ta s\u1ebd x\u00f3a c\u1ea1nh t\u01b0\u01a1ng \u1ee9ng kh\u1ecfi $t$ ho\u1eb7c th\u00eam n\u00f3 v\u00e0o $t$.</li> <li>Cu\u1ed1i c\u00f9ng, \u0111\u1ed1i v\u1edbi m\u1ed7i s\u1ef1 ki\u1ec7n get, ch\u00fang ta ph\u1ea3i ki\u1ec3m tra xem \u0111i\u1ec3m c\u00f3 n\u1eb1m tr\u00ean m\u1ed9t c\u1ea1nh d\u1ecdc n\u00e0o \u0111\u00f3 hay kh\u00f4ng b\u1eb1ng c\u00e1ch th\u1ef1c hi\u1ec7n t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n trong $vert$. N\u1ebfu \u0111i\u1ec3m kh\u00f4ng n\u1eb1m tr\u00ean b\u1ea5t k\u1ef3 c\u1ea1nh d\u1ecdc n\u00e0o, ch\u00fang ta ph\u1ea3i t\u00ecm c\u00e2u tr\u1ea3 l\u1eddi cho truy v\u1ea5n n\u00e0y trong $t$. \u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y, ch\u00fang ta l\u1ea1i th\u1ef1c hi\u1ec7n t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n. \u0110\u1ec3 x\u1eed l\u00fd m\u1ed9t s\u1ed1 tr\u01b0\u1eddng h\u1ee3p suy bi\u1ebfn (v\u00ed d\u1ee5: trong tr\u01b0\u1eddng h\u1ee3p tam gi\u00e1c $(0,~0)$, $(0,~2)$, $(1, 1)$ khi ch\u00fang ta truy v\u1ea5n \u0111i\u1ec3m $(0,~0)$), ch\u00fang ta ph\u1ea3i tr\u1ea3 l\u1eddi l\u1ea1i t\u1ea5t c\u1ea3 c\u00e1c s\u1ef1 ki\u1ec7n get sau khi ch\u00fang ta \u0111\u00e3 x\u1eed l\u00fd t\u1ea5t c\u1ea3 c\u00e1c s\u1ef1 ki\u1ec7n cho t\u1ecda \u0111\u1ed9 x n\u00e0y v\u00e0 ch\u1ecdn c\u00e2u tr\u1ea3 l\u1eddi t\u1ed1t nh\u1ea5t trong hai c\u00e2u tr\u1ea3 l\u1eddi.</li> </ul> <p>B\u00e2y gi\u1edd h\u00e3y ch\u1ecdn m\u1ed9t b\u1ed9 so s\u00e1nh cho t\u1eadp h\u1ee3p $t$. B\u1ed9 so s\u00e1nh n\u00e0y n\u00ean ki\u1ec3m tra xem m\u1ed9t c\u1ea1nh c\u00f3 n\u1eb1m tr\u00ean c\u1ea1nh kh\u00e1c \u0111\u1ed1i v\u1edbi m\u1ecdi t\u1ecda \u0111\u1ed9 x m\u00e0 c\u1ea3 hai \u0111\u1ec1u bao ph\u1ee7 hay kh\u00f4ng. Gi\u1ea3 s\u1eed r\u1eb1ng ch\u00fang ta c\u00f3 hai c\u1ea1nh $(a, b)$ v\u00e0 $(c, d)$. Khi \u0111\u00f3 b\u1ed9 so s\u00e1nh l\u00e0 (b\u1eb1ng m\u00e3 gi\u1ea3):</p> <p>$val = sgn((b - a)\\times(c - a)) + sgn((b - a)\\times(d - a))$ if $val \\neq 0$ then return $val &gt; 0$ $val = sgn((d - c)\\times(a - c)) + sgn((d - c)\\times(b - c))$ return $val &lt; 0$</p> <p>B\u00e2y gi\u1edd \u0111\u1ed1i v\u1edbi m\u1ecdi truy v\u1ea5n, ch\u00fang ta c\u00f3 c\u1ea1nh t\u01b0\u01a1ng \u1ee9ng. L\u00e0m th\u1ebf n\u00e0o \u0111\u1ec3 t\u00ecm m\u1eb7t (face)? N\u1ebfu ch\u00fang ta kh\u00f4ng th\u1ec3 t\u00ecm th\u1ea5y c\u1ea1nh, \u0111i\u1ec1u \u0111\u00f3 c\u00f3 ngh\u0129a l\u00e0 \u0111i\u1ec3m n\u1eb1m \u1edf m\u1eb7t ngo\u00e0i. N\u1ebfu \u0111i\u1ec3m thu\u1ed9c v\u1ec1 c\u1ea1nh m\u00e0 ch\u00fang ta t\u00ecm th\u1ea5y, m\u1eb7t kh\u00f4ng ph\u1ea3i l\u00e0 duy nh\u1ea5t. Ng\u01b0\u1ee3c l\u1ea1i, c\u00f3 hai \u1ee9ng vi\u00ean - c\u00e1c m\u1eb7t \u0111\u01b0\u1ee3c gi\u1edbi h\u1ea1n b\u1edfi c\u1ea1nh n\u00e0y. L\u00e0m th\u1ebf n\u00e0o \u0111\u1ec3 ki\u1ec3m tra c\u00e1i n\u00e0o l\u00e0 c\u00e2u tr\u1ea3 l\u1eddi? L\u01b0u \u00fd r\u1eb1ng c\u1ea1nh kh\u00f4ng ph\u1ea3i l\u00e0 d\u1ecdc. Khi \u0111\u00f3 c\u00e2u tr\u1ea3 l\u1eddi l\u00e0 m\u1eb7t n\u1eb1m ph\u00eda tr\u00ean c\u1ea1nh n\u00e0y. H\u00e3y t\u00ecm m\u1ed9t m\u1eb7t nh\u01b0 v\u1eady cho m\u1ed7i c\u1ea1nh kh\u00f4ng d\u1ecdc. Xem x\u00e9t vi\u1ec7c duy\u1ec7t ng\u01b0\u1ee3c chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3 c\u1ee7a t\u1eebng m\u1eb7t. N\u1ebfu trong qu\u00e1 tr\u00ecnh duy\u1ec7t n\u00e0y, ch\u00fang ta t\u0103ng t\u1ecda \u0111\u1ed9 x trong khi \u0111i qua c\u1ea1nh, th\u00ec m\u1eb7t n\u00e0y l\u00e0 m\u1eb7t ch\u00fang ta c\u1ea7n t\u00ecm cho c\u1ea1nh n\u00e0y.</p>","tags":["Translated"]},{"location":"geometry/point-location.html#notes","title":"Ghi ch\u00fa (Notes)","text":"<p>Th\u1ef1c ra, v\u1edbi c\u00e2y b\u1ec1n v\u1eefng (persistent trees), ph\u01b0\u01a1ng ph\u00e1p n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n tr\u1ef1c tuy\u1ebfn (online).</p>","tags":["Translated"]},{"location":"geometry/point-location.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>M\u00e3 sau \u0111\u00e2y \u0111\u01b0\u1ee3c c\u00e0i \u0111\u1eb7t cho s\u1ed1 nguy\u00ean, nh\u01b0ng n\u00f3 c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng s\u1eeda \u0111\u1ed5i \u0111\u1ec3 l\u00e0m vi\u1ec7c v\u1edbi s\u1ed1 th\u1ef1c (b\u1eb1ng c\u00e1ch thay \u0111\u1ed5i c\u00e1c ph\u01b0\u01a1ng th\u1ee9c so s\u00e1nh v\u00e0 ki\u1ec3u \u0111i\u1ec3m). Vi\u1ec7c c\u00e0i \u0111\u1eb7t n\u00e0y gi\u1ea3 \u0111\u1ecbnh r\u1eb1ng ph\u00e2n ho\u1ea1ch \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef ch\u00ednh x\u00e1c b\u00ean trong m\u1ed9t DCEL v\u00e0 m\u1eb7t ngo\u00e0i \u0111\u01b0\u1ee3c \u0111\u00e1nh s\u1ed1 $-1$. \u0110\u1ed1i v\u1edbi m\u1ed7i truy v\u1ea5n, m\u1ed9t c\u1eb7p $(1, i)$ \u0111\u01b0\u1ee3c tr\u1ea3 v\u1ec1 n\u1ebfu \u0111i\u1ec3m n\u1eb1m ho\u00e0n to\u00e0n b\u00ean trong m\u1eb7t s\u1ed1 $i$, v\u00e0 m\u1ed9t c\u1eb7p $(0, i)$ \u0111\u01b0\u1ee3c tr\u1ea3 v\u1ec1 n\u1ebfu \u0111i\u1ec3m n\u1eb1m tr\u00ean c\u1ea1nh s\u1ed1 $i$.</p> <pre><code>typedef long long ll;\n\nbool ge(const ll&amp; a, const ll&amp; b) { return a &gt;= b; }\nbool le(const ll&amp; a, const ll&amp; b) { return a &lt;= b; }\nbool eq(const ll&amp; a, const ll&amp; b) { return a == b; }\nbool gt(const ll&amp; a, const ll&amp; b) { return a &gt; b; }\nbool lt(const ll&amp; a, const ll&amp; b) { return a &lt; b; }\nint sgn(const ll&amp; x) { return le(x, 0) ? eq(x, 0) ? 0 : -1 : 1; }\n\nstruct pt {\n    ll x, y;\n    pt() {}\n    pt(ll _x, ll _y) : x(_x), y(_y) {}\n    pt operator-(const pt&amp; a) const { return pt(x - a.x, y - a.y); }\n    ll dot(const pt&amp; a) const { return x * a.x + y * a.y; }\n    ll dot(const pt&amp; a, const pt&amp; b) const { return (a - *this).dot(b - *this); }\n    ll cross(const pt&amp; a) const { return x * a.y - y * a.x; }\n    ll cross(const pt&amp; a, const pt&amp; b) const { return (a - *this).cross(b - *this); }\n    bool operator==(const pt&amp; a) const { return a.x == x &amp;&amp; a.y == y; }\n};\n\nstruct Edge {\n    pt l, r;\n};\n\nbool edge_cmp(Edge* edge1, Edge* edge2)\n{\n    const pt a = edge1-&gt;l, b = edge1-&gt;r;\n    const pt c = edge2-&gt;l, d = edge2-&gt;r;\n    int val = sgn(a.cross(b, c)) + sgn(a.cross(b, d));\n    if (val != 0)\n        return val &gt; 0;\n    val = sgn(c.cross(d, a)) + sgn(c.cross(d, b));\n    return val &lt; 0;\n}\n\nenum EventType { DEL = 2, ADD = 3, GET = 1, VERT = 0 };\n\nstruct Event {\n    EventType type;\n    int pos;\n    bool operator&lt;(const Event&amp; event) const { return type &lt; event.type; }\n};\n\nvector&lt;Edge*&gt; sweepline(vector&lt;Edge*&gt; planar, vector&lt;pt&gt; queries)\n{\n    using pt_type = decltype(pt::x);\n\n    // collect all x-coordinates\n    auto s =\n        set&lt;pt_type, std::function&lt;bool(const pt_type&amp;, const pt_type&amp;)&gt;&gt;(lt);\n    for (pt p : queries)\n        s.insert(p.x);\n    for (Edge* e : planar) {\n        s.insert(e-&gt;l.x);\n        s.insert(e-&gt;r.x);\n    }\n\n    // map all x-coordinates to ids\n    int cid = 0;\n    auto id =\n        map&lt;pt_type, int, std::function&lt;bool(const pt_type&amp;, const pt_type&amp;)&gt;&gt;(\n            lt);\n    for (auto x : s)\n        id[x] = cid++;\n\n    // create events\n    auto t = set&lt;Edge*, decltype(*edge_cmp)&gt;(edge_cmp);\n    auto vert_cmp = [](const pair&lt;pt_type, int&gt;&amp; l,\n                       const pair&lt;pt_type, int&gt;&amp; r) {\n        if (!eq(l.first, r.first))\n            return lt(l.first, r.first);\n        return l.second &lt; r.second;\n    };\n    auto vert = set&lt;pair&lt;pt_type, int&gt;, decltype(vert_cmp)&gt;(vert_cmp);\n    vector&lt;vector&lt;Event&gt;&gt; events(cid);\n    for (int i = 0; i &lt; (int)queries.size(); i++) {\n        int x = id[queries[i].x];\n        events[x].push_back(Event{GET, i});\n    }\n    for (int i = 0; i &lt; (int)planar.size(); i++) {\n        int lx = id[planar[i]-&gt;l.x], rx = id[planar[i]-&gt;r.x];\n        if (lx &gt; rx) {\n            swap(lx, rx);\n            swap(planar[i]-&gt;l, planar[i]-&gt;r);\n        }\n        if (lx == rx) {\n            events[lx].push_back(Event{VERT, i});\n        } else {\n            events[lx].push_back(Event{ADD, i});\n            events[rx].push_back(Event{DEL, i});\n        }\n    }\n\n    // perform sweep line algorithm\n    vector&lt;Edge*&gt; ans(queries.size(), nullptr);\n    for (int x = 0; x &lt; cid; x++) {\n        sort(events[x].begin(), events[x].end());\n        vert.clear();\n        for (Event event : events[x]) {\n            if (event.type == DEL) {\n                t.erase(planar[event.pos]);\n            }\n            if (event.type == VERT) {\n                vert.insert(make_pair(\n                    min(planar[event.pos]-&gt;l.y, planar[event.pos]-&gt;r.y),\n                    event.pos));\n            }\n            if (event.type == ADD) {\n                t.insert(planar[event.pos]);\n            }\n            if (event.type == GET) {\n                auto jt = vert.upper_bound(\n                    make_pair(queries[event.pos].y, planar.size()));\n                if (jt != vert.begin()) {\n                    --jt;\n                    int i = jt-&gt;second;\n                    if (ge(max(planar[i]-&gt;l.y, planar[i]-&gt;r.y),\n                           queries[event.pos].y)) {\n                        ans[event.pos] = planar[i];\n                        continue;\n                    }\n                }\n                Edge* e = new Edge;\n                e-&gt;l = e-&gt;r = queries[event.pos];\n                auto it = t.upper_bound(e);\n                if (it != t.begin())\n                    ans[event.pos] = *(--it);\n                delete e;\n            }\n        }\n\n        for (Event event : events[x]) {\n            if (event.type != GET)\n                continue;\n            if (ans[event.pos] != nullptr &amp;&amp;\n                eq(ans[event.pos]-&gt;l.x, ans[event.pos]-&gt;r.x))\n                continue;\n\n            Edge* e = new Edge;\n            e-&gt;l = e-&gt;r = queries[event.pos];\n            auto it = t.upper_bound(e);\n            delete e;\n            if (it == t.begin())\n                e = nullptr;\n            else\n                e = *(--it);\n            if (ans[event.pos] == nullptr) {\n                ans[event.pos] = e;\n                continue;\n            }\n            if (e == nullptr)\n                continue;\n            if (e == ans[event.pos])\n                continue;\n            if (id[ans[event.pos]-&gt;r.x] == x) {\n                if (id[e-&gt;l.x] == x) {\n                    if (gt(e-&gt;l.y, ans[event.pos]-&gt;r.y))\n                        ans[event.pos] = e;\n                }\n            } else {\n                ans[event.pos] = e;\n            }\n        }\n    }\n    return ans;\n}\n\nstruct DCEL {\n    struct Edge {\n        pt origin;\n        Edge* nxt = nullptr;\n        Edge* twin = nullptr;\n        int face;\n    };\n    vector&lt;Edge*&gt; body;\n};\n\nvector&lt;pair&lt;int, int&gt;&gt; point_location(DCEL planar, vector&lt;pt&gt; queries)\n{\n    vector&lt;pair&lt;int, int&gt;&gt; ans(queries.size());\n    vector&lt;Edge*&gt; planar2;\n    map&lt;intptr_t, int&gt; pos;\n    map&lt;intptr_t, int&gt; added_on;\n    int n = planar.body.size();\n    for (int i = 0; i &lt; n; i++) {\n        if (planar.body[i]-&gt;face &gt; planar.body[i]-&gt;twin-&gt;face)\n            continue;\n        Edge* e = new Edge;\n        e-&gt;l = planar.body[i]-&gt;origin;\n        e-&gt;r = planar.body[i]-&gt;twin-&gt;origin;\n        added_on[(intptr_t)e] = i;\n        pos[(intptr_t)e] =\n            lt(planar.body[i]-&gt;origin.x, planar.body[i]-&gt;twin-&gt;origin.x)\n                ? planar.body[i]-&gt;face\n                : planar.body[i]-&gt;twin-&gt;face;\n        planar2.push_back(e);\n    }\n    auto res = sweepline(planar2, queries);\n    for (int i = 0; i &lt; (int)queries.size(); i++) {\n        if (res[i] == nullptr) {\n            ans[i] = make_pair(1, -1);\n            continue;\n        }\n        pt p = queries[i];\n        pt l = res[i]-&gt;l, r = res[i]-&gt;r;\n        if (eq(p.cross(l, r), 0) &amp;&amp; le(p.dot(l, r), 0)) {\n            ans[i] = make_pair(0, added_on[(intptr_t)res[i]]);\n            continue;\n        }\n        ans[i] = make_pair(1, pos[(intptr_t)res[i]]);\n    }\n    for (auto e : planar2)\n        delete e;\n    return ans;\n}\n</code></pre>","tags":["Translated"]},{"location":"geometry/point-location.html#problems","title":"B\u00e0i t\u1eadp (Problems)","text":"<ul> <li>TIMUS 1848 Fly Hunt</li> <li>UVA 12310 Point Location</li> </ul>","tags":["Translated"]},{"location":"geometry/segment-to-line.html","title":"T\u00ecm ph\u01b0\u01a1ng tr\u00ecnh \u0111\u01b0\u1eddng th\u1eb3ng cho m\u1ed9t \u0111o\u1ea1n th\u1eb3ng (Finding the equation of a line for a segment)","text":"<p>Nhi\u1ec7m v\u1ee5 l\u00e0: cho t\u1ecda \u0111\u1ed9 c\u00e1c \u0111\u1ea7u m\u00fat c\u1ee7a m\u1ed9t \u0111o\u1ea1n th\u1eb3ng, x\u00e2y d\u1ef1ng m\u1ed9t \u0111\u01b0\u1eddng th\u1eb3ng \u0111i qua n\u00f3.</p> <p>Ch\u00fang ta gi\u1ea3 s\u1eed r\u1eb1ng \u0111o\u1ea1n th\u1eb3ng l\u00e0 kh\u00f4ng suy bi\u1ebfn, t\u1ee9c l\u00e0 c\u00f3 \u0111\u1ed9 d\u00e0i l\u1edbn h\u01a1n 0 (n\u1ebfu kh\u00f4ng, t\u1ea5t nhi\u00ean, c\u00f3 v\u00f4 s\u1ed1 \u0111\u01b0\u1eddng th\u1eb3ng kh\u00e1c nhau \u0111i qua n\u00f3).</p>","tags":["Translated"]},{"location":"geometry/segment-to-line.html#two-dimensional-case","title":"Tr\u01b0\u1eddng h\u1ee3p hai chi\u1ec1u (Two-dimensional case)","text":"<p>Gi\u1ea3 s\u1eed \u0111o\u1ea1n th\u1eb3ng \u0111\u00e3 cho l\u00e0 $PQ$, t\u1ee9c l\u00e0 t\u1ecda \u0111\u1ed9 \u0111\u00e3 bi\u1ebft c\u1ee7a c\u00e1c \u0111\u1ea7u m\u00fat c\u1ee7a n\u00f3 l\u00e0 $P_x , P_y , Q_x , Q_y$.</p> <p>C\u1ea7n ph\u1ea3i x\u00e2y d\u1ef1ng ph\u01b0\u01a1ng tr\u00ecnh \u0111\u01b0\u1eddng th\u1eb3ng trong m\u1eb7t ph\u1eb3ng \u0111i qua \u0111o\u1ea1n th\u1eb3ng n\u00e0y, t\u1ee9c l\u00e0 t\u00ecm c\u00e1c h\u1ec7 s\u1ed1 $A , B , C$ trong ph\u01b0\u01a1ng tr\u00ecnh \u0111\u01b0\u1eddng th\u1eb3ng:</p> $$A x + B y + C = 0.$$ <p>L\u01b0u \u00fd r\u1eb1ng \u0111\u1ed1i v\u1edbi c\u00e1c b\u1ed9 ba $(A, B, C)$ \u0111\u01b0\u1ee3c y\u00eau c\u1ea7u, c\u00f3 v\u00f4 s\u1ed1 nghi\u1ec7m m\u00f4 t\u1ea3 \u0111o\u1ea1n th\u1eb3ng \u0111\u00e3 cho: b\u1ea1n c\u00f3 th\u1ec3 nh\u00e2n t\u1ea5t c\u1ea3 ba h\u1ec7 s\u1ed1 v\u1edbi m\u1ed9t s\u1ed1 kh\u00e1c kh\u00f4ng t\u00f9y \u00fd v\u00e0 nh\u1eadn \u0111\u01b0\u1ee3c c\u00f9ng m\u1ed9t \u0111\u01b0\u1eddng th\u1eb3ng. Do \u0111\u00f3, nhi\u1ec7m v\u1ee5 c\u1ee7a ch\u00fang ta l\u00e0 t\u00ecm m\u1ed9t trong nh\u1eefng b\u1ed9 ba n\u00e0y.</p> <p>D\u1ec5 d\u00e0ng x\u00e1c minh (b\u1eb1ng c\u00e1ch thay th\u1ebf c\u00e1c bi\u1ec3u th\u1ee9c n\u00e0y v\u00e0 t\u1ecda \u0111\u1ed9 c\u1ee7a c\u00e1c \u0111i\u1ec3m $P$ v\u00e0 $Q$ v\u00e0o ph\u01b0\u01a1ng tr\u00ecnh \u0111\u01b0\u1eddng th\u1eb3ng) r\u1eb1ng b\u1ed9 h\u1ec7 s\u1ed1 sau ph\u00f9 h\u1ee3p:</p> $$\\begin{align} A &amp;= P_y - Q_y, \\\\ B &amp;= Q_x - P_x, \\\\ C &amp;= - A P_x - B P_y. \\end{align}$$","tags":["Translated"]},{"location":"geometry/segment-to-line.html#integer-case","title":"Tr\u01b0\u1eddng h\u1ee3p s\u1ed1 nguy\u00ean (Integer case)","text":"<p>M\u1ed9t l\u1ee3i th\u1ebf quan tr\u1ecdng c\u1ee7a ph\u01b0\u01a1ng ph\u00e1p x\u00e2y d\u1ef1ng \u0111\u01b0\u1eddng th\u1eb3ng n\u00e0y l\u00e0 n\u1ebfu t\u1ecda \u0111\u1ed9 c\u1ee7a c\u00e1c \u0111\u1ea7u m\u00fat l\u00e0 s\u1ed1 nguy\u00ean, th\u00ec c\u00e1c h\u1ec7 s\u1ed1 thu \u0111\u01b0\u1ee3c c\u0169ng s\u1ebd l\u00e0 s\u1ed1 nguy\u00ean. Trong m\u1ed9t s\u1ed1 tr\u01b0\u1eddng h\u1ee3p, \u0111i\u1ec1u n\u00e0y cho ph\u00e9p th\u1ef1c hi\u1ec7n c\u00e1c ph\u00e9p to\u00e1n h\u00ecnh h\u1ecdc m\u00e0 kh\u00f4ng c\u1ea7n d\u00f9ng \u0111\u1ebfn s\u1ed1 th\u1ef1c.</p> <p>Tuy nhi\u00ean, c\u00f3 m\u1ed9t nh\u01b0\u1ee3c \u0111i\u1ec3m nh\u1ecf: \u0111\u1ed1i v\u1edbi c\u00f9ng m\u1ed9t \u0111\u01b0\u1eddng th\u1eb3ng, c\u00f3 th\u1ec3 thu \u0111\u01b0\u1ee3c c\u00e1c b\u1ed9 ba h\u1ec7 s\u1ed1 kh\u00e1c nhau. \u0110\u1ec3 tr\u00e1nh \u0111i\u1ec1u n\u00e0y, nh\u01b0ng kh\u00f4ng \u0111i xa kh\u1ecfi c\u00e1c h\u1ec7 s\u1ed1 nguy\u00ean, b\u1ea1n c\u00f3 th\u1ec3 \u00e1p d\u1ee5ng k\u1ef9 thu\u1eadt sau, th\u01b0\u1eddng \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 t\u1ed1i gi\u1ea3n h\u00f3a (rationing). T\u00ecm \u01b0\u1edbc chung l\u1edbn nh\u1ea5t c\u1ee7a c\u00e1c s\u1ed1 $| A | , | B | , | C |$, ch\u00fang ta chia t\u1ea5t c\u1ea3 ba h\u1ec7 s\u1ed1 cho n\u00f3, v\u00e0 sau \u0111\u00f3 ch\u00fang ta th\u1ef1c hi\u1ec7n vi\u1ec7c chu\u1ea9n h\u00f3a d\u1ea5u: n\u1ebfu $A &lt;0$ ho\u1eb7c $A = 0, B &lt;0$ th\u00ec nh\u00e2n t\u1ea5t c\u1ea3 ba h\u1ec7 s\u1ed1 v\u1edbi $-1$. K\u1ebft qu\u1ea3 l\u00e0, ch\u00fang ta s\u1ebd \u0111i \u0111\u1ebfn k\u1ebft lu\u1eadn r\u1eb1ng \u0111\u1ed1i v\u1edbi c\u00e1c \u0111\u01b0\u1eddng th\u1eb3ng gi\u1ed1ng h\u1ec7t nhau, c\u00e1c b\u1ed9 ba h\u1ec7 s\u1ed1 gi\u1ed1ng h\u1ec7t nhau s\u1ebd thu \u0111\u01b0\u1ee3c, \u0111i\u1ec1u n\u00e0y gi\u00fap d\u1ec5 d\u00e0ng ki\u1ec3m tra c\u00e1c \u0111\u01b0\u1eddng th\u1eb3ng c\u00f3 b\u1eb1ng nhau hay kh\u00f4ng.</p>","tags":["Translated"]},{"location":"geometry/segment-to-line.html#real-case","title":"Tr\u01b0\u1eddng h\u1ee3p s\u1ed1 th\u1ef1c (Real case)","text":"<p>Khi l\u00e0m vi\u1ec7c v\u1edbi s\u1ed1 th\u1ef1c, b\u1ea1n ph\u1ea3i lu\u00f4n nh\u1eadn th\u1ee9c \u0111\u01b0\u1ee3c c\u00e1c sai s\u1ed1.</p> <p>C\u00e1c h\u1ec7 s\u1ed1 $A$ v\u00e0 $B$ s\u1ebd c\u00f3 b\u1eadc c\u1ee7a c\u00e1c t\u1ecda \u0111\u1ed9 ban \u0111\u1ea7u, h\u1ec7 s\u1ed1 $C$ c\u00f3 b\u1eadc c\u1ee7a b\u00ecnh ph\u01b0\u01a1ng c\u1ee7a ch\u00fang. \u0110\u00e2y c\u00f3 th\u1ec3 \u0111\u00e3 l\u00e0 nh\u1eefng con s\u1ed1 kh\u00e1 l\u1edbn, v\u00e0, v\u00ed d\u1ee5, khi ch\u00fang ta c\u1eaft c\u00e1c \u0111\u01b0\u1eddng th\u1eb3ng, ch\u00fang s\u1ebd tr\u1edf n\u00ean l\u1edbn h\u01a1n n\u1eefa, \u0111i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 d\u1eabn \u0111\u1ebfn sai s\u1ed1 l\u00e0m tr\u00f2n l\u1edbn ngay c\u1ea3 khi t\u1ecda \u0111\u1ed9 c\u1ee7a c\u00e1c \u0111i\u1ec3m cu\u1ed1i c\u00f3 b\u1eadc $10^3$.</p> <p>Do \u0111\u00f3, khi l\u00e0m vi\u1ec7c v\u1edbi s\u1ed1 th\u1ef1c, mong mu\u1ed1n t\u1ea1o ra c\u00e1i g\u1ecdi l\u00e0 chu\u1ea9n h\u00f3a (normalization), \u0111i\u1ec1u n\u00e0y r\u1ea5t \u0111\u01a1n gi\u1ea3n: c\u1ee5 th\u1ec3 l\u00e0 l\u00e0m cho c\u00e1c h\u1ec7 s\u1ed1 sao cho $A ^ 2 + B ^ 2 = 1$. \u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y, h\u00e3y t\u00ednh s\u1ed1 $Z$:</p> $$Z = \\sqrt{A ^ 2 + B ^ 2},$$ <p>v\u00e0 chia t\u1ea5t c\u1ea3 ba h\u1ec7 s\u1ed1 $A , B , C$ cho n\u00f3.</p> <p>Do \u0111\u00f3, b\u1eadc c\u1ee7a c\u00e1c h\u1ec7 s\u1ed1 $A$ v\u00e0 $B$ s\u1ebd kh\u00f4ng ph\u1ee5 thu\u1ed9c v\u00e0o b\u1eadc c\u1ee7a c\u00e1c t\u1ecda \u0111\u1ed9 \u0111\u1ea7u v\u00e0o, v\u00e0 h\u1ec7 s\u1ed1 $C$ s\u1ebd c\u00f9ng b\u1eadc v\u1edbi c\u00e1c t\u1ecda \u0111\u1ed9 \u0111\u1ea7u v\u00e0o. Trong th\u1ef1c t\u1ebf, \u0111i\u1ec1u n\u00e0y d\u1eabn \u0111\u1ebfn s\u1ef1 c\u1ea3i thi\u1ec7n \u0111\u00e1ng k\u1ec3 v\u1ec1 \u0111\u1ed9 ch\u00ednh x\u00e1c c\u1ee7a c\u00e1c t\u00ednh to\u00e1n.</p> <p>Cu\u1ed1i c\u00f9ng, ch\u00fang t\u00f4i \u0111\u1ec1 c\u1eadp \u0111\u1ebfn vi\u1ec7c so s\u00e1nh c\u00e1c \u0111\u01b0\u1eddng th\u1eb3ng - tr\u00ean th\u1ef1c t\u1ebf, sau khi chu\u1ea9n h\u00f3a nh\u01b0 v\u1eady, \u0111\u1ed1i v\u1edbi c\u00f9ng m\u1ed9t \u0111\u01b0\u1eddng th\u1eb3ng, ch\u1ec9 c\u00f3 hai b\u1ed9 ba h\u1ec7 s\u1ed1 c\u00f3 th\u1ec3 thu \u0111\u01b0\u1ee3c: sai kh\u00e1c nhau m\u1ed9t ph\u00e9p nh\u00e2n v\u1edbi $-1$. Theo \u0111\u00f3, n\u1ebfu ch\u00fang ta th\u1ef1c hi\u1ec7n m\u1ed9t chu\u1ea9n h\u00f3a b\u1ed5 sung t\u00ednh \u0111\u1ebfn d\u1ea5u (n\u1ebfu $A &lt; -\\varepsilon$ ho\u1eb7c $| A | &lt; \\varepsilon$, $B &lt;- \\varepsilon$ th\u00ec nh\u00e2n v\u1edbi $-1$), c\u00e1c h\u1ec7 s\u1ed1 k\u1ebft qu\u1ea3 s\u1ebd l\u00e0 duy nh\u1ea5t.</p>","tags":["Translated"]},{"location":"geometry/segment-to-line.html#three-dimensional-and-multidimensional-case","title":"Tr\u01b0\u1eddng h\u1ee3p ba chi\u1ec1u v\u00e0 \u0111a chi\u1ec1u (Three-dimensional and multidimensional case)","text":"<p>Ngay c\u1ea3 trong tr\u01b0\u1eddng h\u1ee3p ba chi\u1ec1u, kh\u00f4ng c\u00f3 ph\u01b0\u01a1ng tr\u00ecnh \u0111\u01a1n gi\u1ea3n n\u00e0o m\u00f4 t\u1ea3 m\u1ed9t \u0111\u01b0\u1eddng th\u1eb3ng (n\u00f3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a l\u00e0 giao \u0111i\u1ec3m c\u1ee7a hai m\u1eb7t ph\u1eb3ng, t\u1ee9c l\u00e0, m\u1ed9t h\u1ec7 th\u1ed1ng g\u1ed3m hai ph\u01b0\u01a1ng tr\u00ecnh, nh\u01b0ng \u0111\u00e2y l\u00e0 m\u1ed9t ph\u01b0\u01a1ng ph\u00e1p b\u1ea5t ti\u1ec7n).</p> <p>Do \u0111\u00f3, trong c\u00e1c tr\u01b0\u1eddng h\u1ee3p ba chi\u1ec1u v\u00e0 \u0111a chi\u1ec1u, ch\u00fang ta ph\u1ea3i s\u1eed d\u1ee5ng ph\u01b0\u01a1ng ph\u00e1p tham s\u1ed1 \u0111\u1ec3 \u0111\u1ecbnh ngh\u0129a m\u1ed9t \u0111\u01b0\u1eddng th\u1eb3ng, t\u1ee9c l\u00e0 d\u01b0\u1edbi d\u1ea1ng m\u1ed9t \u0111i\u1ec3m $p$ v\u00e0 m\u1ed9t vector $v$:</p> $$p + v t, ~~~ t \\in \\mathbb{R}.$$ <p>T\u1ee9c l\u00e0 m\u1ed9t \u0111\u01b0\u1eddng th\u1eb3ng l\u00e0 t\u1ea5t c\u1ea3 c\u00e1c \u0111i\u1ec3m c\u00f3 th\u1ec3 thu \u0111\u01b0\u1ee3c t\u1eeb m\u1ed9t \u0111i\u1ec3m $p$ c\u1ed9ng v\u1edbi m\u1ed9t vector $v$ v\u1edbi m\u1ed9t h\u1ec7 s\u1ed1 t\u00f9y \u00fd (tham s\u1ed1 $t$).</p> <p>Vi\u1ec7c x\u00e2y d\u1ef1ng m\u1ed9t \u0111\u01b0\u1eddng th\u1eb3ng \u1edf d\u1ea1ng tham s\u1ed1 d\u1ecdc theo t\u1ecda \u0111\u1ed9 c\u1ee7a c\u00e1c \u0111\u1ea7u m\u00fat c\u1ee7a m\u1ed9t \u0111o\u1ea1n th\u1eb3ng l\u00e0 t\u1ea7m th\u01b0\u1eddng, ch\u00fang ta ch\u1ec9 c\u1ea7n l\u1ea5y m\u1ed9t \u0111\u1ea7u c\u1ee7a \u0111o\u1ea1n th\u1eb3ng cho \u0111i\u1ec3m $p$, v\u00e0 vector t\u1eeb \u0111\u1ea7u th\u1ee9 nh\u1ea5t \u0111\u1ebfn \u0111\u1ea7u th\u1ee9 hai \u2014 cho vector $v$.</p>","tags":["Translated"]},{"location":"geometry/segments-intersection.html","title":"T\u00ecm giao c\u1ee7a hai \u0111o\u1ea1n th\u1eb3ng (Finding intersection of two segments)","text":"<p>B\u1ea1n \u0111\u01b0\u1ee3c cho hai \u0111o\u1ea1n th\u1eb3ng AB v\u00e0 CD, \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 d\u01b0\u1edbi d\u1ea1ng c\u00e1c c\u1eb7p \u0111i\u1ec3m \u0111\u1ea7u m\u00fat c\u1ee7a ch\u00fang. M\u1ed7i \u0111o\u1ea1n th\u1eb3ng c\u00f3 th\u1ec3 l\u00e0 m\u1ed9t \u0111i\u1ec3m duy nh\u1ea5t n\u1ebfu c\u00e1c \u0111i\u1ec3m \u0111\u1ea7u m\u00fat c\u1ee7a n\u00f3 gi\u1ed1ng nhau. B\u1ea1n ph\u1ea3i t\u00ecm giao c\u1ee7a c\u00e1c \u0111o\u1ea1n th\u1eb3ng n\u00e0y, c\u00f3 th\u1ec3 l\u00e0 r\u1ed7ng (n\u1ebfu c\u00e1c \u0111o\u1ea1n th\u1eb3ng kh\u00f4ng c\u1eaft nhau), m\u1ed9t \u0111i\u1ec3m duy nh\u1ea5t ho\u1eb7c m\u1ed9t \u0111o\u1ea1n th\u1eb3ng (n\u1ebfu c\u00e1c \u0111o\u1ea1n th\u1eb3ng \u0111\u00e3 cho ch\u1ed3ng l\u1ea5n l\u00ean nhau).</p>","tags":["Translated"]},{"location":"geometry/segments-intersection.html#solution","title":"Gi\u1ea3i ph\u00e1p (Solution)","text":"<p>Ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm \u0111i\u1ec3m giao nhau c\u1ee7a c\u00e1c \u0111o\u1ea1n th\u1eb3ng theo c\u00e1ch t\u01b0\u01a1ng t\u1ef1 nh\u01b0 giao \u0111i\u1ec3m c\u1ee7a c\u00e1c \u0111\u01b0\u1eddng th\u1eb3ng: x\u00e2y d\u1ef1ng l\u1ea1i ph\u01b0\u01a1ng tr\u00ecnh \u0111\u01b0\u1eddng th\u1eb3ng t\u1eeb c\u00e1c \u0111i\u1ec3m \u0111\u1ea7u m\u00fat c\u1ee7a \u0111o\u1ea1n th\u1eb3ng v\u00e0 ki\u1ec3m tra xem ch\u00fang c\u00f3 song song hay kh\u00f4ng.</p> <p>N\u1ebfu c\u00e1c \u0111\u01b0\u1eddng th\u1eb3ng kh\u00f4ng song song, ch\u00fang ta c\u1ea7n t\u00ecm \u0111i\u1ec3m giao nhau c\u1ee7a ch\u00fang v\u00e0 ki\u1ec3m tra xem n\u00f3 c\u00f3 thu\u1ed9c v\u1ec1 c\u1ea3 hai \u0111o\u1ea1n th\u1eb3ng hay kh\u00f4ng (\u0111\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y, \u0111\u1ee7 \u0111\u1ec3 x\u00e1c minh r\u1eb1ng \u0111i\u1ec3m giao nhau thu\u1ed9c v\u1ec1 t\u1eebng \u0111o\u1ea1n th\u1eb3ng \u0111\u01b0\u1ee3c chi\u1ebfu tr\u00ean c\u00e1c tr\u1ee5c X v\u00e0 Y). Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, c\u00e2u tr\u1ea3 l\u1eddi s\u1ebd l\u00e0 \"kh\u00f4ng giao nhau\" ho\u1eb7c \u0111i\u1ec3m giao nhau duy nh\u1ea5t c\u1ee7a c\u00e1c \u0111\u01b0\u1eddng th\u1eb3ng.</p> <p>Tr\u01b0\u1eddng h\u1ee3p c\u00e1c \u0111\u01b0\u1eddng th\u1eb3ng song song ph\u1ee9c t\u1ea1p h\u01a1n m\u1ed9t ch\u00fat (tr\u01b0\u1eddng h\u1ee3p m\u1ed9t ho\u1eb7c nhi\u1ec1u \u0111o\u1ea1n th\u1eb3ng l\u00e0 m\u1ed9t \u0111i\u1ec3m duy nh\u1ea5t c\u0169ng thu\u1ed9c v\u1ec1 \u0111\u00e2y). Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, ch\u00fang ta c\u1ea7n ki\u1ec3m tra xem c\u1ea3 hai \u0111o\u1ea1n th\u1eb3ng c\u00f3 thu\u1ed9c c\u00f9ng m\u1ed9t \u0111\u01b0\u1eddng th\u1eb3ng hay kh\u00f4ng. N\u1ebfu kh\u00f4ng, c\u00e2u tr\u1ea3 l\u1eddi l\u00e0 \"kh\u00f4ng giao nhau\". N\u1ebfu c\u00f3, c\u00e2u tr\u1ea3 l\u1eddi l\u00e0 giao c\u1ee7a c\u00e1c \u0111o\u1ea1n th\u1eb3ng thu\u1ed9c c\u00f9ng m\u1ed9t \u0111\u01b0\u1eddng th\u1eb3ng, thu \u0111\u01b0\u1ee3c b\u1eb1ng c\u00e1ch s\u1eafp x\u1ebfp c\u00e1c \u0111i\u1ec3m \u0111\u1ea7u m\u00fat c\u1ee7a c\u1ea3 hai \u0111o\u1ea1n th\u1eb3ng theo th\u1ee9 t\u1ef1 t\u0103ng d\u1ea7n c\u1ee7a m\u1ed9t t\u1ecda \u0111\u1ed9 nh\u1ea5t \u0111\u1ecbnh v\u00e0 l\u1ea5y \u0111i\u1ec3m c\u1ef1c ph\u1ea3i c\u1ee7a c\u00e1c \u0111i\u1ec3m \u0111\u1ea7u m\u00fat tr\u00e1i v\u00e0 \u0111i\u1ec3m c\u1ef1c tr\u00e1i c\u1ee7a c\u00e1c \u0111i\u1ec3m \u0111\u1ea7u m\u00fat ph\u1ea3i.</p> <p>N\u1ebfu c\u1ea3 hai \u0111o\u1ea1n th\u1eb3ng l\u00e0 c\u00e1c \u0111i\u1ec3m \u0111\u01a1n l\u1ebb, c\u00e1c \u0111i\u1ec3m n\u00e0y ph\u1ea3i gi\u1ed1ng h\u1ec7t nhau, v\u00e0 vi\u1ec7c th\u1ef1c hi\u1ec7n ki\u1ec3m tra n\u00e0y ri\u00eang bi\u1ec7t l\u00e0 h\u1ee3p l\u00fd.</p> <p>\u1ede \u0111\u1ea7u thu\u1eadt to\u00e1n, h\u00e3y th\u00eam m\u1ed9t ki\u1ec3m tra h\u1ed9p bao (bounding box) - \u0111i\u1ec1u n\u00e0y c\u1ea7n thi\u1ebft cho tr\u01b0\u1eddng h\u1ee3p khi c\u00e1c \u0111o\u1ea1n th\u1eb3ng thu\u1ed9c c\u00f9ng m\u1ed9t \u0111\u01b0\u1eddng th\u1eb3ng, v\u00e0 (l\u00e0 m\u1ed9t ki\u1ec3m tra nh\u1eb9) n\u00f3 cho ph\u00e9p thu\u1eadt to\u00e1n ho\u1ea1t \u0111\u1ed9ng nhanh h\u01a1n trung b\u00ecnh tr\u00ean c\u00e1c th\u1eed nghi\u1ec7m ng\u1eabu nhi\u00ean.</p>","tags":["Translated"]},{"location":"geometry/segments-intersection.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 c\u00e0i \u0111\u1eb7t, bao g\u1ed3m t\u1ea5t c\u1ea3 c\u00e1c h\u00e0m tr\u1ee3 gi\u00fap cho vi\u1ec7c x\u1eed l\u00fd \u0111\u01b0\u1eddng th\u1eb3ng v\u00e0 \u0111o\u1ea1n th\u1eb3ng.</p> <p>H\u00e0m ch\u00ednh <code>intersect</code> tr\u1ea3 v\u1ec1 true n\u1ebfu c\u00e1c \u0111o\u1ea1n th\u1eb3ng c\u00f3 giao \u0111i\u1ec3m kh\u00e1c r\u1ed7ng, v\u00e0 l\u01b0u tr\u1eef c\u00e1c \u0111i\u1ec3m \u0111\u1ea7u m\u00fat c\u1ee7a \u0111o\u1ea1n th\u1eb3ng giao nhau trong c\u00e1c \u0111\u1ed1i s\u1ed1 <code>left</code> v\u00e0 <code>right</code>. N\u1ebfu c\u00e2u tr\u1ea3 l\u1eddi l\u00e0 m\u1ed9t \u0111i\u1ec3m duy nh\u1ea5t, c\u00e1c gi\u00e1 tr\u1ecb \u0111\u01b0\u1ee3c ghi v\u00e0o <code>left</code> v\u00e0 <code>right</code> s\u1ebd gi\u1ed1ng nhau.</p> <pre><code>const double EPS = 1E-9;\n\nstruct pt {\n    double x, y;\n\n    bool operator&lt;(const pt&amp; p) const\n    {\n        return x &lt; p.x - EPS || (abs(x - p.x) &lt; EPS &amp;&amp; y &lt; p.y - EPS);\n    }\n};\n\nstruct line {\n    double a, b, c;\n\n    line() {}\n    line(pt p, pt q)\n    {\n        a = p.y - q.y;\n        b = q.x - p.x;\n        c = -a * p.x - b * p.y;\n        norm();\n    }\n\n    void norm()\n    {\n        double z = sqrt(a * a + b * b);\n        if (abs(z) &gt; EPS)\n            a /= z, b /= z, c /= z;\n    }\n\n    double dist(pt p) const { return a * p.x + b * p.y + c; }\n};\n\ndouble det(double a, double b, double c, double d)\n{\n    return a * d - b * c;\n}\n\ninline bool betw(double l, double r, double x)\n{\n    return min(l, r) &lt;= x + EPS &amp;&amp; x &lt;= max(l, r) + EPS;\n}\n\ninline bool intersect_1d(double a, double b, double c, double d)\n{\n    if (a &gt; b)\n        swap(a, b);\n    if (c &gt; d)\n        swap(c, d);\n    return max(a, c) &lt;= min(b, d) + EPS;\n}\n\nbool intersect(pt a, pt b, pt c, pt d, pt&amp; left, pt&amp; right)\n{\n    if (!intersect_1d(a.x, b.x, c.x, d.x) || !intersect_1d(a.y, b.y, c.y, d.y))\n        return false;\n    line m(a, b);\n    line n(c, d);\n    double zn = det(m.a, m.b, n.a, n.b);\n    if (abs(zn) &lt; EPS) {\n        if (abs(m.dist(c)) &gt; EPS || abs(n.dist(a)) &gt; EPS)\n            return false;\n        if (b &lt; a)\n            swap(a, b);\n        if (d &lt; c)\n            swap(c, d);\n        left = max(a, c);\n        right = min(b, d);\n        return true;\n    } else {\n        left.x = right.x = -det(m.c, m.b, n.c, n.b) / zn;\n        left.y = right.y = -det(m.a, m.c, n.a, n.c) / zn;\n        return betw(a.x, b.x, left.x) &amp;&amp; betw(a.y, b.y, left.y) &amp;&amp;\n               betw(c.x, d.x, left.x) &amp;&amp; betw(c.y, d.y, left.y);\n    }\n}\n</code></pre>","tags":["Translated"]},{"location":"geometry/tangents-to-two-circles.html","title":"T\u00ecm ti\u1ebfp tuy\u1ebfn chung c\u1ee7a hai \u0111\u01b0\u1eddng tr\u00f2n (Finding common tangents to two circles)","text":"<p>Cho hai \u0111\u01b0\u1eddng tr\u00f2n. Y\u00eau c\u1ea7u t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c ti\u1ebfp tuy\u1ebfn chung c\u1ee7a ch\u00fang, t\u1ee9c l\u00e0 t\u1ea5t c\u1ea3 c\u00e1c \u0111\u01b0\u1eddng th\u1eb3ng ti\u1ebfp x\u00fac v\u1edbi c\u1ea3 hai \u0111\u01b0\u1eddng tr\u00f2n c\u00f9ng m\u1ed9t l\u00fac.</p> <p>Thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 c\u0169ng s\u1ebd ho\u1ea1t \u0111\u1ed9ng trong tr\u01b0\u1eddng h\u1ee3p m\u1ed9t (ho\u1eb7c c\u1ea3 hai) \u0111\u01b0\u1eddng tr\u00f2n suy bi\u1ebfn th\u00e0nh \u0111i\u1ec3m. Do \u0111\u00f3, thu\u1eadt to\u00e1n n\u00e0y c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 t\u00ecm ti\u1ebfp tuy\u1ebfn c\u1ee7a m\u1ed9t \u0111\u01b0\u1eddng tr\u00f2n \u0111i qua m\u1ed9t \u0111i\u1ec3m \u0111\u00e3 cho.</p>","tags":["Translated"]},{"location":"geometry/tangents-to-two-circles.html#the-number-of-common-tangents","title":"S\u1ed1 l\u01b0\u1ee3ng ti\u1ebfp tuy\u1ebfn chung (The number of common tangents)","text":"<p>S\u1ed1 l\u01b0\u1ee3ng ti\u1ebfp tuy\u1ebfn chung c\u1ee7a hai \u0111\u01b0\u1eddng tr\u00f2n c\u00f3 th\u1ec3 l\u00e0 0, 1, 2, 3, 4 v\u00e0 v\u00f4 h\u1ea1n. Nh\u00ecn v\u00e0o c\u00e1c h\u00ecnh \u1ea3nh cho c\u00e1c tr\u01b0\u1eddng h\u1ee3p kh\u00e1c nhau.</p> <p>\u1ede \u0111\u00e2y, ch\u00fang ta s\u1ebd kh\u00f4ng xem x\u00e9t c\u00e1c tr\u01b0\u1eddng h\u1ee3p suy bi\u1ebfn, t\u1ee9c l\u00e0 khi c\u00e1c \u0111\u01b0\u1eddng tr\u00f2n tr\u00f9ng nhau (trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y ch\u00fang c\u00f3 v\u00f4 s\u1ed1 ti\u1ebfp tuy\u1ebfn chung), ho\u1eb7c m\u1ed9t \u0111\u01b0\u1eddng tr\u00f2n n\u1eb1m b\u00ean trong \u0111\u01b0\u1eddng tr\u00f2n kia (trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y ch\u00fang kh\u00f4ng c\u00f3 ti\u1ebfp tuy\u1ebfn chung, ho\u1eb7c n\u1ebfu c\u00e1c \u0111\u01b0\u1eddng tr\u00f2n ti\u1ebfp x\u00fac trong, c\u00f3 m\u1ed9t ti\u1ebfp tuy\u1ebfn chung).</p> <p>Trong h\u1ea7u h\u1ebft c\u00e1c tr\u01b0\u1eddng h\u1ee3p, hai \u0111\u01b0\u1eddng tr\u00f2n c\u00f3 b\u1ed1n ti\u1ebfp tuy\u1ebfn chung.</p> <p>Jika c\u00e1c \u0111\u01b0\u1eddng tr\u00f2n ti\u1ebfp x\u00fac, th\u00ec ch\u00fang s\u1ebd c\u00f3 ba ti\u1ebfp tuy\u1ebfn chung, nh\u01b0ng \u0111i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c hi\u1ec3u l\u00e0 m\u1ed9t tr\u01b0\u1eddng h\u1ee3p suy bi\u1ebfn: nh\u01b0 th\u1ec3 hai ti\u1ebfp tuy\u1ebfn tr\u00f9ng nhau.</p> <p>H\u01a1n n\u1eefa, thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 d\u01b0\u1edbi \u0111\u00e2y s\u1ebd ho\u1ea1t \u0111\u1ed9ng trong tr\u01b0\u1eddng h\u1ee3p m\u1ed9t ho\u1eb7c c\u1ea3 hai \u0111\u01b0\u1eddng tr\u00f2n c\u00f3 b\u00e1n k\u00ednh b\u1eb1ng kh\u00f4ng: trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y s\u1ebd c\u00f3 t\u01b0\u01a1ng \u1ee9ng hai ho\u1eb7c m\u1ed9t ti\u1ebfp tuy\u1ebfn chung.</p> <p>T\u00f3m l\u1ea1i, ch\u00fang ta s\u1ebd lu\u00f4n t\u00ecm ki\u1ebfm b\u1ed1n ti\u1ebfp tuy\u1ebfn cho t\u1ea5t c\u1ea3 c\u00e1c tr\u01b0\u1eddng h\u1ee3p ngo\u1ea1i tr\u1eeb tr\u01b0\u1eddng h\u1ee3p v\u00f4 s\u1ed1 ti\u1ebfp tuy\u1ebfn (Tr\u01b0\u1eddng h\u1ee3p v\u00f4 s\u1ed1 ti\u1ebfp tuy\u1ebfn c\u1ea7n \u0111\u01b0\u1ee3c x\u1eed l\u00fd ri\u00eang v\u00e0 kh\u00f4ng \u0111\u01b0\u1ee3c th\u1ea3o lu\u1eadn \u1edf \u0111\u00e2y). Trong c\u00e1c tr\u01b0\u1eddng h\u1ee3p suy bi\u1ebfn, m\u1ed9t s\u1ed1 ti\u1ebfp tuy\u1ebfn s\u1ebd tr\u00f9ng nhau, nh\u01b0ng tuy nhi\u00ean, c\u00e1c tr\u01b0\u1eddng h\u1ee3p n\u00e0y c\u0169ng s\u1ebd ph\u00f9 h\u1ee3p v\u1edbi b\u1ee9c tranh l\u1edbn.</p>","tags":["Translated"]},{"location":"geometry/tangents-to-two-circles.html#algorithm","title":"Thu\u1eadt to\u00e1n (Algorithm)","text":"<p>\u0110\u1ec3 \u0111\u01a1n gi\u1ea3n h\u00f3a thu\u1eadt to\u00e1n, ch\u00fang ta s\u1ebd gi\u1ea3 s\u1eed, kh\u00f4ng m\u1ea5t t\u00ednh t\u1ed5ng qu\u00e1t, r\u1eb1ng t\u00e2m c\u1ee7a \u0111\u01b0\u1eddng tr\u00f2n th\u1ee9 nh\u1ea5t c\u00f3 t\u1ecda \u0111\u1ed9 $(0, 0)$. (N\u1ebfu kh\u00f4ng ph\u1ea3i nh\u01b0 v\u1eady, th\u00ec \u0111i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 \u0111\u1ea1t \u0111\u01b0\u1ee3c b\u1eb1ng c\u00e1ch \u0111\u01a1n gi\u1ea3n l\u00e0 d\u1ecbch chuy\u1ec3n to\u00e0n b\u1ed9 b\u1ee9c tranh, v\u00e0 sau khi t\u00ecm th\u1ea5y gi\u1ea3i ph\u00e1p, b\u1eb1ng c\u00e1ch d\u1ecbch chuy\u1ec3n c\u00e1c \u0111\u01b0\u1eddng th\u1eb3ng thu \u0111\u01b0\u1ee3c tr\u1edf l\u1ea1i.)</p> <p>K\u00fd hi\u1ec7u $r_1$ v\u00e0 $r_2$ l\u00e0 b\u00e1n k\u00ednh c\u1ee7a \u0111\u01b0\u1eddng tr\u00f2n th\u1ee9 nh\u1ea5t v\u00e0 th\u1ee9 hai, v\u00e0 $(v_x,v_y)$ l\u00e0 t\u1ecda \u0111\u1ed9 c\u1ee7a t\u00e2m c\u1ee7a \u0111\u01b0\u1eddng tr\u00f2n th\u1ee9 hai v\u00e0 \u0111i\u1ec3m $v$ kh\u00e1c v\u1edbi g\u1ed1c t\u1ecda \u0111\u1ed9. (L\u01b0u \u00fd: ch\u00fang ta kh\u00f4ng xem x\u00e9t tr\u01b0\u1eddng h\u1ee3p hai \u0111\u01b0\u1eddng tr\u00f2n gi\u1ed1ng nhau).</p> <p>\u0110\u1ec3 gi\u1ea3i quy\u1ebft b\u00e0i to\u00e1n, ch\u00fang ta ti\u1ebfp c\u1eadn n\u00f3 ho\u00e0n to\u00e0n b\u1eb1ng \u0111\u1ea1i s\u1ed1. Ch\u00fang ta c\u1ea7n t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c \u0111\u01b0\u1eddng th\u1eb3ng c\u00f3 d\u1ea1ng $ax + by + c = 0$ n\u1eb1m \u1edf kho\u1ea3ng c\u00e1ch $r_1$ t\u1eeb g\u1ed1c t\u1ecda \u0111\u1ed9, v\u00e0 \u1edf kho\u1ea3ng c\u00e1ch $r_2$ t\u1eeb m\u1ed9t \u0111i\u1ec3m $v$. Ngo\u00e0i ra, ch\u00fang ta \u00e1p \u0111\u1eb7t \u0111i\u1ec1u ki\u1ec7n chu\u1ea9n h\u00f3a c\u1ee7a \u0111\u01b0\u1eddng th\u1eb3ng: t\u1ed5ng b\u00ecnh ph\u01b0\u01a1ng c\u1ee7a c\u00e1c h\u1ec7 s\u1ed1 $a$ v\u00e0 $b$ ph\u1ea3i b\u1eb1ng m\u1ed9t (\u0111i\u1ec1u n\u00e0y l\u00e0 c\u1ea7n thi\u1ebft, n\u1ebfu kh\u00f4ng c\u00f9ng m\u1ed9t \u0111\u01b0\u1eddng th\u1eb3ng s\u1ebd t\u01b0\u01a1ng \u1ee9ng v\u1edbi v\u00f4 s\u1ed1 bi\u1ec3u di\u1ec5n c\u00f3 d\u1ea1ng $ax + by + c = 0$). T\u1ed5ng c\u1ed9ng ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c m\u1ed9t h\u1ec7 ph\u01b0\u01a1ng tr\u00ecnh nh\u01b0 v\u1eady cho $a, b, c$ mong mu\u1ed1n:</p> $$\\begin{align} a^2 + b^2 &amp;= 1 \\\\ \\mid a \\cdot 0 + b \\cdot 0 + c \\mid &amp;= r_1 \\\\ \\mid a \\cdot v_x + b \\cdot v_y + c \\mid &amp;= r_2 \\end{align}$$ <p>\u0110\u1ec3 lo\u1ea1i b\u1ecf gi\u00e1 tr\u1ecb tuy\u1ec7t \u0111\u1ed1i, l\u01b0u \u00fd r\u1eb1ng ch\u1ec9 c\u00f3 b\u1ed1n c\u00e1ch \u0111\u1ec3 ph\u00e1 d\u1ea5u gi\u00e1 tr\u1ecb tuy\u1ec7t \u0111\u1ed1i trong h\u1ec7 ph\u01b0\u01a1ng tr\u00ecnh n\u00e0y. T\u1ea5t c\u1ea3 c\u00e1c ph\u01b0\u01a1ng ph\u00e1p n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c xem x\u00e9t b\u1edfi tr\u01b0\u1eddng h\u1ee3p t\u1ed5ng qu\u00e1t, n\u1ebfu ch\u00fang ta hi\u1ec3u vi\u1ec7c ph\u00e1 d\u1ea5u gi\u00e1 tr\u1ecb tuy\u1ec7t \u0111\u1ed1i nh\u01b0 l\u00e0 th\u1ef1c t\u1ebf r\u1eb1ng h\u1ec7 s\u1ed1 \u1edf v\u1ebf ph\u1ea3i c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c nh\u00e2n v\u1edbi -1. N\u00f3i c\u00e1ch kh\u00e1c, ch\u00fang ta chuy\u1ec3n sang h\u1ec7 ph\u01b0\u01a1ng tr\u00ecnh n\u00e0y:</p> $$\\begin{align} a^2 + b^2 &amp;= 1 \\\\ c &amp;= \\pm r_1 \\\\ a \\cdot v_x + b \\cdot v_y + c &amp;= \\pm r_2 \\end{align}$$ <p>\u0110\u1eb7t k\u00fd hi\u1ec7u $d_1 = \\pm r_1$ v\u00e0 $d_2 = \\pm r_2$, ch\u00fang ta \u0111i \u0111\u1ebfn k\u1ebft lu\u1eadn r\u1eb1ng h\u1ec7 ph\u01b0\u01a1ng tr\u00ecnh ph\u1ea3i c\u00f3 b\u1ed1n nghi\u1ec7m:</p> $$\\begin{align} a^2 + b^2 &amp;= 1 \\\\ c &amp;= d_1 \\\\ a \\cdot v_x + b \\cdot v_y + c &amp;= d_2 \\end{align}$$ <p>Vi\u1ec7c gi\u1ea3i h\u1ec7 ph\u01b0\u01a1ng tr\u00ecnh n\u00e0y \u0111\u01b0\u1ee3c quy v\u1ec1 vi\u1ec7c gi\u1ea3i m\u1ed9t ph\u01b0\u01a1ng tr\u00ecnh b\u1eadc hai. Ch\u00fang ta s\u1ebd b\u1ecf qua t\u1ea5t c\u1ea3 c\u00e1c t\u00ednh to\u00e1n c\u1ed3ng k\u1ec1nh, v\u00e0 ngay l\u1eadp t\u1ee9c \u0111\u01b0a ra c\u00e2u tr\u1ea3 l\u1eddi s\u1eb5n c\u00f3:</p> $$\\begin{align} a &amp;= {( d_2 - d_1 ) v_x \\pm v_y \\sqrt{v_x^2 + v_y^2-(d_2-d_1)^2} \\over {v_x^2 + v_y^2} } \\\\ b &amp;= {( d_2 - d_1 ) v_y \\pm v_x \\sqrt{v_x^2 + v_y^2-(d_2-d_1)^2} \\over {v_x^2 + v_y^2} } \\\\ c &amp;= d_1 \\end{align}$$ <p>T\u1ed5ng c\u1ed9ng ch\u00fang ta c\u00f3 t\u00e1m nghi\u1ec7m thay v\u00ec b\u1ed1n. Tuy nhi\u00ean, th\u1eadt d\u1ec5 hi\u1ec3u nh\u1eefng quy\u1ebft \u0111\u1ecbnh th\u1eeba n\u1ea3y sinh \u1edf \u0111\u00e2u: th\u1ef1c t\u1ebf, trong h\u1ec7 ph\u01b0\u01a1ng tr\u00ecnh sau, ch\u1ec9 c\u1ea7n l\u1ea5y m\u1ed9t nghi\u1ec7m (v\u00ed d\u1ee5, nghi\u1ec7m \u0111\u1ea7u ti\u00ean). Th\u1ef1c t\u1ebf, \u00fd ngh\u0129a h\u00ecnh h\u1ecdc c\u1ee7a vi\u1ec7c ch\u00fang ta l\u1ea5y $\\pm r_1$ v\u00e0 $\\pm r_2$ l\u00e0 r\u00f5 r\u00e0ng: ch\u00fang ta th\u1ef1c s\u1ef1 \u0111ang ph\u00e2n lo\u1ea1i ph\u00eda n\u00e0o c\u1ee7a m\u1ed7i \u0111\u01b0\u1eddng tr\u00f2n c\u00f3 m\u1ed9t \u0111\u01b0\u1eddng th\u1eb3ng. Do \u0111\u00f3, hai ph\u01b0\u01a1ng ph\u00e1p n\u1ea3y sinh khi gi\u1ea3i h\u1ec7 ph\u01b0\u01a1ng tr\u00ecnh sau l\u00e0 d\u01b0 th\u1eeba: ch\u1ec9 c\u1ea7n ch\u1ecdn m\u1ed9t trong hai nghi\u1ec7m (t\u1ea5t nhi\u00ean, ch\u1ec9 c\u1ea7n trong t\u1ea5t c\u1ea3 b\u1ed1n tr\u01b0\u1eddng h\u1ee3p, b\u1ea1n ph\u1ea3i ch\u1ecdn c\u00f9ng m\u1ed9t h\u1ecd nghi\u1ec7m).</p> <p>\u0110i\u1ec1u cu\u1ed1i c\u00f9ng m\u00e0 ch\u00fang ta ch\u01b0a xem x\u00e9t l\u00e0 c\u00e1ch d\u1ecbch chuy\u1ec3n c\u00e1c \u0111\u01b0\u1eddng th\u1eb3ng trong tr\u01b0\u1eddng h\u1ee3p \u0111\u01b0\u1eddng tr\u00f2n th\u1ee9 nh\u1ea5t ban \u0111\u1ea7u kh\u00f4ng n\u1eb1m \u1edf g\u1ed1c t\u1ecda \u0111\u1ed9. Tuy nhi\u00ean, m\u1ecdi th\u1ee9 \u1edf \u0111\u00e2y \u0111\u1ec1u \u0111\u01a1n gi\u1ea3n: t\u1eeb t\u00ednh tuy\u1ebfn t\u00ednh c\u1ee7a ph\u01b0\u01a1ng tr\u00ecnh \u0111\u01b0\u1eddng th\u1eb3ng, suy ra r\u1eb1ng gi\u00e1 tr\u1ecb $a \\cdot x_0 + b \\cdot y_0$ (trong \u0111\u00f3 $x_0$ v\u00e0 $y_0$ l\u00e0 t\u1ecda \u0111\u1ed9 c\u1ee7a t\u00e2m ban \u0111\u1ea7u c\u1ee7a \u0111\u01b0\u1eddng tr\u00f2n th\u1ee9 nh\u1ea5t) ph\u1ea3i \u0111\u01b0\u1ee3c tr\u1eeb kh\u1ecfi h\u1ec7 s\u1ed1 $c$.</p>","tags":["Translated"]},{"location":"geometry/tangents-to-two-circles.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>\u0110\u1ea7u ti\u00ean ch\u00fang ta m\u00f4 t\u1ea3 t\u1ea5t c\u1ea3 c\u00e1c c\u1ea5u tr\u00fac d\u1eef li\u1ec7u c\u1ea7n thi\u1ebft v\u00e0 c\u00e1c \u0111\u1ecbnh ngh\u0129a ph\u1ee5 tr\u1ee3 kh\u00e1c:</p> <pre><code>struct pt {\n    double x, y;\n\n    pt operator- (pt p) {\n        pt res = { x-p.x, y-p.y };\n        return res;\n    }\n};\n\nstruct circle : pt {\n    double r;\n};\n\nstruct line {\n    double a, b, c;\n};\n\nconst double EPS = 1E-9;\n\ndouble sqr (double a) {\n    return a * a;\n}\n</code></pre> <p>Sau \u0111\u00f3, gi\u1ea3i ph\u00e1p ch\u00ednh n\u00f3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c vi\u1ebft theo c\u00e1ch n\u00e0y (trong \u0111\u00f3 h\u00e0m ch\u00ednh cho cu\u1ed9c g\u1ecdi l\u00e0 h\u00e0m th\u1ee9 hai; v\u00e0 h\u00e0m \u0111\u1ea7u ti\u00ean l\u00e0 m\u1ed9t h\u00e0m ph\u1ee5 tr\u1ee3):</p> <pre><code>void tangents (pt c, double r1, double r2, vector&lt;line&gt; &amp; ans) {\n    double r = r2 - r1;\n    double z = sqr(c.x) + sqr(c.y);\n    double d = z - sqr(r);\n    if (d &lt; -EPS)  return;\n    d = sqrt (abs (d));\n    line l;\n    l.a = (c.x * r + c.y * d) / z;\n    l.b = (c.y * r - c.x * d) / z;\n    l.c = r1;\n    ans.push_back (l);\n}\n\nvector&lt;line&gt; tangents (circle a, circle b) {\n    vector&lt;line&gt; ans;\n    for (int i=-1; i&lt;=1; i+=2)\n        for (int j=-1; j&lt;=1; j+=2)\n            tangents (b-a, a.r*i, b.r*j, ans);\n    for (size_t i=0; i&lt;ans.size(); ++i)\n        ans[i].c -= ans[i].a * a.x + ans[i].b * a.y;\n    return ans;\n}\n</code></pre>","tags":["Translated"]},{"location":"geometry/tangents-to-two-circles.html#problems","title":"B\u00e0i t\u1eadp (Problems)","text":"<p>TIMUS 1163 Chapaev</p>","tags":["Translated"]},{"location":"geometry/vertical_decomposition.html","title":"Ph\u00e2n r\u00e3 d\u1ecdc (Vertical decomposition)","text":"","tags":["Translated"]},{"location":"geometry/vertical_decomposition.html#overview","title":"T\u1ed5ng quan (Overview)","text":"<p>Ph\u00e2n r\u00e3 nhanh d\u1ecdc l\u00e0 m\u1ed9t k\u1ef9 thu\u1eadt m\u1ea1nh m\u1ebd \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng trong c\u00e1c b\u00e0i to\u00e1n h\u00ecnh h\u1ecdc kh\u00e1c nhau. \u00dd t\u01b0\u1edfng chung l\u00e0 c\u1eaft m\u1eb7t ph\u1eb3ng th\u00e0nh m\u1ed9t v\u00e0i d\u1ea3i d\u1ecdc (vertical stripes) v\u1edbi m\u1ed9t s\u1ed1 t\u00ednh ch\u1ea5t \"t\u1ed1t\" v\u00e0 gi\u1ea3i quy\u1ebft b\u00e0i to\u00e1n cho c\u00e1c d\u1ea3i n\u00e0y m\u1ed9t c\u00e1ch \u0111\u1ed9c l\u1eadp. Ch\u00fang ta s\u1ebd minh h\u1ecda \u00fd t\u01b0\u1edfng tr\u00ean m\u1ed9t s\u1ed1 v\u00ed d\u1ee5.</p>","tags":["Translated"]},{"location":"geometry/vertical_decomposition.html#area-of-the-union-of-triangles","title":"Di\u1ec7n t\u00edch h\u1ee3p c\u1ee7a c\u00e1c tam gi\u00e1c (Area of the union of triangles)","text":"<p>Gi\u1ea3 s\u1eed c\u00f3 $n$ tam gi\u00e1c tr\u00ean m\u1ed9t m\u1eb7t ph\u1eb3ng v\u00e0 ch\u00fang ta ph\u1ea3i t\u00ecm di\u1ec7n t\u00edch h\u1ee3p c\u1ee7a ch\u00fang. B\u00e0i to\u00e1n s\u1ebd d\u1ec5 d\u00e0ng n\u1ebfu c\u00e1c tam gi\u00e1c kh\u00f4ng c\u1eaft nhau, v\u00ec v\u1eady h\u00e3y lo\u1ea1i b\u1ecf c\u00e1c giao \u0111i\u1ec3m n\u00e0y b\u1eb1ng c\u00e1ch chia m\u1eb7t ph\u1eb3ng th\u00e0nh c\u00e1c d\u1ea3i d\u1ecdc b\u1eb1ng c\u00e1ch v\u1ebd c\u00e1c \u0111\u01b0\u1eddng th\u1eb3ng \u0111\u1ee9ng qua t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh v\u00e0 t\u1ea5t c\u1ea3 c\u00e1c giao \u0111i\u1ec3m c\u1ee7a c\u00e1c c\u1ea1nh c\u1ee7a c\u00e1c tam gi\u00e1c kh\u00e1c nhau. C\u00f3 th\u1ec3 c\u00f3 $O(n^2)$ \u0111\u01b0\u1eddng nh\u01b0 v\u1eady n\u00ean ch\u00fang ta thu \u0111\u01b0\u1ee3c $O(n^2)$ d\u1ea3i. B\u00e2y gi\u1edd h\u00e3y xem x\u00e9t m\u1ed9t d\u1ea3i d\u1ecdc n\u00e0o \u0111\u00f3. M\u1ed7i \u0111o\u1ea1n th\u1eb3ng kh\u00f4ng d\u1ecdc ho\u1eb7c c\u1eaft n\u00f3 t\u1eeb tr\u00e1i sang ph\u1ea3i ho\u1eb7c kh\u00f4ng c\u1eaft ch\u00fat n\u00e0o. H\u01a1n n\u1eefa, kh\u00f4ng c\u00f3 hai \u0111o\u1ea1n th\u1eb3ng n\u00e0o c\u1eaft nhau ho\u00e0n to\u00e0n b\u00ean trong d\u1ea3i. \u0110i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 ph\u1ea7n c\u1ee7a h\u1ee3p c\u00e1c tam gi\u00e1c n\u1eb1m b\u00ean trong d\u1ea3i n\u00e0y bao g\u1ed3m c\u00e1c h\u00ecnh thang r\u1eddi r\u1ea1c v\u1edbi c\u00e1c \u0111\u00e1y n\u1eb1m tr\u00ean c\u00e1c c\u1ea1nh c\u1ee7a d\u1ea3i. T\u00ednh ch\u1ea5t n\u00e0y cho ph\u00e9p ch\u00fang ta t\u00ednh di\u1ec7n t\u00edch b\u00ean trong m\u1ed7i d\u1ea3i b\u1eb1ng thu\u1eadt to\u00e1n qu\u00e9t \u0111\u01b0\u1eddng (scanline) sau \u0111\u00e2y. M\u1ed7i \u0111o\u1ea1n th\u1eb3ng c\u1eaft d\u1ea3i l\u00e0 \u0111o\u1ea1n tr\u00ean (upper) ho\u1eb7c \u0111o\u1ea1n d\u01b0\u1edbi (lower), t\u00f9y thu\u1ed9c v\u00e0o vi\u1ec7c ph\u1ea7n trong c\u1ee7a tam gi\u00e1c t\u01b0\u01a1ng \u1ee9ng n\u1eb1m tr\u00ean hay n\u1eb1m d\u01b0\u1edbi \u0111o\u1ea1n th\u1eb3ng. Ch\u00fang ta c\u00f3 th\u1ec3 h\u00ecnh dung m\u1ed7i \u0111o\u1ea1n tr\u00ean nh\u01b0 m\u1ed9t d\u1ea5u ngo\u1eb7c m\u1edf v\u00e0 m\u1ed7i \u0111o\u1ea1n d\u01b0\u1edbi nh\u01b0 m\u1ed9t d\u1ea5u ngo\u1eb7c \u0111\u00f3ng v\u00e0 ph\u00e2n r\u00e3 d\u1ea3i th\u00e0nh c\u00e1c h\u00ecnh thang b\u1eb1ng c\u00e1ch ph\u00e2n r\u00e3 d\u00e3y ngo\u1eb7c th\u00e0nh c\u00e1c d\u00e3y ngo\u1eb7c \u0111\u00fang nh\u1ecf h\u01a1n. Thu\u1eadt to\u00e1n n\u00e0y y\u00eau c\u1ea7u th\u1eddi gian $O(n^3\\log n)$ v\u00e0 b\u1ed9 nh\u1edb $O(n^2)$.</p>","tags":["Translated"]},{"location":"geometry/vertical_decomposition.html#optimization-1","title":"T\u1ed1i \u01b0u h\u00f3a 1 (Optimization 1)","text":"<p>Tr\u01b0\u1edbc ti\u00ean, ch\u00fang ta s\u1ebd gi\u1ea3m th\u1eddi gian ch\u1ea1y xu\u1ed1ng $O(n^2\\log n)$. Thay v\u00ec t\u1ea1o c\u00e1c h\u00ecnh thang cho m\u1ed7i d\u1ea3i, h\u00e3y c\u1ed1 \u0111\u1ecbnh m\u1ed9t c\u1ea1nh tam gi\u00e1c n\u00e0o \u0111\u00f3 (\u0111o\u1ea1n $s = (s_0, s_1)$) v\u00e0 t\u00ecm t\u1eadp h\u1ee3p c\u00e1c d\u1ea3i n\u01a1i \u0111o\u1ea1n n\u00e0y l\u00e0 m\u1ed9t c\u1ea1nh c\u1ee7a m\u1ed9t h\u00ecnh thang n\u00e0o \u0111\u00f3. L\u01b0u \u00fd r\u1eb1ng trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, ch\u00fang ta ch\u1ec9 ph\u1ea3i t\u00ecm c\u00e1c d\u1ea3i n\u01a1i c\u00e2n b\u1eb1ng c\u1ee7a c\u00e1c d\u1ea5u ngo\u1eb7c b\u00ean d\u01b0\u1edbi (ho\u1eb7c b\u00ean tr\u00ean, trong tr\u01b0\u1eddng h\u1ee3p \u0111o\u1ea1n d\u01b0\u1edbi) $s$ l\u00e0 b\u1eb1ng kh\u00f4ng. \u0110i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 thay v\u00ec ch\u1ea1y qu\u00e9t \u0111\u01b0\u1eddng d\u1ecdc cho m\u1ed7i d\u1ea3i, ch\u00fang ta c\u00f3 th\u1ec3 ch\u1ea1y qu\u00e9t \u0111\u01b0\u1eddng ngang cho t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n c\u1ee7a c\u00e1c \u0111o\u1ea1n kh\u00e1c \u1ea3nh h\u01b0\u1edfng \u0111\u1ebfn c\u00e2n b\u1eb1ng c\u1ee7a c\u00e1c d\u1ea5u ngo\u1eb7c \u0111\u1ed1i v\u1edbi $s$. \u0110\u1ec3 \u0111\u01a1n gi\u1ea3n, ch\u00fang ta s\u1ebd ch\u1ec9 ra c\u00e1ch th\u1ef1c hi\u1ec7n \u0111i\u1ec1u n\u00e0y cho m\u1ed9t \u0111o\u1ea1n tr\u00ean, thu\u1eadt to\u00e1n cho c\u00e1c \u0111o\u1ea1n d\u01b0\u1edbi l\u00e0 t\u01b0\u01a1ng t\u1ef1. Xem x\u00e9t m\u1ed9t s\u1ed1 \u0111o\u1ea1n kh\u00f4ng d\u1ecdc kh\u00e1c $t = (t_0, t_1)$ v\u00e0 t\u00ecm giao \u0111i\u1ec3m $[x_1, x_2]$ c\u1ee7a c\u00e1c h\u00ecnh chi\u1ebfu c\u1ee7a $s$ v\u00e0 $t$ tr\u00ean $Ox$. N\u1ebfu giao \u0111i\u1ec3m n\u00e0y r\u1ed7ng ho\u1eb7c ch\u1ec9 bao g\u1ed3m m\u1ed9t \u0111i\u1ec3m, $t$ c\u00f3 th\u1ec3 b\u1ecb lo\u1ea1i b\u1ecf v\u00ec $s$ v\u00e0 $t$ kh\u00f4ng c\u1eaft ph\u1ea7n trong c\u1ee7a c\u00f9ng m\u1ed9t d\u1ea3i. Ng\u01b0\u1ee3c l\u1ea1i, h\u00e3y xem x\u00e9t giao \u0111i\u1ec3m $I$ c\u1ee7a $s$ v\u00e0 $t$. C\u00f3 ba tr\u01b0\u1eddng h\u1ee3p.</p> <ol> <li> <p>$I = \\varnothing$</p> <p>Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y $t$ ho\u1eb7c n\u1eb1m tr\u00ean ho\u1eb7c n\u1eb1m d\u01b0\u1edbi $s$ tr\u00ean $[x_1, x_2]$. N\u1ebfu $t$ n\u1eb1m tr\u00ean, n\u00f3 kh\u00f4ng \u1ea3nh h\u01b0\u1edfng \u0111\u1ebfn vi\u1ec7c li\u1ec7u $s$ c\u00f3 ph\u1ea3i l\u00e0 m\u1ed9t c\u1ea1nh c\u1ee7a m\u1ed9t h\u00ecnh thang n\u00e0o \u0111\u00f3 hay kh\u00f4ng. N\u1ebfu $t$ n\u1eb1m d\u01b0\u1edbi $s$, ch\u00fang ta n\u00ean th\u00eam $1$ ho\u1eb7c $-1$ v\u00e0o c\u00e2n b\u1eb1ng c\u1ee7a c\u00e1c d\u00e3y ngo\u1eb7c cho t\u1ea5t c\u1ea3 c\u00e1c d\u1ea3i trong $[x_1, x_2]$, t\u00f9y thu\u1ed9c v\u00e0o vi\u1ec7c $t$ l\u00e0 \u0111o\u1ea1n tr\u00ean hay \u0111o\u1ea1n d\u01b0\u1edbi.</p> </li> <li> <p>$I$ bao g\u1ed3m m\u1ed9t \u0111i\u1ec3m duy nh\u1ea5t $p$</p> <p>Tr\u01b0\u1eddng h\u1ee3p n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c quy v\u1ec1 tr\u01b0\u1eddng h\u1ee3p tr\u01b0\u1edbc b\u1eb1ng c\u00e1ch chia $[x_1, x_2]$ th\u00e0nh $[x_1, p_x]$ v\u00e0 $[p_x, x_2]$.</p> </li> <li> <p>$I$ l\u00e0 m\u1ed9t \u0111o\u1ea1n $l$ n\u00e0o \u0111\u00f3</p> <p>Tr\u01b0\u1eddng h\u1ee3p n\u00e0y c\u00f3 ngh\u0129a l\u00e0 c\u00e1c ph\u1ea7n c\u1ee7a $s$ v\u00e0 $t$ cho $x\\in[x_1, x_2]$ tr\u00f9ng nhau. N\u1ebfu $t$ l\u00e0 \u0111o\u1ea1n d\u01b0\u1edbi, $s$ r\u00f5 r\u00e0ng kh\u00f4ng ph\u1ea3i l\u00e0 m\u1ed9t c\u1ea1nh c\u1ee7a h\u00ecnh thang. Ng\u01b0\u1ee3c l\u1ea1i, c\u00f3 th\u1ec3 x\u1ea3y ra tr\u01b0\u1eddng h\u1ee3p c\u1ea3 $s$ v\u00e0 $t$ \u0111\u1ec1u c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c coi l\u00e0 m\u1ed9t c\u1ea1nh c\u1ee7a m\u1ed9t h\u00ecnh thang n\u00e0o \u0111\u00f3. \u0110\u1ec3 gi\u1ea3i quy\u1ebft s\u1ef1 m\u01a1 h\u1ed3 n\u00e0y, ch\u00fang ta c\u00f3 th\u1ec3 quy\u1ebft \u0111\u1ecbnh r\u1eb1ng ch\u1ec9 \u0111o\u1ea1n c\u00f3 ch\u1ec9 s\u1ed1 th\u1ea5p nh\u1ea5t m\u1edbi \u0111\u01b0\u1ee3c coi l\u00e0 m\u1ed9t c\u1ea1nh (\u1edf \u0111\u00e2y ch\u00fang ta gi\u1ea3 s\u1eed r\u1eb1ng c\u00e1c c\u1ea1nh tam gi\u00e1c \u0111\u01b0\u1ee3c \u0111\u00e1nh s\u1ed1 theo m\u1ed9t c\u00e1ch n\u00e0o \u0111\u00f3). V\u00ec v\u1eady, n\u1ebfu $index(s) &lt; index(t)$, ch\u00fang ta n\u00ean b\u1ecf qua tr\u01b0\u1eddng h\u1ee3p n\u00e0y, ng\u01b0\u1ee3c l\u1ea1i ch\u00fang ta n\u00ean \u0111\u00e1nh d\u1ea5u r\u1eb1ng $s$ kh\u00f4ng bao gi\u1edd c\u00f3 th\u1ec3 l\u00e0 m\u1ed9t c\u1ea1nh tr\u00ean $[x_1, x_2]$ (v\u00ed d\u1ee5, b\u1eb1ng c\u00e1ch th\u00eam m\u1ed9t s\u1ef1 ki\u1ec7n t\u01b0\u01a1ng \u1ee9ng v\u1edbi c\u00e2n b\u1eb1ng $-2$).</p> </li> </ol> <p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 bi\u1ec3u di\u1ec5n \u0111\u1ed3 h\u1ecda c\u1ee7a ba tr\u01b0\u1eddng h\u1ee3p.</p> <p>Cu\u1ed1i c\u00f9ng, ch\u00fang ta n\u00ean nh\u1eadn x\u00e9t v\u1ec1 vi\u1ec7c x\u1eed l\u00fd t\u1ea5t c\u1ea3 c\u00e1c ph\u00e9p c\u1ed9ng $1$ ho\u1eb7c $-1$ tr\u00ean t\u1ea5t c\u1ea3 c\u00e1c d\u1ea3i trong $[x_1, x_2]$. \u0110\u1ed1i v\u1edbi m\u1ed7i ph\u00e9p c\u1ed9ng $w$ tr\u00ean $[x_1, x_2]$ ch\u00fang ta c\u00f3 th\u1ec3 t\u1ea1o c\u00e1c s\u1ef1 ki\u1ec7n $(x_1, w),\\ (x_2, -w)$ v\u00e0 x\u1eed l\u00fd t\u1ea5t c\u1ea3 c\u00e1c s\u1ef1 ki\u1ec7n n\u00e0y b\u1eb1ng m\u1ed9t \u0111\u01b0\u1eddng qu\u00e9t.</p>","tags":["Translated"]},{"location":"geometry/vertical_decomposition.html#optimization-2","title":"T\u1ed1i \u01b0u h\u00f3a 2 (Optimization 2)","text":"<p>L\u01b0u \u00fd r\u1eb1ng n\u1ebfu ch\u00fang ta \u00e1p d\u1ee5ng t\u1ed1i \u01b0u h\u00f3a tr\u01b0\u1edbc \u0111\u00f3, ch\u00fang ta kh\u00f4ng c\u00f2n ph\u1ea3i t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c d\u1ea3i m\u1ed9t c\u00e1ch r\u00f5 r\u00e0ng n\u1eefa. \u0110i\u1ec1u n\u00e0y l\u00e0m gi\u1ea3m m\u1ee9c ti\u00eau th\u1ee5 b\u1ed9 nh\u1edb xu\u1ed1ng $O(n)$.</p>","tags":["Translated"]},{"location":"geometry/vertical_decomposition.html#intersection-of-convex-polygons","title":"Giao c\u1ee7a c\u00e1c \u0111a gi\u00e1c l\u1ed3i (Intersection of convex polygons)","text":"<p>M\u1ed9t c\u00e1ch s\u1eed d\u1ee5ng kh\u00e1c c\u1ee7a ph\u00e2n r\u00e3 d\u1ecdc l\u00e0 t\u00ednh to\u00e1n giao c\u1ee7a hai \u0111a gi\u00e1c l\u1ed3i trong th\u1eddi gian tuy\u1ebfn t\u00ednh. Gi\u1ea3 s\u1eed m\u1eb7t ph\u1eb3ng \u0111\u01b0\u1ee3c chia th\u00e0nh c\u00e1c d\u1ea3i d\u1ecdc b\u1edfi c\u00e1c \u0111\u01b0\u1eddng th\u1eb3ng \u0111\u1ee9ng \u0111i qua m\u1ed7i \u0111\u1ec9nh c\u1ee7a m\u1ed7i \u0111a gi\u00e1c. Khi \u0111\u00f3 n\u1ebfu ch\u00fang ta xem x\u00e9t m\u1ed9t trong c\u00e1c \u0111a gi\u00e1c \u0111\u1ea7u v\u00e0o v\u00e0 m\u1ed9t d\u1ea3i n\u00e0o \u0111\u00f3, giao \u0111i\u1ec3m c\u1ee7a ch\u00fang l\u00e0 m\u1ed9t h\u00ecnh thang, m\u1ed9t tam gi\u00e1c ho\u1eb7c m\u1ed9t \u0111i\u1ec3m. Do \u0111\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 ch\u1ec9 c\u1ea7n c\u1eaft c\u00e1c h\u00ecnh n\u00e0y cho m\u1ed7i d\u1ea3i d\u1ecdc v\u00e0 h\u1ee3p nh\u1ea5t c\u00e1c giao \u0111i\u1ec3m n\u00e0y th\u00e0nh m\u1ed9t \u0111a gi\u00e1c duy nh\u1ea5t.</p>","tags":["Translated"]},{"location":"geometry/vertical_decomposition.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u00e3 t\u00ednh to\u00e1n di\u1ec7n t\u00edch h\u1ee3p c\u1ee7a m\u1ed9t t\u1eadp h\u1ee3p c\u00e1c tam gi\u00e1c trong th\u1eddi gian $O(n^2\\log n)$ v\u00e0 b\u1ed9 nh\u1edb $O(n)$.</p> <pre><code>typedef double dbl;\n\nconst dbl eps = 1e-9;\n\ninline bool eq(dbl x, dbl y){\n    return fabs(x - y) &lt; eps;\n}\n\ninline bool lt(dbl x, dbl y){\n    return x &lt; y - eps;\n}\n\ninline bool gt(dbl x, dbl y){\n    return x &gt; y + eps;\n}\n\ninline bool le(dbl x, dbl y){\n    return x &lt; y + eps;\n}\n\ninline bool ge(dbl x, dbl y){\n    return x &gt; y - eps;\n}\n\nstruct pt{\n    dbl x, y;\n    inline pt operator - (const pt &amp; p)const{\n        return pt{x - p.x, y - p.y};\n    }\n    inline pt operator + (const pt &amp; p)const{\n        return pt{x + p.x, y + p.y};\n    }\n    inline pt operator * (dbl a)const{\n        return pt{x * a, y * a};\n    }\n    inline dbl cross(const pt &amp; p)const{\n        return x * p.y - y * p.x;\n    }\n    inline dbl dot(const pt &amp; p)const{\n        return x * p.x + y * p.y;\n    }\n    inline bool operator == (const pt &amp; p)const{\n        return eq(x, p.x) &amp;&amp; eq(y, p.y);\n    }\n};\n\nstruct Line{\n    pt p[2];\n    Line(){}\n    Line(pt a, pt b):p{a, b}{}\n    pt vec()const{\n        return p[1] - p[0];\n    }\n    pt&amp; operator [](size_t i){\n        return p[i];\n    }\n};\n\ninline bool lexComp(const pt &amp; l, const pt &amp; r){\n    if(fabs(l.x - r.x) &gt; eps){\n        return l.x &lt; r.x;\n    }\n    else return l.y &lt; r.y;\n}\n\nvector&lt;pt&gt; interSegSeg(Line l1, Line l2){\n    if(eq(l1.vec().cross(l2.vec()), 0)){\n        if(!eq(l1.vec().cross(l2[0] - l1[0]), 0))\n            return {};\n        if(!lexComp(l1[0], l1[1]))\n            swap(l1[0], l1[1]);\n        if(!lexComp(l2[0], l2[1]))\n            swap(l2[0], l2[1]);\n        pt l = lexComp(l1[0], l2[0]) ? l2[0] : l1[0];\n        pt r = lexComp(l1[1], l2[1]) ? l1[1] : l2[1];\n        if(l == r)\n            return {l};\n        else return lexComp(l, r) ? vector&lt;pt&gt;{l, r} : vector&lt;pt&gt;();\n    }\n    else{\n        dbl s = (l2[0] - l1[0]).cross(l2.vec()) / l1.vec().cross(l2.vec());\n        pt inter = l1[0] + l1.vec() * s;\n        if(ge(s, 0) &amp;&amp; le(s, 1) &amp;&amp; le((l2[0] - inter).dot(l2[1] - inter), 0))\n            return {inter};\n        else\n            return {};\n    }\n}\ninline char get_segtype(Line segment, pt other_point){\n    if(eq(segment[0].x, segment[1].x))\n        return 0;\n    if(!lexComp(segment[0], segment[1]))\n        swap(segment[0], segment[1]);\n    return (segment[1] - segment[0]).cross(other_point - segment[0]) &gt; 0 ? 1 : -1;\n}\n\ndbl union_area(vector&lt;tuple&lt;pt, pt, pt&gt; &gt; triangles){\n    vector&lt;Line&gt; segments(3 * triangles.size());\n    vector&lt;char&gt; segtype(segments.size());\n    for(size_t i = 0; i &lt; triangles.size(); i++){\n        pt a, b, c;\n        tie(a, b, c) = triangles[i];\n        segments[3 * i] = lexComp(a, b) ? Line(a, b) : Line(b, a);\n        segtype[3 * i] = get_segtype(segments[3 * i], c);\n        segments[3 * i + 1] = lexComp(b, c) ? Line(b, c) : Line(c, b);\n        segtype[3 * i + 1] = get_segtype(segments[3 * i + 1], a);\n        segments[3 * i + 2] = lexComp(c, a) ? Line(c, a) : Line(a, c);\n        segtype[3 * i + 2] = get_segtype(segments[3 * i + 2], b);\n    }\n    vector&lt;dbl&gt; k(segments.size()), b(segments.size());\n    for(size_t i = 0; i &lt; segments.size(); i++){\n        if(segtype[i]){\n            k[i] = (segments[i][1].y - segments[i][0].y) / (segments[i][1].x - segments[i][0].x);\n            b[i] = segments[i][0].y - k[i] * segments[i][0].x;\n        }\n    }\n    dbl ans = 0;\n    for(size_t i = 0; i &lt; segments.size(); i++){\n        if(!segtype[i])\n            continue;\n        dbl l = segments[i][0].x, r = segments[i][1].x;\n        vector&lt;pair&lt;dbl, int&gt; &gt; evts;\n        for(size_t j = 0; j &lt; segments.size(); j++){\n            if(!segtype[j] || i == j)\n                continue;\n            dbl l1 = segments[j][0].x, r1 = segments[j][1].x;\n            if(ge(l1, r) || ge(l, r1))\n                continue;\n            dbl common_l = max(l, l1), common_r = min(r, r1);\n            auto pts = interSegSeg(segments[i], segments[j]);\n            if(pts.empty()){\n                dbl yl1 = k[j] * common_l + b[j];\n                dbl yl = k[i] * common_l + b[i];\n                if(lt(yl1, yl) == (segtype[i] == 1)){\n                    int evt_type = -segtype[i] * segtype[j];\n                    evts.emplace_back(common_l, evt_type);\n                    evts.emplace_back(common_r, -evt_type);\n                }\n            }\n            else if(pts.size() == 1u){\n                dbl yl = k[i] * common_l + b[i], yl1 = k[j] * common_l + b[j];\n                int evt_type = -segtype[i] * segtype[j];\n                if(lt(yl1, yl) == (segtype[i] == 1)){\n                    evts.emplace_back(common_l, evt_type);\n                    evts.emplace_back(pts[0].x, -evt_type);\n                }\n                yl = k[i] * common_r + b[i], yl1 = k[j] * common_r + b[j];\n                if(lt(yl1, yl) == (segtype[i] == 1)){\n                    evts.emplace_back(pts[0].x, evt_type);\n                    evts.emplace_back(common_r, -evt_type);\n                }\n            }\n            else{\n                if(segtype[j] != segtype[i] || j &gt; i){\n                    evts.emplace_back(common_l, -2);\n                    evts.emplace_back(common_r, 2);\n                }\n            }\n        }\n        evts.emplace_back(l, 0);\n        sort(evts.begin(), evts.end());\n        size_t j = 0;\n        int balance = 0;\n        while(j &lt; evts.size()){\n            size_t ptr = j;\n            while(ptr &lt; evts.size() &amp;&amp; eq(evts[j].first, evts[ptr].first)){\n                balance += evts[ptr].second;\n                ++ptr;\n            }\n            if(!balance &amp;&amp; !eq(evts[j].first, r)){\n                dbl next_x = ptr == evts.size() ? r : evts[ptr].first;\n                ans -= segtype[i] * (k[i] * (next_x + evts[j].first) + 2 * b[i]) * (next_x - evts[j].first);\n            }\n            j = ptr;\n        }\n    }\n    return ans/2;\n}\n</code></pre>","tags":["Translated"]},{"location":"geometry/vertical_decomposition.html#problems","title":"B\u00e0i t\u1eadp (Problems)","text":"<ul> <li>Codeforces 62C Inquisition</li> <li>Codeforces 107E Darts</li> </ul>","tags":["Translated"]},{"location":"graph/01_bfs.html","title":"BFS 0-1 (0-1 BFS)","text":"<p>Vi\u1ec7c t\u00ecm \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t gi\u1eefa m\u1ed9t ngu\u1ed3n \u0111\u01a1n v\u00e0 t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh kh\u00e1c trong $O(|E|)$ b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng T\u00ecm ki\u1ebfm theo chi\u1ec1u r\u1ed9ng trong \u0111\u1ed3 th\u1ecb kh\u00f4ng tr\u1ecdng s\u1ed1 \u0111\u00e3 r\u1ea5t n\u1ed5i ti\u1ebfng, t\u1ee9c l\u00e0 kho\u1ea3ng c\u00e1ch l\u00e0 s\u1ed1 l\u01b0\u1ee3ng c\u1ea1nh t\u1ed1i thi\u1ec3u b\u1ea1n c\u1ea7n \u0111\u1ec3 \u0111i t\u1eeb ngu\u1ed3n \u0111\u1ebfn \u0111\u1ec9nh kh\u00e1c. Ch\u00fang ta c\u0169ng c\u00f3 th\u1ec3 hi\u1ec3u \u0111\u1ed3 th\u1ecb nh\u01b0 v\u1eady l\u00e0 \u0111\u1ed3 th\u1ecb c\u00f3 tr\u1ecdng s\u1ed1, trong \u0111\u00f3 m\u1ed7i c\u1ea1nh c\u00f3 tr\u1ecdng s\u1ed1 l\u00e0 $1$. N\u1ebfu kh\u00f4ng ph\u1ea3i t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh trong \u0111\u1ed3 th\u1ecb \u0111\u1ec1u c\u00f3 c\u00f9ng tr\u1ecdng s\u1ed1, th\u00ec ch\u00fang ta c\u1ea7n m\u1ed9t thu\u1eadt to\u00e1n t\u1ed5ng qu\u00e1t h\u01a1n, nh\u01b0 Dijkstra ch\u1ea1y trong th\u1eddi gian $O(|V|^2 + |E|)$ ho\u1eb7c $O(|E| \\log |V|)$.</p> <p>Tuy nhi\u00ean, n\u1ebfu tr\u1ecdng s\u1ed1 b\u1ecb h\u1ea1n ch\u1ebf h\u01a1n, ch\u00fang ta th\u01b0\u1eddng c\u00f3 th\u1ec3 l\u00e0m t\u1ed1t h\u01a1n. Trong b\u00e0i vi\u1ebft n\u00e0y, ch\u00fang t\u00f4i tr\u00ecnh b\u00e0y c\u00e1ch ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng BFS \u0111\u1ec3 gi\u1ea3i quy\u1ebft b\u00e0i to\u00e1n SSSP (\u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t t\u1eeb m\u1ed9t ngu\u1ed3n \u0111\u01a1n) trong $O(|E|)$, n\u1ebfu tr\u1ecdng s\u1ed1 c\u1ee7a m\u1ed7i c\u1ea1nh l\u00e0 $0$ ho\u1eb7c $1$.</p>","tags":["Translated"]},{"location":"graph/01_bfs.html#algorithm","title":"Thu\u1eadt to\u00e1n (Algorithm)","text":"<p>Ch\u00fang ta c\u00f3 th\u1ec3 ph\u00e1t tri\u1ec3n thu\u1eadt to\u00e1n b\u1eb1ng c\u00e1ch nghi\u00ean c\u1ee9u k\u1ef9 thu\u1eadt to\u00e1n Dijkstra v\u00e0 suy ngh\u0129 v\u1ec1 nh\u1eefng h\u1eadu qu\u1ea3 m\u00e0 \u0111\u1ed3 th\u1ecb \u0111\u1eb7c bi\u1ec7t c\u1ee7a ch\u00fang ta mang l\u1ea1i. D\u1ea1ng chung c\u1ee7a thu\u1eadt to\u00e1n Dijkstra l\u00e0 (\u1edf \u0111\u00e2y <code>set</code> \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng cho h\u00e0ng \u0111\u1ee3i \u01b0u ti\u00ean):</p> <pre><code>d.assign(n, INF);\nd[s] = 0;\nset&lt;pair&lt;int, int&gt;&gt; q;\nq.insert({0, s});\nwhile (!q.empty()) {\n    int v = q.begin()-&gt;second;\n    q.erase(q.begin());\n\n    for (auto edge : adj[v]) {\n        int u = edge.first;\n        int w = edge.second;\n\n        if (d[v] + w &lt; d[u]) {\n            q.erase({d[u], u});\n            d[u] = d[v] + w;\n            q.insert({d[u], u});\n        }\n    }\n}\n</code></pre> <p>Ch\u00fang ta c\u00f3 th\u1ec3 nh\u1eadn th\u1ea5y r\u1eb1ng s\u1ef1 kh\u00e1c bi\u1ec7t v\u1ec1 kho\u1ea3ng c\u00e1ch gi\u1eefa ngu\u1ed3n <code>s</code> v\u00e0 hai \u0111\u1ec9nh kh\u00e1c trong h\u00e0ng \u0111\u1ee3i sai kh\u00e1c nhau nhi\u1ec1u nh\u1ea5t l\u00e0 m\u1ed9t. \u0110\u1eb7c bi\u1ec7t, ch\u00fang ta bi\u1ebft r\u1eb1ng $d[v] \\le d[u] \\le d[v] + 1$ cho m\u1ed7i $u \\in Q$. L\u00fd do cho \u0111i\u1ec1u n\u00e0y l\u00e0, ch\u00fang ta ch\u1ec9 th\u00eam c\u00e1c \u0111\u1ec9nh c\u00f3 kho\u1ea3ng c\u00e1ch b\u1eb1ng nhau ho\u1eb7c kho\u1ea3ng c\u00e1ch c\u1ed9ng m\u1ed9t v\u00e0o h\u00e0ng \u0111\u1ee3i trong m\u1ed7i l\u1ea7n l\u1eb7p. Gi\u1ea3 s\u1eed t\u1ed3n t\u1ea1i m\u1ed9t $u$ trong h\u00e0ng \u0111\u1ee3i v\u1edbi $d[u] - d[v] &gt; 1$, th\u00ec $u$ ph\u1ea3i \u0111\u01b0\u1ee3c ch\u00e8n v\u00e0o h\u00e0ng \u0111\u1ee3i th\u00f4ng qua m\u1ed9t \u0111\u1ec9nh kh\u00e1c $t$ v\u1edbi $d[t] \\ge d[u] - 1 &gt; d[v]$. Tuy nhi\u00ean \u0111i\u1ec1u n\u00e0y l\u00e0 kh\u00f4ng th\u1ec3, v\u00ec thu\u1eadt to\u00e1n Dijkstra l\u1eb7p qua c\u00e1c \u0111\u1ec9nh theo th\u1ee9 t\u1ef1 t\u0103ng d\u1ea7n.</p> <p>\u0110i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0, th\u1ee9 t\u1ef1 c\u1ee7a h\u00e0ng \u0111\u1ee3i tr\u00f4ng nh\u01b0 sau:</p> $$Q = \\underbrace{v}_{d[v]}, \\dots, \\underbrace{u}_{d[v]}, \\underbrace{m}_{d[v]+1} \\dots \\underbrace{n}_{d[v]+1}$$ <p>C\u1ea5u tr\u00fac n\u00e0y \u0111\u01a1n gi\u1ea3n \u0111\u1ebfn m\u1ee9c ch\u00fang ta kh\u00f4ng c\u1ea7n m\u1ed9t h\u00e0ng \u0111\u1ee3i \u01b0u ti\u00ean th\u1ef1c s\u1ef1, t\u1ee9c l\u00e0 s\u1eed d\u1ee5ng c\u00e2y nh\u1ecb ph\u00e2n c\u00e2n b\u1eb1ng s\u1ebd l\u00e0 qu\u00e1 m\u1ee9c c\u1ea7n thi\u1ebft. Ch\u00fang ta c\u00f3 th\u1ec3 ch\u1ec9 c\u1ea7n s\u1eed d\u1ee5ng m\u1ed9t h\u00e0ng \u0111\u1ee3i b\u00ecnh th\u01b0\u1eddng, v\u00e0 th\u00eam c\u00e1c \u0111\u1ec9nh m\u1edbi v\u00e0o \u0111\u1ea7u n\u1ebfu c\u1ea1nh t\u01b0\u01a1ng \u1ee9ng c\u00f3 tr\u1ecdng s\u1ed1 $0$, t\u1ee9c l\u00e0 n\u1ebfu $d[u] = d[v]$, ho\u1eb7c v\u00e0o cu\u1ed1i n\u1ebfu c\u1ea1nh c\u00f3 tr\u1ecdng s\u1ed1 $1$, t\u1ee9c l\u00e0 n\u1ebfu $d[u] = d[v] + 1$. B\u1eb1ng c\u00e1ch n\u00e0y, h\u00e0ng \u0111\u1ee3i v\u1eabn \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp m\u1ecdi l\u00fac.</p> <pre><code>vector&lt;int&gt; d(n, INF);\nd[s] = 0;\ndeque&lt;int&gt; q;\nq.push_front(s);\nwhile (!q.empty()) {\n    int v = q.front();\n    q.pop_front();\n    for (auto edge : adj[v]) {\n        int u = edge.first;\n        int w = edge.second;\n        if (d[v] + w &lt; d[u]) {\n            d[u] = d[v] + w;\n            if (w == 1)\n                q.push_back(u);\n            else\n                q.push_front(u);\n        }\n    }\n}\n</code></pre>","tags":["Translated"]},{"location":"graph/01_bfs.html#dials-algorithm","title":"Thu\u1eadt to\u00e1n Dial (Dial's algorithm)","text":"<p>Ch\u00fang ta c\u00f3 th\u1ec3 m\u1edf r\u1ed9ng \u0111i\u1ec1u n\u00e0y h\u01a1n n\u1eefa n\u1ebfu ch\u00fang ta cho ph\u00e9p tr\u1ecdng s\u1ed1 c\u1ee7a c\u00e1c c\u1ea1nh l\u1edbn h\u01a1n. N\u1ebfu m\u1ecdi c\u1ea1nh trong \u0111\u1ed3 th\u1ecb c\u00f3 tr\u1ecdng s\u1ed1 $\\le k$, th\u00ec kho\u1ea3ng c\u00e1ch c\u1ee7a c\u00e1c \u0111\u1ec9nh trong h\u00e0ng \u0111\u1ee3i s\u1ebd kh\u00e1c bi\u1ec7t nhi\u1ec1u nh\u1ea5t l\u00e0 $k$ so v\u1edbi kho\u1ea3ng c\u00e1ch t\u1eeb $v$ \u0111\u1ebfn ngu\u1ed3n. V\u00ec v\u1eady, ch\u00fang ta c\u00f3 th\u1ec3 gi\u1eef $k + 1$ bucket cho c\u00e1c \u0111\u1ec9nh trong h\u00e0ng \u0111\u1ee3i, v\u00e0 b\u1ea5t c\u1ee9 khi n\u00e0o bucket t\u01b0\u01a1ng \u1ee9ng v\u1edbi kho\u1ea3ng c\u00e1ch nh\u1ecf nh\u1ea5t tr\u1ed1ng, ch\u00fang ta th\u1ef1c hi\u1ec7n m\u1ed9t d\u1ecbch chuy\u1ec3n v\u00f2ng \u0111\u1ec3 l\u1ea5y bucket c\u00f3 kho\u1ea3ng c\u00e1ch cao h\u01a1n ti\u1ebfp theo. M\u1edf r\u1ed9ng n\u00e0y \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 thu\u1eadt to\u00e1n Dial.</p>","tags":["Translated"]},{"location":"graph/01_bfs.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice problems)","text":"<ul> <li>CodeChef - Chef and Reversing</li> <li>Labyrinth</li> <li>KATHTHI</li> <li>DoNotTurn</li> <li>Ocean Currents</li> <li>Olya and Energy Drinks</li> <li>Three States</li> <li>Colliding Traffic</li> <li>CHamber of Secrets</li> <li>Spiral Maximum</li> <li>Minimum Cost to Make at Least One Valid Path in a Grid</li> </ul>","tags":["Translated"]},{"location":"graph/2SAT.html","title":"2-SAT","text":"<p>SAT (B\u00e0i to\u00e1n th\u1ecfa m\u00e3n Boolean - Boolean satisfiability problem) l\u00e0 b\u00e0i to\u00e1n g\u00e1n c\u00e1c gi\u00e1 tr\u1ecb Boolean cho c\u00e1c bi\u1ebfn \u0111\u1ec3 th\u1ecfa m\u00e3n m\u1ed9t c\u00f4ng th\u1ee9c Boolean \u0111\u00e3 cho. C\u00f4ng th\u1ee9c Boolean th\u01b0\u1eddng s\u1ebd \u0111\u01b0\u1ee3c \u0111\u01b0a ra d\u01b0\u1edbi d\u1ea1ng CNF (d\u1ea1ng chu\u1ea9n h\u1ed9i - conjunctive normal form), l\u00e0 m\u1ed9t h\u1ed9i (AND) c\u1ee7a nhi\u1ec1u m\u1ec7nh \u0111\u1ec1, trong \u0111\u00f3 m\u1ed7i m\u1ec7nh \u0111\u1ec1 l\u00e0 m\u1ed9t tuy\u1ec3n (OR) c\u1ee7a c\u00e1c literal (bi\u1ebfn ho\u1eb7c ph\u1ee7 \u0111\u1ecbnh c\u1ee7a bi\u1ebfn). 2-SAT (2-satisfiability) l\u00e0 m\u1ed9t h\u1ea1n ch\u1ebf c\u1ee7a b\u00e0i to\u00e1n SAT, trong 2-SAT m\u1ed7i m\u1ec7nh \u0111\u1ec1 c\u00f3 ch\u00ednh x\u00e1c hai literal. D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u1ed9t v\u00ed d\u1ee5 v\u1ec1 b\u00e0i to\u00e1n 2-SAT nh\u01b0 v\u1eady. T\u00ecm m\u1ed9t ph\u00e9p g\u00e1n c\u1ee7a $a, b, c$ sao cho c\u00f4ng th\u1ee9c sau l\u00e0 \u0111\u00fang:</p> $$(a \\lor \\lnot b) \\land (\\lnot a \\lor b) \\land (\\lnot a \\lor \\lnot b) \\land (a \\lor \\lnot c)$$ <p>SAT l\u00e0 NP-\u0111\u1ea7y \u0111\u1ee7, kh\u00f4ng c\u00f3 gi\u1ea3i ph\u00e1p hi\u1ec7u qu\u1ea3 n\u00e0o \u0111\u01b0\u1ee3c bi\u1ebft \u0111\u1ebfn cho n\u00f3. Tuy nhi\u00ean 2SAT c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i quy\u1ebft hi\u1ec7u qu\u1ea3 trong $O(n + m)$ trong \u0111\u00f3 $n$ l\u00e0 s\u1ed1 l\u01b0\u1ee3ng bi\u1ebfn v\u00e0 $m$ l\u00e0 s\u1ed1 l\u01b0\u1ee3ng m\u1ec7nh \u0111\u1ec1.</p>","tags":["Translated"]},{"location":"graph/2SAT.html#algorithm","title":"Thu\u1eadt to\u00e1n (Algorithm)","text":"<p>\u0110\u1ea7u ti\u00ean ch\u00fang ta c\u1ea7n chuy\u1ec3n \u0111\u1ed5i b\u00e0i to\u00e1n sang m\u1ed9t d\u1ea1ng kh\u00e1c, c\u00e1i g\u1ecdi l\u00e0 d\u1ea1ng chu\u1ea9n k\u00e9o theo (implicative normal form). L\u01b0u \u00fd r\u1eb1ng bi\u1ec3u th\u1ee9c $a \\lor b$ t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi $\\lnot a \\Rightarrow b \\land \\lnot b \\Rightarrow a$ (n\u1ebfu m\u1ed9t trong hai bi\u1ebfn l\u00e0 sai, th\u00ec bi\u1ebfn kia ph\u1ea3i \u0111\u00fang).</p> <p>B\u00e2y gi\u1edd ch\u00fang ta x\u00e2y d\u1ef1ng m\u1ed9t \u0111\u1ed3 th\u1ecb c\u00f3 h\u01b0\u1edbng c\u1ee7a nh\u1eefng ph\u00e9p k\u00e9o theo n\u00e0y: \u0111\u1ed1i v\u1edbi m\u1ed7i bi\u1ebfn $x$ s\u1ebd c\u00f3 hai \u0111\u1ec9nh $v_x$ v\u00e0 $v_{\\lnot x}$. C\u00e1c c\u1ea1nh s\u1ebd t\u01b0\u01a1ng \u1ee9ng v\u1edbi c\u00e1c ph\u00e9p k\u00e9o theo.</p> <p>H\u00e3y xem v\u00ed d\u1ee5 \u1edf d\u1ea1ng 2-CNF:</p> $$(a \\lor \\lnot b) \\land (\\lnot a \\lor b) \\land (\\lnot a \\lor \\lnot b) \\land (a \\lor \\lnot c)$$ <p>\u0110\u1ed3 th\u1ecb c\u00f3 h\u01b0\u1edbng s\u1ebd ch\u1ee9a c\u00e1c \u0111\u1ec9nh v\u00e0 c\u1ea1nh sau:</p> $$\\begin{array}{cccc} \\lnot a \\Rightarrow \\lnot b &amp; a \\Rightarrow b &amp; a \\Rightarrow \\lnot b &amp; \\lnot a \\Rightarrow \\lnot c\\\\ b \\Rightarrow a &amp; \\lnot b \\Rightarrow \\lnot a &amp; b \\Rightarrow \\lnot a &amp; c \\Rightarrow a \\end{array}$$ <p>B\u1ea1n c\u00f3 th\u1ec3 th\u1ea5y \u0111\u1ed3 th\u1ecb k\u00e9o theo trong h\u00ecnh \u1ea3nh sau \u0111\u00e2y:</p> <p>C\u1ea7n ch\u00fa \u00fd \u0111\u1ebfn t\u00ednh ch\u1ea5t c\u1ee7a \u0111\u1ed3 th\u1ecb k\u00e9o theo: n\u1ebfu c\u00f3 m\u1ed9t c\u1ea1nh $a \\Rightarrow b$, th\u00ec c\u0169ng c\u00f3 m\u1ed9t c\u1ea1nh $\\lnot b \\Rightarrow \\lnot a$.</p> <p>C\u0169ng l\u01b0u \u00fd r\u1eb1ng, n\u1ebfu $x$ c\u00f3 th\u1ec3 \u0111i t\u1edbi t\u1eeb $\\lnot x$, v\u00e0 $\\lnot x$ c\u00f3 th\u1ec3 \u0111i t\u1edbi t\u1eeb $x$, th\u00ec b\u00e0i to\u00e1n kh\u00f4ng c\u00f3 l\u1eddi gi\u1ea3i. B\u1ea5t k\u1ef3 gi\u00e1 tr\u1ecb n\u00e0o ch\u00fang ta ch\u1ecdn cho bi\u1ebfn $x$, n\u00f3 s\u1ebd lu\u00f4n k\u1ebft th\u00fac b\u1eb1ng m\u1ed9t m\u00e2u thu\u1eabn - n\u1ebfu $x$ \u0111\u01b0\u1ee3c g\u00e1n l\u00e0 $\\text{true}$ th\u00ec ph\u00e9p k\u00e9o theo cho ch\u00fang ta bi\u1ebft r\u1eb1ng $\\lnot x$ c\u0169ng ph\u1ea3i l\u00e0 $\\text{true}$ v\u00e0 ng\u01b0\u1ee3c l\u1ea1i. H\u00f3a ra, \u0111i\u1ec1u ki\u1ec7n n\u00e0y kh\u00f4ng ch\u1ec9 c\u1ea7n thi\u1ebft, m\u00e0 c\u00f2n \u0111\u1ee7. Ch\u00fang t\u00f4i s\u1ebd ch\u1ee9ng minh \u0111i\u1ec1u n\u00e0y trong m\u1ed9t v\u00e0i \u0111o\u1ea1n d\u01b0\u1edbi \u0111\u00e2y. \u0110\u1ea7u ti\u00ean h\u00e3y nh\u1edb l\u1ea1i, n\u1ebfu m\u1ed9t \u0111\u1ec9nh c\u00f3 th\u1ec3 \u0111i t\u1edbi t\u1eeb \u0111\u1ec9nh th\u1ee9 hai, v\u00e0 \u0111\u1ec9nh th\u1ee9 hai c\u00f3 th\u1ec3 \u0111i t\u1edbi t\u1eeb \u0111\u1ec9nh \u0111\u1ea7u ti\u00ean, th\u00ec hai \u0111\u1ec9nh n\u00e0y n\u1eb1m trong c\u00f9ng m\u1ed9t th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh. Do \u0111\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 x\u00e2y d\u1ef1ng ti\u00eau ch\u00ed cho s\u1ef1 t\u1ed3n t\u1ea1i c\u1ee7a m\u1ed9t gi\u1ea3i ph\u00e1p nh\u01b0 sau:</p> <p>\u0110\u1ec3 b\u00e0i to\u00e1n 2-SAT n\u00e0y c\u00f3 l\u1eddi gi\u1ea3i, \u0111i\u1ec1u ki\u1ec7n c\u1ea7n v\u00e0 \u0111\u1ee7 l\u00e0 \u0111\u1ed1i v\u1edbi b\u1ea5t k\u1ef3 bi\u1ebfn $x$ n\u00e0o, c\u00e1c \u0111\u1ec9nh $x$ v\u00e0 $\\lnot x$ n\u1eb1m trong c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh kh\u00e1c nhau c\u1ee7a \u0111\u1ed3 th\u1ecb k\u00e9o theo.</p> <p>Ti\u00eau ch\u00ed n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c x\u00e1c minh trong th\u1eddi gian $O(n + m)$ b\u1eb1ng c\u00e1ch t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh.</p> <p>H\u00ecnh \u1ea3nh sau \u0111\u00e2y hi\u1ec3n th\u1ecb t\u1ea5t c\u1ea3 c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh cho v\u00ed d\u1ee5. Nh\u01b0 ch\u00fang ta c\u00f3 th\u1ec3 ki\u1ec3m tra d\u1ec5 d\u00e0ng, kh\u00f4ng c\u00f3 th\u00e0nh ph\u1ea7n n\u00e0o trong b\u1ed1n th\u00e0nh ph\u1ea7n ch\u1ee9a m\u1ed9t \u0111\u1ec9nh $x$ v\u00e0 ph\u1ee7 \u0111\u1ecbnh c\u1ee7a n\u00f3 $\\lnot x$, do \u0111\u00f3 v\u00ed d\u1ee5 c\u00f3 m\u1ed9t gi\u1ea3i ph\u00e1p. Ch\u00fang ta s\u1ebd t\u00ecm hi\u1ec3u trong c\u00e1c \u0111o\u1ea1n ti\u1ebfp theo c\u00e1ch t\u00ednh to\u00e1n m\u1ed9t ph\u00e9p g\u00e1n h\u1ee3p l\u1ec7, nh\u01b0ng ch\u1ec9 cho m\u1ee5c \u0111\u00edch minh h\u1ecda, gi\u1ea3i ph\u00e1p $a = \\text{false}$, $b = \\text{false}$, $c = \\text{false}$ \u0111\u01b0\u1ee3c \u0111\u01b0a ra.</p> <p>B\u00e2y gi\u1edd ch\u00fang ta x\u00e2y d\u1ef1ng thu\u1eadt to\u00e1n \u0111\u1ec3 t\u00ecm l\u1eddi gi\u1ea3i c\u1ee7a b\u00e0i to\u00e1n 2-SAT v\u1edbi gi\u1ea3 \u0111\u1ecbnh r\u1eb1ng l\u1eddi gi\u1ea3i t\u1ed3n t\u1ea1i.</p> <p>L\u01b0u \u00fd r\u1eb1ng, m\u1eb7c d\u00f9 th\u1ef1c t\u1ebf l\u00e0 l\u1eddi gi\u1ea3i t\u1ed3n t\u1ea1i, v\u1eabn c\u00f3 th\u1ec3 x\u1ea3y ra tr\u01b0\u1eddng h\u1ee3p $\\lnot x$ c\u00f3 th\u1ec3 \u0111i t\u1edbi t\u1eeb $x$ trong \u0111\u1ed3 th\u1ecb k\u00e9o theo, ho\u1eb7c (nh\u01b0ng kh\u00f4ng \u0111\u1ed3ng th\u1eddi) $x$ c\u00f3 th\u1ec3 \u0111i t\u1edbi t\u1eeb $\\lnot x$. Trong tr\u01b0\u1eddng h\u1ee3p \u0111\u00f3, vi\u1ec7c ch\u1ecdn $\\text{true}$ ho\u1eb7c $\\text{false}$ cho $x$ s\u1ebd d\u1eabn \u0111\u1ebfn m\u00e2u thu\u1eabn, trong khi vi\u1ec7c ch\u1ecdn c\u00e1i c\u00f2n l\u1ea1i s\u1ebd kh\u00f4ng. H\u00e3y t\u00ecm hi\u1ec3u c\u00e1ch ch\u1ecdn m\u1ed9t gi\u00e1 tr\u1ecb, sao cho ch\u00fang ta kh\u00f4ng t\u1ea1o ra m\u00e2u thu\u1eabn.</p> <p>H\u00e3y s\u1eafp x\u1ebfp c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh theo th\u1ee9 t\u1ef1 t\u00f4 p\u00f4 (t\u1ee9c l\u00e0 $\\text{comp}[v] \\le \\text{comp}[u]$ n\u1ebfu c\u00f3 \u0111\u01b0\u1eddng \u0111i t\u1eeb $v$ \u0111\u1ebfn $u$) v\u00e0 g\u1ecdi $\\text{comp}[v]$ l\u00e0 ch\u1ec9 s\u1ed1 c\u1ee7a th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh m\u00e0 \u0111\u1ec9nh $v$ thu\u1ed9c v\u1ec1. Sau \u0111\u00f3, n\u1ebfu $\\text{comp}[x] &lt; \\text{comp}[\\lnot x]$ ch\u00fang ta g\u00e1n $x$ v\u1edbi $\\text{false}$ v\u00e0 $\\text{true}$ n\u1ebfu ng\u01b0\u1ee3c l\u1ea1i.</p> <p>H\u00e3y ch\u1ee9ng minh r\u1eb1ng v\u1edbi ph\u00e9p g\u00e1n c\u00e1c bi\u1ebfn n\u00e0y, ch\u00fang ta kh\u00f4ng \u0111i \u0111\u1ebfn m\u00e2u thu\u1eabn. Gi\u1ea3 s\u1eed $x$ \u0111\u01b0\u1ee3c g\u00e1n v\u1edbi $\\text{true}$. Tr\u01b0\u1eddng h\u1ee3p kh\u00e1c c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c ch\u1ee9ng minh theo c\u00e1ch t\u01b0\u01a1ng t\u1ef1.</p> <p>\u0110\u1ea7u ti\u00ean ch\u00fang ta ch\u1ee9ng minh r\u1eb1ng \u0111\u1ec9nh $x$ kh\u00f4ng th\u1ec3 \u0111i \u0111\u1ebfn \u0111\u1ec9nh $\\lnot x$. B\u1edfi v\u00ec ch\u00fang ta \u0111\u00e3 g\u00e1n $\\text{true}$, n\u00ean ch\u1ec9 s\u1ed1 c\u1ee7a th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh c\u1ee7a $x$ ph\u1ea3i l\u1edbn h\u01a1n ch\u1ec9 s\u1ed1 c\u1ee7a th\u00e0nh ph\u1ea7n c\u1ee7a $\\lnot x$. \u0110i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 $\\lnot x$ n\u1eb1m b\u00ean tr\u00e1i c\u1ee7a th\u00e0nh ph\u1ea7n ch\u1ee9a $x$, v\u00e0 \u0111\u1ec9nh sau kh\u00f4ng th\u1ec3 \u0111i \u0111\u1ebfn \u0111\u1ec9nh tr\u01b0\u1edbc.</p> <p>Th\u1ee9 hai, ch\u00fang ta ch\u1ee9ng minh r\u1eb1ng kh\u00f4ng t\u1ed3n t\u1ea1i bi\u1ebfn $y$, sao cho c\u00e1c \u0111\u1ec9nh $y$ v\u00e0 $\\lnot y$ \u0111\u1ec1u c\u00f3 th\u1ec3 \u0111i t\u1edbi t\u1eeb $x$ trong \u0111\u1ed3 th\u1ecb k\u00e9o theo. \u0110i\u1ec1u n\u00e0y s\u1ebd g\u00e2y ra m\u00e2u thu\u1eabn, b\u1edfi v\u00ec $x = \\text{true}$ suy ra r\u1eb1ng $y = \\text{true}$ v\u00e0 $\\lnot y = \\text{true}$. H\u00e3y ch\u1ee9ng minh \u0111i\u1ec1u n\u00e0y b\u1eb1ng ph\u1ea3n ch\u1ee9ng. Gi\u1ea3 s\u1eed r\u1eb1ng $y$ v\u00e0 $\\lnot y$ \u0111\u1ec1u c\u00f3 th\u1ec3 \u0111i t\u1edbi t\u1eeb $x$, th\u00ec theo t\u00ednh ch\u1ea5t c\u1ee7a \u0111\u1ed3 th\u1ecb k\u00e9o theo $\\lnot x$ c\u00f3 th\u1ec3 \u0111i t\u1edbi t\u1eeb c\u1ea3 $y$ v\u00e0 $\\lnot y$. Theo t\u00ednh ch\u1ea5t b\u1eafc c\u1ea7u, \u0111i\u1ec1u n\u00e0y d\u1eabn \u0111\u1ebfn k\u1ebft qu\u1ea3 l\u00e0 $\\lnot x$ c\u00f3 th\u1ec3 \u0111i t\u1edbi b\u1edfi $x$, \u0111i\u1ec1u n\u00e0y m\u00e2u thu\u1eabn v\u1edbi gi\u1ea3 \u0111\u1ecbnh.</p> <p>V\u00ec v\u1eady, ch\u00fang ta \u0111\u00e3 x\u00e2y d\u1ef1ng m\u1ed9t thu\u1eadt to\u00e1n t\u00ecm c\u00e1c gi\u00e1 tr\u1ecb c\u1ea7n thi\u1ebft c\u1ee7a c\u00e1c bi\u1ebfn v\u1edbi gi\u1ea3 \u0111\u1ecbnh r\u1eb1ng \u0111\u1ed1i v\u1edbi b\u1ea5t k\u1ef3 bi\u1ebfn $x$ n\u00e0o, c\u00e1c \u0111\u1ec9nh $x$ v\u00e0 $\\lnot x$ n\u1eb1m trong c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh kh\u00e1c nhau. Tr\u00ean \u0111\u00e2y \u0111\u00e3 ch\u1ec9 ra t\u00ednh \u0111\u00fang \u0111\u1eafn c\u1ee7a thu\u1eadt to\u00e1n n\u00e0y. Do \u0111\u00f3, ch\u00fang t\u00f4i \u0111\u1ed3ng th\u1eddi \u0111\u00e3 ch\u1ee9ng minh ti\u00eau ch\u00ed tr\u00ean cho s\u1ef1 t\u1ed3n t\u1ea1i c\u1ee7a m\u1ed9t gi\u1ea3i ph\u00e1p.</p>","tags":["Translated"]},{"location":"graph/2SAT.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>B\u00e2y gi\u1edd ch\u00fang ta c\u00f3 th\u1ec3 c\u00e0i \u0111\u1eb7t to\u00e0n b\u1ed9 thu\u1eadt to\u00e1n. \u0110\u1ea7u ti\u00ean ch\u00fang ta x\u00e2y d\u1ef1ng \u0111\u1ed3 th\u1ecb k\u00e9o theo v\u00e0 t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh. \u0110i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n v\u1edbi thu\u1eadt to\u00e1n Kosaraju trong th\u1eddi gian $O(n + m)$. Trong l\u1ea7n duy\u1ec7t th\u1ee9 hai c\u1ee7a \u0111\u1ed3 th\u1ecb, thu\u1eadt to\u00e1n Kosaraju th\u0103m c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh theo th\u1ee9 t\u1ef1 t\u00f4 p\u00f4, do \u0111\u00f3 r\u1ea5t d\u1ec5 \u0111\u1ec3 t\u00ednh $\\text{comp}[v]$ cho m\u1ed7i \u0111\u1ec9nh $v$.</p> <p>Sau \u0111\u00f3 ch\u00fang ta c\u00f3 th\u1ec3 ch\u1ecdn ph\u00e9p g\u00e1n c\u1ee7a $x$ b\u1eb1ng c\u00e1ch so s\u00e1nh $\\text{comp}[x]$ v\u00e0 $\\text{comp}[\\lnot x]$. N\u1ebfu $\\text{comp}[x] = \\text{comp}[\\lnot x]$ ch\u00fang ta tr\u1ea3 v\u1ec1 $\\text{false}$ \u0111\u1ec3 ch\u1ec9 ra r\u1eb1ng kh\u00f4ng t\u1ed3n t\u1ea1i ph\u00e9p g\u00e1n h\u1ee3p l\u1ec7 n\u00e0o th\u1ecfa m\u00e3n b\u00e0i to\u00e1n 2-SAT.</p> <p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 c\u00e0i \u0111\u1eb7t gi\u1ea3i ph\u00e1p c\u1ee7a b\u00e0i to\u00e1n 2-SAT cho \u0111\u1ed3 th\u1ecb k\u00e9o theo $adj$ \u0111\u00e3 \u0111\u01b0\u1ee3c x\u00e2y d\u1ef1ng v\u00e0 \u0111\u1ed3 th\u1ecb chuy\u1ec3n v\u1ecb $adj^{\\intercal}$ (trong \u0111\u00f3 h\u01b0\u1edbng c\u1ee7a m\u1ed7i c\u1ea1nh b\u1ecb \u0111\u1ea3o ng\u01b0\u1ee3c). Trong \u0111\u1ed3 th\u1ecb, c\u00e1c \u0111\u1ec9nh c\u00f3 ch\u1ec9 s\u1ed1 $2k$ v\u00e0 $2k+1$ l\u00e0 hai \u0111\u1ec9nh t\u01b0\u01a1ng \u1ee9ng v\u1edbi bi\u1ebfn $k$ v\u1edbi $2k+1$ t\u01b0\u01a1ng \u1ee9ng v\u1edbi bi\u1ebfn b\u1ecb ph\u1ee7 \u0111\u1ecbnh.</p> <pre><code>struct TwoSatSolver {\n    int n_vars;\n    int n_vertices;\n    vector&lt;vector&lt;int&gt;&gt; adj, adj_t;\n    vector&lt;bool&gt; used;\n    vector&lt;int&gt; order, comp;\n    vector&lt;bool&gt; assignment;\n\n    TwoSatSolver(int _n_vars) : n_vars(_n_vars), n_vertices(2 * n_vars), adj(n_vertices), adj_t(n_vertices), used(n_vertices), order(), comp(n_vertices, -1), assignment(n_vars) {\n        order.reserve(n_vertices);\n    }\n    void dfs1(int v) {\n        used[v] = true;\n        for (int u : adj[v]) {\n            if (!used[u])\n                dfs1(u);\n        }\n        order.push_back(v);\n    }\n\n    void dfs2(int v, int cl) {\n        comp[v] = cl;\n        for (int u : adj_t[v]) {\n            if (comp[u] == -1)\n                dfs2(u, cl);\n        }\n    }\n\n    bool solve_2SAT() {\n        order.clear();\n        used.assign(n_vertices, false);\n        for (int i = 0; i &lt; n_vertices; ++i) {\n            if (!used[i])\n                dfs1(i);\n        }\n\n        comp.assign(n_vertices, -1);\n        for (int i = 0, j = 0; i &lt; n_vertices; ++i) {\n            int v = order[n_vertices - i - 1];\n            if (comp[v] == -1)\n                dfs2(v, j++);\n        }\n\n        assignment.assign(n_vars, false);\n        for (int i = 0; i &lt; n_vertices; i += 2) {\n            if (comp[i] == comp[i + 1])\n                return false;\n            assignment[i / 2] = comp[i] &gt; comp[i + 1];\n        }\n        return true;\n    }\n\n    void add_disjunction(int a, bool na, int b, bool nb) {\n        // na and nb signify whether a and b are to be negated \n        a = 2 * a ^ na;\n        b = 2 * b ^ nb;\n        int neg_a = a ^ 1;\n        int neg_b = b ^ 1;\n        adj[neg_a].push_back(b);\n        adj[neg_b].push_back(a);\n        adj_t[b].push_back(neg_a);\n        adj_t[a].push_back(neg_b);\n    }\n\n    static void example_usage() {\n        TwoSatSolver solver(3); // a, b, c\n        solver.add_disjunction(0, false, 1, true);  //     a  v  not b\n        solver.add_disjunction(0, true, 1, true);   // not a  v  not b\n        solver.add_disjunction(1, false, 2, false); //     b  v      c\n        solver.add_disjunction(0, false, 0, false); //     a  v      a\n        assert(solver.solve_2SAT() == true);\n        auto expected = vector&lt;bool&gt;(True, False, True);\n        assert(solver.assignment == expected);\n    }\n};\n</code></pre>","tags":["Translated"]},{"location":"graph/2SAT.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>Codeforces: The Door Problem</li> <li>Kattis: Illumination</li> <li>UVA: Rectangles</li> <li>Codeforces : Radio Stations</li> <li>CSES : Giant Pizza</li> <li>Codeforces: +-1</li> <li>Gym: (C) Colorful Village</li> <li>POI: Renovation</li> </ul>","tags":["Translated"]},{"location":"graph/Assignment-problem-min-flow.html","title":"Gi\u1ea3i quy\u1ebft b\u00e0i to\u00e1n ph\u00e2n c\u00f4ng s\u1eed d\u1ee5ng lu\u1ed3ng chi ph\u00ed nh\u1ecf nh\u1ea5t (Solving assignment problem using min-cost-flow)","text":"<p>B\u00e0i to\u00e1n ph\u00e2n c\u00f4ng (assignment problem) c\u00f3 hai ph\u00e1t bi\u1ec3u t\u01b0\u01a1ng \u0111\u01b0\u01a1ng:</p> <ul> <li>Cho m\u1ed9t ma tr\u1eadn vu\u00f4ng $A[1..N, 1..N]$, b\u1ea1n c\u1ea7n ch\u1ecdn $N$ ph\u1ea7n t\u1eed trong \u0111\u00f3 sao cho ch\u00ednh x\u00e1c m\u1ed9t ph\u1ea7n t\u1eed \u0111\u01b0\u1ee3c ch\u1ecdn trong m\u1ed7i h\u00e0ng v\u00e0 m\u1ed7i c\u1ed9t, v\u00e0 t\u1ed5ng gi\u00e1 tr\u1ecb c\u1ee7a c\u00e1c ph\u1ea7n t\u1eed n\u00e0y l\u00e0 nh\u1ecf nh\u1ea5t.</li> <li>C\u00f3 $N$ \u0111\u01a1n h\u00e0ng v\u00e0 $N$ m\u00e1y m\u00f3c. Chi ph\u00ed s\u1ea3n xu\u1ea5t tr\u00ean m\u1ed7i m\u00e1y \u0111\u01b0\u1ee3c bi\u1ebft cho m\u1ed7i \u0111\u01a1n h\u00e0ng. Ch\u1ec9 m\u1ed9t \u0111\u01a1n h\u00e0ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n tr\u00ean m\u1ed7i m\u00e1y. C\u1ea7n ph\u00e2n c\u00f4ng t\u1ea5t c\u1ea3 c\u00e1c \u0111\u01a1n h\u00e0ng cho c\u00e1c m\u00e1y sao cho t\u1ed5ng chi ph\u00ed \u0111\u01b0\u1ee3c gi\u1ea3m thi\u1ec3u.</li> </ul> <p>\u1ede \u0111\u00e2y ch\u00fang ta s\u1ebd xem x\u00e9t gi\u1ea3i ph\u00e1p c\u1ee7a b\u00e0i to\u00e1n d\u1ef1a tr\u00ean thu\u1eadt to\u00e1n t\u00ecm lu\u1ed3ng chi ph\u00ed nh\u1ecf nh\u1ea5t (min-cost-flow), gi\u1ea3i quy\u1ebft b\u00e0i to\u00e1n ph\u00e2n c\u00f4ng trong $\\mathcal{O}(N^3)$.</p>","tags":["Translated"]},{"location":"graph/Assignment-problem-min-flow.html#description","title":"M\u00f4 t\u1ea3 (Description)","text":"<p>H\u00e3y x\u00e2y d\u1ef1ng m\u1ed9t m\u1ea1ng hai ph\u00eda: c\u00f3 m\u1ed9t ngu\u1ed3n $S$, m\u1ed9t \u0111\u00edch $T$, trong ph\u1ea7n \u0111\u1ea7u ti\u00ean c\u00f3 $N$ \u0111\u1ec9nh (t\u01b0\u01a1ng \u1ee9ng v\u1edbi c\u00e1c h\u00e0ng c\u1ee7a ma tr\u1eadn, ho\u1eb7c c\u00e1c \u0111\u01a1n h\u00e0ng), trong ph\u1ea7n th\u1ee9 hai c\u0169ng c\u00f3 $N$ \u0111\u1ec9nh (t\u01b0\u01a1ng \u1ee9ng v\u1edbi c\u00e1c c\u1ed9t c\u1ee7a ma tr\u1eadn, ho\u1eb7c m\u00e1y m\u00f3c). Gi\u1eefa m\u1ed7i \u0111\u1ec9nh $i$ c\u1ee7a t\u1eadp h\u1ee3p th\u1ee9 nh\u1ea5t v\u00e0 m\u1ed7i \u0111\u1ec9nh $j$ c\u1ee7a t\u1eadp h\u1ee3p th\u1ee9 hai, ch\u00fang ta v\u1ebd m\u1ed9t c\u1ea1nh v\u1edbi dung l\u01b0\u1ee3ng 1 v\u00e0 chi ph\u00ed $A_{ij}$. T\u1eeb ngu\u1ed3n $S$ ch\u00fang ta v\u1ebd c\u00e1c c\u1ea1nh \u0111\u1ebfn t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh $i$ c\u1ee7a t\u1eadp h\u1ee3p th\u1ee9 nh\u1ea5t v\u1edbi dung l\u01b0\u1ee3ng 1 v\u00e0 chi ph\u00ed 0. Ch\u00fang ta v\u1ebd m\u1ed9t c\u1ea1nh v\u1edbi dung l\u01b0\u1ee3ng 1 v\u00e0 chi ph\u00ed 0 t\u1eeb m\u1ed7i \u0111\u1ec9nh c\u1ee7a t\u1eadp h\u1ee3p th\u1ee9 hai $j$ \u0111\u1ebfn \u0111\u00edch $T$.</p> <p>Ch\u00fang ta t\u00ecm lu\u1ed3ng c\u1ef1c \u0111\u1ea1i chi ph\u00ed nh\u1ecf nh\u1ea5t trong m\u1ea1ng k\u1ebft qu\u1ea3. R\u00f5 r\u00e0ng, gi\u00e1 tr\u1ecb c\u1ee7a lu\u1ed3ng s\u1ebd l\u00e0 $N$. H\u01a1n n\u1eefa, \u0111\u1ed1i v\u1edbi m\u1ed7i \u0111\u1ec9nh $i$ c\u1ee7a \u0111o\u1ea1n th\u1ee9 nh\u1ea5t c\u00f3 ch\u00ednh x\u00e1c m\u1ed9t \u0111\u1ec9nh $j$ c\u1ee7a \u0111o\u1ea1n th\u1ee9 hai, sao cho lu\u1ed3ng $F_{ij}$ = 1. Cu\u1ed1i c\u00f9ng, \u0111\u00e2y l\u00e0 m\u1ed9t s\u1ef1 t\u01b0\u01a1ng \u1ee9ng 1-1 gi\u1eefa c\u00e1c \u0111\u1ec9nh c\u1ee7a \u0111o\u1ea1n th\u1ee9 nh\u1ea5t v\u00e0 c\u00e1c \u0111\u1ec9nh c\u1ee7a ph\u1ea7n th\u1ee9 hai, \u0111\u00f3 l\u00e0 l\u1eddi gi\u1ea3i cho b\u00e0i to\u00e1n (v\u00ec lu\u1ed3ng t\u00ecm \u0111\u01b0\u1ee3c c\u00f3 chi ph\u00ed t\u1ed1i thi\u1ec3u, n\u00ean t\u1ed5ng chi ph\u00ed c\u1ee7a c\u00e1c c\u1ea1nh \u0111\u01b0\u1ee3c ch\u1ecdn s\u1ebd l\u00e0 th\u1ea5p nh\u1ea5t c\u00f3 th\u1ec3, \u0111\u00f3 l\u00e0 ti\u00eau ch\u00ed t\u1ed1i \u01b0u).</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a gi\u1ea3i ph\u00e1p n\u00e0y cho b\u00e0i to\u00e1n ph\u00e2n c\u00f4ng ph\u1ee5 thu\u1ed9c v\u00e0o thu\u1eadt to\u00e1n m\u00e0 vi\u1ec7c t\u00ecm lu\u1ed3ng c\u1ef1c \u0111\u1ea1i chi ph\u00ed nh\u1ecf nh\u1ea5t \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n. \u0110\u1ed9 ph\u1ee9c t\u1ea1p s\u1ebd l\u00e0 $\\mathcal{O}(N^3)$ khi s\u1eed d\u1ee5ng Dijkstra ho\u1eb7c $\\mathcal{O}(N^4)$ khi s\u1eed d\u1ee5ng Bellman-Ford. \u0110i\u1ec1u n\u00e0y l\u00e0 do th\u1ef1c t\u1ebf l\u00e0 lu\u1ed3ng c\u00f3 k\u00edch th\u01b0\u1edbc $O(N)$ v\u00e0 m\u1ed7i l\u1ea7n l\u1eb7p c\u1ee7a thu\u1eadt to\u00e1n Dijkstra c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong $O(N^2)$, trong khi \u0111\u00f3 l\u00e0 $O(N^3)$ cho Bellman-Ford.</p>","tags":["Translated"]},{"location":"graph/Assignment-problem-min-flow.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>Vi\u1ec7c c\u00e0i \u0111\u1eb7t \u0111\u01b0\u1ee3c \u0111\u01b0a ra \u1edf \u0111\u00e2y r\u1ea5t d\u00e0i, n\u00f3 c\u00f3 th\u1ec3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3m \u0111\u00e1ng k\u1ec3. N\u00f3 s\u1eed d\u1ee5ng thu\u1eadt to\u00e1n SPFA \u0111\u1ec3 t\u00ecm \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t.</p> <pre><code>const int INF = 1000 * 1000 * 1000;\n\nvector&lt;int&gt; assignment(vector&lt;vector&lt;int&gt;&gt; a) {\n    int n = a.size();\n    int m = n * 2 + 2;\n    vector&lt;vector&lt;int&gt;&gt; f(m, vector&lt;int&gt;(m));\n    int s = m - 2, t = m - 1;\n    int cost = 0;\n    while (true) {\n        vector&lt;int&gt; dist(m, INF);\n        vector&lt;int&gt; p(m);\n        vector&lt;bool&gt; inq(m, false);\n        queue&lt;int&gt; q;\n        dist[s] = 0;\n        p[s] = -1;\n        q.push(s);\n        while (!q.empty()) {\n            int v = q.front();\n            q.pop();\n            inq[v] = false;\n            if (v == s) {\n                for (int i = 0; i &lt; n; ++i) {\n                    if (f[s][i] == 0) {\n                        dist[i] = 0;\n                        p[i] = s;\n                        inq[i] = true;\n                        q.push(i);\n                    }\n                }\n            } else {\n                if (v &lt; n) {\n                    for (int j = n; j &lt; n + n; ++j) {\n                        if (f[v][j] &lt; 1 &amp;&amp; dist[j] &gt; dist[v] + a[v][j - n]) {\n                            dist[j] = dist[v] + a[v][j - n];\n                            p[j] = v;\n                            if (!inq[j]) {\n                                q.push(j);\n                                inq[j] = true;\n                            }\n                        }\n                    }\n                } else {\n                    for (int j = 0; j &lt; n; ++j) {\n                        if (f[v][j] &lt; 0 &amp;&amp; dist[j] &gt; dist[v] - a[j][v - n]) {\n                            dist[j] = dist[v] - a[j][v - n];\n                            p[j] = v;\n                            if (!inq[j]) {\n                                q.push(j);\n                                inq[j] = true;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n\n        int curcost = INF;\n        for (int i = n; i &lt; n + n; ++i) {\n            if (f[i][t] == 0 &amp;&amp; dist[i] &lt; curcost) {\n                curcost = dist[i];\n                p[t] = i;\n            }\n        }\n        if (curcost == INF)\n            break;\n        cost += curcost;\n        for (int cur = t; cur != -1; cur = p[cur]) {\n            int prev = p[cur];\n            if (prev != -1)\n                f[cur][prev] = -(f[prev][cur] = 1);\n        }\n    }\n\n    vector&lt;int&gt; answer(n);\n    for (int i = 0; i &lt; n; ++i) {\n        for (int j = 0; j &lt; n; ++j) {\n            if (f[i][j + n] == 1)\n                answer[i] = j;\n        }\n    }\n    return answer;\n}\n</code></pre>","tags":["Translated"]},{"location":"graph/all-pair-shortest-path-floyd-warshall.html","title":"Thu\u1eadt to\u00e1n Floyd-Warshall (Floyd-Warshall Algorithm)","text":"<p>Cho m\u1ed9t \u0111\u1ed3 th\u1ecb c\u00f3 tr\u1ecdng s\u1ed1 c\u00f3 h\u01b0\u1edbng ho\u1eb7c v\u00f4 h\u01b0\u1edbng $G$ v\u1edbi $n$ \u0111\u1ec9nh. Nhi\u1ec7m v\u1ee5 l\u00e0 t\u00ecm \u0111\u1ed9 d\u00e0i c\u1ee7a \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t $d_{ij}$ gi\u1eefa m\u1ed7i c\u1eb7p \u0111\u1ec9nh $i$ v\u00e0 $j$.</p> <p>\u0110\u1ed3 th\u1ecb c\u00f3 th\u1ec3 c\u00f3 c\u00e1c c\u1ea1nh tr\u1ecdng s\u1ed1 \u00e2m, nh\u01b0ng kh\u00f4ng c\u00f3 chu tr\u00ecnh tr\u1ecdng s\u1ed1 \u00e2m.</p> <p>N\u1ebfu c\u00f3 m\u1ed9t chu tr\u00ecnh \u00e2m nh\u01b0 v\u1eady, b\u1ea1n c\u00f3 th\u1ec3 ch\u1ec9 c\u1ea7n \u0111i qua chu tr\u00ecnh n\u00e0y l\u1eb7p \u0111i l\u1eb7p l\u1ea1i, trong m\u1ed7i l\u1ea7n l\u1eb7p l\u00e0m cho chi ph\u00ed c\u1ee7a \u0111\u01b0\u1eddng \u0111i nh\u1ecf h\u01a1n. V\u00ec v\u1eady, b\u1ea1n c\u00f3 th\u1ec3 l\u00e0m cho m\u1ed9t s\u1ed1 \u0111\u01b0\u1eddng \u0111i nh\u1ecf t\u00f9y \u00fd, ho\u1eb7c n\u00f3i c\u00e1ch kh\u00e1c l\u00e0 \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t kh\u00f4ng x\u00e1c \u0111\u1ecbnh. \u0110i\u1ec1u \u0111\u00f3 t\u1ef1 \u0111\u1ed9ng c\u00f3 ngh\u0129a l\u00e0 m\u1ed9t \u0111\u1ed3 th\u1ecb v\u00f4 h\u01b0\u1edbng kh\u00f4ng th\u1ec3 c\u00f3 b\u1ea5t k\u1ef3 c\u1ea1nh tr\u1ecdng s\u1ed1 \u00e2m n\u00e0o, v\u00ec m\u1ed9t c\u1ea1nh nh\u01b0 v\u1eady \u0111\u00e3 t\u1ea1o th\u00e0nh m\u1ed9t chu tr\u00ecnh \u00e2m v\u00ec b\u1ea1n c\u00f3 th\u1ec3 di chuy\u1ec3n qua l\u1ea1i d\u1ecdc theo c\u1ea1nh \u0111\u00f3 bao l\u00e2u t\u00f9y th\u00edch.</p> <p>Thu\u1eadt to\u00e1n n\u00e0y c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 ph\u00e1t hi\u1ec7n s\u1ef1 hi\u1ec7n di\u1ec7n c\u1ee7a c\u00e1c chu tr\u00ecnh \u00e2m. \u0110\u1ed3 th\u1ecb c\u00f3 m\u1ed9t chu tr\u00ecnh \u00e2m n\u1ebfu \u1edf cu\u1ed1i thu\u1eadt to\u00e1n, kho\u1ea3ng c\u00e1ch t\u1eeb m\u1ed9t \u0111\u1ec9nh $v$ \u0111\u1ebfn ch\u00ednh n\u00f3 l\u00e0 \u00e2m.</p> <p>Thu\u1eadt to\u00e1n n\u00e0y \u0111\u00e3 \u0111\u01b0\u1ee3c c\u00f4ng b\u1ed1 \u0111\u1ed3ng th\u1eddi trong c\u00e1c b\u00e0i b\u00e1o c\u1ee7a Robert Floyd v\u00e0 Stephen Warshall v\u00e0o n\u0103m 1962. Tuy nhi\u00ean, v\u00e0o n\u0103m 1959, Bernard Roy \u0111\u00e3 c\u00f4ng b\u1ed1 v\u1ec1 c\u01a1 b\u1ea3n c\u00f9ng m\u1ed9t thu\u1eadt to\u00e1n, nh\u01b0ng \u1ea5n ph\u1ea9m c\u1ee7a \u00f4ng \u0111\u00e3 kh\u00f4ng \u0111\u01b0\u1ee3c ch\u00fa \u00fd.</p>","tags":["Translated"]},{"location":"graph/all-pair-shortest-path-floyd-warshall.html#description-of-the-algorithm","title":"M\u00f4 t\u1ea3 thu\u1eadt to\u00e1n (Description of the algorithm)","text":"<p>\u00dd t\u01b0\u1edfng ch\u00ednh c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 chia qu\u00e1 tr\u00ecnh t\u00ecm \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t gi\u1eefa b\u1ea5t k\u1ef3 hai \u0111\u1ec9nh n\u00e0o th\u00e0nh nhi\u1ec1u pha t\u0103ng d\u1ea7n.</p> <p>H\u00e3y \u0111\u00e1nh s\u1ed1 c\u00e1c \u0111\u1ec9nh b\u1eaft \u0111\u1ea7u t\u1eeb 1 \u0111\u1ebfn $n$. Ma tr\u1eadn kho\u1ea3ng c\u00e1ch l\u00e0 $d[ ][ ]$.</p> <p>Tr\u01b0\u1edbc pha th\u1ee9 $k$ ($k = 1 \\dots n$), $d[i][j]$ cho b\u1ea5t k\u1ef3 \u0111\u1ec9nh $i$ v\u00e0 $j$ n\u00e0o l\u01b0u tr\u1eef \u0111\u1ed9 d\u00e0i c\u1ee7a \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t gi\u1eefa \u0111\u1ec9nh $i$ v\u00e0 \u0111\u1ec9nh $j$, ch\u1ec9 ch\u1ee9a c\u00e1c \u0111\u1ec9nh $\\{1, 2, ..., k-1\\}$ l\u00e0m \u0111\u1ec9nh trung gian (internal vertices) trong \u0111\u01b0\u1eddng \u0111i.</p> <p>N\u00f3i c\u00e1ch kh\u00e1c, tr\u01b0\u1edbc pha th\u1ee9 $k$, gi\u00e1 tr\u1ecb c\u1ee7a $d[i][j]$ b\u1eb1ng \u0111\u1ed9 d\u00e0i c\u1ee7a \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t t\u1eeb \u0111\u1ec9nh $i$ \u0111\u1ebfn \u0111\u1ec9nh $j$, n\u1ebfu \u0111\u01b0\u1eddng \u0111i n\u00e0y ch\u1ec9 \u0111\u01b0\u1ee3c ph\u00e9p \u0111i v\u00e0o \u0111\u1ec9nh c\u00f3 s\u1ed1 nh\u1ecf h\u01a1n $k$ (\u0111\u1ea7u v\u00e0 cu\u1ed1i c\u1ee7a \u0111\u01b0\u1eddng \u0111i kh\u00f4ng b\u1ecb h\u1ea1n ch\u1ebf b\u1edfi thu\u1ed9c t\u00ednh n\u00e0y).</p> <p>D\u1ec5 d\u00e0ng \u0111\u1ea3m b\u1ea3o r\u1eb1ng thu\u1ed9c t\u00ednh n\u00e0y gi\u1eef cho pha \u0111\u1ea7u ti\u00ean. V\u1edbi $k = 0$, ch\u00fang ta c\u00f3 th\u1ec3 \u0111i\u1ec1n v\u00e0o ma tr\u1eadn v\u1edbi $d[i][j] = w_{i j}$ n\u1ebfu t\u1ed3n t\u1ea1i m\u1ed9t c\u1ea1nh gi\u1eefa $i$ v\u00e0 $j$ v\u1edbi tr\u1ecdng s\u1ed1 $w_{i j}$ v\u00e0 $d[i][j] = \\infty$ n\u1ebfu kh\u00f4ng t\u1ed3n t\u1ea1i c\u1ea1nh. Tr\u00ean th\u1ef1c t\u1ebf $\\infty$ s\u1ebd l\u00e0 m\u1ed9t gi\u00e1 tr\u1ecb l\u1edbn n\u00e0o \u0111\u00f3. Nh\u01b0 ch\u00fang ta s\u1ebd th\u1ea5y sau n\u00e0y, \u0111\u00e2y l\u00e0 m\u1ed9t y\u00eau c\u1ea7u cho thu\u1eadt to\u00e1n.</p> <p>Gi\u1ea3 s\u1eed b\u00e2y gi\u1edd ch\u00fang ta \u0111ang \u1edf pha th\u1ee9 $k$, v\u00e0 ch\u00fang ta mu\u1ed1n t\u00ednh to\u00e1n ma tr\u1eadn $d[ ][ ]$ \u0111\u1ec3 n\u00f3 \u0111\u00e1p \u1ee9ng c\u00e1c y\u00eau c\u1ea7u cho pha th\u1ee9 $(k + 1)$. Ch\u00fang ta ph\u1ea3i s\u1eeda kho\u1ea3ng c\u00e1ch cho m\u1ed9t s\u1ed1 c\u1eb7p \u0111\u1ec9nh $(i, j)$. C\u00f3 hai tr\u01b0\u1eddng h\u1ee3p kh\u00e1c nhau v\u1ec1 c\u01a1 b\u1ea3n:</p> <ul> <li> <p>\u0110\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t t\u1eeb \u0111\u1ec9nh $i$ \u0111\u1ebfn \u0111\u1ec9nh $j$ v\u1edbi c\u00e1c \u0111\u1ec9nh trung gian t\u1eeb t\u1eadp h\u1ee3p $\\{1, 2, \\dots, k\\}$ tr\u00f9ng v\u1edbi \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t v\u1edbi c\u00e1c \u0111\u1ec9nh trung gian t\u1eeb t\u1eadp h\u1ee3p $\\{1, 2, \\dots, k-1\\}$.</p> <p>Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, $d[i][j]$ s\u1ebd kh\u00f4ng thay \u0111\u1ed5i trong qu\u00e1 tr\u00ecnh chuy\u1ec3n \u0111\u1ed5i.</p> </li> <li> <p>\u0110\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t v\u1edbi c\u00e1c \u0111\u1ec9nh trung gian t\u1eeb $\\{1, 2, \\dots, k\\}$ ng\u1eafn h\u01a1n.</p> <p>\u0110i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 \u0111\u01b0\u1eddng \u0111i m\u1edbi, ng\u1eafn h\u01a1n \u0111i qua \u0111\u1ec9nh $k$. \u0110i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 ch\u00fang ta c\u00f3 th\u1ec3 chia \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t gi\u1eefa $i$ v\u00e0 $j$ th\u00e0nh hai \u0111\u01b0\u1eddng \u0111i: \u0111\u01b0\u1eddng \u0111i gi\u1eefa $i$ v\u00e0 $k$, v\u00e0 \u0111\u01b0\u1eddng \u0111i gi\u1eefa $k$ v\u00e0 $j$. R\u00f5 r\u00e0ng l\u00e0 c\u1ea3 hai \u0111\u01b0\u1eddng \u0111i n\u00e0y ch\u1ec9 s\u1eed d\u1ee5ng c\u00e1c \u0111\u1ec9nh trung gian c\u1ee7a $\\{1, 2, \\dots, k-1\\}$ v\u00e0 l\u00e0 nh\u1eefng \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t nh\u01b0 v\u1eady trong kh\u00eda c\u1ea1nh \u0111\u00f3. Do \u0111\u00f3, ch\u00fang ta \u0111\u00e3 t\u00ednh to\u00e1n \u0111\u1ed9 d\u00e0i c\u1ee7a c\u00e1c \u0111\u01b0\u1eddng \u0111i \u0111\u00f3 tr\u01b0\u1edbc \u0111\u00f3, v\u00e0 ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh to\u00e1n \u0111\u1ed9 d\u00e0i c\u1ee7a \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t gi\u1eefa $i$ v\u00e0 $j$ l\u00e0 $d[i][k] + d[k][j]$.</p> </li> </ul> <p>K\u1ebft h\u1ee3p hai tr\u01b0\u1eddng h\u1ee3p n\u00e0y, ch\u00fang ta th\u1ea5y r\u1eb1ng ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh to\u00e1n l\u1ea1i \u0111\u1ed9 d\u00e0i c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c c\u1eb7p $(i, j)$ trong pha th\u1ee9 $k$ theo c\u00e1ch sau:</p> $$d_{\\text{new}}[i][j] = min(d[i][j], d[i][k] + d[k][j])$$ <p>Do \u0111\u00f3, t\u1ea5t c\u1ea3 c\u00f4ng vi\u1ec7c c\u1ea7n thi\u1ebft trong pha th\u1ee9 $k$ l\u00e0 l\u1eb7p qua t\u1ea5t c\u1ea3 c\u00e1c c\u1eb7p \u0111\u1ec9nh v\u00e0 t\u00ednh to\u00e1n l\u1ea1i \u0111\u1ed9 d\u00e0i c\u1ee7a \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t gi\u1eefa ch\u00fang. K\u1ebft qu\u1ea3 l\u00e0, sau pha th\u1ee9 $n$, gi\u00e1 tr\u1ecb $d[i][j]$ trong ma tr\u1eadn kho\u1ea3ng c\u00e1ch l\u00e0 \u0111\u1ed9 d\u00e0i c\u1ee7a \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t gi\u1eefa $i$ v\u00e0 $j$, ho\u1eb7c l\u00e0 $\\infty$ n\u1ebfu \u0111\u01b0\u1eddng \u0111i gi\u1eefa c\u00e1c \u0111\u1ec9nh $i$ v\u00e0 $j$ kh\u00f4ng t\u1ed3n t\u1ea1i.</p> <p>M\u1ed9t nh\u1eadn x\u00e9t cu\u1ed1i c\u00f9ng - ch\u00fang ta kh\u00f4ng c\u1ea7n t\u1ea1o m\u1ed9t ma tr\u1eadn kho\u1ea3ng c\u00e1ch ri\u00eang bi\u1ec7t $d_{\\text{new}}[ ][ ]$ \u0111\u1ec3 l\u01b0u tr\u1eef t\u1ea1m th\u1eddi c\u00e1c \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t c\u1ee7a pha th\u1ee9 $k$, t\u1ee9c l\u00e0 t\u1ea5t c\u1ea3 c\u00e1c thay \u0111\u1ed5i c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n tr\u1ef1c ti\u1ebfp trong ma tr\u1eadn $d[ ][ ]$ \u1edf b\u1ea5t k\u1ef3 pha n\u00e0o. Th\u1ef1c t\u1ebf l\u00e0 \u1edf b\u1ea5t k\u1ef3 pha th\u1ee9 $k$ n\u00e0o, ch\u00fang ta t\u1ed1i \u0111a l\u00e0 c\u1ea3i thi\u1ec7n kho\u1ea3ng c\u00e1ch c\u1ee7a b\u1ea5t k\u1ef3 \u0111\u01b0\u1eddng \u0111i n\u00e0o trong ma tr\u1eadn kho\u1ea3ng c\u00e1ch, do \u0111\u00f3 ch\u00fang ta kh\u00f4ng th\u1ec3 l\u00e0m x\u1ea5u \u0111i \u0111\u1ed9 d\u00e0i c\u1ee7a \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t cho b\u1ea5t k\u1ef3 c\u1eb7p \u0111\u1ec9nh n\u00e0o s\u1ebd \u0111\u01b0\u1ee3c x\u1eed l\u00fd trong pha th\u1ee9 $(k+1)$ ho\u1eb7c sau \u0111\u00f3.</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian c\u1ee7a thu\u1eadt to\u00e1n n\u00e0y r\u00f5 r\u00e0ng l\u00e0 $O(n^3)$.</p>","tags":["Translated"]},{"location":"graph/all-pair-shortest-path-floyd-warshall.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>G\u1ecdi $d[][]$ l\u00e0 m\u1ed9t m\u1ea3ng 2D k\u00edch th\u01b0\u1edbc $n \\times n$, \u0111\u01b0\u1ee3c \u0111i\u1ec1n theo pha th\u1ee9 0 nh\u01b0 gi\u1ea3i th\u00edch tr\u01b0\u1edbc \u0111\u00f3. Ngo\u00e0i ra, ch\u00fang ta s\u1ebd \u0111\u1eb7t $d[i][i] = 0$ cho b\u1ea5t k\u1ef3 $i$ n\u00e0o \u1edf pha th\u1ee9 0.</p> <p>Sau \u0111\u00f3 thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c c\u00e0i \u0111\u1eb7t nh\u01b0 sau:</p> <pre><code>for (int k = 0; k &lt; n; ++k) {\n    for (int i = 0; i &lt; n; ++i) {\n        for (int j = 0; j &lt; n; ++j) {\n            d[i][j] = min(d[i][j], d[i][k] + d[k][j]); \n        }\n    }\n}\n</code></pre> <p>Ng\u01b0\u1eddi ta gi\u1ea3 \u0111\u1ecbnh r\u1eb1ng n\u1ebfu kh\u00f4ng c\u00f3 c\u1ea1nh gi\u1eefa b\u1ea5t k\u1ef3 hai \u0111\u1ec9nh $i$ v\u00e0 $j$ n\u00e0o, th\u00ec ma tr\u1eadn t\u1ea1i $d[i][j]$ ch\u1ee9a m\u1ed9t s\u1ed1 l\u1edbn (\u0111\u1ee7 l\u1edbn \u0111\u1ec3 n\u00f3 l\u1edbn h\u01a1n \u0111\u1ed9 d\u00e0i c\u1ee7a b\u1ea5t k\u1ef3 \u0111\u01b0\u1eddng \u0111i n\u00e0o trong \u0111\u1ed3 th\u1ecb n\u00e0y). Khi \u0111\u00f3 c\u1ea1nh n\u00e0y s\u1ebd lu\u00f4n kh\u00f4ng c\u00f3 l\u1ee3i \u0111\u1ec3 \u0111i, v\u00e0 thu\u1eadt to\u00e1n s\u1ebd ho\u1ea1t \u0111\u1ed9ng ch\u00ednh x\u00e1c.</p> <p>Tuy nhi\u00ean, n\u1ebfu c\u00f3 c\u00e1c c\u1ea1nh tr\u1ecdng s\u1ed1 \u00e2m trong \u0111\u1ed3 th\u1ecb, c\u00e1c bi\u1ec7n ph\u00e1p \u0111\u1eb7c bi\u1ec7t ph\u1ea3i \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n. N\u1ebfu kh\u00f4ng, c\u00e1c gi\u00e1 tr\u1ecb k\u1ebft qu\u1ea3 trong ma tr\u1eadn c\u00f3 th\u1ec3 c\u00f3 d\u1ea1ng $\\infty - 1$,  $\\infty - 2$, v.v., t\u1ea5t nhi\u00ean, v\u1eabn ch\u1ec9 ra r\u1eb1ng gi\u1eefa c\u00e1c \u0111\u1ec9nh t\u01b0\u01a1ng \u1ee9ng kh\u00f4ng t\u1ed3n t\u1ea1i m\u1ed9t \u0111\u01b0\u1eddng \u0111i. Do \u0111\u00f3, n\u1ebfu \u0111\u1ed3 th\u1ecb c\u00f3 c\u00e1c c\u1ea1nh tr\u1ecdng s\u1ed1 \u00e2m, t\u1ed1t h\u01a1n l\u00e0 vi\u1ebft thu\u1eadt to\u00e1n Floyd-Warshall theo c\u00e1ch sau, \u0111\u1ec3 n\u00f3 kh\u00f4ng th\u1ef1c hi\u1ec7n c\u00e1c chuy\u1ec3n \u0111\u1ed5i b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng c\u00e1c \u0111\u01b0\u1eddng \u0111i kh\u00f4ng t\u1ed3n t\u1ea1i.</p> <pre><code>for (int k = 0; k &lt; n; ++k) {\n    for (int i = 0; i &lt; n; ++i) {\n        for (int j = 0; j &lt; n; ++j) {\n            if (d[i][k] &lt; INF &amp;&amp; d[k][j] &lt; INF)\n                d[i][j] = min(d[i][j], d[i][k] + d[k][j]); \n        }\n    }\n}\n</code></pre>","tags":["Translated"]},{"location":"graph/all-pair-shortest-path-floyd-warshall.html#retrieving-sequence","title":"Kh\u00f4i ph\u1ee5c chu\u1ed7i c\u00e1c \u0111\u1ec9nh trong \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t (Retrieving the sequence of vertices in the shortest path)","text":"<p>D\u1ec5 d\u00e0ng duy tr\u00ec th\u00f4ng tin b\u1ed5 sung m\u00e0 v\u1edbi n\u00f3 s\u1ebd c\u00f3 th\u1ec3 truy xu\u1ea5t \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t gi\u1eefa b\u1ea5t k\u1ef3 hai \u0111\u1ec9nh n\u00e0o \u0111\u01b0\u1ee3c \u0111\u01b0a ra d\u01b0\u1edbi d\u1ea1ng m\u1ed9t chu\u1ed7i c\u00e1c \u0111\u1ec9nh.</p> <p>\u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y, ngo\u00e0i ma tr\u1eadn kho\u1ea3ng c\u00e1ch $d[ ][ ]$, m\u1ed9t ma tr\u1eadn t\u1ed5 ti\u00ean $p[ ][ ]$ ph\u1ea3i \u0111\u01b0\u1ee3c duy tr\u00ec, s\u1ebd ch\u1ee9a s\u1ed1 c\u1ee7a pha n\u01a1i kho\u1ea3ng c\u00e1ch ng\u1eafn nh\u1ea5t gi\u1eefa hai \u0111\u1ec9nh \u0111\u01b0\u1ee3c s\u1eeda \u0111\u1ed5i l\u1ea7n cu\u1ed1i. R\u00f5 r\u00e0ng l\u00e0 s\u1ed1 c\u1ee7a pha kh\u00f4ng l\u00e0 g\u00ec kh\u00e1c ngo\u00e0i m\u1ed9t \u0111\u1ec9nh \u1edf gi\u1eefa \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t mong mu\u1ed1n. B\u00e2y gi\u1edd ch\u00fang ta ch\u1ec9 c\u1ea7n t\u00ecm \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t gi\u1eefa c\u00e1c \u0111\u1ec9nh $i$ v\u00e0 $p[i][j]$, v\u00e0 gi\u1eefa $p[i][j]$ v\u00e0 $j$. \u0110i\u1ec1u n\u00e0y d\u1eabn \u0111\u1ebfn m\u1ed9t thu\u1eadt to\u00e1n t\u00e1i t\u1ea1o \u0111\u1ec7 quy \u0111\u01a1n gi\u1ea3n c\u1ee7a \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t.</p>","tags":["Translated"]},{"location":"graph/all-pair-shortest-path-floyd-warshall.html#case-of-real-weights","title":"Tr\u01b0\u1eddng h\u1ee3p tr\u1ecdng s\u1ed1 th\u1ef1c (The case of real weights)","text":"<p>N\u1ebfu tr\u1ecdng s\u1ed1 c\u1ee7a c\u00e1c c\u1ea1nh kh\u00f4ng ph\u1ea3i l\u00e0 s\u1ed1 nguy\u00ean m\u00e0 l\u00e0 s\u1ed1 th\u1ef1c, c\u1ea7n ph\u1ea3i t\u00ednh \u0111\u1ebfn c\u00e1c l\u1ed7i x\u1ea3y ra khi l\u00e0m vi\u1ec7c v\u1edbi c\u00e1c ki\u1ec3u float.</p> <p>Thu\u1eadt to\u00e1n Floyd-Warshall c\u00f3 m\u1ed9t hi\u1ec7u \u1ee9ng kh\u00f3 ch\u1ecbu, \u0111\u00f3 l\u00e0 c\u00e1c l\u1ed7i t\u00edch l\u0169y r\u1ea5t nhanh. Th\u1ef1c t\u1ebf l\u00e0 n\u1ebfu c\u00f3 m\u1ed9t l\u1ed7i trong pha \u0111\u1ea7u ti\u00ean c\u1ee7a $\\delta$, l\u1ed7i n\u00e0y c\u00f3 th\u1ec3 lan truy\u1ec1n sang l\u1ea7n l\u1eb7p th\u1ee9 hai l\u00e0 $2 \\delta$, sang l\u1ea7n l\u1eb7p th\u1ee9 ba l\u00e0 $4 \\delta$, v.v.</p> <p>\u0110\u1ec3 tr\u00e1nh \u0111i\u1ec1u n\u00e0y, thu\u1eadt to\u00e1n c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eeda \u0111\u1ed5i \u0111\u1ec3 t\u00ednh \u0111\u1ebfn l\u1ed7i (EPS = $\\delta$) b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng so s\u00e1nh sau:</p> <pre><code>if (d[i][k] + d[k][j] &lt; d[i][j] - EPS)\n    d[i][j] = d[i][k] + d[k][j]; \n</code></pre>","tags":["Translated"]},{"location":"graph/all-pair-shortest-path-floyd-warshall.html#case-of-negative-cycles","title":"Tr\u01b0\u1eddng h\u1ee3p chu tr\u00ecnh \u00e2m (The case of negative cycles)","text":"<p>V\u1ec1 m\u1eb7t h\u00ecnh th\u1ee9c, thu\u1eadt to\u00e1n Floyd-Warshall kh\u00f4ng \u00e1p d\u1ee5ng cho c\u00e1c \u0111\u1ed3 th\u1ecb ch\u1ee9a (c\u00e1c) chu tr\u00ecnh tr\u1ecdng s\u1ed1 \u00e2m. Nh\u01b0ng \u0111\u1ed1i v\u1edbi t\u1ea5t c\u1ea3 c\u00e1c c\u1eb7p \u0111\u1ec9nh $i$ v\u00e0 $j$ m\u00e0 kh\u00f4ng t\u1ed3n t\u1ea1i \u0111\u01b0\u1eddng \u0111i b\u1eaft \u0111\u1ea7u t\u1ea1i $i$, \u0111i qua m\u1ed9t chu tr\u00ecnh \u00e2m v\u00e0 k\u1ebft th\u00fac t\u1ea1i $j$, thu\u1eadt to\u00e1n v\u1eabn s\u1ebd ho\u1ea1t \u0111\u1ed9ng ch\u00ednh x\u00e1c.</p> <p>\u0110\u1ed1i v\u1edbi c\u1eb7p \u0111\u1ec9nh m\u00e0 c\u00e2u tr\u1ea3 l\u1eddi kh\u00f4ng t\u1ed3n t\u1ea1i (do s\u1ef1 hi\u1ec7n di\u1ec7n c\u1ee7a m\u1ed9t chu tr\u00ecnh \u00e2m trong \u0111\u01b0\u1eddng \u0111i gi\u1eefa ch\u00fang), thu\u1eadt to\u00e1n Floyd s\u1ebd l\u01b0u tr\u1eef b\u1ea5t k\u1ef3 s\u1ed1 n\u00e0o (c\u00f3 th\u1ec3 l\u00e0 \u00e2m r\u1ea5t l\u1edbn, nh\u01b0ng kh\u00f4ng nh\u1ea5t thi\u1ebft) trong ma tr\u1eadn kho\u1ea3ng c\u00e1ch. Tuy nhi\u00ean, c\u00f3 th\u1ec3 c\u1ea3i thi\u1ec7n thu\u1eadt to\u00e1n Floyd-Warshall, \u0111\u1ec3 n\u00f3 x\u1eed l\u00fd c\u1ea9n th\u1eadn c\u00e1c c\u1eb7p \u0111\u1ec9nh nh\u01b0 v\u1eady v\u00e0 xu\u1ea5t ch\u00fang, v\u00ed d\u1ee5 nh\u01b0 $-\\text{INF}$.</p> <p>\u0110i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n theo c\u00e1ch sau: h\u00e3y ch\u1ea1y thu\u1eadt to\u00e1n Floyd-Warshall th\u00f4ng th\u01b0\u1eddng cho m\u1ed9t \u0111\u1ed3 th\u1ecb nh\u1ea5t \u0111\u1ecbnh. Khi \u0111\u00f3 m\u1ed9t \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t gi\u1eefa c\u00e1c \u0111\u1ec9nh $i$ v\u00e0 $j$ kh\u00f4ng t\u1ed3n t\u1ea1i, khi v\u00e0 ch\u1ec9 khi, c\u00f3 m\u1ed9t \u0111\u1ec9nh $t$ sao cho, $t$ c\u00f3 th\u1ec3 ti\u1ebfp c\u1eadn t\u1eeb $i$ v\u00e0 $j$ c\u00f3 th\u1ec3 ti\u1ebfp c\u1eadn t\u1eeb $t$, m\u00e0 $d[t][t] &lt; 0$.</p> <p>Ngo\u00e0i ra, khi s\u1eed d\u1ee5ng thu\u1eadt to\u00e1n Floyd-Warshall cho c\u00e1c \u0111\u1ed3 th\u1ecb c\u00f3 chu tr\u00ecnh \u00e2m, ch\u00fang ta n\u00ean nh\u1edb r\u1eb1ng c\u00e1c t\u00ecnh hu\u1ed1ng c\u00f3 th\u1ec3 ph\u00e1t sinh trong \u0111\u00f3 kho\u1ea3ng c\u00e1ch c\u00f3 th\u1ec3 \u0111i v\u00e0o s\u1ed1 \u00e2m nhanh theo c\u1ea5p s\u1ed1 nh\u00e2n. Do \u0111\u00f3, tr\u00e0n s\u1ed1 nguy\u00ean ph\u1ea3i \u0111\u01b0\u1ee3c x\u1eed l\u00fd b\u1eb1ng c\u00e1ch gi\u1edbi h\u1ea1n kho\u1ea3ng c\u00e1ch t\u1ed1i thi\u1ec3u b\u1eb1ng m\u1ed9t gi\u00e1 tr\u1ecb n\u00e0o \u0111\u00f3 (v\u00ed d\u1ee5: $-\\text{INF}$).</p> <p>\u0110\u1ec3 t\u00ecm hi\u1ec3u th\u00eam v\u1ec1 vi\u1ec7c t\u00ecm c\u00e1c chu tr\u00ecnh \u00e2m trong \u0111\u1ed3 th\u1ecb, xem b\u00e0i vi\u1ebft ri\u00eang T\u00ecm chu tr\u00ecnh \u00e2m trong \u0111\u1ed3 th\u1ecb.</p>","tags":["Translated"]},{"location":"graph/all-pair-shortest-path-floyd-warshall.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>UVA: Page Hopping</li> <li>SPOJ: Possible Friends</li> <li>CODEFORCES: Greg and Graph</li> <li>SPOJ: CHICAGO - 106 miles to Chicago</li> <li>UVA 10724 - Road Construction</li> <li>UVA  117 - The Postal Worker Rings Once</li> <li>Codeforces - Traveling Graph</li> <li>UVA - 1198 - The Geodetic Set Problem</li> <li>UVA - 10048 - Audiophobia</li> <li>UVA - 125 - Numbering Paths</li> <li>LOJ - Travel Company</li> <li>UVA 423 - MPI Maelstrom</li> <li>UVA 1416 - Warfare And Logistics</li> <li>UVA 1233 - USHER</li> <li>UVA 10793 - The Orc Attack</li> <li>UVA 10099 The Tourist Guide</li> <li>UVA 869 - Airline Comparison</li> <li>UVA 13211 - Geonosis</li> <li>SPOJ - Defend the Rohan</li> <li>Codeforces - Roads in Berland</li> <li>Codeforces - String Problem</li> <li>GYM - Manic Moving (C)</li> <li>SPOJ - Arbitrage</li> <li>UVA - 12179 - Randomly-priced Tickets</li> <li>LOJ - 1086 - Jogging Trails</li> <li>SPOJ - Ingredients</li> <li>CSES - Shortest Routes II</li> </ul>","tags":["Translated"]},{"location":"graph/bellman_ford.html","title":"Thu\u1eadt to\u00e1n Bellman-Ford (Bellman-Ford Algorithm)","text":"<p>\u0110\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t t\u1eeb m\u1ed9t ngu\u1ed3n \u0111\u01a1n v\u1edbi c\u00e1c c\u1ea1nh c\u00f3 tr\u1ecdng s\u1ed1 \u00e2m</p> <p>Gi\u1ea3 s\u1eed r\u1eb1ng ch\u00fang ta \u0111\u01b0\u1ee3c cho m\u1ed9t \u0111\u1ed3 th\u1ecb c\u00f3 h\u01b0\u1edbng c\u00f3 tr\u1ecdng s\u1ed1 $G$ v\u1edbi $n$ \u0111\u1ec9nh v\u00e0 $m$ c\u1ea1nh, v\u00e0 m\u1ed9t \u0111\u1ec9nh $v$ \u0111\u01b0\u1ee3c ch\u1ec9 \u0111\u1ecbnh. B\u1ea1n mu\u1ed1n t\u00ecm \u0111\u1ed9 d\u00e0i c\u1ee7a c\u00e1c \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t t\u1eeb \u0111\u1ec9nh $v$ \u0111\u1ebfn m\u1ecdi \u0111\u1ec9nh kh\u00e1c.</p> <p>Kh\u00f4ng gi\u1ed1ng nh\u01b0 thu\u1eadt to\u00e1n Dijkstra, thu\u1eadt to\u00e1n n\u00e0y c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c \u00e1p d\u1ee5ng cho c\u00e1c \u0111\u1ed3 th\u1ecb ch\u1ee9a c\u00e1c c\u1ea1nh c\u00f3 tr\u1ecdng s\u1ed1 \u00e2m. Tuy nhi\u00ean, n\u1ebfu \u0111\u1ed3 th\u1ecb ch\u1ee9a m\u1ed9t chu tr\u00ecnh \u00e2m, th\u00ec r\u00f5 r\u00e0ng, \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t \u0111\u1ebfn m\u1ed9t s\u1ed1 \u0111\u1ec9nh c\u00f3 th\u1ec3 kh\u00f4ng t\u1ed3n t\u1ea1i (do th\u1ef1c t\u1ebf l\u00e0 tr\u1ecdng s\u1ed1 c\u1ee7a \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t ph\u1ea3i b\u1eb1ng \u00e2m v\u00f4 c\u00f9ng); tuy nhi\u00ean, thu\u1eadt to\u00e1n n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eeda \u0111\u1ed5i \u0111\u1ec3 b\u00e1o hi\u1ec7u s\u1ef1 hi\u1ec7n di\u1ec7n c\u1ee7a m\u1ed9t chu tr\u00ecnh c\u00f3 tr\u1ecdng s\u1ed1 \u00e2m, ho\u1eb7c th\u1eadm ch\u00ed suy ra chu tr\u00ecnh n\u00e0y.</p> <p>Thu\u1eadt to\u00e1n mang t\u00ean c\u1ee7a hai nh\u00e0 khoa h\u1ecdc ng\u01b0\u1eddi M\u1ef9: Richard Bellman v\u00e0 Lester Ford. Ford th\u1ef1c s\u1ef1 \u0111\u00e3 ph\u00e1t minh ra thu\u1eadt to\u00e1n n\u00e0y v\u00e0o n\u0103m 1956 trong qu\u00e1 tr\u00ecnh nghi\u00ean c\u1ee9u m\u1ed9t b\u00e0i to\u00e1n to\u00e1n h\u1ecdc kh\u00e1c, cu\u1ed1i c\u00f9ng quy v\u1ec1 m\u1ed9t b\u00e0i to\u00e1n con c\u1ee7a vi\u1ec7c t\u00ecm \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t trong \u0111\u1ed3 th\u1ecb, v\u00e0 Ford \u0111\u00e3 \u0111\u01b0a ra m\u1ed9t ph\u00e1c th\u1ea3o c\u1ee7a thu\u1eadt to\u00e1n \u0111\u1ec3 gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 n\u00e0y. Bellman v\u00e0o n\u0103m 1958 \u0111\u00e3 xu\u1ea5t b\u1ea3n m\u1ed9t b\u00e0i b\u00e1o d\u00e0nh ri\u00eang cho b\u00e0i to\u00e1n t\u00ecm \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t, v\u00e0 trong b\u00e0i b\u00e1o n\u00e0y, \u00f4ng \u0111\u00e3 tr\u00ecnh b\u00e0y r\u00f5 r\u00e0ng thu\u1eadt to\u00e1n d\u01b0\u1edbi d\u1ea1ng m\u00e0 n\u00f3 \u0111\u01b0\u1ee3c bi\u1ebft \u0111\u1ebfn v\u1edbi ch\u00fang ta hi\u1ec7n nay.</p>","tags":["Translated"]},{"location":"graph/bellman_ford.html#description-of-the-algorithm","title":"M\u00f4 t\u1ea3 thu\u1eadt to\u00e1n (Description of the algorithm)","text":"<p>H\u00e3y gi\u1ea3 s\u1eed r\u1eb1ng \u0111\u1ed3 th\u1ecb kh\u00f4ng ch\u1ee9a chu tr\u00ecnh tr\u1ecdng s\u1ed1 \u00e2m. Tr\u01b0\u1eddng h\u1ee3p c\u00f3 s\u1ef1 hi\u1ec7n di\u1ec7n c\u1ee7a chu tr\u00ecnh tr\u1ecdng s\u1ed1 \u00e2m s\u1ebd \u0111\u01b0\u1ee3c th\u1ea3o lu\u1eadn b\u00ean d\u01b0\u1edbi trong m\u1ed9t ph\u1ea7n ri\u00eang bi\u1ec7t.</p> <p>Ch\u00fang ta s\u1ebd t\u1ea1o m\u1ed9t m\u1ea3ng kho\u1ea3ng c\u00e1ch $d[0 \\ldots n-1]$, sau khi th\u1ef1c hi\u1ec7n thu\u1eadt to\u00e1n s\u1ebd ch\u1ee9a c\u00e2u tr\u1ea3 l\u1eddi cho b\u00e0i to\u00e1n. Ban \u0111\u1ea7u, ch\u00fang ta \u0111i\u1ec1n n\u00f3 nh\u01b0 sau: $d[v] = 0$, v\u00e0 t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed $d[ ]$ kh\u00e1c b\u1eb1ng v\u00f4 c\u00f9ng $\\infty$.</p> <p>Thu\u1eadt to\u00e1n bao g\u1ed3m nhi\u1ec1u pha. M\u1ed7i pha qu\u00e9t qua t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh c\u1ee7a \u0111\u1ed3 th\u1ecb, v\u00e0 thu\u1eadt to\u00e1n c\u1ed1 g\u1eafng th\u1ef1c hi\u1ec7n n\u1edbi l\u1ecfng (relaxation) d\u1ecdc theo m\u1ed7i c\u1ea1nh $(a,b)$ c\u00f3 tr\u1ecdng s\u1ed1 $c$. N\u1edbi l\u1ecfng d\u1ecdc theo c\u00e1c c\u1ea1nh l\u00e0 m\u1ed9t n\u1ed7 l\u1ef1c \u0111\u1ec3 c\u1ea3i thi\u1ec7n gi\u00e1 tr\u1ecb $d[b]$ b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng gi\u00e1 tr\u1ecb $d[a] + c$. Tr\u00ean th\u1ef1c t\u1ebf, \u0111i\u1ec1u \u0111\u00f3 c\u00f3 ngh\u0129a l\u00e0 ch\u00fang ta \u0111ang c\u1ed1 g\u1eafng c\u1ea3i thi\u1ec7n c\u00e2u tr\u1ea3 l\u1eddi cho \u0111\u1ec9nh n\u00e0y b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng c\u1ea1nh $(a,b)$ v\u00e0 c\u00e2u tr\u1ea3 l\u1eddi hi\u1ec7n t\u1ea1i cho \u0111\u1ec9nh $a$.</p> <p>Ng\u01b0\u1eddi ta kh\u1eb3ng \u0111\u1ecbnh r\u1eb1ng $n-1$ pha c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \u0111\u1ee7 \u0111\u1ec3 t\u00ednh to\u00e1n ch\u00ednh x\u00e1c \u0111\u1ed9 d\u00e0i c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t trong \u0111\u1ed3 th\u1ecb (m\u1ed9t l\u1ea7n n\u1eefa, ch\u00fang t\u00f4i tin r\u1eb1ng c\u00e1c chu tr\u00ecnh tr\u1ecdng s\u1ed1 \u00e2m kh\u00f4ng t\u1ed3n t\u1ea1i). \u0110\u1ed1i v\u1edbi c\u00e1c \u0111\u1ec9nh kh\u00f4ng th\u1ec3 ti\u1ebfp c\u1eadn, kho\u1ea3ng c\u00e1ch $d[ ]$ s\u1ebd v\u1eabn b\u1eb1ng v\u00f4 c\u00f9ng $\\infty$.</p>","tags":["Translated"]},{"location":"graph/bellman_ford.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>Kh\u00f4ng gi\u1ed1ng nh\u01b0 nhi\u1ec1u thu\u1eadt to\u00e1n \u0111\u1ed3 th\u1ecb kh\u00e1c, \u0111\u1ed1i v\u1edbi thu\u1eadt to\u00e1n Bellman-Ford, thu\u1eadn ti\u1ec7n h\u01a1n khi bi\u1ec3u di\u1ec5n \u0111\u1ed3 th\u1ecb b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng m\u1ed9t danh s\u00e1ch duy nh\u1ea5t c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh (thay v\u00ec $n$ danh s\u00e1ch c\u00e1c c\u1ea1nh - c\u00e1c c\u1ea1nh t\u1eeb m\u1ed7i \u0111\u1ec9nh). Ch\u00fang ta b\u1eaft \u0111\u1ea7u vi\u1ec7c c\u00e0i \u0111\u1eb7t v\u1edbi m\u1ed9t c\u1ea5u tr\u00fac $\\rm edge$ \u0111\u1ec3 bi\u1ec3u di\u1ec5n c\u00e1c c\u1ea1nh. \u0110\u1ea7u v\u00e0o cho thu\u1eadt to\u00e1n l\u00e0 c\u00e1c s\u1ed1 $n$, $m$, danh s\u00e1ch $e$ c\u00e1c c\u1ea1nh v\u00e0 \u0111\u1ec9nh b\u1eaft \u0111\u1ea7u $v$. T\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh \u0111\u01b0\u1ee3c \u0111\u00e1nh s\u1ed1 t\u1eeb $0$ \u0111\u1ebfn $n - 1$.</p>","tags":["Translated"]},{"location":"graph/bellman_ford.html#cai-at-on-gian-nhat","title":"C\u00e0i \u0111\u1eb7t \u0111\u01a1n gi\u1ea3n nh\u1ea5t","text":"<p>H\u1eb1ng s\u1ed1 $\\rm INF$ bi\u1ec3u th\u1ecb s\u1ed1 \"v\u00f4 c\u00f9ng\" \u2014 n\u00f3 n\u00ean \u0111\u01b0\u1ee3c ch\u1ecdn sao cho n\u00f3 l\u1edbn h\u01a1n t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ed9 d\u00e0i \u0111\u01b0\u1eddng \u0111i c\u00f3 th\u1ec3.</p> <pre><code>struct Edge {\n    int a, b, cost;\n};\n\nint n, m, v;\nvector&lt;Edge&gt; edges;\nconst int INF = 1000000000;\n\nvoid solve()\n{\n    vector&lt;int&gt; d(n, INF);\n    d[v] = 0;\n    for (int i = 0; i &lt; n - 1; ++i)\n        for (Edge e : edges)\n            if (d[e.a] &lt; INF)\n                d[e.b] = min(d[e.b], d[e.a] + e.cost);\n    // hi\u1ec3n th\u1ecb d, v\u00ed d\u1ee5, tr\u00ean m\u00e0n h\u00ecnh\n}\n</code></pre> <p>Vi\u1ec7c ki\u1ec3m tra <code>if (d[e.a] &lt; INF)</code> ch\u1ec9 c\u1ea7n thi\u1ebft n\u1ebfu \u0111\u1ed3 th\u1ecb ch\u1ee9a c\u00e1c c\u1ea1nh tr\u1ecdng s\u1ed1 \u00e2m: n\u1ebfu kh\u00f4ng c\u00f3 x\u00e1c minh nh\u01b0 v\u1eady s\u1ebd d\u1eabn \u0111\u1ebfn vi\u1ec7c n\u1edbi l\u1ecfng t\u1eeb c\u00e1c \u0111\u1ec9nh m\u00e0 \u0111\u01b0\u1eddng \u0111i ch\u01b0a \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y, v\u00e0 kho\u1ea3ng c\u00e1ch kh\u00f4ng ch\u00ednh x\u00e1c, ki\u1ec3u nh\u01b0 $\\infty - 1$, $\\infty - 2$ v.v. s\u1ebd xu\u1ea5t hi\u1ec7n.</p>","tags":["Translated"]},{"location":"graph/bellman_ford.html#mot-cai-at-tot-hon","title":"M\u1ed9t c\u00e0i \u0111\u1eb7t t\u1ed1t h\u01a1n","text":"<p>Thu\u1eadt to\u00e1n n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u0103ng t\u1ed1c ph\u1ea7n n\u00e0o: th\u01b0\u1eddng th\u00ec ch\u00fang ta \u0111\u00e3 nh\u1eadn \u0111\u01b0\u1ee3c c\u00e2u tr\u1ea3 l\u1eddi trong m\u1ed9t v\u00e0i pha v\u00e0 kh\u00f4ng c\u00f3 c\u00f4ng vi\u1ec7c h\u1eefu \u00edch n\u00e0o \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong c\u00e1c pha c\u00f2n l\u1ea1i, ch\u1ec9 l\u00e3ng ph\u00ed khi gh\u00e9 th\u0103m t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh. V\u00ec v\u1eady, h\u00e3y gi\u1eef c\u1edd, \u0111\u1ec3 cho bi\u1ebft li\u1ec7u c\u00f3 g\u00ec thay \u0111\u1ed5i trong pha hi\u1ec7n t\u1ea1i hay kh\u00f4ng, v\u00e0 n\u1ebfu b\u1ea5t k\u1ef3 pha n\u00e0o, kh\u00f4ng c\u00f3 g\u00ec thay \u0111\u1ed5i, thu\u1eadt to\u00e1n c\u00f3 th\u1ec3 d\u1eebng l\u1ea1i. (T\u1ed1i \u01b0u h\u00f3a n\u00e0y kh\u00f4ng c\u1ea3i thi\u1ec7n h\u00e0nh vi ti\u1ec7m c\u1eadn, t\u1ee9c l\u00e0, m\u1ed9t s\u1ed1 \u0111\u1ed3 th\u1ecb v\u1eabn s\u1ebd c\u1ea7n t\u1ea5t c\u1ea3 $n-1$ pha, nh\u01b0ng t\u0103ng t\u1ed1c \u0111\u00e1ng k\u1ec3 h\u00e0nh vi c\u1ee7a thu\u1eadt to\u00e1n \"tr\u00ean trung b\u00ecnh\", t\u1ee9c l\u00e0, tr\u00ean c\u00e1c \u0111\u1ed3 th\u1ecb ng\u1eabu nhi\u00ean.)</p> <p>V\u1edbi t\u1ed1i \u01b0u h\u00f3a n\u00e0y, th\u01b0\u1eddng kh\u00f4ng c\u1ea7n thi\u1ebft ph\u1ea3i gi\u1edbi h\u1ea1n th\u1ee7 c\u00f4ng s\u1ed1 l\u01b0\u1ee3ng c\u00e1c pha c\u1ee7a thu\u1eadt to\u00e1n th\u00e0nh $n-1$ \u2014 thu\u1eadt to\u00e1n s\u1ebd d\u1eebng l\u1ea1i sau s\u1ed1 l\u01b0\u1ee3ng pha mong mu\u1ed1n.</p> <pre><code>void solve()\n{\n    vector&lt;int&gt; d(n, INF);\n    d[v] = 0;\n    for (;;) {\n        bool any = false;\n\n        for (Edge e : edges)\n            if (d[e.a] &lt; INF)\n                if (d[e.b] &gt; d[e.a] + e.cost) {\n                    d[e.b] = d[e.a] + e.cost;\n                    any = true;\n                }\n\n        if (!any)\n            break;\n    }\n    // hi\u1ec3n th\u1ecb d, v\u00ed d\u1ee5, tr\u00ean m\u00e0n h\u00ecnh\n}\n</code></pre>","tags":["Translated"]},{"location":"graph/bellman_ford.html#retrieving-path","title":"Kh\u00f4i ph\u1ee5c \u0111\u01b0\u1eddng \u0111i (Retrieving Path)","text":"<p>B\u00e2y gi\u1edd h\u00e3y xem x\u00e9t c\u00e1ch s\u1eeda \u0111\u1ed5i thu\u1eadt to\u00e1n \u0111\u1ec3 n\u00f3 kh\u00f4ng ch\u1ec9 t\u00ecm \u0111\u1ed9 d\u00e0i c\u1ee7a c\u00e1c \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t, m\u00e0 c\u00f2n cho ph\u00e9p kh\u00f4i ph\u1ee5c l\u1ea1i c\u00e1c \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t.</p> <p>\u0110\u1ec3 l\u00e0m \u0111i\u1ec1u \u0111\u00f3, h\u00e3y t\u1ea1o m\u1ed9t m\u1ea3ng kh\u00e1c $p[0 \\ldots n-1]$, trong \u0111\u00f3 \u0111\u1ed1i v\u1edbi m\u1ed7i \u0111\u1ec9nh ch\u00fang ta l\u01b0u tr\u1eef \"ti\u1ec1n b\u1ed1i\" (predecessor) c\u1ee7a n\u00f3, t\u1ee9c l\u00e0 \u0111\u1ec9nh \u00e1p ch\u00f3t trong \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t d\u1eabn \u0111\u1ebfn n\u00f3. Tr\u00ean th\u1ef1c t\u1ebf, \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t \u0111\u1ebfn b\u1ea5t k\u1ef3 \u0111\u1ec9nh $a$ n\u00e0o l\u00e0 \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t \u0111\u1ebfn m\u1ed9t \u0111\u1ec9nh $p[a]$ n\u00e0o \u0111\u00f3, m\u00e0 ch\u00fang ta \u0111\u00e3 th\u00eam $a$ v\u00e0o cu\u1ed1i \u0111\u01b0\u1eddng \u0111i.</p> <p>L\u01b0u \u00fd r\u1eb1ng thu\u1eadt to\u00e1n ho\u1ea1t \u0111\u1ed9ng tr\u00ean c\u00f9ng m\u1ed9t logic: n\u00f3 gi\u1ea3 \u0111\u1ecbnh r\u1eb1ng kho\u1ea3ng c\u00e1ch ng\u1eafn nh\u1ea5t \u0111\u1ebfn m\u1ed9t \u0111\u1ec9nh \u0111\u00e3 \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n, v\u00e0 c\u1ed1 g\u1eafng c\u1ea3i thi\u1ec7n kho\u1ea3ng c\u00e1ch ng\u1eafn nh\u1ea5t \u0111\u1ebfn c\u00e1c \u0111\u1ec9nh kh\u00e1c t\u1eeb \u0111\u1ec9nh \u0111\u00f3. Do \u0111\u00f3, t\u1ea1i th\u1eddi \u0111i\u1ec3m c\u1ea3i thi\u1ec7n, ch\u00fang ta ch\u1ec9 c\u1ea7n nh\u1edb $p[ ]$, t\u1ee9c l\u00e0, \u0111\u1ec9nh m\u00e0 t\u1eeb \u0111\u00f3 s\u1ef1 c\u1ea3i thi\u1ec7n n\u00e0y \u0111\u00e3 x\u1ea3y ra.</p> <p>Sau \u0111\u00e2y l\u00e0 m\u1ed9t c\u00e0i \u0111\u1eb7t c\u1ee7a Bellman-Ford v\u1edbi vi\u1ec7c truy xu\u1ea5t \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t \u0111\u1ebfn m\u1ed9t n\u00fat $t$ nh\u1ea5t \u0111\u1ecbnh:</p> <pre><code>void solve()\n{\n    vector&lt;int&gt; d(n, INF);\n    d[v] = 0;\n    vector&lt;int&gt; p(n, -1);\n\n    for (;;) {\n        bool any = false;\n        for (Edge e : edges)\n            if (d[e.a] &lt; INF)\n                if (d[e.b] &gt; d[e.a] + e.cost) {\n                    d[e.b] = d[e.a] + e.cost;\n                    p[e.b] = e.a;\n                    any = true;\n                }\n        if (!any)\n            break;\n    }\n\n    if (d[t] == INF)\n        cout &lt;&lt; \"No path from \" &lt;&lt; v &lt;&lt; \" to \" &lt;&lt; t &lt;&lt; \".\";\n    else {\n        vector&lt;int&gt; path;\n        for (int cur = t; cur != -1; cur = p[cur])\n            path.push_back(cur);\n        reverse(path.begin(), path.end());\n\n        cout &lt;&lt; \"Path from \" &lt;&lt; v &lt;&lt; \" to \" &lt;&lt; t &lt;&lt; \": \";\n        for (int u : path)\n            cout &lt;&lt; u &lt;&lt; ' ';\n    }\n}\n</code></pre> <p>\u1ede \u0111\u00e2y b\u1eaft \u0111\u1ea7u t\u1eeb \u0111\u1ec9nh $t$, ch\u00fang ta \u0111i qua c\u00e1c ti\u1ec1n b\u1ed1i cho \u0111\u1ebfn khi ch\u00fang ta \u0111\u1ebfn \u0111\u1ec9nh b\u1eaft \u0111\u1ea7u kh\u00f4ng c\u00f3 ti\u1ec1n b\u1ed1i, v\u00e0 l\u01b0u tr\u1eef t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh trong \u0111\u01b0\u1eddng \u0111i trong danh s\u00e1ch $\\rm path$. Danh s\u00e1ch n\u00e0y l\u00e0 m\u1ed9t \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t t\u1eeb $v$ \u0111\u1ebfn $t$, nh\u01b0ng theo th\u1ee9 t\u1ef1 ng\u01b0\u1ee3c l\u1ea1i, v\u00ec v\u1eady ch\u00fang ta g\u1ecdi h\u00e0m $\\rm reverse()$ tr\u00ean $\\rm path$ v\u00e0 sau \u0111\u00f3 xu\u1ea5t ra \u0111\u01b0\u1eddng \u0111i.</p>","tags":["Translated"]},{"location":"graph/bellman_ford.html#the-proof-of-the-algorithm","title":"Ch\u1ee9ng minh thu\u1eadt to\u00e1n (The proof of the algorithm)","text":"<p>\u0110\u1ea7u ti\u00ean, l\u01b0u \u00fd r\u1eb1ng \u0111\u1ed1i v\u1edbi t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh kh\u00f4ng th\u1ec3 ti\u1ebfp c\u1eadn $u$, thu\u1eadt to\u00e1n s\u1ebd ho\u1ea1t \u0111\u1ed9ng ch\u00ednh x\u00e1c, nh\u00e3n $d[u]$ s\u1ebd v\u1eabn b\u1eb1ng v\u00f4 c\u00f9ng (b\u1edfi v\u00ec thu\u1eadt to\u00e1n Bellman-Ford s\u1ebd t\u00ecm m\u1ed9t s\u1ed1 c\u00e1ch \u0111\u1ebfn t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh c\u00f3 th\u1ec3 truy c\u1eadp t\u1eeb \u0111\u1ec9nh b\u1eaft \u0111\u1ea7u $v$, v\u00e0 vi\u1ec7c n\u1edbi l\u1ecfng cho t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh c\u00f2n l\u1ea1i kh\u00e1c s\u1ebd kh\u00f4ng bao gi\u1edd x\u1ea3y ra).</p> <p>B\u00e2y gi\u1edd ch\u00fang ta h\u00e3y ch\u1ee9ng minh kh\u1eb3ng \u0111\u1ecbnh sau: Sau khi th\u1ef1c hi\u1ec7n pha th\u1ee9 $i$, thu\u1eadt to\u00e1n Bellman-Ford t\u00ecm ch\u00ednh x\u00e1c t\u1ea5t c\u1ea3 c\u00e1c \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t c\u00f3 s\u1ed1 l\u01b0\u1ee3ng c\u1ea1nh kh\u00f4ng v\u01b0\u1ee3t qu\u00e1 $i$.</p> <p>N\u00f3i c\u00e1ch kh\u00e1c, \u0111\u1ed1i v\u1edbi b\u1ea5t k\u1ef3 \u0111\u1ec9nh $a$ n\u00e0o, h\u00e3y g\u1ecdi $k$ l\u00e0 s\u1ed1 c\u1ea1nh trong \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t \u0111\u1ebfn n\u00f3 (n\u1ebfu c\u00f3 m\u1ed9t s\u1ed1 \u0111\u01b0\u1eddng \u0111i nh\u01b0 v\u1eady, b\u1ea1n c\u00f3 th\u1ec3 l\u1ea5y b\u1ea5t k\u1ef3 \u0111\u01b0\u1eddng \u0111i n\u00e0o). Theo ph\u00e1t bi\u1ec3u n\u00e0y, thu\u1eadt to\u00e1n \u0111\u1ea3m b\u1ea3o r\u1eb1ng sau pha th\u1ee9 $k$, \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t cho \u0111\u1ec9nh $a$ s\u1ebd \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y.</p> <p>Ch\u1ee9ng minh: Xem x\u00e9t m\u1ed9t \u0111\u1ec9nh $a$ t\u00f9y \u00fd c\u00f3 \u0111\u01b0\u1eddng \u0111i t\u1eeb \u0111\u1ec9nh b\u1eaft \u0111\u1ea7u $v$, v\u00e0 xem x\u00e9t m\u1ed9t \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t \u0111\u1ebfn n\u00f3 $(p_0=v, p_1, \\ldots, p_k=a)$. Tr\u01b0\u1edbc pha \u0111\u1ea7u ti\u00ean, \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t \u0111\u1ebfn \u0111\u1ec9nh $p_0 = v$ \u0111\u00e3 \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y ch\u00ednh x\u00e1c. Trong pha \u0111\u1ea7u ti\u00ean, c\u1ea1nh $(p_0,p_1)$ \u0111\u00e3 \u0111\u01b0\u1ee3c thu\u1eadt to\u00e1n ki\u1ec3m tra, v\u00e0 do \u0111\u00f3, kho\u1ea3ng c\u00e1ch \u0111\u1ebfn \u0111\u1ec9nh $p_1$ \u0111\u00e3 \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n ch\u00ednh x\u00e1c sau pha \u0111\u1ea7u ti\u00ean. L\u1eb7p l\u1ea1i ph\u00e1t bi\u1ec3u n\u00e0y $k$ l\u1ea7n, ch\u00fang ta th\u1ea5y r\u1eb1ng sau pha th\u1ee9 $k$, kho\u1ea3ng c\u00e1ch \u0111\u1ebfn \u0111\u1ec9nh $p_k = a$ \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n ch\u00ednh x\u00e1c, \u0111\u00f3 l\u00e0 \u0111i\u1ec1u ch\u00fang ta mu\u1ed1n ch\u1ee9ng minh.</p> <p>\u0110i\u1ec1u cu\u1ed1i c\u00f9ng c\u1ea7n l\u01b0u \u00fd l\u00e0 b\u1ea5t k\u1ef3 \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t n\u00e0o c\u0169ng kh\u00f4ng th\u1ec3 c\u00f3 nhi\u1ec1u h\u01a1n $n - 1$ c\u1ea1nh. Do \u0111\u00f3, thu\u1eadt to\u00e1n v\u1ec1 c\u01a1 b\u1ea3n \u0111i \u0111\u1ebfn pha th\u1ee9 $(n-1)$. Sau \u0111\u00f3, \u0111\u1ea3m b\u1ea3o r\u1eb1ng kh\u00f4ng c\u00f3 s\u1ef1 n\u1edbi l\u1ecfng n\u00e0o s\u1ebd c\u1ea3i thi\u1ec7n kho\u1ea3ng c\u00e1ch \u0111\u1ebfn m\u1ed9t s\u1ed1 \u0111\u1ec9nh.</p>","tags":["Translated"]},{"location":"graph/bellman_ford.html#the-case-of-a-negative-cycle","title":"Tr\u01b0\u1eddng h\u1ee3p chu tr\u00ecnh \u00e2m (The case of a negative cycle)","text":"<p>\u1ede m\u1ecdi n\u01a1i tr\u00ean ch\u00fang ta \u0111\u00e3 xem x\u00e9t r\u1eb1ng kh\u00f4ng c\u00f3 chu tr\u00ecnh \u00e2m n\u00e0o trong \u0111\u1ed3 th\u1ecb (ch\u00ednh x\u00e1c l\u00e0, ch\u00fang ta quan t\u00e2m \u0111\u1ebfn m\u1ed9t chu tr\u00ecnh \u00e2m c\u00f3 th\u1ec3 ti\u1ebfp c\u1eadn t\u1eeb \u0111\u1ec9nh b\u1eaft \u0111\u1ea7u $v$, v\u00e0, \u0111\u1ed1i v\u1edbi c\u00e1c chu tr\u00ecnh kh\u00f4ng th\u1ec3 ti\u1ebfp c\u1eadn, kh\u00f4ng c\u00f3 g\u00ec trong thu\u1eadt to\u00e1n tr\u00ean thay \u0111\u1ed5i). Khi c\u00f3 (c\u00e1c) chu tr\u00ecnh \u00e2m, c\u00f3 th\u00eam c\u00e1c bi\u1ebfn ch\u1ee9ng li\u00ean quan \u0111\u1ebfn th\u1ef1c t\u1ebf l\u00e0 kho\u1ea3ng c\u00e1ch \u0111\u1ebfn t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh trong chu tr\u00ecnh n\u00e0y, c\u0169ng nh\u01b0 kho\u1ea3ng c\u00e1ch \u0111\u1ebfn c\u00e1c \u0111\u1ec9nh c\u00f3 th\u1ec3 truy c\u1eadp t\u1eeb chu tr\u00ecnh n\u00e0y kh\u00f4ng \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh \u2014 ch\u00fang ph\u1ea3i b\u1eb1ng \u00e2m v\u00f4 c\u00f9ng $(- \\infty)$.</p> <p>D\u1ec5 th\u1ea5y r\u1eb1ng thu\u1eadt to\u00e1n Bellman-Ford c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n n\u1edbi l\u1ecfng v\u00f4 t\u1eadn gi\u1eefa t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh c\u1ee7a chu tr\u00ecnh n\u00e0y v\u00e0 c\u00e1c \u0111\u1ec9nh c\u00f3 th\u1ec3 truy c\u1eadp t\u1eeb n\u00f3. Do \u0111\u00f3, n\u1ebfu b\u1ea1n kh\u00f4ng gi\u1edbi h\u1ea1n s\u1ed1 l\u01b0\u1ee3ng pha th\u00e0nh $n - 1$, thu\u1eadt to\u00e1n s\u1ebd ch\u1ea1y v\u00f4 th\u1eddi h\u1ea1n, li\u00ean t\u1ee5c c\u1ea3i thi\u1ec7n kho\u1ea3ng c\u00e1ch t\u1eeb c\u00e1c \u0111\u1ec9nh n\u00e0y (gi\u1ea3m xu\u1ed1ng \u00e2m v\u00f4 c\u00f9ng).</p> <p>Do \u0111\u00f3 ch\u00fang ta thu \u0111\u01b0\u1ee3c ti\u00eau ch\u00ed cho s\u1ef1 hi\u1ec7n di\u1ec7n c\u1ee7a m\u1ed9t chu tr\u00ecnh tr\u1ecdng s\u1ed1 \u00e2m c\u00f3 th\u1ec3 ti\u1ebfp c\u1eadn t\u1eeb \u0111\u1ec9nh ngu\u1ed3n $v$: sau pha th\u1ee9 $(n-1)$, n\u1ebfu ch\u00fang ta ch\u1ea1y thu\u1eadt to\u00e1n th\u00eam m\u1ed9t pha n\u1eefa, v\u00e0 n\u00f3 th\u1ef1c hi\u1ec7n \u00edt nh\u1ea5t m\u1ed9t l\u1ea7n n\u1edbi l\u1ecfng n\u1eefa, th\u00ec \u0111\u1ed3 th\u1ecb ch\u1ee9a m\u1ed9t chu tr\u00ecnh tr\u1ecdng s\u1ed1 \u00e2m c\u00f3 th\u1ec3 ti\u1ebfp c\u1eadn t\u1eeb $v$; ng\u01b0\u1ee3c l\u1ea1i, m\u1ed9t chu tr\u00ecnh nh\u01b0 v\u1eady kh\u00f4ng t\u1ed3n t\u1ea1i.</p> <p>H\u01a1n n\u1eefa, n\u1ebfu m\u1ed9t chu tr\u00ecnh nh\u01b0 v\u1eady \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y, thu\u1eadt to\u00e1n Bellman-Ford c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eeda \u0111\u1ed5i \u0111\u1ec3 n\u00f3 truy xu\u1ea5t chu tr\u00ecnh n\u00e0y nh\u01b0 m\u1ed9t chu\u1ed7i c\u00e1c \u0111\u1ec9nh ch\u1ee9a trong n\u00f3. \u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y, ch\u1ec9 c\u1ea7n nh\u1edb \u0111\u1ec9nh cu\u1ed1i c\u00f9ng $x$ m\u00e0 t\u1ea1i \u0111\u00f3 c\u00f3 s\u1ef1 n\u1edbi l\u1ecfng trong pha th\u1ee9 $n$. \u0110\u1ec9nh n\u00e0y s\u1ebd n\u1eb1m tr\u00ean m\u1ed9t chu tr\u00ecnh tr\u1ecdng s\u1ed1 \u00e2m, ho\u1eb7c c\u00f3 th\u1ec3 ti\u1ebfp c\u1eadn t\u1eeb n\u00f3. \u0110\u1ec3 c\u00f3 \u0111\u01b0\u1ee3c c\u00e1c \u0111\u1ec9nh \u0111\u01b0\u1ee3c \u0111\u1ea3m b\u1ea3o n\u1eb1m tr\u00ean m\u1ed9t chu tr\u00ecnh \u00e2m, b\u1eaft \u0111\u1ea7u t\u1eeb \u0111\u1ec9nh $x$, \u0111i qua c\u00e1c ti\u1ec1n b\u1ed1i $n$ l\u1ea7n. B\u1eb1ng c\u00e1ch n\u00e0y, ch\u00fang ta s\u1ebd \u0111\u1ebfn \u0111\u1ec9nh $y$, \u0111\u01b0\u1ee3c \u0111\u1ea3m b\u1ea3o n\u1eb1m tr\u00ean m\u1ed9t chu tr\u00ecnh \u00e2m. Ch\u00fang ta ph\u1ea3i \u0111i t\u1eeb \u0111\u1ec9nh n\u00e0y, qua c\u00e1c ti\u1ec1n b\u1ed1i, cho \u0111\u1ebfn khi ch\u00fang ta quay tr\u1edf l\u1ea1i c\u00f9ng m\u1ed9t \u0111\u1ec9nh $y$ (v\u00e0 n\u00f3 s\u1ebd x\u1ea3y ra, b\u1edfi v\u00ec s\u1ef1 n\u1edbi l\u1ecfng trong m\u1ed9t chu tr\u00ecnh tr\u1ecdng s\u1ed1 \u00e2m x\u1ea3y ra theo c\u00e1ch tr\u00f2n).</p>","tags":["Translated"]},{"location":"graph/bellman_ford.html#cai-at","title":"C\u00e0i \u0111\u1eb7t:","text":"<pre><code>void solve()\n{\n    vector&lt;int&gt; d(n, INF);\n    d[v] = 0;\n    vector&lt;int&gt; p(n, -1);\n    int x;\n    for (int i = 0; i &lt; n; ++i) {\n        x = -1;\n        for (Edge e : edges)\n            if (d[e.a] &lt; INF)\n                if (d[e.b] &gt; d[e.a] + e.cost) {\n                    d[e.b] = max(-INF, d[e.a] + e.cost);\n                    p[e.b] = e.a;\n                    x = e.b;\n                }\n    }\n\n    if (x == -1)\n        cout &lt;&lt; \"No negative cycle from \" &lt;&lt; v;\n    else {\n        int y = x;\n        for (int i = 0; i &lt; n; ++i)\n            y = p[y];\n\n        vector&lt;int&gt; path;\n        for (int cur = y;; cur = p[cur]) {\n            path.push_back(cur);\n            if (cur == y &amp;&amp; path.size() &gt; 1)\n                break;\n        }\n        reverse(path.begin(), path.end());\n\n        cout &lt;&lt; \"Negative cycle: \";\n        for (int u : path)\n            cout &lt;&lt; u &lt;&lt; ' ';\n    }\n}\n</code></pre> <p>Do s\u1ef1 hi\u1ec7n di\u1ec7n c\u1ee7a m\u1ed9t chu tr\u00ecnh \u00e2m, \u0111\u1ed1i v\u1edbi $n$ l\u1ea7n l\u1eb7p c\u1ee7a thu\u1eadt to\u00e1n, kho\u1ea3ng c\u00e1ch c\u00f3 th\u1ec3 \u0111i xa v\u00e0o ph\u1ea1m vi \u00e2m (\u0111\u1ebfn c\u00e1c s\u1ed1 \u00e2m theo b\u1eadc $-n m W$, trong \u0111\u00f3 $W$ l\u00e0 gi\u00e1 tr\u1ecb tuy\u1ec7t \u0111\u1ed1i t\u1ed1i \u0111a c\u1ee7a b\u1ea5t k\u1ef3 tr\u1ecdng s\u1ed1 n\u00e0o trong \u0111\u1ed3 th\u1ecb). Do \u0111\u00f3 trong m\u00e3, ch\u00fang ta \u0111\u00e3 \u00e1p d\u1ee5ng c\u00e1c bi\u1ec7n ph\u00e1p b\u1ed5 sung ch\u1ed1ng tr\u00e0n s\u1ed1 nguy\u00ean nh\u01b0 sau:</p> <pre><code>d[e.b] = max(-INF, d[e.a] + e.cost);\n</code></pre> <p>C\u00e0i \u0111\u1eb7t tr\u00ean t\u00ecm ki\u1ebfm m\u1ed9t chu tr\u00ecnh \u00e2m c\u00f3 th\u1ec3 ti\u1ebfp c\u1eadn t\u1eeb m\u1ed9t s\u1ed1 \u0111\u1ec9nh b\u1eaft \u0111\u1ea7u $v$; tuy nhi\u00ean, thu\u1eadt to\u00e1n c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eeda \u0111\u1ed5i \u0111\u1ec3 ch\u1ec9 t\u00ecm ki\u1ebfm b\u1ea5t k\u1ef3 chu tr\u00ecnh \u00e2m n\u00e0o trong \u0111\u1ed3 th\u1ecb. \u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y, ch\u00fang ta c\u1ea7n \u0111\u1eb7t t\u1ea5t c\u1ea3 kho\u1ea3ng c\u00e1ch $d[i]$ th\u00e0nh 0 v\u00e0 kh\u00f4ng ph\u1ea3i v\u00f4 c\u00f9ng \u2014 nh\u01b0 th\u1ec3 ch\u00fang ta \u0111ang t\u00ecm ki\u1ebfm \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t t\u1eeb t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh c\u00f9ng m\u1ed9t l\u00fac; t\u00ednh h\u1ee3p l\u1ec7 c\u1ee7a vi\u1ec7c ph\u00e1t hi\u1ec7n chu tr\u00ecnh \u00e2m kh\u00f4ng b\u1ecb \u1ea3nh h\u01b0\u1edfng.</p> <p>\u0110\u1ec3 bi\u1ebft th\u00eam v\u1ec1 ch\u1ee7 \u0111\u1ec1 n\u00e0y \u2014 xem b\u00e0i vi\u1ebft ri\u00eang, T\u00ecm chu tr\u00ecnh \u00e2m trong \u0111\u1ed3 th\u1ecb.</p>","tags":["Translated"]},{"location":"graph/bellman_ford.html#shortest-path-faster-algorithm-spfa","title":"Thu\u1eadt to\u00e1n Shortest Path Faster (SPFA)","text":"<p>SPFA l\u00e0 m\u1ed9t c\u1ea3i ti\u1ebfn c\u1ee7a thu\u1eadt to\u00e1n Bellman-Ford t\u1eadn d\u1ee5ng th\u1ef1c t\u1ebf l\u00e0 kh\u00f4ng ph\u1ea3i t\u1ea5t c\u1ea3 c\u00e1c n\u1ed7 l\u1ef1c n\u1edbi l\u1ecfng s\u1ebd ho\u1ea1t \u0111\u1ed9ng. \u00dd t\u01b0\u1edfng ch\u00ednh l\u00e0 t\u1ea1o ra m\u1ed9t h\u00e0ng \u0111\u1ee3i ch\u1ec9 ch\u1ee9a c\u00e1c \u0111\u1ec9nh \u0111\u00e3 \u0111\u01b0\u1ee3c n\u1edbi l\u1ecfng nh\u01b0ng v\u1eabn c\u00f3 th\u1ec3 n\u1edbi l\u1ecfng th\u00eam c\u00e1c h\u00e0ng x\u00f3m c\u1ee7a ch\u00fang. V\u00e0 b\u1ea5t c\u1ee9 khi n\u00e0o b\u1ea1n c\u00f3 th\u1ec3 n\u1edbi l\u1ecfng m\u1ed9t s\u1ed1 h\u00e0ng x\u00f3m, b\u1ea1n n\u00ean \u0111\u01b0a anh ta v\u00e0o h\u00e0ng \u0111\u1ee3i. Thu\u1eadt to\u00e1n n\u00e0y c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 ph\u00e1t hi\u1ec7n chu tr\u00ecnh \u00e2m nh\u01b0 Bellman-Ford.</p> <p>Tr\u01b0\u1eddng h\u1ee3p x\u1ea5u nh\u1ea5t c\u1ee7a thu\u1eadt to\u00e1n n\u00e0y b\u1eb1ng v\u1edbi $O(n m)$ c\u1ee7a Bellman-Ford, nh\u01b0ng trong th\u1ef1c t\u1ebf n\u00f3 ho\u1ea1t \u0111\u1ed9ng nhanh h\u01a1n nhi\u1ec1u v\u00e0 m\u1ed9t s\u1ed1 ng\u01b0\u1eddi kh\u1eb3ng \u0111\u1ecbnh r\u1eb1ng n\u00f3 ho\u1ea1t \u0111\u1ed9ng ngay c\u1ea3 trong $O(m)$ tr\u00ean trung b\u00ecnh. Tuy nhi\u00ean h\u00e3y c\u1ea9n th\u1eadn, b\u1edfi v\u00ec thu\u1eadt to\u00e1n n\u00e0y l\u00e0 x\u00e1c \u0111\u1ecbnh v\u00e0 r\u1ea5t d\u1ec5 t\u1ea1o ra c\u00e1c v\u00ed d\u1ee5 ph\u1ea3n ch\u1ee9ng l\u00e0m cho thu\u1eadt to\u00e1n ch\u1ea1y trong $O(n m)$.</p> <p>C\u1ea7n l\u01b0u \u00fd m\u1ed9t s\u1ed1 \u0111i\u1ec1u trong c\u00e0i \u0111\u1eb7t, ch\u1eb3ng h\u1ea1n nh\u01b0 th\u1ef1c t\u1ebf l\u00e0 thu\u1eadt to\u00e1n ti\u1ebfp t\u1ee5c m\u00e3i m\u00e3i n\u1ebfu c\u00f3 m\u1ed9t chu tr\u00ecnh \u00e2m. \u0110\u1ec3 tr\u00e1nh \u0111i\u1ec1u n\u00e0y, c\u00f3 th\u1ec3 t\u1ea1o m\u1ed9t b\u1ed9 \u0111\u1ebfm l\u01b0u tr\u1eef s\u1ed1 l\u1ea7n m\u1ed9t \u0111\u1ec9nh \u0111\u00e3 \u0111\u01b0\u1ee3c n\u1edbi l\u1ecfng v\u00e0 d\u1eebng thu\u1eadt to\u00e1n ngay khi m\u1ed9t s\u1ed1 \u0111\u1ec9nh \u0111\u01b0\u1ee3c n\u1edbi l\u1ecfng l\u1ea7n th\u1ee9 $n$. L\u01b0u \u00fd, c\u0169ng kh\u00f4ng c\u00f3 l\u00fd do g\u00ec \u0111\u1ec3 \u0111\u01b0a m\u1ed9t \u0111\u1ec9nh v\u00e0o h\u00e0ng \u0111\u1ee3i n\u1ebfu n\u00f3 \u0111\u00e3 \u1edf trong \u0111\u00f3.</p> <pre><code>const int INF = 1000000000;\nvector&lt;vector&lt;pair&lt;int, int&gt;&gt;&gt; adj;\n\nbool spfa(int s, vector&lt;int&gt;&amp; d) {\n    int n = adj.size();\n    d.assign(n, INF);\n    vector&lt;int&gt; cnt(n, 0);\n    vector&lt;bool&gt; inqueue(n, false);\n    queue&lt;int&gt; q;\n\n    d[s] = 0;\n    q.push(s);\n    inqueue[s] = true;\n    while (!q.empty()) {\n        int v = q.front();\n        q.pop();\n        inqueue[v] = false;\n\n        for (auto edge : adj[v]) {\n            int to = edge.first;\n            int len = edge.second;\n\n            if (d[v] + len &lt; d[to]) {\n                d[to] = d[v] + len;\n                if (!inqueue[to]) {\n                    q.push(to);\n                    inqueue[to] = true;\n                    cnt[to]++;\n                    if (cnt[to] &gt; n)\n                        return false;  // negative cycle\n                }\n            }\n        }\n    }\n    return true;\n}\n</code></pre>","tags":["Translated"]},{"location":"graph/bellman_ford.html#related-problems-in-online-judges","title":"C\u00e1c b\u00e0i to\u00e1n li\u00ean quan (Related problems in online judges)","text":"<p>Danh s\u00e1ch c\u00e1c b\u00e0i t\u1eadp c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i quy\u1ebft b\u1eb1ng thu\u1eadt to\u00e1n Bellman-Ford:</p> <ul> <li>E-OLYMP #1453 \"Ford-Bellman\" [difficulty: low]</li> <li>UVA #423 \"MPI Maelstrom\" [difficulty: low]</li> <li>UVA #534 \"Frogger\" [difficulty: medium]</li> <li>UVA #10099 \"The Tourist Guide\" [difficulty: medium]</li> <li>UVA #515 \"King\" [difficulty: medium]</li> <li>UVA 12519 - The Farnsworth Parabox</li> </ul> <p>Xem th\u00eam danh s\u00e1ch b\u00e0i t\u1eadp trong b\u00e0i vi\u1ebft T\u00ecm chu tr\u00ecnh \u00e2m trong \u0111\u1ed3 th\u1ecb. * CSES - High Score * CSES - Cycle Finding</p>","tags":["Translated"]},{"location":"graph/bipartite-check.html","title":"Ki\u1ec3m tra xem \u0111\u1ed3 th\u1ecb c\u00f3 ph\u1ea3i l\u00e0 hai ph\u00eda (bipartite) kh\u00f4ng","text":"<p>M\u1ed9t \u0111\u1ed3 th\u1ecb hai ph\u00eda l\u00e0 m\u1ed9t \u0111\u1ed3 th\u1ecb m\u00e0 c\u00e1c \u0111\u1ec9nh c\u1ee7a n\u00f3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c chia th\u00e0nh hai t\u1eadp h\u1ee3p r\u1eddi nhau sao cho m\u1ed7i c\u1ea1nh n\u1ed1i hai \u0111\u1ec9nh t\u1eeb c\u00e1c t\u1eadp h\u1ee3p kh\u00e1c nhau (t\u1ee9c l\u00e0 kh\u00f4ng c\u00f3 c\u1ea1nh n\u00e0o n\u1ed1i c\u00e1c \u0111\u1ec9nh t\u1eeb c\u00f9ng m\u1ed9t t\u1eadp h\u1ee3p). C\u00e1c t\u1eadp h\u1ee3p n\u00e0y th\u01b0\u1eddng \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 c\u00e1c ph\u00eda (sides).</p> <p>B\u1ea1n \u0111\u01b0\u1ee3c cho m\u1ed9t \u0111\u1ed3 th\u1ecb v\u00f4 h\u01b0\u1edbng. Ki\u1ec3m tra xem n\u00f3 c\u00f3 ph\u1ea3i l\u00e0 hai ph\u00eda hay kh\u00f4ng, v\u00e0 n\u1ebfu c\u00f3, h\u00e3y xu\u1ea5t ra c\u00e1c ph\u00eda c\u1ee7a n\u00f3.</p>","tags":["Translated"]},{"location":"graph/bipartite-check.html#algorithm","title":"Thu\u1eadt to\u00e1n (Algorithm)","text":"<p>C\u00f3 m\u1ed9t \u0111\u1ecbnh l\u00fd kh\u1eb3ng \u0111\u1ecbnh r\u1eb1ng m\u1ed9t \u0111\u1ed3 th\u1ecb l\u00e0 hai ph\u00eda khi v\u00e0 ch\u1ec9 khi t\u1ea5t c\u1ea3 c\u00e1c chu tr\u00ecnh c\u1ee7a n\u00f3 c\u00f3 \u0111\u1ed9 d\u00e0i ch\u1eb5n. Tuy nhi\u00ean, trong th\u1ef1c t\u1ebf, thu\u1eadn ti\u1ec7n h\u01a1n khi s\u1eed d\u1ee5ng m\u1ed9t c\u00f4ng th\u1ee9c kh\u00e1c c\u1ee7a \u0111\u1ecbnh ngh\u0129a: m\u1ed9t \u0111\u1ed3 th\u1ecb l\u00e0 hai ph\u00eda khi v\u00e0 ch\u1ec9 khi n\u00f3 c\u00f3 th\u1ec3 t\u00f4 b\u1eb1ng hai m\u00e0u (two-colorable).</p> <p>H\u00e3y s\u1eed d\u1ee5ng m\u1ed9t lo\u1ea1t c\u00e1c t\u00ecm ki\u1ebfm theo chi\u1ec1u r\u1ed9ng, b\u1eaft \u0111\u1ea7u t\u1eeb m\u1ed7i \u0111\u1ec9nh ch\u01b0a \u0111\u01b0\u1ee3c th\u0103m. Trong m\u1ed7i l\u1ea7n t\u00ecm ki\u1ebfm, g\u00e1n \u0111\u1ec9nh m\u00e0 ch\u00fang ta b\u1eaft \u0111\u1ea7u cho ph\u00eda 1. M\u1ed7i khi ch\u00fang ta th\u0103m m\u1ed9t h\u00e0ng x\u00f3m ch\u01b0a \u0111\u01b0\u1ee3c th\u0103m c\u1ee7a m\u1ed9t \u0111\u1ec9nh \u0111\u01b0\u1ee3c g\u00e1n cho m\u1ed9t ph\u00eda, ch\u00fang ta g\u00e1n n\u00f3 cho ph\u00eda kia. Khi ch\u00fang ta c\u1ed1 g\u1eafng \u0111i \u0111\u1ebfn m\u1ed9t h\u00e0ng x\u00f3m c\u1ee7a m\u1ed9t \u0111\u1ec9nh \u0111\u01b0\u1ee3c g\u00e1n cho m\u1ed9t ph\u00eda m\u00e0 \u0111\u00e3 \u0111\u01b0\u1ee3c th\u0103m, ch\u00fang ta ki\u1ec3m tra xem n\u00f3 \u0111\u00e3 \u0111\u01b0\u1ee3c g\u00e1n cho ph\u00eda kia hay ch\u01b0a; n\u1ebfu n\u00f3 \u0111\u00e3 \u0111\u01b0\u1ee3c g\u00e1n cho c\u00f9ng m\u1ed9t ph\u00eda, ch\u00fang ta k\u1ebft lu\u1eadn r\u1eb1ng \u0111\u1ed3 th\u1ecb kh\u00f4ng ph\u1ea3i l\u00e0 hai ph\u00eda. Khi ch\u00fang ta \u0111\u00e3 th\u0103m t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh v\u00e0 g\u00e1n th\u00e0nh c\u00f4ng ch\u00fang cho c\u00e1c ph\u00eda, ch\u00fang ta bi\u1ebft r\u1eb1ng \u0111\u1ed3 th\u1ecb l\u00e0 hai ph\u00eda v\u00e0 ch\u00fang ta \u0111\u00e3 x\u00e2y d\u1ef1ng ph\u00e2n ho\u1ea1ch c\u1ee7a n\u00f3.</p>","tags":["Translated"]},{"location":"graph/bipartite-check.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<pre><code>int n;\nvector&lt;vector&lt;int&gt;&gt; adj;\n\nvector&lt;int&gt; side(n, -1);\nbool is_bipartite = true;\nqueue&lt;int&gt; q;\nfor (int st = 0; st &lt; n; ++st) {\n    if (side[st] == -1) {\n        q.push(st);\n        side[st] = 0;\n        while (!q.empty()) {\n            int v = q.front();\n            q.pop();\n            for (int u : adj[v]) {\n                if (side[u] == -1) {\n                    side[u] = side[v] ^ 1;\n                    q.push(u);\n                } else {\n                    is_bipartite &amp;= side[u] != side[v];\n                }\n            }\n        }\n    }\n}\n\ncout &lt;&lt; (is_bipartite ? \"YES\" : \"NO\") &lt;&lt; endl;\n</code></pre>","tags":["Translated"]},{"location":"graph/bipartite-check.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice problems)","text":"<ul> <li>SPOJ - BUGLIFE</li> <li>Codeforces - Graph Without Long Directed Paths</li> <li>Codeforces - String Coloring (easy version)</li> <li>CSES : Building Teams</li> </ul>","tags":["Translated"]},{"location":"graph/breadth-first-search.html","title":"T\u00ecm ki\u1ebfm theo chi\u1ec1u r\u1ed9ng (Breadth-first search)","text":"<p>T\u00ecm ki\u1ebfm theo chi\u1ec1u r\u1ed9ng (Breadth first search - BFS) l\u00e0 m\u1ed9t trong nh\u1eefng thu\u1eadt to\u00e1n t\u00ecm ki\u1ebfm c\u01a1 b\u1ea3n v\u00e0 thi\u1ebft y\u1ebfu tr\u00ean \u0111\u1ed3 th\u1ecb.</p> <p>Do c\u00e1ch ho\u1ea1t \u0111\u1ed9ng c\u1ee7a thu\u1eadt to\u00e1n, \u0111\u01b0\u1eddng \u0111i \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y b\u1edfi t\u00ecm ki\u1ebfm theo chi\u1ec1u r\u1ed9ng \u0111\u1ebfn b\u1ea5t k\u1ef3 n\u00fat n\u00e0o l\u00e0 \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t \u0111\u1ebfn n\u00fat \u0111\u00f3, t\u1ee9c l\u00e0 \u0111\u01b0\u1eddng \u0111i ch\u1ee9a s\u1ed1 l\u01b0\u1ee3ng c\u1ea1nh nh\u1ecf nh\u1ea5t trong \u0111\u1ed3 th\u1ecb kh\u00f4ng tr\u1ecdng s\u1ed1.</p> <p>Thu\u1eadt to\u00e1n ho\u1ea1t \u0111\u1ed9ng trong th\u1eddi gian $O(n + m)$, trong \u0111\u00f3 $n$ l\u00e0 s\u1ed1 l\u01b0\u1ee3ng \u0111\u1ec9nh v\u00e0 $m$ l\u00e0 s\u1ed1 l\u01b0\u1ee3ng c\u1ea1nh.</p>","tags":["Translated"]},{"location":"graph/breadth-first-search.html#description-of-the-algorithm","title":"M\u00f4 t\u1ea3 thu\u1eadt to\u00e1n (Description of the algorithm)","text":"<p>Thu\u1eadt to\u00e1n nh\u1eadn \u0111\u1ea7u v\u00e0o l\u00e0 m\u1ed9t \u0111\u1ed3 th\u1ecb kh\u00f4ng tr\u1ecdng s\u1ed1 v\u00e0 id c\u1ee7a \u0111\u1ec9nh ngu\u1ed3n $s$. \u0110\u1ed3 th\u1ecb \u0111\u1ea7u v\u00e0o c\u00f3 th\u1ec3 l\u00e0 c\u00f3 h\u01b0\u1edbng ho\u1eb7c v\u00f4 h\u01b0\u1edbng, \u0111i\u1ec1u \u0111\u00f3 kh\u00f4ng quan tr\u1ecdng \u0111\u1ed1i v\u1edbi thu\u1eadt to\u00e1n.</p> <p>Thu\u1eadt to\u00e1n c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c hi\u1ec3u nh\u01b0 m\u1ed9t ng\u1ecdn l\u1eeda lan truy\u1ec1n tr\u00ean \u0111\u1ed3 th\u1ecb: \u1edf b\u01b0\u1edbc th\u1ee9 0, ch\u1ec9 c\u00f3 ngu\u1ed3n $s$ b\u1ecb ch\u00e1y. \u1ede m\u1ed7i b\u01b0\u1edbc, ng\u1ecdn l\u1eeda \u0111ang ch\u00e1y t\u1ea1i m\u1ed7i \u0111\u1ec9nh lan sang t\u1ea5t c\u1ea3 c\u00e1c h\u00e0ng x\u00f3m c\u1ee7a n\u00f3. Trong m\u1ed9t l\u1ea7n l\u1eb7p c\u1ee7a thu\u1eadt to\u00e1n, \"v\u00f2ng l\u1eeda\" \u0111\u01b0\u1ee3c m\u1edf r\u1ed9ng theo chi\u1ec1u r\u1ed9ng th\u00eam m\u1ed9t \u0111\u01a1n v\u1ecb (do \u0111\u00f3 c\u00f3 t\u00ean g\u1ecdi c\u1ee7a thu\u1eadt to\u00e1n).</p> <p>Ch\u00ednh x\u00e1c h\u01a1n, thu\u1eadt to\u00e1n c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c ph\u00e1t bi\u1ec3u nh\u01b0 sau: T\u1ea1o m\u1ed9t h\u00e0ng \u0111\u1ee3i $q$ s\u1ebd ch\u1ee9a c\u00e1c \u0111\u1ec9nh c\u1ea7n \u0111\u01b0\u1ee3c x\u1eed l\u00fd v\u00e0 m\u1ed9t m\u1ea3ng Boolean $used[]$ ch\u1ec9 ra cho m\u1ed7i \u0111\u1ec9nh, n\u1ebfu n\u00f3 \u0111\u00e3 \u0111\u01b0\u1ee3c th\u1eafp s\u00e1ng (ho\u1eb7c \u0111\u00e3 th\u0103m) hay ch\u01b0a.</p> <p>Ban \u0111\u1ea7u, \u0111\u1ea9y ngu\u1ed3n $s$ v\u00e0o h\u00e0ng \u0111\u1ee3i v\u00e0 \u0111\u1eb7t $used[s] = true$, v\u00e0 \u0111\u1ed1i v\u1edbi t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh kh\u00e1c $v$ \u0111\u1eb7t $used[v] = false$. Sau \u0111\u00f3, l\u1eb7p l\u1ea1i cho \u0111\u1ebfn khi h\u00e0ng \u0111\u1ee3i tr\u1ed1ng v\u00e0 trong m\u1ed7i l\u1ea7n l\u1eb7p, l\u1ea5y ra m\u1ed9t \u0111\u1ec9nh t\u1eeb \u0111\u1ea7u h\u00e0ng \u0111\u1ee3i. Duy\u1ec7t qua t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh \u0111i ra kh\u1ecfi \u0111\u1ec9nh n\u00e0y v\u00e0 n\u1ebfu m\u1ed9t s\u1ed1 c\u1ea1nh n\u00e0y \u0111i \u0111\u1ebfn c\u00e1c \u0111\u1ec9nh ch\u01b0a \u0111\u01b0\u1ee3c th\u1eafp s\u00e1ng, h\u00e3y th\u1eafp s\u00e1ng ch\u00fang v\u00e0 \u0111\u1eb7t ch\u00fang v\u00e0o h\u00e0ng \u0111\u1ee3i.</p> <p>K\u1ebft qu\u1ea3 l\u00e0, khi h\u00e0ng \u0111\u1ee3i tr\u1ed1ng, \"v\u00f2ng l\u1eeda\" ch\u1ee9a t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh c\u00f3 th\u1ec3 \u0111\u1ebfn \u0111\u01b0\u1ee3c t\u1eeb ngu\u1ed3n $s$, v\u1edbi m\u1ed7i \u0111\u1ec9nh \u0111\u01b0\u1ee3c ti\u1ebfp c\u1eadn theo c\u00e1ch ng\u1eafn nh\u1ea5t c\u00f3 th\u1ec3. B\u1ea1n c\u0169ng c\u00f3 th\u1ec3 t\u00ednh to\u00e1n \u0111\u1ed9 d\u00e0i c\u1ee7a c\u00e1c \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t (ch\u1ec9 c\u1ea7n duy tr\u00ec m\u1ed9t m\u1ea3ng \u0111\u1ed9 d\u00e0i \u0111\u01b0\u1eddng \u0111i $d[]$) c\u0169ng nh\u01b0 l\u01b0u th\u00f4ng tin \u0111\u1ec3 kh\u00f4i ph\u1ee5c t\u1ea5t c\u1ea3 c\u00e1c \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t n\u00e0y (\u0111\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y, c\u1ea7n duy tr\u00ec m\u1ed9t m\u1ea3ng c\u00e1c \"cha\" $p[]$, l\u01b0u tr\u1eef cho m\u1ed7i \u0111\u1ec9nh \u0111\u1ec9nh m\u00e0 t\u1eeb \u0111\u00f3 ch\u00fang ta \u0111\u00e3 \u0111\u1ebfn n\u00f3).</p>","tags":["Translated"]},{"location":"graph/breadth-first-search.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>Ch\u00fang t\u00f4i vi\u1ebft m\u00e3 cho thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 b\u1eb1ng C++ v\u00e0 Java.</p> C++Java <pre><code>vector&lt;vector&lt;int&gt;&gt; adj;  // bi\u1ec3u di\u1ec5n danh s\u00e1ch k\u1ec1\nint n; // s\u1ed1 l\u01b0\u1ee3ng n\u00fat\nint s; // \u0111\u1ec9nh ngu\u1ed3n\n\nqueue&lt;int&gt; q;\nvector&lt;bool&gt; used(n);\nvector&lt;int&gt; d(n), p(n);\n\nq.push(s);\nused[s] = true;\np[s] = -1;\nwhile (!q.empty()) {\n    int v = q.front();\n    q.pop();\n    for (int u : adj[v]) {\n        if (!used[u]) {\n            used[u] = true;\n            q.push(u);\n            d[u] = d[v] + 1;\n            p[u] = v;\n        }\n    }\n}\n</code></pre> <pre><code>ArrayList&lt;ArrayList&lt;Integer&gt;&gt; adj = new ArrayList&lt;&gt;(); // bi\u1ec3u di\u1ec5n danh s\u00e1ch k\u1ec1\n\nint n; // s\u1ed1 l\u01b0\u1ee3ng n\u00fat\nint s; // \u0111\u1ec9nh ngu\u1ed3n\n\n\nLinkedList&lt;Integer&gt; q = new LinkedList&lt;Integer&gt;();\nboolean used[] = new boolean[n];\nint d[] = new int[n];\nint p[] = new int[n];\n\nq.push(s);\nused[s] = true;\np[s] = -1;\nwhile (!q.isEmpty()) {\n    int v = q.pop();\n    for (int u : adj.get(v)) {\n        if (!used[u]) {\n            used[u] = true;\n            q.push(u);\n            d[u] = d[v] + 1;\n            p[u] = v;\n        }\n    }\n}\n</code></pre> <p>N\u1ebfu ch\u00fang ta ph\u1ea3i kh\u00f4i ph\u1ee5c v\u00e0 hi\u1ec3n th\u1ecb \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t t\u1eeb ngu\u1ed3n \u0111\u1ebfn m\u1ed9t \u0111\u1ec9nh $u$ n\u00e0o \u0111\u00f3, n\u00f3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n theo c\u00e1ch sau:</p> C++Java <pre><code>if (!used[u]) {\n    cout &lt;&lt; \"No path!\";\n} else {\n    vector&lt;int&gt; path;\n    for (int v = u; v != -1; v = p[v])\n        path.push_back(v);\n    reverse(path.begin(), path.end());\n    cout &lt;&lt; \"Path: \";\n    for (int v : path)\n        cout &lt;&lt; v &lt;&lt; \" \";\n}\n</code></pre> <pre><code>if (!used[u]) {\n    System.out.println(\"No path!\");\n} else {\n    ArrayList&lt;Integer&gt; path = new ArrayList&lt;Integer&gt;();\n    for (int v = u; v != -1; v = p[v])\n        path.add(v);\n    Collections.reverse(path);\n    for(int v : path)\n        System.out.println(v);\n}\n</code></pre>","tags":["Translated"]},{"location":"graph/breadth-first-search.html#applications-of-bfs","title":"\u1ee8ng d\u1ee5ng c\u1ee7a BFS (Applications of BFS)","text":"<ul> <li> <p>T\u00ecm \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t t\u1eeb m\u1ed9t ngu\u1ed3n \u0111\u1ebfn c\u00e1c \u0111\u1ec9nh kh\u00e1c trong m\u1ed9t \u0111\u1ed3 th\u1ecb kh\u00f4ng tr\u1ecdng s\u1ed1.</p> </li> <li> <p>T\u00ecm t\u1ea5t c\u1ea3 c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng trong m\u1ed9t \u0111\u1ed3 th\u1ecb v\u00f4 h\u01b0\u1edbng trong th\u1eddi gian $O(n + m)$: \u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y, ch\u00fang ta ch\u1ec9 c\u1ea7n ch\u1ea1y BFS b\u1eaft \u0111\u1ea7u t\u1eeb m\u1ed7i \u0111\u1ec9nh, ngo\u1ea1i tr\u1eeb c\u00e1c \u0111\u1ec9nh \u0111\u00e3 \u0111\u01b0\u1ee3c th\u0103m t\u1eeb c\u00e1c l\u1ea7n ch\u1ea1y tr\u01b0\u1edbc. Do \u0111\u00f3, ch\u00fang ta th\u1ef1c hi\u1ec7n BFS b\u00ecnh th\u01b0\u1eddng t\u1eeb m\u1ed7i \u0111\u1ec9nh, nh\u01b0ng kh\u00f4ng \u0111\u1eb7t l\u1ea1i m\u1ea3ng $used[]$ m\u1ed7i khi ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c m\u1ed9t th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1edbi, v\u00e0 t\u1ed5ng th\u1eddi gian ch\u1ea1y v\u1eabn s\u1ebd l\u00e0 $O(n + m)$ (vi\u1ec7c th\u1ef1c hi\u1ec7n nhi\u1ec1u BFS tr\u00ean \u0111\u1ed3 th\u1ecb m\u00e0 kh\u00f4ng \u0111\u1eb7t l\u1ea1i m\u1ea3ng $used []$ \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 m\u1ed9t lo\u1ea1t c\u00e1c t\u00ecm ki\u1ebfm theo chi\u1ec1u r\u1ed9ng).</p> </li> <li> <p>T\u00ecm l\u1eddi gi\u1ea3i cho m\u1ed9t b\u00e0i to\u00e1n ho\u1eb7c m\u1ed9t tr\u00f2 ch\u01a1i v\u1edbi s\u1ed1 b\u01b0\u1edbc \u0111i \u00edt nh\u1ea5t, n\u1ebfu m\u1ed7i tr\u1ea1ng th\u00e1i c\u1ee7a tr\u00f2 ch\u01a1i c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n b\u1eb1ng m\u1ed9t \u0111\u1ec9nh c\u1ee7a \u0111\u1ed3 th\u1ecb, v\u00e0 c\u00e1c chuy\u1ec3n \u0111\u1ed5i t\u1eeb tr\u1ea1ng th\u00e1i n\u00e0y sang tr\u1ea1ng th\u00e1i kh\u00e1c l\u00e0 c\u00e1c c\u1ea1nh c\u1ee7a \u0111\u1ed3 th\u1ecb.</p> </li> <li> <p>T\u00ecm \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t trong \u0111\u1ed3 th\u1ecb c\u00f3 tr\u1ecdng s\u1ed1 0 ho\u1eb7c 1: \u0110i\u1ec1u n\u00e0y ch\u1ec9 y\u00eau c\u1ea7u m\u1ed9t ch\u00fat s\u1eeda \u0111\u1ed5i \u0111\u1ed1i v\u1edbi t\u00ecm ki\u1ebfm theo chi\u1ec1u r\u1ed9ng th\u00f4ng th\u01b0\u1eddng: Thay v\u00ec duy tr\u00ec m\u1ea3ng $used[]$, b\u00e2y gi\u1edd ch\u00fang ta s\u1ebd ki\u1ec3m tra xem kho\u1ea3ng c\u00e1ch \u0111\u1ebfn \u0111\u1ec9nh c\u00f3 ng\u1eafn h\u01a1n kho\u1ea3ng c\u00e1ch \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y hi\u1ec7n t\u1ea1i hay kh\u00f4ng, sau \u0111\u00f3 n\u1ebfu c\u1ea1nh hi\u1ec7n t\u1ea1i c\u00f3 tr\u1ecdng s\u1ed1 b\u1eb1ng 0, ch\u00fang ta th\u00eam n\u00f3 v\u00e0o \u0111\u1ea7u h\u00e0ng \u0111\u1ee3i, ng\u01b0\u1ee3c l\u1ea1i ch\u00fang ta th\u00eam n\u00f3 v\u00e0o cu\u1ed1i h\u00e0ng \u0111\u1ee3i. S\u1eeda \u0111\u1ed5i n\u00e0y \u0111\u01b0\u1ee3c gi\u1ea3i th\u00edch chi ti\u1ebft h\u01a1n trong b\u00e0i vi\u1ebft 0-1 BFS.</p> </li> <li> <p>T\u00ecm chu tr\u00ecnh ng\u1eafn nh\u1ea5t trong \u0111\u1ed3 th\u1ecb c\u00f3 h\u01b0\u1edbng kh\u00f4ng tr\u1ecdng s\u1ed1: B\u1eaft \u0111\u1ea7u t\u00ecm ki\u1ebfm theo chi\u1ec1u r\u1ed9ng t\u1eeb m\u1ed7i \u0111\u1ec9nh. Ngay khi ch\u00fang ta c\u1ed1 g\u1eafng \u0111i t\u1eeb \u0111\u1ec9nh hi\u1ec7n t\u1ea1i tr\u1edf l\u1ea1i \u0111\u1ec9nh ngu\u1ed3n, ch\u00fang ta \u0111\u00e3 t\u00ecm th\u1ea5y chu tr\u00ecnh ng\u1eafn nh\u1ea5t ch\u1ee9a \u0111\u1ec9nh ngu\u1ed3n. T\u1ea1i th\u1eddi \u0111i\u1ec3m n\u00e0y, ch\u00fang ta c\u00f3 th\u1ec3 d\u1eebng BFS v\u00e0 b\u1eaft \u0111\u1ea7u BFS m\u1edbi t\u1eeb \u0111\u1ec9nh ti\u1ebfp theo. T\u1eeb t\u1ea5t c\u1ea3 c\u00e1c chu tr\u00ecnh nh\u01b0 v\u1eady (t\u1ed1i \u0111a m\u1ed9t t\u1eeb m\u1ed7i BFS), ch\u1ecdn chu tr\u00ecnh ng\u1eafn nh\u1ea5t.</p> </li> <li> <p>T\u00ecm t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh n\u1eb1m tr\u00ean b\u1ea5t k\u1ef3 \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t n\u00e0o gi\u1eefa m\u1ed9t c\u1eb7p \u0111\u1ec9nh $(a, b)$ cho tr\u01b0\u1edbc. \u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y, h\u00e3y ch\u1ea1y hai t\u00ecm ki\u1ebfm theo chi\u1ec1u r\u1ed9ng: m\u1ed9t t\u1eeb $a$ v\u00e0 m\u1ed9t t\u1eeb $b$. Gi\u1ea3 s\u1eed $d_a []$ l\u00e0 m\u1ea3ng ch\u1ee9a kho\u1ea3ng c\u00e1ch ng\u1eafn nh\u1ea5t thu \u0111\u01b0\u1ee3c t\u1eeb BFS \u0111\u1ea7u ti\u00ean (t\u1eeb $a$) v\u00e0 $d_b []$ l\u00e0 m\u1ea3ng ch\u1ee9a kho\u1ea3ng c\u00e1ch ng\u1eafn nh\u1ea5t thu \u0111\u01b0\u1ee3c t\u1eeb BFS th\u1ee9 hai t\u1eeb $b$. B\u00e2y gi\u1edd \u0111\u1ed1i v\u1edbi m\u1ecdi c\u1ea1nh $(u, v)$, th\u1eadt d\u1ec5 d\u00e0ng \u0111\u1ec3 ki\u1ec3m tra xem c\u1ea1nh \u0111\u00f3 c\u00f3 n\u1eb1m tr\u00ean b\u1ea5t k\u1ef3 \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t n\u00e0o gi\u1eefa $a$ v\u00e0 $b$ hay kh\u00f4ng: ti\u00eau ch\u00ed l\u00e0 \u0111i\u1ec1u ki\u1ec7n $d_a [u] + 1 + d_b [v] = d_a [b]$.</p> </li> <li> <p>T\u00ecm t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh tr\u00ean b\u1ea5t k\u1ef3 \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t n\u00e0o gi\u1eefa m\u1ed9t c\u1eb7p \u0111\u1ec9nh $(a, b)$ cho tr\u01b0\u1edbc. \u0110\u1ec3 th\u1ef1c hi\u1ec7n \u0111i\u1ec1u \u0111\u00f3, h\u00e3y ch\u1ea1y hai t\u00ecm ki\u1ebfm theo chi\u1ec1u r\u1ed9ng: m\u1ed9t t\u1eeb $a$ v\u00e0 m\u1ed9t t\u1eeb $b$. Gi\u1ea3 s\u1eed $d_a []$ l\u00e0 m\u1ea3ng ch\u1ee9a kho\u1ea3ng c\u00e1ch ng\u1eafn nh\u1ea5t thu \u0111\u01b0\u1ee3c t\u1eeb BFS \u0111\u1ea7u ti\u00ean (t\u1eeb $a$) v\u00e0 $d_b []$ l\u00e0 m\u1ea3ng ch\u1ee9a kho\u1ea3ng c\u00e1ch ng\u1eafn nh\u1ea5t thu \u0111\u01b0\u1ee3c t\u1eeb BFS th\u1ee9 hai (t\u1eeb $b$). B\u00e2y gi\u1edd \u0111\u1ed1i v\u1edbi m\u1ed7i \u0111\u1ec9nh, th\u1eadt d\u1ec5 d\u00e0ng \u0111\u1ec3 ki\u1ec3m tra xem n\u00f3 c\u00f3 n\u1eb1m tr\u00ean b\u1ea5t k\u1ef3 \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t n\u00e0o gi\u1eefa $a$ v\u00e0 $b$ hay kh\u00f4ng: ti\u00eau ch\u00ed l\u00e0 \u0111i\u1ec1u ki\u1ec7n $d_a [v] + d_b [v] = d_a [b]$.</p> </li> <li> <p>T\u00ecm h\u00e0nh tr\u00ecnh (walk) ng\u1eafn nh\u1ea5t c\u00f3 \u0111\u1ed9 d\u00e0i ch\u1eb5n t\u1eeb m\u1ed9t \u0111\u1ec9nh ngu\u1ed3n $s$ \u0111\u1ebfn m\u1ed9t \u0111\u1ec9nh \u0111\u00edch $t$ trong m\u1ed9t \u0111\u1ed3 th\u1ecb kh\u00f4ng tr\u1ecdng s\u1ed1: \u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y, ch\u00fang ta ph\u1ea3i x\u00e2y d\u1ef1ng m\u1ed9t \u0111\u1ed3 th\u1ecb ph\u1ee5 tr\u1ee3, c\u00f3 c\u00e1c \u0111\u1ec9nh l\u00e0 tr\u1ea1ng th\u00e1i $(v, c)$, trong \u0111\u00f3 $v$ - n\u00fat hi\u1ec7n t\u1ea1i, $c = 0$ ho\u1eb7c $c = 1$ - t\u00ednh ch\u1eb5n l\u1ebb hi\u1ec7n t\u1ea1i. B\u1ea5t k\u1ef3 c\u1ea1nh $(u, v)$ n\u00e0o c\u1ee7a \u0111\u1ed3 th\u1ecb ban \u0111\u1ea7u trong c\u1ed9t m\u1edbi n\u00e0y s\u1ebd bi\u1ebfn th\u00e0nh hai c\u1ea1nh $((u, 0), (v, 1))$ v\u00e0 $((u, 1), (v, 0))$. Sau \u0111\u00f3, ch\u00fang ta ch\u1ea1y m\u1ed9t BFS \u0111\u1ec3 t\u00ecm h\u00e0nh tr\u00ecnh ng\u1eafn nh\u1ea5t t\u1eeb \u0111\u1ec9nh b\u1eaft \u0111\u1ea7u $(s, 0)$ \u0111\u1ebfn \u0111\u1ec9nh k\u1ebft th\u00fac $(t, 0)$.L\u01b0u \u00fd: M\u1ee5c n\u00e0y s\u1eed d\u1ee5ng thu\u1eadt ng\u1eef \"h\u00e0nh tr\u00ecnh\" (\"walk\") thay v\u00ec \"\u0111\u01b0\u1eddng \u0111i\" (\"path\") v\u00ec m\u1ed9t l\u00fd do, v\u00ec c\u00e1c \u0111\u1ec9nh c\u00f3 th\u1ec3 l\u1eb7p l\u1ea1i trong h\u00e0nh tr\u00ecnh t\u00ecm th\u1ea5y \u0111\u1ec3 l\u00e0m cho \u0111\u1ed9 d\u00e0i c\u1ee7a n\u00f3 ch\u1eb5n. B\u00e0i to\u00e1n t\u00ecm \u0111\u01b0\u1eddng \u0111i (path) ng\u1eafn nh\u1ea5t c\u00f3 \u0111\u1ed9 d\u00e0i ch\u1eb5n l\u00e0 NP-Complete trong c\u00e1c \u0111\u1ed3 th\u1ecb c\u00f3 h\u01b0\u1edbng, v\u00e0 c\u00f3 th\u1ec3 gi\u1ea3i quy\u1ebft trong th\u1eddi gian tuy\u1ebfn t\u00ednh trong c\u00e1c \u0111\u1ed3 th\u1ecb v\u00f4 h\u01b0\u1edbng, nh\u01b0ng v\u1edbi m\u1ed9t c\u00e1ch ti\u1ebfp c\u1eadn ph\u1ee9c t\u1ea1p h\u01a1n nhi\u1ec1u.</p> </li> </ul>","tags":["Translated"]},{"location":"graph/breadth-first-search.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>SPOJ: AKBAR</li> <li>SPOJ: NAKANJ</li> <li>SPOJ: WATER</li> <li>SPOJ: MICE AND MAZE</li> <li>Timus: Caravans</li> <li>DevSkill - Holloween Party (archived)</li> <li>DevSkill - Ohani And The Link Cut Tree (archived)</li> <li>SPOJ - Spiky Mazes</li> <li>SPOJ - Four Chips (hard)</li> <li>SPOJ - Inversion Sort</li> <li>Codeforces - Shortest Path</li> <li>SPOJ - Yet Another Multiple Problem</li> <li>UVA 11392 - Binary 3xType Multiple</li> <li>UVA 10968 - KuPellaKeS</li> <li>Codeforces - Police Stations</li> <li>Codeforces - Okabe and City</li> <li>SPOJ - Find the Treasure</li> <li>Codeforces - Bear and Forgotten Tree 2</li> <li>Codeforces - Cycle in Maze</li> <li>UVA - 11312 - Flipping Frustration</li> <li>SPOJ - Ada and Cycle</li> <li>CSES - Labyrinth</li> <li>CSES - Message Route</li> <li>CSES - Monsters</li> </ul>","tags":["Translated"]},{"location":"graph/bridge-searching-online.html","title":"T\u00ecm c\u1ea7u tr\u1ef1c tuy\u1ebfn (Finding Bridges Online)","text":"<p>Ch\u00fang ta \u0111\u01b0\u1ee3c cho m\u1ed9t \u0111\u1ed3 th\u1ecb v\u00f4 h\u01b0\u1edbng. M\u1ed9t c\u1ea7u (bridge) l\u00e0 m\u1ed9t c\u1ea1nh m\u00e0 vi\u1ec7c lo\u1ea1i b\u1ecf n\u00f3 l\u00e0m cho \u0111\u1ed3 th\u1ecb m\u1ea5t li\u00ean th\u00f4ng (ho\u1eb7c, ch\u00ednh x\u00e1c h\u01a1n l\u00e0 l\u00e0m t\u0103ng s\u1ed1 l\u01b0\u1ee3ng c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng). Nhi\u1ec7m v\u1ee5 c\u1ee7a ch\u00fang ta l\u00e0 t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c c\u1ea7u trong \u0111\u1ed3 th\u1ecb \u0111\u00e3 cho.</p> <p>M\u1ed9t c\u00e1ch kh\u00f4ng ch\u00ednh th\u1ee9c, nhi\u1ec7m v\u1ee5 n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c \u0111\u1eb7t ra nh\u01b0 sau: ch\u00fang ta ph\u1ea3i t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c con \u0111\u01b0\u1eddng \"quan tr\u1ecdng\" tr\u00ean b\u1ea3n \u0111\u1ed3 \u0111\u01b0\u1eddng b\u1ed9 \u0111\u00e3 cho, t\u1ee9c l\u00e0 nh\u1eefng con \u0111\u01b0\u1eddng m\u00e0 vi\u1ec7c lo\u1ea1i b\u1ecf b\u1ea5t k\u1ef3 con \u0111\u01b0\u1eddng n\u00e0o trong s\u1ed1 \u0111\u00f3 s\u1ebd d\u1eabn \u0111\u1ebfn vi\u1ec7c m\u1ed9t s\u1ed1 th\u00e0nh ph\u1ed1 kh\u00f4ng th\u1ec3 ti\u1ebfp c\u1eadn \u0111\u01b0\u1ee3c t\u1eeb nh\u1eefng th\u00e0nh ph\u1ed1 kh\u00e1c.</p> <p>\u0110\u00e3 c\u00f3 b\u00e0i vi\u1ebft T\u00ecm C\u1ea7u trong $O(N+M)$ gi\u1ea3i quy\u1ebft nhi\u1ec7m v\u1ee5 n\u00e0y b\u1eb1ng c\u00e1ch duy\u1ec7t T\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u (DFS). Thu\u1eadt to\u00e1n n\u00e0y s\u1ebd ph\u1ee9c t\u1ea1p h\u01a1n nhi\u1ec1u nh\u01b0ng n\u00f3 c\u00f3 m\u1ed9t l\u1ee3i th\u1ebf l\u1edbn: thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 trong b\u00e0i vi\u1ebft n\u00e0y ho\u1ea1t \u0111\u1ed9ng tr\u1ef1c tuy\u1ebfn (online), c\u00f3 ngh\u0129a l\u00e0 \u0111\u1ed3 th\u1ecb \u0111\u1ea7u v\u00e0o kh\u00f4ng c\u1ea7n ph\u1ea3i bi\u1ebft tr\u01b0\u1edbc. C\u00e1c c\u1ea1nh \u0111\u01b0\u1ee3c th\u00eam v\u00e0o t\u1eebng c\u00e1i m\u1ed9t, v\u00e0 sau m\u1ed7i l\u1ea7n th\u00eam, thu\u1eadt to\u00e1n s\u1ebd \u0111\u1ebfm l\u1ea1i t\u1ea5t c\u1ea3 c\u00e1c c\u1ea7u trong \u0111\u1ed3 th\u1ecb hi\u1ec7n t\u1ea1i. N\u00f3i c\u00e1ch kh\u00e1c, thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c thi\u1ebft k\u1ebf \u0111\u1ec3 ho\u1ea1t \u0111\u1ed9ng hi\u1ec7u qu\u1ea3 tr\u00ean m\u1ed9t \u0111\u1ed3 th\u1ecb \u0111\u1ed9ng, thay \u0111\u1ed5i.</p> <p>N\u00f3i m\u1ed9t c\u00e1ch ch\u00ednh x\u00e1c h\u01a1n, ph\u00e1t bi\u1ec3u c\u1ee7a b\u00e0i to\u00e1n nh\u01b0 sau: Ban \u0111\u1ea7u \u0111\u1ed3 th\u1ecb r\u1ed7ng v\u00e0 bao g\u1ed3m $n$ \u0111\u1ec9nh. Sau \u0111\u00f3, ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c c\u00e1c c\u1eb7p \u0111\u1ec9nh $(a, b)$, bi\u1ec3u th\u1ecb m\u1ed9t c\u1ea1nh \u0111\u01b0\u1ee3c th\u00eam v\u00e0o \u0111\u1ed3 th\u1ecb. Sau m\u1ed7i c\u1ea1nh nh\u1eadn \u0111\u01b0\u1ee3c, t\u1ee9c l\u00e0 sau khi th\u00eam m\u1ed7i c\u1ea1nh, h\u00e3y xu\u1ea5t ra s\u1ed1 l\u01b0\u1ee3ng c\u1ea7u hi\u1ec7n t\u1ea1i trong \u0111\u1ed3 th\u1ecb.</p> <p>C\u0169ng c\u00f3 th\u1ec3 duy tr\u00ec danh s\u00e1ch t\u1ea5t c\u1ea3 c\u00e1c c\u1ea7u c\u0169ng nh\u01b0 h\u1ed7 tr\u1ee3 r\u00f5 r\u00e0ng c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng 2 c\u1ea1nh (2-edge-connected components).</p> <p>Thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 b\u00ean d\u01b0\u1edbi ho\u1ea1t \u0111\u1ed9ng trong th\u1eddi gian $O(n \\log n + m)$, trong \u0111\u00f3 $m$ l\u00e0 s\u1ed1 c\u1ea1nh. Thu\u1eadt to\u00e1n d\u1ef1a tr\u00ean c\u1ea5u tr\u00fac d\u1eef li\u1ec7u Disjoint Set Union. Tuy nhi\u00ean, vi\u1ec7c c\u00e0i \u0111\u1eb7t trong b\u00e0i vi\u1ebft n\u00e0y t\u1ed1n th\u1eddi gian $O(n \\log n + m \\log n)$, v\u00ec n\u00f3 s\u1eed d\u1ee5ng phi\u00ean b\u1ea3n \u0111\u01a1n gi\u1ea3n h\u00f3a c\u1ee7a DSU kh\u00f4ng c\u00f3 Union by Rank (h\u1ee3p nh\u1ea5t theo h\u1ea1ng).</p>","tags":["Translated"]},{"location":"graph/bridge-searching-online.html#algorithm","title":"Thu\u1eadt to\u00e1n (Algorithm)","text":"<p>\u0110\u1ea7u ti\u00ean, h\u00e3y \u0111\u1ecbnh ngh\u0129a th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng 2 c\u1ea1nh (2-edge-connected component): \u0111\u00f3 l\u00e0 m\u1ed9t th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng v\u1eabn gi\u1eef nguy\u00ean t\u00ednh li\u00ean th\u00f4ng b\u1ea5t c\u1ee9 khi n\u00e0o b\u1ea1n lo\u1ea1i b\u1ecf \u00edt h\u01a1n $k$ c\u1ea1nh.</p> <p>R\u1ea5t d\u1ec5 th\u1ea5y r\u1eb1ng c\u00e1c c\u1ea7u ph\u00e2n chia \u0111\u1ed3 th\u1ecb th\u00e0nh c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng 2 c\u1ea1nh. N\u1ebfu ch\u00fang ta n\u00e9n m\u1ed7i th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng 2 c\u1ea1nh \u0111\u00f3 th\u00e0nh c\u00e1c \u0111\u1ec9nh v\u00e0 ch\u1ec9 \u0111\u1ec3 l\u1ea1i c\u00e1c c\u1ea7u l\u00e0m c\u00e1c c\u1ea1nh trong \u0111\u1ed3 th\u1ecb n\u00e9n, th\u00ec ch\u00fang ta thu \u0111\u01b0\u1ee3c m\u1ed9t \u0111\u1ed3 th\u1ecb kh\u00f4ng c\u00f3 chu tr\u00ecnh, t\u1ee9c l\u00e0 m\u1ed9t r\u1eebng (forest).</p> <p>Thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 d\u01b0\u1edbi \u0111\u00e2y duy tr\u00ec khu r\u1eebng n\u00e0y m\u1ed9t c\u00e1ch r\u00f5 r\u00e0ng c\u0169ng nh\u01b0 c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng 2 c\u1ea1nh.</p> <p>R\u00f5 r\u00e0ng l\u00e0 ban \u0111\u1ea7u, khi \u0111\u1ed3 th\u1ecb r\u1ed7ng, n\u00f3 ch\u1ee9a $n$ th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng 2 c\u1ea1nh, b\u1ea3n th\u00e2n ch\u00fang kh\u00f4ng \u0111\u01b0\u1ee3c k\u1ebft n\u1ed1i.</p> <p>Khi th\u00eam c\u1ea1nh ti\u1ebfp theo $(a, b)$, c\u00f3 th\u1ec3 x\u1ea3y ra ba t\u00ecnh hu\u1ed1ng:</p> <ul> <li> <p>C\u1ea3 hai \u0111\u1ec9nh $a$ v\u00e0 $b$ \u0111\u1ec1u n\u1eb1m trong c\u00f9ng m\u1ed9t th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng 2 c\u1ea1nh - khi \u0111\u00f3 c\u1ea1nh n\u00e0y kh\u00f4ng ph\u1ea3i l\u00e0 c\u1ea7u, v\u00e0 kh\u00f4ng thay \u0111\u1ed5i b\u1ea5t c\u1ee9 \u0111i\u1ec1u g\u00ec trong c\u1ea5u tr\u00fac r\u1eebng, v\u00ec v\u1eady ch\u00fang ta c\u00f3 th\u1ec3 b\u1ecf qua c\u1ea1nh n\u00e0y.</p> <p>Do \u0111\u00f3, trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y s\u1ed1 l\u01b0\u1ee3ng c\u1ea7u kh\u00f4ng thay \u0111\u1ed5i.</p> </li> <li> <p>C\u00e1c \u0111\u1ec9nh $a$ v\u00e0 $b$ n\u1eb1m trong c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng ho\u00e0n to\u00e0n kh\u00e1c nhau, t\u1ee9c l\u00e0 m\u1ed7i \u0111\u1ec9nh l\u00e0 m\u1ed9t ph\u1ea7n c\u1ee7a m\u1ed9t c\u00e2y kh\u00e1c nhau.     Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, c\u1ea1nh $(a, b)$ tr\u1edf th\u00e0nh m\u1ed9t c\u1ea7u m\u1edbi, v\u00e0 hai c\u00e2y n\u00e0y \u0111\u01b0\u1ee3c k\u1ebft h\u1ee3p th\u00e0nh m\u1ed9t (v\u00e0 t\u1ea5t c\u1ea3 c\u00e1c c\u1ea7u c\u0169 v\u1eabn c\u00f2n).</p> <p>Do \u0111\u00f3, trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, s\u1ed1 l\u01b0\u1ee3ng c\u1ea7u t\u0103ng th\u00eam m\u1ed9t.</p> </li> <li> <p>C\u00e1c \u0111\u1ec9nh $a$ v\u00e0 $b$ n\u1eb1m trong m\u1ed9t th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng, nh\u01b0ng n\u1eb1m trong c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng 2 c\u1ea1nh kh\u00e1c nhau.     Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, c\u1ea1nh n\u00e0y t\u1ea1o th\u00e0nh m\u1ed9t chu tr\u00ecnh c\u00f9ng v\u1edbi m\u1ed9t s\u1ed1 c\u1ea7u c\u0169.     T\u1ea5t c\u1ea3 c\u00e1c c\u1ea7u n\u00e0y k\u1ebft th\u00fac vi\u1ec7c l\u00e0 c\u1ea7u, v\u00e0 chu tr\u00ecnh k\u1ebft qu\u1ea3 ph\u1ea3i \u0111\u01b0\u1ee3c n\u00e9n th\u00e0nh m\u1ed9t th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng 2 c\u1ea1nh m\u1edbi.</p> <p>Do \u0111\u00f3, trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, s\u1ed1 l\u01b0\u1ee3ng c\u1ea7u gi\u1ea3m \u0111i m\u1ed9t ho\u1eb7c nhi\u1ec1u h\u01a1n.</p> </li> </ul> <p>Do \u0111\u00f3, to\u00e0n b\u1ed9 nhi\u1ec7m v\u1ee5 \u0111\u01b0\u1ee3c gi\u1ea3m xu\u1ed1ng th\u00e0nh vi\u1ec7c th\u1ef1c hi\u1ec7n hi\u1ec7u qu\u1ea3 t\u1ea5t c\u1ea3 c\u00e1c thao t\u00e1c n\u00e0y tr\u00ean r\u1eebng c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng 2 c\u1ea1nh.</p>","tags":["Translated"]},{"location":"graph/bridge-searching-online.html#data-structures-for-storing-the-forest","title":"C\u1ea5u tr\u00fac d\u1eef li\u1ec7u \u0111\u1ec3 l\u01b0u tr\u1eef r\u1eebng (Data Structures for storing the forest)","text":"<p>C\u1ea5u tr\u00fac d\u1eef li\u1ec7u duy nh\u1ea5t m\u00e0 ch\u00fang ta c\u1ea7n l\u00e0 Disjoint Set Union. Tr\u00ean th\u1ef1c t\u1ebf, ch\u00fang ta s\u1ebd t\u1ea1o hai b\u1ea3n sao c\u1ee7a c\u1ea5u tr\u00fac n\u00e0y: m\u1ed9t b\u1ea3n s\u1ebd l\u00e0 \u0111\u1ec3 duy tr\u00ec c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng (connected components), b\u1ea3n c\u00f2n l\u1ea1i \u0111\u1ec3 duy tr\u00ec c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng 2 c\u1ea1nh (2-edge-connected components). V\u00e0 ngo\u00e0i ra, ch\u00fang ta l\u01b0u tr\u1eef c\u1ea5u tr\u00fac c\u1ee7a c\u00e1c c\u00e2y trong r\u1eebng c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng 2 c\u1ea1nh th\u00f4ng qua c\u00e1c con tr\u1ecf: M\u1ed7i th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng 2 c\u1ea1nh s\u1ebd l\u01b0u tr\u1eef ch\u1ec9 s\u1ed1 <code>par[]</code> c\u1ee7a t\u1ed5 ti\u00ean c\u1ee7a n\u00f3 trong c\u00e2y.</p> <p>B\u00e2y gi\u1edd ch\u00fang ta s\u1ebd li\u00ean t\u1ee5c ph\u00e2n t\u00edch m\u1ecdi thao t\u00e1c m\u00e0 ch\u00fang ta c\u1ea7n h\u1ecdc c\u00e1ch c\u00e0i \u0111\u1eb7t:</p> <ul> <li> <p>Ki\u1ec3m tra xem li\u1ec7u hai \u0111\u1ec9nh c\u00f3 n\u1eb1m trong c\u00f9ng m\u1ed9t th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng / li\u00ean th\u00f4ng 2 c\u1ea1nh hay kh\u00f4ng.     N\u00f3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n v\u1edbi thu\u1eadt to\u00e1n DSU th\u00f4ng th\u01b0\u1eddng, ch\u00fang ta ch\u1ec9 c\u1ea7n t\u00ecm v\u00e0 so s\u00e1nh c\u00e1c \u0111\u1ea1i di\u1ec7n c\u1ee7a c\u00e1c DSU.</p> </li> <li> <p>N\u1ed1i hai c\u00e2y cho m\u1ed9t s\u1ed1 c\u1ea1nh $(a, b)$.     V\u00ec c\u00f3 th\u1ec3 x\u1ea3y ra tr\u01b0\u1eddng h\u1ee3p c\u1ea3 \u0111\u1ec9nh $a$ v\u00e0 \u0111\u1ec9nh $b$ \u0111\u1ec1u kh\u00f4ng ph\u1ea3i l\u00e0 g\u1ed1c c\u1ee7a c\u00e2y c\u1ee7a ch\u00fang, c\u00e1ch duy nh\u1ea5t \u0111\u1ec3 k\u1ebft n\u1ed1i hai c\u00e2y n\u00e0y l\u00e0 \u0111\u1ed5i g\u1ed1c (re-root) m\u1ed9t trong hai c\u00e2y.     V\u00ed d\u1ee5, b\u1ea1n c\u00f3 th\u1ec3 \u0111\u1ed5i g\u1ed1c c\u00e2y c\u1ee7a \u0111\u1ec9nh $a$, v\u00e0 sau \u0111\u00f3 g\u1eafn n\u00f3 v\u00e0o m\u1ed9t c\u00e2y kh\u00e1c b\u1eb1ng c\u00e1ch \u0111\u1eb7t t\u1ed5 ti\u00ean c\u1ee7a $a$ th\u00e0nh $b$.</p> <p>Tuy nhi\u00ean, c\u00e2u h\u1ecfi v\u1ec1 hi\u1ec7u qu\u1ea3 c\u1ee7a thao t\u00e1c \u0111\u1ed5i g\u1ed1c n\u1ea3y sinh: \u0111\u1ec3 \u0111\u1ed5i g\u1ed1c c\u00e2y v\u1edbi g\u1ed1c $r$ sang \u0111\u1ec9nh $v$, c\u1ea7n ph\u1ea3i th\u0103m t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh tr\u00ean \u0111\u01b0\u1eddng \u0111i gi\u1eefa $v$ v\u00e0 $r$ v\u00e0 chuy\u1ec3n h\u01b0\u1edbng c\u00e1c con tr\u1ecf <code>par[]</code> theo h\u01b0\u1edbng ng\u01b0\u1ee3c l\u1ea1i, v\u00e0 c\u0169ng thay \u0111\u1ed5i c\u00e1c tham chi\u1ebfu \u0111\u1ebfn c\u00e1c t\u1ed5 ti\u00ean trong DSU ch\u1ecbu tr\u00e1ch nhi\u1ec7m cho c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng.</p> <p>Do \u0111\u00f3, chi ph\u00ed c\u1ee7a vi\u1ec7c \u0111\u1ed5i g\u1ed1c l\u00e0 $O(h)$, trong \u0111\u00f3 $h$ l\u00e0 chi\u1ec1u cao c\u1ee7a c\u00e2y. B\u1ea1n c\u00f3 th\u1ec3 \u0111\u01b0a ra m\u1ed9t \u01b0\u1edbc t\u00ednh th\u1eadm ch\u00ed t\u1ed3i t\u1ec7 h\u01a1n b\u1eb1ng c\u00e1ch n\u00f3i r\u1eb1ng chi ph\u00ed l\u00e0 $O(\\text{size})$ trong \u0111\u00f3 $\\text{size}$ l\u00e0 s\u1ed1 l\u01b0\u1ee3ng \u0111\u1ec9nh trong c\u00e2y. \u0110\u1ed9 ph\u1ee9c t\u1ea1p cu\u1ed1i c\u00f9ng s\u1ebd kh\u00f4ng kh\u00e1c bi\u1ec7t.</p> <p>B\u00e2y gi\u1edd ch\u00fang ta \u00e1p d\u1ee5ng m\u1ed9t k\u1ef9 thu\u1eadt ti\u00eau chu\u1ea9n: ch\u00fang ta \u0111\u1ed5i g\u1ed1c c\u00e2y ch\u1ee9a \u00edt \u0111\u1ec9nh h\u01a1n. Sau \u0111\u00f3, theo tr\u1ef1c gi\u00e1c, tr\u01b0\u1eddng h\u1ee3p x\u1ea5u nh\u1ea5t l\u00e0 khi hai c\u00e2y c\u00f3 k\u00edch th\u01b0\u1edbc x\u1ea5p x\u1ec9 b\u1eb1ng nhau \u0111\u01b0\u1ee3c k\u1ebft h\u1ee3p, nh\u01b0ng sau \u0111\u00f3 k\u1ebft qu\u1ea3 l\u00e0 m\u1ed9t c\u00e2y c\u00f3 k\u00edch th\u01b0\u1edbc g\u1ea5p \u0111\u00f4i. \u0110i\u1ec1u n\u00e0y kh\u00f4ng cho ph\u00e9p t\u00ecnh hu\u1ed1ng n\u00e0y x\u1ea3y ra nhi\u1ec1u l\u1ea7n.</p> <p>N\u00f3i chung, t\u1ed5ng chi ph\u00ed c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c vi\u1ebft d\u01b0\u1edbi d\u1ea1ng truy h\u1ed3i:</p> $$ T(n) = \\max_{k = 1 \\ldots n-1} \\left\\{ T(k) + T(n - k) + O(\\min(k, n - k))\\right\\} $$ <p>$T(n)$ l\u00e0 s\u1ed1 l\u01b0\u1ee3ng thao t\u00e1c c\u1ea7n thi\u1ebft \u0111\u1ec3 c\u00f3 \u0111\u01b0\u1ee3c m\u1ed9t c\u00e2y v\u1edbi $n$ \u0111\u1ec9nh b\u1eb1ng c\u00e1ch \u0111\u1ed5i g\u1ed1c v\u00e0 h\u1ee3p nh\u1ea5t c\u00e1c c\u00e2y. M\u1ed9t c\u00e2y c\u00f3 k\u00edch th\u01b0\u1edbc $n$ c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u1ea1o ra b\u1eb1ng c\u00e1ch k\u1ebft h\u1ee3p hai c\u00e2y nh\u1ecf h\u01a1n c\u00f3 k\u00edch th\u01b0\u1edbc $k$ v\u00e0 $n - k$. C\u00f4ng th\u1ee9c truy h\u1ed3i n\u00e0y c\u00f3 l\u1eddi gi\u1ea3i $T(n) = O (n \\log n)$.</p> <p>Do \u0111\u00f3, t\u1ed5ng th\u1eddi gian d\u00e0nh cho t\u1ea5t c\u1ea3 c\u00e1c thao t\u00e1c \u0111\u1ed5i g\u1ed1c s\u1ebd l\u00e0 $O(n \\log n)$ n\u1ebfu ch\u00fang ta lu\u00f4n \u0111\u1ed5i g\u1ed1c c\u00e2y nh\u1ecf h\u01a1n trong hai c\u00e2y.</p> <p>Ch\u00fang ta s\u1ebd ph\u1ea3i duy tr\u00ec k\u00edch th\u01b0\u1edbc c\u1ee7a m\u1ed7i th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng, nh\u01b0ng c\u1ea5u tr\u00fac d\u1eef li\u1ec7u DSU l\u00e0m cho \u0111i\u1ec1u n\u00e0y tr\u1edf n\u00ean kh\u1ea3 thi m\u00e0 kh\u00f4ng g\u1eb7p kh\u00f3 kh\u0103n g\u00ec.</p> </li> <li> <p>T\u00ecm ki\u1ebfm chu tr\u00ecnh \u0111\u01b0\u1ee3c h\u00ecnh th\u00e0nh b\u1eb1ng c\u00e1ch th\u00eam m\u1ed9t c\u1ea1nh m\u1edbi $(a, b)$.     V\u00ec $a$ v\u00e0 $b$ \u0111\u00e3 \u0111\u01b0\u1ee3c k\u1ebft n\u1ed1i trong c\u00e2y n\u00ean ch\u00fang ta c\u1ea7n t\u00ecm T\u1ed5 ti\u00ean chung th\u1ea5p nh\u1ea5t (LCA) c\u1ee7a c\u00e1c \u0111\u1ec9nh $a$ v\u00e0 $b$.     Chu tr\u00ecnh s\u1ebd bao g\u1ed3m c\u00e1c \u0111\u01b0\u1eddng \u0111i t\u1eeb $b$ \u0111\u1ebfn LCA, t\u1eeb LCA \u0111\u1ebfn $a$ v\u00e0 c\u1ea1nh $a$ \u0111\u1ebfn $b$.</p> <p>Sau khi t\u00ecm th\u1ea5y chu tr\u00ecnh, ch\u00fang ta n\u00e9n t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh c\u1ee7a chu tr\u00ecnh \u0111\u01b0\u1ee3c ph\u00e1t hi\u1ec7n th\u00e0nh m\u1ed9t \u0111\u1ec9nh. \u0110i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 ch\u00fang ta \u0111\u00e3 c\u00f3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p t\u1ef7 l\u1ec7 thu\u1eadn v\u1edbi \u0111\u1ed9 d\u00e0i chu tr\u00ecnh, \u0111i\u1ec1u \u0111\u00f3 c\u00f3 ngh\u0129a l\u00e0 ch\u00fang ta c\u0169ng c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng b\u1ea5t k\u1ef3 thu\u1eadt to\u00e1n LCA n\u00e0o t\u1ef7 l\u1ec7 thu\u1eadn v\u1edbi \u0111\u1ed9 d\u00e0i v\u00e0 kh\u00f4ng c\u1ea7n ph\u1ea3i s\u1eed d\u1ee5ng b\u1ea5t k\u1ef3 thu\u1eadt to\u00e1n nhanh n\u00e0o.</p> <p>V\u00ec t\u1ea5t c\u1ea3 th\u00f4ng tin v\u1ec1 c\u1ea5u tr\u00fac c\u1ee7a c\u00e2y \u0111\u1ec1u c\u00f3 s\u1eb5n trong m\u1ea3ng t\u1ed5 ti\u00ean <code>par[]</code>, thu\u1eadt to\u00e1n LCA h\u1ee3p l\u00fd duy nh\u1ea5t l\u00e0 nh\u01b0 sau: \u0111\u00e1nh d\u1ea5u c\u00e1c \u0111\u1ec9nh $a$ v\u00e0 $b$ l\u00e0 \u0111\u00e3 th\u0103m, sau \u0111\u00f3 ch\u00fang ta \u0111i \u0111\u1ebfn t\u1ed5 ti\u00ean c\u1ee7a ch\u00fang <code>par[a]</code> v\u00e0 <code>par[b]</code> v\u00e0 \u0111\u00e1nh d\u1ea5u ch\u00fang, sau \u0111\u00f3 ti\u1ebfn \u0111\u1ebfn t\u1ed5 ti\u00ean c\u1ee7a ch\u00fang v\u00e0 c\u1ee9 th\u1ebf, cho \u0111\u1ebfn khi ch\u00fang ta \u0111\u1ebfn m\u1ed9t \u0111\u1ec9nh \u0111\u00e3 \u0111\u01b0\u1ee3c \u0111\u00e1nh d\u1ea5u. \u0110\u1ec9nh n\u00e0y l\u00e0 LCA m\u00e0 ch\u00fang ta \u0111ang t\u00ecm ki\u1ebfm, v\u00e0 ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm c\u00e1c \u0111\u1ec9nh tr\u00ean chu tr\u00ecnh b\u1eb1ng c\u00e1ch duy\u1ec7t l\u1ea1i \u0111\u01b0\u1eddng \u0111i t\u1eeb $a$ v\u00e0 $b$ \u0111\u1ebfn LCA.</p> <p>R\u00f5 r\u00e0ng l\u00e0 \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a thu\u1eadt to\u00e1n n\u00e0y t\u1ef7 l\u1ec7 thu\u1eadn v\u1edbi \u0111\u1ed9 d\u00e0i c\u1ee7a chu tr\u00ecnh mong mu\u1ed1n.</p> </li> <li> <p>N\u00e9n chu tr\u00ecnh b\u1eb1ng c\u00e1ch th\u00eam m\u1ed9t c\u1ea1nh m\u1edbi $(a, b)$ trong m\u1ed9t c\u00e2y.</p> <p>Ch\u00fang ta c\u1ea7n t\u1ea1o m\u1ed9t th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng 2 c\u1ea1nh m\u1edbi, bao g\u1ed3m t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh c\u1ee7a chu tr\u00ecnh \u0111\u01b0\u1ee3c ph\u00e1t hi\u1ec7n (chu tr\u00ecnh \u0111\u01b0\u1ee3c ph\u00e1t hi\u1ec7n c\u0169ng c\u00f3 th\u1ec3 bao g\u1ed3m m\u1ed9t s\u1ed1 th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng 2 c\u1ea1nh, nh\u01b0ng \u0111i\u1ec1u n\u00e0y kh\u00f4ng thay \u0111\u1ed5i b\u1ea5t c\u1ee9 \u0111i\u1ec1u g\u00ec). Ngo\u00e0i ra, c\u1ea7n ph\u1ea3i n\u00e9n ch\u00fang theo c\u00e1ch m\u00e0 c\u1ea5u tr\u00fac c\u1ee7a c\u00e2y kh\u00f4ng b\u1ecb x\u00e1o tr\u1ed9n, v\u00e0 t\u1ea5t c\u1ea3 c\u00e1c con tr\u1ecf <code>par[]</code> v\u00e0 hai DSU v\u1eabn ch\u00ednh x\u00e1c.</p> <p>C\u00e1ch d\u1ec5 nh\u1ea5t \u0111\u1ec3 \u0111\u1ea1t \u0111\u01b0\u1ee3c \u0111i\u1ec1u n\u00e0y l\u00e0 n\u00e9n t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh c\u1ee7a chu tr\u00ecnh v\u00e0o LCA c\u1ee7a ch\u00fang. Tr\u00ean th\u1ef1c t\u1ebf, LCA l\u00e0 \u0111\u1ec9nh cao nh\u1ea5t trong s\u1ed1 c\u00e1c \u0111\u1ec9nh, t\u1ee9c l\u00e0 con tr\u1ecf t\u1ed5 ti\u00ean <code>par[]</code> c\u1ee7a n\u00f3 v\u1eabn kh\u00f4ng thay \u0111\u1ed5i. \u0110\u1ed1i v\u1edbi t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh kh\u00e1c c\u1ee7a v\u00f2ng l\u1eb7p, c\u00e1c t\u1ed5 ti\u00ean kh\u00f4ng c\u1ea7n c\u1eadp nh\u1eadt, v\u00ec c\u00e1c \u0111\u1ec9nh n\u00e0y \u0111\u01a1n gi\u1ea3n l\u00e0 kh\u00f4ng c\u00f2n t\u1ed3n t\u1ea1i n\u1eefa. Nh\u01b0ng trong DSU c\u1ee7a c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng 2 c\u1ea1nh, t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh n\u00e0y s\u1ebd ch\u1ec9 tr\u1ecf \u0111\u1ebfn LCA.</p> <p>Ch\u00fang ta s\u1ebd c\u00e0i \u0111\u1eb7t DSU c\u1ee7a c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng 2 c\u1ea1nh m\u00e0 kh\u00f4ng c\u1ea7n t\u1ed1i \u01b0u h\u00f3a Union by rank, do \u0111\u00f3 ch\u00fang ta s\u1ebd nh\u1eadn \u0111\u01b0\u1ee3c \u0111\u1ed9 ph\u1ee9c t\u1ea1p trung b\u00ecnh l\u00e0 $O(\\log n)$ cho m\u1ed7i truy v\u1ea5n. \u0110\u1ec3 \u0111\u1ea1t \u0111\u01b0\u1ee3c \u0111\u1ed9 ph\u1ee9c t\u1ea1p trung b\u00ecnh l\u00e0 $O(1)$ cho m\u1ed7i truy v\u1ea5n, ch\u00fang ta c\u1ea7n k\u1ebft h\u1ee3p c\u00e1c \u0111\u1ec9nh c\u1ee7a chu tr\u00ecnh theo Union by rank, v\u00e0 sau \u0111\u00f3 g\u00e1n <code>par[]</code> cho ph\u00f9 h\u1ee3p.</p> </li> </ul>","tags":["Translated"]},{"location":"graph/bridge-searching-online.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 c\u00e0i \u0111\u1eb7t cu\u1ed1i c\u00f9ng c\u1ee7a to\u00e0n b\u1ed9 thu\u1eadt to\u00e1n.</p> <p>Nh\u01b0 \u0111\u00e3 \u0111\u1ec1 c\u1eadp tr\u01b0\u1edbc \u0111\u00f3, \u0111\u1ec3 \u0111\u01a1n gi\u1ea3n, DSU c\u1ee7a c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng 2 c\u1ea1nh \u0111\u01b0\u1ee3c vi\u1ebft m\u00e0 kh\u00f4ng c\u00f3 Union by rank, do \u0111\u00f3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p k\u1ebft qu\u1ea3 s\u1ebd l\u00e0 trung b\u00ecnh $O(\\log n)$.</p> <p>Ngo\u00e0i ra trong c\u00e0i \u0111\u1eb7t n\u00e0y, b\u1ea3n th\u00e2n c\u00e1c c\u1ea7u kh\u00f4ng \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef, ch\u1ec9 c\u00f3 s\u1ed1 l\u01b0\u1ee3ng c\u1ee7a ch\u00fang <code>bridges</code>. Tuy nhi\u00ean, s\u1ebd kh\u00f4ng kh\u00f3 \u0111\u1ec3 t\u1ea1o m\u1ed9t <code>set</code> c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c c\u1ea7u.</p> <p>Ban \u0111\u1ea7u b\u1ea1n g\u1ecdi h\u00e0m <code>init()</code>, kh\u1edfi t\u1ea1o hai DSU (t\u1ea1o m\u1ed9t t\u1eadp h\u1ee3p ri\u00eang cho m\u1ed7i \u0111\u1ec9nh v\u00e0 \u0111\u1eb7t k\u00edch th\u01b0\u1edbc b\u1eb1ng m\u1ed9t), v\u00e0 \u0111\u1eb7t c\u00e1c t\u1ed5 ti\u00ean <code>par</code>.</p> <p>H\u00e0m ch\u00ednh l\u00e0 <code>add_edge(a, b)</code>, x\u1eed l\u00fd v\u00e0 th\u00eam m\u1ed9t c\u1ea1nh m\u1edbi.</p> <pre><code>vector&lt;int&gt; par, dsu_2ecc, dsu_cc, dsu_cc_size;\nint bridges;\nint lca_iteration;\nvector&lt;int&gt; last_visit;\n\nvoid init(int n) {\n    par.resize(n);\n    dsu_2ecc.resize(n);\n    dsu_cc.resize(n);\n    dsu_cc_size.resize(n);\n    lca_iteration = 0;\n    last_visit.assign(n, 0);\n    for (int i=0; i&lt;n; ++i) {\n        dsu_2ecc[i] = i;\n        dsu_cc[i] = i;\n        dsu_cc_size[i] = 1;\n        par[i] = -1;\n    }\n    bridges = 0;\n}\n\nint find_2ecc(int v) {\n    if (v == -1)\n        return -1;\n    return dsu_2ecc[v] == v ? v : dsu_2ecc[v] = find_2ecc(dsu_2ecc[v]);\n}\n\nint find_cc(int v) {\n    v = find_2ecc(v);\n    return dsu_cc[v] == v ? v : dsu_cc[v] = find_cc(dsu_cc[v]);\n}\n\nvoid make_root(int v) {\n    int root = v;\n    int child = -1;\n    while (v != -1) {\n        int p = find_2ecc(par[v]);\n        par[v] = child;\n        dsu_cc[v] = root;\n        child = v;\n        v = p;\n    }\n    dsu_cc_size[root] = dsu_cc_size[child];\n}\n\nvoid merge_path (int a, int b) {\n    ++lca_iteration;\n    vector&lt;int&gt; path_a, path_b;\n    int lca = -1;\n    while (lca == -1) {\n        if (a != -1) {\n            a = find_2ecc(a);\n            path_a.push_back(a);\n            if (last_visit[a] == lca_iteration){\n                lca = a;\n                break;\n                }\n            last_visit[a] = lca_iteration;\n            a = par[a];\n        }\n        if (b != -1) {\n            b = find_2ecc(b);\n            path_b.push_back(b);\n            if (last_visit[b] == lca_iteration){\n                lca = b;\n                break;\n                }\n            last_visit[b] = lca_iteration;\n            b = par[b];\n        }\n\n    }\n\n    for (int v : path_a) {\n        dsu_2ecc[v] = lca;\n        if (v == lca)\n            break;\n        --bridges;\n    }\n    for (int v : path_b) {\n        dsu_2ecc[v] = lca;\n        if (v == lca)\n            break;\n        --bridges;\n    }\n}\n\nvoid add_edge(int a, int b) {\n    a = find_2ecc(a);\n    b = find_2ecc(b);\n    if (a == b)\n        return;\n\n    int ca = find_cc(a);\n    int cb = find_cc(b);\n\n    if (ca != cb) {\n        ++bridges;\n        if (dsu_cc_size[ca] &gt; dsu_cc_size[cb]) {\n            swap(a, b);\n            swap(ca, cb);\n        }\n        make_root(a);\n        par[a] = dsu_cc[a] = b;\n        dsu_cc_size[cb] += dsu_cc_size[a];\n    } else {\n        merge_path(a, b);\n    }\n}\n</code></pre> <p>DSU cho c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng 2 c\u1ea1nh \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef trong vector <code>dsu_2ecc</code>, v\u00e0 h\u00e0m tr\u1ea3 v\u1ec1 \u0111\u1ea1i di\u1ec7n l\u00e0 <code>find_2ecc(v)</code>. H\u00e0m n\u00e0y \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng nhi\u1ec1u l\u1ea7n trong ph\u1ea7n c\u00f2n l\u1ea1i c\u1ee7a m\u00e3, v\u00ec sau khi n\u00e9n m\u1ed9t s\u1ed1 \u0111\u1ec9nh th\u00e0nh m\u1ed9t, t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh n\u00e0y kh\u00f4ng c\u00f2n t\u1ed3n t\u1ea1i n\u1eefa v\u00e0 thay v\u00e0o \u0111\u00f3 ch\u1ec9 c\u00f3 ng\u01b0\u1eddi l\u00e3nh \u0111\u1ea1o c\u00f3 t\u1ed5 ti\u00ean <code>par</code> ch\u00ednh x\u00e1c trong r\u1eebng c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng 2 c\u1ea1nh.</p> <p>DSU cho c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef trong vector <code>dsu_cc</code>, v\u00e0 c\u0169ng c\u00f3 m\u1ed9t vector b\u1ed5 sung <code>dsu_cc_size</code> \u0111\u1ec3 l\u01b0u tr\u1eef k\u00edch th\u01b0\u1edbc th\u00e0nh ph\u1ea7n. H\u00e0m <code>find_cc(v)</code> tr\u1ea3 v\u1ec1 ng\u01b0\u1eddi l\u00e3nh \u0111\u1ea1o c\u1ee7a th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng (th\u1ef1c ra l\u00e0 g\u1ed1c c\u1ee7a c\u00e2y).</p> <p>Vi\u1ec7c \u0111\u1ed5i g\u1ed1c c\u1ee7a m\u1ed9t c\u00e2y <code>make_root(v)</code> ho\u1ea1t \u0111\u1ed9ng nh\u01b0 m\u00f4 t\u1ea3 \u1edf tr\u00ean: n\u00f3 \u0111i t\u1eeb \u0111\u1ec9nh $v$ qua c\u00e1c t\u1ed5 ti\u00ean \u0111\u1ebfn \u0111\u1ec9nh g\u1ed1c, m\u1ed7i l\u1ea7n chuy\u1ec3n h\u01b0\u1edbng t\u1ed5 ti\u00ean <code>par</code> theo h\u01b0\u1edbng ng\u01b0\u1ee3c l\u1ea1i. Li\u00ean k\u1ebft \u0111\u1ebfn \u0111\u1ea1i di\u1ec7n c\u1ee7a th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng <code>dsu_cc</code> c\u0169ng \u0111\u01b0\u1ee3c c\u1eadp nh\u1eadt, \u0111\u1ec3 n\u00f3 tr\u1ecf \u0111\u1ebfn \u0111\u1ec9nh g\u1ed1c m\u1edbi. Sau khi \u0111\u1ed5i g\u1ed1c, ch\u00fang ta ph\u1ea3i g\u00e1n cho g\u1ed1c m\u1edbi k\u00edch th\u01b0\u1edbc ch\u00ednh x\u00e1c c\u1ee7a th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng. Ngo\u00e0i ra, ch\u00fang ta ph\u1ea3i c\u1ea9n th\u1eadn g\u1ecdi <code>find_2ecc()</code> \u0111\u1ec3 l\u1ea5y c\u00e1c \u0111\u1ea1i di\u1ec7n c\u1ee7a th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng 2 c\u1ea1nh, thay v\u00ec m\u1ed9t s\u1ed1 \u0111\u1ec9nh kh\u00e1c \u0111\u00e3 b\u1ecb n\u00e9n.</p> <p>H\u00e0m t\u00ecm chu tr\u00ecnh v\u00e0 n\u00e9n <code>merge_path(a, b)</code> c\u0169ng \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n nh\u01b0 m\u00f4 t\u1ea3 \u1edf tr\u00ean. N\u00f3 t\u00ecm ki\u1ebfm LCA c\u1ee7a $a$ v\u00e0 $b$ b\u1eb1ng c\u00e1ch n\u00e2ng c\u00e1c n\u00fat n\u00e0y song song, cho \u0111\u1ebfn khi ch\u00fang ta g\u1eb7p m\u1ed9t \u0111\u1ec9nh l\u1ea7n th\u1ee9 hai. V\u00ec m\u1ee5c \u0111\u00edch hi\u1ec7u qu\u1ea3, ch\u00fang ta ch\u1ecdn m\u1ed9t \u0111\u1ecbnh danh duy nh\u1ea5t cho m\u1ed7i cu\u1ed9c g\u1ecdi t\u00ecm LCA v\u00e0 \u0111\u00e1nh d\u1ea5u c\u00e1c \u0111\u1ec9nh \u0111\u00e3 \u0111i qua b\u1eb1ng n\u00f3. Thao t\u00e1c n\u00e0y ho\u1ea1t \u0111\u1ed9ng trong $O(1)$, trong khi c\u00e1c ph\u01b0\u01a1ng ph\u00e1p kh\u00e1c nh\u01b0 s\u1eed d\u1ee5ng <code>set</code> th\u1ef1c hi\u1ec7n k\u00e9m h\u01a1n. C\u00e1c \u0111\u01b0\u1eddng d\u1eabn \u0111\u00e3 qua \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef trong c\u00e1c vector <code>path_a</code> v\u00e0 <code>path_b</code>, v\u00e0 ch\u00fang ta s\u1eed d\u1ee5ng ch\u00fang \u0111\u1ec3 duy\u1ec7t qua ch\u00fang l\u1ea7n th\u1ee9 hai l\u00ean \u0111\u1ebfn LCA, qua \u0111\u00f3 thu \u0111\u01b0\u1ee3c t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh c\u1ee7a chu tr\u00ecnh. T\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh c\u1ee7a chu tr\u00ecnh \u0111\u01b0\u1ee3c n\u00e9n b\u1eb1ng c\u00e1ch g\u1eafn ch\u00fang v\u00e0o LCA, do \u0111\u00f3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p trung b\u00ecnh l\u00e0 $O(\\log n)$ (v\u00ec ch\u00fang ta kh\u00f4ng s\u1eed d\u1ee5ng Union by rank). T\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh ch\u00fang ta \u0111i qua \u0111\u1ec1u l\u00e0 c\u00e1c c\u1ea7u, v\u00ec v\u1eady ch\u00fang ta tr\u1eeb 1 cho m\u1ed7i c\u1ea1nh trong chu tr\u00ecnh.</p> <p>Cu\u1ed1i c\u00f9ng, h\u00e0m truy v\u1ea5n <code>add_edge(a, b)</code> x\u00e1c \u0111\u1ecbnh c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u00e0 c\u00e1c \u0111\u1ec9nh $a$ v\u00e0 $b$ n\u1eb1m trong \u0111\u00f3. N\u1ebfu ch\u00fang n\u1eb1m trong c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng kh\u00e1c nhau, th\u00ec m\u1ed9t c\u00e2y nh\u1ecf h\u01a1n s\u1ebd \u0111\u01b0\u1ee3c \u0111\u1ed5i g\u1ed1c v\u00e0 sau \u0111\u00f3 g\u1eafn v\u00e0o c\u00e2y l\u1edbn h\u01a1n. Ng\u01b0\u1ee3c l\u1ea1i n\u1ebfu c\u00e1c \u0111\u1ec9nh $a$ v\u00e0 $b$ n\u1eb1m trong m\u1ed9t c\u00e2y, nh\u01b0ng trong c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng 2 c\u1ea1nh kh\u00e1c nhau, th\u00ec h\u00e0m <code>merge_path(a, b)</code> \u0111\u01b0\u1ee3c g\u1ecdi, h\u00e0m n\u00e0y s\u1ebd ph\u00e1t hi\u1ec7n chu tr\u00ecnh v\u00e0 n\u00e9n n\u00f3 th\u00e0nh m\u1ed9t th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng 2 c\u1ea1nh.</p>","tags":["Translated"]},{"location":"graph/bridge-searching.html","title":"T\u00ecm c\u1ea7u trong \u0111\u1ed3 th\u1ecb $O(N+M)$ (Finding bridges in a graph in $O(N+M)$)","text":"<p>Ch\u00fang ta \u0111\u01b0\u1ee3c cho m\u1ed9t \u0111\u1ed3 th\u1ecb v\u00f4 h\u01b0\u1edbng. M\u1ed9t c\u1ea1nh c\u1ea7u (bridge) \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a l\u00e0 m\u1ed9t c\u1ea1nh m\u00e0 khi b\u1ecb lo\u1ea1i b\u1ecf, l\u00e0m cho \u0111\u1ed3 th\u1ecb m\u1ea5t li\u00ean th\u00f4ng (ho\u1eb7c ch\u00ednh x\u00e1c h\u01a1n l\u00e0 l\u00e0m t\u0103ng s\u1ed1 l\u01b0\u1ee3ng c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng trong \u0111\u1ed3 th\u1ecb). Nhi\u1ec7m v\u1ee5 l\u00e0 t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c c\u1ea7u trong \u0111\u1ed3 th\u1ecb \u0111\u00e3 cho.</p> <p>M\u1ed9t c\u00e1ch kh\u00f4ng ch\u00ednh th\u1ee9c, b\u00e0i to\u00e1n \u0111\u01b0\u1ee3c ph\u00e1t bi\u1ec3u nh\u01b0 sau: cho m\u1ed9t b\u1ea3n \u0111\u1ed3 c\u00e1c th\u00e0nh ph\u1ed1 \u0111\u01b0\u1ee3c k\u1ebft n\u1ed1i v\u1edbi nhau b\u1eb1ng c\u00e1c con \u0111\u01b0\u1eddng, h\u00e3y t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c con \u0111\u01b0\u1eddng \"quan tr\u1ecdng\", t\u1ee9c l\u00e0 c\u00e1c con \u0111\u01b0\u1eddng m\u00e0 khi b\u1ecb lo\u1ea1i b\u1ecf, s\u1ebd l\u00e0m m\u1ea5t \u0111i \u0111\u01b0\u1eddng \u0111i gi\u1eefa m\u1ed9t c\u1eb7p th\u00e0nh ph\u1ed1 n\u00e0o \u0111\u00f3.</p> <p>Thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 \u1edf \u0111\u00e2y d\u1ef1a tr\u00ean t\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u v\u00e0 c\u00f3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p $O(N+M)$, trong \u0111\u00f3 $N$ l\u00e0 s\u1ed1 l\u01b0\u1ee3ng \u0111\u1ec9nh v\u00e0 $M$ l\u00e0 s\u1ed1 l\u01b0\u1ee3ng c\u1ea1nh trong \u0111\u1ed3 th\u1ecb.</p> <p>L\u01b0u \u00fd r\u1eb1ng c\u0169ng c\u00f3 b\u00e0i vi\u1ebft T\u00ecm C\u1ea7u Online - kh\u00f4ng gi\u1ed1ng nh\u01b0 thu\u1eadt to\u00e1n offline \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 \u1edf \u0111\u00e2y, thu\u1eadt to\u00e1n online c\u00f3 th\u1ec3 duy tr\u00ec danh s\u00e1ch t\u1ea5t c\u1ea3 c\u00e1c c\u1ea7u trong m\u1ed9t \u0111\u1ed3 th\u1ecb \u0111ang thay \u0111\u1ed5i (v\u1edbi gi\u1ea3 \u0111\u1ecbnh r\u1eb1ng lo\u1ea1i thay \u0111\u1ed5i duy nh\u1ea5t l\u00e0 th\u00eam c\u00e1c c\u1ea1nh m\u1edbi).</p>","tags":["Translated"]},{"location":"graph/bridge-searching.html#algorithm","title":"Thu\u1eadt to\u00e1n (Algorithm)","text":"<p>Ch\u1ecdn m\u1ed9t \u0111\u1ec9nh b\u1ea5t k\u1ef3 c\u1ee7a \u0111\u1ed3 th\u1ecb l\u00e0m $root$ v\u00e0 ch\u1ea1y t\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u t\u1eeb n\u00f3. L\u01b0u \u00fd th\u1ef1c t\u1ebf sau \u0111\u00e2y (d\u1ec5 d\u00e0ng ch\u1ee9ng minh):</p> <ul> <li>Gi\u1ea3 s\u1eed ch\u00fang ta \u0111ang \u1edf trong DFS, xem x\u00e9t c\u00e1c c\u1ea1nh b\u1eaft \u0111\u1ea7u t\u1eeb \u0111\u1ec9nh $v$. C\u1ea1nh hi\u1ec7n t\u1ea1i $(v, to)$ l\u00e0 m\u1ed9t c\u1ea7u khi v\u00e0 ch\u1ec9 khi kh\u00f4ng c\u00f3 \u0111\u1ec9nh n\u00e0o trong s\u1ed1 c\u00e1c \u0111\u1ec9nh $to$ v\u00e0 c\u00e1c h\u1eadu du\u1ec7 c\u1ee7a n\u00f3 trong c\u00e2y duy\u1ec7t DFS c\u00f3 c\u1ea1nh ng\u01b0\u1ee3c (back-edge) \u0111\u1ebfn \u0111\u1ec9nh $v$ ho\u1eb7c b\u1ea5t k\u1ef3 t\u1ed5 ti\u00ean n\u00e0o c\u1ee7a n\u00f3. Th\u1eadt v\u1eady, \u0111i\u1ec1u ki\u1ec7n n\u00e0y c\u00f3 ngh\u0129a l\u00e0 kh\u00f4ng c\u00f3 c\u00e1ch n\u00e0o kh\u00e1c t\u1eeb $v$ \u0111\u1ebfn $to$ ngo\u1ea1i tr\u1eeb c\u1ea1nh $(v, to)$.</li> </ul> <p>B\u00e2y gi\u1edd ch\u00fang ta ph\u1ea3i h\u1ecdc c\u00e1ch ki\u1ec3m tra th\u1ef1c t\u1ebf n\u00e0y cho m\u1ed7i \u0111\u1ec9nh m\u1ed9t c\u00e1ch hi\u1ec7u qu\u1ea3. Ch\u00fang ta s\u1ebd s\u1eed d\u1ee5ng \"th\u1eddi gian v\u00e0o n\u00fat\" (time of entry into node) \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n b\u1edfi t\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u.</p> <p>V\u00ec v\u1eady, h\u00e3y \u0111\u1ec3 $\\mathtt{tin}[v]$ bi\u1ec3u th\u1ecb th\u1eddi gian v\u00e0o n\u00fat $v$. Ch\u00fang ta gi\u1edbi thi\u1ec7u m\u1ed9t m\u1ea3ng $\\mathtt{low}$ cho ph\u00e9p ch\u00fang ta l\u01b0u tr\u1eef th\u1eddi gian v\u00e0o s\u1edbm nh\u1ea5t c\u1ee7a n\u00fat \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y trong t\u00ecm ki\u1ebfm DFS m\u00e0 m\u1ed9t n\u00fat $v$ c\u00f3 th\u1ec3 truy c\u1eadp v\u1edbi m\u1ed9t c\u1ea1nh duy nh\u1ea5t t\u1eeb ch\u00ednh n\u00f3 ho\u1eb7c c\u00e1c h\u1eadu du\u1ec7 c\u1ee7a n\u00f3. $\\mathtt{low}[v]$ l\u00e0 gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t c\u1ee7a $\\mathtt{tin}[v]$, th\u1eddi gian v\u00e0o $\\mathtt{tin}[p]$ cho m\u1ed7i n\u00fat $p$ \u0111\u01b0\u1ee3c k\u1ebft n\u1ed1i v\u1edbi n\u00fat $v$ th\u00f4ng qua m\u1ed9t c\u1ea1nh ng\u01b0\u1ee3c $(v, p)$ v\u00e0 c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a $\\mathtt{low}[to]$ cho m\u1ed7i \u0111\u1ec9nh $to$ l\u00e0 h\u1eadu du\u1ec7 tr\u1ef1c ti\u1ebfp c\u1ee7a $v$ trong c\u00e2y DFS:</p> $$\\mathtt{low}[v] = \\min \\left\\{      \\begin{array}{l}     \\mathtt{tin}[v] \\\\      \\mathtt{tin}[p]  &amp;\\text{ cho t\u1ea5t c\u1ea3 }p\\text{ m\u00e0 }(v, p)\\text{ l\u00e0 m\u1ed9t c\u1ea1nh ng\u01b0\u1ee3c} \\\\      \\mathtt{low}[to] &amp;\\text{ cho t\u1ea5t c\u1ea3 }to\\text{ m\u00e0 }(v, to)\\text{ l\u00e0 m\u1ed9t c\u1ea1nh c\u00e2y}     \\end{array} \\right\\}$$ <p>B\u00e2y gi\u1edd, c\u00f3 m\u1ed9t c\u1ea1nh ng\u01b0\u1ee3c t\u1eeb \u0111\u1ec9nh $v$ ho\u1eb7c m\u1ed9t trong nh\u1eefng h\u1eadu du\u1ec7 c\u1ee7a n\u00f3 \u0111\u1ebfn m\u1ed9t trong nh\u1eefng t\u1ed5 ti\u00ean c\u1ee7a n\u00f3 khi v\u00e0 ch\u1ec9 khi \u0111\u1ec9nh $v$ c\u00f3 m\u1ed9t \u0111\u1ee9a con $to$ m\u00e0 $\\mathtt{low}[to] \\leq \\mathtt{tin}[v]$. N\u1ebfu $\\mathtt{low}[to] = \\mathtt{tin}[v]$, c\u1ea1nh ng\u01b0\u1ee3c \u0111i tr\u1ef1c ti\u1ebfp \u0111\u1ebfn $v$, ng\u01b0\u1ee3c l\u1ea1i n\u00f3 \u0111i \u0111\u1ebfn m\u1ed9t trong c\u00e1c t\u1ed5 ti\u00ean c\u1ee7a $v$.</p> <p>Do \u0111\u00f3, c\u1ea1nh hi\u1ec7n t\u1ea1i $(v, to)$ trong c\u00e2y DFS l\u00e0 m\u1ed9t c\u1ea7u khi v\u00e0 ch\u1ec9 khi $\\mathtt{low}[to] &gt; \\mathtt{tin}[v]$.</p>","tags":["Translated"]},{"location":"graph/bridge-searching.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>C\u00e0i \u0111\u1eb7t c\u1ea7n ph\u00e2n bi\u1ec7t ba tr\u01b0\u1eddng h\u1ee3p: khi ch\u00fang ta \u0111i xu\u1ed1ng c\u1ea1nh trong c\u00e2y DFS, khi ch\u00fang ta t\u00ecm th\u1ea5y m\u1ed9t c\u1ea1nh ng\u01b0\u1ee3c \u0111\u1ebfn t\u1ed5 ti\u00ean c\u1ee7a \u0111\u1ec9nh v\u00e0 khi ch\u00fang ta quay tr\u1edf l\u1ea1i cha c\u1ee7a \u0111\u1ec9nh. \u0110\u00e2y l\u00e0 c\u00e1c tr\u01b0\u1eddng h\u1ee3p:</p> <ul> <li>$\\mathtt{visited}[to] = false$ - c\u1ea1nh l\u00e0 m\u1ed9t ph\u1ea7n c\u1ee7a c\u00e2y DFS;</li> <li>$\\mathtt{visited}[to] = true$ &amp;&amp; $to \\neq parent$ - c\u1ea1nh l\u00e0 c\u1ea1nh ng\u01b0\u1ee3c \u0111\u1ebfn m\u1ed9t trong c\u00e1c t\u1ed5 ti\u00ean;</li> <li>$to = parent$ - c\u1ea1nh d\u1eabn quay l\u1ea1i cha trong c\u00e2y DFS.</li> </ul> <p>\u0110\u1ec3 c\u00e0i \u0111\u1eb7t \u0111i\u1ec1u n\u00e0y, ch\u00fang ta c\u1ea7n m\u1ed9t h\u00e0m t\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u ch\u1ea5p nh\u1eadn \u0111\u1ec9nh cha c\u1ee7a n\u00fat hi\u1ec7n t\u1ea1i.</p> <p>\u0110\u1ed1i v\u1edbi c\u00e1c tr\u01b0\u1eddng h\u1ee3p \u0111a c\u1ea1nh (multiple edges), ch\u00fang ta c\u1ea7n c\u1ea9n th\u1eadn khi b\u1ecf qua c\u1ea1nh t\u1eeb cha. \u0110\u1ec3 gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 n\u00e0y, ch\u00fang ta c\u00f3 th\u1ec3 th\u00eam m\u1ed9t c\u1edd <code>parent_skipped</code> \u0111\u1ec3 \u0111\u1ea3m b\u1ea3o ch\u00fang ta ch\u1ec9 b\u1ecf qua cha m\u1ed9t l\u1ea7n.</p> <pre><code>void IS_BRIDGE(int v,int to); // m\u1ed9t s\u1ed1 h\u00e0m \u0111\u1ec3 x\u1eed l\u00fd c\u1ea7u \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y\nint n; // s\u1ed1 l\u01b0\u1ee3ng n\u00fat\nvector&lt;vector&lt;int&gt;&gt; adj; // danh s\u00e1ch k\u1ec1 c\u1ee7a \u0111\u1ed3 th\u1ecb\n\nvector&lt;bool&gt; visited;\nvector&lt;int&gt; tin, low;\nint timer;\n\nvoid dfs(int v, int p = -1) {\n    visited[v] = true;\n    tin[v] = low[v] = timer++;\n    bool parent_skipped = false;\n    for (int to : adj[v]) {\n        if (to == p &amp;&amp; !parent_skipped) {\n            parent_skipped = true;\n            continue;\n        }\n        if (visited[to]) {\n            low[v] = min(low[v], tin[to]);\n        } else {\n            dfs(to, v);\n            low[v] = min(low[v], low[to]);\n            if (low[to] &gt; tin[v])\n                IS_BRIDGE(v, to);\n        }\n    }\n}\n\nvoid find_bridges() {\n    timer = 0;\n    visited.assign(n, false);\n    tin.assign(n, -1);\n    low.assign(n, -1);\n    for (int i = 0; i &lt; n; ++i) {\n        if (!visited[i])\n            dfs(i);\n    }\n}\n</code></pre> <p>H\u00e0m ch\u00ednh l\u00e0 <code>find_bridges</code>; n\u00f3 th\u1ef1c hi\u1ec7n kh\u1edfi t\u1ea1o c\u1ea7n thi\u1ebft v\u00e0 b\u1eaft \u0111\u1ea7u t\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u trong m\u1ed7i th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng c\u1ee7a \u0111\u1ed3 th\u1ecb.</p> <p>H\u00e0m <code>IS_BRIDGE(a, b)</code> l\u00e0 m\u1ed9t s\u1ed1 h\u00e0m s\u1ebd x\u1eed l\u00fd th\u1ef1c t\u1ebf r\u1eb1ng c\u1ea1nh $(a, b)$ l\u00e0 m\u1ed9t c\u1ea7u, v\u00ed d\u1ee5, in n\u00f3 ra.</p> <p>L\u01b0u \u00fd r\u1eb1ng c\u00e0i \u0111\u1eb7t n\u00e0y ho\u1ea1t \u0111\u1ed9ng sai n\u1ebfu \u0111\u1ed3 th\u1ecb c\u00f3 \u0111a c\u1ea1nh, v\u00ec n\u00f3 b\u1ecf qua ch\u00fang. T\u1ea5t nhi\u00ean, \u0111a c\u1ea1nh s\u1ebd kh\u00f4ng bao gi\u1edd l\u00e0 m\u1ed9t ph\u1ea7n c\u1ee7a c\u00e2u tr\u1ea3 l\u1eddi, v\u00ec v\u1eady <code>IS_BRIDGE</code> c\u00f3 th\u1ec3 ki\u1ec3m tra th\u00eam r\u1eb1ng c\u1ea7u \u0111\u01b0\u1ee3c b\u00e1o c\u00e1o kh\u00f4ng ph\u1ea3i l\u00e0 \u0111a c\u1ea1nh. Ngo\u00e0i ra, c\u00f3 th\u1ec3 chuy\u1ec3n cho <code>dfs</code> ch\u1ec9 s\u1ed1 c\u1ee7a c\u1ea1nh \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 v\u00e0o \u0111\u1ec9nh thay v\u00ec \u0111\u1ec9nh cha (v\u00e0 l\u01b0u tr\u1eef ch\u1ec9 s\u1ed1 c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh).</p>","tags":["Translated"]},{"location":"graph/bridge-searching.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>UVA #796 \"Critical Links\" [difficulty: low]</li> <li>UVA #610 \"Street Directions\" [difficulty: medium]</li> <li>Case of the Computer Network (Codeforces Round #310 Div. 1 E) [difficulty: hard]</li> <li>UVA 12363 - Hedge Mazes</li> <li>UVA 315 - Network</li> <li>GYM - Computer Network (J)</li> <li>SPOJ - King Graffs Defense</li> <li>SPOJ - Critical Edges</li> <li>Codeforces - Break Up</li> <li>Codeforces - Tourist Reform</li> <li>Codeforces - Non-academic problem</li> </ul>","tags":["Translated"]},{"location":"graph/cutpoints.html","title":"T\u00ecm kh\u1edbp trong \u0111\u1ed3 th\u1ecb $O(N+M)$ (Finding articulation points in a graph in $O(N+M)$)","text":"<p>Ch\u00fang ta \u0111\u01b0\u1ee3c cho m\u1ed9t \u0111\u1ed3 th\u1ecb v\u00f4 h\u01b0\u1edbng. M\u1ed9t \u0111\u1ec9nh kh\u1edbp (articulation point) hay \u0111\u1ec9nh c\u1eaft (cut vertex) \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a l\u00e0 m\u1ed9t \u0111\u1ec9nh m\u00e0 khi b\u1ecb lo\u1ea1i b\u1ecf c\u00f9ng v\u1edbi c\u00e1c c\u1ea1nh li\u00ean k\u1ebft, l\u00e0m cho \u0111\u1ed3 th\u1ecb m\u1ea5t li\u00ean th\u00f4ng (ho\u1eb7c ch\u00ednh x\u00e1c h\u01a1n l\u00e0 l\u00e0m t\u0103ng s\u1ed1 l\u01b0\u1ee3ng c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng trong \u0111\u1ed3 th\u1ecb). Nhi\u1ec7m v\u1ee5 l\u00e0 t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh kh\u1edbp trong \u0111\u1ed3 th\u1ecb \u0111\u00e3 cho.</p> <p>Thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 \u1edf \u0111\u00e2y d\u1ef1a tr\u00ean t\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u v\u00e0 c\u00f3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p $O(N+M)$, trong \u0111\u00f3 $N$ l\u00e0 s\u1ed1 l\u01b0\u1ee3ng \u0111\u1ec9nh v\u00e0 $M$ l\u00e0 s\u1ed1 l\u01b0\u1ee3ng c\u1ea1nh trong \u0111\u1ed3 th\u1ecb.</p>","tags":["Translated"]},{"location":"graph/cutpoints.html#algorithm","title":"Thu\u1eadt to\u00e1n (Algorithm)","text":"<p>Ch\u1ecdn m\u1ed9t \u0111\u1ec9nh b\u1ea5t k\u1ef3 c\u1ee7a \u0111\u1ed3 th\u1ecb l\u00e0m $root$ v\u00e0 ch\u1ea1y t\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u t\u1eeb n\u00f3. L\u01b0u \u00fd th\u1ef1c t\u1ebf sau \u0111\u00e2y (d\u1ec5 d\u00e0ng ch\u1ee9ng minh):</p> <ul> <li> <p>Gi\u1ea3 s\u1eed ch\u00fang ta \u0111ang \u1edf trong DFS, xem x\u00e9t c\u00e1c c\u1ea1nh b\u1eaft \u0111\u1ea7u t\u1eeb \u0111\u1ec9nh $v\\ne root$. N\u1ebfu c\u1ea1nh hi\u1ec7n t\u1ea1i $(v, to)$ sao cho kh\u00f4ng c\u00f3 \u0111\u1ec9nh n\u00e0o trong s\u1ed1 c\u00e1c \u0111\u1ec9nh $to$ ho\u1eb7c c\u00e1c h\u1eadu du\u1ec7 c\u1ee7a n\u00f3 trong c\u00e2y duy\u1ec7t DFS c\u00f3 c\u1ea1nh ng\u01b0\u1ee3c (back-edge) \u0111\u1ebfn b\u1ea5t k\u1ef3 t\u1ed5 ti\u00ean n\u00e0o c\u1ee7a $v$, th\u00ec $v$ l\u00e0 m\u1ed9t \u0111\u1ec9nh kh\u1edbp. Ng\u01b0\u1ee3c l\u1ea1i, $v$ kh\u00f4ng ph\u1ea3i l\u00e0 m\u1ed9t \u0111\u1ec9nh kh\u1edbp.</p> </li> <li> <p>H\u00e3y xem x\u00e9t tr\u01b0\u1eddng h\u1ee3p c\u00f2n l\u1ea1i c\u1ee7a $v=root$. \u0110\u1ec9nh n\u00e0y s\u1ebd l\u00e0 \u0111\u1ec9nh kh\u1edbp khi v\u00e0 ch\u1ec9 khi \u0111\u1ec9nh n\u00e0y c\u00f3 nhi\u1ec1u h\u01a1n m\u1ed9t \u0111\u1ee9a con trong c\u00e2y DFS.</p> </li> </ul> <p>B\u00e2y gi\u1edd ch\u00fang ta ph\u1ea3i h\u1ecdc c\u00e1ch ki\u1ec3m tra th\u1ef1c t\u1ebf n\u00e0y cho m\u1ed7i \u0111\u1ec9nh m\u1ed9t c\u00e1ch hi\u1ec7u qu\u1ea3. Ch\u00fang ta s\u1ebd s\u1eed d\u1ee5ng \"th\u1eddi gian v\u00e0o n\u00fat\" (time of entry into node) \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n b\u1edfi t\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u.</p> <p>V\u00ec v\u1eady, h\u00e3y \u0111\u1ec3 $tin[v]$ bi\u1ec3u th\u1ecb th\u1eddi gian v\u00e0o n\u00fat $v$. Ch\u00fang ta gi\u1edbi thi\u1ec7u m\u1ed9t m\u1ea3ng $low[v]$ cho ph\u00e9p ch\u00fang ta ki\u1ec3m tra th\u1ef1c t\u1ebf cho m\u1ed7i \u0111\u1ec9nh $v$. $low[v]$ l\u00e0 gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t c\u1ee7a $tin[v]$, th\u1eddi gian v\u00e0o $tin[p]$ cho m\u1ed7i n\u00fat $p$ \u0111\u01b0\u1ee3c k\u1ebft n\u1ed1i v\u1edbi n\u00fat $v$ th\u00f4ng qua m\u1ed9t c\u1ea1nh ng\u01b0\u1ee3c $(v, p)$ v\u00e0 c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a $low[to]$ cho m\u1ed7i \u0111\u1ec9nh $to$ l\u00e0 h\u1eadu du\u1ec7 tr\u1ef1c ti\u1ebfp c\u1ee7a $v$ trong c\u00e2y DFS:</p> $$low[v] = \\min \\begin{cases} tin[v] \\\\ tin[p] &amp;\\text{ cho t\u1ea5t c\u1ea3 }p\\text{ m\u00e0 }(v, p)\\text{ l\u00e0 m\u1ed9t c\u1ea1nh ng\u01b0\u1ee3c} \\\\ low[to]&amp; \\text{ cho t\u1ea5t c\u1ea3 }to\\text{ m\u00e0 }(v, to)\\text{ l\u00e0 m\u1ed9t c\u1ea1nh c\u00e2y} \\end{cases}$$ <p>B\u00e2y gi\u1edd, c\u00f3 m\u1ed9t c\u1ea1nh ng\u01b0\u1ee3c t\u1eeb \u0111\u1ec9nh $v$ ho\u1eb7c m\u1ed9t trong nh\u1eefng h\u1eadu du\u1ec7 c\u1ee7a n\u00f3 \u0111\u1ebfn m\u1ed9t trong nh\u1eefng t\u1ed5 ti\u00ean c\u1ee7a n\u00f3 khi v\u00e0 ch\u1ec9 khi \u0111\u1ec9nh $v$ c\u00f3 m\u1ed9t \u0111\u1ee9a con $to$ m\u00e0 $low[to] &lt; tin[v]$. N\u1ebfu $low[to] = tin[v]$, c\u1ea1nh ng\u01b0\u1ee3c \u0111i tr\u1ef1c ti\u1ebfp \u0111\u1ebfn $v$, ng\u01b0\u1ee3c l\u1ea1i n\u00f3 \u0111i \u0111\u1ebfn m\u1ed9t trong c\u00e1c t\u1ed5 ti\u00ean c\u1ee7a $v$.</p> <p>Do \u0111\u00f3, \u0111\u1ec9nh $v$ trong c\u00e2y DFS l\u00e0 m\u1ed9t \u0111\u1ec9nh kh\u1edbp khi v\u00e0 ch\u1ec9 khi $low[to] \\geq tin[v]$.</p>","tags":["Translated"]},{"location":"graph/cutpoints.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>C\u00e0i \u0111\u1eb7t c\u1ea7n ph\u00e2n bi\u1ec7t ba tr\u01b0\u1eddng h\u1ee3p: khi ch\u00fang ta \u0111i xu\u1ed1ng c\u1ea1nh trong c\u00e2y DFS, khi ch\u00fang ta t\u00ecm th\u1ea5y m\u1ed9t c\u1ea1nh ng\u01b0\u1ee3c \u0111\u1ebfn t\u1ed5 ti\u00ean c\u1ee7a \u0111\u1ec9nh v\u00e0 khi ch\u00fang ta quay tr\u1edf l\u1ea1i cha c\u1ee7a \u0111\u1ec9nh. \u0110\u00e2y l\u00e0 c\u00e1c tr\u01b0\u1eddng h\u1ee3p:</p> <ul> <li>$visited[to] = false$ - c\u1ea1nh l\u00e0 m\u1ed9t ph\u1ea7n c\u1ee7a c\u00e2y DFS;</li> <li>$visited[to] = true$ &amp;&amp; $to \\neq parent$ - c\u1ea1nh l\u00e0 c\u1ea1nh ng\u01b0\u1ee3c \u0111\u1ebfn m\u1ed9t trong c\u00e1c t\u1ed5 ti\u00ean;</li> <li>$to = parent$ - c\u1ea1nh d\u1eabn quay l\u1ea1i cha trong c\u00e2y DFS.</li> </ul> <p>\u0110\u1ec3 c\u00e0i \u0111\u1eb7t \u0111i\u1ec1u n\u00e0y, ch\u00fang ta c\u1ea7n m\u1ed9t h\u00e0m t\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u ch\u1ea5p nh\u1eadn \u0111\u1ec9nh cha c\u1ee7a n\u00fat hi\u1ec7n t\u1ea1i.</p> <pre><code>int n; // s\u1ed1 l\u01b0\u1ee3ng n\u00fat\nvector&lt;vector&lt;int&gt;&gt; adj; // danh s\u00e1ch k\u1ec1 c\u1ee7a \u0111\u1ed3 th\u1ecb\n\nvector&lt;bool&gt; visited;\nvector&lt;int&gt; tin, low;\nint timer;\n\nvoid dfs(int v, int p = -1) {\n    visited[v] = true;\n    tin[v] = low[v] = timer++;\n    int children=0;\n    for (int to : adj[v]) {\n        if (to == p) continue;\n        if (visited[to]) {\n            low[v] = min(low[v], tin[to]);\n        } else {\n            dfs(to, v);\n            low[v] = min(low[v], low[to]);\n            if (low[to] &gt;= tin[v] &amp;&amp; p!=-1)\n                IS_CUTPOINT(v);\n            ++children;\n        }\n    }\n    if(p == -1 &amp;&amp; children &gt; 1)\n        IS_CUTPOINT(v);\n}\n\nvoid find_cutpoints() {\n    timer = 0;\n    visited.assign(n, false);\n    tin.assign(n, -1);\n    low.assign(n, -1);\n    for (int i = 0; i &lt; n; ++i) {\n        if (!visited[i])\n            dfs (i);\n    }\n}\n</code></pre> <p>H\u00e0m ch\u00ednh l\u00e0 <code>find_cutpoints</code>; n\u00f3 th\u1ef1c hi\u1ec7n kh\u1edfi t\u1ea1o c\u1ea7n thi\u1ebft v\u00e0 b\u1eaft \u0111\u1ea7u t\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u trong m\u1ed7i th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng c\u1ee7a \u0111\u1ed3 th\u1ecb.</p> <p>H\u00e0m <code>IS_CUTPOINT(a)</code> l\u00e0 m\u1ed9t s\u1ed1 h\u00e0m s\u1ebd x\u1eed l\u00fd th\u1ef1c t\u1ebf r\u1eb1ng \u0111\u1ec9nh $a$ l\u00e0 m\u1ed9t \u0111\u1ec9nh kh\u1edbp, v\u00ed d\u1ee5, in n\u00f3 ra (L\u01b0u \u00fd r\u1eb1ng h\u00e0m n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c g\u1ecdi nhi\u1ec1u l\u1ea7n cho m\u1ed9t \u0111\u1ec9nh).</p>","tags":["Translated"]},{"location":"graph/cutpoints.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>UVA #10199 \"Tourist Guide\" [difficulty: low]</li> <li>UVA #315 \"Network\" [difficulty: low]</li> <li>SPOJ - Submerging Islands</li> <li>Codeforces - Cutting Figure</li> </ul>","tags":["Translated"]},{"location":"graph/depth-first-search.html","title":"T\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u (Depth First Search)","text":"<p>T\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u (Depth First Search - DFS) l\u00e0 m\u1ed9t trong nh\u1eefng thu\u1eadt to\u00e1n \u0111\u1ed3 th\u1ecb ch\u00ednh.</p> <p>T\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u t\u00ecm \u0111\u01b0\u1eddng \u0111i \u0111\u1ea7u ti\u00ean theo th\u1ee9 t\u1ef1 t\u1eeb \u0111i\u1ec3n trong \u0111\u1ed3 th\u1ecb t\u1eeb m\u1ed9t \u0111\u1ec9nh ngu\u1ed3n $u$ \u0111\u1ebfn m\u1ed7i \u0111\u1ec9nh. T\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u c\u0169ng s\u1ebd t\u00ecm \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t trong m\u1ed9t c\u00e2y (v\u00ec ch\u1ec9 t\u1ed3n t\u1ea1i m\u1ed9t \u0111\u01b0\u1eddng \u0111i \u0111\u01a1n), nh\u01b0ng tr\u00ean c\u00e1c \u0111\u1ed3 th\u1ecb t\u1ed5ng qu\u00e1t th\u00ec kh\u00f4ng ph\u1ea3i v\u1eady.</p> <p>Thu\u1eadt to\u00e1n ho\u1ea1t \u0111\u1ed9ng trong th\u1eddi gian $O(m + n)$ trong \u0111\u00f3 $n$ l\u00e0 s\u1ed1 l\u01b0\u1ee3ng \u0111\u1ec9nh v\u00e0 $m$ l\u00e0 s\u1ed1 l\u01b0\u1ee3ng c\u1ea1nh.</p>","tags":["Translated"]},{"location":"graph/depth-first-search.html#description-of-the-algorithm","title":"M\u00f4 t\u1ea3 thu\u1eadt to\u00e1n (Description of the algorithm)","text":"<p>\u00dd t\u01b0\u1edfng \u0111\u1eb1ng sau DFS l\u00e0 \u0111i s\u00e2u v\u00e0o \u0111\u1ed3 th\u1ecb nh\u1ea5t c\u00f3 th\u1ec3, v\u00e0 quay lui (backtrack) khi b\u1ea1n \u1edf t\u1ea1i m\u1ed9t \u0111\u1ec9nh kh\u00f4ng c\u00f3 b\u1ea5t k\u1ef3 \u0111\u1ec9nh k\u1ec1 n\u00e0o ch\u01b0a \u0111\u01b0\u1ee3c th\u0103m.</p> <p>R\u1ea5t d\u1ec5 \u0111\u1ec3 m\u00f4 t\u1ea3 / c\u00e0i \u0111\u1eb7t thu\u1eadt to\u00e1n m\u1ed9t c\u00e1ch \u0111\u1ec7 quy: Ch\u00fang ta b\u1eaft \u0111\u1ea7u t\u00ecm ki\u1ebfm t\u1ea1i m\u1ed9t \u0111\u1ec9nh. Sau khi th\u0103m m\u1ed9t \u0111\u1ec9nh, ch\u00fang ta ti\u1ebfp t\u1ee5c th\u1ef1c hi\u1ec7n DFS cho m\u1ed7i \u0111\u1ec9nh k\u1ec1 m\u00e0 ch\u00fang ta ch\u01b0a th\u0103m tr\u01b0\u1edbc \u0111\u00f3. B\u1eb1ng c\u00e1ch n\u00e0y, ch\u00fang ta th\u0103m t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh c\u00f3 th\u1ec3 \u0111\u1ebfn \u0111\u01b0\u1ee3c t\u1eeb \u0111\u1ec9nh b\u1eaft \u0111\u1ea7u.</p> <p>\u0110\u1ec3 bi\u1ebft th\u00eam chi ti\u1ebft, h\u00e3y xem ph\u1ea7n c\u00e0i \u0111\u1eb7t.</p>","tags":["Translated"]},{"location":"graph/depth-first-search.html#applications-of-depth-first-search","title":"\u1ee8ng d\u1ee5ng c\u1ee7a T\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u (Applications of Depth First Search)","text":"<ul> <li> <p>T\u00ecm b\u1ea5t k\u1ef3 \u0111\u01b0\u1eddng \u0111i n\u00e0o trong \u0111\u1ed3 th\u1ecb t\u1eeb \u0111\u1ec9nh ngu\u1ed3n $u$ \u0111\u1ebfn t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh.</p> </li> <li> <p>T\u00ecm \u0111\u01b0\u1eddng \u0111i \u0111\u1ea7u ti\u00ean theo th\u1ee9 t\u1ef1 t\u1eeb \u0111i\u1ec3n trong \u0111\u1ed3 th\u1ecb t\u1eeb ngu\u1ed3n $u$ \u0111\u1ebfn t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh.</p> </li> <li> <p>Ki\u1ec3m tra xem m\u1ed9t \u0111\u1ec9nh trong c\u00e2y c\u00f3 ph\u1ea3i l\u00e0 t\u1ed5 ti\u00ean c\u1ee7a m\u1ed9t s\u1ed1 \u0111\u1ec9nh kh\u00e1c hay kh\u00f4ng:</p> <p>\u1ede \u0111\u1ea7u v\u00e0 cu\u1ed1i m\u1ed7i cu\u1ed9c g\u1ecdi t\u00ecm ki\u1ebfm, ch\u00fang ta ghi nh\u1edb \"th\u1eddi gian\" v\u00e0o (entry) v\u00e0 ra (exit) c\u1ee7a m\u1ed7i \u0111\u1ec9nh. B\u00e2y gi\u1edd b\u1ea1n c\u00f3 th\u1ec3 t\u00ecm c\u00e2u tr\u1ea3 l\u1eddi cho b\u1ea5t k\u1ef3 c\u1eb7p \u0111\u1ec9nh $(i, j)$ n\u00e0o trong $O(1)$: \u0111\u1ec9nh $i$ l\u00e0 t\u1ed5 ti\u00ean c\u1ee7a \u0111\u1ec9nh $j$ khi v\u00e0 ch\u1ec9 khi $\\text{entry}[i] &lt; \\text{entry}[j]$ v\u00e0 $\\text{exit}[i] &gt; \\text{exit}[j]$.</p> </li> <li> <p>T\u00ecm t\u1ed5 ti\u00ean chung th\u1ea5p nh\u1ea5t (LCA) c\u1ee7a hai \u0111\u1ec9nh.</p> </li> <li> <p>S\u1eafp x\u1ebfp topo (Topological sorting):</p> <p>Ch\u1ea1y m\u1ed9t lo\u1ea1t c\u00e1c t\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u \u0111\u1ec3 th\u0103m m\u1ed7i \u0111\u1ec9nh ch\u00ednh x\u00e1c m\u1ed9t l\u1ea7n trong th\u1eddi gian $O(n + m)$. Th\u1ee9 t\u1ef1 topo c\u1ea7n t\u00ecm s\u1ebd l\u00e0 c\u00e1c \u0111\u1ec9nh \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp theo th\u1ee9 t\u1ef1 gi\u1ea3m d\u1ea7n c\u1ee7a th\u1eddi gian ra (exit time).</p> </li> <li> <p>Ki\u1ec3m tra xem m\u1ed9t \u0111\u1ed3 th\u1ecb \u0111\u00e3 cho c\u00f3 ph\u1ea3i l\u00e0 kh\u00f4ng c\u00f3 chu tr\u00ecnh (acyclic) hay kh\u00f4ng v\u00e0 t\u00ecm c\u00e1c chu tr\u00ecnh trong m\u1ed9t \u0111\u1ed3 th\u1ecb. (Nh\u01b0 \u0111\u00e3 \u0111\u1ec1 c\u1eadp b\u00ean d\u01b0\u1edbi b\u1eb1ng c\u00e1ch \u0111\u1ebfm c\u00e1c c\u1ea1nh ng\u01b0\u1ee3c trong m\u1ecdi th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng).</p> </li> <li> <p>T\u00ecm c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh trong m\u1ed9t \u0111\u1ed3 th\u1ecb c\u00f3 h\u01b0\u1edbng:</p> <p>\u0110\u1ea7u ti\u00ean th\u1ef1c hi\u1ec7n s\u1eafp x\u1ebfp topo c\u1ee7a \u0111\u1ed3 th\u1ecb. Sau \u0111\u00f3 chuy\u1ec3n v\u1ecb \u0111\u1ed3 th\u1ecb v\u00e0 ch\u1ea1y m\u1ed9t lo\u1ea1t c\u00e1c t\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u kh\u00e1c theo th\u1ee9 t\u1ef1 \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a b\u1edfi s\u1eafp x\u1ebfp topo. \u0110\u1ed1i v\u1edbi m\u1ed7i cu\u1ed9c g\u1ecdi DFS, th\u00e0nh ph\u1ea7n \u0111\u01b0\u1ee3c t\u1ea1o b\u1edfi n\u00f3 l\u00e0 m\u1ed9t th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh.</p> </li> <li> <p>T\u00ecm c\u1ea7u (bridges) trong m\u1ed9t \u0111\u1ed3 th\u1ecb v\u00f4 h\u01b0\u1edbng:</p> <p>\u0110\u1ea7u ti\u00ean chuy\u1ec3n \u0111\u1ed5i \u0111\u1ed3 th\u1ecb \u0111\u00e3 cho th\u00e0nh \u0111\u1ed3 th\u1ecb c\u00f3 h\u01b0\u1edbng b\u1eb1ng c\u00e1ch ch\u1ea1y m\u1ed9t lo\u1ea1t c\u00e1c t\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u v\u00e0 l\u00e0m cho m\u1ed7i c\u1ea1nh c\u00f3 h\u01b0\u1edbng khi ch\u00fang ta \u0111i qua n\u00f3, theo h\u01b0\u1edbng ch\u00fang ta \u0111\u00e3 \u0111i. Th\u1ee9 hai, t\u00ecm c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh trong \u0111\u1ed3 th\u1ecb c\u00f3 h\u01b0\u1edbng n\u00e0y. C\u1ea7u l\u00e0 nh\u1eefng c\u1ea1nh m\u00e0 c\u00e1c \u0111\u1ea7u c\u1ee7a n\u00f3 thu\u1ed9c v\u1ec1 c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh kh\u00e1c nhau.</p> </li> </ul>","tags":["Translated"]},{"location":"graph/depth-first-search.html#classification-of-edges-of-a-graph","title":"Ph\u00e2n lo\u1ea1i c\u00e1c c\u1ea1nh c\u1ee7a \u0111\u1ed3 th\u1ecb (Classification of edges of a graph)","text":"<p>Ch\u00fang ta c\u00f3 th\u1ec3 ph\u00e2n lo\u1ea1i c\u00e1c c\u1ea1nh c\u1ee7a m\u1ed9t \u0111\u1ed3 th\u1ecb, $G$, b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng th\u1eddi gian v\u00e0o v\u00e0 ra c\u1ee7a c\u00e1c n\u00fat \u0111\u1ea7u cu\u1ed1i $u$ v\u00e0 $v$ c\u1ee7a c\u00e1c c\u1ea1nh $(u,v)$. C\u00e1c ph\u00e2n lo\u1ea1i n\u00e0y th\u01b0\u1eddng \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng cho c\u00e1c b\u00e0i to\u00e1n nh\u01b0 t\u00ecm c\u1ea7u v\u00e0 t\u00ecm kh\u1edbp.</p> <p>Ch\u00fang ta th\u1ef1c hi\u1ec7n m\u1ed9t DFS v\u00e0 ph\u00e2n lo\u1ea1i c\u00e1c c\u1ea1nh g\u1eb7p ph\u1ea3i b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng c\u00e1c quy t\u1eafc sau:</p> <p>N\u1ebfu $v$ ch\u01b0a \u0111\u01b0\u1ee3c th\u0103m:</p> <ul> <li>C\u1ea1nh c\u00e2y (Tree Edge) - N\u1ebfu $v$ \u0111\u01b0\u1ee3c th\u0103m sau $u$ th\u00ec c\u1ea1nh $(u,v)$ \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 c\u1ea1nh c\u00e2y. N\u00f3i c\u00e1ch kh\u00e1c, n\u1ebfu $v$ \u0111\u01b0\u1ee3c th\u0103m l\u1ea7n \u0111\u1ea7u ti\u00ean v\u00e0 $u$ hi\u1ec7n \u0111ang \u0111\u01b0\u1ee3c th\u0103m th\u00ec $(u,v)$ \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 c\u1ea1nh c\u00e2y. C\u00e1c c\u1ea1nh n\u00e0y t\u1ea1o th\u00e0nh m\u1ed9t c\u00e2y DFS v\u00e0 do \u0111\u00f3 c\u00f3 t\u00ean l\u00e0 c\u1ea1nh c\u00e2y.</li> </ul> <p>N\u1ebfu $v$ \u0111\u01b0\u1ee3c th\u0103m tr\u01b0\u1edbc $u$:</p> <ul> <li> <p>C\u1ea1nh ng\u01b0\u1ee3c (Back edge) - N\u1ebfu $v$ l\u00e0 t\u1ed5 ti\u00ean c\u1ee7a $u$, th\u00ec c\u1ea1nh $(u,v)$ l\u00e0 m\u1ed9t c\u1ea1nh ng\u01b0\u1ee3c. $v$ l\u00e0 t\u1ed5 ti\u00ean ch\u00ednh x\u00e1c n\u1ebfu ch\u00fang ta \u0111\u00e3 v\u00e0o $v$, nh\u01b0ng ch\u01b0a ra kh\u1ecfi n\u00f3. C\u00e1c c\u1ea1nh ng\u01b0\u1ee3c ho\u00e0n th\u00e0nh m\u1ed9t chu tr\u00ecnh v\u00ec c\u00f3 m\u1ed9t \u0111\u01b0\u1eddng \u0111i t\u1eeb t\u1ed5 ti\u00ean $v$ \u0111\u1ebfn h\u1eadu du\u1ec7 $u$ (trong \u0111\u1ec7 quy c\u1ee7a DFS) v\u00e0 m\u1ed9t c\u1ea1nh t\u1eeb h\u1eadu du\u1ec7 $u$ \u0111\u1ebfn t\u1ed5 ti\u00ean $v$ (c\u1ea1nh ng\u01b0\u1ee3c), do \u0111\u00f3 m\u1ed9t chu tr\u00ecnh \u0111\u01b0\u1ee3c h\u00ecnh th\u00e0nh. C\u00e1c chu tr\u00ecnh c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c ph\u00e1t hi\u1ec7n b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng c\u00e1c c\u1ea1nh ng\u01b0\u1ee3c.</p> </li> <li> <p>C\u1ea1nh xu\u00f4i (Forward Edge) - N\u1ebfu $v$ l\u00e0 h\u1eadu du\u1ec7 c\u1ee7a $u$, th\u00ec c\u1ea1nh $(u, v)$ l\u00e0 m\u1ed9t c\u1ea1nh xu\u00f4i. N\u00f3i c\u00e1ch kh\u00e1c, n\u1ebfu ch\u00fang ta \u0111\u00e3 th\u0103m v\u00e0 ra kh\u1ecfi $v$ v\u00e0 $\\text{entry}[u] &lt; \\text{entry}[v]$ th\u00ec c\u1ea1nh $(u,v)$ t\u1ea1o th\u00e0nh m\u1ed9t c\u1ea1nh xu\u00f4i.</p> </li> <li> <p>C\u1ea1nh ch\u00e9o (Cross Edge): n\u1ebfu $v$ kh\u00f4ng ph\u1ea3i l\u00e0 t\u1ed5 ti\u00ean c\u0169ng kh\u00f4ng ph\u1ea3i l\u00e0 h\u1eadu du\u1ec7 c\u1ee7a $u$, th\u00ec c\u1ea1nh $(u, v)$ l\u00e0 m\u1ed9t c\u1ea1nh ch\u00e9o. N\u00f3i c\u00e1ch kh\u00e1c, n\u1ebfu ch\u00fang ta \u0111\u00e3 th\u0103m v\u00e0 ra kh\u1ecfi $v$ v\u00e0 $\\text{entry}[u] &gt; \\text{entry}[v]$ th\u00ec $(u,v)$ l\u00e0 m\u1ed9t c\u1ea1nh ch\u00e9o.</p> </li> </ul> <p>\u0110\u1ecbnh l\u00fd. Cho $G$ l\u00e0 m\u1ed9t \u0111\u1ed3 th\u1ecb v\u00f4 h\u01b0\u1edbng. Khi \u0111\u00f3, vi\u1ec7c th\u1ef1c hi\u1ec7n m\u1ed9t DFS tr\u00ean $G$ s\u1ebd ph\u00e2n lo\u1ea1i m\u1ecdi c\u1ea1nh g\u1eb7p ph\u1ea3i l\u00e0 c\u1ea1nh c\u00e2y ho\u1eb7c c\u1ea1nh ng\u01b0\u1ee3c, t\u1ee9c l\u00e0, c\u00e1c c\u1ea1nh xu\u00f4i v\u00e0 c\u1ea1nh ch\u00e9o ch\u1ec9 t\u1ed3n t\u1ea1i trong c\u00e1c \u0111\u1ed3 th\u1ecb c\u00f3 h\u01b0\u1edbng.</p> <p>Gi\u1ea3 s\u1eed $(u,v)$ l\u00e0 m\u1ed9t c\u1ea1nh t\u00f9y \u00fd c\u1ee7a $G$ v\u00e0 kh\u00f4ng m\u1ea5t t\u00ednh t\u1ed5ng qu\u00e1t, $u$ \u0111\u01b0\u1ee3c th\u0103m tr\u01b0\u1edbc $v$, t\u1ee9c l\u00e0, $\\text{entry}[u] &lt; \\text{entry}[v]$. B\u1edfi v\u00ec DFS ch\u1ec9 x\u1eed l\u00fd c\u00e1c c\u1ea1nh m\u1ed9t l\u1ea7n, ch\u1ec9 c\u00f3 hai c\u00e1ch m\u00e0 ch\u00fang ta c\u00f3 th\u1ec3 x\u1eed l\u00fd c\u1ea1nh $(u,v)$ v\u00e0 do \u0111\u00f3 ph\u00e2n lo\u1ea1i n\u00f3:</p> <ul> <li> <p>L\u1ea7n \u0111\u1ea7u ti\u00ean ch\u00fang ta kh\u00e1m ph\u00e1 c\u1ea1nh $(u,v)$ l\u00e0 theo h\u01b0\u1edbng t\u1eeb $u$ \u0111\u1ebfn $v$. B\u1edfi v\u00ec $\\text{entry}[u] &lt; \\text{entry}[v]$, b\u1ea3n ch\u1ea5t \u0111\u1ec7 quy c\u1ee7a DFS c\u00f3 ngh\u0129a l\u00e0 n\u00fat $v$ s\u1ebd \u0111\u01b0\u1ee3c kh\u00e1m ph\u00e1 \u0111\u1ea7y \u0111\u1ee7 v\u00e0 do \u0111\u00f3 tho\u00e1t ra tr\u01b0\u1edbc khi ch\u00fang ta c\u00f3 th\u1ec3 \"di chuy\u1ec3n ng\u01b0\u1ee3c l\u00ean ng\u0103n x\u1ebfp cu\u1ed9c g\u1ecdi\" \u0111\u1ec3 tho\u00e1t kh\u1ecfi n\u00fat $u$. Do \u0111\u00f3, n\u00fat $v$ ph\u1ea3i ch\u01b0a \u0111\u01b0\u1ee3c th\u0103m khi DFS l\u1ea7n \u0111\u1ea7u ti\u00ean kh\u00e1m ph\u00e1 c\u1ea1nh $(u,v)$ t\u1eeb $u$ \u0111\u1ebfn $v$ v\u00ec n\u1ebfu kh\u00f4ng, vi\u1ec7c t\u00ecm ki\u1ebfm s\u1ebd kh\u00e1m ph\u00e1 $(u,v)$ t\u1eeb $v$ \u0111\u1ebfn $u$ tr\u01b0\u1edbc khi tho\u00e1t kh\u1ecfi n\u00fat $v$, v\u00ec c\u00e1c n\u00fat $u$ v\u00e0 $v$ l\u00e0 h\u00e0ng x\u00f3m. Do \u0111\u00f3, c\u1ea1nh $(u,v)$ l\u00e0 m\u1ed9t c\u1ea1nh c\u00e2y.</p> </li> <li> <p>L\u1ea7n \u0111\u1ea7u ti\u00ean ch\u00fang ta kh\u00e1m ph\u00e1 c\u1ea1nh $(u,v)$ l\u00e0 theo h\u01b0\u1edbng t\u1eeb $v$ \u0111\u1ebfn $u$. B\u1edfi v\u00ec ch\u00fang ta \u0111\u00e3 ph\u00e1t hi\u1ec7n ra n\u00fat $u$ tr\u01b0\u1edbc khi ph\u00e1t hi\u1ec7n ra n\u00fat $v$, v\u00e0 ch\u00fang ta ch\u1ec9 x\u1eed l\u00fd c\u00e1c c\u1ea1nh m\u1ed9t l\u1ea7n, c\u00e1ch duy nh\u1ea5t m\u00e0 ch\u00fang ta c\u00f3 th\u1ec3 kh\u00e1m ph\u00e1 c\u1ea1nh $(u,v)$ theo h\u01b0\u1edbng t\u1eeb $v$ \u0111\u1ebfn $u$ l\u00e0 n\u1ebfu c\u00f3 m\u1ed9t \u0111\u01b0\u1eddng \u0111i kh\u00e1c t\u1eeb $u$ \u0111\u1ebfn $v$ kh\u00f4ng li\u00ean quan \u0111\u1ebfn c\u1ea1nh $(u,v)$, do \u0111\u00f3 l\u00e0m cho $u$ tr\u1edf th\u00e0nh t\u1ed5 ti\u00ean c\u1ee7a $v$. C\u1ea1nh $(u,v)$ do \u0111\u00f3 ho\u00e0n th\u00e0nh m\u1ed9t chu tr\u00ecnh v\u00ec n\u00f3 \u0111i t\u1eeb h\u1eadu du\u1ec7, $v$, \u0111\u1ebfn t\u1ed5 ti\u00ean, $u$, m\u00e0 ch\u00fang ta ch\u01b0a tho\u00e1t ra. Do \u0111\u00f3, c\u1ea1nh $(u,v)$ l\u00e0 m\u1ed9t c\u1ea1nh ng\u01b0\u1ee3c.</p> </li> </ul> <p>V\u00ec ch\u1ec9 c\u00f3 hai c\u00e1ch \u0111\u1ec3 x\u1eed l\u00fd c\u1ea1nh $(u,v)$, v\u1edbi hai tr\u01b0\u1eddng h\u1ee3p v\u00e0 c\u00e1c ph\u00e2n lo\u1ea1i k\u1ebft qu\u1ea3 c\u1ee7a ch\u00fang \u0111\u01b0\u1ee3c ph\u00e1c th\u1ea3o \u1edf tr\u00ean, vi\u1ec7c th\u1ef1c hi\u1ec7n m\u1ed9t DFS tr\u00ean $G$ do \u0111\u00f3 s\u1ebd ph\u00e2n lo\u1ea1i m\u1ecdi c\u1ea1nh g\u1eb7p ph\u1ea3i l\u00e0 c\u1ea1nh c\u00e2y ho\u1eb7c c\u1ea1nh ng\u01b0\u1ee3c, t\u1ee9c l\u00e0, c\u00e1c c\u1ea1nh xu\u00f4i v\u00e0 c\u1ea1nh ch\u00e9o ch\u1ec9 t\u1ed3n t\u1ea1i trong c\u00e1c \u0111\u1ed3 th\u1ecb c\u00f3 h\u01b0\u1edbng. \u0110i\u1ec1u n\u00e0y ho\u00e0n th\u00e0nh ch\u1ee9ng minh.</p>","tags":["Translated"]},{"location":"graph/depth-first-search.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p><pre><code>vector&lt;vector&lt;int&gt;&gt; adj; // bi\u1ec3u di\u1ec5n \u0111\u1ed3 th\u1ecb d\u01b0\u1edbi d\u1ea1ng danh s\u00e1ch k\u1ec1\nint n; // s\u1ed1 l\u01b0\u1ee3ng \u0111\u1ec9nh\n\nvector&lt;bool&gt; visited;\n\nvoid dfs(int v) {\n    visited[v] = true;\n    for (int u : adj[v]) {\n        if (!visited[u])\n            dfs(u);\n    }\n}\n</code></pre> \u0110\u00e2y l\u00e0 c\u00e0i \u0111\u1eb7t \u0111\u01a1n gi\u1ea3n nh\u1ea5t c\u1ee7a T\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u. Nh\u01b0 \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 trong c\u00e1c \u1ee9ng d\u1ee5ng, c\u00f3 th\u1ec3 h\u1eefu \u00edch khi t\u00ednh to\u00e1n th\u00eam th\u1eddi gian v\u00e0o v\u00e0 ra v\u00e0 m\u00e0u c\u1ee7a \u0111\u1ec9nh. Ch\u00fang ta s\u1ebd t\u00f4 m\u00e0u t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh v\u1edbi m\u00e0u 0, n\u1ebfu ch\u00fang ta ch\u01b0a th\u0103m ch\u00fang, v\u1edbi m\u00e0u 1 n\u1ebfu ch\u00fang ta \u0111\u00e3 th\u0103m ch\u00fang, v\u00e0 v\u1edbi m\u00e0u 2, n\u1ebfu ch\u00fang ta \u0111\u00e3 ra kh\u1ecfi \u0111\u1ec9nh.</p> <p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u1ed9t c\u00e0i \u0111\u1eb7t chung t\u00ednh to\u00e1n th\u00eam nh\u1eefng th\u1ee9 \u0111\u00f3:</p> <pre><code>vector&lt;vector&lt;int&gt;&gt; adj; // bi\u1ec3u di\u1ec5n \u0111\u1ed3 th\u1ecb d\u01b0\u1edbi d\u1ea1ng danh s\u00e1ch k\u1ec1\nint n; // s\u1ed1 l\u01b0\u1ee3ng \u0111\u1ec9nh\n\nvector&lt;int&gt; color;\n\nvector&lt;int&gt; time_in, time_out;\nint dfs_timer = 0;\n\nvoid dfs(int v) {\n    time_in[v] = dfs_timer++;\n    color[v] = 1;\n    for (int u : adj[v])\n        if (color[u] == 0)\n            dfs(u);\n    color[v] = 2;\n    time_out[v] = dfs_timer++;\n}\n</code></pre>","tags":["Translated"]},{"location":"graph/depth-first-search.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>SPOJ: ABCPATH</li> <li>SPOJ: EAGLE1</li> <li>Codeforces: Kefa and Park</li> <li>Timus:Werewolf</li> <li>Timus:Penguin Avia</li> <li>Timus:Two Teams</li> <li>SPOJ - Ada and Island</li> <li>UVA 657 - The die is cast</li> <li>SPOJ - Sheep</li> <li>SPOJ - Path of the Rightenous Man</li> <li>SPOJ - Validate the Maze</li> <li>SPOJ - Ghosts having Fun</li> <li>Codeforces - Underground Lab</li> <li>DevSkill - Maze Tester (archived)</li> <li>DevSkill - Tourist (archived)</li> <li>Codeforces - Anton and Tree</li> <li>Codeforces - Transformation: From A to B</li> <li>Codeforces - One Way Reform</li> <li>Codeforces - Centroids</li> <li>Codeforces - Generate a String</li> <li>Codeforces - Broken Tree</li> <li>Codeforces - Dasha and Puzzle</li> <li>Codeforces - Making genome In Berland</li> <li>Codeforces - Road Improvement</li> <li>Codeforces - Garland</li> <li>Codeforces - Labeling Cities</li> <li>Codeforces - Send the Fool Futher!</li> <li>Codeforces - The tag Game</li> <li>Codeforces - Leha and Another game about graphs</li> <li>Codeforces - Shortest path problem</li> <li>Codeforces - Upgrading Tree</li> <li>Codeforces - From Y to Y</li> <li>Codeforces - Chemistry in Berland</li> <li>Codeforces - Wizards Tour</li> <li>Codeforces - Ring Road</li> <li>Codeforces - Mail Stamps</li> <li>Codeforces - Ant on the Tree</li> <li>SPOJ - Cactus</li> <li>SPOJ - Mixing Chemicals</li> </ul>","tags":["Translated"]},{"location":"graph/desopo_pape.html","title":"Thu\u1eadt to\u00e1n D\u00b4Esopo-Pape (D\u00b4Esopo-Pape algorithm)","text":"<p>Cho m\u1ed9t \u0111\u1ed3 th\u1ecb v\u1edbi $n$ \u0111\u1ec9nh v\u00e0 $m$ c\u1ea1nh v\u1edbi tr\u1ecdng s\u1ed1 $w_i$ v\u00e0 m\u1ed9t \u0111\u1ec9nh b\u1eaft \u0111\u1ea7u $v_0$. Nhi\u1ec7m v\u1ee5 l\u00e0 t\u00ecm \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t t\u1eeb \u0111\u1ec9nh $v_0$ \u0111\u1ebfn m\u1ecdi \u0111\u1ec9nh kh\u00e1c.</p> <p>Thu\u1eadt to\u00e1n t\u1eeb D\u00b4Esopo-Pape s\u1ebd ho\u1ea1t \u0111\u1ed9ng nhanh h\u01a1n thu\u1eadt to\u00e1n Dijkstra v\u00e0 thu\u1eadt to\u00e1n Bellman-Ford trong h\u1ea7u h\u1ebft c\u00e1c tr\u01b0\u1eddng h\u1ee3p, v\u00e0 c\u0169ng s\u1ebd ho\u1ea1t \u0111\u1ed9ng cho c\u00e1c c\u1ea1nh \u00e2m. Tuy nhi\u00ean kh\u00f4ng \u00e1p d\u1ee5ng cho c\u00e1c chu tr\u00ecnh \u00e2m.</p>","tags":["Translated"]},{"location":"graph/desopo_pape.html#description","title":"M\u00f4 t\u1ea3 (Description)","text":"<p>G\u1ecdi m\u1ea3ng $d$ ch\u1ee9a \u0111\u1ed9 d\u00e0i \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t, t\u1ee9c l\u00e0 $d_i$ l\u00e0 \u0111\u1ed9 d\u00e0i hi\u1ec7n t\u1ea1i c\u1ee7a \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t t\u1eeb \u0111\u1ec9nh $v_0$ \u0111\u1ebfn \u0111\u1ec9nh $i$. Ban \u0111\u1ea7u m\u1ea3ng n\u00e0y \u0111\u01b0\u1ee3c \u0111i\u1ec1n b\u1eb1ng v\u00f4 c\u1ef1c cho m\u1ecdi \u0111\u1ec9nh, ngo\u1ea1i tr\u1eeb $d_{v_0} = 0$. Sau khi thu\u1eadt to\u00e1n k\u1ebft th\u00fac, m\u1ea3ng n\u00e0y s\u1ebd ch\u1ee9a kho\u1ea3ng c\u00e1ch ng\u1eafn nh\u1ea5t.</p> <p>G\u1ecdi m\u1ea3ng $p$ ch\u1ee9a c\u00e1c t\u1ed5 ti\u00ean hi\u1ec7n t\u1ea1i, t\u1ee9c l\u00e0 $p_i$ l\u00e0 t\u1ed5 ti\u00ean tr\u1ef1c ti\u1ebfp c\u1ee7a \u0111\u1ec9nh $i$ tr\u00ean \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t hi\u1ec7n t\u1ea1i t\u1eeb $v_0$ \u0111\u1ebfn $i$. C\u0169ng gi\u1ed1ng nh\u01b0 m\u1ea3ng $d$, m\u1ea3ng $p$ thay \u0111\u1ed5i d\u1ea7n d\u1ea7n trong thu\u1eadt to\u00e1n v\u00e0 cu\u1ed1i c\u00f9ng nh\u1eadn c\u00e1c gi\u00e1 tr\u1ecb cu\u1ed1i c\u00f9ng c\u1ee7a n\u00f3.</p> <p>B\u00e2y gi\u1edd \u0111\u1ebfn thu\u1eadt to\u00e1n. \u1ede m\u1ed7i b\u01b0\u1edbc, ba t\u1eadp h\u1ee3p \u0111\u1ec9nh \u0111\u01b0\u1ee3c duy tr\u00ec:</p> <ul> <li>$M_0$ - c\u00e1c \u0111\u1ec9nh, m\u00e0 kho\u1ea3ng c\u00e1ch \u0111\u00e3 \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n (m\u1eb7c d\u00f9 n\u00f3 c\u00f3 th\u1ec3 kh\u00f4ng ph\u1ea3i l\u00e0 kho\u1ea3ng c\u00e1ch cu\u1ed1i c\u00f9ng)</li> <li>$M_1$ - c\u00e1c \u0111\u1ec9nh, m\u00e0 kho\u1ea3ng c\u00e1ch hi\u1ec7n \u0111ang \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n</li> <li>$M_2$ - c\u00e1c \u0111\u1ec9nh, m\u00e0 kho\u1ea3ng c\u00e1ch v\u1eabn ch\u01b0a \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n</li> </ul> <p>C\u00e1c \u0111\u1ec9nh trong t\u1eadp h\u1ee3p $M_1$ \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef trong m\u1ed9t h\u00e0ng \u0111\u1ee3i hai \u0111\u1ea7u (deque).</p> <p>\u1ede m\u1ed7i b\u01b0\u1edbc c\u1ee7a thu\u1eadt to\u00e1n, ch\u00fang ta l\u1ea5y m\u1ed9t \u0111\u1ec9nh t\u1eeb t\u1eadp h\u1ee3p $M_1$ (t\u1eeb \u0111\u1ea7u h\u00e0ng \u0111\u1ee3i). G\u1ecdi $u$ l\u00e0 \u0111\u1ec9nh \u0111\u01b0\u1ee3c ch\u1ecdn. Ch\u00fang ta \u0111\u1eb7t \u0111\u1ec9nh $u$ n\u00e0y v\u00e0o t\u1eadp h\u1ee3p $M_0$. Sau \u0111\u00f3, ch\u00fang ta l\u1eb7p qua t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh \u0111i ra t\u1eeb \u0111\u1ec9nh n\u00e0y. G\u1ecdi $v$ l\u00e0 \u0111\u1ea7u m\u00fat th\u1ee9 hai c\u1ee7a c\u1ea1nh hi\u1ec7n t\u1ea1i, v\u00e0 $w$ l\u00e0 tr\u1ecdng s\u1ed1 c\u1ee7a n\u00f3.</p> <ul> <li>N\u1ebfu $v$ thu\u1ed9c v\u1ec1 $M_2$, th\u00ec $v$ \u0111\u01b0\u1ee3c ch\u00e8n v\u00e0o t\u1eadp h\u1ee3p $M_1$ b\u1eb1ng c\u00e1ch ch\u00e8n n\u00f3 v\u00e0o cu\u1ed1i h\u00e0ng \u0111\u1ee3i. $d_v$ \u0111\u01b0\u1ee3c \u0111\u1eb7t th\u00e0nh $d_u + w$.</li> <li>N\u1ebfu $v$ thu\u1ed9c v\u1ec1 $M_1$, th\u00ec ch\u00fang ta c\u1ed1 g\u1eafng c\u1ea3i thi\u1ec7n gi\u00e1 tr\u1ecb c\u1ee7a $d_v$: $d_v = \\min(d_v, d_u + w)$. V\u00ec $v$ \u0111\u00e3 \u1edf trong $M_1$, ch\u00fang ta kh\u00f4ng c\u1ea7n ch\u00e8n n\u00f3 v\u00e0o $M_1$ v\u00e0 h\u00e0ng \u0111\u1ee3i.</li> <li>N\u1ebfu $v$ thu\u1ed9c v\u1ec1 $M_0$, v\u00e0 n\u1ebfu $d_v$ c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c c\u1ea3i thi\u1ec7n $d_v &gt; d_u + w$, th\u00ec ch\u00fang ta c\u1ea3i thi\u1ec7n $d_v$ v\u00e0 ch\u00e8n \u0111\u1ec9nh $v$ tr\u1edf l\u1ea1i t\u1eadp h\u1ee3p $M_1$, \u0111\u1eb7t n\u00f3 \u1edf \u0111\u1ea7u h\u00e0ng \u0111\u1ee3i.</li> </ul> <p>V\u00e0 t\u1ea5t nhi\u00ean, v\u1edbi m\u1ed7i l\u1ea7n c\u1eadp nh\u1eadt trong m\u1ea3ng $d$, ch\u00fang ta c\u0169ng ph\u1ea3i c\u1eadp nh\u1eadt ph\u1ea7n t\u1eed t\u01b0\u01a1ng \u1ee9ng trong m\u1ea3ng $p$.</p>","tags":["Translated"]},{"location":"graph/desopo_pape.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>Ch\u00fang ta s\u1ebd s\u1eed d\u1ee5ng m\u1ed9t m\u1ea3ng $m$ \u0111\u1ec3 l\u01b0u tr\u1eef t\u1eadp h\u1ee3p m\u00e0 m\u1ed7i \u0111\u1ec9nh hi\u1ec7n \u0111ang \u1edf.</p> <pre><code>struct Edge {\n    int to, w;\n};\n\nint n;\nvector&lt;vector&lt;Edge&gt;&gt; adj;\n\nconst int INF = 1e9;\n\nvoid shortest_paths(int v0, vector&lt;int&gt;&amp; d, vector&lt;int&gt;&amp; p) {\n    d.assign(n, INF);\n    d[v0] = 0;\n    vector&lt;int&gt; m(n, 2);\n    deque&lt;int&gt; q;\n    q.push_back(v0);\n    p.assign(n, -1);\n\n    while (!q.empty()) {\n        int u = q.front();\n        q.pop_front();\n        m[u] = 0;\n        for (Edge e : adj[u]) {\n            if (d[e.to] &gt; d[u] + e.w) {\n                d[e.to] = d[u] + e.w;\n                p[e.to] = u;\n                if (m[e.to] == 2) {\n                    m[e.to] = 1;\n                    q.push_back(e.to);\n                } else if (m[e.to] == 0) {\n                    m[e.to] = 1;\n                    q.push_front(e.to);\n                }\n            }\n        }\n    }\n}\n</code></pre>","tags":["Translated"]},{"location":"graph/desopo_pape.html#complexity","title":"\u0110\u1ed9 ph\u1ee9c t\u1ea1p (Complexity)","text":"<p>Thu\u1eadt to\u00e1n th\u01b0\u1eddng th\u1ef1c hi\u1ec7n kh\u00e1 nhanh - trong h\u1ea7u h\u1ebft c\u00e1c tr\u01b0\u1eddng h\u1ee3p, th\u1eadm ch\u00ed c\u00f2n nhanh h\u01a1n thu\u1eadt to\u00e1n c\u1ee7a Dijkstra. Tuy nhi\u00ean, t\u1ed3n t\u1ea1i c\u00e1c tr\u01b0\u1eddng h\u1ee3p m\u00e0 thu\u1eadt to\u00e1n t\u1ed1n th\u1eddi gian theo h\u00e0m m\u0169, khi\u1ebfn n\u00f3 kh\u00f4ng ph\u00f9 h\u1ee3p trong tr\u01b0\u1eddng h\u1ee3p x\u1ea5u nh\u1ea5t. Xem c\u00e1c cu\u1ed9c th\u1ea3o lu\u1eadn tr\u00ean Stack Overflow v\u00e0 Codeforces \u0111\u1ec3 tham kh\u1ea3o.</p>","tags":["Translated"]},{"location":"graph/dijkstra.html","title":"Thu\u1eadt to\u00e1n Dijkstra (Dijkstra Algorithm)","text":"<p>B\u1ea1n \u0111\u01b0\u1ee3c cho m\u1ed9t \u0111\u1ed3 th\u1ecb c\u00f3 tr\u1ecdng s\u1ed1 c\u00f3 h\u01b0\u1edbng ho\u1eb7c v\u00f4 h\u01b0\u1edbng v\u1edbi $n$ \u0111\u1ec9nh v\u00e0 $m$ c\u1ea1nh. Tr\u1ecdng s\u1ed1 c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh l\u00e0 kh\u00f4ng \u00e2m. B\u1ea1n c\u0169ng \u0111\u01b0\u1ee3c cho m\u1ed9t \u0111\u1ec9nh b\u1eaft \u0111\u1ea7u $s$. B\u00e0i vi\u1ebft n\u00e0y th\u1ea3o lu\u1eadn v\u1ec1 vi\u1ec7c t\u00ecm \u0111\u1ed9 d\u00e0i c\u1ee7a c\u00e1c \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t t\u1eeb m\u1ed9t \u0111\u1ec9nh b\u1eaft \u0111\u1ea7u $s$ \u0111\u1ebfn t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh kh\u00e1c, v\u00e0 \u0111\u01b0a ra ch\u00ednh c\u00e1c \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t.</p> <p>B\u00e0i to\u00e1n n\u00e0y c\u0169ng \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 b\u00e0i to\u00e1n \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t t\u1eeb m\u1ed9t ngu\u1ed3n \u0111\u01a1n (single-source shortest paths problem).</p>","tags":["Translated"]},{"location":"graph/dijkstra.html#algorithm","title":"Thu\u1eadt to\u00e1n (Algorithm)","text":"<p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u1ed9t thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 b\u1edfi nh\u00e0 khoa h\u1ecdc m\u00e1y t\u00ednh ng\u01b0\u1eddi H\u00e0 Lan Edsger W. Dijkstra v\u00e0o n\u0103m 1959.</p> <p>H\u00e3y t\u1ea1o m\u1ed9t m\u1ea3ng $d[]$ trong \u0111\u00f3 v\u1edbi m\u1ed7i \u0111\u1ec9nh $v$ ch\u00fang ta l\u01b0u tr\u1eef \u0111\u1ed9 d\u00e0i hi\u1ec7n t\u1ea1i c\u1ee7a \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t t\u1eeb $s$ \u0111\u1ebfn $v$ trong $d[v]$. Ban \u0111\u1ea7u $d[s] = 0$, v\u00e0 \u0111\u1ed1i v\u1edbi t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh kh\u00e1c, \u0111\u1ed9 d\u00e0i n\u00e0y b\u1eb1ng v\u00f4 c\u00f9ng. Trong c\u00e0i \u0111\u1eb7t, m\u1ed9t s\u1ed1 \u0111\u1ee7 l\u1edbn (\u0111\u01b0\u1ee3c \u0111\u1ea3m b\u1ea3o l\u1edbn h\u01a1n b\u1ea5t k\u1ef3 \u0111\u1ed9 d\u00e0i \u0111\u01b0\u1eddng \u0111i n\u00e0o c\u00f3 th\u1ec3) \u0111\u01b0\u1ee3c ch\u1ecdn l\u00e0m v\u00f4 c\u00f9ng.</p> $$d[v] = \\infty,~ v \\ne s$$ <p>Ngo\u00e0i ra, ch\u00fang ta duy tr\u00ec m\u1ed9t m\u1ea3ng Boolean $u[]$ l\u01b0u tr\u1eef cho m\u1ed7i \u0111\u1ec9nh $v$ xem n\u00f3 \u0111\u00e3 \u0111\u01b0\u1ee3c \u0111\u00e1nh d\u1ea5u hay ch\u01b0a. Ban \u0111\u1ea7u t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh \u0111\u1ec1u ch\u01b0a \u0111\u01b0\u1ee3c \u0111\u00e1nh d\u1ea5u:</p> $$u[v] = {\\rm false}$$ <p>Thu\u1eadt to\u00e1n Dijkstra ch\u1ea1y trong $n$ l\u1ea7n l\u1eb7p. T\u1ea1i m\u1ed7i l\u1ea7n l\u1eb7p, m\u1ed9t \u0111\u1ec9nh $v$ \u0111\u01b0\u1ee3c ch\u1ecdn l\u00e0 \u0111\u1ec9nh ch\u01b0a \u0111\u01b0\u1ee3c \u0111\u00e1nh d\u1ea5u c\u00f3 gi\u00e1 tr\u1ecb $d[v]$ nh\u1ecf nh\u1ea5t:</p> <p>R\u00f5 r\u00e0ng, trong l\u1ea7n l\u1eb7p \u0111\u1ea7u ti\u00ean, \u0111\u1ec9nh b\u1eaft \u0111\u1ea7u $s$ s\u1ebd \u0111\u01b0\u1ee3c ch\u1ecdn.</p> <p>\u0110\u1ec9nh $v$ \u0111\u01b0\u1ee3c ch\u1ecdn s\u1ebd \u0111\u01b0\u1ee3c \u0111\u00e1nh d\u1ea5u. Ti\u1ebfp theo, t\u1eeb \u0111\u1ec9nh $v$, c\u00e1c thao t\u00e1c n\u1edbi l\u1ecfng (relaxations) \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n: t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh c\u00f3 d\u1ea1ng $(v,\\text{to})$ \u0111\u01b0\u1ee3c xem x\u00e9t, v\u00e0 \u0111\u1ed1i v\u1edbi m\u1ed7i \u0111\u1ec9nh $\\text{to}$, thu\u1eadt to\u00e1n c\u1ed1 g\u1eafng c\u1ea3i thi\u1ec7n gi\u00e1 tr\u1ecb $d[\\text{to}]$. N\u1ebfu \u0111\u1ed9 d\u00e0i c\u1ee7a c\u1ea1nh hi\u1ec7n t\u1ea1i b\u1eb1ng $len$, m\u00e3 cho thao t\u00e1c n\u1edbi l\u1ecfng l\u00e0:</p> $$d[\\text{to}] = \\min (d[\\text{to}], d[v] + len)$$ <p>Sau khi t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh nh\u01b0 v\u1eady \u0111\u01b0\u1ee3c xem x\u00e9t, l\u1ea7n l\u1eb7p hi\u1ec7n t\u1ea1i k\u1ebft th\u00fac. Cu\u1ed1i c\u00f9ng, sau $n$ l\u1ea7n l\u1eb7p, t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh s\u1ebd \u0111\u01b0\u1ee3c \u0111\u00e1nh d\u1ea5u, v\u00e0 thu\u1eadt to\u00e1n k\u1ebft th\u00fac. Ch\u00fang t\u00f4i kh\u1eb3ng \u0111\u1ecbnh r\u1eb1ng c\u00e1c gi\u00e1 tr\u1ecb t\u00ecm \u0111\u01b0\u1ee3c $d[v]$ l\u00e0 \u0111\u1ed9 d\u00e0i c\u1ee7a c\u00e1c \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t t\u1eeb $s$ \u0111\u1ebfn t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh $v$.</p> <p>L\u01b0u \u00fd r\u1eb1ng n\u1ebfu m\u1ed9t s\u1ed1 \u0111\u1ec9nh kh\u00f4ng th\u1ec3 \u0111\u1ebfn \u0111\u01b0\u1ee3c t\u1eeb \u0111\u1ec9nh b\u1eaft \u0111\u1ea7u $s$, c\u00e1c gi\u00e1 tr\u1ecb $d[v]$ cho ch\u00fang s\u1ebd v\u1eabn l\u00e0 v\u00f4 c\u00f9ng. R\u00f5 r\u00e0ng, v\u00e0i l\u1ea7n l\u1eb7p cu\u1ed1i c\u00f9ng c\u1ee7a thu\u1eadt to\u00e1n s\u1ebd ch\u1ecdn nh\u1eefng \u0111\u1ec9nh \u0111\u00f3, nh\u01b0ng s\u1ebd kh\u00f4ng c\u00f3 c\u00f4ng vi\u1ec7c h\u1eefu \u00edch n\u00e0o \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n cho ch\u00fang. Do \u0111\u00f3, thu\u1eadt to\u00e1n c\u00f3 th\u1ec3 d\u1eebng l\u1ea1i ngay khi \u0111\u1ec9nh \u0111\u01b0\u1ee3c ch\u1ecdn c\u00f3 kho\u1ea3ng c\u00e1ch \u0111\u1ebfn n\u00f3 l\u00e0 v\u00f4 c\u00f9ng.</p>","tags":["Translated"]},{"location":"graph/dijkstra.html#restoring-shortest-paths","title":"Kh\u00f4i ph\u1ee5c \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t (Restoring Shortest Paths)","text":"<p>Th\u00f4ng th\u01b0\u1eddng ng\u01b0\u1eddi ta c\u1ea7n bi\u1ebft kh\u00f4ng ch\u1ec9 \u0111\u1ed9 d\u00e0i c\u1ee7a c\u00e1c \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t m\u00e0 c\u00f2n c\u1ea3 b\u1ea3n th\u00e2n c\u00e1c \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t. H\u00e3y xem c\u00e1ch duy tr\u00ec th\u00f4ng tin \u0111\u1ee7 \u0111\u1ec3 kh\u00f4i ph\u1ee5c \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t t\u1eeb $s$ \u0111\u1ebfn b\u1ea5t k\u1ef3 \u0111\u1ec9nh n\u00e0o. Ch\u00fang ta s\u1ebd duy tr\u00ec m\u1ed9t m\u1ea3ng c\u00e1c ti\u1ec1n b\u1ed1i (predecessors) $p[]$ trong \u0111\u00f3 \u0111\u1ed1i v\u1edbi m\u1ed7i \u0111\u1ec9nh $v \\ne s$, $p[v]$ l\u00e0 \u0111\u1ec9nh \u00e1p ch\u00f3t trong \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t t\u1eeb $s$ \u0111\u1ebfn $v$. \u1ede \u0111\u00e2y ch\u00fang ta s\u1eed d\u1ee5ng th\u1ef1c t\u1ebf l\u00e0 n\u1ebfu ch\u00fang ta l\u1ea5y \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t \u0111\u1ebfn m\u1ed9t \u0111\u1ec9nh $v$ n\u00e0o \u0111\u00f3 v\u00e0 lo\u1ea1i b\u1ecf $v$ kh\u1ecfi \u0111\u01b0\u1eddng \u0111i n\u00e0y, ch\u00fang ta s\u1ebd nh\u1eadn \u0111\u01b0\u1ee3c m\u1ed9t \u0111\u01b0\u1eddng \u0111i k\u1ebft th\u00fac t\u1ea1i \u0111\u1ec9nh $p[v]$, v\u00e0 \u0111\u01b0\u1eddng \u0111i n\u00e0y s\u1ebd l\u00e0 ng\u1eafn nh\u1ea5t cho \u0111\u1ec9nh $p[v]$. M\u1ea3ng c\u00e1c ti\u1ec1n b\u1ed1i n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 kh\u00f4i ph\u1ee5c \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t \u0111\u1ebfn b\u1ea5t k\u1ef3 \u0111\u1ec9nh n\u00e0o: b\u1eaft \u0111\u1ea7u v\u1edbi $v$, li\u00ean t\u1ee5c l\u1ea5y ti\u1ec1n b\u1ed1i c\u1ee7a \u0111\u1ec9nh hi\u1ec7n t\u1ea1i cho \u0111\u1ebfn khi ch\u00fang ta \u0111\u1ebfn \u0111\u1ec9nh b\u1eaft \u0111\u1ea7u $s$ \u0111\u1ec3 nh\u1eadn \u0111\u01b0\u1ee3c \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t c\u1ea7n thi\u1ebft v\u1edbi c\u00e1c \u0111\u1ec9nh \u0111\u01b0\u1ee3c li\u1ec7t k\u00ea theo th\u1ee9 t\u1ef1 ng\u01b0\u1ee3c l\u1ea1i. V\u00ec v\u1eady, \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t $P$ \u0111\u1ebfn \u0111\u1ec9nh $v$ b\u1eb1ng:</p> $$P = (s, \\ldots, p[p[p[v]]], p[p[v]], p[v], v)$$ <p>Vi\u1ec7c x\u00e2y d\u1ef1ng m\u1ea3ng c\u00e1c ti\u1ec1n b\u1ed1i n\u00e0y r\u1ea5t \u0111\u01a1n gi\u1ea3n: \u0111\u1ed1i v\u1edbi m\u1ed7i l\u1ea7n n\u1edbi l\u1ecfng th\u00e0nh c\u00f4ng, t\u1ee9c l\u00e0 khi \u0111\u1ed1i v\u1edbi m\u1ed9t s\u1ed1 \u0111\u1ec9nh \u0111\u00e3 ch\u1ecdn $v$, c\u00f3 s\u1ef1 c\u1ea3i thi\u1ec7n v\u1ec1 kho\u1ea3ng c\u00e1ch \u0111\u1ebfn m\u1ed9t s\u1ed1 \u0111\u1ec9nh $\\text{to}$, ch\u00fang ta c\u1eadp nh\u1eadt \u0111\u1ec9nh ti\u1ec1n b\u1ed1i cho $\\text{to}$ b\u1eb1ng \u0111\u1ec9nh $v$:</p> $$p[\\text{to}] = v$$","tags":["Translated"]},{"location":"graph/dijkstra.html#proof","title":"Ch\u1ee9ng minh (Proof)","text":"<p>Kh\u1eb3ng \u0111\u1ecbnh ch\u00ednh m\u00e0 t\u00ednh \u0111\u00fang \u0111\u1eafn c\u1ee7a thu\u1eadt to\u00e1n Dijkstra d\u1ef1a tr\u00ean \u0111\u00f3 l\u00e0:</p> <p>Sau khi b\u1ea5t k\u1ef3 \u0111\u1ec9nh $v$ n\u00e0o \u0111\u01b0\u1ee3c \u0111\u00e1nh d\u1ea5u, kho\u1ea3ng c\u00e1ch hi\u1ec7n t\u1ea1i \u0111\u1ebfn n\u00f3 $d[v]$ l\u00e0 ng\u1eafn nh\u1ea5t, v\u00e0 s\u1ebd kh\u00f4ng thay \u0111\u1ed5i n\u1eefa.</p> <p>Ch\u1ee9ng minh \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n b\u1eb1ng quy n\u1ea1p. \u0110\u1ed1i v\u1edbi l\u1ea7n l\u1eb7p \u0111\u1ea7u ti\u00ean, ph\u00e1t bi\u1ec3u n\u00e0y l\u00e0 hi\u1ec3n nhi\u00ean: \u0111\u1ec9nh duy nh\u1ea5t \u0111\u01b0\u1ee3c \u0111\u00e1nh d\u1ea5u l\u00e0 $s$, v\u00e0 kho\u1ea3ng c\u00e1ch \u0111\u1ebfn l\u00e0 $d[s] = 0$ th\u1ef1c s\u1ef1 l\u00e0 \u0111\u1ed9 d\u00e0i c\u1ee7a \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t \u0111\u1ebfn $s$. B\u00e2y gi\u1edd gi\u1ea3 s\u1eed ph\u00e1t bi\u1ec3u n\u00e0y \u0111\u00fang cho t\u1ea5t c\u1ea3 c\u00e1c l\u1ea7n l\u1eb7p tr\u01b0\u1edbc, t\u1ee9c l\u00e0 cho t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh \u0111\u00e3 \u0111\u01b0\u1ee3c \u0111\u00e1nh d\u1ea5u; h\u00e3y ch\u1ee9ng minh r\u1eb1ng n\u00f3 kh\u00f4ng b\u1ecb vi ph\u1ea1m sau khi l\u1ea7n l\u1eb7p hi\u1ec7n t\u1ea1i ho\u00e0n th\u00e0nh. G\u1ecdi $v$ l\u00e0 \u0111\u1ec9nh \u0111\u01b0\u1ee3c ch\u1ecdn trong l\u1ea7n l\u1eb7p hi\u1ec7n t\u1ea1i, t\u1ee9c l\u00e0 $v$ l\u00e0 \u0111\u1ec9nh m\u00e0 thu\u1eadt to\u00e1n s\u1ebd \u0111\u00e1nh d\u1ea5u. B\u00e2y gi\u1edd ch\u00fang ta ph\u1ea3i ch\u1ee9ng minh r\u1eb1ng $d[v]$ th\u1ef1c s\u1ef1 b\u1eb1ng \u0111\u1ed9 d\u00e0i c\u1ee7a \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t \u0111\u1ebfn n\u00f3 $l[v]$.</p> <p>Xem x\u00e9t \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t $P$ \u0111\u1ebfn \u0111\u1ec9nh $v$. \u0110\u01b0\u1eddng \u0111i n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c chia th\u00e0nh hai ph\u1ea7n: $P_1$ ch\u1ec9 bao g\u1ed3m c\u00e1c n\u00fat \u0111\u01b0\u1ee3c \u0111\u00e1nh d\u1ea5u (\u00edt nh\u1ea5t l\u00e0 \u0111\u1ec9nh b\u1eaft \u0111\u1ea7u $s$ l\u00e0 m\u1ed9t ph\u1ea7n c\u1ee7a $P_1$), v\u00e0 ph\u1ea7n c\u00f2n l\u1ea1i c\u1ee7a \u0111\u01b0\u1eddng \u0111i $P_2$ (n\u00f3 c\u00f3 th\u1ec3 bao g\u1ed3m m\u1ed9t \u0111\u1ec9nh \u0111\u01b0\u1ee3c \u0111\u00e1nh d\u1ea5u, nh\u01b0ng n\u00f3 lu\u00f4n b\u1eaft \u0111\u1ea7u b\u1eb1ng m\u1ed9t \u0111\u1ec9nh ch\u01b0a \u0111\u01b0\u1ee3c \u0111\u00e1nh d\u1ea5u). H\u00e3y k\u00fd hi\u1ec7u \u0111\u1ec9nh \u0111\u1ea7u ti\u00ean c\u1ee7a \u0111\u01b0\u1eddng \u0111i $P_2$ l\u00e0 $p$, v\u00e0 \u0111\u1ec9nh cu\u1ed1i c\u00f9ng c\u1ee7a \u0111\u01b0\u1eddng \u0111i $P_1$ l\u00e0 $q$.</p> <p>\u0110\u1ea7u ti\u00ean ch\u00fang ta ch\u1ee9ng minh ph\u00e1t bi\u1ec3u c\u1ee7a m\u00ecnh cho \u0111\u1ec9nh $p$, t\u1ee9c l\u00e0 h\u00e3y ch\u1ee9ng minh r\u1eb1ng $d[p] = l[p]$. \u0110i\u1ec1u n\u00e0y g\u1ea7n nh\u01b0 hi\u1ec3n nhi\u00ean: trong m\u1ed9t trong nh\u1eefng l\u1ea7n l\u1eb7p tr\u01b0\u1edbc \u0111\u00f3, ch\u00fang ta \u0111\u00e3 ch\u1ecdn \u0111\u1ec9nh $q$ v\u00e0 th\u1ef1c hi\u1ec7n n\u1edbi l\u1ecfng t\u1eeb n\u00f3. V\u00ec (theo l\u1ef1a ch\u1ecdn \u0111\u1ec9nh $p$) \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t \u0111\u1ebfn $p$ l\u00e0 \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t \u0111\u1ebfn $q$ c\u1ed9ng v\u1edbi c\u1ea1nh $(p,q)$, vi\u1ec7c n\u1edbi l\u1ecfng t\u1eeb $q$ \u0111\u1eb7t gi\u00e1 tr\u1ecb c\u1ee7a $d[p]$ th\u00e0nh \u0111\u1ed9 d\u00e0i c\u1ee7a \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t $l[p]$.</p> <p>V\u00ec tr\u1ecdng s\u1ed1 c\u1ee7a c\u00e1c c\u1ea1nh l\u00e0 kh\u00f4ng \u00e2m, \u0111\u1ed9 d\u00e0i c\u1ee7a \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t $l[p]$ (m\u00e0 ch\u00fang ta v\u1eeba ch\u1ee9ng minh b\u1eb1ng $d[p]$) kh\u00f4ng v\u01b0\u1ee3t qu\u00e1 \u0111\u1ed9 d\u00e0i $l[v]$ c\u1ee7a \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t \u0111\u1ebfn \u0111\u1ec9nh $v$. Cho r\u1eb1ng $l[v] \\le d[v]$ (b\u1edfi v\u00ec thu\u1eadt to\u00e1n Dijkstra kh\u00f4ng th\u1ec3 t\u00ecm th\u1ea5y m\u1ed9t c\u00e1ch ng\u1eafn h\u01a1n c\u00e1ch ng\u1eafn nh\u1ea5t c\u00f3 th\u1ec3), ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c b\u1ea5t \u0111\u1eb3ng th\u1ee9c:</p> $$d[p] = l[p] \\le l[v] \\le d[v]$$ <p>M\u1eb7t kh\u00e1c, v\u00ec c\u1ea3 hai \u0111\u1ec9nh $p$ v\u00e0 $v$ \u0111\u1ec1u ch\u01b0a \u0111\u01b0\u1ee3c \u0111\u00e1nh d\u1ea5u, v\u00e0 l\u1ea7n l\u1eb7p hi\u1ec7n t\u1ea1i \u0111\u00e3 ch\u1ecdn \u0111\u1ec9nh $v$, ch\u1ee9 kh\u00f4ng ph\u1ea3i $p$, ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c m\u1ed9t b\u1ea5t \u0111\u1eb3ng th\u1ee9c kh\u00e1c:</p> $$d[p] \\ge d[v]$$ <p>T\u1eeb hai b\u1ea5t \u0111\u1eb3ng th\u1ee9c n\u00e0y, ch\u00fang ta k\u1ebft lu\u1eadn r\u1eb1ng $d[p] = d[v]$, v\u00e0 sau \u0111\u00f3 t\u1eeb c\u00e1c ph\u01b0\u01a1ng tr\u00ecnh \u0111\u00e3 t\u00ecm th\u1ea5y tr\u01b0\u1edbc \u0111\u00f3, ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c:</p> $$d[v] = l[v]$$ <p>Q.E.D.</p>","tags":["Translated"]},{"location":"graph/dijkstra.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>Thu\u1eadt to\u00e1n Dijkstra th\u1ef1c hi\u1ec7n $n$ l\u1ea7n l\u1eb7p. Trong m\u1ed7i l\u1ea7n l\u1eb7p, n\u00f3 ch\u1ecdn m\u1ed9t \u0111\u1ec9nh ch\u01b0a \u0111\u01b0\u1ee3c \u0111\u00e1nh d\u1ea5u $v$ v\u1edbi gi\u00e1 tr\u1ecb th\u1ea5p nh\u1ea5t $d[v]$, \u0111\u00e1nh d\u1ea5u n\u00f3 v\u00e0 ki\u1ec3m tra t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh $(v, \\text{to})$ c\u1ed1 g\u1eafng c\u1ea3i thi\u1ec7n gi\u00e1 tr\u1ecb $d[\\text{to}]$.</p> <p>Th\u1eddi gian ch\u1ea1y c\u1ee7a thu\u1eadt to\u00e1n bao g\u1ed3m:</p> <ul> <li>$n$ l\u1ea7n t\u00ecm ki\u1ebfm m\u1ed9t \u0111\u1ec9nh c\u00f3 gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t $d[v]$ trong s\u1ed1 $O(n)$ \u0111\u1ec9nh ch\u01b0a \u0111\u01b0\u1ee3c \u0111\u00e1nh d\u1ea5u</li> <li>$m$ l\u1ea7n th\u1eed n\u1edbi l\u1ecfng</li> </ul> <p>\u0110\u1ed1i v\u1edbi c\u00e1ch c\u00e0i \u0111\u1eb7t \u0111\u01a1n gi\u1ea3n nh\u1ea5t c\u1ee7a c\u00e1c thao t\u00e1c n\u00e0y, tr\u00ean m\u1ed7i l\u1ea7n l\u1eb7p, t\u00ecm ki\u1ebfm \u0111\u1ec9nh y\u00eau c\u1ea7u $O(n)$ thao t\u00e1c, v\u00e0 m\u1ed7i l\u1ea7n n\u1edbi l\u1ecfng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong $O(1)$. Do \u0111\u00f3, h\u00e0nh vi ti\u1ec7m c\u1eadn k\u1ebft qu\u1ea3 c\u1ee7a thu\u1eadt to\u00e1n l\u00e0:</p> $$O(n^2+m)$$ <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p n\u00e0y l\u00e0 t\u1ed1i \u01b0u cho \u0111\u1ed3 th\u1ecb d\u00e0y, t\u1ee9c l\u00e0 khi $m \\approx n^2$. Tuy nhi\u00ean, trong c\u00e1c \u0111\u1ed3 th\u1ecb th\u01b0a, khi $m$ nh\u1ecf h\u01a1n nhi\u1ec1u so v\u1edbi s\u1ed1 l\u01b0\u1ee3ng c\u1ea1nh t\u1ed1i \u0111a $n^2$, b\u00e0i to\u00e1n c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i quy\u1ebft v\u1edbi \u0111\u1ed9 ph\u1ee9c t\u1ea1p $O(n \\log n + m)$. Thu\u1eadt to\u00e1n v\u00e0 c\u00e0i \u0111\u1eb7t c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y trong b\u00e0i vi\u1ebft Dijkstra tr\u00ean \u0111\u1ed3 th\u1ecb th\u01b0a.</p> <pre><code>const int INF = 1000000000;\nvector&lt;vector&lt;pair&lt;int, int&gt;&gt;&gt; adj;\n\nvoid dijkstra(int s, vector&lt;int&gt; &amp; d, vector&lt;int&gt; &amp; p) {\n    int n = adj.size();\n    d.assign(n, INF);\n    p.assign(n, -1);\n    vector&lt;bool&gt; u(n, false);\n\n    d[s] = 0;\n    for (int i = 0; i &lt; n; i++) {\n        int v = -1;\n        for (int j = 0; j &lt; n; j++) {\n            if (!u[j] &amp;&amp; (v == -1 || d[j] &lt; d[v]))\n                v = j;\n        }\n\n        if (d[v] == INF)\n            break;\n\n        u[v] = true;\n        for (auto edge : adj[v]) {\n            int to = edge.first;\n            int len = edge.second;\n\n            if (d[v] + len &lt; d[to]) {\n                d[to] = d[v] + len;\n                p[to] = v;\n            }\n        }\n    }\n}\n</code></pre> <p>\u1ede \u0111\u00e2y \u0111\u1ed3 th\u1ecb $\\text{adj}$ \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef d\u01b0\u1edbi d\u1ea1ng danh s\u00e1ch k\u1ec1: \u0111\u1ed1i v\u1edbi m\u1ed7i \u0111\u1ec9nh $v$, $\\text{adj}[v]$ ch\u1ee9a danh s\u00e1ch c\u00e1c c\u1ea1nh \u0111i t\u1eeb \u0111\u1ec9nh n\u00e0y, t\u1ee9c l\u00e0 danh s\u00e1ch <code>pair&lt;int,int&gt;</code> trong \u0111\u00f3 ph\u1ea7n t\u1eed \u0111\u1ea7u ti\u00ean trong c\u1eb7p l\u00e0 \u0111\u1ec9nh \u1edf \u0111\u1ea7u kia c\u1ee7a c\u1ea1nh, v\u00e0 ph\u1ea7n t\u1eed th\u1ee9 hai l\u00e0 tr\u1ecdng s\u1ed1 c\u1ea1nh.</p> <p>H\u00e0m nh\u1eadn \u0111\u1ec9nh b\u1eaft \u0111\u1ea7u $s$ v\u00e0 hai vector s\u1ebd \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng l\u00e0m gi\u00e1 tr\u1ecb tr\u1ea3 v\u1ec1.</p> <p>Tr\u01b0\u1edbc h\u1ebft, m\u00e3 kh\u1edfi t\u1ea1o c\u00e1c m\u1ea3ng: kho\u1ea3ng c\u00e1ch $d[]$, nh\u00e3n $u[]$ v\u00e0 ti\u1ec1n b\u1ed1i $p[]$. Sau \u0111\u00f3 n\u00f3 th\u1ef1c hi\u1ec7n $n$ l\u1ea7n l\u1eb7p. T\u1ea1i m\u1ed7i l\u1ea7n l\u1eb7p, \u0111\u1ec9nh $v$ \u0111\u01b0\u1ee3c ch\u1ecdn c\u00f3 kho\u1ea3ng c\u00e1ch nh\u1ecf nh\u1ea5t $d[v]$ trong s\u1ed1 t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh ch\u01b0a \u0111\u01b0\u1ee3c \u0111\u00e1nh d\u1ea5u. N\u1ebfu kho\u1ea3ng c\u00e1ch \u0111\u1ebfn \u0111\u1ec9nh \u0111\u00e3 ch\u1ecdn $v$ b\u1eb1ng v\u00f4 c\u00f9ng, thu\u1eadt to\u00e1n d\u1eebng l\u1ea1i. Ng\u01b0\u1ee3c l\u1ea1i, \u0111\u1ec9nh \u0111\u01b0\u1ee3c \u0111\u00e1nh d\u1ea5u v\u00e0 t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh \u0111i ra t\u1eeb \u0111\u1ec9nh n\u00e0y \u0111\u01b0\u1ee3c ki\u1ec3m tra. N\u1ebfu vi\u1ec7c n\u1edbi l\u1ecfng d\u1ecdc theo c\u1ea1nh l\u00e0 c\u00f3 th\u1ec3 (t\u1ee9c l\u00e0 kho\u1ea3ng c\u00e1ch $d[\\text{to}]$ c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c c\u1ea3i thi\u1ec7n), kho\u1ea3ng c\u00e1ch $d[\\text{to}]$ v\u00e0 ti\u1ec1n b\u1ed1i $p[\\text{to}]$ \u0111\u01b0\u1ee3c c\u1eadp nh\u1eadt.</p> <p>Sau khi th\u1ef1c hi\u1ec7n t\u1ea5t c\u1ea3 c\u00e1c l\u1ea7n l\u1eb7p, m\u1ea3ng $d[]$ l\u01b0u tr\u1eef \u0111\u1ed9 d\u00e0i c\u1ee7a c\u00e1c \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t \u0111\u1ebfn t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh, v\u00e0 m\u1ea3ng $p[]$ l\u01b0u tr\u1eef c\u00e1c ti\u1ec1n b\u1ed1i c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh (ngo\u1ea1i tr\u1eeb \u0111\u1ec9nh b\u1eaft \u0111\u1ea7u $s$). \u0110\u01b0\u1eddng \u0111i \u0111\u1ebfn b\u1ea5t k\u1ef3 \u0111\u1ec9nh $t$ n\u00e0o c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c kh\u00f4i ph\u1ee5c theo c\u00e1ch sau:</p> <pre><code>vector&lt;int&gt; restore_path(int s, int t, vector&lt;int&gt; const&amp; p) {\n    vector&lt;int&gt; path;\n\n    for (int v = t; v != s; v = p[v])\n        path.push_back(v);\n    path.push_back(s);\n\n    reverse(path.begin(), path.end());\n    return path;\n}\n</code></pre>","tags":["Translated"]},{"location":"graph/dijkstra.html#references","title":"Tham kh\u1ea3o (References)","text":"<ul> <li>Edsger Dijkstra. A note on two problems in connexion with graphs [1959]</li> <li>Thomas Cormen, Charles Leiserson, Ronald Rivest, Clifford Stein. Introduction to Algorithms [2005]</li> </ul>","tags":["Translated"]},{"location":"graph/dijkstra.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>Timus - Ivan's Car [Difficulty:Medium]</li> <li>Timus - Sightseeing Trip</li> <li>SPOJ - SHPATH [Difficulty:Easy]</li> <li>Codeforces - Dijkstra? [Difficulty:Easy]</li> <li>Codeforces - Shortest Path</li> <li>Codeforces - Jzzhu and Cities</li> <li>Codeforces - The Classic Problem</li> <li>Codeforces - President and Roads</li> <li>Codeforces - Complete The Graph</li> <li>TopCoder - SkiResorts</li> <li>TopCoder - MaliciousPath</li> <li>SPOJ - Ada and Trip</li> <li>LA - 3850 - Here We Go(relians) Again</li> <li>GYM - Destination Unknown (D)</li> <li>UVA 12950 - Even Obsession</li> <li>GYM - Journey to Grece (A)</li> <li>UVA 13030 - Brain Fry</li> <li>UVA 1027 - Toll</li> <li>UVA 11377 - Airport Setup</li> <li>Codeforces - Dynamic Shortest Path</li> <li>UVA 11813 - Shopping</li> <li>UVA 11833 - Route Change</li> <li>SPOJ - Easy Dijkstra Problem</li> <li>LA - 2819 - Cave Raider</li> <li>UVA 12144 - Almost Shortest Path</li> <li>UVA 12047 - Highest Paid Toll</li> <li>UVA 11514 - Batman</li> <li>Codeforces - Team Rocket Rises Again</li> <li>UVA - 11338 - Minefield</li> <li>UVA 11374 - Airport Express</li> <li>UVA 11097 - Poor My Problem</li> <li>UVA 13172 - The music teacher</li> <li>Codeforces - Dirty Arkady's Kitchen</li> <li>SPOJ - Delivery Route</li> <li>SPOJ - Costly Chess</li> <li>CSES - Shortest Routes 1</li> <li>CSES - Flight Discount</li> <li>CSES - Flight Routes</li> </ul>","tags":["Translated"]},{"location":"graph/dijkstra_sparse.html","title":"Dijkstra tr\u00ean \u0111\u1ed3 th\u1ecb th\u01b0a (Dijkstra on sparse graphs)","text":"<p>\u0110\u1ed1i v\u1edbi ph\u00e1t bi\u1ec3u c\u1ee7a b\u00e0i to\u00e1n, thu\u1eadt to\u00e1n v\u1edbi c\u00e0i \u0111\u1eb7t v\u00e0 ch\u1ee9ng minh c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y trong b\u00e0i vi\u1ebft Thu\u1eadt to\u00e1n Dijkstra.</p>","tags":["Translated"]},{"location":"graph/dijkstra_sparse.html#algorithm","title":"Thu\u1eadt to\u00e1n (Algorithm)","text":"<p>Ch\u00fang ta nh\u1edb l\u1ea1i trong vi\u1ec7c t\u00ednh to\u00e1n \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a thu\u1eadt to\u00e1n Dijkstra, ch\u00fang ta \u0111\u00e3 s\u1eed d\u1ee5ng hai y\u1ebfu t\u1ed1: th\u1eddi gian t\u00ecm \u0111\u1ec9nh ch\u01b0a \u0111\u01b0\u1ee3c \u0111\u00e1nh d\u1ea5u c\u00f3 kho\u1ea3ng c\u00e1ch nh\u1ecf nh\u1ea5t $d[v]$, v\u00e0 th\u1eddi gian n\u1edbi l\u1ecfng, t\u1ee9c l\u00e0 th\u1eddi gian thay \u0111\u1ed5i c\u00e1c gi\u00e1 tr\u1ecb $d[\\text{to}]$.</p> <p>Trong c\u00e0i \u0111\u1eb7t \u0111\u01a1n gi\u1ea3n nh\u1ea5t, c\u00e1c thao t\u00e1c n\u00e0y y\u00eau c\u1ea7u th\u1eddi gian $O(n)$ v\u00e0 $O(1)$. Do \u0111\u00f3, v\u00ec ch\u00fang ta th\u1ef1c hi\u1ec7n thao t\u00e1c \u0111\u1ea7u ti\u00ean $O(n)$ l\u1ea7n, v\u00e0 thao t\u00e1c th\u1ee9 hai $O(m)$ l\u1ea7n, ch\u00fang ta thu \u0111\u01b0\u1ee3c \u0111\u1ed9 ph\u1ee9c t\u1ea1p $O(n^2 + m)$.</p> <p>R\u00f5 r\u00e0ng, \u0111\u1ed9 ph\u1ee9c t\u1ea1p n\u00e0y l\u00e0 t\u1ed1i \u01b0u cho m\u1ed9t \u0111\u1ed3 th\u1ecb d\u00e0y, t\u1ee9c l\u00e0 khi $m \\approx n^2$. Tuy nhi\u00ean, trong c\u00e1c \u0111\u1ed3 th\u1ecb th\u01b0a, khi $m$ nh\u1ecf h\u01a1n nhi\u1ec1u so v\u1edbi s\u1ed1 l\u01b0\u1ee3ng c\u1ea1nh t\u1ed1i \u0111a $n^2$, \u0111\u1ed9 ph\u1ee9c t\u1ea1p tr\u1edf n\u00ean k\u00e9m t\u1ed1i \u01b0u h\u01a1n v\u00ec s\u1ed1 h\u1ea1ng \u0111\u1ea7u ti\u00ean. V\u00ec v\u1eady, c\u1ea7n ph\u1ea3i c\u1ea3i thi\u1ec7n th\u1eddi gian th\u1ef1c hi\u1ec7n c\u1ee7a thao t\u00e1c \u0111\u1ea7u ti\u00ean (v\u00e0 t\u1ea5t nhi\u00ean l\u00e0 kh\u00f4ng \u1ea3nh h\u01b0\u1edfng nhi\u1ec1u \u0111\u1ebfn thao t\u00e1c th\u1ee9 hai).</p> <p>\u0110\u1ec3 th\u1ef1c hi\u1ec7n \u0111i\u1ec1u \u0111\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng m\u1ed9t bi\u1ebfn th\u1ec3 c\u1ee7a nhi\u1ec1u c\u1ea5u tr\u00fac d\u1eef li\u1ec7u b\u1ed5 tr\u1ee3. Hi\u1ec7u qu\u1ea3 nh\u1ea5t l\u00e0 Heap Fibonacci (Fibonacci heap), cho ph\u00e9p thao t\u00e1c \u0111\u1ea7u ti\u00ean ch\u1ea1y trong $O(\\log n)$, v\u00e0 thao t\u00e1c th\u1ee9 hai trong $O(1)$. Do \u0111\u00f3, ch\u00fang ta s\u1ebd nh\u1eadn \u0111\u01b0\u1ee3c \u0111\u1ed9 ph\u1ee9c t\u1ea1p $O(n \\log n + m)$ cho thu\u1eadt to\u00e1n Dijkstra, \u0111\u00e2y c\u0169ng l\u00e0 m\u1ee9c t\u1ed1i thi\u1ec3u l\u00fd thuy\u1ebft cho b\u00e0i to\u00e1n t\u00ecm ki\u1ebfm \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t. Do \u0111\u00f3 thu\u1eadt to\u00e1n n\u00e0y ho\u1ea1t \u0111\u1ed9ng t\u1ed1i \u01b0u, v\u00e0 Heap Fibonacci l\u00e0 c\u1ea5u tr\u00fac d\u1eef li\u1ec7u t\u1ed1i \u01b0u. Kh\u00f4ng t\u1ed3n t\u1ea1i b\u1ea5t k\u1ef3 c\u1ea5u tr\u00fac d\u1eef li\u1ec7u n\u00e0o c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n c\u1ea3 hai thao t\u00e1c trong $O(1)$, v\u00ec \u0111i\u1ec1u n\u00e0y c\u0169ng s\u1ebd cho ph\u00e9p s\u1eafp x\u1ebfp m\u1ed9t danh s\u00e1ch c\u00e1c s\u1ed1 ng\u1eabu nhi\u00ean trong th\u1eddi gian tuy\u1ebfn t\u00ednh, \u0111i\u1ec1u n\u00e0y l\u00e0 kh\u00f4ng th\u1ec3. Th\u1eadt th\u00fa v\u1ecb, c\u00f3 m\u1ed9t thu\u1eadt to\u00e1n c\u1ee7a Thorup t\u00ecm \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t trong th\u1eddi gian $O(m)$, tuy nhi\u00ean ch\u1ec9 ho\u1ea1t \u0111\u1ed9ng v\u1edbi tr\u1ecdng s\u1ed1 nguy\u00ean, v\u00e0 s\u1eed d\u1ee5ng m\u1ed9t \u00fd t\u01b0\u1edfng ho\u00e0n to\u00e0n kh\u00e1c. V\u00ec v\u1eady, \u0111i\u1ec1u n\u00e0y kh\u00f4ng d\u1eabn \u0111\u1ebfn b\u1ea5t k\u1ef3 m\u00e2u thu\u1eabn n\u00e0o. Heap Fibonacci cung c\u1ea5p \u0111\u1ed9 ph\u1ee9c t\u1ea1p t\u1ed1i \u01b0u cho t\u00e1c v\u1ee5 n\u00e0y. Tuy nhi\u00ean, ch\u00fang kh\u00e1 ph\u1ee9c t\u1ea1p \u0111\u1ec3 c\u00e0i \u0111\u1eb7t, v\u00e0 c\u0169ng c\u00f3 h\u1eb1ng s\u1ed1 \u1ea9n kh\u00e1 l\u1edbn.</p> <p>Nh\u01b0 m\u1ed9t s\u1ef1 th\u1ecfa hi\u1ec7p, b\u1ea1n c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng c\u00e1c c\u1ea5u tr\u00fac d\u1eef li\u1ec7u th\u1ef1c hi\u1ec7n c\u1ea3 hai lo\u1ea1i thao t\u00e1c (tr\u00edch xu\u1ea5t gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t v\u00e0 c\u1eadp nh\u1eadt m\u1ed9t ph\u1ea7n t\u1eed) trong $O(\\log n)$. Khi \u0111\u00f3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a thu\u1eadt to\u00e1n Dijkstra l\u00e0 $O(n \\log n + m \\log n) = O(m \\log n)$.</p> <p>C++ cung c\u1ea5p hai c\u1ea5u tr\u00fac d\u1eef li\u1ec7u nh\u01b0 v\u1eady: <code>set</code> v\u00e0 <code>priority_queue</code>. C\u00e1i \u0111\u1ea7u ti\u00ean d\u1ef1a tr\u00ean c\u00e2y \u0111\u1ecf-\u0111en, v\u00e0 c\u00e1i th\u1ee9 hai d\u1ef1a tr\u00ean heap (vun \u0111\u1ed1ng). Do \u0111\u00f3 <code>priority_queue</code> c\u00f3 h\u1eb1ng s\u1ed1 \u1ea9n nh\u1ecf h\u01a1n, nh\u01b0ng c\u0169ng c\u00f3 m\u1ed9t nh\u01b0\u1ee3c \u0111i\u1ec3m: n\u00f3 kh\u00f4ng h\u1ed7 tr\u1ee3 thao t\u00e1c x\u00f3a m\u1ed9t ph\u1ea7n t\u1eed. B\u1edfi v\u00ec \u0111i\u1ec1u n\u00e0y, ch\u00fang ta c\u1ea7n th\u1ef1c hi\u1ec7n m\u1ed9t \"gi\u1ea3i ph\u00e1p thay th\u1ebf\", th\u1ef1c t\u1ebf d\u1eabn \u0111\u1ebfn h\u1ec7 s\u1ed1 t\u1ec7 h\u01a1n m\u1ed9t ch\u00fat $\\log m$ thay v\u00ec $\\log n$ (m\u1eb7c d\u00f9 v\u1ec1 m\u1eb7t \u0111\u1ed9 ph\u1ee9c t\u1ea1p ch\u00fang l\u00e0 gi\u1ed1ng h\u1ec7t nhau).</p>","tags":["Translated"]},{"location":"graph/dijkstra_sparse.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"","tags":["Translated"]},{"location":"graph/dijkstra_sparse.html#set","title":"set","text":"<p>H\u00e3y b\u1eaft \u0111\u1ea7u v\u1edbi container <code>set</code>. V\u00ec ch\u00fang ta c\u1ea7n l\u01b0u tr\u1eef c\u00e1c \u0111\u1ec9nh \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp theo gi\u00e1 tr\u1ecb $d[]$ c\u1ee7a ch\u00fang, n\u00ean thu\u1eadn ti\u1ec7n \u0111\u1ec3 l\u01b0u tr\u1eef c\u00e1c c\u1eb7p th\u1ef1c t\u1ebf: kho\u1ea3ng c\u00e1ch v\u00e0 ch\u1ec9 s\u1ed1 c\u1ee7a \u0111\u1ec9nh. K\u1ebft qu\u1ea3 l\u00e0 trong m\u1ed9t <code>set</code>, c\u00e1c c\u1eb7p \u0111\u01b0\u1ee3c t\u1ef1 \u0111\u1ed9ng s\u1eafp x\u1ebfp theo kho\u1ea3ng c\u00e1ch c\u1ee7a ch\u00fang.</p> <pre><code>const int INF = 1000000000;\nvector&lt;vector&lt;pair&lt;int, int&gt;&gt;&gt; adj;\n\nvoid dijkstra(int s, vector&lt;int&gt; &amp; d, vector&lt;int&gt; &amp; p) {\n    int n = adj.size();\n    d.assign(n, INF);\n    p.assign(n, -1);\n\n    d[s] = 0;\n    set&lt;pair&lt;int, int&gt;&gt; q;\n    q.insert({0, s});\n    while (!q.empty()) {\n        int v = q.begin()-&gt;second;\n        q.erase(q.begin());\n\n        for (auto edge : adj[v]) {\n            int to = edge.first;\n            int len = edge.second;\n\n            if (d[v] + len &lt; d[to]) {\n                q.erase({d[to], to});\n                d[to] = d[v] + len;\n                p[to] = v;\n                q.insert({d[to], to});\n            }\n        }\n    }\n}\n</code></pre> <p>Ch\u00fang ta kh\u00f4ng c\u1ea7n m\u1ea3ng $u[]$ t\u1eeb c\u00e0i \u0111\u1eb7t thu\u1eadt to\u00e1n Dijkstra th\u00f4ng th\u01b0\u1eddng n\u1eefa. Ch\u00fang ta s\u1ebd s\u1eed d\u1ee5ng <code>set</code> \u0111\u1ec3 l\u01b0u tr\u1eef th\u00f4ng tin \u0111\u00f3, v\u00e0 c\u0169ng t\u00ecm \u0111\u1ec9nh c\u00f3 kho\u1ea3ng c\u00e1ch ng\u1eafn nh\u1ea5t v\u1edbi n\u00f3. N\u00f3 ho\u1ea1t \u0111\u1ed9ng gi\u1ed1ng nh\u01b0 m\u1ed9t h\u00e0ng \u0111\u1ee3i. C\u00e1c v\u00f2ng l\u1eb7p ch\u00ednh th\u1ef1c hi\u1ec7n cho \u0111\u1ebfn khi kh\u00f4ng c\u00f2n \u0111\u1ec9nh n\u00e0o trong set/h\u00e0ng \u0111\u1ee3i. M\u1ed9t \u0111\u1ec9nh c\u00f3 kho\u1ea3ng c\u00e1ch nh\u1ecf nh\u1ea5t \u0111\u01b0\u1ee3c tr\u00edch xu\u1ea5t, v\u00e0 \u0111\u1ed1i v\u1edbi m\u1ed7i l\u1ea7n n\u1edbi l\u1ecfng th\u00e0nh c\u00f4ng, tr\u01b0\u1edbc ti\u00ean ch\u00fang ta x\u00f3a c\u1eb7p c\u0169, v\u00e0 sau \u0111\u00f3 sau khi n\u1edbi l\u1ecfng th\u00eam c\u1eb7p m\u1edbi v\u00e0o h\u00e0ng \u0111\u1ee3i.</p>","tags":["Translated"]},{"location":"graph/dijkstra_sparse.html#priority_queue","title":"priority_queue","text":"<p>S\u1ef1 kh\u00e1c bi\u1ec7t ch\u00ednh \u0111\u1ed1i v\u1edbi vi\u1ec7c c\u00e0i \u0111\u1eb7t b\u1eb1ng <code>set</code> l\u00e0 trong nhi\u1ec1u ng\u00f4n ng\u1eef, bao g\u1ed3m C++, ch\u00fang ta kh\u00f4ng th\u1ec3 x\u00f3a c\u00e1c ph\u1ea7n t\u1eed kh\u1ecfi <code>priority_queue</code> (m\u1eb7c d\u00f9 heap c\u00f3 th\u1ec3 h\u1ed7 tr\u1ee3 thao t\u00e1c \u0111\u00f3 v\u1ec1 m\u1eb7t l\u00fd thuy\u1ebft). Do \u0111\u00f3 ch\u00fang ta ph\u1ea3i s\u1eed d\u1ee5ng m\u1ed9t gi\u1ea3i ph\u00e1p thay th\u1ebf: Ch\u00fang ta \u0111\u01a1n gi\u1ea3n l\u00e0 kh\u00f4ng x\u00f3a c\u1eb7p c\u0169 kh\u1ecfi h\u00e0ng \u0111\u1ee3i. K\u1ebft qu\u1ea3 l\u00e0 m\u1ed9t \u0111\u1ec9nh c\u00f3 th\u1ec3 xu\u1ea5t hi\u1ec7n nhi\u1ec1u l\u1ea7n v\u1edbi kho\u1ea3ng c\u00e1ch kh\u00e1c nhau trong h\u00e0ng \u0111\u1ee3i c\u00f9ng m\u1ed9t l\u00fac. Trong s\u1ed1 c\u00e1c c\u1eb7p n\u00e0y, ch\u00fang ta ch\u1ec9 quan t\u00e2m \u0111\u1ebfn c\u00e1c c\u1eb7p m\u00e0 ph\u1ea7n t\u1eed \u0111\u1ea7u ti\u00ean b\u1eb1ng v\u1edbi gi\u00e1 tr\u1ecb t\u01b0\u01a1ng \u1ee9ng trong $d[]$, t\u1ea5t c\u1ea3 c\u00e1c c\u1eb7p kh\u00e1c \u0111\u1ec1u l\u00e0 c\u0169. Do \u0111\u00f3, ch\u00fang ta c\u1ea7n th\u1ef1c hi\u1ec7n m\u1ed9t s\u1eeda \u0111\u1ed5i nh\u1ecf: khi b\u1eaft \u0111\u1ea7u m\u1ed7i l\u1ea7n l\u1eb7p, sau khi tr\u00edch xu\u1ea5t c\u1eb7p ti\u1ebfp theo, ch\u00fang ta ki\u1ec3m tra xem n\u00f3 c\u00f3 ph\u1ea3i l\u00e0 c\u1eb7p quan tr\u1ecdng hay kh\u00f4ng ho\u1eb7c n\u1ebfu n\u00f3 \u0111\u00e3 l\u00e0 m\u1ed9t c\u1eb7p c\u0169 v\u00e0 \u0111\u00e3 \u0111\u01b0\u1ee3c x\u1eed l\u00fd. Vi\u1ec7c ki\u1ec3m tra n\u00e0y r\u1ea5t quan tr\u1ecdng, n\u1ebfu kh\u00f4ng \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u00f3 th\u1ec3 t\u0103ng l\u00ean t\u1edbi $O(n m)$.</p> <p>Theo m\u1eb7c \u0111\u1ecbnh, m\u1ed9t <code>priority_queue</code> s\u1eafp x\u1ebfp c\u00e1c ph\u1ea7n t\u1eed theo th\u1ee9 t\u1ef1 gi\u1ea3m d\u1ea7n. \u0110\u1ec3 l\u00e0m cho n\u00f3 s\u1eafp x\u1ebfp c\u00e1c ph\u1ea7n t\u1eed theo th\u1ee9 t\u1ef1 t\u0103ng d\u1ea7n, ch\u00fang ta c\u00f3 th\u1ec3 l\u01b0u tr\u1eef kho\u1ea3ng c\u00e1ch ph\u1ee7 \u0111\u1ecbnh trong \u0111\u00f3, ho\u1eb7c chuy\u1ec3n cho n\u00f3 m\u1ed9t h\u00e0m s\u1eafp x\u1ebfp kh\u00e1c. Ch\u00fang ta s\u1ebd th\u1ef1c hi\u1ec7n t\u00f9y ch\u1ecdn th\u1ee9 hai.</p> <pre><code>const int INF = 1000000000;\nvector&lt;vector&lt;pair&lt;int, int&gt;&gt;&gt; adj;\n\nvoid dijkstra(int s, vector&lt;int&gt; &amp; d, vector&lt;int&gt; &amp; p) {\n    int n = adj.size();\n    d.assign(n, INF);\n    p.assign(n, -1);\n\n    d[s] = 0;\n    using pii = pair&lt;int, int&gt;;\n    priority_queue&lt;pii, vector&lt;pii&gt;, greater&lt;pii&gt;&gt; q;\n    q.push({0, s});\n    while (!q.empty()) {\n        int v = q.top().second;\n        int d_v = q.top().first;\n        q.pop();\n        if (d_v != d[v])\n            continue;\n\n        for (auto edge : adj[v]) {\n            int to = edge.first;\n            int len = edge.second;\n\n            if (d[v] + len &lt; d[to]) {\n                d[to] = d[v] + len;\n                p[to] = v;\n                q.push({d[to], to});\n            }\n        }\n    }\n}\n</code></pre> <p>Trong th\u1ef1c t\u1ebf, phi\u00ean b\u1ea3n <code>priority_queue</code> nhanh h\u01a1n m\u1ed9t ch\u00fat so v\u1edbi phi\u00ean b\u1ea3n d\u00f9ng <code>set</code>.</p> <p>Th\u1eadt th\u00fa v\u1ecb, m\u1ed9t b\u00e1o c\u00e1o k\u1ef9 thu\u1eadt n\u0103m 2007 \u0111\u00e3 k\u1ebft lu\u1eadn r\u1eb1ng bi\u1ebfn th\u1ec3 c\u1ee7a thu\u1eadt to\u00e1n kh\u00f4ng s\u1eed d\u1ee5ng c\u00e1c ph\u00e9p to\u00e1n gi\u1ea3m kh\u00f3a (decrease-key) ch\u1ea1y nhanh h\u01a1n bi\u1ebfn th\u1ec3 gi\u1ea3m kh\u00f3a, v\u1edbi kho\u1ea3ng c\u00e1ch hi\u1ec7u su\u1ea5t l\u1edbn h\u01a1n \u0111\u1ed1i v\u1edbi c\u00e1c \u0111\u1ed3 th\u1ecb th\u01b0a.</p>","tags":["Translated"]},{"location":"graph/dijkstra_sparse.html#getting-rid-of-pairs","title":"Lo\u1ea1i b\u1ecf c\u00e1c c\u1eb7p (Getting rid of pairs)","text":"<p>B\u1ea1n c\u00f3 th\u1ec3 c\u1ea3i thi\u1ec7n hi\u1ec7u su\u1ea5t th\u00eam m\u1ed9t ch\u00fat n\u1ebfu b\u1ea1n kh\u00f4ng l\u01b0u tr\u1eef c\u00e1c c\u1eb7p trong c\u00e1c container, m\u00e0 ch\u1ec9 l\u01b0u tr\u1eef c\u00e1c ch\u1ec9 s\u1ed1 c\u1ee7a \u0111\u1ec9nh. Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, ch\u00fang ta ph\u1ea3i n\u1ea1p ch\u1ed3ng to\u00e1n t\u1eed so s\u00e1nh: n\u00f3 ph\u1ea3i so s\u00e1nh hai \u0111\u1ec9nh b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng kho\u1ea3ng c\u00e1ch \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef trong $d[]$.</p> <p>K\u1ebft qu\u1ea3 c\u1ee7a vi\u1ec7c n\u1edbi l\u1ecfng, kho\u1ea3ng c\u00e1ch c\u1ee7a m\u1ed9t s\u1ed1 \u0111\u1ec9nh s\u1ebd thay \u0111\u1ed5i. Tuy nhi\u00ean, c\u1ea5u tr\u00fac d\u1eef li\u1ec7u s\u1ebd kh\u00f4ng t\u1ef1 s\u1eafp x\u1ebfp l\u1ea1i ch\u00ednh n\u00f3. Tr\u00ean th\u1ef1c t\u1ebf, vi\u1ec7c thay \u0111\u1ed5i kho\u1ea3ng c\u00e1ch c\u1ee7a c\u00e1c \u0111\u1ec9nh trong h\u00e0ng \u0111\u1ee3i c\u00f3 th\u1ec3 ph\u00e1 h\u1ee7y c\u1ea5u tr\u00fac d\u1eef li\u1ec7u. Nh\u01b0 tr\u01b0\u1edbc \u0111\u00e2y, ch\u00fang ta c\u1ea7n x\u00f3a \u0111\u1ec9nh tr\u01b0\u1edbc khi n\u1edbi l\u1ecfng n\u00f3, v\u00e0 sau \u0111\u00f3 ch\u00e8n l\u1ea1i n\u00f3 sau \u0111\u00f3.</p> <p>V\u00ec ch\u00fang ta ch\u1ec9 c\u00f3 th\u1ec3 x\u00f3a kh\u1ecfi <code>set</code>, t\u1ed1i \u01b0u h\u00f3a n\u00e0y ch\u1ec9 \u00e1p d\u1ee5ng cho ph\u01b0\u01a1ng ph\u00e1p <code>set</code>, v\u00e0 kh\u00f4ng ho\u1ea1t \u0111\u1ed9ng v\u1edbi c\u00e0i \u0111\u1eb7t <code>priority_queue</code>. Trong th\u1ef1c t\u1ebf, \u0111i\u1ec1u n\u00e0y l\u00e0m t\u0103ng \u0111\u00e1ng k\u1ec3 hi\u1ec7u su\u1ea5t, \u0111\u1eb7c bi\u1ec7t l\u00e0 khi c\u00e1c ki\u1ec3u d\u1eef li\u1ec7u l\u1edbn h\u01a1n \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 l\u01b0u tr\u1eef kho\u1ea3ng c\u00e1ch, nh\u01b0 <code>long long</code> ho\u1eb7c <code>double</code>.</p>","tags":["Translated"]},{"location":"graph/dinic.html","title":"Lu\u1ed3ng c\u1ef1c \u0111\u1ea1i - Thu\u1eadt to\u00e1n Dinic (Maximum flow - Dinic's algorithm)","text":"<p>Thu\u1eadt to\u00e1n Dinic gi\u1ea3i quy\u1ebft b\u00e0i to\u00e1n lu\u1ed3ng c\u1ef1c \u0111\u1ea1i trong $O(V^2E)$. B\u00e0i to\u00e1n lu\u1ed3ng c\u1ef1c \u0111\u1ea1i \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a trong b\u00e0i vi\u1ebft n\u00e0y Lu\u1ed3ng c\u1ef1c \u0111\u1ea1i - Ford-Fulkerson v\u00e0 Edmonds-Karp. Thu\u1eadt to\u00e1n n\u00e0y \u0111\u01b0\u1ee3c ph\u00e1t hi\u1ec7n b\u1edfi Yefim Dinitz v\u00e0o n\u0103m 1970.</p>","tags":["Translated"]},{"location":"graph/dinic.html#definitions","title":"\u0110\u1ecbnh ngh\u0129a (Definitions)","text":"<p>M\u1ed9t m\u1ea1ng d\u01b0 (residual network) $G^R$ c\u1ee7a m\u1ea1ng $G$ l\u00e0 m\u1ed9t m\u1ea1ng ch\u1ee9a hai c\u1ea1nh cho m\u1ed7i c\u1ea1nh $(v, u)\\in G$:</p> <ul> <li>$(v, u)$ v\u1edbi dung l\u01b0\u1ee3ng $c_{vu}^R = c_{vu} - f_{vu}$</li> <li>$(u, v)$ v\u1edbi dung l\u01b0\u1ee3ng $c_{uv}^R = f_{vu}$</li> </ul> <p>M\u1ed9t lu\u1ed3ng ch\u1eafn (blocking flow) c\u1ee7a m\u1ed9t m\u1ea1ng n\u00e0o \u0111\u00f3 l\u00e0 m\u1ed9t lu\u1ed3ng sao cho m\u1ecdi \u0111\u01b0\u1eddng \u0111i t\u1eeb $s$ \u0111\u1ebfn $t$ ch\u1ee9a \u00edt nh\u1ea5t m\u1ed9t c\u1ea1nh b\u1ecb b\u00e3o h\u00f2a b\u1edfi lu\u1ed3ng n\u00e0y. L\u01b0u \u00fd r\u1eb1ng m\u1ed9t lu\u1ed3ng ch\u1eafn kh\u00f4ng nh\u1ea5t thi\u1ebft ph\u1ea3i l\u00e0 c\u1ef1c \u0111\u1ea1i.</p> <p>M\u1ed9t m\u1ea1ng ph\u00e2n l\u1edbp (layered network) c\u1ee7a m\u1ed9t m\u1ea1ng $G$ l\u00e0 m\u1ed9t m\u1ea1ng \u0111\u01b0\u1ee3c x\u00e2y d\u1ef1ng theo c\u00e1ch sau. \u0110\u1ea7u ti\u00ean, \u0111\u1ed1i v\u1edbi m\u1ed7i \u0111\u1ec9nh $v$, ch\u00fang ta t\u00ednh to\u00e1n $level[v]$ - \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t (kh\u00f4ng tr\u1ecdng s\u1ed1) t\u1eeb $s$ \u0111\u1ebfn \u0111\u1ec9nh n\u00e0y ch\u1ec9 s\u1eed d\u1ee5ng c\u00e1c c\u1ea1nh c\u00f3 dung l\u01b0\u1ee3ng d\u01b0\u01a1ng. Sau \u0111\u00f3 ch\u00fang ta ch\u1ec9 gi\u1eef l\u1ea1i nh\u1eefng c\u1ea1nh $(v, u)$ m\u00e0 $level[v] + 1 = level[u]$. R\u00f5 r\u00e0ng, m\u1ea1ng n\u00e0y l\u00e0 kh\u00f4ng c\u00f3 chu tr\u00ecnh.</p>","tags":["Translated"]},{"location":"graph/dinic.html#algorithm","title":"Thu\u1eadt to\u00e1n (Algorithm)","text":"<p>Thu\u1eadt to\u00e1n bao g\u1ed3m nhi\u1ec1u pha. \u1ede m\u1ed7i pha, ch\u00fang ta x\u00e2y d\u1ef1ng m\u1ea1ng ph\u00e2n l\u1edbp c\u1ee7a m\u1ea1ng d\u01b0 c\u1ee7a $G$. Sau \u0111\u00f3 ch\u00fang ta t\u00ecm m\u1ed9t lu\u1ed3ng ch\u1eafn b\u1ea5t k\u1ef3 trong m\u1ea1ng ph\u00e2n l\u1edbp v\u00e0 th\u00eam n\u00f3 v\u00e0o lu\u1ed3ng hi\u1ec7n t\u1ea1i.</p>","tags":["Translated"]},{"location":"graph/dinic.html#proof-of-correctness","title":"Ch\u1ee9ng minh t\u00ednh \u0111\u00fang \u0111\u1eafn (Proof of correctness)","text":"<p>H\u00e3y ch\u1ec9 ra r\u1eb1ng n\u1ebfu thu\u1eadt to\u00e1n k\u1ebft th\u00fac, n\u00f3 t\u00ecm th\u1ea5y lu\u1ed3ng c\u1ef1c \u0111\u1ea1i.</p> <p>N\u1ebfu thu\u1eadt to\u00e1n \u0111\u00e3 k\u1ebft th\u00fac, n\u00f3 kh\u00f4ng th\u1ec3 t\u00ecm th\u1ea5y m\u1ed9t lu\u1ed3ng ch\u1eafn trong m\u1ea1ng ph\u00e2n l\u1edbp. \u0110i\u1ec1u \u0111\u00f3 c\u00f3 ngh\u0129a l\u00e0 m\u1ea1ng ph\u00e2n l\u1edbp kh\u00f4ng c\u00f3 b\u1ea5t k\u1ef3 \u0111\u01b0\u1eddng \u0111i n\u00e0o t\u1eeb $s$ \u0111\u1ebfn $t$. \u0110i\u1ec1u \u0111\u00f3 c\u00f3 ngh\u0129a l\u00e0 m\u1ea1ng d\u01b0 kh\u00f4ng c\u00f3 b\u1ea5t k\u1ef3 \u0111\u01b0\u1eddng \u0111i n\u00e0o t\u1eeb $s$ \u0111\u1ebfn $t$. \u0110i\u1ec1u \u0111\u00f3 c\u00f3 ngh\u0129a l\u00e0 lu\u1ed3ng l\u00e0 c\u1ef1c \u0111\u1ea1i.</p>","tags":["Translated"]},{"location":"graph/dinic.html#number-of-phases","title":"S\u1ed1 l\u01b0\u1ee3ng pha (Number of phases)","text":"<p>Thu\u1eadt to\u00e1n k\u1ebft th\u00fac trong \u00edt h\u01a1n $V$ pha. \u0110\u1ec3 ch\u1ee9ng minh \u0111i\u1ec1u n\u00e0y, ch\u00fang ta ph\u1ea3i ch\u1ee9ng minh tr\u01b0\u1edbc hai b\u1ed5 \u0111\u1ec1.</p> <p>B\u1ed5 \u0111\u1ec1 1. Kho\u1ea3ng c\u00e1ch t\u1eeb $s$ \u0111\u1ebfn m\u1ed7i \u0111\u1ec9nh kh\u00f4ng gi\u1ea3m sau m\u1ed7i l\u1ea7n l\u1eb7p, t\u1ee9c l\u00e0 $level_{i+1}[v] \\ge level_i[v]$.</p> <p>Ch\u1ee9ng minh. C\u1ed1 \u0111\u1ecbnh m\u1ed9t pha $i$ v\u00e0 m\u1ed9t \u0111\u1ec9nh $v$. Ph\u00e2n t\u00edch m\u1ed9t \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t b\u1ea5t k\u1ef3 $P$ t\u1eeb $s$ \u0111\u1ebfn $v$ trong $G_{i+1}^R$. \u0110\u1ed9 d\u00e0i c\u1ee7a $P$ b\u1eb1ng $level_{i+1}[v]$. L\u01b0u \u00fd r\u1eb1ng $G_{i+1}^R$ ch\u1ec9 c\u00f3 th\u1ec3 ch\u1ee9a c\u00e1c c\u1ea1nh t\u1eeb $G_i^R$ v\u00e0 c\u00e1c c\u1ea1nh ng\u01b0\u1ee3c cho c\u00e1c c\u1ea1nh t\u1eeb $G_i^R$. N\u1ebfu $P$ kh\u00f4ng c\u00f3 c\u1ea1nh ng\u01b0\u1ee3c n\u00e0o cho $G_i^R$, th\u00ec $level_{i+1}[v] \\ge level_i[v]$ v\u00ec $P$ c\u0169ng l\u00e0 m\u1ed9t \u0111\u01b0\u1eddng \u0111i trong $G_i^R$. B\u00e2y gi\u1edd, gi\u1ea3 s\u1eed r\u1eb1ng $P$ c\u00f3 \u00edt nh\u1ea5t m\u1ed9t c\u1ea1nh ng\u01b0\u1ee3c. G\u1ecdi c\u1ea1nh \u0111\u1ea7u ti\u00ean nh\u01b0 v\u1eady l\u00e0 $(u, w)$. Khi \u0111\u00f3 $level_{i+1}[u] \\ge level_i[u]$ (do tr\u01b0\u1eddng h\u1ee3p \u0111\u1ea7u ti\u00ean). C\u1ea1nh $(u, w)$ kh\u00f4ng thu\u1ed9c v\u1ec1 $G_i^R$, v\u00ec v\u1eady c\u1ea1nh $(w, u)$ \u0111\u00e3 b\u1ecb \u1ea3nh h\u01b0\u1edfng b\u1edfi lu\u1ed3ng ch\u1eafn \u1edf l\u1ea7n l\u1eb7p tr\u01b0\u1edbc. \u0110i\u1ec1u \u0111\u00f3 c\u00f3 ngh\u0129a l\u00e0 $level_i[u] = level_i[w] + 1$. Ngo\u00e0i ra, $level_{i+1}[w] = level_{i+1}[u] + 1$. T\u1eeb hai ph\u01b0\u01a1ng tr\u00ecnh n\u00e0y v\u00e0 $level_{i+1}[u] \\ge level_i[u]$ ch\u00fang ta thu \u0111\u01b0\u1ee3c $level_{i+1}[w] \\ge level_i[w] + 2$. B\u00e2y gi\u1edd ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng \u00fd t\u01b0\u1edfng t\u01b0\u01a1ng t\u1ef1 cho ph\u1ea7n c\u00f2n l\u1ea1i c\u1ee7a \u0111\u01b0\u1eddng \u0111i.</p> <p>B\u1ed5 \u0111\u1ec1 2. $level_{i+1}[t] &gt; level_i[t]$</p> <p>Ch\u1ee9ng minh. T\u1eeb b\u1ed5 \u0111\u1ec1 tr\u01b0\u1edbc, $level_{i+1}[t] \\ge level_i[t]$. Gi\u1ea3 s\u1eed r\u1eb1ng $level_{i+1}[t] = level_i[t]$. L\u01b0u \u00fd r\u1eb1ng $G_{i+1}^R$ ch\u1ec9 c\u00f3 th\u1ec3 ch\u1ee9a c\u00e1c c\u1ea1nh t\u1eeb $G_i^R$ v\u00e0 c\u00e1c c\u1ea1nh ng\u01b0\u1ee3c cho c\u00e1c c\u1ea1nh t\u1eeb $G_i^R$. \u0110i\u1ec1u \u0111\u00f3 c\u00f3 ngh\u0129a l\u00e0 c\u00f3 m\u1ed9t \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t trong $G_i^R$ m\u00e0 kh\u00f4ng b\u1ecb ch\u1eb7n b\u1edfi lu\u1ed3ng ch\u1eafn. \u0110\u00f3 l\u00e0 m\u1ed9t m\u00e2u thu\u1eabn.</p> <p>T\u1eeb hai b\u1ed5 \u0111\u1ec1 n\u00e0y, ch\u00fang ta k\u1ebft lu\u1eadn r\u1eb1ng c\u00f3 \u00edt h\u01a1n $V$ pha v\u00ec $level[t]$ t\u0103ng, nh\u01b0ng n\u00f3 kh\u00f4ng th\u1ec3 l\u1edbn h\u01a1n $V - 1$.</p>","tags":["Translated"]},{"location":"graph/dinic.html#finding-blocking-flow","title":"T\u00ecm lu\u1ed3ng ch\u1eafn (Finding blocking flow)","text":"<p>\u0111\u1ec3 t\u00ecm lu\u1ed3ng ch\u1eafn tr\u00ean m\u1ed7i l\u1ea7n l\u1eb7p, ch\u00fang ta c\u00f3 th\u1ec3 \u0111\u01a1n gi\u1ea3n th\u1eed \u0111\u1ea9y lu\u1ed3ng b\u1eb1ng DFS t\u1eeb $s$ \u0111\u1ebfn $t$ trong m\u1ea1ng ph\u00e2n l\u1edbp trong khi n\u00f3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c \u0111\u1ea9y. \u0110\u1ec3 th\u1ef1c hi\u1ec7n nhanh h\u01a1n, ch\u00fang ta ph\u1ea3i lo\u1ea1i b\u1ecf c\u00e1c c\u1ea1nh kh\u00f4ng th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 \u0111\u1ea9y n\u1eefa. \u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y ch\u00fang ta c\u00f3 th\u1ec3 gi\u1eef m\u1ed9t con tr\u1ecf trong m\u1ed7i \u0111\u1ec9nh tr\u1ecf \u0111\u1ebfn c\u1ea1nh ti\u1ebfp theo c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng.</p> <p>M\u1ed9t l\u1ea7n ch\u1ea1y DFS duy nh\u1ea5t m\u1ea5t th\u1eddi gian $O(k+V)$, trong \u0111\u00f3 $k$ l\u00e0 s\u1ed1 l\u1ea7n di chuy\u1ec3n con tr\u1ecf trong l\u1ea7n ch\u1ea1y n\u00e0y. T\u1ed5ng c\u1ed9ng tr\u00ean t\u1ea5t c\u1ea3 c\u00e1c l\u1ea7n ch\u1ea1y, s\u1ed1 l\u1ea7n di chuy\u1ec3n con tr\u1ecf kh\u00f4ng th\u1ec3 v\u01b0\u1ee3t qu\u00e1 $E$. M\u1eb7t kh\u00e1c, t\u1ed5ng s\u1ed1 l\u1ea7n ch\u1ea1y s\u1ebd kh\u00f4ng v\u01b0\u1ee3t qu\u00e1 $E$, v\u00ec m\u1ed7i l\u1ea7n ch\u1ea1y l\u00e0m b\u00e3o h\u00f2a \u00edt nh\u1ea5t m\u1ed9t c\u1ea1nh. B\u1eb1ng c\u00e1ch n\u00e0y, t\u1ed5ng th\u1eddi gian ch\u1ea1y \u0111\u1ec3 t\u00ecm m\u1ed9t lu\u1ed3ng ch\u1eafn l\u00e0 $O(VE)$.</p>","tags":["Translated"]},{"location":"graph/dinic.html#complexity","title":"\u0110\u1ed9 ph\u1ee9c t\u1ea1p (Complexity)","text":"<p>C\u00f3 \u00edt h\u01a1n $V$ pha, v\u00ec v\u1eady t\u1ed5ng \u0111\u1ed9 ph\u1ee9c t\u1ea1p l\u00e0 $O(V^2E)$.</p>","tags":["Translated"]},{"location":"graph/dinic.html#unit-networks","title":"M\u1ea1ng \u0111\u01a1n v\u1ecb (Unit networks)","text":"<p>M\u1ed9t m\u1ea1ng \u0111\u01a1n v\u1ecb l\u00e0 m\u1ed9t m\u1ea1ng trong \u0111\u00f3 \u0111\u1ed1i v\u1edbi b\u1ea5t k\u1ef3 \u0111\u1ec9nh n\u00e0o ngo\u1ea1i tr\u1eeb $s$ v\u00e0 $t$, c\u1ea1nh \u0111i v\u00e0o ho\u1eb7c c\u1ea1nh \u0111i ra l\u00e0 duy nh\u1ea5t v\u00e0 c\u00f3 dung l\u01b0\u1ee3ng \u0111\u01a1n v\u1ecb. \u0110\u00f3 ch\u00ednh x\u00e1c l\u00e0 tr\u01b0\u1eddng h\u1ee3p v\u1edbi m\u1ea1ng ch\u00fang ta x\u00e2y d\u1ef1ng \u0111\u1ec3 gi\u1ea3i quy\u1ebft b\u00e0i to\u00e1n gh\u00e9p c\u1eb7p c\u1ef1c \u0111\u1ea1i b\u1eb1ng lu\u1ed3ng.</p> <p>Tr\u00ean c\u00e1c m\u1ea1ng \u0111\u01a1n v\u1ecb, thu\u1eadt to\u00e1n Dinic ho\u1ea1t \u0111\u1ed9ng trong $O(E\\sqrt{V})$. H\u00e3y ch\u1ee9ng minh \u0111i\u1ec1u n\u00e0y.</p> <p>Th\u1ee9 nh\u1ea5t, m\u1ed7i pha b\u00e2y gi\u1edd ho\u1ea1t \u0111\u1ed9ng trong $O(E)$ v\u00ec m\u1ed7i c\u1ea1nh s\u1ebd \u0111\u01b0\u1ee3c xem x\u00e9t t\u1ed1i \u0111a m\u1ed9t l\u1ea7n.</p> <p>Th\u1ee9 hai, gi\u1ea3 s\u1eed \u0111\u00e3 c\u00f3 $\\sqrt{V}$ pha. Khi \u0111\u00f3 t\u1ea5t c\u1ea3 c\u00e1c \u0111\u01b0\u1eddng t\u0103ng lu\u1ed3ng c\u00f3 \u0111\u1ed9 d\u00e0i $\\le\\sqrt{V}$ \u0111\u00e3 \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y. G\u1ecdi $f$ l\u00e0 lu\u1ed3ng hi\u1ec7n t\u1ea1i, $f'$ l\u00e0 lu\u1ed3ng c\u1ef1c \u0111\u1ea1i. X\u00e9t hi\u1ec7u c\u1ee7a ch\u00fang $f' - f$. N\u00f3 l\u00e0 m\u1ed9t lu\u1ed3ng trong $G^R$ c\u00f3 gi\u00e1 tr\u1ecb $|f'| - |f|$ v\u00e0 tr\u00ean m\u1ed7i c\u1ea1nh n\u00f3 ho\u1eb7c l\u00e0 $0$ ho\u1eb7c l\u00e0 $1$. N\u00f3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c ph\u00e2n t\u00e1ch th\u00e0nh $|f'| - |f|$ \u0111\u01b0\u1eddng \u0111i t\u1eeb $s$ \u0111\u1ebfn $t$ v\u00e0 c\u00f3 th\u1ec3 l\u00e0 c\u00e1c chu tr\u00ecnh. V\u00ec m\u1ea1ng l\u00e0 \u0111\u01a1n v\u1ecb, ch\u00fang kh\u00f4ng th\u1ec3 c\u00f3 c\u00e1c \u0111\u1ec9nh chung, v\u00ec v\u1eady t\u1ed5ng s\u1ed1 \u0111\u1ec9nh l\u00e0 $\\ge (|f'| - |f|)\\sqrt{V}$, nh\u01b0ng n\u00f3 c\u0169ng $\\le V$, v\u00ec v\u1eady trong $\\sqrt{V}$ l\u1ea7n l\u1eb7p n\u1eefa ch\u00fang ta ch\u1eafc ch\u1eafn s\u1ebd t\u00ecm th\u1ea5y lu\u1ed3ng c\u1ef1c \u0111\u1ea1i.</p>","tags":["Translated"]},{"location":"graph/dinic.html#unit-capacities-networks","title":"M\u1ea1ng dung l\u01b0\u1ee3ng \u0111\u01a1n v\u1ecb (Unit capacities networks)","text":"<p>Trong m\u1ed9t c\u00e0i \u0111\u1eb7t t\u1ed5ng qu\u00e1t h\u01a1n khi t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh c\u00f3 dung l\u01b0\u1ee3ng \u0111\u01a1n v\u1ecb, nh\u01b0ng s\u1ed1 l\u01b0\u1ee3ng c\u1ea1nh \u0111i v\u00e0o v\u00e0 \u0111i ra l\u00e0 kh\u00f4ng b\u1ecb ch\u1eb7n, c\u00e1c \u0111\u01b0\u1eddng \u0111i kh\u00f4ng th\u1ec3 c\u00f3 c\u00e1c c\u1ea1nh chung thay v\u00ec c\u00e1c \u0111\u1ec9nh chung. Theo m\u1ed9t c\u00e1ch t\u01b0\u01a1ng t\u1ef1, n\u00f3 cho ph\u00e9p ch\u1ee9ng minh gi\u1edbi h\u1ea1n c\u1ee7a $\\sqrt E$ v\u1ec1 s\u1ed1 l\u1ea7n l\u1eb7p, do \u0111\u00f3 th\u1eddi gian ch\u1ea1y c\u1ee7a thu\u1eadt to\u00e1n Dinic tr\u00ean c\u00e1c m\u1ea1ng nh\u01b0 v\u1eady t\u1ed1i \u0111a l\u00e0 $O(E \\sqrt E)$.</p> <p>Cu\u1ed1i c\u00f9ng, c\u0169ng c\u00f3 th\u1ec3 ch\u1ee9ng minh r\u1eb1ng s\u1ed1 l\u01b0\u1ee3ng pha tr\u00ean c\u00e1c m\u1ea1ng dung l\u01b0\u1ee3ng \u0111\u01a1n v\u1ecb kh\u00f4ng v\u01b0\u1ee3t qu\u00e1 $O(V^{2/3})$, cung c\u1ea5p m\u1ed9t \u01b0\u1edbc t\u00ednh thay th\u1ebf l\u00e0 $O(EV^{2/3})$ tr\u00ean c\u00e1c m\u1ea1ng c\u00f3 s\u1ed1 l\u01b0\u1ee3ng c\u1ea1nh \u0111\u1eb7c bi\u1ec7t l\u1edbn.</p>","tags":["Translated"]},{"location":"graph/dinic.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<pre><code>struct FlowEdge {\n    int v, u;\n    long long cap, flow = 0;\n    FlowEdge(int v, int u, long long cap) : v(v), u(u), cap(cap) {}\n};\n\nstruct Dinic {\n    const long long flow_inf = 1e18;\n    vector&lt;FlowEdge&gt; edges;\n    vector&lt;vector&lt;int&gt;&gt; adj;\n    int n, m = 0;\n    int s, t;\n    vector&lt;int&gt; level, ptr;\n    queue&lt;int&gt; q;\n\n    Dinic(int n, int s, int t) : n(n), s(s), t(t) {\n        adj.resize(n);\n        level.resize(n);\n        ptr.resize(n);\n    }\n\n    void add_edge(int v, int u, long long cap) {\n        edges.emplace_back(v, u, cap);\n        edges.emplace_back(u, v, 0);\n        adj[v].push_back(m);\n        adj[u].push_back(m + 1);\n        m += 2;\n    }\n\n    bool bfs() {\n        while (!q.empty()) {\n            int v = q.front();\n            q.pop();\n            for (int id : adj[v]) {\n                if (edges[id].cap == edges[id].flow)\n                    continue;\n                if (level[edges[id].u] != -1)\n                    continue;\n                level[edges[id].u] = level[v] + 1;\n                q.push(edges[id].u);\n            }\n        }\n        return level[t] != -1;\n    }\n\n    long long dfs(int v, long long pushed) {\n        if (pushed == 0)\n            return 0;\n        if (v == t)\n            return pushed;\n        for (int&amp; cid = ptr[v]; cid &lt; (int)adj[v].size(); cid++) {\n            int id = adj[v][cid];\n            int u = edges[id].u;\n            if (level[v] + 1 != level[u])\n                continue;\n            long long tr = dfs(u, min(pushed, edges[id].cap - edges[id].flow));\n            if (tr == 0)\n                continue;\n            edges[id].flow += tr;\n            edges[id ^ 1].flow -= tr;\n            return tr;\n        }\n        return 0;\n    }\n\n    long long flow() {\n        long long f = 0;\n        while (true) {\n            fill(level.begin(), level.end(), -1);\n            level[s] = 0;\n            q.push(s);\n            if (!bfs())\n                break;\n            fill(ptr.begin(), ptr.end(), 0);\n            while (long long pushed = dfs(s, flow_inf)) {\n                f += pushed;\n            }\n        }\n        return f;\n    }\n};\n</code></pre>","tags":["Translated"]},{"location":"graph/dinic.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>SPOJ: FASTFLOW</li> </ul>","tags":["Translated"]},{"location":"graph/edge_vertex_connectivity.html","title":"\u0110\u1ed9 li\u00ean th\u00f4ng c\u1ea1nh / \u0110\u1ed9 li\u00ean th\u00f4ng \u0111\u1ec9nh (Edge connectivity / Vertex connectivity)","text":"","tags":["Translated"]},{"location":"graph/edge_vertex_connectivity.html#definition","title":"\u0110\u1ecbnh ngh\u0129a (Definition)","text":"<p>Cho m\u1ed9t \u0111\u1ed3 th\u1ecb v\u00f4 h\u01b0\u1edbng $G$ v\u1edbi $n$ \u0111\u1ec9nh v\u00e0 $m$ c\u1ea1nh. C\u1ea3 \u0111\u1ed9 li\u00ean th\u00f4ng c\u1ea1nh v\u00e0 \u0111\u1ed9 li\u00ean th\u00f4ng \u0111\u1ec9nh \u0111\u1ec1u l\u00e0 c\u00e1c \u0111\u1eb7c \u0111i\u1ec3m m\u00f4 t\u1ea3 \u0111\u1ed3 th\u1ecb.</p>","tags":["Translated"]},{"location":"graph/edge_vertex_connectivity.html#edge-connectivity","title":"\u0110\u1ed9 li\u00ean th\u00f4ng c\u1ea1nh (Edge connectivity)","text":"<p>\u0110\u1ed9 li\u00ean th\u00f4ng c\u1ea1nh $\\lambda$ c\u1ee7a \u0111\u1ed3 th\u1ecb $G$ l\u00e0 s\u1ed1 l\u01b0\u1ee3ng c\u1ea1nh t\u1ed1i thi\u1ec3u c\u1ea7n ph\u1ea3i x\u00f3a, sao cho \u0111\u1ed3 th\u1ecb $G$ b\u1ecb m\u1ea5t li\u00ean th\u00f4ng.</p> <p>V\u00ed d\u1ee5, m\u1ed9t \u0111\u1ed3 th\u1ecb \u0111\u00e3 m\u1ea5t li\u00ean th\u00f4ng c\u00f3 \u0111\u1ed9 li\u00ean th\u00f4ng c\u1ea1nh l\u00e0 $0$, m\u1ed9t \u0111\u1ed3 th\u1ecb li\u00ean th\u00f4ng c\u00f3 \u00edt nh\u1ea5t m\u1ed9t c\u1ea7u c\u00f3 \u0111\u1ed9 li\u00ean th\u00f4ng c\u1ea1nh l\u00e0 $1$, v\u00e0 m\u1ed9t \u0111\u1ed3 th\u1ecb li\u00ean th\u00f4ng kh\u00f4ng c\u00f3 c\u1ea7u c\u00f3 \u0111\u1ed9 li\u00ean th\u00f4ng c\u1ea1nh \u00edt nh\u1ea5t l\u00e0 $2$.</p> <p>Ch\u00fang ta n\u00f3i r\u1eb1ng m\u1ed9t t\u1eadp h\u1ee3p $S$ c\u00e1c c\u1ea1nh ph\u00e2n t\u00e1ch c\u00e1c \u0111\u1ec9nh $s$ v\u00e0 $t$, n\u1ebfu, sau khi lo\u1ea1i b\u1ecf t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh trong $S$ kh\u1ecfi \u0111\u1ed3 th\u1ecb $G$, c\u00e1c \u0111\u1ec9nh $s$ v\u00e0 $t$ n\u1eb1m trong c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng kh\u00e1c nhau.</p> <p>R\u00f5 r\u00e0ng l\u00e0, \u0111\u1ed9 li\u00ean th\u00f4ng c\u1ea1nh c\u1ee7a m\u1ed9t \u0111\u1ed3 th\u1ecb b\u1eb1ng k\u00edch th\u01b0\u1edbc t\u1ed1i thi\u1ec3u c\u1ee7a m\u1ed9t t\u1eadp h\u1ee3p nh\u01b0 v\u1eady ph\u00e2n t\u00e1ch hai \u0111\u1ec9nh $s$ v\u00e0 $t$, \u0111\u01b0\u1ee3c l\u1ea5y trong s\u1ed1 t\u1ea5t c\u1ea3 c\u00e1c c\u1eb7p $(s, t)$ c\u00f3 th\u1ec3.</p>","tags":["Translated"]},{"location":"graph/edge_vertex_connectivity.html#vertex-connectivity","title":"\u0110\u1ed9 li\u00ean th\u00f4ng \u0111\u1ec9nh (Vertex connectivity)","text":"<p>\u0110\u1ed9 li\u00ean th\u00f4ng \u0111\u1ec9nh $\\kappa$ c\u1ee7a \u0111\u1ed3 th\u1ecb $G$ l\u00e0 s\u1ed1 l\u01b0\u1ee3ng \u0111\u1ec9nh t\u1ed1i thi\u1ec3u c\u1ea7n ph\u1ea3i x\u00f3a, sao cho \u0111\u1ed3 th\u1ecb $G$ b\u1ecb m\u1ea5t li\u00ean th\u00f4ng.</p> <p>V\u00ed d\u1ee5, m\u1ed9t \u0111\u1ed3 th\u1ecb \u0111\u00e3 m\u1ea5t li\u00ean th\u00f4ng c\u00f3 \u0111\u1ed9 li\u00ean th\u00f4ng \u0111\u1ec9nh l\u00e0 $0$, v\u00e0 m\u1ed9t \u0111\u1ed3 th\u1ecb li\u00ean th\u00f4ng c\u00f3 m\u1ed9t kh\u1edbp c\u00f3 \u0111\u1ed9 li\u00ean th\u00f4ng \u0111\u1ec9nh l\u00e0 $1$. Ch\u00fang ta \u0111\u1ecbnh ngh\u0129a r\u1eb1ng m\u1ed9t \u0111\u1ed3 th\u1ecb \u0111\u1ea7y \u0111\u1ee7 c\u00f3 \u0111\u1ed9 li\u00ean th\u00f4ng \u0111\u1ec9nh l\u00e0 $n-1$. \u0110\u1ed1i v\u1edbi t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ed3 th\u1ecb kh\u00e1c, \u0111\u1ed9 li\u00ean th\u00f4ng \u0111\u1ec9nh kh\u00f4ng v\u01b0\u1ee3t qu\u00e1 $n-2$, v\u00ec b\u1ea1n c\u00f3 th\u1ec3 t\u00ecm th\u1ea5y m\u1ed9t c\u1eb7p \u0111\u1ec9nh kh\u00f4ng \u0111\u01b0\u1ee3c n\u1ed1i v\u1edbi nhau b\u1eb1ng m\u1ed9t c\u1ea1nh v\u00e0 lo\u1ea1i b\u1ecf t\u1ea5t c\u1ea3 $n-2$ \u0111\u1ec9nh kh\u00e1c.</p> <p>Ch\u00fang ta n\u00f3i r\u1eb1ng m\u1ed9t t\u1eadp h\u1ee3p $T$ c\u00e1c \u0111\u1ec9nh ph\u00e2n t\u00e1ch c\u00e1c \u0111\u1ec9nh $s$ v\u00e0 $t$, n\u1ebfu, sau khi lo\u1ea1i b\u1ecf t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh trong $T$ kh\u1ecfi \u0111\u1ed3 th\u1ecb $G$, c\u00e1c \u0111\u1ec9nh n\u1eb1m trong c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng kh\u00e1c nhau.</p> <p>R\u00f5 r\u00e0ng l\u00e0, \u0111\u1ed9 li\u00ean th\u00f4ng \u0111\u1ec9nh c\u1ee7a m\u1ed9t \u0111\u1ed3 th\u1ecb b\u1eb1ng k\u00edch th\u01b0\u1edbc t\u1ed1i thi\u1ec3u c\u1ee7a m\u1ed9t t\u1eadp h\u1ee3p nh\u01b0 v\u1eady ph\u00e2n t\u00e1ch hai \u0111\u1ec9nh $s$ v\u00e0 $t$, \u0111\u01b0\u1ee3c l\u1ea5y trong s\u1ed1 t\u1ea5t c\u1ea3 c\u00e1c c\u1eb7p $(s, t)$ c\u00f3 th\u1ec3.</p>","tags":["Translated"]},{"location":"graph/edge_vertex_connectivity.html#properties","title":"T\u00ednh ch\u1ea5t (Properties)","text":"","tags":["Translated"]},{"location":"graph/edge_vertex_connectivity.html#the-whitney-inequalities","title":"B\u1ea5t \u0111\u1eb3ng th\u1ee9c Whitney (The Whitney inequalities)","text":"<p>B\u1ea5t \u0111\u1eb3ng th\u1ee9c Whitney (1932) \u0111\u01b0a ra m\u1ed1i quan h\u1ec7 gi\u1eefa \u0111\u1ed9 li\u00ean th\u00f4ng c\u1ea1nh $\\lambda$, \u0111\u1ed9 li\u00ean th\u00f4ng \u0111\u1ec9nh $\\kappa$ v\u00e0 b\u1eadc nh\u1ecf nh\u1ea5t c\u1ee7a b\u1ea5t k\u1ef3 \u0111\u1ec9nh n\u00e0o trong \u0111\u1ed3 th\u1ecb $\\delta$:</p> $$\\kappa \\le \\lambda \\le \\delta$$ <p>V\u1ec1 m\u1eb7t tr\u1ef1c gi\u00e1c, n\u1ebfu ch\u00fang ta c\u00f3 m\u1ed9t t\u1eadp h\u1ee3p c\u00e1c c\u1ea1nh c\u00f3 k\u00edch th\u01b0\u1edbc $\\lambda$, l\u00e0m cho \u0111\u1ed3 th\u1ecb m\u1ea5t li\u00ean th\u00f4ng, ch\u00fang ta c\u00f3 th\u1ec3 ch\u1ecdn m\u1ed9t trong m\u1ed7i \u0111i\u1ec3m cu\u1ed1i, v\u00e0 t\u1ea1o ra m\u1ed9t t\u1eadp h\u1ee3p c\u00e1c \u0111\u1ec9nh, c\u0169ng l\u00e0m m\u1ea5t li\u00ean th\u00f4ng \u0111\u1ed3 th\u1ecb. V\u00e0 t\u1eadp h\u1ee3p n\u00e0y c\u00f3 k\u00edch th\u01b0\u1edbc $\\le \\lambda$.</p> <p>V\u00e0 n\u1ebfu ch\u00fang ta ch\u1ecdn \u0111\u1ec9nh v\u00e0 b\u1eadc t\u1ed1i thi\u1ec3u $\\delta$, v\u00e0 lo\u1ea1i b\u1ecf t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh \u0111\u01b0\u1ee3c n\u1ed1i v\u1edbi n\u00f3, th\u00ec ch\u00fang ta c\u0169ng s\u1ebd c\u00f3 m\u1ed9t \u0111\u1ed3 th\u1ecb m\u1ea5t li\u00ean th\u00f4ng. Do \u0111\u00f3 b\u1ea5t \u0111\u1eb3ng th\u1ee9c th\u1ee9 hai $\\lambda \\le \\delta$.</p> <p>Th\u1eadt th\u00fa v\u1ecb khi l\u01b0u \u00fd r\u1eb1ng c\u00e1c b\u1ea5t \u0111\u1eb3ng th\u1ee9c Whitney kh\u00f4ng th\u1ec3 \u0111\u01b0\u1ee3c c\u1ea3i thi\u1ec7n: t\u1ee9c l\u00e0 \u0111\u1ed1i v\u1edbi b\u1ea5t k\u1ef3 b\u1ed9 ba s\u1ed1 n\u00e0o th\u1ecfa m\u00e3n b\u1ea5t \u0111\u1eb3ng th\u1ee9c n\u00e0y, t\u1ed3n t\u1ea1i \u00edt nh\u1ea5t m\u1ed9t \u0111\u1ed3 th\u1ecb t\u01b0\u01a1ng \u1ee9ng. M\u1ed9t \u0111\u1ed3 th\u1ecb nh\u01b0 v\u1eady c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c x\u00e2y d\u1ef1ng theo c\u00e1ch sau: \u0110\u1ed3 th\u1ecb s\u1ebd bao g\u1ed3m $2(\\delta + 1)$ \u0111\u1ec9nh, $\\delta + 1$ \u0111\u1ec9nh \u0111\u1ea7u ti\u00ean t\u1ea1o th\u00e0nh m\u1ed9t clique (t\u1ea5t c\u1ea3 c\u00e1c c\u1eb7p \u0111\u1ec9nh \u0111\u01b0\u1ee3c n\u1ed1i v\u1edbi nhau qua m\u1ed9t c\u1ea1nh), v\u00e0 $\\delta + 1$ \u0111\u1ec9nh th\u1ee9 hai t\u1ea1o th\u00e0nh m\u1ed9t clique th\u1ee9 hai. Ngo\u00e0i ra, ch\u00fang ta k\u1ebft n\u1ed1i hai clique b\u1eb1ng $\\lambda$ c\u1ea1nh, sao cho n\u00f3 s\u1eed d\u1ee5ng $\\lambda$ \u0111\u1ec9nh kh\u00e1c nhau trong clique \u0111\u1ea7u ti\u00ean, v\u00e0 ch\u1ec9 $\\kappa$ \u0111\u1ec9nh trong clique th\u1ee9 hai. \u0110\u1ed3 th\u1ecb k\u1ebft qu\u1ea3 s\u1ebd c\u00f3 ba \u0111\u1eb7c \u0111i\u1ec3m.</p>","tags":["Translated"]},{"location":"graph/edge_vertex_connectivity.html#the-ford-fulkerson-theorem","title":"\u0110\u1ecbnh l\u00fd Ford-Fulkerson (The Ford-Fulkerson theorem)","text":"<p>\u0110\u1ecbnh l\u00fd Ford-Fulkerson ng\u1ee5 \u00fd r\u1eb1ng, s\u1ed1 l\u01b0\u1ee3ng l\u1edbn nh\u1ea5t c\u00e1c \u0111\u01b0\u1eddng \u0111i kh\u00f4ng giao nhau v\u1ec1 c\u1ea1nh k\u1ebft n\u1ed1i hai \u0111\u1ec9nh, b\u1eb1ng s\u1ed1 l\u01b0\u1ee3ng nh\u1ecf nh\u1ea5t c\u00e1c c\u1ea1nh ph\u00e2n t\u00e1ch c\u00e1c \u0111\u1ec9nh n\u00e0y.</p>","tags":["Translated"]},{"location":"graph/edge_vertex_connectivity.html#computing-the-values","title":"T\u00ednh to\u00e1n c\u00e1c gi\u00e1 tr\u1ecb (Computing the values)","text":"","tags":["Translated"]},{"location":"graph/edge_vertex_connectivity.html#edge-connectivity-using-maximum-flow","title":"\u0110\u1ed9 li\u00ean th\u00f4ng c\u1ea1nh s\u1eed d\u1ee5ng lu\u1ed3ng c\u1ef1c \u0111\u1ea1i (Edge connectivity using maximum flow)","text":"<p>Ph\u01b0\u01a1ng ph\u00e1p n\u00e0y d\u1ef1a tr\u00ean \u0111\u1ecbnh l\u00fd Ford-Fulkerson.</p> <p>Ch\u00fang ta l\u1eb7p qua t\u1ea5t c\u1ea3 c\u00e1c c\u1eb7p \u0111\u1ec9nh $(s, t)$ v\u00e0 gi\u1eefa m\u1ed7i c\u1eb7p, ch\u00fang ta t\u00ecm s\u1ed1 l\u01b0\u1ee3ng l\u1edbn nh\u1ea5t c\u00e1c \u0111\u01b0\u1eddng \u0111i kh\u00f4ng giao nhau gi\u1eefa ch\u00fang. Gi\u00e1 tr\u1ecb n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng thu\u1eadt to\u00e1n lu\u1ed3ng c\u1ef1c \u0111\u1ea1i: ch\u00fang ta s\u1eed d\u1ee5ng $s$ l\u00e0m ngu\u1ed3n, $t$ l\u00e0m \u0111\u00edch, v\u00e0 g\u00e1n cho m\u1ed7i c\u1ea1nh m\u1ed9t dung l\u01b0\u1ee3ng l\u00e0 $1$. Sau \u0111\u00f3, lu\u1ed3ng c\u1ef1c \u0111\u1ea1i l\u00e0 s\u1ed1 l\u01b0\u1ee3ng \u0111\u01b0\u1eddng \u0111i kh\u00f4ng giao nhau.</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p cho thu\u1eadt to\u00e1n s\u1eed d\u1ee5ng Edmonds-Karp l\u00e0 $O(V^2 V E^2) = O(V^3 E^2)$. Nh\u01b0ng ch\u00fang ta n\u00ean l\u01b0u \u00fd r\u1eb1ng, \u0111i\u1ec1u n\u00e0y bao g\u1ed3m m\u1ed9t y\u1ebfu t\u1ed1 \u1ea9n, v\u00ec th\u1ef1c t\u1ebf kh\u00f4ng th\u1ec3 t\u1ea1o ra m\u1ed9t \u0111\u1ed3 th\u1ecb sao cho thu\u1eadt to\u00e1n lu\u1ed3ng c\u1ef1c \u0111\u1ea1i s\u1ebd ch\u1eadm cho t\u1ea5t c\u1ea3 c\u00e1c ngu\u1ed3n v\u00e0 \u0111\u00edch. \u0110\u1eb7c bi\u1ec7t thu\u1eadt to\u00e1n s\u1ebd ch\u1ea1y kh\u00e1 nhanh \u0111\u1ed1i v\u1edbi c\u00e1c \u0111\u1ed3 th\u1ecb ng\u1eabu nhi\u00ean.</p>","tags":["Translated"]},{"location":"graph/edge_vertex_connectivity.html#special-algorithm-for-edge-connectivity","title":"Thu\u1eadt to\u00e1n \u0111\u1eb7c bi\u1ec7t cho \u0111\u1ed9 li\u00ean th\u00f4ng c\u1ea1nh (Special algorithm for edge connectivity)","text":"<p>Nhi\u1ec7m v\u1ee5 t\u00ecm \u0111\u1ed9 li\u00ean th\u00f4ng c\u1ea1nh t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi nhi\u1ec7m v\u1ee5 t\u00ecm l\u00e1t c\u1eaft c\u1ef1c ti\u1ec3u to\u00e0n c\u1ee5c (global minimum cut).</p> <p>C\u00e1c thu\u1eadt to\u00e1n \u0111\u1eb7c bi\u1ec7t \u0111\u00e3 \u0111\u01b0\u1ee3c ph\u00e1t tri\u1ec3n cho nhi\u1ec7m v\u1ee5 n\u00e0y. M\u1ed9t trong s\u1ed1 \u0111\u00f3 l\u00e0 thu\u1eadt to\u00e1n Stoer-Wagner, ho\u1ea1t \u0111\u1ed9ng trong th\u1eddi gian $O(V^3)$ ho\u1eb7c $O(V E)$.</p>","tags":["Translated"]},{"location":"graph/edge_vertex_connectivity.html#vertex-connectivity-1","title":"\u0110\u1ed9 li\u00ean th\u00f4ng \u0111\u1ec9nh (Vertex connectivity)","text":"<p>M\u1ed9t l\u1ea7n n\u1eefa ch\u00fang ta l\u1eb7p qua t\u1ea5t c\u1ea3 c\u00e1c c\u1eb7p \u0111\u1ec9nh $s$ v\u00e0 $t$, v\u00e0 \u0111\u1ed1i v\u1edbi m\u1ed7i c\u1eb7p, ch\u00fang ta t\u00ecm s\u1ed1 l\u01b0\u1ee3ng \u0111\u1ec9nh t\u1ed1i thi\u1ec3u ph\u00e2n t\u00e1ch $s$ v\u00e0 $t$.</p> <p>B\u1eb1ng c\u00e1ch l\u00e0m \u0111i\u1ec1u n\u00e0y, ch\u00fang ta c\u00f3 th\u1ec3 \u00e1p d\u1ee5ng c\u00f9ng m\u1ed9t c\u00e1ch ti\u1ebfp c\u1eadn lu\u1ed3ng c\u1ef1c \u0111\u1ea1i nh\u01b0 \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 trong c\u00e1c ph\u1ea7n tr\u01b0\u1edbc.</p> <p>Ch\u00fang ta chia m\u1ed7i \u0111\u1ec9nh $x$ v\u1edbi $x \\neq s$ v\u00e0 $x \\neq t$ th\u00e0nh hai \u0111\u1ec9nh $x_1$ v\u00e0 $x_2$. Ch\u00fang ta k\u1ebft n\u1ed1i hai \u0111\u1ec9nh n\u00e0y b\u1eb1ng m\u1ed9t c\u1ea1nh c\u00f3 h\u01b0\u1edbng $(x_1, x_2)$ v\u1edbi dung l\u01b0\u1ee3ng $1$, v\u00e0 thay th\u1ebf t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh $(u, v)$ b\u1eb1ng hai c\u1ea1nh c\u00f3 h\u01b0\u1edbng $(u_2, v_1)$ v\u00e0 $(v_2, u_1)$, c\u1ea3 hai \u0111\u1ec1u c\u00f3 dung l\u01b0\u1ee3ng l\u00e0 1. B\u1eb1ng c\u00e1ch x\u00e2y d\u1ef1ng, gi\u00e1 tr\u1ecb c\u1ee7a lu\u1ed3ng c\u1ef1c \u0111\u1ea1i s\u1ebd b\u1eb1ng s\u1ed1 l\u01b0\u1ee3ng \u0111\u1ec9nh t\u1ed1i thi\u1ec3u c\u1ea7n thi\u1ebft \u0111\u1ec3 ph\u00e2n t\u00e1ch $s$ v\u00e0 $t$.</p> <p>C\u00e1ch ti\u1ebfp c\u1eadn n\u00e0y c\u00f3 c\u00f9ng \u0111\u1ed9 ph\u1ee9c t\u1ea1p nh\u01b0 c\u00e1ch ti\u1ebfp c\u1eadn lu\u1ed3ng \u0111\u1ec3 t\u00ecm \u0111\u1ed9 li\u00ean th\u00f4ng c\u1ea1nh.</p>","tags":["Translated"]},{"location":"graph/edmonds_karp.html","title":"Lu\u1ed3ng c\u1ef1c \u0111\u1ea1i - Ford-Fulkerson v\u00e0 Edmonds-Karp (Maximum flow - Ford-Fulkerson and Edmonds-Karp)","text":"<p>Thu\u1eadt to\u00e1n Edmonds-Karp l\u00e0 m\u1ed9t c\u00e0i \u0111\u1eb7t c\u1ee7a ph\u01b0\u01a1ng ph\u00e1p Ford-Fulkerson \u0111\u1ec3 t\u00ednh to\u00e1n lu\u1ed3ng c\u1ef1c \u0111\u1ea1i trong m\u1ed9t m\u1ea1ng lu\u1ed3ng.</p>","tags":["Translated"]},{"location":"graph/edmonds_karp.html#flow-network","title":"M\u1ea1ng lu\u1ed3ng (Flow network)","text":"<p>\u0110\u1ea7u ti\u00ean h\u00e3y \u0111\u1ecbnh ngh\u0129a m\u1ea1ng lu\u1ed3ng, lu\u1ed3ng, v\u00e0 lu\u1ed3ng c\u1ef1c \u0111\u1ea1i l\u00e0 g\u00ec.</p> <p>M\u1ed9t m\u1ea1ng l\u00e0 m\u1ed9t \u0111\u1ed3 th\u1ecb c\u00f3 h\u01b0\u1edbng $G$ v\u1edbi c\u00e1c \u0111\u1ec9nh $V$ v\u00e0 c\u00e1c c\u1ea1nh $E$ k\u1ebft h\u1ee3p v\u1edbi m\u1ed9t h\u00e0m $c$, g\u00e1n cho m\u1ed7i c\u1ea1nh $e \\in E$ m\u1ed9t gi\u00e1 tr\u1ecb nguy\u00ean kh\u00f4ng \u00e2m, l\u00e0 dung l\u01b0\u1ee3ng c\u1ee7a $e$. M\u1ed9t m\u1ea1ng nh\u01b0 v\u1eady \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 m\u1ea1ng lu\u1ed3ng, n\u1ebfu ch\u00fang ta g\u00e1n nh\u00e3n th\u00eam cho hai \u0111\u1ec9nh, m\u1ed9t l\u00e0 ngu\u1ed3n (source) v\u00e0 m\u1ed9t l\u00e0 \u0111\u00edch (sink).</p> <p>M\u1ed9t lu\u1ed3ng trong m\u1ea1ng lu\u1ed3ng l\u00e0 h\u00e0m $f$, h\u00e0m n\u00e0y l\u1ea1i g\u00e1n cho m\u1ed7i c\u1ea1nh $e$ m\u1ed9t gi\u00e1 tr\u1ecb nguy\u00ean kh\u00f4ng \u00e2m, c\u1ee5 th\u1ec3 l\u00e0 lu\u1ed3ng. H\u00e0m n\u00e0y ph\u1ea3i th\u1ecfa m\u00e3n hai \u0111i\u1ec1u ki\u1ec7n sau:</p> <p>Lu\u1ed3ng c\u1ee7a m\u1ed9t c\u1ea1nh kh\u00f4ng \u0111\u01b0\u1ee3c v\u01b0\u1ee3t qu\u00e1 dung l\u01b0\u1ee3ng.</p> $$f(e) \\le c(e)$$ <p>V\u00e0 t\u1ed5ng lu\u1ed3ng \u0111i v\u00e0o c\u1ee7a m\u1ed9t \u0111\u1ec9nh $u$ ph\u1ea3i b\u1eb1ng t\u1ed5ng lu\u1ed3ng \u0111i ra c\u1ee7a $u$ ngo\u1ea1i tr\u1eeb c\u00e1c \u0111\u1ec9nh ngu\u1ed3n v\u00e0 \u0111\u00edch.</p> $$\\sum_{(v, u) \\in E} f((v, u)) = \\sum_{(u, v) \\in E} f((u, v))$$ <p>\u0110\u1ec9nh ngu\u1ed3n $s$ ch\u1ec9 c\u00f3 lu\u1ed3ng \u0111i ra, v\u00e0 \u0111\u1ec9nh \u0111\u00edch $t$ ch\u1ec9 c\u00f3 lu\u1ed3ng \u0111i v\u00e0o.</p> <p>D\u1ec5 d\u00e0ng th\u1ea5y r\u1eb1ng ph\u01b0\u01a1ng tr\u00ecnh sau \u0111\u00e2y \u0111\u00fang:</p> $$\\sum_{(s, u) \\in E} f((s, u)) = \\sum_{(u, t) \\in E} f((u, t))$$ <p>M\u1ed9t s\u1ef1 t\u01b0\u01a1ng t\u1ef1 t\u1ed1t cho m\u1ea1ng lu\u1ed3ng l\u00e0 h\u00ecnh \u1ea3nh tr\u1ef1c quan sau: Ch\u00fang ta bi\u1ec3u di\u1ec5n c\u00e1c c\u1ea1nh nh\u01b0 c\u00e1c \u0111\u01b0\u1eddng \u1ed1ng n\u01b0\u1edbc, dung l\u01b0\u1ee3ng c\u1ee7a m\u1ed9t c\u1ea1nh l\u00e0 l\u01b0\u1ee3ng n\u01b0\u1edbc t\u1ed1i \u0111a c\u00f3 th\u1ec3 ch\u1ea3y qua \u0111\u01b0\u1eddng \u1ed1ng m\u1ed7i gi\u00e2y, v\u00e0 lu\u1ed3ng c\u1ee7a m\u1ed9t c\u1ea1nh l\u00e0 l\u01b0\u1ee3ng n\u01b0\u1edbc hi\u1ec7n \u0111ang ch\u1ea3y qua \u0111\u01b0\u1eddng \u1ed1ng m\u1ed7i gi\u00e2y. \u0110i\u1ec1u n\u00e0y th\u00fac \u0111\u1ea9y \u0111i\u1ec1u ki\u1ec7n lu\u1ed3ng \u0111\u1ea7u ti\u00ean. N\u01b0\u1edbc ch\u1ea3y qua m\u1ed9t \u0111\u01b0\u1eddng \u1ed1ng kh\u00f4ng th\u1ec3 nhi\u1ec1u h\u01a1n dung l\u01b0\u1ee3ng c\u1ee7a n\u00f3. C\u00e1c \u0111\u1ec9nh \u0111\u00f3ng vai tr\u00f2 l\u00e0 c\u00e1c \u0111i\u1ec3m n\u1ed1i, n\u01a1i n\u01b0\u1edbc ch\u1ea3y ra t\u1eeb m\u1ed9t s\u1ed1 \u0111\u01b0\u1eddng \u1ed1ng, v\u00e0 sau \u0111\u00f3, c\u00e1c \u0111\u1ec9nh n\u00e0y ph\u00e2n ph\u1ed1i n\u01b0\u1edbc theo m\u1ed9t c\u00e1ch n\u00e0o \u0111\u00f3 \u0111\u1ebfn c\u00e1c \u0111\u01b0\u1eddng \u1ed1ng kh\u00e1c. \u0110i\u1ec1u n\u00e0y c\u0169ng th\u00fac \u0111\u1ea9y \u0111i\u1ec1u ki\u1ec7n lu\u1ed3ng th\u1ee9 hai. T\u1ea5t c\u1ea3 n\u01b0\u1edbc \u0111i v\u00e0o ph\u1ea3i \u0111\u01b0\u1ee3c ph\u00e2n ph\u1ed1i \u0111\u1ebfn c\u00e1c \u0111\u01b0\u1eddng \u1ed1ng kh\u00e1c trong m\u1ed7i \u0111i\u1ec3m n\u1ed1i. N\u00f3 kh\u00f4ng th\u1ec3 bi\u1ebfn m\u1ea5t ho\u1eb7c xu\u1ea5t hi\u1ec7n m\u1ed9t c\u00e1ch k\u1ef3 di\u1ec7u. Ngu\u1ed3n $s$ l\u00e0 ngu\u1ed3n g\u1ed1c c\u1ee7a t\u1ea5t c\u1ea3 n\u01b0\u1edbc, v\u00e0 n\u01b0\u1edbc ch\u1ec9 c\u00f3 th\u1ec3 tho\u00e1t ra \u1edf \u0111\u00edch $t$.</p> <p>H\u00ecnh \u1ea3nh sau \u0111\u00e2y cho th\u1ea5y m\u1ed9t m\u1ea1ng lu\u1ed3ng. Gi\u00e1 tr\u1ecb \u0111\u1ea7u ti\u00ean c\u1ee7a m\u1ed7i c\u1ea1nh bi\u1ec3u th\u1ecb lu\u1ed3ng, ban \u0111\u1ea7u l\u00e0 0, v\u00e0 gi\u00e1 tr\u1ecb th\u1ee9 hai bi\u1ec3u th\u1ecb dung l\u01b0\u1ee3ng.</p> <p>Gi\u00e1 tr\u1ecb c\u1ee7a lu\u1ed3ng c\u1ee7a m\u1ed9t m\u1ea1ng l\u00e0 t\u1ed5ng c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c lu\u1ed3ng \u0111\u01b0\u1ee3c t\u1ea1o ra trong ngu\u1ed3n $s$, ho\u1eb7c t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi t\u1ed5ng c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c lu\u1ed3ng \u0111\u01b0\u1ee3c ti\u00eau th\u1ee5 b\u1edfi \u0111\u00edch $t$. M\u1ed9t lu\u1ed3ng c\u1ef1c \u0111\u1ea1i l\u00e0 m\u1ed9t lu\u1ed3ng c\u00f3 gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t c\u00f3 th\u1ec3. T\u00ecm lu\u1ed3ng c\u1ef1c \u0111\u1ea1i n\u00e0y c\u1ee7a m\u1ed9t m\u1ea1ng lu\u1ed3ng l\u00e0 b\u00e0i to\u00e1n m\u00e0 ch\u00fang ta mu\u1ed1n gi\u1ea3i quy\u1ebft.</p> <p>Trong h\u00ecnh \u1ea3nh tr\u1ef1c quan v\u1edbi c\u00e1c \u0111\u01b0\u1eddng \u1ed1ng n\u01b0\u1edbc, b\u00e0i to\u00e1n c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c ph\u00e1t bi\u1ec3u theo c\u00e1ch sau: ch\u00fang ta c\u00f3 th\u1ec3 \u0111\u1ea9y bao nhi\u00eau n\u01b0\u1edbc qua c\u00e1c \u0111\u01b0\u1eddng \u1ed1ng t\u1eeb ngu\u1ed3n \u0111\u1ebfn \u0111\u00edch?</p> <p>H\u00ecnh \u1ea3nh sau \u0111\u00e2y cho th\u1ea5y lu\u1ed3ng c\u1ef1c \u0111\u1ea1i trong m\u1ea1ng lu\u1ed3ng.</p>","tags":["Translated"]},{"location":"graph/edmonds_karp.html#ford-fulkerson-method","title":"Ph\u01b0\u01a1ng ph\u00e1p Ford-Fulkerson (Ford-Fulkerson method)","text":"<p>H\u00e3y \u0111\u1ecbnh ngh\u0129a th\u00eam m\u1ed9t \u0111i\u1ec1u n\u1eefa. Dung l\u01b0\u1ee3ng d\u01b0 (residual capacity) c\u1ee7a m\u1ed9t c\u1ea1nh c\u00f3 h\u01b0\u1edbng l\u00e0 dung l\u01b0\u1ee3ng tr\u1eeb \u0111i lu\u1ed3ng. C\u1ea7n l\u01b0u \u00fd r\u1eb1ng n\u1ebfu c\u00f3 m\u1ed9t lu\u1ed3ng d\u1ecdc theo m\u1ed9t c\u1ea1nh c\u00f3 h\u01b0\u1edbng n\u00e0o \u0111\u00f3 $(u, v)$, th\u00ec c\u1ea1nh ng\u01b0\u1ee3c l\u1ea1i c\u00f3 dung l\u01b0\u1ee3ng 0 v\u00e0 ch\u00fang ta c\u00f3 th\u1ec3 \u0111\u1ecbnh ngh\u0129a lu\u1ed3ng c\u1ee7a n\u00f3 l\u00e0 $f((v, u)) = -f((u, v))$. \u0110i\u1ec1u n\u00e0y c\u0169ng \u0111\u1ecbnh ngh\u0129a dung l\u01b0\u1ee3ng d\u01b0 cho t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh ng\u01b0\u1ee3c l\u1ea1i. Ch\u00fang ta c\u00f3 th\u1ec3 t\u1ea1o m\u1ed9t m\u1ea1ng d\u01b0 (residual network) t\u1eeb t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh n\u00e0y, \u0111\u00f3 ch\u1ec9 l\u00e0 m\u1ed9t m\u1ea1ng v\u1edbi c\u00f9ng c\u00e1c \u0111\u1ec9nh v\u00e0 c\u1ea1nh, nh\u01b0ng ch\u00fang ta s\u1eed d\u1ee5ng dung l\u01b0\u1ee3ng d\u01b0 l\u00e0m dung l\u01b0\u1ee3ng.</p> <p>Ph\u01b0\u01a1ng ph\u00e1p Ford-Fulkerson ho\u1ea1t \u0111\u1ed9ng nh\u01b0 sau. \u0110\u1ea7u ti\u00ean, ch\u00fang ta \u0111\u1eb7t lu\u1ed3ng c\u1ee7a m\u1ed7i c\u1ea1nh b\u1eb1ng 0. Sau \u0111\u00f3 ch\u00fang ta t\u00ecm ki\u1ebfm m\u1ed9t \u0111\u01b0\u1eddng t\u0103ng lu\u1ed3ng (augmenting path) t\u1eeb $s$ \u0111\u1ebfn $t$. \u0110\u01b0\u1eddng t\u0103ng lu\u1ed3ng l\u00e0 m\u1ed9t \u0111\u01b0\u1eddng \u0111i \u0111\u01a1n trong \u0111\u1ed3 th\u1ecb d\u01b0 trong \u0111\u00f3 dung l\u01b0\u1ee3ng d\u01b0 l\u00e0 d\u01b0\u01a1ng \u0111\u1ed1i v\u1edbi t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh d\u1ecdc theo \u0111\u01b0\u1eddng \u0111i \u0111\u00f3. N\u1ebfu t\u00ecm th\u1ea5y m\u1ed9t \u0111\u01b0\u1eddng \u0111i nh\u01b0 v\u1eady, th\u00ec ch\u00fang ta c\u00f3 th\u1ec3 t\u0103ng lu\u1ed3ng d\u1ecdc theo c\u00e1c c\u1ea1nh n\u00e0y. Ch\u00fang ta ti\u1ebfp t\u1ee5c t\u00ecm ki\u1ebfm c\u00e1c \u0111\u01b0\u1eddng t\u0103ng lu\u1ed3ng v\u00e0 t\u0103ng lu\u1ed3ng. Khi \u0111\u01b0\u1eddng t\u0103ng lu\u1ed3ng kh\u00f4ng c\u00f2n t\u1ed3n t\u1ea1i n\u1eefa, lu\u1ed3ng l\u00e0 c\u1ef1c \u0111\u1ea1i.</p> <p>H\u00e3y x\u00e1c \u0111\u1ecbnh chi ti\u1ebft h\u01a1n, vi\u1ec7c t\u0103ng lu\u1ed3ng d\u1ecdc theo m\u1ed9t \u0111\u01b0\u1eddng t\u0103ng lu\u1ed3ng ngh\u0129a l\u00e0 g\u00ec. G\u1ecdi $C$ l\u00e0 dung l\u01b0\u1ee3ng d\u01b0 nh\u1ecf nh\u1ea5t c\u1ee7a c\u00e1c c\u1ea1nh trong \u0111\u01b0\u1eddng \u0111i. Sau \u0111\u00f3 ch\u00fang ta t\u0103ng lu\u1ed3ng theo c\u00e1ch sau: ch\u00fang ta c\u1eadp nh\u1eadt $f((u, v)) ~\\text{+=}~ C$ v\u00e0 $f((v, u)) ~\\text{-=}~ C$ cho m\u1ed7i c\u1ea1nh $(u, v)$ trong \u0111\u01b0\u1eddng \u0111i.</p> <p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u1ed9t v\u00ed d\u1ee5 \u0111\u1ec3 ch\u1ee9ng minh ph\u01b0\u01a1ng ph\u00e1p. Ch\u00fang ta s\u1eed d\u1ee5ng c\u00f9ng m\u1ed9t m\u1ea1ng lu\u1ed3ng nh\u01b0 tr\u00ean. Ban \u0111\u1ea7u ch\u00fang ta b\u1eaft \u0111\u1ea7u v\u1edbi lu\u1ed3ng b\u1eb1ng 0.</p> <p>Ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm th\u1ea5y \u0111\u01b0\u1eddng \u0111i $s - A - B - t$ v\u1edbi c\u00e1c dung l\u01b0\u1ee3ng d\u01b0 7, 5, v\u00e0 8. Gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t c\u1ee7a ch\u00fang l\u00e0 5, do \u0111\u00f3 ch\u00fang ta c\u00f3 th\u1ec3 t\u0103ng lu\u1ed3ng d\u1ecdc theo \u0111\u01b0\u1eddng \u0111i n\u00e0y th\u00eam 5. \u0110i\u1ec1u n\u00e0y mang l\u1ea1i lu\u1ed3ng b\u1eb1ng 5 cho m\u1ea1ng.</p> <p>M\u1ed9t l\u1ea7n n\u1eefa ch\u00fang ta t\u00ecm ki\u1ebfm m\u1ed9t \u0111\u01b0\u1eddng t\u0103ng lu\u1ed3ng, l\u1ea7n n\u00e0y ch\u00fang ta t\u00ecm th\u1ea5y $s - D - A - C - t$ v\u1edbi c\u00e1c dung l\u01b0\u1ee3ng d\u01b0 4, 3, 3, v\u00e0 5. Do \u0111\u00f3 ch\u00fang ta c\u00f3 th\u1ec3 t\u0103ng lu\u1ed3ng th\u00eam 3 v\u00e0 ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c lu\u1ed3ng b\u1eb1ng 8 cho m\u1ea1ng.</p> <p>L\u1ea7n n\u00e0y ch\u00fang ta t\u00ecm th\u1ea5y \u0111\u01b0\u1eddng \u0111i $s - D - C - B - t$ v\u1edbi c\u00e1c dung l\u01b0\u1ee3ng d\u01b0 1, 2, 3, v\u00e0 3, v\u00e0 do \u0111\u00f3, ch\u00fang ta t\u0103ng lu\u1ed3ng th\u00eam 1.</p> <p>L\u1ea7n n\u00e0y ch\u00fang ta t\u00ecm th\u1ea5y \u0111\u01b0\u1eddng t\u0103ng lu\u1ed3ng $s - A - D - C - t$ v\u1edbi c\u00e1c dung l\u01b0\u1ee3ng d\u01b0 2, 3, 1, v\u00e0 2. Ch\u00fang ta c\u00f3 th\u1ec3 t\u0103ng lu\u1ed3ng th\u00eam 1. Nh\u01b0ng \u0111\u01b0\u1eddng \u0111i n\u00e0y r\u1ea5t th\u00fa v\u1ecb. N\u00f3 bao g\u1ed3m c\u1ea1nh ng\u01b0\u1ee3c $(A, D)$. Trong m\u1ea1ng lu\u1ed3ng ban \u0111\u1ea7u, ch\u00fang ta kh\u00f4ng \u0111\u01b0\u1ee3c ph\u00e9p g\u1eedi b\u1ea5t k\u1ef3 lu\u1ed3ng n\u00e0o t\u1eeb $A$ \u0111\u1ebfn $D$. Nh\u01b0ng v\u00ec ch\u00fang ta \u0111\u00e3 c\u00f3 lu\u1ed3ng b\u1eb1ng 3 t\u1eeb $D$ \u0111\u1ebfn $A$, \u0111i\u1ec1u n\u00e0y l\u00e0 c\u00f3 th\u1ec3. Tr\u1ef1c gi\u00e1c c\u1ee7a n\u00f3 l\u00e0 nh\u01b0 sau: Thay v\u00ec g\u1eedi lu\u1ed3ng b\u1eb1ng 3 t\u1eeb $D$ \u0111\u1ebfn $A$, ch\u00fang ta ch\u1ec9 g\u1eedi 2 v\u00e0 b\u00f9 \u0111\u1eafp \u0111i\u1ec1u n\u00e0y b\u1eb1ng c\u00e1ch g\u1eedi th\u00eam lu\u1ed3ng b\u1eb1ng 1 t\u1eeb $s$ \u0111\u1ebfn $A$, \u0111i\u1ec1u n\u00e0y cho ph\u00e9p ch\u00fang ta g\u1eedi th\u00eam lu\u1ed3ng b\u1eb1ng 1 d\u1ecdc theo \u0111\u01b0\u1eddng \u0111i $D - C - t$.</p> <p>B\u00e2y gi\u1edd, kh\u00f4ng th\u1ec3 t\u00ecm th\u1ea5y \u0111\u01b0\u1eddng t\u0103ng lu\u1ed3ng n\u00e0o gi\u1eefa $s$ v\u00e0 $t$, do \u0111\u00f3 lu\u1ed3ng $10$ n\u00e0y l\u00e0 l\u1edbn nh\u1ea5t c\u00f3 th\u1ec3. Ch\u00fang ta \u0111\u00e3 t\u00ecm th\u1ea5y lu\u1ed3ng c\u1ef1c \u0111\u1ea1i.</p> <p>C\u1ea7n l\u01b0u \u00fd r\u1eb1ng, ph\u01b0\u01a1ng ph\u00e1p Ford-Fulkerson kh\u00f4ng ch\u1ec9 \u0111\u1ecbnh ph\u01b0\u01a1ng ph\u00e1p t\u00ecm \u0111\u01b0\u1eddng t\u0103ng lu\u1ed3ng. C\u00e1c c\u00e1ch ti\u1ebfp c\u1eadn c\u00f3 th\u1ec3 l\u00e0 s\u1eed d\u1ee5ng DFS ho\u1eb7c BFS, c\u1ea3 hai \u0111\u1ec1u ho\u1ea1t \u0111\u1ed9ng trong $O(E)$. N\u1ebfu t\u1ea5t c\u1ea3 c\u00e1c dung l\u01b0\u1ee3ng c\u1ee7a m\u1ea1ng l\u00e0 s\u1ed1 nguy\u00ean, th\u00ec \u0111\u1ed1i v\u1edbi m\u1ed7i \u0111\u01b0\u1eddng t\u0103ng lu\u1ed3ng, lu\u1ed3ng c\u1ee7a m\u1ea1ng t\u0103ng \u00edt nh\u1ea5t 1 (\u0111\u1ec3 bi\u1ebft th\u00eam chi ti\u1ebft xem \u0110\u1ecbnh l\u00fd lu\u1ed3ng nguy\u00ean). Do \u0111\u00f3, \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a Ford-Fulkerson l\u00e0 $O(E F)$, trong \u0111\u00f3 $F$ l\u00e0 lu\u1ed3ng c\u1ef1c \u0111\u1ea1i c\u1ee7a m\u1ea1ng. Trong tr\u01b0\u1eddng h\u1ee3p dung l\u01b0\u1ee3ng l\u00e0 s\u1ed1 h\u1eefu t\u1ec9, thu\u1eadt to\u00e1n c\u0169ng s\u1ebd k\u1ebft th\u00fac, nh\u01b0ng \u0111\u1ed9 ph\u1ee9c t\u1ea1p kh\u00f4ng b\u1ecb ch\u1eb7n. Trong tr\u01b0\u1eddng h\u1ee3p dung l\u01b0\u1ee3ng l\u00e0 s\u1ed1 v\u00f4 t\u1ec9, thu\u1eadt to\u00e1n c\u00f3 th\u1ec3 kh\u00f4ng bao gi\u1edd k\u1ebft th\u00fac, v\u00e0 th\u1eadm ch\u00ed c\u00f3 th\u1ec3 kh\u00f4ng h\u1ed9i t\u1ee5 v\u1ec1 lu\u1ed3ng c\u1ef1c \u0111\u1ea1i.</p>","tags":["Translated"]},{"location":"graph/edmonds_karp.html#edmonds-karp-algorithm","title":"Thu\u1eadt to\u00e1n Edmonds-Karp (Edmonds-Karp algorithm)","text":"<p>Thu\u1eadt to\u00e1n Edmonds-Karp ch\u1ec9 l\u00e0 m\u1ed9t c\u00e0i \u0111\u1eb7t c\u1ee7a ph\u01b0\u01a1ng ph\u00e1p Ford-Fulkerson s\u1eed d\u1ee5ng BFS \u0111\u1ec3 t\u00ecm c\u00e1c \u0111\u01b0\u1eddng t\u0103ng lu\u1ed3ng. Thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c xu\u1ea5t b\u1ea3n l\u1ea7n \u0111\u1ea7u ti\u00ean b\u1edfi Yefim Dinitz v\u00e0o n\u0103m 1970, v\u00e0 sau \u0111\u00f3 \u0111\u01b0\u1ee3c xu\u1ea5t b\u1ea3n \u0111\u1ed9c l\u1eadp b\u1edfi Jack Edmonds v\u00e0 Richard Karp v\u00e0o n\u0103m 1972.</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c \u0111\u01b0a ra \u0111\u1ed9c l\u1eadp v\u1edbi lu\u1ed3ng c\u1ef1c \u0111\u1ea1i. Thu\u1eadt to\u00e1n ch\u1ea1y trong th\u1eddi gian $O(V E^2)$, ngay c\u1ea3 \u0111\u1ed1i v\u1edbi dung l\u01b0\u1ee3ng v\u00f4 t\u1ec9. Tr\u1ef1c gi\u00e1c l\u00e0, m\u1ed7i khi ch\u00fang ta t\u00ecm th\u1ea5y m\u1ed9t \u0111\u01b0\u1eddng t\u0103ng lu\u1ed3ng, m\u1ed9t trong c\u00e1c c\u1ea1nh tr\u1edf n\u00ean b\u00e3o h\u00f2a, v\u00e0 kho\u1ea3ng c\u00e1ch t\u1eeb c\u1ea1nh \u0111\u1ebfn $s$ s\u1ebd d\u00e0i h\u01a1n n\u1ebfu n\u00f3 xu\u1ea5t hi\u1ec7n l\u1ea1i sau n\u00e0y trong m\u1ed9t \u0111\u01b0\u1eddng t\u0103ng lu\u1ed3ng. \u0110\u1ed9 d\u00e0i c\u1ee7a c\u00e1c \u0111\u01b0\u1eddng \u0111i \u0111\u01a1n b\u1ecb ch\u1eb7n b\u1edfi $V$.</p>","tags":["Translated"]},{"location":"graph/edmonds_karp.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>Ma tr\u1eadn <code>capacity</code> l\u01b0u tr\u1eef dung l\u01b0\u1ee3ng cho m\u1ecdi c\u1eb7p \u0111\u1ec9nh. <code>adj</code> l\u00e0 danh s\u00e1ch k\u1ec1 c\u1ee7a \u0111\u1ed3 th\u1ecb v\u00f4 h\u01b0\u1edbng, v\u00ec ch\u00fang ta c\u0169ng ph\u1ea3i s\u1eed d\u1ee5ng c\u1ea1nh ng\u01b0\u1ee3c c\u1ee7a c\u00e1c c\u1ea1nh c\u00f3 h\u01b0\u1edbng khi ch\u00fang ta \u0111ang t\u00ecm ki\u1ebfm c\u00e1c \u0111\u01b0\u1eddng t\u0103ng lu\u1ed3ng.</p> <p>H\u00e0m <code>maxflow</code> s\u1ebd tr\u1ea3 v\u1ec1 gi\u00e1 tr\u1ecb c\u1ee7a lu\u1ed3ng c\u1ef1c \u0111\u1ea1i. Trong thu\u1eadt to\u00e1n, ma tr\u1eadn <code>capacity</code> th\u1ef1c s\u1ef1 s\u1ebd l\u01b0u tr\u1eef dung l\u01b0\u1ee3ng d\u01b0 c\u1ee7a m\u1ea1ng. Gi\u00e1 tr\u1ecb c\u1ee7a lu\u1ed3ng trong m\u1ed7i c\u1ea1nh th\u1ef1c s\u1ef1 s\u1ebd kh\u00f4ng \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef, nh\u01b0ng r\u1ea5t d\u1ec5 \u0111\u1ec3 m\u1edf r\u1ed9ng c\u00e0i \u0111\u1eb7t - b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng m\u1ed9t ma tr\u1eadn b\u1ed5 sung - \u0111\u1ec3 c\u0169ng l\u01b0u tr\u1eef lu\u1ed3ng v\u00e0 tr\u1ea3 v\u1ec1 n\u00f3.</p> <pre><code>int n;\nvector&lt;vector&lt;int&gt;&gt; capacity;\nvector&lt;vector&lt;int&gt;&gt; adj;\n\nint bfs(int s, int t, vector&lt;int&gt;&amp; parent) {\n    fill(parent.begin(), parent.end(), -1);\n    parent[s] = -2;\n    queue&lt;pair&lt;int, int&gt;&gt; q;\n    q.push({s, INF});\n\n    while (!q.empty()) {\n        int cur = q.front().first;\n        int flow = q.front().second;\n        q.pop();\n\n        for (int next : adj[cur]) {\n            if (parent[next] == -1 &amp;&amp; capacity[cur][next]) {\n                parent[next] = cur;\n                int new_flow = min(flow, capacity[cur][next]);\n                if (next == t)\n                    return new_flow;\n                q.push({next, new_flow});\n            }\n        }\n    }\n\n    return 0;\n}\n\nint maxflow(int s, int t) {\n    int flow = 0;\n    vector&lt;int&gt; parent(n);\n    int new_flow;\n\n    while (new_flow = bfs(s, t, parent)) {\n        flow += new_flow;\n        int cur = t;\n        while (cur != s) {\n            int prev = parent[cur];\n            capacity[prev][cur] -= new_flow;\n            capacity[cur][prev] += new_flow;\n            cur = prev;\n        }\n    }\n\n    return flow;\n}\n</code></pre>","tags":["Translated"]},{"location":"graph/edmonds_karp.html#integral-theorem","title":"\u0110\u1ecbnh l\u00fd lu\u1ed3ng nguy\u00ean (Integral flow theorem)","text":"<p>\u0110\u1ecbnh l\u00fd n\u00f3i r\u1eb1ng, n\u1ebfu m\u1ecdi dung l\u01b0\u1ee3ng trong m\u1ea1ng l\u00e0 m\u1ed9t s\u1ed1 nguy\u00ean, th\u00ec k\u00edch th\u01b0\u1edbc c\u1ee7a lu\u1ed3ng c\u1ef1c \u0111\u1ea1i l\u00e0 m\u1ed9t s\u1ed1 nguy\u00ean, v\u00e0 c\u00f3 m\u1ed9t lu\u1ed3ng c\u1ef1c \u0111\u1ea1i sao cho lu\u1ed3ng trong m\u1ed7i c\u1ea1nh c\u0169ng l\u00e0 m\u1ed9t s\u1ed1 nguy\u00ean. \u0110\u1eb7c bi\u1ec7t, ph\u01b0\u01a1ng ph\u00e1p Ford-Fulkerson t\u00ecm th\u1ea5y m\u1ed9t lu\u1ed3ng nh\u01b0 v\u1eady.</p>","tags":["Translated"]},{"location":"graph/edmonds_karp.html#max-flow-min-cut-theorem","title":"\u0110\u1ecbnh l\u00fd Lu\u1ed3ng c\u1ef1c \u0111\u1ea1i l\u00e1t c\u1eaft c\u1ef1c ti\u1ec3u (Max-flow min-cut theorem)","text":"<p>M\u1ed9t l\u00e1t c\u1eaft $s$-$t$ l\u00e0 m\u1ed9t ph\u00e2n ho\u1ea1ch c\u00e1c \u0111\u1ec9nh c\u1ee7a m\u1ed9t m\u1ea1ng lu\u1ed3ng th\u00e0nh hai t\u1eadp h\u1ee3p, sao cho m\u1ed9t t\u1eadp h\u1ee3p bao g\u1ed3m ngu\u1ed3n $s$ v\u00e0 t\u1eadp h\u1ee3p kia bao g\u1ed3m \u0111\u00edch $t$. Dung l\u01b0\u1ee3ng c\u1ee7a m\u1ed9t l\u00e1t c\u1eaft $s$-$t$ \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a l\u00e0 t\u1ed5ng dung l\u01b0\u1ee3ng c\u1ee7a c\u00e1c c\u1ea1nh t\u1eeb ph\u00eda ngu\u1ed3n \u0111\u1ebfn ph\u00eda \u0111\u00edch.</p> <p>R\u00f5 r\u00e0ng, ch\u00fang ta kh\u00f4ng th\u1ec3 g\u1eedi nhi\u1ec1u lu\u1ed3ng t\u1eeb $s$ \u0111\u1ebfn $t$ h\u01a1n dung l\u01b0\u1ee3ng c\u1ee7a b\u1ea5t k\u1ef3 l\u00e1t c\u1eaft $s$-$t$ n\u00e0o. Do \u0111\u00f3, lu\u1ed3ng c\u1ef1c \u0111\u1ea1i b\u1ecb ch\u1eb7n b\u1edfi dung l\u01b0\u1ee3ng l\u00e1t c\u1eaft c\u1ef1c ti\u1ec3u.</p> <p>\u0110\u1ecbnh l\u00fd lu\u1ed3ng c\u1ef1c \u0111\u1ea1i l\u00e1t c\u1eaft c\u1ef1c ti\u1ec3u th\u1eadm ch\u00ed c\u00f2n \u0111i xa h\u01a1n. N\u00f3 n\u00f3i r\u1eb1ng dung l\u01b0\u1ee3ng c\u1ee7a lu\u1ed3ng c\u1ef1c \u0111\u1ea1i ph\u1ea3i b\u1eb1ng dung l\u01b0\u1ee3ng c\u1ee7a l\u00e1t c\u1eaft c\u1ef1c ti\u1ec3u.</p> <p>Trong h\u00ecnh \u1ea3nh sau \u0111\u00e2y, b\u1ea1n c\u00f3 th\u1ec3 th\u1ea5y l\u00e1t c\u1eaft c\u1ef1c ti\u1ec3u c\u1ee7a m\u1ea1ng lu\u1ed3ng ch\u00fang ta \u0111\u00e3 s\u1eed d\u1ee5ng tr\u01b0\u1edbc \u0111\u00f3. N\u00f3 cho th\u1ea5y dung l\u01b0\u1ee3ng c\u1ee7a l\u00e1t c\u1eaft $\\{s, A, D\\}$ v\u00e0 $\\{B, C, t\\}$ l\u00e0 $5 + 3 + 2 = 10$, b\u1eb1ng v\u1edbi lu\u1ed3ng c\u1ef1c \u0111\u1ea1i m\u00e0 ch\u00fang ta \u0111\u00e3 t\u00ecm th\u1ea5y. C\u00e1c l\u00e1t c\u1eaft kh\u00e1c s\u1ebd c\u00f3 dung l\u01b0\u1ee3ng l\u1edbn h\u01a1n, nh\u01b0 dung l\u01b0\u1ee3ng gi\u1eefa $\\{s, A\\}$ v\u00e0 $\\{B, C, D, t\\}$ l\u00e0 $4 + 3 + 5 = 12$.</p> <p>L\u00e1t c\u1eaft c\u1ef1c ti\u1ec3u c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y sau khi th\u1ef1c hi\u1ec7n t\u00ednh to\u00e1n lu\u1ed3ng c\u1ef1c \u0111\u1ea1i b\u1eb1ng ph\u01b0\u01a1ng ph\u00e1p Ford-Fulkerson. M\u1ed9t l\u00e1t c\u1eaft c\u1ef1c ti\u1ec3u c\u00f3 th\u1ec3 l\u00e0 nh\u01b0 sau: t\u1eadp h\u1ee3p t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh c\u00f3 th\u1ec3 \u0111\u1ebfn \u0111\u01b0\u1ee3c t\u1eeb $s$ trong \u0111\u1ed3 th\u1ecb d\u01b0 (s\u1eed d\u1ee5ng c\u00e1c c\u1ea1nh c\u00f3 dung l\u01b0\u1ee3ng d\u01b0 d\u01b0\u01a1ng), v\u00e0 t\u1eadp h\u1ee3p t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh kh\u00e1c. Ph\u00e2n v\u00f9ng n\u00e0y c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng t\u00ecm th\u1ea5y b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng DFS b\u1eaft \u0111\u1ea7u t\u1ea1i $s$.</p>","tags":["Translated"]},{"location":"graph/edmonds_karp.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>Codeforces - Array and Operations</li> <li>Codeforces - Red-Blue Graph</li> <li>CSES - Download Speed</li> <li>CSES - Police Chase</li> <li>CSES - School Dance</li> <li>CSES - Distinct Routes</li> </ul>","tags":["Translated"]},{"location":"graph/euler_path.html","title":"T\u00ecm \u0111\u01b0\u1eddng \u0111i Euler trong $O(M)$ (Finding the Eulerian path in $O(M)$)","text":"<p>\u0110\u01b0\u1eddng \u0111i Euler l\u00e0 \u0111\u01b0\u1eddng \u0111i trong \u0111\u1ed3 th\u1ecb \u0111i qua t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh c\u1ee7a n\u00f3 \u0111\u00fang m\u1ed9t l\u1ea7n. Chu tr\u00ecnh Euler l\u00e0 \u0111\u01b0\u1eddng \u0111i Euler m\u00e0 c\u0169ng l\u00e0 m\u1ed9t chu tr\u00ecnh.</p> <p>B\u00e0i to\u00e1n l\u00e0 t\u00ecm \u0111\u01b0\u1eddng \u0111i Euler trong m\u1ed9t \u0111a \u0111\u1ed3 th\u1ecb v\u00f4 h\u01b0\u1edbng c\u00f3 khuy\u00ean.</p>","tags":["Translated"]},{"location":"graph/euler_path.html#algorithm","title":"Thu\u1eadt to\u00e1n (Algorithm)","text":"<p>\u0110\u1ea7u ti\u00ean ch\u00fang ta c\u00f3 th\u1ec3 ki\u1ec3m tra xem c\u00f3 t\u1ed3n t\u1ea1i \u0111\u01b0\u1eddng \u0111i Euler hay kh\u00f4ng. Ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng \u0111\u1ecbnh l\u00fd sau. M\u1ed9t chu tr\u00ecnh Euler t\u1ed3n t\u1ea1i khi v\u00e0 ch\u1ec9 khi b\u1eadc c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh \u0111\u1ec1u l\u00e0 ch\u1eb5n. V\u00e0 m\u1ed9t \u0111\u01b0\u1eddng \u0111i Euler t\u1ed3n t\u1ea1i khi v\u00e0 ch\u1ec9 khi s\u1ed1 l\u01b0\u1ee3ng \u0111\u1ec9nh c\u00f3 b\u1eadc l\u1ebb l\u00e0 hai (ho\u1eb7c kh\u00f4ng, trong tr\u01b0\u1eddng h\u1ee3p t\u1ed3n t\u1ea1i chu tr\u00ecnh Euler). Ngo\u00e0i ra, t\u1ea5t nhi\u00ean, \u0111\u1ed3 th\u1ecb ph\u1ea3i \u0111\u1ee7 li\u00ean th\u00f4ng (t\u1ee9c l\u00e0, n\u1ebfu b\u1ea1n lo\u1ea1i b\u1ecf t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh c\u00f4 l\u1eadp kh\u1ecfi n\u00f3, b\u1ea1n s\u1ebd nh\u1eadn \u0111\u01b0\u1ee3c m\u1ed9t \u0111\u1ed3 th\u1ecb li\u00ean th\u00f4ng).</p> <p>\u0110\u1ec3 t\u00ecm \u0111\u01b0\u1eddng \u0111i Euler / chu tr\u00ecnh Euler, ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng chi\u1ebfn l\u01b0\u1ee3c sau: Ch\u00fang ta t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c chu tr\u00ecnh \u0111\u01a1n v\u00e0 k\u1ebft h\u1ee3p ch\u00fang th\u00e0nh m\u1ed9t - \u0111\u00e2y s\u1ebd l\u00e0 chu tr\u00ecnh Euler. N\u1ebfu \u0111\u1ed3 th\u1ecb sao cho \u0111\u01b0\u1eddng \u0111i Euler kh\u00f4ng ph\u1ea3i l\u00e0 m\u1ed9t chu tr\u00ecnh, th\u00ec h\u00e3y th\u00eam c\u1ea1nh b\u1ecb thi\u1ebfu v\u00e0o, t\u00ecm chu tr\u00ecnh Euler, sau \u0111\u00f3 x\u00f3a c\u1ea1nh th\u1eeba.</p> <p>Vi\u1ec7c t\u00ecm ki\u1ebfm t\u1ea5t c\u1ea3 c\u00e1c chu tr\u00ecnh v\u00e0 k\u1ebft h\u1ee3p ch\u00fang c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n b\u1eb1ng m\u1ed9t th\u1ee7 t\u1ee5c \u0111\u1ec7 quy \u0111\u01a1n gi\u1ea3n:</p> <pre><code>procedure FindEulerPath(V)\n  1. duy\u1ec7t qua t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh \u0111i ra t\u1eeb \u0111\u1ec9nh V;\n       x\u00f3a c\u1ea1nh n\u00e0y kh\u1ecfi \u0111\u1ed3 th\u1ecb,\n       v\u00e0 g\u1ecdi FindEulerPath t\u1eeb \u0111\u1ea7u th\u1ee9 hai c\u1ee7a c\u1ea1nh n\u00e0y;\n  2. th\u00eam \u0111\u1ec9nh V v\u00e0o c\u00e2u tr\u1ea3 l\u1eddi.\n</code></pre> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a thu\u1eadt to\u00e1n n\u00e0y r\u00f5 r\u00e0ng l\u00e0 tuy\u1ebfn t\u00ednh \u0111\u1ed1i v\u1edbi s\u1ed1 l\u01b0\u1ee3ng c\u1ea1nh.</p> <p>Nh\u01b0ng ch\u00fang ta c\u00f3 th\u1ec3 vi\u1ebft c\u00f9ng m\u1ed9t thu\u1eadt to\u00e1n trong phi\u00ean b\u1ea3n kh\u00f4ng \u0111\u1ec7 quy:</p> <pre><code>stack St;\n\u0111\u1eb7t \u0111\u1ec9nh b\u1eaft \u0111\u1ea7u v\u00e0o St;\ncho \u0111\u1ebfn khi St r\u1ed7ng\n  g\u1ecdi V l\u00e0 gi\u00e1 tr\u1ecb \u1edf \u0111\u1ec9nh c\u1ee7a St;\n  n\u1ebfu degree(V) = 0, th\u00ec\n    th\u00eam V v\u00e0o c\u00e2u tr\u1ea3 l\u1eddi;\n    x\u00f3a V kh\u1ecfi \u0111\u1ec9nh c\u1ee7a St;\n  ng\u01b0\u1ee3c l\u1ea1i\n    t\u00ecm b\u1ea5t k\u1ef3 c\u1ea1nh n\u00e0o \u0111i ra t\u1eeb V;\n    x\u00f3a n\u00f3 kh\u1ecfi \u0111\u1ed3 th\u1ecb;\n    \u0111\u1eb7t \u0111\u1ea7u th\u1ee9 hai c\u1ee7a c\u1ea1nh n\u00e0y v\u00e0o St;\n</code></pre> <p>D\u1ec5 d\u00e0ng ki\u1ec3m tra t\u00ednh t\u01b0\u01a1ng \u0111\u01b0\u01a1ng c\u1ee7a hai d\u1ea1ng thu\u1eadt to\u00e1n n\u00e0y. Tuy nhi\u00ean, d\u1ea1ng th\u1ee9 hai r\u00f5 r\u00e0ng nhanh h\u01a1n v\u00e0 m\u00e3 s\u1ebd hi\u1ec7u qu\u1ea3 h\u01a1n nhi\u1ec1u.</p>","tags":["Translated"]},{"location":"graph/euler_path.html#the-domino-problem","title":"B\u00e0i to\u00e1n Domino (The Domino problem)","text":"<p>Ch\u00fang t\u00f4i \u0111\u01b0a ra \u1edf \u0111\u00e2y m\u1ed9t b\u00e0i to\u00e1n chu tr\u00ecnh Euler c\u1ed5 \u0111i\u1ec3n - b\u00e0i to\u00e1n Domino.</p> <p>C\u00f3 $N$ qu\u00e2n domino, nh\u01b0 \u0111\u00e3 bi\u1ebft, tr\u00ean c\u1ea3 hai \u0111\u1ea7u c\u1ee7a Domino m\u1ed9t s\u1ed1 \u0111\u01b0\u1ee3c vi\u1ebft (th\u01b0\u1eddng t\u1eeb 1 \u0111\u1ebfn 6, nh\u01b0ng trong tr\u01b0\u1eddng h\u1ee3p c\u1ee7a ch\u00fang t\u00f4i \u0111i\u1ec1u \u0111\u00f3 kh\u00f4ng quan tr\u1ecdng). B\u1ea1n mu\u1ed1n \u0111\u1eb7t t\u1ea5t c\u1ea3 c\u00e1c qu\u00e2n domino th\u00e0nh m\u1ed9t h\u00e0ng sao cho c\u00e1c s\u1ed1 tr\u00ean b\u1ea5t k\u1ef3 hai qu\u00e2n domino li\u1ec1n k\u1ec1 n\u00e0o, \u0111\u01b0\u1ee3c vi\u1ebft tr\u00ean c\u1ea1nh chung c\u1ee7a ch\u00fang, tr\u00f9ng nhau. C\u00e1c qu\u00e2n domino \u0111\u01b0\u1ee3c ph\u00e9p xoay.</p> <p>Ph\u00e1t bi\u1ec3u l\u1ea1i b\u00e0i to\u00e1n. H\u00e3y \u0111\u1ec3 c\u00e1c s\u1ed1 \u0111\u01b0\u1ee3c vi\u1ebft tr\u00ean c\u00e1c m\u1eb7t l\u00e0 c\u00e1c \u0111\u1ec9nh c\u1ee7a \u0111\u1ed3 th\u1ecb, v\u00e0 c\u00e1c qu\u00e2n domino l\u00e0 c\u00e1c c\u1ea1nh c\u1ee7a \u0111\u1ed3 th\u1ecb n\u00e0y (m\u1ed7i Domino v\u1edbi c\u00e1c s\u1ed1 $(a,b)$ l\u00e0 c\u00e1c c\u1ea1nh $(a,b)$ v\u00e0 $(b, a)$). Khi \u0111\u00f3, b\u00e0i to\u00e1n c\u1ee7a ch\u00fang ta \u0111\u01b0\u1ee3c quy v\u1ec1 b\u00e0i to\u00e1n t\u00ecm \u0111\u01b0\u1eddng \u0111i Euler trong \u0111\u1ed3 th\u1ecb n\u00e0y.</p>","tags":["Translated"]},{"location":"graph/euler_path.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>Ch\u01b0\u01a1ng tr\u00ecnh d\u01b0\u1edbi \u0111\u00e2y t\u00ecm ki\u1ebfm v\u00e0 in ra m\u1ed9t v\u00f2ng l\u1eb7p ho\u1eb7c \u0111\u01b0\u1eddng \u0111i Euler trong m\u1ed9t \u0111\u1ed3 th\u1ecb, ho\u1eb7c in ra $-1$ n\u1ebfu n\u00f3 kh\u00f4ng t\u1ed3n t\u1ea1i.</p> <p>\u0110\u1ea7u ti\u00ean, ch\u01b0\u01a1ng tr\u00ecnh ki\u1ec3m tra b\u1eadc c\u1ee7a c\u00e1c \u0111\u1ec9nh: n\u1ebfu kh\u00f4ng c\u00f3 \u0111\u1ec9nh n\u00e0o c\u00f3 b\u1eadc l\u1ebb, th\u00ec \u0111\u1ed3 th\u1ecb c\u00f3 chu tr\u00ecnh Euler, n\u1ebfu c\u00f3 $2$ \u0111\u1ec9nh c\u00f3 b\u1eadc l\u1ebb, th\u00ec trong \u0111\u1ed3 th\u1ecb ch\u1ec9 c\u00f3 \u0111\u01b0\u1eddng \u0111i Euler (nh\u01b0ng kh\u00f4ng c\u00f3 chu tr\u00ecnh Euler), n\u1ebfu c\u00f3 nhi\u1ec1u h\u01a1n $2$ \u0111\u1ec9nh nh\u01b0 v\u1eady, th\u00ec trong \u0111\u1ed3 th\u1ecb kh\u00f4ng c\u00f3 chu tr\u00ecnh Euler ho\u1eb7c \u0111\u01b0\u1eddng \u0111i Euler. \u0110\u1ec3 t\u00ecm \u0111\u01b0\u1eddng \u0111i Euler (kh\u00f4ng ph\u1ea3i l\u00e0 chu tr\u00ecnh), h\u00e3y l\u00e0m nh\u01b0 sau: n\u1ebfu $V1$ v\u00e0 $V2$ l\u00e0 hai \u0111\u1ec9nh c\u00f3 b\u1eadc l\u1ebb, th\u00ec ch\u1ec9 c\u1ea7n th\u00eam m\u1ed9t c\u1ea1nh $(V1, V2)$, trong \u0111\u1ed3 th\u1ecb k\u1ebft qu\u1ea3 ch\u00fang ta t\u00ecm chu tr\u00ecnh Euler (n\u00f3 r\u00f5 r\u00e0ng s\u1ebd t\u1ed3n t\u1ea1i), v\u00e0 sau \u0111\u00f3 x\u00f3a c\u1ea1nh \"gi\u1ea3\" $(V1, V2)$ kh\u1ecfi c\u00e2u tr\u1ea3 l\u1eddi. Ch\u00fang ta s\u1ebd t\u00ecm ki\u1ebfm chu tr\u00ecnh Euler ch\u00ednh x\u00e1c nh\u01b0 m\u00f4 t\u1ea3 \u1edf tr\u00ean (phi\u00ean b\u1ea3n kh\u00f4ng \u0111\u1ec7 quy), v\u00e0 \u0111\u1ed3ng th\u1eddi \u1edf cu\u1ed1i thu\u1eadt to\u00e1n n\u00e0y, ch\u00fang ta s\u1ebd ki\u1ec3m tra xem \u0111\u1ed3 th\u1ecb c\u00f3 li\u00ean th\u00f4ng hay kh\u00f4ng (n\u1ebfu \u0111\u1ed3 th\u1ecb kh\u00f4ng li\u00ean th\u00f4ng, th\u00ec \u1edf cu\u1ed1i thu\u1eadt to\u00e1n, m\u1ed9t s\u1ed1 c\u1ea1nh s\u1ebd v\u1eabn c\u00f2n trong \u0111\u1ed3 th\u1ecb, v\u00e0 trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y ch\u00fang ta c\u1ea7n in $-1$). Cu\u1ed1i c\u00f9ng, ch\u01b0\u01a1ng tr\u00ecnh t\u00ednh \u0111\u1ebfn vi\u1ec7c c\u00f3 th\u1ec3 c\u00f3 c\u00e1c \u0111\u1ec9nh c\u00f4 l\u1eadp trong \u0111\u1ed3 th\u1ecb.</p> <p>L\u01b0u \u00fd r\u1eb1ng ch\u00fang ta s\u1eed d\u1ee5ng ma tr\u1eadn k\u1ec1 trong b\u00e0i to\u00e1n n\u00e0y. Ngo\u00e0i ra, vi\u1ec7c c\u00e0i \u0111\u1eb7t n\u00e0y x\u1eed l\u00fd vi\u1ec7c t\u00ecm \u0111\u1ec9nh ti\u1ebfp theo b\u1eb1ng brute-force, \u0111\u00f2i h\u1ecfi ph\u1ea3i l\u1eb7p \u0111i l\u1eb7p l\u1ea1i qua to\u00e0n b\u1ed9 h\u00e0ng trong ma tr\u1eadn. C\u00e1ch t\u1ed1t h\u01a1n s\u1ebd l\u00e0 l\u01b0u tr\u1eef \u0111\u1ed3 th\u1ecb d\u01b0\u1edbi d\u1ea1ng danh s\u00e1ch k\u1ec1, v\u00e0 x\u00f3a c\u00e1c c\u1ea1nh trong $O(1)$ v\u00e0 \u0111\u00e1nh d\u1ea5u c\u00e1c c\u1ea1nh ng\u01b0\u1ee3c l\u1ea1i trong danh s\u00e1ch ri\u00eang bi\u1ec7t. B\u1eb1ng c\u00e1ch n\u00e0y ch\u00fang ta c\u00f3 th\u1ec3 \u0111\u1ea1t \u0111\u01b0\u1ee3c thu\u1eadt to\u00e1n $O(N)$.</p> <pre><code>int main() {\n    int n;\n    vector&lt;vector&lt;int&gt;&gt; g(n, vector&lt;int&gt;(n));\n    // \u0111\u1ecdc \u0111\u1ed3 th\u1ecb v\u00e0o ma tr\u1eadn k\u1ec1\n\n    vector&lt;int&gt; deg(n);\n    for (int i = 0; i &lt; n; ++i) {\n        for (int j = 0; j &lt; n; ++j)\n            deg[i] += g[i][j];\n    }\n\n    int first = 0;\n    while (first &lt; n &amp;&amp; !deg[first])\n        ++first;\n    if (first == n) {\n        cout &lt;&lt; -1;\n        return 0;\n    }\n\n    int v1 = -1, v2 = -1;\n    bool bad = false;\n    for (int i = 0; i &lt; n; ++i) {\n        if (deg[i] &amp; 1) {\n            if (v1 == -1)\n                v1 = i;\n            else if (v2 == -1)\n                v2 = i;\n            else\n                bad = true;\n        }\n    }\n\n    if (v1 != -1)\n        ++g[v1][v2], ++g[v2][v1];\n\n    stack&lt;int&gt; st;\n    st.push(first);\n    vector&lt;int&gt; res;\n    while (!st.empty()) {\n        int v = st.top();\n        int i;\n        for (i = 0; i &lt; n; ++i)\n            if (g[v][i])\n                break;\n        if (i == n) {\n            res.push_back(v);\n            st.pop();\n        } else {\n            --g[v][i];\n            --g[i][v];\n            st.push(i);\n        }\n    }\n\n    if (v1 != -1) {\n        for (size_t i = 0; i + 1 &lt; res.size(); ++i) {\n            if ((res[i] == v1 &amp;&amp; res[i + 1] == v2) ||\n                (res[i] == v2 &amp;&amp; res[i + 1] == v1)) {\n                vector&lt;int&gt; res2;\n                for (size_t j = i + 1; j &lt; res.size(); ++j)\n                    res2.push_back(res[j]);\n                for (size_t j = 1; j &lt;= i; ++j)\n                    res2.push_back(res[j]);\n                res = res2;\n                break;\n            }\n        }\n    }\n\n    for (int i = 0; i &lt; n; ++i) {\n        for (int j = 0; j &lt; n; ++j) {\n            if (g[i][j])\n                bad = true;\n        }\n    }\n\n    if (bad) {\n        cout &lt;&lt; -1;\n    } else {\n        for (int x : res)\n            cout &lt;&lt; x &lt;&lt; \" \";\n    }\n}\n</code></pre>","tags":["Translated"]},{"location":"graph/euler_path.html#bai-tap-practice-problems","title":"B\u00e0i t\u1eadp (Practice problems):","text":"<ul> <li>CSES : Mail Delivery</li> <li>CSES : Teleporters Path</li> <li>Codeforces - Melody</li> <li>Codeforces - Tanya and Password</li> </ul>","tags":["Translated"]},{"location":"graph/finding-cycle.html","title":"Ki\u1ec3m tra \u0111\u1ed3 th\u1ecb kh\u00f4ng chu tr\u00ecnh v\u00e0 t\u00ecm chu tr\u00ecnh trong $O(M)$ (Checking a graph for acyclicity and finding a cycle in $O(M)$)","text":"<p>Xem x\u00e9t m\u1ed9t \u0111\u1ed3 th\u1ecb c\u00f3 h\u01b0\u1edbng ho\u1eb7c v\u00f4 h\u01b0\u1edbng kh\u00f4ng c\u00f3 khuy\u00ean (loops) v\u00e0 \u0111a c\u1ea1nh (multiple edges). Ch\u00fang ta ph\u1ea3i ki\u1ec3m tra xem n\u00f3 c\u00f3 ph\u1ea3i l\u00e0 kh\u00f4ng chu tr\u00ecnh (acyclic) hay kh\u00f4ng, v\u00e0 n\u1ebfu kh\u00f4ng, h\u00e3y t\u00ecm b\u1ea5t k\u1ef3 chu tr\u00ecnh n\u00e0o.</p> <p>Ch\u00fang ta c\u00f3 th\u1ec3 gi\u1ea3i quy\u1ebft b\u00e0i to\u00e1n n\u00e0y b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng T\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u trong $O(M)$ trong \u0111\u00f3 $M$ l\u00e0 s\u1ed1 l\u01b0\u1ee3ng c\u1ea1nh.</p>","tags":["Translated"]},{"location":"graph/finding-cycle.html#algorithm","title":"Thu\u1eadt to\u00e1n (Algorithm)","text":"<p>Ch\u00fang ta s\u1ebd ch\u1ea1y m\u1ed9t lo\u1ea1t c\u00e1c DFS trong \u0111\u1ed3 th\u1ecb. Ban \u0111\u1ea7u t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh \u0111\u01b0\u1ee3c t\u00f4 m\u00e0u tr\u1eafng (0). T\u1eeb m\u1ed7i \u0111\u1ec9nh ch\u01b0a \u0111\u01b0\u1ee3c th\u0103m (m\u00e0u tr\u1eafng), b\u1eaft \u0111\u1ea7u DFS, \u0111\u00e1nh d\u1ea5u n\u00f3 l\u00e0 m\u00e0u x\u00e1m (1) khi \u0111i v\u00e0o v\u00e0 \u0111\u00e1nh d\u1ea5u n\u00f3 l\u00e0 m\u00e0u \u0111en (2) khi tho\u00e1t ra. N\u1ebfu DFS di chuy\u1ec3n \u0111\u1ebfn m\u1ed9t \u0111\u1ec9nh m\u00e0u x\u00e1m, th\u00ec ch\u00fang ta \u0111\u00e3 t\u00ecm th\u1ea5y m\u1ed9t chu tr\u00ecnh (n\u1ebfu \u0111\u1ed3 th\u1ecb l\u00e0 v\u00f4 h\u01b0\u1edbng, c\u1ea1nh t\u1edbi cha kh\u00f4ng \u0111\u01b0\u1ee3c xem x\u00e9t). B\u1ea3n th\u00e2n chu tr\u00ecnh c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00e1i t\u1ea1o b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng m\u1ea3ng cha (parent array).</p>","tags":["Translated"]},{"location":"graph/finding-cycle.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u1ed9t c\u00e0i \u0111\u1eb7t cho \u0111\u1ed3 th\u1ecb c\u00f3 h\u01b0\u1edbng.</p> <pre><code>int n;\nvector&lt;vector&lt;int&gt;&gt; adj;\nvector&lt;char&gt; color;\nvector&lt;int&gt; parent;\nint cycle_start, cycle_end;\n\nbool dfs(int v) {\n    color[v] = 1;\n    for (int u : adj[v]) {\n        if (color[u] == 0) {\n            parent[u] = v;\n            if (dfs(u))\n                return true;\n        } else if (color[u] == 1) {\n            cycle_end = v;\n            cycle_start = u;\n            return true;\n        }\n    }\n    color[v] = 2;\n    return false;\n}\n\nvoid find_cycle() {\n    color.assign(n, 0);\n    parent.assign(n, -1);\n    cycle_start = -1;\n\n    for (int v = 0; v &lt; n; v++) {\n        if (color[v] == 0 &amp;&amp; dfs(v))\n            break;\n    }\n\n    if (cycle_start == -1) {\n        cout &lt;&lt; \"Acyclic\" &lt;&lt; endl;\n    } else {\n        vector&lt;int&gt; cycle;\n        cycle.push_back(cycle_start);\n        for (int v = cycle_end; v != cycle_start; v = parent[v])\n            cycle.push_back(v);\n        cycle.push_back(cycle_start);\n        reverse(cycle.begin(), cycle.end());\n\n        cout &lt;&lt; \"Cycle found: \";\n        for (int v : cycle)\n            cout &lt;&lt; v &lt;&lt; \" \";\n        cout &lt;&lt; endl;\n    }\n}\n</code></pre> <p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u1ed9t c\u00e0i \u0111\u1eb7t cho \u0111\u1ed3 th\u1ecb v\u00f4 h\u01b0\u1edbng. L\u01b0u \u00fd r\u1eb1ng trong phi\u00ean b\u1ea3n v\u00f4 h\u01b0\u1edbng, n\u1ebfu m\u1ed9t \u0111\u1ec9nh <code>v</code> \u0111\u01b0\u1ee3c t\u00f4 m\u00e0u \u0111en, n\u00f3 s\u1ebd kh\u00f4ng bao gi\u1edd \u0111\u01b0\u1ee3c th\u0103m l\u1ea1i b\u1edfi DFS. \u0110i\u1ec1u n\u00e0y l\u00e0 do ch\u00fang ta \u0111\u00e3 kh\u00e1m ph\u00e1 t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh k\u1ebft n\u1ed1i c\u1ee7a <code>v</code> khi ch\u00fang ta l\u1ea7n \u0111\u1ea7u ti\u00ean gh\u00e9 th\u0103m n\u00f3. Th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng ch\u1ee9a <code>v</code> (sau khi lo\u1ea1i b\u1ecf c\u1ea1nh gi\u1eefa <code>v</code> v\u00e0 cha c\u1ee7a n\u00f3) ph\u1ea3i l\u00e0 m\u1ed9t c\u00e2y, n\u1ebfu DFS \u0111\u00e3 ho\u00e0n th\u00e0nh x\u1eed l\u00fd <code>v</code> m\u00e0 kh\u00f4ng t\u00ecm th\u1ea5y chu tr\u00ecnh. V\u00ec v\u1eady, ch\u00fang ta th\u1eadm ch\u00ed kh\u00f4ng c\u1ea7n ph\u00e2n bi\u1ec7t gi\u1eefa c\u00e1c tr\u1ea1ng th\u00e1i m\u00e0u x\u00e1m v\u00e0 m\u00e0u \u0111en. Do \u0111\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 bi\u1ebfn vector char <code>color</code> th\u00e0nh m\u1ed9t vector boolean <code>visited</code>.</p> <pre><code>int n;\nvector&lt;vector&lt;int&gt;&gt; adj;\nvector&lt;bool&gt; visited;\nvector&lt;int&gt; parent;\nint cycle_start, cycle_end;\n\nbool dfs(int v, int par) { // truy\u1ec1n \u0111\u1ec9nh v\u00e0 \u0111\u1ec9nh cha c\u1ee7a n\u00f3\n    visited[v] = true;\n    for (int u : adj[v]) {\n        if(u == par) continue; // b\u1ecf qua c\u1ea1nh t\u1edbi \u0111\u1ec9nh cha\n        if (visited[u]) {\n            cycle_end = v;\n            cycle_start = u;\n            return true;\n        }\n        parent[u] = v;\n        if (dfs(u, parent[u]))\n            return true;\n    }\n    return false;\n}\n\nvoid find_cycle() {\n    visited.assign(n, false);\n    parent.assign(n, -1);\n    cycle_start = -1;\n\n    for (int v = 0; v &lt; n; v++) {\n        if (!visited[v] &amp;&amp; dfs(v, parent[v]))\n            break;\n    }\n\n    if (cycle_start == -1) {\n        cout &lt;&lt; \"Acyclic\" &lt;&lt; endl;\n    } else {\n        vector&lt;int&gt; cycle;\n        cycle.push_back(cycle_start);\n        for (int v = cycle_end; v != cycle_start; v = parent[v])\n            cycle.push_back(v);\n        cycle.push_back(cycle_start);\n\n        cout &lt;&lt; \"Cycle found: \";\n        for (int v : cycle)\n            cout &lt;&lt; v &lt;&lt; \" \";\n        cout &lt;&lt; endl;\n    }\n}\n</code></pre>","tags":["Translated"]},{"location":"graph/finding-cycle.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice problems)","text":"<ul> <li>AtCoder : Reachability in Functional Graph</li> <li>CSES : Round Trip</li> <li>CSES : Round Trip II</li> </ul>","tags":["Translated"]},{"location":"graph/finding-negative-cycle-in-graph.html","title":"T\u00ecm chu tr\u00ecnh \u00e2m trong \u0111\u1ed3 th\u1ecb (Finding a negative cycle in the graph)","text":"<p>B\u1ea1n \u0111\u01b0\u1ee3c cho m\u1ed9t \u0111\u1ed3 th\u1ecb c\u00f3 tr\u1ecdng s\u1ed1 c\u00f3 h\u01b0\u1edbng $G$ v\u1edbi $N$ \u0111\u1ec9nh v\u00e0 $M$ c\u1ea1nh. T\u00ecm b\u1ea5t k\u1ef3 chu tr\u00ecnh n\u00e0o c\u00f3 tr\u1ecdng s\u1ed1 \u00e2m trong \u0111\u00f3, n\u1ebfu t\u1ed3n t\u1ea1i m\u1ed9t chu tr\u00ecnh nh\u01b0 v\u1eady.</p> <p>Trong m\u1ed9t c\u00e1ch ph\u00e1t bi\u1ec3u b\u00e0i to\u00e1n kh\u00e1c, b\u1ea1n ph\u1ea3i t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c c\u1eb7p \u0111\u1ec9nh c\u00f3 \u0111\u01b0\u1eddng \u0111i v\u1edbi tr\u1ecdng s\u1ed1 nh\u1ecf t\u00f9y \u00fd gi\u1eefa ch\u00fang.</p> <p>Thu\u1eadn ti\u1ec7n \u0111\u1ec3 s\u1eed d\u1ee5ng c\u00e1c thu\u1eadt to\u00e1n kh\u00e1c nhau \u0111\u1ec3 gi\u1ea3i quy\u1ebft hai bi\u1ebfn th\u1ec3 n\u00e0y c\u1ee7a b\u00e0i to\u00e1n, v\u00ec v\u1eady ch\u00fang t\u00f4i s\u1ebd th\u1ea3o lu\u1eadn v\u1ec1 c\u1ea3 hai \u1edf \u0111\u00e2y.</p>","tags":["Translated"]},{"location":"graph/finding-negative-cycle-in-graph.html#using-bellman-ford-algorithm","title":"S\u1eed d\u1ee5ng thu\u1eadt to\u00e1n Bellman-Ford (Using Bellman-Ford algorithm)","text":"<p>Thu\u1eadt to\u00e1n Bellman-Ford cho ph\u00e9p b\u1ea1n ki\u1ec3m tra xem c\u00f3 t\u1ed3n t\u1ea1i m\u1ed9t chu tr\u00ecnh tr\u1ecdng s\u1ed1 \u00e2m trong \u0111\u1ed3 th\u1ecb hay kh\u00f4ng, v\u00e0 n\u1ebfu c\u00f3, h\u00e3y t\u00ecm m\u1ed9t trong nh\u1eefng chu tr\u00ecnh n\u00e0y.</p> <p>C\u00e1c chi ti\u1ebft c\u1ee7a thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 trong b\u00e0i vi\u1ebft v\u1ec1 thu\u1eadt to\u00e1n Bellman-Ford. \u1ede \u0111\u00e2y ch\u00fang t\u00f4i s\u1ebd ch\u1ec9 m\u00f4 t\u1ea3 \u1ee9ng d\u1ee5ng c\u1ee7a n\u00f3 cho b\u00e0i to\u00e1n n\u00e0y.</p> <p>C\u00e0i \u0111\u1eb7t ti\u00eau chu\u1ea9n c\u1ee7a Bellman-Ford t\u00ecm ki\u1ebfm m\u1ed9t chu tr\u00ecnh \u00e2m c\u00f3 th\u1ec3 truy c\u1eadp \u0111\u01b0\u1ee3c t\u1eeb m\u1ed9t \u0111\u1ec9nh b\u1eaft \u0111\u1ea7u $v$; tuy nhi\u00ean, thu\u1eadt to\u00e1n c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eeda \u0111\u1ed5i \u0111\u1ec3 ch\u1ec9 t\u00ecm b\u1ea5t k\u1ef3 chu tr\u00ecnh \u00e2m n\u00e0o trong \u0111\u1ed3 th\u1ecb. \u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y, ch\u00fang ta c\u1ea7n \u0111\u1eb7t t\u1ea5t c\u1ea3 kho\u1ea3ng c\u00e1ch $d[i]$ th\u00e0nh 0 v\u00e0 kh\u00f4ng ph\u1ea3i v\u00f4 c\u00f9ng \u2014 nh\u01b0 th\u1ec3 ch\u00fang ta \u0111ang t\u00ecm ki\u1ebfm \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t t\u1eeb t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh c\u00f9ng m\u1ed9t l\u00fac; t\u00ednh h\u1ee3p l\u1ec7 c\u1ee7a vi\u1ec7c ph\u00e1t hi\u1ec7n chu tr\u00ecnh \u00e2m kh\u00f4ng b\u1ecb \u1ea3nh h\u01b0\u1edfng.</p> <p>Th\u1ef1c hi\u1ec7n $N$ l\u1ea7n l\u1eb7p thu\u1eadt to\u00e1n Bellman-Ford. N\u1ebfu kh\u00f4ng c\u00f3 thay \u0111\u1ed5i n\u00e0o trong l\u1ea7n l\u1eb7p cu\u1ed1i c\u00f9ng, kh\u00f4ng c\u00f3 chu tr\u00ecnh tr\u1ecdng s\u1ed1 \u00e2m trong \u0111\u1ed3 th\u1ecb. Ng\u01b0\u1ee3c l\u1ea1i, l\u1ea5y m\u1ed9t \u0111\u1ec9nh m\u00e0 kho\u1ea3ng c\u00e1ch \u0111\u1ebfn n\u00f3 \u0111\u00e3 thay \u0111\u1ed5i, v\u00e0 \u0111i t\u1eeb n\u00f3 qua c\u00e1c t\u1ed5 ti\u00ean c\u1ee7a n\u00f3 cho \u0111\u1ebfn khi t\u00ecm th\u1ea5y chu tr\u00ecnh. Chu tr\u00ecnh n\u00e0y s\u1ebd l\u00e0 chu tr\u00ecnh tr\u1ecdng s\u1ed1 \u00e2m mong mu\u1ed1n.</p>","tags":["Translated"]},{"location":"graph/finding-negative-cycle-in-graph.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<pre><code>struct Edge {\n    int a, b, cost;\n};\n\nint n;\nvector&lt;Edge&gt; edges;\nconst int INF = 1000000000;\n\nvoid solve() {\n    vector&lt;int&gt; d(n, 0);\n    vector&lt;int&gt; p(n, -1);\n    int x;\n\n    for (int i = 0; i &lt; n; ++i) {\n        x = -1;\n        for (Edge e : edges) {\n            if (d[e.a] + e.cost &lt; d[e.b]) {\n                d[e.b] = max(-INF, d[e.a] + e.cost);\n                p[e.b] = e.a;\n                x = e.b;\n            }\n        }\n    }\n\n    if (x == -1) {\n        cout &lt;&lt; \"No negative cycle found.\";\n    } else {\n        for (int i = 0; i &lt; n; ++i)\n            x = p[x];\n\n        vector&lt;int&gt; cycle;\n        for (int v = x;; v = p[v]) {\n            cycle.push_back(v);\n            if (v == x &amp;&amp; cycle.size() &gt; 1)\n                break;\n        }\n        reverse(cycle.begin(), cycle.end());\n\n        cout &lt;&lt; \"Negative cycle: \";\n        for (int v : cycle)\n            cout &lt;&lt; v &lt;&lt; ' ';\n        cout &lt;&lt; endl;\n    }\n}\n</code></pre>","tags":["Translated"]},{"location":"graph/finding-negative-cycle-in-graph.html#using-floyd-warshall-algorithm","title":"S\u1eed d\u1ee5ng thu\u1eadt to\u00e1n Floyd-Warshall (Using Floyd-Warshall algorithm)","text":"<p>Thu\u1eadt to\u00e1n Floyd-Warshall cho ph\u00e9p gi\u1ea3i quy\u1ebft bi\u1ebfn th\u1ec3 th\u1ee9 hai c\u1ee7a b\u00e0i to\u00e1n - t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c c\u1eb7p \u0111\u1ec9nh $(i, j)$ kh\u00f4ng c\u00f3 \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t gi\u1eefa ch\u00fang (t\u1ee9c l\u00e0 t\u1ed3n t\u1ea1i m\u1ed9t \u0111\u01b0\u1eddng \u0111i c\u00f3 tr\u1ecdng s\u1ed1 nh\u1ecf t\u00f9y \u00fd).</p> <p>M\u1ed9t l\u1ea7n n\u1eefa, c\u00e1c chi ti\u1ebft c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y trong b\u00e0i vi\u1ebft Floyd-Warshall, v\u00e0 \u1edf \u0111\u00e2y ch\u00fang t\u00f4i ch\u1ec9 m\u00f4 t\u1ea3 \u1ee9ng d\u1ee5ng c\u1ee7a n\u00f3.</p> <p>Ch\u1ea1y thu\u1eadt to\u00e1n Floyd-Warshall tr\u00ean \u0111\u1ed3 th\u1ecb. Ban \u0111\u1ea7u $d[v][v] = 0$ cho m\u1ed7i $v$. Nh\u01b0ng sau khi ch\u1ea1y thu\u1eadt to\u00e1n $d[v][v]$ s\u1ebd nh\u1ecf h\u01a1n $0$ n\u1ebfu t\u1ed3n t\u1ea1i m\u1ed9t \u0111\u01b0\u1eddng \u0111i c\u00f3 \u0111\u1ed9 d\u00e0i \u00e2m t\u1eeb $v$ \u0111\u1ebfn $v$. Ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng \u0111i\u1ec1u n\u00e0y \u0111\u1ec3 t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c c\u1eb7p \u0111\u1ec9nh kh\u00f4ng c\u00f3 \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t gi\u1eefa ch\u00fang. Ch\u00fang ta l\u1eb7p qua t\u1ea5t c\u1ea3 c\u00e1c c\u1eb7p \u0111\u1ec9nh $(i, j)$ v\u00e0 \u0111\u1ed1i v\u1edbi m\u1ed7i c\u1eb7p, ch\u00fang ta ki\u1ec3m tra xem ch\u00fang c\u00f3 \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t gi\u1eefa ch\u00fang hay kh\u00f4ng. \u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y, h\u00e3y th\u1eed t\u1ea5t c\u1ea3 c\u00e1c kh\u1ea3 n\u0103ng cho m\u1ed9t \u0111\u1ec9nh trung gian $t$. $(i, j)$ kh\u00f4ng c\u00f3 \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t, n\u1ebfu m\u1ed9t trong c\u00e1c \u0111\u1ec9nh trung gian $t$ c\u00f3 $d[t][t] &lt; 0$ (t\u1ee9c l\u00e0 $t$ l\u00e0 m\u1ed9t ph\u1ea7n c\u1ee7a chu tr\u00ecnh tr\u1ecdng s\u1ed1 \u00e2m), $t$ c\u00f3 th\u1ec3 truy c\u1eadp \u0111\u01b0\u1ee3c t\u1eeb $i$ v\u00e0 $j$ c\u00f3 th\u1ec3 truy c\u1eadp \u0111\u01b0\u1ee3c t\u1eeb $t$. Khi \u0111\u00f3 \u0111\u01b0\u1eddng \u0111i t\u1eeb $i$ \u0111\u1ebfn $j$ c\u00f3 th\u1ec3 c\u00f3 tr\u1ecdng s\u1ed1 nh\u1ecf t\u00f9y \u00fd. Ch\u00fang ta s\u1ebd k\u00fd hi\u1ec7u \u0111i\u1ec1u n\u00e0y b\u1eb1ng <code>-INF</code>.</p>","tags":["Translated"]},{"location":"graph/finding-negative-cycle-in-graph.html#cai-at-implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<pre><code>for (int i = 0; i &lt; n; ++i) {\n    for (int j = 0; j &lt; n; ++j) {\n        for (int t = 0; t &lt; n; ++t) {\n            if (d[i][t] &lt; INF &amp;&amp; d[t][t] &lt; 0 &amp;&amp; d[t][j] &lt; INF)\n                d[i][j] = - INF; \n        }\n    }\n}\n</code></pre>","tags":["Translated"]},{"location":"graph/finding-negative-cycle-in-graph.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>UVA: Wormholes</li> <li>SPOJ: Alice in Amsterdam, I mean Wonderland</li> <li>SPOJ: Johnsons Algorithm</li> </ul>","tags":["Translated"]},{"location":"graph/fixed_length_paths.html","title":"S\u1ed1 l\u01b0\u1ee3ng \u0111\u01b0\u1eddng \u0111i c\u00f3 \u0111\u1ed9 d\u00e0i c\u1ed1 \u0111\u1ecbnh / \u0110\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t c\u00f3 \u0111\u1ed9 d\u00e0i c\u1ed1 \u0111\u1ecbnh (Number of paths of fixed length / Shortest paths of fixed length)","text":"<p>B\u00e0i vi\u1ebft sau \u0111\u00e2y m\u00f4 t\u1ea3 c\u00e1c gi\u1ea3i ph\u00e1p cho hai b\u00e0i to\u00e1n n\u00e0y \u0111\u01b0\u1ee3c x\u00e2y d\u1ef1ng tr\u00ean c\u00f9ng m\u1ed9t \u00fd t\u01b0\u1edfng: \u0111\u01b0a b\u00e0i to\u00e1n v\u1ec1 vi\u1ec7c x\u00e2y d\u1ef1ng ma tr\u1eadn v\u00e0 t\u00ednh to\u00e1n gi\u1ea3i ph\u00e1p b\u1eb1ng ph\u00e9p nh\u00e2n ma tr\u1eadn th\u00f4ng th\u01b0\u1eddng ho\u1eb7c ph\u00e9p nh\u00e2n s\u1eeda \u0111\u1ed5i.</p>","tags":["Translated"]},{"location":"graph/fixed_length_paths.html#number-of-paths-of-a-fixed-length","title":"S\u1ed1 l\u01b0\u1ee3ng \u0111\u01b0\u1eddng \u0111i c\u00f3 \u0111\u1ed9 d\u00e0i c\u1ed1 \u0111\u1ecbnh (Number of paths of a fixed length)","text":"<p>Ch\u00fang ta \u0111\u01b0\u1ee3c cho m\u1ed9t \u0111\u1ed3 th\u1ecb c\u00f3 h\u01b0\u1edbng, kh\u00f4ng tr\u1ecdng s\u1ed1 $G$ v\u1edbi $n$ \u0111\u1ec9nh v\u00e0 m\u1ed9t s\u1ed1 nguy\u00ean $k$. Nhi\u1ec7m v\u1ee5 l\u00e0 nh\u01b0 sau: \u0111\u1ed1i v\u1edbi m\u1ed7i c\u1eb7p \u0111\u1ec9nh $(i, j)$, ch\u00fang ta ph\u1ea3i t\u00ecm s\u1ed1 l\u01b0\u1ee3ng \u0111\u01b0\u1eddng \u0111i c\u00f3 \u0111\u1ed9 d\u00e0i $k$ gi\u1eefa c\u00e1c \u0111\u1ec9nh n\u00e0y. C\u00e1c \u0111\u01b0\u1eddng \u0111i kh\u00f4ng nh\u1ea5t thi\u1ebft ph\u1ea3i \u0111\u01a1n, t\u1ee9c l\u00e0 c\u00e1c \u0111\u1ec9nh v\u00e0 c\u00e1c c\u1ea1nh c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gh\u00e9 th\u0103m b\u1ea5t k\u1ef3 s\u1ed1 l\u1ea7n n\u00e0o trong m\u1ed9t \u0111\u01b0\u1eddng \u0111i duy nh\u1ea5t.</p> <p>Ch\u00fang ta gi\u1ea3 s\u1eed r\u1eb1ng \u0111\u1ed3 th\u1ecb \u0111\u01b0\u1ee3c ch\u1ec9 \u0111\u1ecbnh b\u1eb1ng ma tr\u1eadn k\u1ec1, t\u1ee9c l\u00e0 ma tr\u1eadn $G[][]$ c\u00f3 k\u00edch th\u01b0\u1edbc $n \\times n$, trong \u0111\u00f3 m\u1ed7i ph\u1ea7n t\u1eed $G[i][j]$ b\u1eb1ng $1$ n\u1ebfu \u0111\u1ec9nh $i$ \u0111\u01b0\u1ee3c k\u1ebft n\u1ed1i v\u1edbi $j$ b\u1eb1ng m\u1ed9t c\u1ea1nh, v\u00e0 $0$ n\u1ebfu ch\u00fang kh\u00f4ng \u0111\u01b0\u1ee3c k\u1ebft n\u1ed1i b\u1eb1ng m\u1ed9t c\u1ea1nh. Thu\u1eadt to\u00e1n sau \u0111\u00e2y c\u0169ng ho\u1ea1t \u0111\u1ed9ng trong tr\u01b0\u1eddng h\u1ee3p c\u00f3 nhi\u1ec1u c\u1ea1nh: n\u1ebfu m\u1ed9t c\u1eb7p \u0111\u1ec9nh $(i, j)$ \u0111\u01b0\u1ee3c k\u1ebft n\u1ed1i v\u1edbi $m$ c\u1ea1nh, th\u00ec ch\u00fang ta c\u00f3 th\u1ec3 ghi l\u1ea1i \u0111i\u1ec1u n\u00e0y trong ma tr\u1eadn k\u1ec1 b\u1eb1ng c\u00e1ch \u0111\u1eb7t $G[i][j] = m$. Thu\u1eadt to\u00e1n c\u0169ng ho\u1ea1t \u0111\u1ed9ng n\u1ebfu \u0111\u1ed3 th\u1ecb ch\u1ee9a c\u00e1c khuy\u00ean (khuy\u00ean l\u00e0 m\u1ed9t c\u1ea1nh k\u1ebft n\u1ed1i m\u1ed9t \u0111\u1ec9nh v\u1edbi ch\u00ednh n\u00f3).</p> <p>R\u00f5 r\u00e0ng l\u00e0 ma tr\u1eadn k\u1ec1 \u0111\u00e3 x\u00e2y d\u1ef1ng l\u00e0 c\u00e2u tr\u1ea3 l\u1eddi cho v\u1ea5n \u0111\u1ec1 trong tr\u01b0\u1eddng h\u1ee3p $k = 1$. N\u00f3 ch\u1ee9a s\u1ed1 l\u01b0\u1ee3ng \u0111\u01b0\u1eddng \u0111i c\u00f3 \u0111\u1ed9 d\u00e0i $1$ gi\u1eefa m\u1ed7i c\u1eb7p \u0111\u1ec9nh.</p> <p>Ch\u00fang ta s\u1ebd x\u00e2y d\u1ef1ng gi\u1ea3i ph\u00e1p l\u1eb7p \u0111i l\u1eb7p l\u1ea1i: Gi\u1ea3 s\u1eed ch\u00fang ta bi\u1ebft c\u00e2u tr\u1ea3 l\u1eddi cho m\u1ed9t s\u1ed1 $k$. \u1ede \u0111\u00e2y ch\u00fang t\u00f4i m\u00f4 t\u1ea3 m\u1ed9t ph\u01b0\u01a1ng ph\u00e1p l\u00e0m th\u1ebf n\u00e0o ch\u00fang ta c\u00f3 th\u1ec3 x\u00e2y d\u1ef1ng c\u00e2u tr\u1ea3 l\u1eddi cho $k + 1$. K\u00fd hi\u1ec7u $C_k$ l\u00e0 ma tr\u1eadn cho tr\u01b0\u1eddng h\u1ee3p $k$, v\u00e0 $C_{k+1}$ l\u00e0 ma tr\u1eadn ch\u00fang ta mu\u1ed1n x\u00e2y d\u1ef1ng. V\u1edbi c\u00f4ng th\u1ee9c sau, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh to\u00e1n m\u1ecdi m\u1ee5c c\u1ee7a $C_{k+1}$:</p> $$C_{k+1}[i][j] = \\sum_{p = 1}^{n} C_k[i][p] \\cdot G[p][j]$$ <p>D\u1ec5 d\u00e0ng nh\u1eadn th\u1ea5y r\u1eb1ng c\u00f4ng th\u1ee9c n\u00e0y kh\u00f4ng t\u00ednh to\u00e1n g\u00ec kh\u00e1c ngo\u00e0i t\u00edch c\u1ee7a c\u00e1c ma tr\u1eadn $C_k$ v\u00e0 $G$:</p> $$C_{k+1} = C_k \\cdot G$$ <p>Do \u0111\u00f3, gi\u1ea3i ph\u00e1p c\u1ee7a b\u00e0i to\u00e1n c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n nh\u01b0 sau:</p> $$C_k = \\underbrace{G \\cdot G \\cdots G}_{k \\text{ l\u1ea7n}} = G^k$$ <p>C\u1ea7n l\u01b0u \u00fd r\u1eb1ng c\u00e1c t\u00edch ma tr\u1eadn c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c n\u00e2ng l\u00ean l\u0169y th\u1eeba l\u1edbn m\u1ed9t c\u00e1ch hi\u1ec7u qu\u1ea3 b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng L\u0169y th\u1eeba nh\u1ecb ph\u00e2n. \u0110i\u1ec1u n\u00e0y mang l\u1ea1i m\u1ed9t gi\u1ea3i ph\u00e1p v\u1edbi \u0111\u1ed9 ph\u1ee9c t\u1ea1p $O(n^3 \\log k)$.</p>","tags":["Translated"]},{"location":"graph/fixed_length_paths.html#shortest-paths-of-a-fixed-length","title":"\u0110\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t c\u00f3 \u0111\u1ed9 d\u00e0i c\u1ed1 \u0111\u1ecbnh (Shortest paths of a fixed length)","text":"<p>Ch\u00fang ta \u0111\u01b0\u1ee3c cho m\u1ed9t \u0111\u1ed3 th\u1ecb c\u00f3 tr\u1ecdng s\u1ed1 c\u00f3 h\u01b0\u1edbng $G$ v\u1edbi $n$ \u0111\u1ec9nh v\u00e0 m\u1ed9t s\u1ed1 nguy\u00ean $k$. \u0110\u1ed1i v\u1edbi m\u1ed7i c\u1eb7p \u0111\u1ec9nh $(i, j)$, ch\u00fang ta ph\u1ea3i t\u00ecm \u0111\u1ed9 d\u00e0i c\u1ee7a \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t gi\u1eefa $i$ v\u00e0 $j$ bao g\u1ed3m ch\u00ednh x\u00e1c $k$ c\u1ea1nh.</p> <p>Ch\u00fang ta gi\u1ea3 s\u1eed r\u1eb1ng \u0111\u1ed3 th\u1ecb \u0111\u01b0\u1ee3c ch\u1ec9 \u0111\u1ecbnh b\u1edfi m\u1ed9t ma tr\u1eadn k\u1ec1, t\u1ee9c l\u00e0 th\u00f4ng qua ma tr\u1eadn $G[][]$ c\u00f3 k\u00edch th\u01b0\u1edbc $n \\times n$ trong \u0111\u00f3 m\u1ed7i ph\u1ea7n t\u1eed $G[i][j]$ ch\u1ee9a \u0111\u1ed9 d\u00e0i c\u1ee7a c\u00e1c c\u1ea1nh t\u1eeb \u0111\u1ec9nh $i$ \u0111\u1ebfn \u0111\u1ec9nh $j$. N\u1ebfu kh\u00f4ng c\u00f3 c\u1ea1nh n\u00e0o gi\u1eefa hai \u0111\u1ec9nh, th\u00ec ph\u1ea7n t\u1eed t\u01b0\u01a1ng \u1ee9ng c\u1ee7a ma tr\u1eadn s\u1ebd \u0111\u01b0\u1ee3c g\u00e1n cho v\u00f4 c\u00f9ng $\\infty$.</p> <p>R\u00f5 r\u00e0ng l\u00e0 \u1edf d\u1ea1ng n\u00e0y, ma tr\u1eadn k\u1ec1 l\u00e0 c\u00e2u tr\u1ea3 l\u1eddi cho b\u00e0i to\u00e1n v\u1edbi $k = 1$. N\u00f3 ch\u1ee9a \u0111\u1ed9 d\u00e0i c\u1ee7a c\u00e1c \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t gi\u1eefa m\u1ed7i c\u1eb7p \u0111\u1ec9nh, ho\u1eb7c $\\infty$ n\u1ebfu m\u1ed9t \u0111\u01b0\u1eddng \u0111i bao g\u1ed3m m\u1ed9t c\u1ea1nh kh\u00f4ng t\u1ed3n t\u1ea1i.</p> <p>M\u1ed9t l\u1ea7n n\u1eefa ch\u00fang ta c\u00f3 th\u1ec3 x\u00e2y d\u1ef1ng gi\u1ea3i ph\u00e1p cho b\u00e0i to\u00e1n l\u1eb7p \u0111i l\u1eb7p l\u1ea1i: Gi\u1ea3 s\u1eed ch\u00fang ta bi\u1ebft c\u00e2u tr\u1ea3 l\u1eddi cho m\u1ed9t s\u1ed1 $k$. Ch\u00fang t\u00f4i ch\u1ec9 ra c\u00e1ch ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh to\u00e1n c\u00e2u tr\u1ea3 l\u1eddi cho $k+1$. H\u00e3y k\u00fd hi\u1ec7u $L_k$ l\u00e0 ma tr\u1eadn cho $k$ v\u00e0 $L_{k+1}$ l\u00e0 ma tr\u1eadn ch\u00fang ta mu\u1ed1n x\u00e2y d\u1ef1ng. Khi \u0111\u00f3 c\u00f4ng th\u1ee9c sau t\u00ednh to\u00e1n m\u1ed7i m\u1ee5c ti\u00eau c\u1ee7a $L_{k+1}$:</p> $$L_{k+1}[i][j] = \\min_{p = 1 \\ldots n} \\left(L_k[i][p] + G[p][j]\\right)$$ <p>Khi nh\u00ecn k\u1ef9 h\u01a1n v\u00e0o c\u00f4ng th\u1ee9c n\u00e0y, ch\u00fang ta c\u00f3 th\u1ec3 r\u00fat ra m\u1ed9t s\u1ef1 t\u01b0\u01a1ng t\u1ef1 v\u1edbi ph\u00e9p nh\u00e2n ma tr\u1eadn: tr\u00ean th\u1ef1c t\u1ebf ma tr\u1eadn $L_k$ \u0111\u01b0\u1ee3c nh\u00e2n v\u1edbi ma tr\u1eadn $G$, s\u1ef1 kh\u00e1c bi\u1ec7t duy nh\u1ea5t l\u00e0 thay v\u00ec trong ph\u00e9p nh\u00e2n, ch\u00fang ta l\u1ea5y gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t thay v\u00ec t\u1ed5ng, v\u00e0 t\u1ed5ng thay v\u00ec ph\u00e9p nh\u00e2n nh\u01b0 ho\u1ea1t \u0111\u1ed9ng b\u00ean trong.</p> $$L_{k+1} = L_k \\odot G,$$ <p>trong \u0111\u00f3 ph\u00e9p to\u00e1n $\\odot$ \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a nh\u01b0 sau:</p> $$A \\odot B = C~~\\Longleftrightarrow~~C_{i j} = \\min_{p = 1 \\ldots n}\\left(A_{i p} + B_{p j}\\right)$$ <p>Do \u0111\u00f3, gi\u1ea3i ph\u00e1p c\u1ee7a nhi\u1ec7m v\u1ee5 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng ph\u00e9p nh\u00e2n s\u1eeda \u0111\u1ed5i:</p> $$L_k = \\underbrace{G \\odot \\ldots \\odot G}_{k~\\text{l\u1ea7n}} = G^{\\odot k}$$ <p>C\u1ea7n l\u01b0u \u00fd r\u1eb1ng ch\u00fang ta c\u0169ng c\u00f3 th\u1ec3 t\u00ednh to\u00e1n l\u0169y th\u1eeba n\u00e0y m\u1ed9t c\u00e1ch hi\u1ec7u qu\u1ea3 v\u1edbi L\u0169y th\u1eeba nh\u1ecb ph\u00e2n, b\u1edfi v\u00ec ph\u00e9p nh\u00e2n s\u1eeda \u0111\u1ed5i r\u00f5 r\u00e0ng l\u00e0 c\u00f3 t\u00ednh k\u1ebft h\u1ee3p. V\u00ec v\u1eady, gi\u1ea3i ph\u00e1p n\u00e0y c\u0169ng c\u00f3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p $O(n^3 \\log k)$.</p>","tags":["Translated"]},{"location":"graph/fixed_length_paths.html#generalization-of-the-problems-for-paths-with-length-up-to-k","title":"T\u1ed5ng qu\u00e1t h\u00f3a c\u00e1c b\u00e0i to\u00e1n cho \u0111\u01b0\u1eddng \u0111i c\u00f3 \u0111\u1ed9 d\u00e0i t\u1ed1i \u0111a k (Generalization of the problems for paths with length up to k)","text":"<p>C\u00e1c gi\u1ea3i ph\u00e1p tr\u00ean gi\u1ea3i quy\u1ebft c\u00e1c b\u00e0i to\u00e1n cho m\u1ed9t $k$ c\u1ed1 \u0111\u1ecbnh. Tuy nhi\u00ean, c\u00e1c gi\u1ea3i ph\u00e1p c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c \u0111i\u1ec1u ch\u1ec9nh \u0111\u1ec3 gi\u1ea3i quy\u1ebft c\u00e1c b\u00e0i to\u00e1n m\u00e0 c\u00e1c \u0111\u01b0\u1eddng \u0111i \u0111\u01b0\u1ee3c ph\u00e9p ch\u1ee9a kh\u00f4ng qu\u00e1 $k$ c\u1ea1nh.</p> <p>\u0110i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n b\u1eb1ng c\u00e1ch s\u1eeda \u0111\u1ed5i nh\u1eb9 \u0111\u1ed3 th\u1ecb \u0111\u1ea7u v\u00e0o.</p> <p>Ch\u00fang ta nh\u00e2n \u0111\u00f4i m\u1ed7i \u0111\u1ec9nh: \u0111\u1ed1i v\u1edbi m\u1ed7i \u0111\u1ec9nh $v$ ch\u00fang ta t\u1ea1o th\u00eam m\u1ed9t \u0111\u1ec9nh $v'$ v\u00e0 th\u00eam c\u1ea1nh $(v, v')$ v\u00e0 khuy\u00ean $(v', v')$. S\u1ed1 l\u01b0\u1ee3ng \u0111\u01b0\u1eddng \u0111i gi\u1eefa $i$ v\u00e0 $j$ v\u1edbi t\u1ed1i \u0111a $k$ c\u1ea1nh l\u00e0 c\u00f9ng m\u1ed9t s\u1ed1 l\u01b0\u1ee3ng v\u1edbi s\u1ed1 l\u01b0\u1ee3ng \u0111\u01b0\u1eddng \u0111i gi\u1eefa $i$ v\u00e0 $j'$ v\u1edbi ch\u00ednh x\u00e1c $k + 1$ c\u1ea1nh, v\u00ec c\u00f3 m\u1ed9t song \u00e1nh \u00e1nh x\u1ea1 m\u1ed7i \u0111\u01b0\u1eddng \u0111i $[p_0 = i,~p_1,~\\ldots,~p_{m-1},~p_m = j]$ c\u00f3 \u0111\u1ed9 d\u00e0i $m \\le k$ \u0111\u1ebfn \u0111\u01b0\u1eddng \u0111i $[p_0 = i,~p_1,~\\ldots,~p_{m-1},~p_m = j, j', \\ldots, j']$ c\u00f3 \u0111\u1ed9 d\u00e0i $k + 1$.</p> <p>Th\u1ee7 thu\u1eadt t\u01b0\u01a1ng t\u1ef1 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c \u00e1p d\u1ee5ng \u0111\u1ec3 t\u00ednh to\u00e1n c\u00e1c \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t v\u1edbi t\u1ed1i \u0111a $k$ c\u1ea1nh. Ch\u00fang ta l\u1ea1i nh\u00e2n \u0111\u00f4i m\u1ed7i \u0111\u1ec9nh v\u00e0 th\u00eam hai c\u1ea1nh \u0111\u00e3 \u0111\u1ec1 c\u1eadp v\u1edbi tr\u1ecdng s\u1ed1 $0$.</p>","tags":["Translated"]},{"location":"graph/flow_with_demands.html","title":"Lu\u1ed3ng v\u1edbi c\u00e1c nhu c\u1ea7u (Flows with demands)","text":"<p>Trong m\u1ed9t m\u1ea1ng lu\u1ed3ng b\u00ecnh th\u01b0\u1eddng, lu\u1ed3ng c\u1ee7a m\u1ed9t c\u1ea1nh ch\u1ec9 b\u1ecb gi\u1edbi h\u1ea1n b\u1edfi dung l\u01b0\u1ee3ng $c(e)$ t\u1eeb ph\u00eda tr\u00ean v\u00e0 b\u1edfi 0 t\u1eeb ph\u00eda d\u01b0\u1edbi. Trong b\u00e0i vi\u1ebft n\u00e0y, ch\u00fang ta s\u1ebd th\u1ea3o lu\u1eadn v\u1ec1 c\u00e1c m\u1ea1ng lu\u1ed3ng, trong \u0111\u00f3 ch\u00fang ta y\u00eau c\u1ea7u th\u00eam lu\u1ed3ng c\u1ee7a m\u1ed7i c\u1ea1nh ph\u1ea3i c\u00f3 m\u1ed9t l\u01b0\u1ee3ng nh\u1ea5t \u0111\u1ecbnh, t\u1ee9c l\u00e0 ch\u00fang ta ch\u1eb7n lu\u1ed3ng t\u1eeb ph\u00eda d\u01b0\u1edbi b\u1edfi m\u1ed9t h\u00e0m nhu c\u1ea7u (demand) $d(e)$:</p> $$ d(e) \\le f(e) \\le c(e)$$ <p>V\u00ec v\u1eady, ti\u1ebfp theo m\u1ed7i c\u1ea1nh c\u00f3 m\u1ed9t gi\u00e1 tr\u1ecb lu\u1ed3ng t\u1ed1i thi\u1ec3u, m\u00e0 ch\u00fang ta ph\u1ea3i chuy\u1ec3n d\u1ecdc theo c\u1ea1nh.</p> <p>\u0110\u00e2y l\u00e0 m\u1ed9t s\u1ef1 t\u1ed5ng qu\u00e1t h\u00f3a c\u1ee7a b\u00e0i to\u00e1n lu\u1ed3ng b\u00ecnh th\u01b0\u1eddng, v\u00ec vi\u1ec7c \u0111\u1eb7t $d(e) = 0$ cho t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh $e$ mang l\u1ea1i m\u1ed9t m\u1ea1ng lu\u1ed3ng b\u00ecnh th\u01b0\u1eddng. L\u01b0u \u00fd r\u1eb1ng, trong m\u1ea1ng lu\u1ed3ng b\u00ecnh th\u01b0\u1eddng, vi\u1ec7c t\u00ecm m\u1ed9t lu\u1ed3ng h\u1ee3p l\u1ec7 l\u00e0 c\u1ef1c k\u1ef3 t\u1ea7m th\u01b0\u1eddng, ch\u1ec9 c\u1ea7n \u0111\u1eb7t $f(e) = 0$ \u0111\u00e3 l\u00e0 m\u1ed9t lu\u1ed3ng h\u1ee3p l\u1ec7. Tuy nhi\u00ean, n\u1ebfu lu\u1ed3ng c\u1ee7a m\u1ed7i c\u1ea1nh ph\u1ea3i th\u1ecfa m\u00e3n m\u1ed9t nhu c\u1ea7u, th\u00ec vi\u1ec7c t\u00ecm m\u1ed9t lu\u1ed3ng h\u1ee3p l\u1ec7 \u0111\u1ed9t nhi\u00ean \u0111\u00e3 l\u00e0 kh\u00e1 ph\u1ee9c t\u1ea1p.</p> <p>Ch\u00fang ta s\u1ebd xem x\u00e9t hai b\u00e0i to\u00e1n:</p> <ol> <li>t\u00ecm m\u1ed9t lu\u1ed3ng b\u1ea5t k\u1ef3 th\u1ecfa m\u00e3n t\u1ea5t c\u1ea3 c\u00e1c r\u00e0ng bu\u1ed9c</li> <li>t\u00ecm m\u1ed9t lu\u1ed3ng c\u1ef1c ti\u1ec3u th\u1ecfa m\u00e3n t\u1ea5t c\u1ea3 c\u00e1c r\u00e0ng bu\u1ed9c</li> </ol>","tags":["Translated"]},{"location":"graph/flow_with_demands.html#finding-an-arbitrary-flow","title":"T\u00ecm m\u1ed9t lu\u1ed3ng b\u1ea5t k\u1ef3 (Finding an arbitrary flow)","text":"<p>Ch\u00fang ta th\u1ef1c hi\u1ec7n c\u00e1c thay \u0111\u1ed5i sau trong m\u1ea1ng. Ch\u00fang ta th\u00eam m\u1ed9t ngu\u1ed3n m\u1edbi $s'$ v\u00e0 m\u1ed9t \u0111\u00edch m\u1edbi $t'$, m\u1ed9t c\u1ea1nh m\u1edbi t\u1eeb ngu\u1ed3n $s'$ \u0111\u1ebfn m\u1ecdi \u0111\u1ec9nh kh\u00e1c, m\u1ed9t c\u1ea1nh m\u1edbi cho m\u1ecdi \u0111\u1ec9nh \u0111\u1ebfn \u0111\u00edch $t'$, v\u00e0 m\u1ed9t c\u1ea1nh t\u1eeb $t$ \u0111\u1ebfn $s$. Ngo\u00e0i ra ch\u00fang ta \u0111\u1ecbnh ngh\u0129a h\u00e0m dung l\u01b0\u1ee3ng m\u1edbi $c'$ nh\u01b0 sau:</p> <ul> <li>$c'((s', v)) = \\sum_{u \\in V} d((u, v))$ cho m\u1ed7i c\u1ea1nh $(s', v)$.</li> <li>$c'((v, t')) = \\sum_{w \\in V} d((v, w))$ cho m\u1ed7i c\u1ea1nh $(v, t')$.</li> <li>$c'((u, v)) = c((u, v)) - d((u, v))$ cho m\u1ed7i c\u1ea1nh $(u, v)$ trong m\u1ea1ng c\u0169.</li> <li>$c'((t, s)) = \\infty$</li> </ul> <p>N\u1ebfu m\u1ea1ng m\u1edbi c\u00f3 m\u1ed9t lu\u1ed3ng b\u00e3o h\u00f2a (m\u1ed9t lu\u1ed3ng trong \u0111\u00f3 m\u1ed7i c\u1ea1nh \u0111i ra t\u1eeb $s'$ \u0111\u01b0\u1ee3c l\u1ea5p \u0111\u1ea7y ho\u00e0n to\u00e0n, t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi m\u1ecdi c\u1ea1nh \u0111i v\u00e0o $t'$ \u0111\u01b0\u1ee3c l\u1ea5p \u0111\u1ea7y ho\u00e0n to\u00e0n), th\u00ec m\u1ea1ng v\u1edbi nhu c\u1ea7u c\u00f3 m\u1ed9t lu\u1ed3ng h\u1ee3p l\u1ec7, v\u00e0 lu\u1ed3ng th\u1ef1c t\u1ebf c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng \u0111\u01b0\u1ee3c x\u00e2y d\u1ef1ng l\u1ea1i t\u1eeb m\u1ea1ng m\u1edbi. N\u1ebfu kh\u00f4ng th\u00ec kh\u00f4ng t\u1ed3n t\u1ea1i m\u1ed9t lu\u1ed3ng th\u1ecfa m\u00e3n t\u1ea5t c\u1ea3 c\u00e1c \u0111i\u1ec1u ki\u1ec7n. V\u00ec m\u1ed9t lu\u1ed3ng b\u00e3o h\u00f2a ph\u1ea3i l\u00e0 m\u1ed9t lu\u1ed3ng c\u1ef1c \u0111\u1ea1i, n\u00f3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y b\u1edfi b\u1ea5t k\u1ef3 thu\u1eadt to\u00e1n lu\u1ed3ng c\u1ef1c \u0111\u1ea1i n\u00e0o, nh\u01b0 thu\u1eadt to\u00e1n Edmonds-Karp ho\u1eb7c thu\u1eadt to\u00e1n Push-relabel.</p> <p>T\u00ednh \u0111\u00fang \u0111\u1eafn c\u1ee7a nh\u1eefng bi\u1ebfn \u0111\u1ed5i n\u00e0y kh\u00f3 hi\u1ec3u h\u01a1n. Ch\u00fang ta c\u00f3 th\u1ec3 ngh\u0129 v\u1ec1 n\u00f3 theo c\u00e1ch sau: M\u1ed7i c\u1ea1nh $e = (u, v)$ v\u1edbi $d(e) &gt; 0$ ban \u0111\u1ea7u \u0111\u01b0\u1ee3c thay th\u1ebf b\u1eb1ng hai c\u1ea1nh: m\u1ed9t c\u1ea1nh c\u00f3 dung l\u01b0\u1ee3ng $d(i)$ , v\u00e0 c\u1ea1nh kia c\u00f3 dung l\u01b0\u1ee3ng $c(i) - d(i)$. Ch\u00fang ta mu\u1ed1n t\u00ecm m\u1ed9t lu\u1ed3ng b\u00e3o h\u00f2a c\u1ea1nh \u0111\u1ea7u ti\u00ean (t\u1ee9c l\u00e0 lu\u1ed3ng d\u1ecdc theo c\u1ea1nh n\u00e0y ph\u1ea3i b\u1eb1ng dung l\u01b0\u1ee3ng c\u1ee7a n\u00f3). C\u1ea1nh th\u1ee9 hai \u00edt quan tr\u1ecdng h\u01a1n - lu\u1ed3ng d\u1ecdc theo n\u00f3 c\u00f3 th\u1ec3 l\u00e0 b\u1ea5t c\u1ee9 th\u1ee9 g\u00ec, gi\u1ea3 s\u1eed r\u1eb1ng n\u00f3 kh\u00f4ng v\u01b0\u1ee3t qu\u00e1 dung l\u01b0\u1ee3ng c\u1ee7a n\u00f3. Xem x\u00e9t m\u1ed7i c\u1ea1nh ph\u1ea3i \u0111\u01b0\u1ee3c b\u00e3o h\u00f2a, v\u00e0 ch\u00fang ta th\u1ef1c hi\u1ec7n thao t\u00e1c sau: ch\u00fang ta v\u1ebd c\u1ea1nh t\u1eeb ngu\u1ed3n m\u1edbi $s'$ \u0111\u1ebfn \u0111i\u1ec3m cu\u1ed1i $v$ c\u1ee7a n\u00f3, v\u1ebd c\u1ea1nh t\u1eeb \u0111i\u1ec3m b\u1eaft \u0111\u1ea7u $u$ c\u1ee7a n\u00f3 \u0111\u1ebfn \u0111\u00edch m\u1edbi $t'$, x\u00f3a c\u1ea1nh \u0111\u00f3, v\u00e0 t\u1eeb \u0111\u00edch c\u0169 $t$ \u0111\u1ebfn ngu\u1ed3n c\u0169 $s$ ch\u00fang ta v\u1ebd m\u1ed9t c\u1ea1nh c\u00f3 dung l\u01b0\u1ee3ng v\u00f4 h\u1ea1n. B\u1eb1ng nh\u1eefng h\u00e0nh \u0111\u1ed9ng n\u00e0y, ch\u00fang ta m\u00f4 ph\u1ecfng th\u1ef1c t\u1ebf r\u1eb1ng c\u1ea1nh n\u00e0y \u0111\u01b0\u1ee3c b\u00e3o h\u00f2a - t\u1eeb $v$ s\u1ebd c\u00f3 th\u00eam lu\u1ed3ng $d(e)$ \u0111i ra (ch\u00fang ta m\u00f4 ph\u1ecfng n\u00f3 b\u1eb1ng m\u1ed9t ngu\u1ed3n m\u1edbi cung c\u1ea5p l\u01b0\u1ee3ng lu\u1ed3ng ph\u00f9 h\u1ee3p cho $v$), v\u00e0 $u$ c\u0169ng s\u1ebd \u0111\u1ea9y th\u00eam lu\u1ed3ng $d(e)$ (nh\u01b0ng thay v\u00ec d\u1ecdc theo c\u1ea1nh c\u0169, lu\u1ed3ng n\u00e0y s\u1ebd \u0111i tr\u1ef1c ti\u1ebfp \u0111\u1ebfn \u0111\u00edch m\u1edbi $t'$). M\u1ed9t lu\u1ed3ng v\u1edbi gi\u00e1 tr\u1ecb $d(e)$, ban \u0111\u1ea7u ch\u1ea3y d\u1ecdc theo \u0111\u01b0\u1eddng \u0111i $s - \\dots - u - v - \\dots t$ b\u00e2y gi\u1edd c\u00f3 th\u1ec3 \u0111i theo \u0111\u01b0\u1eddng \u0111i m\u1edbi $s' - v - \\dots - t - s - \\dots - u - t'$. \u0110i\u1ec1u duy nh\u1ea5t \u0111\u01b0\u1ee3c \u0111\u01a1n gi\u1ea3n h\u00f3a trong \u0111\u1ecbnh ngh\u0129a c\u1ee7a m\u1ea1ng m\u1edbi, l\u00e0 n\u1ebfu th\u1ee7 t\u1ee5c t\u1ea1o ra nhi\u1ec1u c\u1ea1nh gi\u1eefa c\u00f9ng m\u1ed9t c\u1eb7p \u0111\u1ec9nh, th\u00ec ch\u00fang \u0111\u01b0\u1ee3c k\u1ebft h\u1ee3p th\u00e0nh m\u1ed9t c\u1ea1nh duy nh\u1ea5t v\u1edbi dung l\u01b0\u1ee3ng t\u1ed5ng.</p>","tags":["Translated"]},{"location":"graph/flow_with_demands.html#minimal-flow","title":"Lu\u1ed3ng c\u1ef1c ti\u1ec3u (Minimal flow)","text":"<p>L\u01b0u \u00fd r\u1eb1ng d\u1ecdc theo c\u1ea1nh $(t, s)$ (t\u1eeb \u0111\u00edch c\u0169 \u0111\u1ebfn ngu\u1ed3n c\u0169) v\u1edbi dung l\u01b0\u1ee3ng $\\infty$ ch\u1ea3y to\u00e0n b\u1ed9 lu\u1ed3ng c\u1ee7a m\u1ea1ng c\u0169 t\u01b0\u01a1ng \u1ee9ng. T\u1ee9c l\u00e0 dung l\u01b0\u1ee3ng c\u1ee7a c\u1ea1nh n\u00e0y \u1ea3nh h\u01b0\u1edfng \u0111\u1ebfn gi\u00e1 tr\u1ecb lu\u1ed3ng c\u1ee7a m\u1ea1ng c\u0169. B\u1eb1ng c\u00e1ch cho c\u1ea1nh n\u00e0y m\u1ed9t dung l\u01b0\u1ee3ng \u0111\u1ee7 l\u1edbn (t\u1ee9c l\u00e0 $\\infty$), lu\u1ed3ng c\u1ee7a m\u1ea1ng c\u0169 l\u00e0 kh\u00f4ng gi\u1edbi h\u1ea1n. B\u1eb1ng c\u00e1ch gi\u1edbi h\u1ea1n c\u1ea1nh n\u00e0y b\u1edfi c\u00e1c dung l\u01b0\u1ee3ng nh\u1ecf h\u01a1n, gi\u00e1 tr\u1ecb lu\u1ed3ng s\u1ebd gi\u1ea3m. Tuy nhi\u00ean, n\u1ebfu ch\u00fang ta gi\u1edbi h\u1ea1n c\u1ea1nh n\u00e0y b\u1edfi m\u1ed9t gi\u00e1 tr\u1ecb qu\u00e1 nh\u1ecf, th\u00ec m\u1ea1ng s\u1ebd kh\u00f4ng c\u00f3 gi\u1ea3i ph\u00e1p b\u00e3o h\u00f2a, v\u00ed d\u1ee5: gi\u1ea3i ph\u00e1p t\u01b0\u01a1ng \u1ee9ng cho m\u1ea1ng ban \u0111\u1ea7u s\u1ebd kh\u00f4ng th\u1ecfa m\u00e3n nhu c\u1ea7u c\u1ee7a c\u00e1c c\u1ea1nh. R\u00f5 r\u00e0ng \u1edf \u0111\u00e2y c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n \u0111\u1ec3 t\u00ecm gi\u00e1 tr\u1ecb th\u1ea5p nh\u1ea5t m\u00e0 t\u1ea5t c\u1ea3 c\u00e1c r\u00e0ng bu\u1ed9c v\u1eabn \u0111\u01b0\u1ee3c th\u1ecfa m\u00e3n. \u0110i\u1ec1u n\u00e0y mang l\u1ea1i lu\u1ed3ng c\u1ef1c ti\u1ec3u c\u1ee7a m\u1ea1ng ban \u0111\u1ea7u.</p>","tags":["Translated"]},{"location":"graph/hld.html","title":"Ph\u00e2n r\u00e3 Heavy-light (Heavy-light decomposition)","text":"<p>Ph\u00e2n r\u00e3 Heavy-light l\u00e0 m\u1ed9t k\u1ef9 thu\u1eadt kh\u00e1 t\u1ed5ng qu\u00e1t cho ph\u00e9p ch\u00fang ta gi\u1ea3i quy\u1ebft hi\u1ec7u qu\u1ea3 nhi\u1ec1u b\u00e0i to\u00e1n li\u00ean quan \u0111\u1ebfn truy v\u1ea5n tr\u00ean c\u00e2y.</p>","tags":["Translated"]},{"location":"graph/hld.html#description","title":"M\u00f4 t\u1ea3 (Description)","text":"<p>Gi\u1ea3 s\u1eed c\u00f3 m\u1ed9t c\u00e2y $G$ g\u1ed3m $n$ \u0111\u1ec9nh, v\u1edbi m\u1ed9t g\u1ed1c t\u00f9y \u00fd.</p> <p>B\u1ea3n ch\u1ea5t c\u1ee7a vi\u1ec7c ph\u00e2n r\u00e3 c\u00e2y n\u00e0y l\u00e0 chia c\u00e2y th\u00e0nh nhi\u1ec1u \u0111\u01b0\u1eddng \u0111i sao cho ch\u00fang ta c\u00f3 th\u1ec3 \u0111\u1ebfn \u0111\u1ec9nh g\u1ed1c t\u1eeb b\u1ea5t k\u1ef3 $v$ n\u00e0o b\u1eb1ng c\u00e1ch \u0111i qua t\u1ed1i \u0111a $\\log n$ \u0111\u01b0\u1eddng \u0111i. Ngo\u00e0i ra, kh\u00f4ng c\u00f3 \u0111\u01b0\u1eddng \u0111i n\u00e0o trong s\u1ed1 n\u00e0y giao nhau v\u1edbi \u0111\u01b0\u1eddng \u0111i kh\u00e1c.</p> <p>R\u00f5 r\u00e0ng l\u00e0 n\u1ebfu ch\u00fang ta t\u00ecm th\u1ea5y m\u1ed9t s\u1ef1 ph\u00e2n r\u00e3 nh\u01b0 v\u1eady cho b\u1ea5t k\u1ef3 c\u00e2y n\u00e0o, n\u00f3 s\u1ebd cho ph\u00e9p ch\u00fang ta gi\u1ea3m m\u1ed9t s\u1ed1 truy v\u1ea5n \u0111\u01a1n l\u1ebb c\u00f3 d\u1ea1ng \u201ct\u00ednh to\u00e1n th\u1ee9 g\u00ec \u0111\u00f3 tr\u00ean \u0111\u01b0\u1eddng \u0111i t\u1eeb $a$ \u0111\u1ebfn $b$\u201d th\u00e0nh m\u1ed9t s\u1ed1 truy v\u1ea5n thu\u1ed9c lo\u1ea1i \u201ct\u00ednh to\u00e1n th\u1ee9 g\u00ec \u0111\u00f3 tr\u00ean \u0111o\u1ea1n $[l, r]$ c\u1ee7a \u0111\u01b0\u1eddng \u0111i th\u1ee9 $k$\u201d.</p>","tags":["Translated"]},{"location":"graph/hld.html#construction-algorithm","title":"Thu\u1eadt to\u00e1n x\u00e2y d\u1ef1ng (Construction algorithm)","text":"<p>Ch\u00fang ta t\u00ednh to\u00e1n cho m\u1ed7i \u0111\u1ec9nh $v$ k\u00edch th\u01b0\u1edbc c\u1ee7a c\u00e2y con c\u1ee7a n\u00f3 $s(v)$, t\u1ee9c l\u00e0 s\u1ed1 l\u01b0\u1ee3ng \u0111\u1ec9nh trong c\u00e2y con c\u1ee7a \u0111\u1ec9nh $v$ bao g\u1ed3m c\u1ea3 ch\u00ednh n\u00f3.</p> <p>Ti\u1ebfp theo, xem x\u00e9t t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh d\u1eabn \u0111\u1ebfn c\u00e1c con c\u1ee7a m\u1ed9t \u0111\u1ec9nh $v$. Ch\u00fang ta g\u1ecdi m\u1ed9t c\u1ea1nh l\u00e0 n\u1eb7ng (heavy) n\u1ebfu n\u00f3 d\u1eabn \u0111\u1ebfn m\u1ed9t \u0111\u1ec9nh $c$ sao cho:</p> $$ s(c) \\ge \\frac{s(v)}{2} \\iff \\text{c\u1ea1nh }(v, c)\\text{ l\u00e0 n\u1eb7ng} $$ <p>T\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh kh\u00e1c \u0111\u01b0\u1ee3c nh\u00e3n l\u00e0 nh\u1eb9 (light).</p> <p>R\u00f5 r\u00e0ng l\u00e0 t\u1ed1i \u0111a m\u1ed9t c\u1ea1nh n\u1eb7ng c\u00f3 th\u1ec3 \u0111i ra t\u1eeb m\u1ed9t \u0111\u1ec9nh xu\u1ed1ng d\u01b0\u1edbi, b\u1edfi v\u00ec n\u1ebfu kh\u00f4ng th\u00ec \u0111\u1ec9nh $v$ s\u1ebd c\u00f3 \u00edt nh\u1ea5t hai con c\u00f3 k\u00edch th\u01b0\u1edbc $\\ge \\frac{s(v)}{2}$, v\u00e0 do \u0111\u00f3 k\u00edch th\u01b0\u1edbc c\u1ee7a c\u00e2y con c\u1ee7a $v$ s\u1ebd qu\u00e1 l\u1edbn, $s(v) \\ge 1 + 2 \\frac{s(v)}{2} &gt; s(v)$, \u0111i\u1ec1u n\u00e0y d\u1eabn \u0111\u1ebfn m\u00e2u thu\u1eabn.</p> <p>B\u00e2y gi\u1edd ch\u00fang ta s\u1ebd ph\u00e2n r\u00e3 c\u00e2y th\u00e0nh c\u00e1c \u0111\u01b0\u1eddng \u0111i kh\u00f4ng giao nhau. Xem x\u00e9t t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh m\u00e0 t\u1eeb \u0111\u00f3 kh\u00f4ng c\u00f3 c\u1ea1nh n\u1eb7ng n\u00e0o \u0111i xu\u1ed1ng. Ch\u00fang ta s\u1ebd \u0111i l\u00ean t\u1eeb m\u1ed7i \u0111\u1ec9nh nh\u01b0 v\u1eady cho \u0111\u1ebfn khi ch\u00fang ta \u0111\u1ebfn g\u1ed1c c\u1ee7a c\u00e2y ho\u1eb7c \u0111i qua m\u1ed9t c\u1ea1nh nh\u1eb9. K\u1ebft qu\u1ea3 l\u00e0, ch\u00fang ta s\u1ebd nh\u1eadn \u0111\u01b0\u1ee3c m\u1ed9t s\u1ed1 \u0111\u01b0\u1eddng \u0111i \u0111\u01b0\u1ee3c t\u1ea1o th\u00e0nh t\u1eeb kh\u00f4ng ho\u1eb7c nhi\u1ec1u c\u1ea1nh n\u1eb7ng c\u1ed9ng v\u1edbi m\u1ed9t c\u1ea1nh nh\u1eb9. \u0110\u01b0\u1eddng \u0111i c\u00f3 m\u1ed9t \u0111\u1ea7u \u1edf g\u1ed1c l\u00e0 m\u1ed9t ngo\u1ea1i l\u1ec7 \u0111\u1ed1i v\u1edbi \u0111i\u1ec1u n\u00e0y v\u00e0 s\u1ebd kh\u00f4ng c\u00f3 c\u1ea1nh nh\u1eb9. G\u1ecdi \u0111\u00e2y l\u00e0 \u0111\u01b0\u1eddng \u0111i n\u1eb7ng (heavy paths) - \u0111\u00e2y l\u00e0 nh\u1eefng \u0111\u01b0\u1eddng \u0111i mong mu\u1ed1n c\u1ee7a ph\u00e2n r\u00e3 heavy-light.</p>","tags":["Translated"]},{"location":"graph/hld.html#proof-of-correctness","title":"Ch\u1ee9ng minh t\u00ednh \u0111\u00fang \u0111\u1eafn (Proof of correctness)","text":"<p>\u0110\u1ea7u ti\u00ean, ch\u00fang ta l\u01b0u \u00fd r\u1eb1ng c\u00e1c \u0111\u01b0\u1eddng \u0111i n\u1eb7ng thu \u0111\u01b0\u1ee3c b\u1eb1ng thu\u1eadt to\u00e1n s\u1ebd kh\u00f4ng giao nhau. Tr\u00ean th\u1ef1c t\u1ebf, n\u1ebfu hai \u0111\u01b0\u1eddng \u0111i nh\u01b0 v\u1eady c\u00f3 chung m\u1ed9t c\u1ea1nh, \u0111i\u1ec1u \u0111\u00f3 c\u00f3 ngh\u0129a l\u00e0 c\u00f3 hai c\u1ea1nh n\u1eb7ng \u0111i ra kh\u1ecfi m\u1ed9t \u0111\u1ec9nh, \u0111i\u1ec1u n\u00e0y l\u00e0 kh\u00f4ng th\u1ec3.</p> <p>Th\u1ee9 hai, ch\u00fang ta s\u1ebd ch\u1ec9 ra r\u1eb1ng \u0111i xu\u1ed1ng t\u1eeb g\u1ed1c c\u1ee7a c\u00e2y \u0111\u1ebfn m\u1ed9t \u0111\u1ec9nh t\u00f9y \u00fd, ch\u00fang ta s\u1ebd thay \u0111\u1ed5i kh\u00f4ng qu\u00e1 $\\log n$ \u0111\u01b0\u1eddng \u0111i n\u1eb7ng tr\u00ean \u0111\u01b0\u1eddng \u0111i. Di chuy\u1ec3n xu\u1ed1ng m\u1ed9t c\u1ea1nh nh\u1eb9 l\u00e0m gi\u1ea3m k\u00edch th\u01b0\u1edbc c\u1ee7a c\u00e2y con hi\u1ec7n t\u1ea1i xu\u1ed1ng m\u1ed9t n\u1eeda ho\u1eb7c th\u1ea5p h\u01a1n:</p> $$ s(c) &lt; \\frac{s(v)}{2} \\iff \\text{c\u1ea1nh }(v, c)\\text{ l\u00e0 nh\u1eb9} $$ <p>Do \u0111\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 \u0111i qua t\u1ed1i \u0111a $\\log n$ c\u1ea1nh nh\u1eb9 tr\u01b0\u1edbc khi k\u00edch th\u01b0\u1edbc c\u00e2y con gi\u1ea3m xu\u1ed1ng c\u00f2n m\u1ed9t.</p> <p>V\u00ec ch\u00fang ta c\u00f3 th\u1ec3 di chuy\u1ec3n t\u1eeb m\u1ed9t \u0111\u01b0\u1eddng \u0111i n\u1eb7ng sang \u0111\u01b0\u1eddng \u0111i kh\u00e1c ch\u1ec9 th\u00f4ng qua m\u1ed9t c\u1ea1nh nh\u1eb9 (m\u1ed7i \u0111\u01b0\u1eddng \u0111i n\u1eb7ng, ngo\u1ea1i tr\u1eeb \u0111\u01b0\u1eddng \u0111i b\u1eaft \u0111\u1ea7u t\u1eeb g\u1ed1c, c\u00f3 m\u1ed9t c\u1ea1nh nh\u1eb9), ch\u00fang ta kh\u00f4ng th\u1ec3 thay \u0111\u1ed5i \u0111\u01b0\u1eddng \u0111i n\u1eb7ng qu\u00e1 $\\log n$ l\u1ea7n d\u1ecdc theo \u0111\u01b0\u1eddng \u0111i t\u1eeb g\u1ed1c \u0111\u1ebfn b\u1ea5t k\u1ef3 \u0111\u1ec9nh n\u00e0o, nh\u01b0 y\u00eau c\u1ea7u.</p> <p>H\u00ecnh \u1ea3nh sau \u0111\u00e2y minh h\u1ecda s\u1ef1 ph\u00e2n r\u00e3 c\u1ee7a m\u1ed9t c\u00e2y m\u1eabu. C\u00e1c c\u1ea1nh n\u1eb7ng d\u00e0y h\u01a1n c\u00e1c c\u1ea1nh nh\u1eb9. C\u00e1c \u0111\u01b0\u1eddng \u0111i n\u1eb7ng \u0111\u01b0\u1ee3c \u0111\u00e1nh d\u1ea5u b\u1eb1ng c\u00e1c ranh gi\u1edbi ch\u1ea5m ch\u1ea5m.</p>","tags":["Translated"]},{"location":"graph/hld.html#sample-problems","title":"B\u00e0i to\u00e1n v\u00ed d\u1ee5 (Sample problems)","text":"<p>Khi gi\u1ea3i quy\u1ebft c\u00e1c b\u00e0i to\u00e1n, \u0111\u00f4i khi thu\u1eadn ti\u1ec7n h\u01a1n khi coi ph\u00e2n r\u00e3 heavy-light l\u00e0 m\u1ed9t t\u1eadp h\u1ee3p c\u00e1c \u0111\u01b0\u1eddng \u0111i kh\u00f4ng giao nhau v\u1ec1 \u0111\u1ec9nh (thay v\u00ec c\u00e1c \u0111\u01b0\u1eddng \u0111i kh\u00f4ng giao nhau v\u1ec1 c\u1ea1nh). \u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y, \u0111\u1ee7 \u0111\u1ec3 lo\u1ea1i tr\u1eeb c\u1ea1nh cu\u1ed1i c\u00f9ng kh\u1ecfi m\u1ed7i \u0111\u01b0\u1eddng \u0111i n\u1eb7ng n\u1ebfu n\u00f3 l\u00e0 m\u1ed9t c\u1ea1nh nh\u1eb9, th\u00ec kh\u00f4ng c\u00f3 t\u00ednh ch\u1ea5t n\u00e0o b\u1ecb vi ph\u1ea1m, nh\u01b0ng b\u00e2y gi\u1edd m\u1ed7i \u0111\u1ec9nh thu\u1ed9c v\u1ec1 ch\u00ednh x\u00e1c m\u1ed9t \u0111\u01b0\u1eddng \u0111i n\u1eb7ng.</p> <p>D\u01b0\u1edbi \u0111\u00e2y ch\u00fang t\u00f4i s\u1ebd xem x\u00e9t m\u1ed9t s\u1ed1 nhi\u1ec7m v\u1ee5 \u0111i\u1ec3n h\u00ecnh c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i quy\u1ebft v\u1edbi s\u1ef1 tr\u1ee3 gi\u00fap c\u1ee7a ph\u00e2n r\u00e3 heavy-light.</p> <p>Ri\u00eang bi\u1ec7t, \u0111\u00e1ng \u0111\u1ec3 ch\u00fa \u00fd \u0111\u1ebfn b\u00e0i to\u00e1n v\u1ec1 t\u1ed5ng c\u00e1c s\u1ed1 tr\u00ean \u0111\u01b0\u1eddng \u0111i, v\u00ec \u0111\u00e2y l\u00e0 m\u1ed9t v\u00ed d\u1ee5 v\u1ec1 m\u1ed9t v\u1ea5n \u0111\u1ec1 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i quy\u1ebft b\u1eb1ng c\u00e1c k\u1ef9 thu\u1eadt \u0111\u01a1n gi\u1ea3n h\u01a1n.</p>","tags":["Translated"]},{"location":"graph/hld.html#maximum-value-on-the-path-between-two-vertices","title":"Gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t tr\u00ean \u0111\u01b0\u1eddng \u0111i gi\u1eefa hai \u0111\u1ec9nh (Maximum value on the path between two vertices)","text":"<p>Cho m\u1ed9t c\u00e2y, m\u1ed7i \u0111\u1ec9nh \u0111\u01b0\u1ee3c g\u00e1n m\u1ed9t gi\u00e1 tr\u1ecb. C\u00f3 c\u00e1c truy v\u1ea5n c\u00f3 d\u1ea1ng $(a, b)$, trong \u0111\u00f3 $a$ v\u00e0 $b$ l\u00e0 hai \u0111\u1ec9nh trong c\u00e2y, v\u00e0 c\u1ea7n t\u00ecm gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t tr\u00ean \u0111\u01b0\u1eddng \u0111i gi\u1eefa c\u00e1c \u0111\u1ec9nh $a$ v\u00e0 $b$.</p> <p>Ch\u00fang ta x\u00e2y d\u1ef1ng tr\u01b0\u1edbc m\u1ed9t ph\u00e2n r\u00e3 heavy-light c\u1ee7a c\u00e2y. Tr\u00ean m\u1ed7i \u0111\u01b0\u1eddng \u0111i n\u1eb7ng, ch\u00fang ta s\u1ebd x\u00e2y d\u1ef1ng m\u1ed9t segment tree, cho ph\u00e9p ch\u00fang ta t\u00ecm ki\u1ebfm m\u1ed9t \u0111\u1ec9nh c\u00f3 gi\u00e1 tr\u1ecb \u0111\u01b0\u1ee3c g\u00e1n l\u1edbn nh\u1ea5t trong \u0111o\u1ea1n \u0111\u00e3 ch\u1ec9 \u0111\u1ecbnh c\u1ee7a \u0111\u01b0\u1eddng \u0111i n\u1eb7ng \u0111\u00e3 ch\u1ec9 \u0111\u1ecbnh trong $\\mathcal{O}(\\log n)$. M\u1eb7c d\u00f9 s\u1ed1 l\u01b0\u1ee3ng \u0111\u01b0\u1eddng \u0111i n\u1eb7ng trong ph\u00e2n r\u00e3 heavy-light c\u00f3 th\u1ec3 \u0111\u1ea1t t\u1edbi $n - 1$, t\u1ed5ng k\u00edch th\u01b0\u1edbc c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c \u0111\u01b0\u1eddng \u0111i b\u1ecb gi\u1edbi h\u1ea1n b\u1edfi $\\mathcal{O}(n)$, do \u0111\u00f3 t\u1ed5ng k\u00edch th\u01b0\u1edbc c\u1ee7a c\u00e1c segment tree c\u0169ng s\u1ebd l\u00e0 tuy\u1ebfn t\u00ednh.</p> <p>\u0110\u1ec3 tr\u1ea3 l\u1eddi m\u1ed9t truy v\u1ea5n $(a, b)$, ch\u00fang ta t\u00ecm t\u1ed5 ti\u00ean chung th\u1ea5p nh\u1ea5t (lowest common ancestor) c\u1ee7a $a$ v\u00e0 $b$ l\u00e0 $l$, b\u1eb1ng b\u1ea5t k\u1ef3 ph\u01b0\u01a1ng ph\u00e1p \u01b0a th\u00edch n\u00e0o. B\u00e2y gi\u1edd nhi\u1ec7m v\u1ee5 \u0111\u00e3 \u0111\u01b0\u1ee3c gi\u1ea3m xu\u1ed1ng c\u00f2n hai truy v\u1ea5n $(a, l)$ v\u00e0 $(b, l)$, \u0111\u1ed1i v\u1edbi m\u1ed7i truy v\u1ea5n ch\u00fang ta c\u00f3 th\u1ec3 l\u00e0m nh\u01b0 sau: t\u00ecm \u0111\u01b0\u1eddng \u0111i n\u1eb7ng m\u00e0 \u0111\u1ec9nh th\u1ea5p h\u01a1n n\u1eb1m trong \u0111\u00f3, th\u1ef1c hi\u1ec7n m\u1ed9t truy v\u1ea5n tr\u00ean \u0111\u01b0\u1eddng \u0111i n\u00e0y, di chuy\u1ec3n l\u00ean \u0111\u1ea7u \u0111\u01b0\u1eddng \u0111i n\u00e0y, m\u1ed9t l\u1ea7n n\u1eefa x\u00e1c \u0111\u1ecbnh xem ch\u00fang ta \u0111ang \u1edf tr\u00ean \u0111\u01b0\u1eddng \u0111i n\u1eb7ng n\u00e0o v\u00e0 th\u1ef1c hi\u1ec7n m\u1ed9t truy v\u1ea5n tr\u00ean \u0111\u00f3, v\u00e0 c\u1ee9 th\u1ebf ti\u1ebfp t\u1ee5c, cho \u0111\u1ebfn khi ch\u00fang ta \u0111\u1ebfn \u0111\u01b0\u1eddng \u0111i ch\u1ee9a $l$.</p> <p>C\u1ea7n c\u1ea9n th\u1eadn v\u1edbi tr\u01b0\u1eddng h\u1ee3p khi, v\u00ed d\u1ee5, $a$ v\u00e0 $l$ n\u1eb1m tr\u00ean c\u00f9ng m\u1ed9t \u0111\u01b0\u1eddng \u0111i n\u1eb7ng - th\u00ec truy v\u1ea5n t\u1ed1i \u0111a tr\u00ean \u0111\u01b0\u1eddng \u0111i n\u00e0y kh\u00f4ng n\u00ean \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n tr\u00ean b\u1ea5t k\u1ef3 ti\u1ec1n t\u1ed1 n\u00e0o, m\u00e0 tr\u00ean ph\u1ea7n b\u00ean trong gi\u1eefa $a$ v\u00e0 $l$.</p> <p>Tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n con $(a, l)$ v\u00e0 $(b, l)$ m\u1ed7i truy v\u1ea5n y\u00eau c\u1ea7u \u0111i qua $\\mathcal{O}(\\log n)$ \u0111\u01b0\u1eddng \u0111i n\u1eb7ng v\u00e0 \u0111\u1ed1i v\u1edbi m\u1ed7i \u0111\u01b0\u1eddng \u0111i, m\u1ed9t truy v\u1ea5n t\u1ed1i \u0111a \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n tr\u00ean m\u1ed9t s\u1ed1 ph\u1ea7n c\u1ee7a \u0111\u01b0\u1eddng \u0111i, m\u1ed9t l\u1ea7n n\u1eefa y\u00eau c\u1ea7u $\\mathcal{O}(\\log n)$ thao t\u00e1c trong segment tree. Do \u0111\u00f3, m\u1ed9t truy v\u1ea5n $(a, b)$ m\u1ea5t th\u1eddi gian $\\mathcal{O}(\\log^2 n)$.</p> <p>N\u1ebfu b\u1ea1n t\u00ednh to\u00e1n v\u00e0 l\u01b0u tr\u1eef th\u00eam c\u00e1c gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c ti\u1ec1n t\u1ed1 cho m\u1ed7i \u0111\u01b0\u1eddng \u0111i n\u1eb7ng, th\u00ec b\u1ea1n s\u1ebd nh\u1eadn \u0111\u01b0\u1ee3c m\u1ed9t gi\u1ea3i ph\u00e1p $\\mathcal{O}(\\log n)$ v\u00ec t\u1ea5t c\u1ea3 c\u00e1c truy v\u1ea5n t\u1ed1i \u0111a \u0111\u1ec1u n\u1eb1m tr\u00ean c\u00e1c ti\u1ec1n t\u1ed1, ngo\u1ea1i tr\u1eeb t\u1ed1i \u0111a m\u1ed9t l\u1ea7n khi ch\u00fang ta \u0111\u1ebfn t\u1ed5 ti\u00ean $l$.</p>","tags":["Translated"]},{"location":"graph/hld.html#sum-of-the-numbers-on-the-path-between-two-vertices","title":"T\u1ed5ng c\u00e1c s\u1ed1 tr\u00ean \u0111\u01b0\u1eddng \u0111i gi\u1eefa hai \u0111\u1ec9nh (Sum of the numbers on the path between two vertices)","text":"<p>Cho m\u1ed9t c\u00e2y, m\u1ed7i \u0111\u1ec9nh \u0111\u01b0\u1ee3c g\u00e1n m\u1ed9t gi\u00e1 tr\u1ecb. C\u00f3 c\u00e1c truy v\u1ea5n c\u00f3 d\u1ea1ng $(a, b)$, trong \u0111\u00f3 $a$ v\u00e0 $b$ l\u00e0 hai \u0111\u1ec9nh trong c\u00e2y, v\u00e0 c\u1ea7n t\u00ecm t\u1ed5ng c\u00e1c gi\u00e1 tr\u1ecb tr\u00ean \u0111\u01b0\u1eddng \u0111i gi\u1eefa c\u00e1c \u0111\u1ec9nh $a$ v\u00e0 $b$. M\u1ed9t bi\u1ebfn th\u1ec3 c\u1ee7a nhi\u1ec7m v\u1ee5 n\u00e0y l\u00e0 c\u00f3 th\u1ec3 c\u00f3 th\u00eam c\u00e1c thao t\u00e1c c\u1eadp nh\u1eadt thay \u0111\u1ed5i s\u1ed1 \u0111\u01b0\u1ee3c g\u00e1n cho m\u1ed9t ho\u1eb7c nhi\u1ec1u \u0111\u1ec9nh.</p> <p>Nhi\u1ec7m v\u1ee5 n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i quy\u1ebft t\u01b0\u01a1ng t\u1ef1 nh\u01b0 b\u00e0i to\u00e1n tr\u01b0\u1edbc v\u1ec1 gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t v\u1edbi s\u1ef1 tr\u1ee3 gi\u00fap c\u1ee7a ph\u00e2n r\u00e3 heavy-light b\u1eb1ng c\u00e1ch x\u00e2y d\u1ef1ng c\u00e1c segment tree tr\u00ean c\u00e1c \u0111\u01b0\u1eddng \u0111i n\u1eb7ng. T\u1ed5ng ti\u1ec1n t\u1ed1 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng thay th\u1ebf n\u1ebfu kh\u00f4ng c\u00f3 c\u1eadp nh\u1eadt. Tuy nhi\u00ean, v\u1ea5n \u0111\u1ec1 n\u00e0y c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i quy\u1ebft b\u1eb1ng c\u00e1c k\u1ef9 thu\u1eadt \u0111\u01a1n gi\u1ea3n h\u01a1n.</p> <p>N\u1ebfu kh\u00f4ng c\u00f3 c\u1eadp nh\u1eadt, th\u00ec c\u00f3 th\u1ec3 t\u00ecm ra t\u1ed5ng tr\u00ean \u0111\u01b0\u1eddng \u0111i gi\u1eefa hai \u0111\u1ec9nh song song v\u1edbi t\u00ecm ki\u1ebfm LCA c\u1ee7a hai \u0111\u1ec9nh b\u1eb1ng n\u00e2ng nh\u1ecb ph\u00e2n \u2014 \u0111\u1ed1i v\u1edbi \u0111i\u1ec1u n\u00e0y, c\u00f9ng v\u1edbi t\u1ed5 ti\u00ean th\u1ee9 $2^k$ c\u1ee7a m\u1ed7i \u0111\u1ec9nh, c\u0169ng c\u1ea7n ph\u1ea3i l\u01b0u tr\u1eef t\u1ed5ng tr\u00ean c\u00e1c \u0111\u01b0\u1eddng \u0111i \u0111\u1ebfn c\u00e1c t\u1ed5 ti\u00ean \u0111\u00f3 trong qu\u00e1 tr\u00ecnh ti\u1ec1n x\u1eed l\u00fd.</p> <p>C\u00f3 m\u1ed9t c\u00e1ch ti\u1ebfp c\u1eadn ho\u00e0n to\u00e0n kh\u00e1c cho v\u1ea5n \u0111\u1ec1 n\u00e0y - xem x\u00e9t Euler tour c\u1ee7a c\u00e2y, v\u00e0 x\u00e2y d\u1ef1ng m\u1ed9t segment tree tr\u00ean \u0111\u00f3. Thu\u1eadt to\u00e1n n\u00e0y \u0111\u01b0\u1ee3c xem x\u00e9t trong m\u1ed9t b\u00e0i vi\u1ebft v\u1ec1 m\u1ed9t v\u1ea5n \u0111\u1ec1 t\u01b0\u01a1ng t\u1ef1. M\u1ed9t l\u1ea7n n\u1eefa, n\u1ebfu kh\u00f4ng c\u00f3 c\u1eadp nh\u1eadt, vi\u1ec7c l\u01b0u tr\u1eef t\u1ed5ng ti\u1ec1n t\u1ed1 l\u00e0 \u0111\u1ee7 v\u00e0 kh\u00f4ng c\u1ea7n segment tree.</p> <p>C\u1ea3 hai ph\u01b0\u01a1ng ph\u00e1p n\u00e0y \u0111\u1ec1u cung c\u1ea5p c\u00e1c gi\u1ea3i ph\u00e1p t\u01b0\u01a1ng \u0111\u1ed1i \u0111\u01a1n gi\u1ea3n l\u1ea5y $\\mathcal{O}(\\log n)$ cho m\u1ed9t truy v\u1ea5n.</p>","tags":["Translated"]},{"location":"graph/hld.html#repainting-the-edges-of-the-path-between-two-vertices","title":"T\u00f4 l\u1ea1i m\u00e0u c\u00e1c c\u1ea1nh c\u1ee7a \u0111\u01b0\u1eddng \u0111i gi\u1eefa hai \u0111\u1ec9nh (Repainting the edges of the path between two vertices)","text":"<p>Cho m\u1ed9t c\u00e2y, m\u1ed7i c\u1ea1nh ban \u0111\u1ea7u \u0111\u01b0\u1ee3c t\u00f4 m\u00e0u tr\u1eafng. C\u00f3 c\u00e1c c\u1eadp nh\u1eadt c\u00f3 d\u1ea1ng $(a, b, c)$, trong \u0111\u00f3 $a$ v\u00e0 $b$ l\u00e0 hai \u0111\u1ec9nh v\u00e0 $c$ l\u00e0 m\u1ed9t m\u00e0u, h\u01b0\u1edbng d\u1eabn r\u1eb1ng t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh tr\u00ean \u0111\u01b0\u1eddng \u0111i t\u1eeb $a$ \u0111\u1ebfn $b$ ph\u1ea3i \u0111\u01b0\u1ee3c t\u00f4 l\u1ea1i b\u1eb1ng m\u00e0u $c$. Sau t\u1ea5t c\u1ea3 c\u00e1c l\u1ea7n t\u00f4 l\u1ea1i, c\u1ea7n b\u00e1o c\u00e1o c\u00f3 bao nhi\u00eau c\u1ea1nh c\u1ee7a m\u1ed7i m\u00e0u \u0111\u00e3 thu \u0111\u01b0\u1ee3c.</p> <p>T\u01b0\u01a1ng t\u1ef1 nh\u01b0 c\u00e1c v\u1ea5n \u0111\u1ec1 tr\u00ean, gi\u1ea3i ph\u00e1p \u0111\u01a1n gi\u1ea3n l\u00e0 \u00e1p d\u1ee5ng ph\u00e2n r\u00e3 heavy-light v\u00e0 t\u1ea1o m\u1ed9t segment tree tr\u00ean m\u1ed7i \u0111\u01b0\u1eddng \u0111i n\u1eb7ng.</p> <p>M\u1ed7i l\u1ea7n t\u00f4 l\u1ea1i tr\u00ean \u0111\u01b0\u1eddng \u0111i $(a, b)$ s\u1ebd chuy\u1ec3n th\u00e0nh hai b\u1ea3n c\u1eadp nh\u1eadt $(a, l)$ v\u00e0 $(b, l)$, trong \u0111\u00f3 $l$ l\u00e0 t\u1ed5 ti\u00ean chung th\u1ea5p nh\u1ea5t c\u1ee7a c\u00e1c \u0111\u1ec9nh $a$ v\u00e0 $b$. $\\mathcal{O}(\\log n)$ cho m\u1ed7i \u0111\u01b0\u1eddng \u0111i cho $\\mathcal{O}(\\log n)$ \u0111\u01b0\u1eddng \u0111i d\u1eabn \u0111\u1ebfn \u0111\u1ed9 ph\u1ee9c t\u1ea1p l\u00e0 $\\mathcal{O}(\\log^2 n)$ cho m\u1ed7i c\u1eadp nh\u1eadt.</p>","tags":["Translated"]},{"location":"graph/hld.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>M\u1ed9t s\u1ed1 ph\u1ea7n c\u1ee7a c\u00e1ch ti\u1ebfp c\u1eadn \u0111\u01b0\u1ee3c th\u1ea3o lu\u1eadn \u1edf tr\u00ean c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eeda \u0111\u1ed5i \u0111\u1ec3 l\u00e0m cho vi\u1ec7c tri\u1ec3n khai d\u1ec5 d\u00e0ng h\u01a1n m\u00e0 kh\u00f4ng l\u00e0m m\u1ea5t hi\u1ec7u qu\u1ea3.</p> <ul> <li>\u0110\u1ecbnh ngh\u0129a v\u1ec1 c\u1ea1nh n\u1eb7ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c thay \u0111\u1ed5i th\u00e0nh c\u1ea1nh d\u1eabn \u0111\u1ebfn con c\u00f3 c\u00e2y con l\u1edbn nh\u1ea5t, v\u1edbi s\u1ef1 ph\u00e1 v\u1ee1 h\u00f2a t\u00f9y \u00fd. \u0110i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 d\u1eabn \u0111\u1ebfn vi\u1ec7c m\u1ed9t s\u1ed1 c\u1ea1nh nh\u1eb9 \u0111\u01b0\u1ee3c chuy\u1ec3n \u0111\u1ed5i th\u00e0nh n\u1eb7ng, \u0111i\u1ec1u \u0111\u00f3 c\u00f3 ngh\u0129a l\u00e0 m\u1ed9t s\u1ed1 \u0111\u01b0\u1eddng \u0111i n\u1eb7ng s\u1ebd k\u1ebft h\u1ee3p \u0111\u1ec3 t\u1ea1o th\u00e0nh m\u1ed9t \u0111\u01b0\u1eddng \u0111i duy nh\u1ea5t, nh\u01b0ng t\u1ea5t c\u1ea3 c\u00e1c \u0111\u01b0\u1eddng \u0111i n\u1eb7ng s\u1ebd v\u1eabn kh\u00f4ng giao nhau. V\u1eabn \u0111\u1ea3m b\u1ea3o r\u1eb1ng \u0111i xu\u1ed1ng m\u1ed9t c\u1ea1nh nh\u1eb9 l\u00e0m gi\u1ea3m k\u00edch th\u01b0\u1edbc c\u00e2y con xu\u1ed1ng m\u1ed9t n\u1eeda ho\u1eb7c \u00edt h\u01a1n.</li> <li>Thay v\u00ec x\u00e2y d\u1ef1ng segment tree tr\u00ean m\u1ecdi \u0111\u01b0\u1eddng \u0111i n\u1eb7ng, m\u1ed9t segment tree duy nh\u1ea5t c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng v\u1edbi c\u00e1c \u0111o\u1ea1n kh\u00f4ng giao nhau \u0111\u01b0\u1ee3c ph\u00e2n b\u1ed5 cho m\u1ed7i \u0111\u01b0\u1eddng \u0111i n\u1eb7ng.</li> <li>\u0110\u00e3 \u0111\u1ec1 c\u1eadp r\u1eb1ng vi\u1ec7c tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n \u0111\u00f2i h\u1ecfi ph\u1ea3i t\u00ednh to\u00e1n LCA. Trong khi LCA c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n ri\u00eang bi\u1ec7t, c\u0169ng c\u00f3 th\u1ec3 t\u00edch h\u1ee3p t\u00ednh to\u00e1n LCA trong qu\u00e1 tr\u00ecnh tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n.</li> </ul> <p>\u0110\u1ec3 th\u1ef1c hi\u1ec7n ph\u00e2n r\u00e3 heavy-light:</p> <p><pre><code>vector&lt;int&gt; parent, depth, heavy, head, pos;\nint cur_pos;\n\nint dfs(int v, vector&lt;vector&lt;int&gt;&gt; const&amp; adj) {\n    int size = 1;\n    int max_c_size = 0;\n    for (int c : adj[v]) {\n        if (c != parent[v]) {\n            parent[c] = v, depth[c] = depth[v] + 1;\n            int c_size = dfs(c, adj);\n            size += c_size;\n            if (c_size &gt; max_c_size)\n                max_c_size = c_size, heavy[v] = c;\n        }\n    }\n    return size;\n}\n\nvoid decompose(int v, int h, vector&lt;vector&lt;int&gt;&gt; const&amp; adj) {\n    head[v] = h, pos[v] = cur_pos++;\n    if (heavy[v] != -1)\n        decompose(heavy[v], h, adj);\n    for (int c : adj[v]) {\n        if (c != parent[v] &amp;&amp; c != heavy[v])\n            decompose(c, c, adj);\n    }\n}\n\nvoid init(vector&lt;vector&lt;int&gt;&gt; const&amp; adj) {\n    int n = adj.size();\n    parent = vector&lt;int&gt;(n);\n    depth = vector&lt;int&gt;(n);\n    heavy = vector&lt;int&gt;(n, -1);\n    head = vector&lt;int&gt;(n);\n    pos = vector&lt;int&gt;(n);\n    cur_pos = 0;\n\n    dfs(0, adj);\n    decompose(0, 0, adj);\n}\n</code></pre> Danh s\u00e1ch k\u1ec1 c\u1ee7a c\u00e2y ph\u1ea3i \u0111\u01b0\u1ee3c chuy\u1ec3n \u0111\u1ebfn h\u00e0m <code>init</code>, v\u00e0 vi\u1ec7c ph\u00e2n r\u00e3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n gi\u1ea3 s\u1eed \u0111\u1ec9nh <code>0</code> l\u00e0 g\u1ed1c.</p> <p>H\u00e0m <code>dfs</code> \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 t\u00ednh to\u00e1n <code>heavy[v]</code>, con \u1edf \u0111\u1ea7u kia c\u1ee7a c\u1ea1nh n\u1eb7ng t\u1eeb <code>v</code>, cho m\u1ed7i \u0111\u1ec9nh <code>v</code>. Ngo\u00e0i ra <code>dfs</code> c\u0169ng l\u01b0u tr\u1eef cha v\u00e0 \u0111\u1ed9 s\u00e2u c\u1ee7a m\u1ed7i \u0111\u1ec9nh, s\u1ebd h\u1eefu \u00edch sau n\u00e0y trong c\u00e1c truy v\u1ea5n.</p> <p>H\u00e0m <code>decompose</code> g\u00e1n cho m\u1ed7i \u0111\u1ec9nh <code>v</code> c\u00e1c gi\u00e1 tr\u1ecb <code>head[v]</code> v\u00e0 <code>pos[v]</code>, t\u01b0\u01a1ng \u1ee9ng l\u00e0 \u0111\u1ea7u c\u1ee7a \u0111\u01b0\u1eddng \u0111i n\u1eb7ng m\u00e0 <code>v</code> thu\u1ed9c v\u1ec1 v\u00e0 v\u1ecb tr\u00ed c\u1ee7a <code>v</code> tr\u00ean segment tree duy nh\u1ea5t bao g\u1ed3m t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh.</p> <p>\u0110\u1ec3 tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n tr\u00ean c\u00e1c \u0111\u01b0\u1eddng \u0111i, v\u00ed d\u1ee5 truy v\u1ea5n t\u1ed1i \u0111a \u0111\u01b0\u1ee3c th\u1ea3o lu\u1eadn, ch\u00fang ta c\u00f3 th\u1ec3 l\u00e0m m\u1ed9t c\u00e1i g\u00ec \u0111\u00f3 nh\u01b0 th\u1ebf n\u00e0y:</p> <pre><code>int query(int a, int b) {\n    int res = 0;\n    for (; head[a] != head[b]; b = parent[head[b]]) {\n        if (depth[head[a]] &gt; depth[head[b]])\n            swap(a, b);\n        int cur_heavy_path_max = segment_tree_query(pos[head[b]], pos[b]);\n        res = max(res, cur_heavy_path_max);\n    }\n    if (depth[a] &gt; depth[b])\n        swap(a, b);\n    int last_heavy_path_max = segment_tree_query(pos[a], pos[b]);\n    res = max(res, last_heavy_path_max);\n    return res;\n}\n</code></pre>","tags":["Translated"]},{"location":"graph/hld.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice problems)","text":"<ul> <li>SPOJ - QTREE - Query on a tree</li> <li>CSES - Path Queries II</li> <li>Codeforces - Subway Lines</li> <li>Codeforces - Tree Queries</li> <li>Codeforces - Tree or not Tree</li> <li>Codeforces - The Tree</li> <li>Balkan OI 2018 - Min-max tree</li> </ul>","tags":["Translated"]},{"location":"graph/hungarian-algorithm.html","title":"Thu\u1eadt to\u00e1n Hungary gi\u1ea3i b\u00e0i to\u00e1n ph\u00e2n c\u00f4ng (Hungarian algorithm for solving the assignment problem)","text":"","tags":["Translated"]},{"location":"graph/hungarian-algorithm.html#statement-of-the-assignment-problem","title":"Ph\u00e1t bi\u1ec3u b\u00e0i to\u00e1n ph\u00e2n c\u00f4ng (Statement of the assignment problem)","text":"<p>C\u00f3 m\u1ed9t s\u1ed1 c\u00e1ch ph\u00e1t bi\u1ec3u ti\u00eau chu\u1ea9n cho b\u00e0i to\u00e1n ph\u00e2n c\u00f4ng (t\u1ea5t c\u1ea3 v\u1ec1 c\u01a1 b\u1ea3n \u0111\u1ec1u t\u01b0\u01a1ng \u0111\u01b0\u01a1ng). D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u1ed9t s\u1ed1 trong s\u1ed1 \u0111\u00f3:</p> <ul> <li> <p>C\u00f3 $n$ c\u00f4ng vi\u1ec7c v\u00e0 $n$ c\u00f4ng nh\u00e2n. M\u1ed7i c\u00f4ng nh\u00e2n ch\u1ec9 \u0111\u1ecbnh s\u1ed1 ti\u1ec1n h\u1ecd mong \u0111\u1ee3i cho m\u1ed9t c\u00f4ng vi\u1ec7c c\u1ee5 th\u1ec3. M\u1ed7i c\u00f4ng nh\u00e2n ch\u1ec9 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c giao m\u1ed9t c\u00f4ng vi\u1ec7c. M\u1ee5c ti\u00eau l\u00e0 ph\u00e2n c\u00f4ng c\u00f4ng vi\u1ec7c cho c\u00f4ng nh\u00e2n theo c\u00e1ch gi\u1ea3m thi\u1ec3u t\u1ed5ng chi ph\u00ed.</p> </li> <li> <p>Cho m\u1ed9t ma tr\u1eadn $A$ k\u00edch th\u01b0\u1edbc $n \\times n$, nhi\u1ec7m v\u1ee5 l\u00e0 ch\u1ecdn m\u1ed9t s\u1ed1 t\u1eeb m\u1ed7i h\u00e0ng sao cho m\u1ed7i c\u1ed9t c\u00f3 ch\u00ednh x\u00e1c m\u1ed9t s\u1ed1 \u0111\u01b0\u1ee3c ch\u1ecdn, v\u00e0 t\u1ed5ng c\u1ee7a c\u00e1c s\u1ed1 \u0111\u01b0\u1ee3c ch\u1ecdn l\u00e0 nh\u1ecf nh\u1ea5t.</p> </li> <li> <p>Cho m\u1ed9t ma tr\u1eadn $A$ k\u00edch th\u01b0\u1edbc $n \\times n$, nhi\u1ec7m v\u1ee5 l\u00e0 t\u00ecm m\u1ed9t ho\u00e1n v\u1ecb $p$ c\u00f3 \u0111\u1ed9 d\u00e0i $n$ sao cho gi\u00e1 tr\u1ecb $\\sum A[i]\\left[p[i]\\right]$ l\u00e0 nh\u1ecf nh\u1ea5t.</p> </li> <li> <p>Xem x\u00e9t m\u1ed9t \u0111\u1ed3 th\u1ecb hai ph\u00eda \u0111\u1ea7y \u0111\u1ee7 v\u1edbi $n$ \u0111\u1ec9nh m\u1ed7i ph\u1ea7n, trong \u0111\u00f3 m\u1ed7i c\u1ea1nh \u0111\u01b0\u1ee3c g\u00e1n m\u1ed9t tr\u1ecdng s\u1ed1. M\u1ee5c ti\u00eau l\u00e0 t\u00ecm m\u1ed9t c\u1eb7p gh\u00e9p ho\u00e0n h\u1ea3o c\u00f3 t\u1ed5ng tr\u1ecdng s\u1ed1 nh\u1ecf nh\u1ea5t.</p> </li> </ul> <p>\u0110i\u1ec1u quan tr\u1ecdng c\u1ea7n l\u01b0u \u00fd l\u00e0 t\u1ea5t c\u1ea3 c\u00e1c t\u00ecnh hu\u1ed1ng tr\u00ean \u0111\u1ec1u l\u00e0 c\u00e1c b\u00e0i to\u00e1n \"vu\u00f4ng\", ngh\u0129a l\u00e0 c\u1ea3 hai k\u00edch th\u01b0\u1edbc lu\u00f4n b\u1eb1ng $n$. Trong th\u1ef1c t\u1ebf, c\u00e1c c\u00f4ng th\u1ee9c \"ch\u1eef nh\u1eadt\" t\u01b0\u01a1ng t\u1ef1 th\u01b0\u1eddng g\u1eb7p, trong \u0111\u00f3 $n$ kh\u00f4ng b\u1eb1ng $m$, v\u00e0 nhi\u1ec7m v\u1ee5 l\u00e0 ch\u1ecdn $\\min(n,m)$ ph\u1ea7n t\u1eed. Tuy nhi\u00ean, c\u00f3 th\u1ec3 th\u1ea5y r\u1eb1ng m\u1ed9t b\u00e0i to\u00e1n \"ch\u1eef nh\u1eadt\" lu\u00f4n c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c chuy\u1ec3n \u0111\u1ed5i th\u00e0nh b\u00e0i to\u00e1n \"vu\u00f4ng\" b\u1eb1ng c\u00e1ch th\u00eam c\u00e1c h\u00e0ng ho\u1eb7c c\u1ed9t c\u00f3 gi\u00e1 tr\u1ecb 0 ho\u1eb7c v\u00f4 c\u00f9ng t\u01b0\u01a1ng \u1ee9ng.</p> <p>Ch\u00fang t\u00f4i c\u0169ng l\u01b0u \u00fd r\u1eb1ng b\u1eb1ng c\u00e1ch t\u01b0\u01a1ng t\u1ef1 v\u1edbi vi\u1ec7c t\u00ecm ki\u1ebfm gi\u1ea3i ph\u00e1p nh\u1ecf nh\u1ea5t, ng\u01b0\u1eddi ta c\u0169ng c\u00f3 th\u1ec3 \u0111\u1eb7t ra b\u00e0i to\u00e1n t\u00ecm gi\u1ea3i ph\u00e1p l\u1edbn nh\u1ea5t. Tuy nhi\u00ean, hai b\u00e0i to\u00e1n n\u00e0y t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi nhau: ch\u1ec9 c\u1ea7n nh\u00e2n t\u1ea5t c\u1ea3 c\u00e1c tr\u1ecdng s\u1ed1 v\u1edbi $-1$.</p>","tags":["Translated"]},{"location":"graph/hungarian-algorithm.html#hungarian-algorithm","title":"Thu\u1eadt to\u00e1n Hungary (Hungarian algorithm)","text":"","tags":["Translated"]},{"location":"graph/hungarian-algorithm.html#historical-reference","title":"Tham kh\u1ea3o l\u1ecbch s\u1eed (Historical reference)","text":"<p>Thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c ph\u00e1t tri\u1ec3n v\u00e0 xu\u1ea5t b\u1ea3n b\u1edfi Harold Kuhn v\u00e0o n\u0103m 1955. B\u1ea3n th\u00e2n Kuhn \u0111\u00e3 \u0111\u1eb7t t\u00ean cho n\u00f3 l\u00e0 \"Hungary\" v\u00ec n\u00f3 d\u1ef1a tr\u00ean c\u00f4ng tr\u00ecnh tr\u01b0\u1edbc \u0111\u00f3 c\u1ee7a c\u00e1c nh\u00e0 to\u00e1n h\u1ecdc ng\u01b0\u1eddi Hungary D\u00e9nes K\u0151nig v\u00e0 Jen\u0151 Egerv\u00e1ry. N\u0103m 1957, James Munkres \u0111\u00e3 ch\u1ec9 ra r\u1eb1ng thu\u1eadt to\u00e1n n\u00e0y ch\u1ea1y trong th\u1eddi gian \u0111a th\u1ee9c (nghi\u00eam ng\u1eb7t), \u0111\u1ed9c l\u1eadp v\u1edbi chi ph\u00ed. Do \u0111\u00f3, trong v\u0103n h\u1ecdc, thu\u1eadt to\u00e1n n\u00e0y \u0111\u01b0\u1ee3c bi\u1ebft \u0111\u1ebfn kh\u00f4ng ch\u1ec9 l\u00e0 \"Hungary\", m\u00e0 c\u00f2n l\u00e0 \"thu\u1eadt to\u00e1n Kuhn-Mankres\" ho\u1eb7c \"thu\u1eadt to\u00e1n Mankres\". Tuy nhi\u00ean, g\u1ea7n \u0111\u00e2y ng\u01b0\u1eddi ta ph\u00e1t hi\u1ec7n ra v\u00e0o n\u0103m 2006 r\u1eb1ng c\u00f9ng m\u1ed9t thu\u1eadt to\u00e1n n\u00e0y \u0111\u00e3 \u0111\u01b0\u1ee3c ph\u00e1t minh ra m\u1ed9t th\u1ebf k\u1ef7 tr\u01b0\u1edbc Kuhn b\u1edfi nh\u00e0 to\u00e1n h\u1ecdc ng\u01b0\u1eddi \u0110\u1ee9c Carl Gustav Jacobi. C\u00f4ng tr\u00ecnh c\u1ee7a \u00f4ng, V\u1ec1 nghi\u00ean c\u1ee9u th\u1ee9 t\u1ef1 c\u1ee7a m\u1ed9t h\u1ec7 ph\u01b0\u01a1ng tr\u00ecnh vi ph\u00e2n th\u01b0\u1eddng t\u00f9y \u00fd, \u0111\u01b0\u1ee3c xu\u1ea5t b\u1ea3n sau khi \u00f4ng qua \u0111\u1eddi v\u00e0o n\u0103m 1890, c\u00f3 ch\u1ee9a, trong s\u1ed1 c\u00e1c ph\u00e1t hi\u1ec7n kh\u00e1c, m\u1ed9t thu\u1eadt to\u00e1n \u0111a th\u1ee9c \u0111\u1ec3 gi\u1ea3i quy\u1ebft b\u00e0i to\u00e1n ph\u00e2n c\u00f4ng. Th\u1eadt kh\u00f4ng may, v\u00ec \u1ea5n ph\u1ea9m b\u1eb1ng ti\u1ebfng Latinh, n\u00ean n\u00f3 \u0111\u00e3 kh\u00f4ng \u0111\u01b0\u1ee3c c\u00e1c nh\u00e0 to\u00e1n h\u1ecdc ch\u00fa \u00fd.</p> <p>C\u0169ng c\u1ea7n l\u01b0u \u00fd r\u1eb1ng thu\u1eadt to\u00e1n ban \u0111\u1ea7u c\u1ee7a Kuhn c\u00f3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p ti\u1ec7m c\u1eadn l\u00e0 $\\mathcal{O}(n^4)$, v\u00e0 ch\u1ec9 sau \u0111\u00f3 Jack Edmonds v\u00e0 Richard Karp (v\u00e0 m\u1ed9t c\u00e1ch \u0111\u1ed9c l\u1eadp Tomizawa) \u0111\u00e3 ch\u1ec9 ra c\u00e1ch c\u1ea3i thi\u1ec7n n\u00f3 th\u00e0nh \u0111\u1ed9 ph\u1ee9c t\u1ea1p ti\u1ec7m c\u1eadn l\u00e0 $\\mathcal{O}(n^3)$.</p>","tags":["Translated"]},{"location":"graph/hungarian-algorithm.html#the-o-n-4-algorithm","title":"Thu\u1eadt to\u00e1n $\\mathcal{O}(n^4)$ (The $\\mathcal{O}(n^4)$ algorithm)","text":"<p>\u0110\u1ec3 tr\u00e1nh s\u1ef1 m\u01a1 h\u1ed3, ch\u00fang t\u00f4i l\u01b0u \u00fd ngay r\u1eb1ng ch\u00fang t\u00f4i ch\u1ee7 y\u1ebfu quan t\u00e2m \u0111\u1ebfn b\u00e0i to\u00e1n ph\u00e2n c\u00f4ng trong m\u1ed9t c\u00f4ng th\u1ee9c ma tr\u1eadn (t\u1ee9c l\u00e0, cho m\u1ed9t ma tr\u1eadn $A$, b\u1ea1n c\u1ea7n ch\u1ecdn $n$ \u00f4 t\u1eeb n\u00f3 n\u1eb1m trong c\u00e1c h\u00e0ng v\u00e0 c\u1ed9t kh\u00e1c nhau). Ch\u00fang t\u00f4i l\u1eadp ch\u1ec9 m\u1ee5c m\u1ea3ng b\u1eaft \u0111\u1ea7u b\u1eb1ng $1$, ngh\u0129a l\u00e0, v\u00ed d\u1ee5, ma tr\u1eadn $A$ c\u00f3 c\u00e1c ch\u1ec9 s\u1ed1 $A[1 \\dots n][1 \\dots n]$.</p> <p>Ch\u00fang ta c\u0169ng s\u1ebd gi\u1ea3 s\u1eed r\u1eb1ng t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 trong ma tr\u1eadn A \u0111\u1ec1u kh\u00f4ng \u00e2m (n\u1ebfu kh\u00f4ng ph\u1ea3i v\u1eady, b\u1ea1n lu\u00f4n c\u00f3 th\u1ec3 l\u00e0m cho ma tr\u1eadn kh\u00f4ng \u00e2m b\u1eb1ng c\u00e1ch th\u00eam m\u1ed9t h\u1eb1ng s\u1ed1 v\u00e0o t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1).</p> <p>H\u00e3y g\u1ecdi m\u1ed9t th\u1ebf n\u0103ng (potential) l\u00e0 hai m\u1ea3ng s\u1ed1 t\u00f9y \u00fd $u[1 \\ldots n]$ v\u00e0 $v[1 \\ldots n]$, sao cho \u0111i\u1ec1u ki\u1ec7n sau \u0111\u01b0\u1ee3c th\u1ecfa m\u00e3n:</p> $$u[i]+v[j]\\leq A[i][j],\\quad i=1\\dots n,\\ j=1\\dots n$$ <p>(Nh\u01b0 b\u1ea1n c\u00f3 th\u1ec3 th\u1ea5y, $u[i]$ t\u01b0\u01a1ng \u1ee9ng v\u1edbi h\u00e0ng th\u1ee9 $i$, v\u00e0 $v[j]$ t\u01b0\u01a1ng \u1ee9ng v\u1edbi c\u1ed9t th\u1ee9 $j$ c\u1ee7a ma tr\u1eadn).</p> <p>H\u00e3y g\u1ecdi gi\u00e1 tr\u1ecb $f$ c\u1ee7a th\u1ebf n\u0103ng l\u00e0 t\u1ed5ng c\u00e1c ph\u1ea7n t\u1eed c\u1ee7a n\u00f3:</p> $$f=\\sum_{i=1}^{n} u[i] + \\sum_{j=1}^{n} v[j].$$ <p>M\u1ed9t m\u1eb7t, d\u1ec5 th\u1ea5y r\u1eb1ng chi ph\u00ed c\u1ee7a gi\u1ea3i ph\u00e1p mong mu\u1ed1n $sol$ kh\u00f4ng nh\u1ecf h\u01a1n gi\u00e1 tr\u1ecb c\u1ee7a b\u1ea5t k\u1ef3 th\u1ebf n\u0103ng n\u00e0o.</p> <p>B\u1ed5 \u0111\u1ec1. $sol\\geq f.$</p> Ch\u1ee9ng minh <p>Gi\u1ea3i ph\u00e1p mong mu\u1ed1n c\u1ee7a b\u00e0i to\u00e1n bao g\u1ed3m $n$ \u00f4 c\u1ee7a ma tr\u1eadn $A$, v\u00ec v\u1eady $u[i]+v[j]\\leq A[i][j]$ cho m\u1ed7i \u00f4 trong s\u1ed1 \u0111\u00f3. V\u00ec t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed trong $sol$ n\u1eb1m trong c\u00e1c h\u00e0ng v\u00e0 c\u1ed9t kh\u00e1c nhau, c\u1ed9ng c\u00e1c b\u1ea5t \u0111\u1eb3ng th\u1ee9c n\u00e0y tr\u00ean t\u1ea5t c\u1ea3 c\u00e1c $A[i][j]$ \u0111\u00e3 ch\u1ecdn, b\u1ea1n nh\u1eadn \u0111\u01b0\u1ee3c $f$ \u1edf ph\u00eda b\u00ean tr\u00e1i c\u1ee7a b\u1ea5t \u0111\u1eb3ng th\u1ee9c, v\u00e0 $sol$ \u1edf ph\u00eda b\u00ean ph\u1ea3i.</p> <p>M\u1eb7t kh\u00e1c, h\u00f3a ra lu\u00f4n c\u00f3 m\u1ed9t gi\u1ea3i ph\u00e1p v\u00e0 m\u1ed9t th\u1ebf n\u0103ng bi\u1ebfn b\u1ea5t \u0111\u1eb3ng th\u1ee9c n\u00e0y th\u00e0nh \u0111\u1eb3ng th\u1ee9c. Thu\u1eadt to\u00e1n Hungary \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 d\u01b0\u1edbi \u0111\u00e2y s\u1ebd l\u00e0 m\u1ed9t b\u1eb1ng ch\u1ee9ng x\u00e2y d\u1ef1ng cho th\u1ef1c t\u1ebf n\u00e0y. B\u00e2y gi\u1edd, h\u00e3y ch\u1ec9 ch\u00fa \u00fd \u0111\u1ebfn th\u1ef1c t\u1ebf l\u00e0 n\u1ebfu b\u1ea5t k\u1ef3 gi\u1ea3i ph\u00e1p n\u00e0o c\u00f3 chi ph\u00ed b\u1eb1ng v\u1edbi b\u1ea5t k\u1ef3 th\u1ebf n\u0103ng n\u00e0o, th\u00ec gi\u1ea3i ph\u00e1p n\u00e0y l\u00e0 t\u1ed1i \u01b0u.</p> <p>H\u00e3y c\u1ed1 \u0111\u1ecbnh m\u1ed9t th\u1ebf n\u0103ng n\u00e0o \u0111\u00f3. H\u00e3y g\u1ecdi m\u1ed9t c\u1ea1nh $(i,j)$ l\u00e0 c\u1ee9ng (rigid) n\u1ebfu $u[i]+v[j]=A[i][j].$</p> <p>Nh\u1edb l\u1ea1i m\u1ed9t c\u00f4ng th\u1ee9c thay th\u1ebf c\u1ee7a b\u00e0i to\u00e1n ph\u00e2n c\u00f4ng, s\u1eed d\u1ee5ng \u0111\u1ed3 th\u1ecb hai ph\u00eda. K\u00fd hi\u1ec7u $H$ l\u00e0 m\u1ed9t \u0111\u1ed3 th\u1ecb hai ph\u00eda ch\u1ec9 bao g\u1ed3m c\u00e1c c\u1ea1nh c\u1ee9ng. Thu\u1eadt to\u00e1n Hungary s\u1ebd duy tr\u00ec, cho th\u1ebf n\u0103ng hi\u1ec7n t\u1ea1i, c\u1eb7p gh\u00e9p c\u00f3 s\u1ed1 l\u01b0\u1ee3ng c\u1ea1nh t\u1ed1i \u0111a $M$ c\u1ee7a \u0111\u1ed3 th\u1ecb $H$. Ngay khi $M$ ch\u1ee9a $n$ c\u1ea1nh, th\u00ec gi\u1ea3i ph\u00e1p cho b\u00e0i to\u00e1n s\u1ebd ch\u1ec9 l\u00e0 $M$ (r\u1ed1t cu\u1ed9c, n\u00f3 s\u1ebd l\u00e0 m\u1ed9t gi\u1ea3i ph\u00e1p c\u00f3 chi ph\u00ed tr\u00f9ng v\u1edbi gi\u00e1 tr\u1ecb c\u1ee7a m\u1ed9t th\u1ebf n\u0103ng).</p> <p>H\u00e3y ti\u1ebfn h\u00e0nh tr\u1ef1c ti\u1ebfp \u0111\u1ebfn m\u00f4 t\u1ea3 thu\u1eadt to\u00e1n.</p> <p>B\u01b0\u1edbc 1. Ban \u0111\u1ea7u, th\u1ebf n\u0103ng \u0111\u01b0\u1ee3c gi\u1ea3 \u0111\u1ecbnh l\u00e0 b\u1eb1ng 0 ($u[i]=v[i]=0$ cho t\u1ea5t c\u1ea3 $i$), v\u00e0 c\u1eb7p gh\u00e9p $M$ \u0111\u01b0\u1ee3c gi\u1ea3 \u0111\u1ecbnh l\u00e0 r\u1ed7ng.</p> <p>B\u01b0\u1edbc 2. H\u01a1n n\u1eefa, t\u1ea1i m\u1ed7i b\u01b0\u1edbc c\u1ee7a thu\u1eadt to\u00e1n, ch\u00fang ta c\u1ed1 g\u1eafng, m\u00e0 kh\u00f4ng thay \u0111\u1ed5i th\u1ebf n\u0103ng, \u0111\u1ec3 t\u0103ng l\u1ef1c l\u01b0\u1ee3ng c\u1ee7a c\u1eb7p gh\u00e9p hi\u1ec7n t\u1ea1i $M$ l\u00ean m\u1ed9t (nh\u1edb l\u1ea1i r\u1eb1ng c\u1eb7p gh\u00e9p \u0111\u01b0\u1ee3c t\u00ecm ki\u1ebfm trong \u0111\u1ed3 th\u1ecb c\u00e1c c\u1ea1nh c\u1ee9ng $H$). \u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y, Thu\u1eadt to\u00e1n Kuhn th\u00f4ng th\u01b0\u1eddng \u0111\u1ec3 t\u00ecm c\u1eb7p gh\u00e9p c\u1ef1c \u0111\u1ea1i trong \u0111\u1ed3 th\u1ecb hai ph\u00eda \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng. H\u00e3y nh\u1edb l\u1ea1i thu\u1eadt to\u00e1n \u1edf \u0111\u00e2y. T\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh c\u1ee7a c\u1eb7p gh\u00e9p $M$ \u0111\u01b0\u1ee3c \u0111\u1ecbnh h\u01b0\u1edbng theo h\u01b0\u1edbng t\u1eeb ph\u1ea7n b\u00ean ph\u1ea3i sang ph\u1ea7n b\u00ean tr\u00e1i, v\u00e0 t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh kh\u00e1c c\u1ee7a \u0111\u1ed3 th\u1ecb $H$ \u0111\u01b0\u1ee3c \u0111\u1ecbnh h\u01b0\u1edbng theo h\u01b0\u1edbng ng\u01b0\u1ee3c l\u1ea1i.</p> <p>Nh\u1edb l\u1ea1i (t\u1eeb thu\u1eadt ng\u1eef t\u00ecm ki\u1ebfm c\u1eb7p gh\u00e9p) r\u1eb1ng m\u1ed9t \u0111\u1ec9nh \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 b\u00e3o h\u00f2a n\u1ebfu m\u1ed9t c\u1ea1nh c\u1ee7a c\u1eb7p gh\u00e9p hi\u1ec7n t\u1ea1i k\u1ec1 v\u1edbi n\u00f3. M\u1ed9t \u0111\u1ec9nh kh\u00f4ng k\u1ec1 v\u1edbi b\u1ea5t k\u1ef3 c\u1ea1nh n\u00e0o c\u1ee7a c\u1eb7p gh\u00e9p hi\u1ec7n t\u1ea1i \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 ch\u01b0a b\u00e3o h\u00f2a. M\u1ed9t \u0111\u01b0\u1eddng \u0111i c\u00f3 \u0111\u1ed9 d\u00e0i l\u1ebb, trong \u0111\u00f3 c\u1ea1nh \u0111\u1ea7u ti\u00ean kh\u00f4ng thu\u1ed9c v\u1ec1 c\u1eb7p gh\u00e9p, v\u00e0 \u0111\u1ed1i v\u1edbi t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh ti\u1ebfp theo c\u00f3 s\u1ef1 thay th\u1ebf thu\u1ed9c v\u1ec1 c\u1eb7p gh\u00e9p (thu\u1ed9c / kh\u00f4ng thu\u1ed9c) - \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 \u0111\u01b0\u1eddng t\u0103ng. T\u1eeb t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh ch\u01b0a b\u00e3o h\u00f2a trong ph\u1ea7n b\u00ean tr\u00e1i, m\u1ed9t duy\u1ec7t theo chi\u1ec1u s\u00e2u ho\u1eb7c theo chi\u1ec1u r\u1ed9ng \u0111\u01b0\u1ee3c b\u1eaft \u0111\u1ea7u. N\u1ebfu, k\u1ebft qu\u1ea3 c\u1ee7a vi\u1ec7c t\u00ecm ki\u1ebfm, c\u00f3 th\u1ec3 \u0111\u1ebfn \u0111\u01b0\u1ee3c m\u1ed9t \u0111\u1ec9nh ch\u01b0a b\u00e3o h\u00f2a c\u1ee7a ph\u1ea7n b\u00ean ph\u1ea3i, ch\u00fang ta \u0111\u00e3 t\u00ecm th\u1ea5y m\u1ed9t \u0111\u01b0\u1eddng t\u0103ng t\u1eeb ph\u1ea7n b\u00ean tr\u00e1i sang ph\u1ea7n b\u00ean ph\u1ea3i. N\u1ebfu ch\u00fang ta bao g\u1ed3m c\u00e1c c\u1ea1nh l\u1ebb c\u1ee7a \u0111\u01b0\u1eddng \u0111i v\u00e0 lo\u1ea1i b\u1ecf c\u00e1c c\u1ea1nh ch\u1eb5n trong c\u1eb7p gh\u00e9p (t\u1ee9c l\u00e0 bao g\u1ed3m c\u1ea1nh \u0111\u1ea7u ti\u00ean trong c\u1eb7p gh\u00e9p, lo\u1ea1i tr\u1eeb c\u1ea1nh th\u1ee9 hai, bao g\u1ed3m c\u1ea1nh th\u1ee9 ba, v.v.), th\u00ec ch\u00fang ta s\u1ebd t\u0103ng l\u1ef1c l\u01b0\u1ee3ng c\u1eb7p gh\u00e9p l\u00ean m\u1ed9t.</p> <p>N\u1ebfu kh\u00f4ng c\u00f3 \u0111\u01b0\u1eddng t\u0103ng, th\u00ec c\u1eb7p gh\u00e9p hi\u1ec7n t\u1ea1i $M$ l\u00e0 c\u1ef1c \u0111\u1ea1i trong \u0111\u1ed3 th\u1ecb $H$.</p> <p>B\u01b0\u1edbc 3. N\u1ebfu \u1edf b\u01b0\u1edbc hi\u1ec7n t\u1ea1i, kh\u00f4ng th\u1ec3 t\u0103ng l\u1ef1c l\u01b0\u1ee3ng c\u1ee7a c\u1eb7p gh\u00e9p hi\u1ec7n t\u1ea1i, th\u00ec vi\u1ec7c t\u00ednh to\u00e1n l\u1ea1i th\u1ebf n\u0103ng \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n theo c\u00e1ch sao cho, \u1edf c\u00e1c b\u01b0\u1edbc ti\u1ebfp theo, s\u1ebd c\u00f3 nhi\u1ec1u c\u01a1 h\u1ed9i h\u01a1n \u0111\u1ec3 t\u0103ng c\u1eb7p gh\u00e9p.</p> <p>K\u00fd hi\u1ec7u $Z_1$ l\u00e0 t\u1eadp h\u1ee3p c\u00e1c \u0111\u1ec9nh c\u1ee7a ph\u1ea7n b\u00ean tr\u00e1i \u0111\u00e3 \u0111\u01b0\u1ee3c th\u0103m trong l\u1ea7n duy\u1ec7t cu\u1ed1i c\u00f9ng c\u1ee7a thu\u1eadt to\u00e1n Kuhn, v\u00e0 qua $Z_2$ t\u1eadp h\u1ee3p c\u00e1c \u0111\u1ec9nh \u0111\u00e3 \u0111\u01b0\u1ee3c th\u0103m c\u1ee7a ph\u1ea7n b\u00ean ph\u1ea3i.</p> <p>H\u00e3y t\u00ednh gi\u00e1 tr\u1ecb $\\Delta$:</p> $$\\Delta = \\min_{i\\in Z_1,\\ j\\notin Z_2} A[i][j]-u[i]-v[j].$$ <p>B\u1ed5 \u0111\u1ec1. $\\Delta &gt; 0.$</p> Ch\u1ee9ng minh <p>Gi\u1ea3 s\u1eed $\\Delta=0$. Khi \u0111\u00f3 t\u1ed3n t\u1ea1i m\u1ed9t c\u1ea1nh c\u1ee9ng $(i,j)$ v\u1edbi $i\\in Z_1$ v\u00e0 $j\\notin Z_2$. Suy ra r\u1eb1ng c\u1ea1nh $(i,j)$ ph\u1ea3i \u0111\u01b0\u1ee3c \u0111\u1ecbnh h\u01b0\u1edbng t\u1eeb ph\u1ea7n b\u00ean ph\u1ea3i sang ph\u1ea7n b\u00ean tr\u00e1i, t\u1ee9c l\u00e0 $(i,j)$ ph\u1ea3i \u0111\u01b0\u1ee3c bao g\u1ed3m trong c\u1eb7p gh\u00e9p $M$. Tuy nhi\u00ean, \u0111i\u1ec1u n\u00e0y l\u00e0 kh\u00f4ng th\u1ec3, b\u1edfi v\u00ec ch\u00fang ta kh\u00f4ng th\u1ec3 \u0111\u1ebfn \u0111\u01b0\u1ee3c \u0111\u1ec9nh b\u00e3o h\u00f2a $i$ ngo\u1ea1i tr\u1eeb b\u1eb1ng c\u00e1ch \u0111i d\u1ecdc theo c\u1ea1nh t\u1eeb j \u0111\u1ebfn i. V\u00ec v\u1eady $\\Delta &gt; 0$.</p> <p>B\u00e2y gi\u1edd h\u00e3y t\u00ednh to\u00e1n l\u1ea1i th\u1ebf n\u0103ng theo c\u00e1ch n\u00e0y:</p> <ul> <li> <p>cho t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh $i\\in Z_1$, th\u1ef1c hi\u1ec7n $u[i] \\gets u[i]+\\Delta$,</p> </li> <li> <p>cho t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh $j\\in Z_2$, th\u1ef1c hi\u1ec7n $v[j] \\gets v[j]-\\Delta$.</p> </li> </ul> <p>B\u1ed5 \u0111\u1ec1. Th\u1ebf n\u0103ng k\u1ebft qu\u1ea3 v\u1eabn l\u00e0 m\u1ed9t th\u1ebf n\u0103ng ch\u00ednh x\u00e1c.</p> Ch\u1ee9ng minh <p>Ch\u00fang ta s\u1ebd ch\u1ec9 ra r\u1eb1ng, sau khi t\u00ednh to\u00e1n l\u1ea1i, $u[i]+v[j]\\leq A[i][j]$ cho t\u1ea5t c\u1ea3 $i,j$. \u0110\u1ed1i v\u1edbi t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed c\u1ee7a $A$ v\u1edbi $i\\in Z_1$ v\u00e0 $j\\in Z_2$, t\u1ed5ng $u[i]+v[j]$ kh\u00f4ng thay \u0111\u1ed5i, v\u00ec v\u1eady b\u1ea5t \u0111\u1eb3ng th\u1ee9c v\u1eabn \u0111\u00fang. \u0110\u1ed1i v\u1edbi t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed v\u1edbi $i\\notin Z_1$ v\u00e0 $j\\in Z_2$, t\u1ed5ng $u[i]+v[j]$ gi\u1ea3m \u0111i $\\Delta$, v\u00ec v\u1eady b\u1ea5t \u0111\u1eb3ng th\u1ee9c v\u1eabn \u0111\u00fang. \u0110\u1ed1i v\u1edbi c\u00e1c ph\u1ea7n t\u1eed kh\u00e1c c\u00f3 $i\\in Z_1$ v\u00e0 $j\\notin Z_2$, t\u1ed5ng t\u0103ng l\u00ean, nh\u01b0ng b\u1ea5t \u0111\u1eb3ng th\u1ee9c v\u1eabn \u0111\u01b0\u1ee3c b\u1ea3o t\u1ed3n, v\u00ec gi\u00e1 tr\u1ecb $\\Delta$, theo \u0111\u1ecbnh ngh\u0129a, l\u00e0 m\u1ee9c t\u0103ng t\u1ed1i \u0111a kh\u00f4ng l\u00e0m thay \u0111\u1ed5i b\u1ea5t \u0111\u1eb3ng th\u1ee9c.</p> <p>B\u1ed5 \u0111\u1ec1. C\u1eb7p gh\u00e9p c\u0169 $M$ c\u1ee7a c\u00e1c c\u1ea1nh c\u1ee9ng l\u00e0 h\u1ee3p l\u1ec7, t\u1ee9c l\u00e0 t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh c\u1ee7a c\u1eb7p gh\u00e9p s\u1ebd v\u1eabn c\u1ee9ng.</p> Ch\u1ee9ng minh <p>\u0110\u1ec3 m\u1ed9t s\u1ed1 c\u1ea1nh c\u1ee9ng $(i,j)$ ng\u1eebng c\u1ee9ng do thay \u0111\u1ed5i th\u1ebf n\u0103ng, c\u1ea7n ph\u1ea3i c\u00f3 \u0111\u1eb3ng th\u1ee9c $u[i] + v[j] = A[i][j]$ chuy\u1ec3n th\u00e0nh b\u1ea5t \u0111\u1eb3ng th\u1ee9c $u[i] + v[j] &lt; A[i][j]$. Tuy nhi\u00ean, \u0111i\u1ec1u n\u00e0y ch\u1ec9 c\u00f3 th\u1ec3 x\u1ea3y ra khi $i \\notin Z_1$ v\u00e0 $j \\in Z_2$. Nh\u01b0ng $i \\notin Z_1$ ng\u1ee5 \u00fd r\u1eb1ng c\u1ea1nh $(i,j)$ kh\u00f4ng th\u1ec3 l\u00e0 m\u1ed9t c\u1ea1nh c\u1eb7p gh\u00e9p.</p> <p>B\u1ed5 \u0111\u1ec1. Sau m\u1ed7i l\u1ea7n t\u00ednh to\u00e1n l\u1ea1i th\u1ebf n\u0103ng, s\u1ed1 l\u01b0\u1ee3ng \u0111\u1ec9nh c\u00f3 th\u1ec3 \u0111\u1ebfn \u0111\u01b0\u1ee3c b\u1eb1ng c\u00e1ch duy\u1ec7t, t\u1ee9c l\u00e0 $|Z_1|+|Z_2|$, t\u0103ng nghi\u00eam ng\u1eb7t.</p> Ch\u1ee9ng minh <p>Tr\u01b0\u1edbc ti\u00ean, l\u01b0u \u00fd r\u1eb1ng b\u1ea5t k\u1ef3 \u0111\u1ec9nh n\u00e0o c\u00f3 th\u1ec3 \u0111\u1ebfn \u0111\u01b0\u1ee3c tr\u01b0\u1edbc khi t\u00ednh to\u00e1n l\u1ea1i, v\u1eabn c\u00f3 th\u1ec3 \u0111\u1ebfn \u0111\u01b0\u1ee3c. Th\u1eadt v\u1eady, n\u1ebfu m\u1ed9t s\u1ed1 \u0111\u1ec9nh c\u00f3 th\u1ec3 \u0111\u1ebfn \u0111\u01b0\u1ee3c, th\u00ec c\u00f3 m\u1ed9t s\u1ed1 \u0111\u01b0\u1eddng \u0111i t\u1eeb c\u00e1c \u0111\u1ec9nh c\u00f3 th\u1ec3 \u0111\u1ebfn \u0111\u01b0\u1ee3c \u0111\u1ebfn n\u00f3, b\u1eaft \u0111\u1ea7u t\u1eeb \u0111\u1ec9nh ch\u01b0a b\u00e3o h\u00f2a c\u1ee7a ph\u1ea7n b\u00ean tr\u00e1i; v\u00ec \u0111\u1ed1i v\u1edbi c\u00e1c c\u1ea1nh c\u00f3 d\u1ea1ng $(i,j),\\ i\\in Z_1,\\ j\\in Z_2$ t\u1ed5ng $u[i]+v[j]$ kh\u00f4ng thay \u0111\u1ed5i, to\u00e0n b\u1ed9 \u0111\u01b0\u1eddng \u0111i n\u00e0y s\u1ebd \u0111\u01b0\u1ee3c b\u1ea3o t\u1ed3n sau khi thay \u0111\u1ed5i th\u1ebf n\u0103ng. Th\u1ee9 hai, ch\u00fang ta ch\u1ec9 ra r\u1eb1ng sau m\u1ed9t l\u1ea7n t\u00ednh to\u00e1n l\u1ea1i, \u00edt nh\u1ea5t m\u1ed9t \u0111\u1ec9nh m\u1edbi s\u1ebd c\u00f3 th\u1ec3 \u0111\u1ebfn \u0111\u01b0\u1ee3c. \u0110i\u1ec1u n\u00e0y tu\u00e2n theo \u0111\u1ecbnh ngh\u0129a c\u1ee7a $\\Delta$: c\u1ea1nh $(i,j)$ m\u00e0 $\\Delta$ \u0111\u1ec1 c\u1eadp \u0111\u1ebfn s\u1ebd tr\u1edf n\u00ean c\u1ee9ng, v\u00ec v\u1eady \u0111\u1ec9nh $j$ s\u1ebd c\u00f3 th\u1ec3 \u0111\u1ebfn \u0111\u01b0\u1ee3c t\u1eeb \u0111\u1ec9nh $i$.</p> <p>Do b\u1ed5 \u0111\u1ec1 cu\u1ed1i c\u00f9ng, kh\u00f4ng qu\u00e1 $n$ l\u1ea7n t\u00ednh to\u00e1n l\u1ea1i th\u1ebf n\u0103ng c\u00f3 th\u1ec3 x\u1ea3y ra tr\u01b0\u1edbc khi t\u00ecm th\u1ea5y m\u1ed9t \u0111\u01b0\u1eddng t\u0103ng v\u00e0 l\u1ef1c l\u01b0\u1ee3ng c\u1eb7p gh\u00e9p c\u1ee7a $M$ \u0111\u01b0\u1ee3c t\u0103ng l\u00ean. Do \u0111\u00f3, s\u1edbm hay mu\u1ed9n, m\u1ed9t th\u1ebf n\u0103ng t\u01b0\u01a1ng \u1ee9ng v\u1edbi m\u1ed9t c\u1eb7p gh\u00e9p ho\u00e0n h\u1ea3o $M^*$ s\u1ebd \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y, v\u00e0 $M^*$ s\u1ebd l\u00e0 c\u00e2u tr\u1ea3 l\u1eddi cho b\u00e0i to\u00e1n. N\u1ebfu ch\u00fang ta n\u00f3i v\u1ec1 \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a thu\u1eadt to\u00e1n, th\u00ec \u0111\u00f3 l\u00e0 $\\mathcal{O}(n^4)$: t\u1ed5ng c\u1ed9ng s\u1ebd c\u00f3 t\u1ed1i \u0111a $n$ l\u1ea7n t\u0103ng c\u1eb7p gh\u00e9p, tr\u01b0\u1edbc m\u1ed7i l\u1ea7n \u0111\u00f3 kh\u00f4ng qu\u00e1 $n$ l\u1ea7n t\u00ednh to\u00e1n l\u1ea1i th\u1ebf n\u0103ng, m\u1ed7i l\u1ea7n \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong th\u1eddi gian $\\mathcal{O}(n^2)$.</p> <p>Ch\u00fang t\u00f4i s\u1ebd kh\u00f4ng \u0111\u01b0a ra c\u00e0i \u0111\u1eb7t cho thu\u1eadt to\u00e1n $\\mathcal{O}(n^4)$ \u1edf \u0111\u00e2y, v\u00ec n\u00f3 s\u1ebd kh\u00f4ng ng\u1eafn h\u01a1n c\u00e0i \u0111\u1eb7t cho $\\mathcal{O}(n^3)$, \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 b\u00ean d\u01b0\u1edbi.</p>","tags":["Translated"]},{"location":"graph/hungarian-algorithm.html#the-o-n-3-algorithm","title":"Thu\u1eadt to\u00e1n $\\mathcal{O}(n^3)$ (The $\\mathcal{O}(n^3)$ algorithm)","text":"<p>B\u00e2y gi\u1edd h\u00e3y t\u00ecm hi\u1ec3u c\u00e1ch c\u00e0i \u0111\u1eb7t thu\u1eadt to\u00e1n t\u01b0\u01a1ng t\u1ef1 trong $\\mathcal{O}(n^3)$ (\u0111\u1ed1i v\u1edbi c\u00e1c b\u00e0i to\u00e1n h\u00ecnh ch\u1eef nh\u1eadt $n \\times m$, $\\mathcal{O}(n^2m)$).</p> <p>\u00dd t\u01b0\u1edfng ch\u00ednh l\u00e0 xem x\u00e9t c\u00e1c h\u00e0ng ma tr\u1eadn t\u1eebng h\u00e0ng m\u1ed9t, v\u00e0 kh\u00f4ng ph\u1ea3i t\u1ea5t c\u1ea3 c\u00f9ng m\u1ed9t l\u00fac. Do \u0111\u00f3, thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 \u1edf tr\u00ean s\u1ebd c\u00f3 d\u1ea1ng sau:</p> <ol> <li> <p>Xem x\u00e9t h\u00e0ng ti\u1ebfp theo c\u1ee7a ma tr\u1eadn $A$.</p> </li> <li> <p>Trong khi kh\u00f4ng c\u00f3 \u0111\u01b0\u1eddng t\u0103ng b\u1eaft \u0111\u1ea7u trong h\u00e0ng n\u00e0y, h\u00e3y t\u00ednh to\u00e1n l\u1ea1i th\u1ebf n\u0103ng.</p> </li> <li> <p>Ngay khi t\u00ecm th\u1ea5y m\u1ed9t \u0111\u01b0\u1eddng t\u0103ng, h\u00e3y lan truy\u1ec1n c\u1eb7p gh\u00e9p d\u1ecdc theo n\u00f3 (do \u0111\u00f3 bao g\u1ed3m c\u1ea1nh cu\u1ed1i c\u00f9ng trong c\u1eb7p gh\u00e9p), v\u00e0 kh\u1edfi \u0111\u1ed9ng l\u1ea1i t\u1eeb b\u01b0\u1edbc 1 (\u0111\u1ec3 xem x\u00e9t d\u00f2ng ti\u1ebfp theo).</p> </li> </ol> <p>\u0110\u1ec3 \u0111\u1ea1t \u0111\u01b0\u1ee3c \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u1ea7n thi\u1ebft, c\u1ea7n ph\u1ea3i c\u00e0i \u0111\u1eb7t c\u00e1c b\u01b0\u1edbc 2-3, \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n cho m\u1ed7i h\u00e0ng c\u1ee7a ma tr\u1eadn, trong th\u1eddi gian $\\mathcal{O}(n^2)$ (\u0111\u1ed1i v\u1edbi c\u00e1c b\u00e0i to\u00e1n h\u00ecnh ch\u1eef nh\u1eadt trong $\\mathcal{O}(nm)$).</p> <p>\u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y, h\u00e3y nh\u1edb l\u1ea1i hai s\u1ef1 ki\u1ec7n \u0111\u00e3 \u0111\u01b0\u1ee3c ch\u1ee9ng minh \u1edf tr\u00ean:</p> <ul> <li> <p>V\u1edbi s\u1ef1 thay \u0111\u1ed5i v\u1ec1 th\u1ebf n\u0103ng, c\u00e1c \u0111\u1ec9nh c\u00f3 th\u1ec3 \u0111\u1ebfn \u0111\u01b0\u1ee3c b\u1eb1ng c\u00e1ch duy\u1ec7t Kuhn s\u1ebd v\u1eabn c\u00f3 th\u1ec3 \u0111\u1ebfn \u0111\u01b0\u1ee3c.</p> </li> <li> <p>T\u1ed5ng c\u1ed9ng, ch\u1ec9 c\u00f3 $\\mathcal{O}(n)$ l\u1ea7n t\u00ednh to\u00e1n l\u1ea1i th\u1ebf n\u0103ng c\u00f3 th\u1ec3 x\u1ea3y ra tr\u01b0\u1edbc khi t\u00ecm th\u1ea5y m\u1ed9t \u0111\u01b0\u1eddng t\u0103ng.</p> </li> </ul> <p>T\u1eeb \u0111\u00e2y suy ra nh\u1eefng \u00fd t\u01b0\u1edfng ch\u00ednh n\u00e0y cho ph\u00e9p ch\u00fang ta \u0111\u1ea1t \u0111\u01b0\u1ee3c \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u1ea7n thi\u1ebft:</p> <ul> <li> <p>\u0110\u1ec3 ki\u1ec3m tra s\u1ef1 hi\u1ec7n di\u1ec7n c\u1ee7a m\u1ed9t \u0111\u01b0\u1eddng t\u0103ng, kh\u00f4ng c\u1ea7n ph\u1ea3i b\u1eaft \u0111\u1ea7u l\u1ea1i duy\u1ec7t Kuhn sau m\u1ed7i l\u1ea7n t\u00ednh to\u00e1n l\u1ea1i th\u1ebf n\u0103ng. Thay v\u00e0o \u0111\u00f3, b\u1ea1n c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n duy\u1ec7t Kuhn \u1edf d\u1ea1ng l\u1eb7p: sau m\u1ed7i l\u1ea7n t\u00ednh to\u00e1n l\u1ea1i th\u1ebf n\u0103ng, nh\u00ecn v\u00e0o c\u00e1c c\u1ea1nh c\u1ee9ng \u0111\u01b0\u1ee3c th\u00eam v\u00e0o v\u00e0, n\u1ebfu \u0111\u1ea7u b\u00ean tr\u00e1i c\u1ee7a ch\u00fang c\u00f3 th\u1ec3 \u0111\u1ebfn \u0111\u01b0\u1ee3c, h\u00e3y \u0111\u00e1nh d\u1ea5u \u0111\u1ea7u b\u00ean ph\u1ea3i c\u1ee7a ch\u00fang c\u0169ng c\u00f3 th\u1ec3 \u0111\u1ebfn \u0111\u01b0\u1ee3c v\u00e0 ti\u1ebfp t\u1ee5c duy\u1ec7t t\u1eeb ch\u00fang.</p> </li> <li> <p>Ph\u00e1t tri\u1ec3n \u00fd t\u01b0\u1edfng n\u00e0y h\u01a1n n\u1eefa, ch\u00fang ta c\u00f3 th\u1ec3 tr\u00ecnh b\u00e0y thu\u1eadt to\u00e1n nh\u01b0 sau: \u1edf m\u1ed7i b\u01b0\u1edbc c\u1ee7a v\u00f2ng l\u1eb7p, th\u1ebf n\u0103ng \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n l\u1ea1i. Sau \u0111\u00f3, m\u1ed9t c\u1ed9t \u0111\u00e3 tr\u1edf n\u00ean c\u00f3 th\u1ec3 \u0111\u1ebfn \u0111\u01b0\u1ee3c \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh (c\u1ed9t n\u00e0y s\u1ebd lu\u00f4n t\u1ed3n t\u1ea1i khi c\u00e1c \u0111\u1ec9nh c\u00f3 th\u1ec3 \u0111\u1ebfn \u0111\u01b0\u1ee3c m\u1edbi xu\u1ea5t hi\u1ec7n sau m\u1ed7i l\u1ea7n t\u00ednh to\u00e1n l\u1ea1i th\u1ebf n\u0103ng). N\u1ebfu c\u1ed9t ch\u01b0a b\u00e3o h\u00f2a, m\u1ed9t chu\u1ed7i t\u0103ng \u0111\u01b0\u1ee3c ph\u00e1t hi\u1ec7n. Ng\u01b0\u1ee3c l\u1ea1i, n\u1ebfu c\u1ed9t b\u00e3o h\u00f2a, h\u00e0ng gh\u00e9p \u0111\u00f4i c\u0169ng tr\u1edf n\u00ean c\u00f3 th\u1ec3 \u0111\u1ebfn \u0111\u01b0\u1ee3c.</p> </li> <li> <p>\u0110\u1ec3 t\u00ednh to\u00e1n l\u1ea1i nhanh th\u1ebf n\u0103ng (nhanh h\u01a1n phi\u00ean b\u1ea3n ng\u00e2y th\u01a1 $\\mathcal{O}(n^2)$), b\u1ea1n c\u1ea7n duy tr\u00ec c\u00e1c c\u1ef1c ti\u1ec3u ph\u1ee5 tr\u1ee3 cho m\u1ed7i c\u1ed9t:</p> <p>$minv[j]=\\min_{i\\in Z_1} A[i][j]-u[i]-v[j].$</p> <p>D\u1ec5 th\u1ea5y r\u1eb1ng gi\u00e1 tr\u1ecb mong mu\u1ed1n $\\Delta$ \u0111\u01b0\u1ee3c bi\u1ec3u th\u1ecb qua ch\u00fang nh\u01b0 sau:</p> <p>$\\Delta=\\min_{j\\notin Z_2} minv[j].$</p> <p>Do \u0111\u00f3, vi\u1ec7c t\u00ecm $\\Delta$ b\u00e2y gi\u1edd c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong $\\mathcal{O}(n)$.</p> <p>C\u1ea7n c\u1eadp nh\u1eadt m\u1ea3ng $minv$ khi c\u00e1c h\u00e0ng \u0111\u00e3 th\u0103m m\u1edbi xu\u1ea5t hi\u1ec7n. \u0110i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong $\\mathcal{O}(n)$ cho h\u00e0ng \u0111\u00e3 th\u00eam (c\u1ed9ng d\u1ed3n tr\u00ean t\u1ea5t c\u1ea3 c\u00e1c h\u00e0ng th\u00e0nh $\\mathcal{O}(n^2)$). C\u0169ng c\u1ea7n c\u1eadp nh\u1eadt m\u1ea3ng $minv$ khi t\u00ednh to\u00e1n l\u1ea1i th\u1ebf n\u0103ng, \u0111i\u1ec1u n\u00e0y c\u0169ng \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong th\u1eddi gian $\\mathcal{O}(n)$ ($minv$ ch\u1ec9 thay \u0111\u1ed5i \u0111\u1ed1i v\u1edbi c\u00e1c c\u1ed9t ch\u01b0a \u0111\u1ebfn \u0111\u01b0\u1ee3c: c\u1ee5 th\u1ec3, n\u00f3 gi\u1ea3m \u0111i $\\Delta$).</p> </li> </ul> <p>Do \u0111\u00f3, thu\u1eadt to\u00e1n c\u00f3 d\u1ea1ng sau: trong v\u00f2ng l\u1eb7p ngo\u00e0i, ch\u00fang ta xem x\u00e9t c\u00e1c h\u00e0ng ma tr\u1eadn t\u1eebng h\u00e0ng m\u1ed9t. M\u1ed7i h\u00e0ng \u0111\u01b0\u1ee3c x\u1eed l\u00fd trong th\u1eddi gian $\\mathcal{O}(n^2)$, v\u00ec ch\u1ec9 c\u00f3 $\\mathcal{O}(n)$ l\u1ea7n t\u00ednh to\u00e1n l\u1ea1i th\u1ebf n\u0103ng c\u00f3 th\u1ec3 x\u1ea3y ra (m\u1ed7i l\u1ea7n trong th\u1eddi gian $\\mathcal{O}(n)$), v\u00e0 m\u1ea3ng $minv$ \u0111\u01b0\u1ee3c duy tr\u00ec trong th\u1eddi gian $\\mathcal{O}(n^2)$; Thu\u1eadt to\u00e1n Kuhn s\u1ebd ho\u1ea1t \u0111\u1ed9ng trong th\u1eddi gian $\\mathcal{O}(n^2)$ (v\u00ec n\u00f3 \u0111\u01b0\u1ee3c tr\u00ecnh b\u00e0y d\u01b0\u1edbi d\u1ea1ng $\\mathcal{O}(n)$ l\u1ea7n l\u1eb7p, m\u1ed7i l\u1ea7n l\u1eb7p th\u0103m m\u1ed9t c\u1ed9t m\u1edbi).</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p k\u1ebft qu\u1ea3 l\u00e0 $\\mathcal{O}(n^3)$ ho\u1eb7c, n\u1ebfu b\u00e0i to\u00e1n l\u00e0 h\u00ecnh ch\u1eef nh\u1eadt, $\\mathcal{O}(n^2m)$.</p>","tags":["Translated"]},{"location":"graph/hungarian-algorithm.html#implementation-of-the-hungarian-algorithm","title":"C\u00e0i \u0111\u1eb7t thu\u1eadt to\u00e1n Hungary (Implementation of the Hungarian algorithm)","text":"<p>C\u00e0i \u0111\u1eb7t d\u01b0\u1edbi \u0111\u00e2y \u0111\u01b0\u1ee3c ph\u00e1t tri\u1ec3n b\u1edfi Andrey Lopatin v\u00e0i n\u0103m tr\u01b0\u1edbc. N\u00f3 \u0111\u01b0\u1ee3c ph\u00e2n bi\u1ec7t b\u1edfi s\u1ef1 ng\u1eafn g\u1ecdn \u0111\u00e1ng kinh ng\u1ea1c: to\u00e0n b\u1ed9 thu\u1eadt to\u00e1n bao g\u1ed3m 30 d\u00f2ng m\u00e3.</p> <p>C\u00e0i \u0111\u1eb7t t\u00ecm gi\u1ea3i ph\u00e1p cho ma tr\u1eadn ch\u1eef nh\u1eadt $A[1\\dots n][1\\dots m]$, trong \u0111\u00f3 $n\\leq m$. Ma tr\u1eadn d\u1ef1a tr\u00ean 1 thu\u1eadn ti\u1ec7n v\u00e0 ng\u1eafn g\u1ecdn m\u00e3: c\u00e0i \u0111\u1eb7t n\u00e0y gi\u1edbi thi\u1ec7u m\u1ed9t h\u00e0ng kh\u00f4ng gi\u1ea3 v\u00e0 c\u1ed9t kh\u00f4ng gi\u1ea3, cho ph\u00e9p ch\u00fang ta vi\u1ebft nhi\u1ec1u chu tr\u00ecnh \u1edf d\u1ea1ng t\u1ed5ng qu\u00e1t, m\u00e0 kh\u00f4ng c\u1ea7n ki\u1ec3m tra th\u00eam.</p> <p>C\u00e1c m\u1ea3ng $u[0 \\ldots n]$ v\u00e0 $v[0 \\ldots m]$ l\u01b0u tr\u1eef th\u1ebf n\u0103ng. Ban \u0111\u1ea7u, ch\u00fang \u0111\u01b0\u1ee3c \u0111\u1eb7t b\u1eb1ng 0, \u0111i\u1ec1u n\u00e0y ph\u00f9 h\u1ee3p v\u1edbi ma tr\u1eadn c\u00e1c h\u00e0ng 0 (L\u01b0u \u00fd r\u1eb1ng \u0111\u1ed1i v\u1edbi vi\u1ec7c c\u00e0i \u0111\u1eb7t n\u00e0y, vi\u1ec7c ma tr\u1eadn $A$ c\u00f3 ch\u1ee9a s\u1ed1 \u00e2m hay kh\u00f4ng l\u00e0 kh\u00f4ng quan tr\u1ecdng).</p> <p>M\u1ea3ng $p[0 \\ldots m]$ ch\u1ee9a m\u1ed9t c\u1eb7p gh\u00e9p: \u0111\u1ed1i v\u1edbi m\u1ed7i c\u1ed9t $j = 1 \\ldots m$, n\u00f3 l\u01b0u tr\u1eef s\u1ed1 $p[j]$ c\u1ee7a h\u00e0ng \u0111\u01b0\u1ee3c ch\u1ecdn (ho\u1eb7c $0$ n\u1ebfu ch\u01b0a c\u00f3 g\u00ec \u0111\u01b0\u1ee3c ch\u1ecdn). \u0110\u1ec3 thu\u1eadn ti\u1ec7n cho vi\u1ec7c c\u00e0i \u0111\u1eb7t, $p[0]$ \u0111\u01b0\u1ee3c gi\u1ea3 \u0111\u1ecbnh l\u00e0 b\u1eb1ng s\u1ed1 c\u1ee7a h\u00e0ng hi\u1ec7n t\u1ea1i.</p> <p>M\u1ea3ng $minv[1 \\ldots m]$ ch\u1ee9a, \u0111\u1ed1i v\u1edbi m\u1ed7i c\u1ed9t $j$, c\u00e1c c\u1ef1c ti\u1ec3u ph\u1ee5 tr\u1ee3 c\u1ea7n thi\u1ebft \u0111\u1ec3 t\u00ednh to\u00e1n l\u1ea1i nhanh th\u1ebf n\u0103ng, nh\u01b0 \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 \u1edf tr\u00ean.</p> <p>M\u1ea3ng $way[1 \\ldots m]$ ch\u1ee9a th\u00f4ng tin v\u1ec1 n\u01a1i c\u00e1c c\u1ef1c ti\u1ec3u n\u00e0y \u0111\u1ea1t \u0111\u01b0\u1ee3c \u0111\u1ec3 sau n\u00e0y ch\u00fang ta c\u00f3 th\u1ec3 kh\u00f4i ph\u1ee5c \u0111\u01b0\u1eddng t\u0103ng. L\u01b0u \u00fd r\u1eb1ng, \u0111\u1ec3 kh\u00f4i ph\u1ee5c \u0111\u01b0\u1eddng \u0111i, ch\u1ec9 c\u1ea7n l\u01b0u tr\u1eef c\u00e1c gi\u00e1 tr\u1ecb c\u1ed9t l\u00e0 \u0111\u1ee7, v\u00ec s\u1ed1 h\u00e0ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c l\u1ea5y t\u1eeb c\u1eb7p gh\u00e9p (t\u1ee9c l\u00e0 t\u1eeb m\u1ea3ng $p$). Do \u0111\u00f3, $way[j]$, \u0111\u1ed1i v\u1edbi m\u1ed7i c\u1ed9t $j$, ch\u1ee9a s\u1ed1 c\u1ee7a c\u1ed9t tr\u01b0\u1edbc \u0111\u00f3 trong \u0111\u01b0\u1eddng \u0111i (ho\u1eb7c $0$ n\u1ebfu kh\u00f4ng c\u00f3).</p> <p>B\u1ea3n th\u00e2n thu\u1eadt to\u00e1n l\u00e0 m\u1ed9t v\u00f2ng l\u1eb7p ngo\u00e0i qua c\u00e1c h\u00e0ng c\u1ee7a ma tr\u1eadn, b\u00ean trong \u0111\u00f3 h\u00e0ng th\u1ee9 $i$ c\u1ee7a ma tr\u1eadn \u0111\u01b0\u1ee3c xem x\u00e9t. V\u00f2ng l\u1eb7p do-while \u0111\u1ea7u ti\u00ean ch\u1ea1y cho \u0111\u1ebfn khi t\u00ecm th\u1ea5y m\u1ed9t c\u1ed9t t\u1ef1 do $j0$. M\u1ed7i l\u1ea7n l\u1eb7p c\u1ee7a v\u00f2ng l\u1eb7p \u0111\u00e1nh d\u1ea5u \u0111\u00e3 th\u0103m m\u1ed9t c\u1ed9t m\u1edbi v\u1edbi s\u1ed1 $j0$ (\u0111\u01b0\u1ee3c t\u00ednh to\u00e1n \u1edf l\u1ea7n l\u1eb7p cu\u1ed1i c\u00f9ng; v\u00e0 ban \u0111\u1ea7u b\u1eb1ng 0 - t\u1ee9c l\u00e0 ch\u00fang ta b\u1eaft \u0111\u1ea7u t\u1eeb m\u1ed9t c\u1ed9t gi\u1ea3), c\u0169ng nh\u01b0 m\u1ed9t h\u00e0ng m\u1edbi $i0$ - k\u1ec1 v\u1edbi n\u00f3 trong c\u1eb7p gh\u00e9p (t\u1ee9c l\u00e0 $p[j0]$; v\u00e0 ban \u0111\u1ea7u khi $j0=0$ h\u00e0ng th\u1ee9 $i$ \u0111\u01b0\u1ee3c l\u1ea5y). Do s\u1ef1 xu\u1ea5t hi\u1ec7n c\u1ee7a m\u1ed9t h\u00e0ng \u0111\u00e3 th\u0103m m\u1edbi $i0$, b\u1ea1n c\u1ea7n t\u00ednh to\u00e1n l\u1ea1i m\u1ea3ng $minv$ v\u00e0 $\\Delta$ t\u01b0\u01a1ng \u1ee9ng. N\u1ebfu $\\Delta$ \u0111\u01b0\u1ee3c c\u1eadp nh\u1eadt, th\u00ec c\u1ed9t $j1$ tr\u1edf th\u00e0nh c\u1ef1c ti\u1ec3u \u0111\u00e3 \u0111\u1ea1t \u0111\u01b0\u1ee3c (l\u01b0u \u00fd r\u1eb1ng v\u1edbi c\u00e0i \u0111\u1eb7t nh\u01b0 v\u1eady $\\Delta$ c\u00f3 th\u1ec3 b\u1eb1ng 0, \u0111i\u1ec1u \u0111\u00f3 c\u00f3 ngh\u0129a l\u00e0 th\u1ebf n\u0103ng kh\u00f4ng th\u1ec3 thay \u0111\u1ed5i \u1edf b\u01b0\u1edbc hi\u1ec7n t\u1ea1i: \u0111\u00e3 c\u00f3 m\u1ed9t c\u1ed9t c\u00f3 th\u1ec3 \u0111\u1ebfn \u0111\u01b0\u1ee3c m\u1edbi). Sau \u0111\u00f3, th\u1ebf n\u0103ng v\u00e0 m\u1ea3ng $minv$ \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n l\u1ea1i. \u1ede cu\u1ed1i v\u00f2ng l\u1eb7p \"do-while\", ch\u00fang ta \u0111\u00e3 t\u00ecm th\u1ea5y m\u1ed9t \u0111\u01b0\u1eddng t\u0103ng k\u1ebft th\u00fac b\u1eb1ng m\u1ed9t c\u1ed9t $j0$ c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c \"m\u1edf ra\" b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng m\u1ea3ng t\u1ed5 ti\u00ean $way$.</p> <p>H\u1eb1ng s\u1ed1 INF l\u00e0 \"v\u00f4 c\u00f9ng\", t\u1ee9c l\u00e0 m\u1ed9t s\u1ed1 n\u00e0o \u0111\u00f3, r\u00f5 r\u00e0ng l\u1edbn h\u01a1n t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 c\u00f3 th\u1ec3 c\u00f3 trong ma tr\u1eadn \u0111\u1ea7u v\u00e0o $A$.</p> <pre><code>vector&lt;int&gt; u (n+1), v (m+1), p (m+1), way (m+1);\nfor (int i=1; i&lt;=n; ++i) {\n    p[0] = i;\n    int j0 = 0;\n    vector&lt;int&gt; minv (m+1, INF);\n    vector&lt;bool&gt; used (m+1, false);\n    do {\n        used[j0] = true;\n        int i0 = p[j0],  delta = INF,  j1;\n        for (int j=1; j&lt;=m; ++j)\n            if (!used[j]) {\n                int cur = A[i0][j]-u[i0]-v[j];\n                if (cur &lt; minv[j])\n                    minv[j] = cur,  way[j] = j0;\n                if (minv[j] &lt; delta)\n                    delta = minv[j],  j1 = j;\n            }\n        for (int j=0; j&lt;=m; ++j)\n            if (used[j])\n                u[p[j]] += delta,  v[j] -= delta;\n            else\n                minv[j] -= delta;\n        j0 = j1;\n    } while (p[j0] != 0);\n    do {\n        int j1 = way[j0];\n        p[j0] = p[j1];\n        j0 = j1;\n    } while (j0);\n}\n</code></pre> <p>\u0110\u1ec3 kh\u00f4i ph\u1ee5c c\u00e2u tr\u1ea3 l\u1eddi \u1edf d\u1ea1ng quen thu\u1ed9c h\u01a1n, t\u1ee9c l\u00e0 t\u00ecm cho m\u1ed7i h\u00e0ng $i = 1 \\ldots n$ s\u1ed1 $ans[i]$ c\u1ee7a c\u1ed9t \u0111\u01b0\u1ee3c ch\u1ecdn trong \u0111\u00f3, c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n nh\u01b0 sau:</p> <pre><code>vector&lt;int&gt; ans (n+1);\nfor (int j=1; j&lt;=m; ++j)\n    ans[p[j]] = j;\n</code></pre> <p>Chi ph\u00ed c\u1ee7a c\u1eb7p gh\u00e9p c\u00f3 th\u1ec3 \u0111\u01a1n gi\u1ea3n \u0111\u01b0\u1ee3c l\u1ea5y l\u00e0m th\u1ebf n\u0103ng c\u1ee7a c\u1ed9t 0 (l\u1ea5y v\u1edbi d\u1ea5u ng\u01b0\u1ee3c l\u1ea1i). Th\u1eadt v\u1eady, nh\u01b0 b\u1ea1n c\u00f3 th\u1ec3 th\u1ea5y t\u1eeb m\u00e3, $-v[0]$ ch\u1ee9a t\u1ed5ng c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a $\\Delta$, t\u1ee9c l\u00e0 t\u1ed5ng thay \u0111\u1ed5i trong th\u1ebf n\u0103ng. M\u1eb7c d\u00f9 m\u1ed9t s\u1ed1 gi\u00e1 tr\u1ecb c\u1ee7a $u[i]$ v\u00e0 $v[j]$ c\u00f3 th\u1ec3 thay \u0111\u1ed5i c\u00f9ng m\u1ed9t l\u00fac, t\u1ed5ng thay \u0111\u1ed5i trong th\u1ebf n\u0103ng ch\u00ednh x\u00e1c b\u1eb1ng $\\Delta$, v\u00ec cho \u0111\u1ebfn khi c\u00f3 m\u1ed9t \u0111\u01b0\u1eddng t\u0103ng, s\u1ed1 l\u01b0\u1ee3ng h\u00e0ng c\u00f3 th\u1ec3 \u0111\u1ebfn \u0111\u01b0\u1ee3c nhi\u1ec1u h\u01a1n ch\u00ednh x\u00e1c m\u1ed9t so v\u1edbi s\u1ed1 l\u01b0\u1ee3ng c\u1ed9t c\u00f3 th\u1ec3 \u0111\u1ebfn \u0111\u01b0\u1ee3c (ch\u1ec9 c\u00f3 h\u00e0ng hi\u1ec7n t\u1ea1i $i$ kh\u00f4ng c\u00f3 m\u1ed9t \"c\u1eb7p\" d\u01b0\u1edbi d\u1ea1ng m\u1ed9t c\u1ed9t \u0111\u00e3 th\u0103m):</p> <pre><code>int cost = -v[0];\n</code></pre>","tags":["Translated"]},{"location":"graph/hungarian-algorithm.html#connection-to-the-successive-shortest-path-algorithm","title":"K\u1ebft n\u1ed1i v\u1edbi Thu\u1eadt to\u00e1n \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t li\u00ean ti\u1ebfp (Connection to the Successive Shortest Path Algorithm)","text":"<p>Thu\u1eadt to\u00e1n Hungary c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c coi l\u00e0 Thu\u1eadt to\u00e1n \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t li\u00ean ti\u1ebfp, \u0111\u01b0\u1ee3c \u0111i\u1ec1u ch\u1ec9nh cho b\u00e0i to\u00e1n ph\u00e2n c\u00f4ng. Kh\u00f4ng \u0111i s\u00e2u v\u00e0o chi ti\u1ebft, h\u00e3y cung c\u1ea5p m\u1ed9t tr\u1ef1c gi\u00e1c v\u1ec1 m\u1ed1i li\u00ean h\u1ec7 gi\u1eefa ch\u00fang.</p> <p>Thu\u1eadt to\u00e1n \u0111\u01b0\u1eddng \u0111i li\u00ean ti\u1ebfp s\u1eed d\u1ee5ng phi\u00ean b\u1ea3n s\u1eeda \u0111\u1ed5i c\u1ee7a thu\u1eadt to\u00e1n Johnson l\u00e0m k\u1ef9 thu\u1eadt \u0111\u00e1nh tr\u1ecdng s\u1ed1 l\u1ea1i. \u0110i\u1ec1u n\u00e0y \u0111\u01b0\u1ee3c chia th\u00e0nh b\u1ed1n b\u01b0\u1edbc:</p> <ul> <li>S\u1eed d\u1ee5ng thu\u1eadt to\u00e1n Bellman-Ford, b\u1eaft \u0111\u1ea7u t\u1eeb \u0111\u00edch $s$ v\u00e0, \u0111\u1ed1i v\u1edbi m\u1ed7i n\u00fat, t\u00ecm tr\u1ecdng s\u1ed1 t\u1ed1i thi\u1ec3u $h(v)$ c\u1ee7a m\u1ed9t \u0111\u01b0\u1eddng \u0111i t\u1eeb $s$ \u0111\u1ebfn $v$.</li> </ul> <p>Cho m\u1ed7i b\u01b0\u1edbc c\u1ee7a thu\u1eadt to\u00e1n ch\u00ednh:</p> <ul> <li>\u0110\u00e1nh tr\u1ecdng s\u1ed1 l\u1ea1i c\u00e1c c\u1ea1nh c\u1ee7a \u0111\u1ed3 th\u1ecb ban \u0111\u1ea7u theo c\u00e1ch n\u00e0y: $w(u,v) \\gets w(u,v)+h(u)-h(v)$.</li> <li>S\u1eed d\u1ee5ng thu\u1eadt to\u00e1n Dijkstra \u0111\u1ec3 t\u00ecm \u0111\u1ed3 th\u1ecb con \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t c\u1ee7a m\u1ea1ng ban \u0111\u1ea7u.</li> <li>C\u1eadp nh\u1eadt th\u1ebf n\u0103ng cho l\u1ea7n l\u1eb7p ti\u1ebfp theo.</li> </ul> <p>V\u1edbi m\u00f4 t\u1ea3 n\u00e0y, ch\u00fang ta c\u00f3 th\u1ec3 quan s\u00e1t th\u1ea5y r\u1eb1ng c\u00f3 m\u1ed9t s\u1ef1 t\u01b0\u01a1ng t\u1ef1 m\u1ea1nh m\u1ebd gi\u1eefa $h(v)$ v\u00e0 th\u1ebf n\u0103ng: c\u00f3 th\u1ec3 ki\u1ec3m tra xem ch\u00fang c\u00f3 b\u1eb1ng nhau hay kh\u00f4ng cho \u0111\u1ebfn m\u1ed9t h\u1eb1ng s\u1ed1 b\u00f9. Ngo\u00e0i ra, c\u00f3 th\u1ec3 ch\u1ec9 ra r\u1eb1ng, sau khi \u0111\u00e1nh tr\u1ecdng s\u1ed1 l\u1ea1i, t\u1eadp h\u1ee3p t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh c\u00f3 tr\u1ecdng s\u1ed1 b\u1eb1ng 0 \u0111\u1ea1i di\u1ec7n cho \u0111\u1ed3 th\u1ecb con \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t n\u01a1i thu\u1eadt to\u00e1n ch\u00ednh c\u1ed1 g\u1eafng t\u0103ng lu\u1ed3ng. \u0110i\u1ec1u n\u00e0y c\u0169ng x\u1ea3y ra trong thu\u1eadt to\u00e1n Hungary: ch\u00fang ta t\u1ea1o m\u1ed9t \u0111\u1ed3 th\u1ecb con \u0111\u01b0\u1ee3c l\u00e0m b\u1eb1ng c\u00e1c c\u1ea1nh c\u1ee9ng (nh\u1eefng c\u1ea1nh m\u00e0 l\u01b0\u1ee3ng $A[i][j]-u[i]-v[j]$ b\u1eb1ng 0), v\u00e0 ch\u00fang ta c\u1ed1 g\u1eafng t\u0103ng k\u00edch th\u01b0\u1edbc c\u1ee7a c\u1eb7p gh\u00e9p.</p> <p>Trong b\u01b0\u1edbc 4, t\u1ea5t c\u1ea3 $h(v)$ \u0111\u01b0\u1ee3c c\u1eadp nh\u1eadt: m\u1ed7i l\u1ea7n ch\u00fang ta s\u1eeda \u0111\u1ed5i m\u1ea1ng lu\u1ed3ng, ch\u00fang ta n\u00ean \u0111\u1ea3m b\u1ea3o r\u1eb1ng kho\u1ea3ng c\u00e1ch t\u1eeb ngu\u1ed3n l\u00e0 ch\u00ednh x\u00e1c (ng\u01b0\u1ee3c l\u1ea1i, trong l\u1ea7n l\u1eb7p ti\u1ebfp theo, thu\u1eadt to\u00e1n Dijkstra c\u00f3 th\u1ec3 th\u1ea5t b\u1ea1i). \u0110i\u1ec1u n\u00e0y nghe gi\u1ed1ng nh\u01b0 b\u1ea3n c\u1eadp nh\u1eadt \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n tr\u00ean c\u00e1c th\u1ebf n\u0103ng, nh\u01b0ng trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, ch\u00fang kh\u00f4ng \u0111\u01b0\u1ee3c t\u0103ng \u0111\u1ec1u.</p> <p>\u0110\u1ec3 hi\u1ec3u s\u00e2u h\u01a1n v\u1ec1 th\u1ebf n\u0103ng, h\u00e3y tham kh\u1ea3o b\u00e0i vi\u1ebft n\u00e0y.</p>","tags":["Translated"]},{"location":"graph/kirchhoff-theorem.html","title":"\u0110\u1ecbnh l\u00fd Kirchhoff. T\u00ecm s\u1ed1 l\u01b0\u1ee3ng c\u00e2y khung (Kirchhoff's theorem. Finding the number of spanning trees)","text":"<p>B\u00e0i to\u00e1n: B\u1ea1n \u0111\u01b0\u1ee3c cho m\u1ed9t \u0111\u1ed3 th\u1ecb v\u00f4 h\u01b0\u1edbng li\u00ean th\u00f4ng (c\u00f3 th\u1ec3 c\u00f3 nhi\u1ec1u c\u1ea1nh) \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n b\u1eb1ng ma tr\u1eadn k\u1ec1. T\u00ecm s\u1ed1 l\u01b0\u1ee3ng c\u00e2y khung kh\u00e1c nhau c\u1ee7a \u0111\u1ed3 th\u1ecb n\u00e0y.</p> <p>C\u00f4ng th\u1ee9c sau \u0111\u00e2y \u0111\u00e3 \u0111\u01b0\u1ee3c ch\u1ee9ng minh b\u1edfi Kirchhoff v\u00e0o n\u0103m 1847.</p>","tags":["Translated"]},{"location":"graph/kirchhoff-theorem.html#kirchhoffs-matrix-tree-theorem","title":"\u0110\u1ecbnh l\u00fd ma tr\u1eadn c\u00e2y Kirchhoff (Kirchhoff's matrix tree theorem)","text":"<p>G\u1ecdi $A$ l\u00e0 ma tr\u1eadn k\u1ec1 c\u1ee7a \u0111\u1ed3 th\u1ecb: $A_{u,v}$ l\u00e0 s\u1ed1 l\u01b0\u1ee3ng c\u1ea1nh gi\u1eefa $u$ v\u00e0 $v$. G\u1ecdi $D$ l\u00e0 ma tr\u1eadn b\u1eadc c\u1ee7a \u0111\u1ed3 th\u1ecb: m\u1ed9t ma tr\u1eadn \u0111\u01b0\u1eddng ch\u00e9o v\u1edbi $D_{u,u}$ l\u00e0 b\u1eadc c\u1ee7a \u0111\u1ec9nh $u$ (bao g\u1ed3m c\u1ea3 nhi\u1ec1u c\u1ea1nh v\u00e0 v\u00f2ng l\u1eb7p - c\u00e1c c\u1ea1nh n\u1ed1i \u0111\u1ec9nh $u$ v\u1edbi ch\u00ednh n\u00f3).</p> <p>Ma tr\u1eadn Laplacian c\u1ee7a \u0111\u1ed3 th\u1ecb \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a l\u00e0 $L = D - A$. Theo \u0111\u1ecbnh l\u00fd Kirchhoff, t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n b\u00f9 \u0111\u1ea1i s\u1ed1 (cofactors) c\u1ee7a ma tr\u1eadn n\u00e0y \u0111\u1ec1u b\u1eb1ng nhau, v\u00e0 ch\u00fang b\u1eb1ng s\u1ed1 l\u01b0\u1ee3ng c\u00e2y khung c\u1ee7a \u0111\u1ed3 th\u1ecb. Ph\u1ea7n b\u00f9 \u0111\u1ea1i s\u1ed1 $(i,j)$ c\u1ee7a m\u1ed9t ma tr\u1eadn l\u00e0 t\u00edch c\u1ee7a $(-1)^{i + j}$ v\u1edbi \u0111\u1ecbnh th\u1ee9c c\u1ee7a ma tr\u1eadn m\u00e0 b\u1ea1n nh\u1eadn \u0111\u01b0\u1ee3c sau khi lo\u1ea1i b\u1ecf h\u00e0ng th\u1ee9 $i$ v\u00e0 c\u1ed9t th\u1ee9 $j$. V\u00ec v\u1eady, b\u1ea1n c\u00f3 th\u1ec3, v\u00ed d\u1ee5, x\u00f3a h\u00e0ng cu\u1ed1i c\u00f9ng v\u00e0 c\u1ed9t cu\u1ed1i c\u00f9ng c\u1ee7a ma tr\u1eadn $L$, v\u00e0 gi\u00e1 tr\u1ecb tuy\u1ec7t \u0111\u1ed1i c\u1ee7a \u0111\u1ecbnh th\u1ee9c c\u1ee7a ma tr\u1eadn k\u1ebft qu\u1ea3 s\u1ebd cho b\u1ea1n s\u1ed1 l\u01b0\u1ee3ng c\u00e2y khung.</p> <p>\u0110\u1ecbnh th\u1ee9c c\u1ee7a ma tr\u1eadn c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y trong $O(N^3)$ b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng ph\u01b0\u01a1ng ph\u00e1p Gaussian.</p> <p>Ch\u1ee9ng minh \u0111\u1ecbnh l\u00fd n\u00e0y kh\u00e1 kh\u00f3 v\u00e0 kh\u00f4ng \u0111\u01b0\u1ee3c tr\u00ecnh b\u00e0y \u1edf \u0111\u00e2y; \u0111\u1ec3 bi\u1ebft ph\u00e1c th\u1ea3o ch\u1ee9ng minh v\u00e0 c\u00e1c bi\u1ebfn th\u1ec3 c\u1ee7a \u0111\u1ecbnh l\u00fd cho \u0111\u1ed3 th\u1ecb kh\u00f4ng c\u00f3 nhi\u1ec1u c\u1ea1nh v\u00e0 cho \u0111\u1ed3 th\u1ecb c\u00f3 h\u01b0\u1edbng, h\u00e3y tham kh\u1ea3o Wikipedia.</p>","tags":["Translated"]},{"location":"graph/kirchhoff-theorem.html#relation-to-kirchhoffs-circuit-laws","title":"Quan h\u1ec7 v\u1edbi c\u00e1c \u0111\u1ecbnh lu\u1eadt m\u1ea1ch Kirchhoff (Relation to Kirchhoff's circuit laws)","text":"<p>\u0110\u1ecbnh l\u00fd ma tr\u1eadn c\u00e2y Kirchhoff v\u00e0 c\u00e1c \u0111\u1ecbnh lu\u1eadt Kirchhoff cho m\u1ea1ch \u0111i\u1ec7n c\u00f3 quan h\u1ec7 theo m\u1ed9t c\u00e1ch \u0111\u1eb9p \u0111\u1ebd. C\u00f3 th\u1ec3 ch\u1ec9 ra (s\u1eed d\u1ee5ng \u0111\u1ecbnh lu\u1eadt Ohm v\u00e0 \u0111\u1ecbnh lu\u1eadt Kirchhoff th\u1ee9 nh\u1ea5t) r\u1eb1ng \u0111i\u1ec7n tr\u1edf $R_{ij}$ gi\u1eefa hai \u0111i\u1ec3m c\u1ee7a m\u1ea1ch $i$ v\u00e0 $j$ l\u00e0</p> $$R_{ij} = \\frac{ \\left| L^{(i,j)} \\right| }{ | L^j | }.$$ <p>\u1ede \u0111\u00e2y ma tr\u1eadn $L$ thu \u0111\u01b0\u1ee3c t\u1eeb ma tr\u1eadn \u0111i\u1ec7n tr\u1edf ngh\u1ecbch \u0111\u1ea3o $A$ ($A_{i,j}$ l\u00e0 ngh\u1ecbch \u0111\u1ea3o c\u1ee7a \u0111i\u1ec7n tr\u1edf c\u1ee7a d\u00e2y d\u1eabn gi\u1eefa c\u00e1c \u0111i\u1ec3m $i$ v\u00e0 $j$) b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng quy tr\u00ecnh \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 trong \u0111\u1ecbnh l\u00fd ma tr\u1eadn c\u00e2y Kirchhoff. $T^j$ l\u00e0 ma tr\u1eadn v\u1edbi h\u00e0ng v\u00e0 c\u1ed9t $j$ b\u1ecb lo\u1ea1i b\u1ecf, $T^{(i,j)}$ l\u00e0 ma tr\u1eadn v\u1edbi hai h\u00e0ng v\u00e0 hai c\u1ed9t $i$ v\u00e0 $j$ b\u1ecb lo\u1ea1i b\u1ecf.</p> <p>\u0110\u1ecbnh l\u00fd Kirchhoff mang l\u1ea1i cho c\u00f4ng th\u1ee9c n\u00e0y \u00fd ngh\u0129a h\u00ecnh h\u1ecdc.</p>","tags":["Translated"]},{"location":"graph/kirchhoff-theorem.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>CODECHEF: Roads in Stars</li> <li>SPOJ: Maze</li> <li>CODECHEF: Complement Spanning Trees</li> </ul>","tags":["Translated"]},{"location":"graph/kuhn_maximum_bipartite_matching.html","title":"Thu\u1eadt to\u00e1n Kuhn cho C\u1eb7p gh\u00e9p c\u1ef1c \u0111\u1ea1i tr\u00ean \u0111\u1ed3 th\u1ecb hai ph\u00eda (Kuhn's Algorithm for Maximum Bipartite Matching)","text":"","tags":["Translated"]},{"location":"graph/kuhn_maximum_bipartite_matching.html#problem","title":"B\u00e0i to\u00e1n (Problem)","text":"<p>B\u1ea1n \u0111\u01b0\u1ee3c cho m\u1ed9t \u0111\u1ed3 th\u1ecb hai ph\u00eda $G$ ch\u1ee9a $n$ \u0111\u1ec9nh v\u00e0 $m$ c\u1ea1nh. T\u00ecm c\u1eb7p gh\u00e9p c\u1ef1c \u0111\u1ea1i, t\u1ee9c l\u00e0 ch\u1ecdn c\u00e0ng nhi\u1ec1u c\u1ea1nh c\u00e0ng t\u1ed1t sao cho kh\u00f4ng c\u00f3 c\u1ea1nh n\u00e0o \u0111\u01b0\u1ee3c ch\u1ecdn chia s\u1ebb m\u1ed9t \u0111\u1ec9nh v\u1edbi b\u1ea5t k\u1ef3 c\u1ea1nh n\u00e0o \u0111\u01b0\u1ee3c ch\u1ecdn kh\u00e1c.</p>","tags":["Translated"]},{"location":"graph/kuhn_maximum_bipartite_matching.html#algorithm-description","title":"M\u00f4 t\u1ea3 thu\u1eadt to\u00e1n (Algorithm Description)","text":"","tags":["Translated"]},{"location":"graph/kuhn_maximum_bipartite_matching.html#required-definitions","title":"C\u00e1c \u0111\u1ecbnh ngh\u0129a c\u1ea7n thi\u1ebft (Required Definitions)","text":"<ul> <li>M\u1ed9t c\u1eb7p gh\u00e9p (matching) $M$ l\u00e0 m\u1ed9t t\u1eadp h\u1ee3p c\u00e1c c\u1ea1nh kh\u00f4ng k\u1ec1 nhau t\u1eebng \u0111\u00f4i m\u1ed9t c\u1ee7a m\u1ed9t \u0111\u1ed3 th\u1ecb (n\u00f3i c\u00e1ch kh\u00e1c, kh\u00f4ng qu\u00e1 m\u1ed9t c\u1ea1nh t\u1eeb t\u1eadp h\u1ee3p n\u00e0y k\u1ec1 v\u1edbi b\u1ea5t k\u1ef3 \u0111\u1ec9nh n\u00e0o c\u1ee7a \u0111\u1ed3 th\u1ecb $M$).</li> <li>L\u1ef1c l\u01b0\u1ee3ng (cardinality) c\u1ee7a m\u1ed9t c\u1eb7p gh\u00e9p l\u00e0 s\u1ed1 l\u01b0\u1ee3ng c\u1ea1nh trong \u0111\u00f3.</li> <li> <p>T\u1ea5t c\u1ea3 nh\u1eefng \u0111\u1ec9nh c\u00f3 m\u1ed9t c\u1ea1nh k\u1ec1 t\u1eeb c\u1eb7p gh\u00e9p (t\u1ee9c l\u00e0 c\u00f3 b\u1eadc ch\u00ednh x\u00e1c l\u00e0 m\u1ed9t trong \u0111\u1ed3 th\u1ecb con \u0111\u01b0\u1ee3c t\u1ea1o b\u1edfi $M$) \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 b\u00e3o h\u00f2a (saturated) b\u1edfi c\u1eb7p gh\u00e9p n\u00e0y.</p> </li> <li> <p>M\u1ed9t c\u1eb7p gh\u00e9p t\u1ed1i \u0111\u1ea1i (maximal matching) l\u00e0 m\u1ed9t c\u1eb7p gh\u00e9p $M$ c\u1ee7a \u0111\u1ed3 th\u1ecb $G$ m\u00e0 kh\u00f4ng ph\u1ea3i l\u00e0 t\u1eadp con c\u1ee7a b\u1ea5t k\u1ef3 c\u1eb7p gh\u00e9p n\u00e0o kh\u00e1c.</p> </li> <li> <p>M\u1ed9t c\u1eb7p gh\u00e9p c\u1ef1c \u0111\u1ea1i (maximum matching) (hay c\u00f2n g\u1ecdi l\u00e0 c\u1eb7p gh\u00e9p c\u00f3 l\u1ef1c l\u01b0\u1ee3ng c\u1ef1c \u0111\u1ea1i) l\u00e0 m\u1ed9t c\u1eb7p gh\u00e9p ch\u1ee9a s\u1ed1 l\u01b0\u1ee3ng c\u1ea1nh l\u1edbn nh\u1ea5t c\u00f3 th\u1ec3. M\u1ecdi c\u1eb7p gh\u00e9p c\u1ef1c \u0111\u1ea1i \u0111\u1ec1u l\u00e0 c\u1eb7p gh\u00e9p t\u1ed1i \u0111\u1ea1i.</p> </li> <li> <p>M\u1ed9t \u0111\u01b0\u1eddng \u0111i (path) c\u00f3 \u0111\u1ed9 d\u00e0i $k$ \u1edf \u0111\u00e2y c\u00f3 ngh\u0129a l\u00e0 m\u1ed9t \u0111\u01b0\u1eddng \u0111i \u0111\u01a1n (t\u1ee9c l\u00e0 kh\u00f4ng ch\u1ee9a c\u00e1c \u0111\u1ec9nh ho\u1eb7c c\u1ea1nh l\u1eb7p l\u1ea1i) ch\u1ee9a $k$ c\u1ea1nh, tr\u1eeb khi c\u00f3 quy \u0111\u1ecbnh kh\u00e1c.</p> </li> <li> <p>M\u1ed9t \u0111\u01b0\u1eddng m\u1edf (alternating path) (trong \u0111\u1ed3 th\u1ecb hai ph\u00eda, \u0111\u1ed1i v\u1edbi m\u1ed9t c\u1eb7p gh\u00e9p n\u00e0o \u0111\u00f3) l\u00e0 m\u1ed9t \u0111\u01b0\u1eddng \u0111i trong \u0111\u00f3 c\u00e1c c\u1ea1nh lu\u00e2n phi\u00ean thu\u1ed9c v\u1ec1 / kh\u00f4ng thu\u1ed9c v\u1ec1 c\u1eb7p gh\u00e9p.</p> </li> <li> <p>M\u1ed9t \u0111\u01b0\u1eddng t\u0103ng (augmenting path) (trong \u0111\u1ed3 th\u1ecb hai ph\u00eda, \u0111\u1ed1i v\u1edbi m\u1ed9t c\u1eb7p gh\u00e9p n\u00e0o \u0111\u00f3) l\u00e0 m\u1ed9t \u0111\u01b0\u1eddng m\u1edf c\u00f3 c\u00e1c \u0111\u1ec9nh \u0111\u1ea7u v\u00e0 cu\u1ed1i kh\u00f4ng b\u00e3o h\u00f2a, t\u1ee9c l\u00e0 ch\u00fang kh\u00f4ng thu\u1ed9c v\u1ec1 c\u1eb7p gh\u00e9p.</p> </li> <li> <p>Hi\u1ec7u \u0111\u1ed1i x\u1ee9ng (symmetric difference) (c\u00f2n \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 h\u1ee3p r\u1eddi) c\u1ee7a c\u00e1c t\u1eadp h\u1ee3p $A$ v\u00e0 $B$, \u0111\u01b0\u1ee3c bi\u1ec3u th\u1ecb b\u1eb1ng $A \\oplus B$, l\u00e0 t\u1eadp h\u1ee3p c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed thu\u1ed9c v\u1ec1 ch\u00ednh x\u00e1c m\u1ed9t trong $A$ ho\u1eb7c $B$, nh\u01b0ng kh\u00f4ng thu\u1ed9c v\u1ec1 c\u1ea3 hai. T\u1ee9c l\u00e0, $A \\oplus B = (A - B) \\cup (B - A) = (A \\cup B) - (A \\cap B)$.</p> </li> </ul>","tags":["Translated"]},{"location":"graph/kuhn_maximum_bipartite_matching.html#berges-lemma","title":"B\u1ed5 \u0111\u1ec1 Berge (Berge's lemma)","text":"<p>B\u1ed5 \u0111\u1ec1 n\u00e0y \u0111\u00e3 \u0111\u01b0\u1ee3c ch\u1ee9ng minh b\u1edfi nh\u00e0 to\u00e1n h\u1ecdc ng\u01b0\u1eddi Ph\u00e1p Claude Berge v\u00e0o n\u0103m 1957, m\u1eb7c d\u00f9 n\u00f3 \u0111\u00e3 \u0111\u01b0\u1ee3c quan s\u00e1t b\u1edfi nh\u00e0 to\u00e1n h\u1ecdc ng\u01b0\u1eddi \u0110an M\u1ea1ch Julius Petersen v\u00e0o n\u0103m 1891 v\u00e0 nh\u00e0 to\u00e1n h\u1ecdc ng\u01b0\u1eddi Hungary Den\u00e9s K\u0151nig v\u00e0o n\u0103m 1931.</p>","tags":["Translated"]},{"location":"graph/kuhn_maximum_bipartite_matching.html#formulation","title":"Ph\u00e1t bi\u1ec3u (Formulation)","text":"<p>M\u1ed9t c\u1eb7p gh\u00e9p $M$ l\u00e0 c\u1ef1c \u0111\u1ea1i $\\Leftrightarrow$ kh\u00f4ng c\u00f3 \u0111\u01b0\u1eddng t\u0103ng n\u00e0o li\u00ean quan \u0111\u1ebfn c\u1eb7p gh\u00e9p $M$.</p>","tags":["Translated"]},{"location":"graph/kuhn_maximum_bipartite_matching.html#proof","title":"Ch\u1ee9ng minh (Proof)","text":"<p>C\u1ea3 hai v\u1ebf c\u1ee7a ph\u00e9p t\u01b0\u01a1ng \u0111\u01b0\u01a1ng s\u1ebd \u0111\u01b0\u1ee3c ch\u1ee9ng minh b\u1eb1ng ph\u1ea3n ch\u1ee9ng.</p> <ol> <li> <p>M\u1ed9t c\u1eb7p gh\u00e9p $M$ l\u00e0 c\u1ef1c \u0111\u1ea1i $\\Rightarrow$ kh\u00f4ng c\u00f3 \u0111\u01b0\u1eddng t\u0103ng n\u00e0o li\u00ean quan \u0111\u1ebfn c\u1eb7p gh\u00e9p $M$.</p> <p>Gi\u1ea3 s\u1eed c\u00f3 m\u1ed9t \u0111\u01b0\u1eddng t\u0103ng $P$ li\u00ean quan \u0111\u1ebfn c\u1eb7p gh\u00e9p c\u1ef1c \u0111\u1ea1i \u0111\u00e3 cho $M$. \u0110\u01b0\u1eddng t\u0103ng $P$ n\u00e0y nh\u1ea5t thi\u1ebft ph\u1ea3i c\u00f3 \u0111\u1ed9 d\u00e0i l\u1ebb, c\u00f3 nhi\u1ec1u h\u01a1n m\u1ed9t c\u1ea1nh kh\u00f4ng n\u1eb1m trong $M$ so v\u1edbi s\u1ed1 c\u1ea1nh c\u1ee7a n\u00f3 c\u0169ng n\u1eb1m trong $M$. Ch\u00fang ta t\u1ea1o m\u1ed9t c\u1eb7p gh\u00e9p m\u1edbi $M'$ b\u1eb1ng c\u00e1ch bao g\u1ed3m t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh trong c\u1eb7p gh\u00e9p ban \u0111\u1ea7u $M$ ngo\u1ea1i tr\u1eeb nh\u1eefng c\u1ea1nh c\u0169ng n\u1eb1m trong $P$, v\u00e0 c\u00e1c c\u1ea1nh trong $P$ kh\u00f4ng n\u1eb1m trong $M$. \u0110\u00e2y l\u00e0 m\u1ed9t c\u1eb7p gh\u00e9p h\u1ee3p l\u1ec7 v\u00ec c\u00e1c \u0111\u1ec9nh \u0111\u1ea7u v\u00e0 cu\u1ed1i c\u1ee7a $P$ kh\u00f4ng \u0111\u01b0\u1ee3c b\u00e3o h\u00f2a b\u1edfi $M$, v\u00e0 c\u00e1c \u0111\u1ec9nh c\u00f2n l\u1ea1i ch\u1ec9 \u0111\u01b0\u1ee3c b\u00e3o h\u00f2a b\u1edfi c\u1eb7p gh\u00e9p $P \\cap M$. C\u1eb7p gh\u00e9p m\u1edbi $M'$ n\u00e0y s\u1ebd c\u00f3 nhi\u1ec1u h\u01a1n m\u1ed9t c\u1ea1nh so v\u1edbi $M$, v\u00e0 do \u0111\u00f3 $M$ kh\u00f4ng th\u1ec3 l\u00e0 c\u1ef1c \u0111\u1ea1i.</p> <p>M\u1ed9t c\u00e1ch ch\u00ednh th\u1ee9c, v\u1edbi m\u1ed9t \u0111\u01b0\u1eddng t\u0103ng $P$ so v\u1edbi m\u1ed9t c\u1eb7p gh\u00e9p c\u1ef1c \u0111\u1ea1i $M$ n\u00e0o \u0111\u00f3, c\u1eb7p gh\u00e9p $M' = P \\oplus M$ l\u00e0 sao cho $|M'| = |M| + 1$, m\u1ed9t m\u00e2u thu\u1eabn.</p> </li> <li> <p>M\u1ed9t c\u1eb7p gh\u00e9p $M$ l\u00e0 c\u1ef1c \u0111\u1ea1i $\\Leftarrow$ kh\u00f4ng c\u00f3 \u0111\u01b0\u1eddng t\u0103ng n\u00e0o li\u00ean quan \u0111\u1ebfn c\u1eb7p gh\u00e9p $M$.</p> <p>Gi\u1ea3 s\u1eed c\u00f3 m\u1ed9t c\u1eb7p gh\u00e9p $M'$ c\u00f3 l\u1ef1c l\u01b0\u1ee3ng l\u1edbn h\u01a1n $M$. Ch\u00fang ta xem x\u00e9t hi\u1ec7u \u0111\u1ed1i x\u1ee9ng $Q = M \\oplus M'$. \u0110\u1ed3 th\u1ecb con $Q$ kh\u00f4ng c\u00f2n nh\u1ea5t thi\u1ebft ph\u1ea3i l\u00e0 m\u1ed9t c\u1eb7p gh\u00e9p. B\u1ea5t k\u1ef3 \u0111\u1ec9nh n\u00e0o trong $Q$ \u0111\u1ec1u c\u00f3 b\u1eadc t\u1ed1i \u0111a l\u00e0 $2$, c\u00f3 ngh\u0129a l\u00e0 t\u1ea5t c\u1ea3 c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng trong n\u00f3 l\u00e0 m\u1ed9t trong ba lo\u1ea1i -</p> <ul> <li>m\u1ed9t \u0111\u1ec9nh c\u00f4 l\u1eadp</li> <li>m\u1ed9t \u0111\u01b0\u1eddng \u0111i (\u0111\u01a1n) c\u00f3 c\u00e1c c\u1ea1nh lu\u00e2n phi\u00ean t\u1eeb $M$ v\u00e0 $M'$</li> <li>m\u1ed9t chu tr\u00ecnh c\u00f3 \u0111\u1ed9 d\u00e0i ch\u1eb5n c\u00f3 c\u00e1c c\u1ea1nh lu\u00e2n phi\u00ean t\u1eeb $M$ v\u00e0 $M'$</li> </ul> <p>V\u00ec $M'$ c\u00f3 l\u1ef1c l\u01b0\u1ee3ng l\u1edbn h\u01a1n $M$, $Q$ c\u00f3 nhi\u1ec1u c\u1ea1nh t\u1eeb $M'$ h\u01a1n $M$. Theo nguy\u00ean l\u00fd Pigeonhole, \u00edt nh\u1ea5t m\u1ed9t th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng s\u1ebd l\u00e0 m\u1ed9t \u0111\u01b0\u1eddng \u0111i c\u00f3 nhi\u1ec1u c\u1ea1nh t\u1eeb $M'$ h\u01a1n $M$. V\u00ec b\u1ea5t k\u1ef3 \u0111\u01b0\u1eddng \u0111i n\u00e0o nh\u01b0 v\u1eady \u0111\u1ec1u l\u00e0 \u0111\u01b0\u1eddng m\u1edf, n\u00ean n\u00f3 s\u1ebd c\u00f3 c\u00e1c \u0111\u1ec9nh \u0111\u1ea7u v\u00e0 cu\u1ed1i kh\u00f4ng \u0111\u01b0\u1ee3c b\u00e3o h\u00f2a b\u1edfi $M$, l\u00e0m cho n\u00f3 tr\u1edf th\u00e0nh m\u1ed9t \u0111\u01b0\u1eddng t\u0103ng cho $M$, \u0111i\u1ec1u n\u00e0y m\u00e2u thu\u1eabn v\u1edbi ti\u1ec1n \u0111\u1ec1. \u2002 $\\blacksquare$</p> </li> </ol>","tags":["Translated"]},{"location":"graph/kuhn_maximum_bipartite_matching.html#kuhns-algorithm","title":"Thu\u1eadt to\u00e1n Kuhn (Kuhn's algorithm)","text":"<p>Thu\u1eadt to\u00e1n Kuhn l\u00e0 m\u1ed9t \u1ee9ng d\u1ee5ng tr\u1ef1c ti\u1ebfp c\u1ee7a b\u1ed5 \u0111\u1ec1 Berge. V\u1ec1 c\u01a1 b\u1ea3n n\u00f3 \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 nh\u01b0 sau:</p> <p>\u0110\u1ea7u ti\u00ean, ch\u00fang ta l\u1ea5y m\u1ed9t c\u1eb7p gh\u00e9p r\u1ed7ng. Sau \u0111\u00f3, trong khi thu\u1eadt to\u00e1n c\u00f3 th\u1ec3 t\u00ecm th\u1ea5y m\u1ed9t \u0111\u01b0\u1eddng t\u0103ng, ch\u00fang ta c\u1eadp nh\u1eadt c\u1eb7p gh\u00e9p b\u1eb1ng c\u00e1ch lu\u00e2n phi\u00ean n\u00f3 d\u1ecdc theo \u0111\u01b0\u1eddng \u0111i n\u00e0y v\u00e0 l\u1eb7p l\u1ea1i qu\u00e1 tr\u00ecnh t\u00ecm \u0111\u01b0\u1eddng t\u0103ng. Ngay khi kh\u00f4ng th\u1ec3 t\u00ecm th\u1ea5y m\u1ed9t \u0111\u01b0\u1eddng \u0111i nh\u01b0 v\u1eady, ch\u00fang ta d\u1eebng qu\u00e1 tr\u00ecnh - c\u1eb7p gh\u00e9p hi\u1ec7n t\u1ea1i l\u00e0 c\u1ef1c \u0111\u1ea1i.</p> <p>V\u1eabn c\u00f2n ph\u1ea3i tr\u00ecnh b\u00e0y chi ti\u1ebft c\u00e1ch t\u00ecm c\u00e1c \u0111\u01b0\u1eddng t\u0103ng. Thu\u1eadt to\u00e1n Kuhn ch\u1ec9 \u0111\u01a1n gi\u1ea3n l\u00e0 t\u00ecm ki\u1ebfm b\u1ea5t k\u1ef3 \u0111\u01b0\u1eddng \u0111i n\u00e0o trong s\u1ed1 n\u00e0y b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng duy\u1ec7t theo chi\u1ec1u s\u00e2u ho\u1eb7c theo chi\u1ec1u r\u1ed9ng. Thu\u1eadt to\u00e1n l\u1ea7n l\u01b0\u1ee3t xem x\u00e9t t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh c\u1ee7a \u0111\u1ed3 th\u1ecb, b\u1eaft \u0111\u1ea7u m\u1ed7i l\u1ea7n duy\u1ec7t t\u1eeb n\u00f3, c\u1ed1 g\u1eafng t\u00ecm m\u1ed9t \u0111\u01b0\u1eddng t\u0103ng b\u1eaft \u0111\u1ea7u t\u1ea1i \u0111\u1ec9nh n\u00e0y.</p> <p>Thu\u1eadt to\u00e1n thu\u1eadn ti\u1ec7n h\u01a1n \u0111\u1ec3 m\u00f4 t\u1ea3 n\u1ebfu ch\u00fang ta gi\u1ea3 s\u1eed r\u1eb1ng \u0111\u1ed3 th\u1ecb \u0111\u1ea7u v\u00e0o \u0111\u00e3 \u0111\u01b0\u1ee3c chia th\u00e0nh hai ph\u1ea7n (m\u1eb7c d\u00f9, tr\u00ean th\u1ef1c t\u1ebf, thu\u1eadt to\u00e1n c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c c\u00e0i \u0111\u1eb7t theo c\u00e1ch m\u00e0 \u0111\u1ed3 th\u1ecb \u0111\u1ea7u v\u00e0o kh\u00f4ng \u0111\u01b0\u1ee3c chia r\u00f5 r\u00e0ng th\u00e0nh hai ph\u1ea7n).</p> <p>Thu\u1eadt to\u00e1n xem x\u00e9t t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh $v$ c\u1ee7a ph\u1ea7n \u0111\u1ea7u ti\u00ean c\u1ee7a \u0111\u1ed3 th\u1ecb: $v = 1 \\ldots n_1$. N\u1ebfu \u0111\u1ec9nh hi\u1ec7n t\u1ea1i $v$ \u0111\u00e3 \u0111\u01b0\u1ee3c b\u00e3o h\u00f2a v\u1edbi c\u1eb7p gh\u00e9p hi\u1ec7n t\u1ea1i (t\u1ee9c l\u00e0, m\u1ed9t s\u1ed1 c\u1ea1nh k\u1ec1 v\u1edbi n\u00f3 \u0111\u00e3 \u0111\u01b0\u1ee3c ch\u1ecdn), th\u00ec b\u1ecf qua \u0111\u1ec9nh n\u00e0y. Ng\u01b0\u1ee3c l\u1ea1i, thu\u1eadt to\u00e1n c\u1ed1 g\u1eafng b\u00e3o h\u00f2a \u0111\u1ec9nh n\u00e0y, b\u1eb1ng c\u00e1ch b\u1eaft \u0111\u1ea7u t\u00ecm ki\u1ebfm m\u1ed9t \u0111\u01b0\u1eddng t\u0103ng b\u1eaft \u0111\u1ea7u t\u1eeb \u0111\u1ec9nh n\u00e0y.</p> <p>Vi\u1ec7c t\u00ecm ki\u1ebfm m\u1ed9t \u0111\u01b0\u1eddng t\u0103ng \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng duy\u1ec7t theo chi\u1ec1u s\u00e2u ho\u1eb7c chi\u1ec1u r\u1ed9ng \u0111\u1eb7c bi\u1ec7t (th\u01b0\u1eddng duy\u1ec7t theo chi\u1ec1u s\u00e2u \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 d\u1ec5 c\u00e0i \u0111\u1eb7t). Ban \u0111\u1ea7u, duy\u1ec7t theo chi\u1ec1u s\u00e2u \u1edf t\u1ea1i \u0111\u1ec9nh ch\u01b0a b\u00e3o h\u00f2a hi\u1ec7n t\u1ea1i $v$ c\u1ee7a ph\u1ea7n \u0111\u1ea7u ti\u00ean. H\u00e3y xem qua t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh t\u1eeb \u0111\u1ec9nh n\u00e0y. Gi\u1ea3 s\u1eed c\u1ea1nh hi\u1ec7n t\u1ea1i l\u00e0 m\u1ed9t c\u1ea1nh $(v, to)$. N\u1ebfu \u0111\u1ec9nh $to$ ch\u01b0a \u0111\u01b0\u1ee3c b\u00e3o h\u00f2a v\u1edbi c\u1eb7p gh\u00e9p, th\u00ec ch\u00fang ta \u0111\u00e3 th\u00e0nh c\u00f4ng trong vi\u1ec7c t\u00ecm m\u1ed9t \u0111\u01b0\u1eddng t\u0103ng: n\u00f3 bao g\u1ed3m m\u1ed9t c\u1ea1nh duy nh\u1ea5t $(v, to)$; trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, ch\u00fang ta ch\u1ec9 c\u1ea7n bao g\u1ed3m c\u1ea1nh n\u00e0y trong c\u1eb7p gh\u00e9p v\u00e0 ng\u1eebng t\u00ecm ki\u1ebfm \u0111\u01b0\u1eddng t\u0103ng t\u1eeb \u0111\u1ec9nh $v$. Ng\u01b0\u1ee3c l\u1ea1i, n\u1ebfu $to$ \u0111\u00e3 \u0111\u01b0\u1ee3c b\u00e3o h\u00f2a v\u1edbi m\u1ed9t s\u1ed1 c\u1ea1nh $(to, p)$, th\u00ec s\u1ebd \u0111i d\u1ecdc theo c\u1ea1nh n\u00e0y: do \u0111\u00f3 ch\u00fang ta s\u1ebd c\u1ed1 g\u1eafng t\u00ecm m\u1ed9t \u0111\u01b0\u1eddng t\u0103ng \u0111i qua c\u00e1c c\u1ea1nh $(v, to),(to, p), \\ldots$. \u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y, ch\u1ec9 c\u1ea7n \u0111i \u0111\u1ebfn \u0111\u1ec9nh $p$ trong qu\u00e1 tr\u00ecnh duy\u1ec7t c\u1ee7a ch\u00fang ta - b\u00e2y gi\u1edd ch\u00fang ta c\u1ed1 g\u1eafng t\u00ecm m\u1ed9t \u0111\u01b0\u1eddng t\u0103ng t\u1eeb \u0111\u1ec9nh n\u00e0y.</p> <p>V\u00ec v\u1eady, qu\u00e1 tr\u00ecnh duy\u1ec7t n\u00e0y, \u0111\u01b0\u1ee3c kh\u1edfi ch\u1ea1y t\u1eeb \u0111\u1ec9nh $v$, s\u1ebd ho\u1eb7c t\u00ecm th\u1ea5y m\u1ed9t \u0111\u01b0\u1eddng t\u0103ng, v\u00e0 do \u0111\u00f3 b\u00e3o h\u00f2a \u0111\u1ec9nh $v$, ho\u1eb7c n\u00f3 s\u1ebd kh\u00f4ng t\u00ecm th\u1ea5y m\u1ed9t \u0111\u01b0\u1eddng t\u0103ng nh\u01b0 v\u1eady (v\u00e0 do \u0111\u00f3, \u0111\u1ec9nh $v$ n\u00e0y kh\u00f4ng th\u1ec3 \u0111\u01b0\u1ee3c b\u00e3o h\u00f2a).</p> <p>Sau khi t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh $v = 1 \\ldots n_1$ \u0111\u00e3 \u0111\u01b0\u1ee3c qu\u00e9t, c\u1eb7p gh\u00e9p hi\u1ec7n t\u1ea1i s\u1ebd l\u00e0 c\u1ef1c \u0111\u1ea1i.</p>","tags":["Translated"]},{"location":"graph/kuhn_maximum_bipartite_matching.html#running-time","title":"Th\u1eddi gian ch\u1ea1y (Running time)","text":"<p>Thu\u1eadt to\u00e1n Kuhn c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c coi l\u00e0 m\u1ed9t lo\u1ea1t $n$ l\u1ea7n ch\u1ea1y duy\u1ec7t theo chi\u1ec1u s\u00e2u/chi\u1ec1u r\u1ed9ng tr\u00ean to\u00e0n b\u1ed9 \u0111\u1ed3 th\u1ecb. Do \u0111\u00f3, to\u00e0n b\u1ed9 thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c th\u1ef1c thi trong th\u1eddi gian $O(nm)$, trong tr\u01b0\u1eddng h\u1ee3p x\u1ea5u nh\u1ea5t l\u00e0 $O(n^3)$.</p> <p>Tuy nhi\u00ean, \u01b0\u1edbc t\u00ednh n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c c\u1ea3i thi\u1ec7n m\u1ed9t ch\u00fat. H\u00f3a ra \u0111\u1ed1i v\u1edbi thu\u1eadt to\u00e1n Kuhn, \u0111i\u1ec1u quan tr\u1ecdng l\u00e0 ph\u1ea7n n\u00e0o c\u1ee7a \u0111\u1ed3 th\u1ecb \u0111\u01b0\u1ee3c ch\u1ecdn l\u00e0m ph\u1ea7n th\u1ee9 nh\u1ea5t v\u00e0 ph\u1ea7n n\u00e0o l\u00e0 ph\u1ea7n th\u1ee9 hai. Th\u1eadt v\u1eady, trong c\u00e1ch c\u00e0i \u0111\u1eb7t \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 \u1edf tr\u00ean, duy\u1ec7t theo chi\u1ec1u s\u00e2u/chi\u1ec1u r\u1ed9ng ch\u1ec9 b\u1eaft \u0111\u1ea7u t\u1eeb c\u00e1c \u0111\u1ec9nh c\u1ee7a ph\u1ea7n \u0111\u1ea7u ti\u00ean, v\u00ec v\u1eady to\u00e0n b\u1ed9 thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c th\u1ef1c thi trong th\u1eddi gian $O(n_1m)$, trong \u0111\u00f3 $n_1$ l\u00e0 s\u1ed1 l\u01b0\u1ee3ng \u0111\u1ec9nh c\u1ee7a ph\u1ea7n \u0111\u1ea7u ti\u00ean. Trong tr\u01b0\u1eddng h\u1ee3p x\u1ea5u nh\u1ea5t, \u0111\u00e2y l\u00e0 $O(n_1 ^ 2 n_2)$ (trong \u0111\u00f3 $n_2$ l\u00e0 s\u1ed1 l\u01b0\u1ee3ng \u0111\u1ec9nh c\u1ee7a ph\u1ea7n th\u1ee9 hai). \u0110i\u1ec1u n\u00e0y cho th\u1ea5y r\u1eb1ng s\u1ebd c\u00f3 l\u1ee3i h\u01a1n khi ph\u1ea7n \u0111\u1ea7u ti\u00ean ch\u1ee9a \u00edt \u0111\u1ec9nh h\u01a1n ph\u1ea7n th\u1ee9 hai. Tr\u00ean c\u00e1c \u0111\u1ed3 th\u1ecb r\u1ea5t m\u1ea5t c\u00e2n b\u1eb1ng (khi $n_1$ v\u00e0 $n_2$ r\u1ea5t kh\u00e1c nhau), \u0111i\u1ec1u n\u00e0y chuy\u1ec3n th\u00e0nh s\u1ef1 kh\u00e1c bi\u1ec7t \u0111\u00e1ng k\u1ec3 v\u1ec1 th\u1eddi gian ch\u1ea1y.</p>","tags":["Translated"]},{"location":"graph/kuhn_maximum_bipartite_matching.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"","tags":["Translated"]},{"location":"graph/kuhn_maximum_bipartite_matching.html#standard-implementation","title":"C\u00e0i \u0111\u1eb7t ti\u00eau chu\u1ea9n (Standard implementation)","text":"<p>Ch\u00fang ta h\u00e3y tr\u00ecnh b\u00e0y \u1edf \u0111\u00e2y m\u1ed9t c\u00e1ch c\u00e0i \u0111\u1eb7t thu\u1eadt to\u00e1n tr\u00ean d\u1ef1a tr\u00ean duy\u1ec7t theo chi\u1ec1u s\u00e2u v\u00e0 ch\u1ea5p nh\u1eadn m\u1ed9t \u0111\u1ed3 th\u1ecb hai ph\u00eda d\u01b0\u1edbi d\u1ea1ng m\u1ed9t \u0111\u1ed3 th\u1ecb \u0111\u01b0\u1ee3c chia r\u00f5 r\u00e0ng th\u00e0nh hai ph\u1ea7n. C\u00e1ch c\u00e0i \u0111\u1eb7t n\u00e0y r\u1ea5t ng\u1eafn g\u1ecdn, v\u00e0 c\u00f3 l\u1ebd n\u00f3 n\u00ean \u0111\u01b0\u1ee3c ghi nh\u1edb \u1edf d\u1ea1ng n\u00e0y.</p> <p>\u1ede \u0111\u00e2y $n$ l\u00e0 s\u1ed1 l\u01b0\u1ee3ng \u0111\u1ec9nh trong ph\u1ea7n \u0111\u1ea7u ti\u00ean, $k$ - trong ph\u1ea7n th\u1ee9 hai, $g[v]$ l\u00e0 danh s\u00e1ch c\u00e1c c\u1ea1nh t\u1eeb \u0111\u1ec9nh c\u1ee7a ph\u1ea7n \u0111\u1ea7u ti\u00ean (t\u1ee9c l\u00e0 danh s\u00e1ch c\u00e1c s\u1ed1 c\u1ee7a c\u00e1c \u0111\u1ec9nh m\u00e0 c\u00e1c c\u1ea1nh n\u00e0y d\u1eabn \u0111\u1ebfn t\u1eeb $v$). C\u00e1c \u0111\u1ec9nh trong c\u1ea3 hai ph\u1ea7n \u0111\u01b0\u1ee3c \u0111\u00e1nh s\u1ed1 \u0111\u1ed9c l\u1eadp, t\u1ee9c l\u00e0 c\u00e1c \u0111\u1ec9nh trong ph\u1ea7n \u0111\u1ea7u ti\u00ean \u0111\u01b0\u1ee3c \u0111\u00e1nh s\u1ed1 $1 \\ldots n$, v\u00e0 nh\u1eefng \u0111\u1ec9nh trong ph\u1ea7n th\u1ee9 hai \u0111\u01b0\u1ee3c \u0111\u00e1nh s\u1ed1 $1 \\ldots k$.</p> <p>Sau \u0111\u00f3, c\u00f3 hai m\u1ea3ng ph\u1ee5 tr\u1ee3: $\\rm mt$ v\u00e0 $\\rm used$. M\u1ea3ng \u0111\u1ea7u ti\u00ean - $\\rm mt$ - ch\u1ee9a th\u00f4ng tin v\u1ec1 c\u1eb7p gh\u00e9p hi\u1ec7n t\u1ea1i. \u0110\u1ec3 thu\u1eadn ti\u1ec7n cho vi\u1ec7c l\u1eadp tr\u00ecnh, th\u00f4ng tin n\u00e0y ch\u1ec9 \u0111\u01b0\u1ee3c ch\u1ee9a cho c\u00e1c \u0111\u1ec9nh c\u1ee7a ph\u1ea7n th\u1ee9 hai: $\\textrm{mt[} i \\rm]$ - \u0111\u00e2y l\u00e0 s\u1ed1 c\u1ee7a \u0111\u1ec9nh c\u1ee7a ph\u1ea7n \u0111\u1ea7u ti\u00ean \u0111\u01b0\u1ee3c n\u1ed1i b\u1edfi m\u1ed9t c\u1ea1nh v\u1edbi \u0111\u1ec9nh $i$ c\u1ee7a ph\u1ea7n th\u1ee9 hai (ho\u1eb7c $-1$, n\u1ebfu kh\u00f4ng c\u00f3 c\u1ea1nh c\u1eb7p gh\u00e9p n\u00e0o \u0111i ra t\u1eeb n\u00f3). M\u1ea3ng th\u1ee9 hai l\u00e0 $\\rm used$: m\u1ea3ng \"th\u0103m\" th\u00f4ng th\u01b0\u1eddng \u0111\u1ebfn c\u00e1c \u0111\u1ec9nh trong duy\u1ec7t theo chi\u1ec1u s\u00e2u (n\u00f3 ch\u1ec9 c\u1ea7n thi\u1ebft \u0111\u1ec3 duy\u1ec7t theo chi\u1ec1u s\u00e2u kh\u00f4ng \u0111i v\u00e0o c\u00f9ng m\u1ed9t \u0111\u1ec9nh hai l\u1ea7n).</p> <p>M\u1ed9t h\u00e0m $\\textrm{try\\_kuhn}$ l\u00e0 m\u1ed9t duy\u1ec7t theo chi\u1ec1u s\u00e2u. N\u00f3 tr\u1ea3 v\u1ec1 $\\rm true$ n\u1ebfu n\u00f3 c\u00f3 th\u1ec3 t\u00ecm th\u1ea5y m\u1ed9t \u0111\u01b0\u1eddng t\u0103ng t\u1eeb \u0111\u1ec9nh $v$, v\u00e0 coi nh\u01b0 h\u00e0m n\u00e0y \u0111\u00e3 th\u1ef1c hi\u1ec7n vi\u1ec7c lu\u00e2n phi\u00ean c\u1eb7p gh\u00e9p d\u1ecdc theo chu\u1ed7i t\u00ecm \u0111\u01b0\u1ee3c.</p> <p>B\u00ean trong h\u00e0m, t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh \u0111i ra t\u1eeb \u0111\u1ec9nh $v$ c\u1ee7a ph\u1ea7n \u0111\u1ea7u ti\u00ean \u0111\u01b0\u1ee3c qu\u00e9t, v\u00e0 sau \u0111\u00f3 ki\u1ec3m tra nh\u01b0 sau: n\u1ebfu c\u1ea1nh n\u00e0y d\u1eabn \u0111\u1ebfn m\u1ed9t \u0111\u1ec9nh ch\u01b0a b\u00e3o h\u00f2a $to$, ho\u1eb7c n\u1ebfu \u0111\u1ec9nh n\u00e0y $to$ \u0111\u01b0\u1ee3c b\u00e3o h\u00f2a, nh\u01b0ng c\u00f3 th\u1ec3 t\u00ecm th\u1ea5y m\u1ed9t chu\u1ed7i t\u0103ng b\u1eb1ng c\u00e1ch b\u1eaft \u0111\u1ea7u \u0111\u1ec7 quy t\u1eeb $\\textrm{mt[}to \\rm ]$, th\u00ec ch\u00fang ta n\u00f3i r\u1eb1ng ch\u00fang ta \u0111\u00e3 t\u00ecm th\u1ea5y m\u1ed9t \u0111\u01b0\u1eddng t\u0103ng, v\u00e0 tr\u01b0\u1edbc khi tr\u1ea3 v\u1ec1 t\u1eeb h\u00e0m v\u1edbi k\u1ebft qu\u1ea3 $\\rm true$, ch\u00fang ta lu\u00e2n phi\u00ean c\u1ea1nh hi\u1ec7n t\u1ea1i: ch\u00fang ta chuy\u1ec3n h\u01b0\u1edbng c\u1ea1nh k\u1ec1 v\u1edbi $to$ sang \u0111\u1ec9nh $v$.</p> <p>Ch\u01b0\u01a1ng tr\u00ecnh ch\u00ednh tr\u01b0\u1edbc ti\u00ean ch\u1ec9 ra r\u1eb1ng c\u1eb7p gh\u00e9p hi\u1ec7n t\u1ea1i l\u00e0 r\u1ed7ng (danh s\u00e1ch $\\rm mt$ \u0111\u01b0\u1ee3c \u0111i\u1ec1n b\u1eb1ng c\u00e1c s\u1ed1 $-1$). Sau \u0111\u00f3, \u0111\u1ec9nh $v$ c\u1ee7a ph\u1ea7n \u0111\u1ea7u ti\u00ean \u0111\u01b0\u1ee3c t\u00ecm ki\u1ebfm b\u1edfi $\\textrm{try\\_kuhn}$, v\u00e0 m\u1ed9t duy\u1ec7t theo chi\u1ec1u s\u00e2u \u0111\u01b0\u1ee3c b\u1eaft \u0111\u1ea7u t\u1eeb n\u00f3, sau khi \u0111\u00e3 l\u00e0m s\u1ea1ch m\u1ea3ng $\\rm used$ tr\u01b0\u1edbc \u0111\u00f3.</p> <p>\u0110i\u1ec1u \u0111\u00e1ng ch\u00fa \u00fd l\u00e0 k\u00edch th\u01b0\u1edbc c\u1ee7a c\u1eb7p gh\u00e9p r\u1ea5t d\u1ec5 nh\u1eadn \u0111\u01b0\u1ee3c b\u1eb1ng s\u1ed1 l\u01b0\u1ee3ng l\u1ec7nh g\u1ecdi $\\textrm{try\\_kuhn}$ trong ch\u01b0\u01a1ng tr\u00ecnh ch\u00ednh tr\u1ea3 v\u1ec1 k\u1ebft qu\u1ea3 $\\rm true$. B\u1ea3n th\u00e2n c\u1eb7p gh\u00e9p c\u1ef1c \u0111\u1ea1i mong mu\u1ed1n \u0111\u01b0\u1ee3c ch\u1ee9a trong m\u1ea3ng $\\rm mt$.</p> <pre><code>int n, k;\nvector&lt;vector&lt;int&gt;&gt; g;\nvector&lt;int&gt; mt;\nvector&lt;bool&gt; used;\n\nbool try_kuhn(int v) {\n    if (used[v])\n        return false;\n    used[v] = true;\n    for (int to : g[v]) {\n        if (mt[to] == -1 || try_kuhn(mt[to])) {\n            mt[to] = v;\n            return true;\n        }\n    }\n    return false;\n}\n\nint main() {\n    //... reading the graph ...\n\n    mt.assign(k, -1);\n    for (int v = 0; v &lt; n; ++v) {\n        used.assign(n, false);\n        try_kuhn(v);\n    }\n\n    for (int i = 0; i &lt; k; ++i)\n        if (mt[i] != -1)\n            printf(\"%d %d\\n\", mt[i] + 1, i + 1);\n}\n</code></pre> <p>Ch\u00fang t\u00f4i l\u1eb7p l\u1ea1i m\u1ed9t l\u1ea7n n\u1eefa r\u1eb1ng thu\u1eadt to\u00e1n Kuhn r\u1ea5t d\u1ec5 th\u1ef1c hi\u1ec7n theo c\u00e1ch m\u00e0 n\u00f3 ho\u1ea1t \u0111\u1ed9ng tr\u00ean c\u00e1c \u0111\u1ed3 th\u1ecb \u0111\u01b0\u1ee3c bi\u1ebft l\u00e0 hai ph\u00eda, nh\u01b0ng s\u1ef1 ph\u00e2n chia r\u00f5 r\u00e0ng c\u1ee7a ch\u00fang th\u00e0nh hai ph\u1ea7n ch\u01b0a \u0111\u01b0\u1ee3c \u0111\u01b0a ra. Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, s\u1ebd c\u1ea7n ph\u1ea3i t\u1eeb b\u1ecf vi\u1ec7c chia th\u00e0nh hai ph\u1ea7n thu\u1eadn ti\u1ec7n, v\u00e0 l\u01b0u tr\u1eef t\u1ea5t c\u1ea3 th\u00f4ng tin cho t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh c\u1ee7a \u0111\u1ed3 th\u1ecb. \u0110\u1ed1i v\u1edbi \u0111i\u1ec1u n\u00e0y, m\u1ed9t m\u1ea3ng danh s\u00e1ch $g$ b\u00e2y gi\u1edd \u0111\u01b0\u1ee3c ch\u1ec9 \u0111\u1ecbnh kh\u00f4ng ch\u1ec9 cho c\u00e1c \u0111\u1ec9nh c\u1ee7a ph\u1ea7n \u0111\u1ea7u ti\u00ean, m\u00e0 cho t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh c\u1ee7a \u0111\u1ed3 th\u1ecb (t\u1ea5t nhi\u00ean, b\u00e2y gi\u1edd c\u00e1c \u0111\u1ec9nh c\u1ee7a c\u1ea3 hai ph\u1ea7n \u0111\u01b0\u1ee3c \u0111\u00e1nh s\u1ed1 theo m\u1ed9t \u0111\u00e1nh s\u1ed1 chung - t\u1eeb $1$ \u0111\u1ebfn $n$). C\u00e1c m\u1ea3ng $\\rm mt$ v\u00e0 $\\rm used$ b\u00e2y gi\u1edd c\u0169ng \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a cho c\u00e1c \u0111\u1ec9nh c\u1ee7a c\u1ea3 hai ph\u1ea7n, v\u00e0 theo \u0111\u00f3, ch\u00fang c\u1ea7n \u0111\u01b0\u1ee3c gi\u1eef \u1edf tr\u1ea1ng th\u00e1i n\u00e0y.</p>","tags":["Translated"]},{"location":"graph/kuhn_maximum_bipartite_matching.html#improved-implementation","title":"C\u00e0i \u0111\u1eb7t c\u1ea3i ti\u1ebfn (Improved implementation)","text":"<p>H\u00e3y s\u1eeda \u0111\u1ed5i thu\u1eadt to\u00e1n nh\u01b0 sau. Tr\u01b0\u1edbc v\u00f2ng l\u1eb7p ch\u00ednh c\u1ee7a thu\u1eadt to\u00e1n, ch\u00fang ta s\u1ebd t\u00ecm m\u1ed9t c\u1eb7p gh\u00e9p b\u1ea5t k\u1ef3 b\u1eb1ng m\u1ed9t thu\u1eadt to\u00e1n \u0111\u01a1n gi\u1ea3n n\u00e0o \u0111\u00f3 (m\u1ed9t thu\u1eadt to\u00e1n heuristic \u0111\u01a1n gi\u1ea3n), v\u00e0 ch\u1ec9 sau \u0111\u00f3 ch\u00fang ta m\u1edbi th\u1ef1c hi\u1ec7n m\u1ed9t v\u00f2ng l\u1eb7p v\u1edbi c\u00e1c l\u1ec7nh g\u1ecdi \u0111\u1ebfn h\u00e0m $\\textrm{try\\_kuhn}()$, h\u00e0m n\u00e0y s\u1ebd c\u1ea3i thi\u1ec7n c\u1eb7p gh\u00e9p n\u00e0y. K\u1ebft qu\u1ea3 l\u00e0, thu\u1eadt to\u00e1n s\u1ebd ho\u1ea1t \u0111\u1ed9ng nhanh h\u01a1n \u0111\u00e1ng k\u1ec3 tr\u00ean c\u00e1c \u0111\u1ed3 th\u1ecb ng\u1eabu nhi\u00ean - b\u1edfi v\u00ec trong h\u1ea7u h\u1ebft c\u00e1c \u0111\u1ed3 th\u1ecb, b\u1ea1n c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng t\u00ecm th\u1ea5y m\u1ed9t c\u1eb7p gh\u00e9p c\u00f3 k\u00edch th\u01b0\u1edbc \u0111\u1ee7 l\u1edbn b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng heuristic, v\u00e0 sau \u0111\u00f3 c\u1ea3i thi\u1ec7n c\u1eb7p gh\u00e9p \u0111\u00e3 t\u00ecm th\u1ea5y \u0111\u1ebfn m\u1ee9c t\u1ed1i \u0111a b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng thu\u1eadt to\u00e1n Kuhn th\u00f4ng th\u01b0\u1eddng. Do \u0111\u00f3, ch\u00fang ta s\u1ebd ti\u1ebft ki\u1ec7m \u0111\u01b0\u1ee3c vi\u1ec7c kh\u1edfi ch\u1ea1y m\u1ed9t duy\u1ec7t theo chi\u1ec1u s\u00e2u t\u1eeb nh\u1eefng \u0111\u1ec9nh m\u00e0 ch\u00fang ta \u0111\u00e3 \u0111\u01b0a v\u00e0o c\u1eb7p gh\u00e9p hi\u1ec7n t\u1ea1i b\u1eb1ng heuristic.</p> <p>V\u00ed d\u1ee5, b\u1ea1n c\u00f3 th\u1ec3 ch\u1ec9 c\u1ea7n l\u1eb7p qua t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh c\u1ee7a ph\u1ea7n \u0111\u1ea7u ti\u00ean, v\u00e0 \u0111\u1ed1i v\u1edbi m\u1ed7i \u0111\u1ec9nh trong s\u1ed1 ch\u00fang, t\u00ecm m\u1ed9t c\u1ea1nh b\u1ea5t k\u1ef3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u00eam v\u00e0o c\u1eb7p gh\u00e9p, v\u00e0 th\u00eam n\u00f3. Ngay c\u1ea3 m\u1ed9t heuristic \u0111\u01a1n gi\u1ea3n nh\u01b0 v\u1eady c\u0169ng c\u00f3 th\u1ec3 t\u0103ng t\u1ed1c thu\u1eadt to\u00e1n Kuhn l\u00ean nhi\u1ec1u l\u1ea7n.</p> <p>Xin l\u01b0u \u00fd r\u1eb1ng v\u00f2ng l\u1eb7p ch\u00ednh s\u1ebd ph\u1ea3i \u0111\u01b0\u1ee3c s\u1eeda \u0111\u1ed5i m\u1ed9t ch\u00fat. V\u00ec khi g\u1ecdi h\u00e0m $\\textrm{try\\_kuhn}$ trong v\u00f2ng l\u1eb7p ch\u00ednh, ng\u01b0\u1eddi ta cho r\u1eb1ng \u0111\u1ec9nh hi\u1ec7n t\u1ea1i ch\u01b0a \u0111\u01b0\u1ee3c \u0111\u01b0a v\u00e0o c\u1eb7p gh\u00e9p, n\u00ean b\u1ea1n c\u1ea7n th\u00eam m\u1ed9t ki\u1ec3m tra th\u00edch h\u1ee3p.</p> <p>Trong c\u00e0i \u0111\u1eb7t, ch\u1ec9 m\u00e3 trong h\u00e0m $\\textrm{main}()$ s\u1ebd thay \u0111\u1ed5i:</p> <pre><code>int main() {\n    // ... reading the graph ...\n\n    mt.assign(k, -1);\n    vector&lt;bool&gt; used1(n, false);\n    for (int v = 0; v &lt; n; ++v) {\n        for (int to : g[v]) {\n            if (mt[to] == -1) {\n                mt[to] = v;\n                used1[v] = true;\n                break;\n            }\n        }\n    }\n    for (int v = 0; v &lt; n; ++v) {\n        if (used1[v])\n            continue;\n        used.assign(n, false);\n        try_kuhn(v);\n    }\n\n    for (int i = 0; i &lt; k; ++i)\n        if (mt[i] != -1)\n            printf(\"%d %d\\n\", mt[i] + 1, i + 1);\n}\n</code></pre> <p>M\u1ed9t heuristic t\u1ed1t kh\u00e1c nh\u01b0 sau. \u1ede m\u1ed7i b\u01b0\u1edbc, n\u00f3 s\u1ebd t\u00ecm ki\u1ebfm \u0111\u1ec9nh c\u00f3 b\u1eadc nh\u1ecf nh\u1ea5t (nh\u01b0ng kh\u00f4ng c\u00f4 l\u1eadp), ch\u1ecdn b\u1ea5t k\u1ef3 c\u1ea1nh n\u00e0o t\u1eeb n\u00f3 v\u00e0 th\u00eam n\u00f3 v\u00e0o c\u1eb7p gh\u00e9p, sau \u0111\u00f3 lo\u1ea1i b\u1ecf c\u1ea3 hai \u0111\u1ec9nh n\u00e0y v\u1edbi t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh k\u1ec1 kh\u1ecfi \u0111\u1ed3 th\u1ecb. S\u1ef1 tham lam nh\u01b0 v\u1eady ho\u1ea1t \u0111\u1ed9ng r\u1ea5t t\u1ed1t tr\u00ean c\u00e1c \u0111\u1ed3 th\u1ecb ng\u1eabu nhi\u00ean; trong nhi\u1ec1u tr\u01b0\u1eddng h\u1ee3p n\u00f3 th\u1eadm ch\u00ed c\u00f2n x\u00e2y d\u1ef1ng \u0111\u01b0\u1ee3c c\u1eb7p gh\u00e9p c\u1ef1c \u0111\u1ea1i (m\u1eb7c d\u00f9 c\u00f3 m\u1ed9t tr\u01b0\u1eddng h\u1ee3p ki\u1ec3m tra ch\u1ed1ng l\u1ea1i n\u00f3, trong \u0111\u00f3 n\u00f3 s\u1ebd t\u00ecm th\u1ea5y m\u1ed9t c\u1eb7p gh\u00e9p nh\u1ecf h\u01a1n nhi\u1ec1u so v\u1edbi c\u1ef1c \u0111\u1ea1i).</p>","tags":["Translated"]},{"location":"graph/kuhn_maximum_bipartite_matching.html#notes","title":"Ghi ch\u00fa (Notes)","text":"<ul> <li>Thu\u1eadt to\u00e1n Kuhn l\u00e0 m\u1ed9t ch\u01b0\u01a1ng tr\u00ecnh con trong thu\u1eadt to\u00e1n Hungary, c\u00f2n \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 thu\u1eadt to\u00e1n Kuhn-Munkres.</li> <li>Thu\u1eadt to\u00e1n Kuhn ch\u1ea1y trong th\u1eddi gian $O(nm)$. N\u00f3 th\u01b0\u1eddng \u0111\u01a1n gi\u1ea3n \u0111\u1ec3 th\u1ef1c hi\u1ec7n, tuy nhi\u00ean, c\u00e1c thu\u1eadt to\u00e1n hi\u1ec7u qu\u1ea3 h\u01a1n t\u1ed3n t\u1ea1i cho b\u00e0i to\u00e1n c\u1eb7p gh\u00e9p hai ph\u00eda c\u1ef1c \u0111\u1ea1i - ch\u1eb3ng h\u1ea1n nh\u01b0 thu\u1eadt to\u00e1n Hopcroft-Karp-Karzanov, ch\u1ea1y trong th\u1eddi gian $O(\\sqrt{n}m)$.</li> <li>B\u00e0i to\u00e1n ph\u1ee7 \u0111\u1ec9nh nh\u1ecf nh\u1ea5t l\u00e0 NP-kh\u00f3 cho c\u00e1c \u0111\u1ed3 th\u1ecb t\u1ed5ng qu\u00e1t. Tuy nhi\u00ean, \u0111\u1ecbnh l\u00fd K\u0151nig cho r\u1eb1ng, \u0111\u1ed1i v\u1edbi c\u00e1c \u0111\u1ed3 th\u1ecb hai ph\u00eda, l\u1ef1c l\u01b0\u1ee3ng c\u1ee7a c\u1eb7p gh\u00e9p c\u1ef1c \u0111\u1ea1i b\u1eb1ng l\u1ef1c l\u01b0\u1ee3ng c\u1ee7a ph\u1ee7 \u0111\u1ec9nh nh\u1ecf nh\u1ea5t. Do \u0111\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng c\u00e1c thu\u1eadt to\u00e1n c\u1eb7p gh\u00e9p hai ph\u00eda c\u1ef1c \u0111\u1ea1i \u0111\u1ec3 gi\u1ea3i quy\u1ebft b\u00e0i to\u00e1n ph\u1ee7 \u0111\u1ec9nh nh\u1ecf nh\u1ea5t trong th\u1eddi gian \u0111a th\u1ee9c cho c\u00e1c \u0111\u1ed3 th\u1ecb hai ph\u00eda.</li> </ul>","tags":["Translated"]},{"location":"graph/kuhn_maximum_bipartite_matching.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>Kattis - Gopher II</li> <li>Kattis - Borders</li> </ul>","tags":["Translated"]},{"location":"graph/lca.html","title":"T\u1ed5 ti\u00ean chung th\u1ea5p nh\u1ea5t - $O(\\sqrt{N})$ v\u00e0 $O(\\log N)$ v\u1edbi ti\u1ec1n x\u1eed l\u00fd $O(N)$ (Lowest Common Ancestor - $O(\\sqrt{N})$ and $O(\\log N)$ with $O(N)$ preprocessing)","text":"<p>Cho m\u1ed9t c\u00e2y $G$. Cho c\u00e1c truy v\u1ea5n c\u00f3 d\u1ea1ng $(v_1, v_2)$, \u0111\u1ed1i v\u1edbi m\u1ed7i truy v\u1ea5n b\u1ea1n c\u1ea7n t\u00ecm t\u1ed5 ti\u00ean chung th\u1ea5p nh\u1ea5t (ho\u1eb7c t\u1ed5 ti\u00ean chung nh\u1ecf nh\u1ea5t), t\u1ee9c l\u00e0 m\u1ed9t \u0111\u1ec9nh $v$ n\u1eb1m tr\u00ean \u0111\u01b0\u1eddng \u0111i t\u1eeb g\u1ed1c \u0111\u1ebfn $v_1$ v\u00e0 \u0111\u01b0\u1eddng \u0111i t\u1eeb g\u1ed1c \u0111\u1ebfn $v_2$, v\u00e0 \u0111\u1ec9nh n\u00e0y ph\u1ea3i l\u00e0 th\u1ea5p nh\u1ea5t. N\u00f3i c\u00e1ch kh\u00e1c, \u0111\u1ec9nh $v$ mong mu\u1ed1n l\u00e0 t\u1ed5 ti\u00ean g\u1ea7n nh\u1ea5t (most bottom ancestor) c\u1ee7a $v_1$ v\u00e0 $v_2$. R\u00f5 r\u00e0ng l\u00e0 t\u1ed5 ti\u00ean chung th\u1ea5p nh\u1ea5t c\u1ee7a ch\u00fang n\u1eb1m tr\u00ean \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t t\u1eeb $v_1$ v\u00e0 $v_2$. Ngo\u00e0i ra, n\u1ebfu $v_1$ l\u00e0 t\u1ed5 ti\u00ean c\u1ee7a $v_2$, th\u00ec $v_1$ l\u00e0 t\u1ed5 ti\u00ean chung th\u1ea5p nh\u1ea5t c\u1ee7a ch\u00fang.</p>","tags":["Translated"]},{"location":"graph/lca.html#y-tuong-cua-thuat-toan-the-idea-of-the-algorithm","title":"\u00dd t\u01b0\u1edfng c\u1ee7a thu\u1eadt to\u00e1n (The Idea of the Algorithm)","text":"<p>Tr\u01b0\u1edbc khi tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n, ch\u00fang ta c\u1ea7n ti\u1ec1n x\u1eed l\u00fd c\u00e2y. Ch\u00fang ta th\u1ef1c hi\u1ec7n duy\u1ec7t DFS b\u1eaft \u0111\u1ea7u t\u1eeb g\u1ed1c v\u00e0 x\u00e2y d\u1ef1ng m\u1ed9t danh s\u00e1ch $\\text{euler}$ l\u01b0u tr\u1eef th\u1ee9 t\u1ef1 c\u00e1c \u0111\u1ec9nh m\u00e0 ch\u00fang ta th\u0103m (m\u1ed9t \u0111\u1ec9nh \u0111\u01b0\u1ee3c th\u00eam v\u00e0o danh s\u00e1ch khi ch\u00fang ta l\u1ea7n \u0111\u1ea7u ti\u00ean th\u0103m n\u00f3, v\u00e0 sau khi quay l\u1ea1i t\u1eeb c\u00e1c l\u1ea7n duy\u1ec7t DFS \u0111\u1ebfn con c\u1ee7a n\u00f3). \u0110\u00e2y c\u0169ng \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 m\u1ed9t Euler tour c\u1ee7a c\u00e2y. R\u00f5 r\u00e0ng k\u00edch th\u01b0\u1edbc c\u1ee7a danh s\u00e1ch n\u00e0y s\u1ebd l\u00e0 $O(N)$. Ch\u00fang ta c\u0169ng c\u1ea7n x\u00e2y d\u1ef1ng m\u1ed9t m\u1ea3ng $\\text{first}[0..N-1]$ l\u01b0u tr\u1eef l\u1ea7n xu\u1ea5t hi\u1ec7n \u0111\u1ea7u ti\u00ean c\u1ee7a m\u1ed7i \u0111\u1ec9nh $i$ trong $\\text{euler}$. Ngh\u0129a l\u00e0, v\u1ecb tr\u00ed \u0111\u1ea7u ti\u00ean trong $\\text{euler}$ sao cho $\\text{euler}[\\text{first}[i]] = i$. Ngo\u00e0i ra b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng DFS ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm \u0111\u1ed9 cao c\u1ee7a m\u1ed7i n\u00fat (kho\u1ea3ng c\u00e1ch t\u1eeb g\u1ed1c \u0111\u1ebfn n\u00f3) v\u00e0 l\u01b0u tr\u1eef n\u00f3 trong m\u1ea3ng $\\text{height}[0..N-1]$.</p> <p>V\u1eady l\u00e0m th\u1ebf n\u00e0o ch\u00fang ta c\u00f3 th\u1ec3 tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng Euler tour v\u00e0 hai m\u1ea3ng b\u1ed5 sung? Gi\u1ea3 s\u1eed truy v\u1ea5n l\u00e0 m\u1ed9t c\u1eb7p $v_1$ v\u00e0 $v_2$. Xem x\u00e9t c\u00e1c \u0111\u1ec9nh m\u00e0 ch\u00fang ta th\u0103m trong Euler tour gi\u1eefa l\u1ea7n th\u0103m \u0111\u1ea7u ti\u00ean c\u1ee7a $v_1$ v\u00e0 l\u1ea7n th\u0103m \u0111\u1ea7u ti\u00ean c\u1ee7a $v_2$. D\u1ec5 d\u00e0ng nh\u1eadn th\u1ea5y r\u1eb1ng, $\\text{LCA}(v_1, v_2)$ l\u00e0 \u0111\u1ec9nh c\u00f3 \u0111\u1ed9 cao th\u1ea5p nh\u1ea5t tr\u00ean \u0111\u01b0\u1eddng \u0111i n\u00e0y. Ch\u00fang ta \u0111\u00e3 nh\u1eadn th\u1ea5y r\u1eb1ng, LCA ph\u1ea3i l\u00e0 m\u1ed9t ph\u1ea7n c\u1ee7a \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t gi\u1eefa $v_1$ v\u00e0 $v_2$. R\u00f5 r\u00e0ng n\u00f3 c\u0169ng ph\u1ea3i l\u00e0 \u0111\u1ec9nh c\u00f3 \u0111\u1ed9 cao nh\u1ecf nh\u1ea5t. V\u00e0 trong Euler tour ch\u00fang ta v\u1ec1 c\u01a1 b\u1ea3n s\u1eed d\u1ee5ng \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t, ngo\u1ea1i tr\u1eeb vi\u1ec7c ch\u00fang ta th\u0103m th\u00eam t\u1ea5t c\u1ea3 c\u00e1c c\u00e2y con m\u00e0 ch\u00fang ta t\u00ecm th\u1ea5y tr\u00ean \u0111\u01b0\u1eddng \u0111i. Nh\u01b0ng t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh trong c\u00e1c c\u00e2y con n\u00e0y \u0111\u1ec1u th\u1ea5p h\u01a1n trong c\u00e2y so v\u1edbi LCA v\u00e0 do \u0111\u00f3 c\u00f3 \u0111\u1ed9 cao l\u1edbn h\u01a1n. V\u00ec v\u1eady $\\text{LCA}(v_1, v_2)$ c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh duy nh\u1ea5t b\u1eb1ng c\u00e1ch t\u00ecm \u0111\u1ec9nh c\u00f3 \u0111\u1ed9 cao nh\u1ecf nh\u1ea5t trong Euler tour gi\u1eefa $\\text{first}(v_1)$ v\u00e0 $\\text{first}(v_2)$.</p> <p>H\u00e3y minh h\u1ecda \u00fd t\u01b0\u1edfng n\u00e0y. Xem x\u00e9t \u0111\u1ed3 th\u1ecb sau v\u00e0 Euler tour v\u1edbi c\u00e1c \u0111\u1ed9 cao t\u01b0\u01a1ng \u1ee9ng:</p> $$\\begin{array}{|l|c|c|c|c|c|c|c|c|c|c|c|c|c|} \\hline \\text{Vertices:}   &amp; 1 &amp; 2 &amp; 5 &amp; 2 &amp; 6 &amp; 2 &amp; 1 &amp; 3 &amp; 1 &amp; 4 &amp; 7 &amp; 4 &amp; 1 \\\\ \\hline \\text{Heights:} &amp; 1 &amp; 2 &amp; 3 &amp; 2 &amp; 3 &amp; 2 &amp; 1 &amp; 2 &amp; 1 &amp; 2 &amp; 3 &amp; 2 &amp; 1 \\\\ \\hline \\end{array}$$ <p>Tour b\u1eaft \u0111\u1ea7u t\u1ea1i \u0111\u1ec9nh $6$ v\u00e0 k\u1ebft th\u00fac t\u1ea1i $4$ ch\u00fang ta th\u0103m c\u00e1c \u0111\u1ec9nh $[6, 2, 1, 3, 1, 4]$. Trong s\u1ed1 c\u00e1c \u0111\u1ec9nh \u0111\u00f3, \u0111\u1ec9nh $1$ c\u00f3 \u0111\u1ed9 cao th\u1ea5p nh\u1ea5t, do \u0111\u00f3 $\\text{LCA(6, 4) = 1}$.</p> <p>T\u00f3m t\u1eaft l\u1ea1i: \u0111\u1ec3 tr\u1ea3 l\u1eddi m\u1ed9t truy v\u1ea5n ch\u00fang ta ch\u1ec9 c\u1ea7n t\u00ecm \u0111\u1ec9nh c\u00f3 \u0111\u1ed9 cao nh\u1ecf nh\u1ea5t trong m\u1ea3ng $\\text{euler}$ trong ph\u1ea1m vi t\u1eeb $\\text{first}[v_1]$ \u0111\u1ebfn $\\text{first}[v_2]$. Do \u0111\u00f3, b\u00e0i to\u00e1n LCA \u0111\u01b0\u1ee3c quy v\u1ec1 b\u00e0i to\u00e1n RMQ (t\u00ecm gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t trong m\u1ed9t ph\u1ea1m vi).</p> <p>S\u1eed d\u1ee5ng Ph\u00e2n r\u00e3 c\u0103n b\u1eadc hai (Sqrt-Decomposition), c\u00f3 th\u1ec3 thu \u0111\u01b0\u1ee3c m\u1ed9t gi\u1ea3i ph\u00e1p tr\u1ea3 l\u1eddi m\u1ed7i truy v\u1ea5n trong $O(\\sqrt{N})$ v\u1edbi ti\u1ec1n x\u1eed l\u00fd trong th\u1eddi gian $O(N)$.</p> <p>S\u1eed d\u1ee5ng Segment Tree b\u1ea1n c\u00f3 th\u1ec3 tr\u1ea3 l\u1eddi m\u1ed7i truy v\u1ea5n trong $O(\\log N)$ v\u1edbi ti\u1ec1n x\u1eed l\u00fd trong th\u1eddi gian $O(N)$.</p> <p>V\u00ec h\u1ea7u nh\u01b0 s\u1ebd kh\u00f4ng bao gi\u1edd c\u00f3 b\u1ea5t k\u1ef3 c\u1eadp nh\u1eadt n\u00e0o cho c\u00e1c gi\u00e1 tr\u1ecb \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef, B\u1ea3ng th\u01b0a (Sparse Table) c\u00f3 th\u1ec3 l\u00e0 m\u1ed9t l\u1ef1a ch\u1ecdn t\u1ed1t h\u01a1n, cho ph\u00e9p tr\u1ea3 l\u1eddi truy v\u1ea5n $O(1)$ v\u1edbi th\u1eddi gian x\u00e2y d\u1ef1ng $O(N\\log N)$.</p>","tags":["Translated"]},{"location":"graph/lca.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>Trong c\u00e0i \u0111\u1eb7t LCA sau \u0111\u00e2y, Segment Tree \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng.</p> <pre><code>struct LCA {\n    vector&lt;int&gt; height, euler, first, segtree;\n    vector&lt;bool&gt; visited;\n    int n;\n\n    LCA(vector&lt;vector&lt;int&gt;&gt; &amp;adj, int root = 0) {\n        n = adj.size();\n        height.resize(n);\n        first.resize(n);\n        euler.reserve(n * 2);\n        visited.assign(n, false);\n        dfs(adj, root);\n        int m = euler.size();\n        segtree.resize(m * 4);\n        build(1, 0, m - 1);\n    }\n\n    void dfs(vector&lt;vector&lt;int&gt;&gt; &amp;adj, int node, int h = 0) {\n        visited[node] = true;\n        height[node] = h;\n        first[node] = euler.size();\n        euler.push_back(node);\n        for (auto to : adj[node]) {\n            if (!visited[to]) {\n                dfs(adj, to, h + 1);\n                euler.push_back(node);\n            }\n        }\n    }\n\n    void build(int node, int b, int e) {\n        if (b == e) {\n            segtree[node] = euler[b];\n        } else {\n            int mid = (b + e) / 2;\n            build(node &lt;&lt; 1, b, mid);\n            build(node &lt;&lt; 1 | 1, mid + 1, e);\n            int l = segtree[node &lt;&lt; 1], r = segtree[node &lt;&lt; 1 | 1];\n            segtree[node] = (height[l] &lt; height[r]) ? l : r;\n        }\n    }\n\n    int query(int node, int b, int e, int L, int R) {\n        if (b &gt; R || e &lt; L)\n            return -1;\n        if (b &gt;= L &amp;&amp; e &lt;= R)\n            return segtree[node];\n        int mid = (b + e) &gt;&gt; 1;\n\n        int left = query(node &lt;&lt; 1, b, mid, L, R);\n        int right = query(node &lt;&lt; 1 | 1, mid + 1, e, L, R);\n        if (left == -1) return right;\n        if (right == -1) return left;\n        return height[left] &lt; height[right] ? left : right;\n    }\n\n    int lca(int u, int v) {\n        int left = first[u], right = first[v];\n        if (left &gt; right)\n            swap(left, right);\n        return query(1, 0, euler.size() - 1, left, right);\n    }\n};\n</code></pre>","tags":["Translated"]},{"location":"graph/lca.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>SPOJ: LCA</li> <li>SPOJ: DISQUERY</li> <li>TIMUS: 1471. Distance in the Tree</li> <li>CODEFORCES: Design Tutorial: Inverse the Problem</li> <li>CODECHEF: Lowest Common Ancestor</li> <li>SPOJ - Lowest Common Ancestor</li> <li>SPOJ - Ada and Orange Tree</li> <li>DevSkill - Motoku (archived)</li> <li>UVA 12655 - Trucks</li> <li>Codechef - Pishty and Tree</li> <li>UVA - 12533 - Joining Couples</li> <li>Codechef - So close yet So Far</li> <li>Codeforces - Drivers Dissatisfaction</li> <li>UVA 11354 - Bond</li> <li>SPOJ - Querry on a tree II</li> <li>Codeforces - Best Edge Weight</li> <li>Codeforces - Misha, Grisha and Underground</li> <li>SPOJ - Nlogonian Tickets</li> <li>Codeforces - Rowena Rawenclaws Diadem</li> </ul>","tags":["Translated"]},{"location":"graph/lca_binary_lifting.html","title":"T\u1ed5 ti\u00ean chung th\u1ea5p nh\u1ea5t - N\u00e2ng nh\u1ecb ph\u00e2n (Lowest Common Ancestor - Binary Lifting)","text":"<p>Cho $G$ l\u00e0 m\u1ed9t c\u00e2y. \u0110\u1ed1i v\u1edbi m\u1ed7i truy v\u1ea5n c\u00f3 d\u1ea1ng <code>(u, v)</code>, ch\u00fang ta mu\u1ed1n t\u00ecm t\u1ed5 ti\u00ean chung th\u1ea5p nh\u1ea5t c\u1ee7a c\u00e1c n\u00fat <code>u</code> v\u00e0 <code>v</code>, t\u1ee9c l\u00e0 ch\u00fang ta mu\u1ed1n t\u00ecm m\u1ed9t n\u00fat <code>w</code> n\u1eb1m tr\u00ean \u0111\u01b0\u1eddng \u0111i t\u1eeb <code>u</code> \u0111\u1ebfn n\u00fat g\u1ed1c, n\u1eb1m tr\u00ean \u0111\u01b0\u1eddng \u0111i t\u1eeb <code>v</code> \u0111\u1ebfn n\u00fat g\u1ed1c, v\u00e0 n\u1ebfu c\u00f3 nhi\u1ec1u n\u00fat nh\u01b0 v\u1eady, ch\u00fang ta ch\u1ecdn n\u00fat xa n\u00fat g\u1ed1c nh\u1ea5t. N\u00f3i c\u00e1ch kh\u00e1c, n\u00fat <code>w</code> mong mu\u1ed1n l\u00e0 t\u1ed5 ti\u00ean th\u1ea5p nh\u1ea5t c\u1ee7a <code>u</code> v\u00e0 <code>v</code>. \u0110\u1eb7c bi\u1ec7t n\u1ebfu <code>u</code> l\u00e0 t\u1ed5 ti\u00ean c\u1ee7a <code>v</code>, th\u00ec <code>u</code> l\u00e0 t\u1ed5 ti\u00ean chung th\u1ea5p nh\u1ea5t c\u1ee7a ch\u00fang.</p> <p>Thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 trong b\u00e0i vi\u1ebft n\u00e0y s\u1ebd c\u1ea7n $O(N \\log N)$ \u0111\u1ec3 ti\u1ec1n x\u1eed l\u00fd c\u00e2y, v\u00e0 sau \u0111\u00f3 $O(\\log N)$ cho m\u1ed7i truy v\u1ea5n LCA.</p>","tags":["Translated"]},{"location":"graph/lca_binary_lifting.html#algorithm","title":"Thu\u1eadt to\u00e1n (Algorithm)","text":"<p>\u0110\u1ed1i v\u1edbi m\u1ed7i n\u00fat, ch\u00fang ta s\u1ebd t\u00ednh to\u00e1n tr\u01b0\u1edbc t\u1ed5 ti\u00ean b\u00ean tr\u00ean n\u00f3, t\u1ed5 ti\u00ean hai n\u00fat b\u00ean tr\u00ean, t\u1ed5 ti\u00ean b\u1ed1n n\u00fat b\u00ean tr\u00ean, v.v. H\u00e3y l\u01b0u tr\u1eef ch\u00fang trong m\u1ea3ng <code>up</code>, t\u1ee9c l\u00e0 <code>up[i][j]</code> l\u00e0 t\u1ed5 ti\u00ean th\u1ee9 <code>2^j</code> b\u00ean tr\u00ean n\u00fat <code>i</code> v\u1edbi <code>i=1...N</code>, <code>j=0...ceil(log(N))</code>. Th\u00f4ng tin n\u00e0y cho ph\u00e9p ch\u00fang ta nh\u1ea3y t\u1eeb b\u1ea5t k\u1ef3 n\u00fat n\u00e0o \u0111\u1ebfn b\u1ea5t k\u1ef3 t\u1ed5 ti\u00ean n\u00e0o b\u00ean tr\u00ean n\u00f3 trong th\u1eddi gian $O(\\log N)$. Ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh to\u00e1n m\u1ea3ng n\u00e0y b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng duy\u1ec7t DFS tr\u00ean c\u00e2y.</p> <p>\u0110\u1ed1i v\u1edbi m\u1ed7i n\u00fat, ch\u00fang ta c\u0169ng s\u1ebd ghi nh\u1edb th\u1eddi gian th\u0103m \u0111\u1ea7u ti\u00ean c\u1ee7a n\u00fat n\u00e0y (t\u1ee9c l\u00e0 th\u1eddi gian DFS kh\u00e1m ph\u00e1 n\u00fat), v\u00e0 th\u1eddi gian khi ch\u00fang ta r\u1eddi kh\u1ecfi n\u00f3 (t\u1ee9c l\u00e0 sau khi ch\u00fang ta th\u0103m t\u1ea5t c\u1ea3 c\u00e1c con v\u00e0 tho\u00e1t kh\u1ecfi h\u00e0m DFS). Ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng th\u00f4ng tin n\u00e0y \u0111\u1ec3 x\u00e1c \u0111\u1ecbnh trong th\u1eddi gian h\u1eb1ng s\u1ed1 n\u1ebfu m\u1ed9t n\u00fat l\u00e0 t\u1ed5 ti\u00ean c\u1ee7a m\u1ed9t n\u00fat kh\u00e1c.</p> <p>Gi\u1ea3 s\u1eed b\u00e2y gi\u1edd ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c m\u1ed9t truy v\u1ea5n <code>(u, v)</code>. Ch\u00fang ta c\u00f3 th\u1ec3 ki\u1ec3m tra ngay l\u1eadp t\u1ee9c xem m\u1ed9t n\u00fat c\u00f3 ph\u1ea3i l\u00e0 t\u1ed5 ti\u00ean c\u1ee7a n\u00fat kia hay kh\u00f4ng. Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, n\u00fat n\u00e0y \u0111\u00e3 l\u00e0 LCA. N\u1ebfu <code>u</code> kh\u00f4ng ph\u1ea3i l\u00e0 t\u1ed5 ti\u00ean c\u1ee7a <code>v</code>, v\u00e0 <code>v</code> kh\u00f4ng ph\u1ea3i l\u00e0 t\u1ed5 ti\u00ean c\u1ee7a <code>u</code>, ch\u00fang ta leo l\u00ean c\u00e1c t\u1ed5 ti\u00ean c\u1ee7a <code>u</code> cho \u0111\u1ebfn khi ch\u00fang ta t\u00ecm th\u1ea5y n\u00fat cao nh\u1ea5t (t\u1ee9c l\u00e0 g\u1ea7n g\u1ed1c nh\u1ea5t), m\u00e0 kh\u00f4ng ph\u1ea3i l\u00e0 t\u1ed5 ti\u00ean c\u1ee7a <code>v</code> (t\u1ee9c l\u00e0 m\u1ed9t n\u00fat <code>x</code>, sao cho <code>x</code> kh\u00f4ng ph\u1ea3i l\u00e0 t\u1ed5 ti\u00ean c\u1ee7a <code>v</code>, nh\u01b0ng <code>up[x][0]</code> th\u00ec ph\u1ea3i). Ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm th\u1ea5y n\u00fat <code>x</code> n\u00e0y trong th\u1eddi gian $O(\\log N)$ b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng m\u1ea3ng <code>up</code>.</p> <p>Ch\u00fang t\u00f4i s\u1ebd m\u00f4 t\u1ea3 qu\u00e1 tr\u00ecnh n\u00e0y chi ti\u1ebft h\u01a1n. G\u1ecdi <code>L = ceil(log(N))</code>. Gi\u1ea3 s\u1eed tr\u01b0\u1edbc ti\u00ean r\u1eb1ng <code>i = L</code>. N\u1ebfu <code>up[u][i]</code> kh\u00f4ng ph\u1ea3i l\u00e0 t\u1ed5 ti\u00ean c\u1ee7a <code>v</code>, th\u00ec ch\u00fang ta c\u00f3 th\u1ec3 g\u00e1n <code>u = up[u][i]</code> v\u00e0 gi\u1ea3m <code>i</code>. N\u1ebfu <code>up[u][i]</code> l\u00e0 m\u1ed9t t\u1ed5 ti\u00ean, th\u00ec ch\u00fang ta ch\u1ec9 c\u1ea7n gi\u1ea3m <code>i</code>. R\u00f5 r\u00e0ng sau khi th\u1ef1c hi\u1ec7n vi\u1ec7c n\u00e0y cho t\u1ea5t c\u1ea3 c\u00e1c <code>i</code> kh\u00f4ng \u00e2m, n\u00fat <code>u</code> s\u1ebd l\u00e0 n\u00fat mong mu\u1ed1n - t\u1ee9c l\u00e0 <code>u</code> v\u1eabn kh\u00f4ng ph\u1ea3i l\u00e0 t\u1ed5 ti\u00ean c\u1ee7a <code>v</code>, nh\u01b0ng <code>up[u][0]</code> th\u00ec ph\u1ea3i.</p> <p>B\u00e2y gi\u1edd, r\u00f5 r\u00e0ng, c\u00e2u tr\u1ea3 l\u1eddi cho LCA s\u1ebd l\u00e0 <code>up[u][0]</code> - t\u1ee9c l\u00e0, n\u00fat nh\u1ecf nh\u1ea5t trong s\u1ed1 c\u00e1c t\u1ed5 ti\u00ean c\u1ee7a n\u00fat <code>u</code>, m\u00e0 c\u0169ng l\u00e0 m\u1ed9t t\u1ed5 ti\u00ean c\u1ee7a <code>v</code>.</p> <p>V\u00ec v\u1eady, vi\u1ec7c tr\u1ea3 l\u1eddi m\u1ed9t truy v\u1ea5n LCA s\u1ebd l\u1eb7p <code>i</code> t\u1eeb <code>ceil(log(N))</code> \u0111\u1ebfn <code>0</code> v\u00e0 ki\u1ec3m tra trong m\u1ed7i l\u1ea7n l\u1eb7p xem m\u1ed9t n\u00fat c\u00f3 ph\u1ea3i l\u00e0 t\u1ed5 ti\u00ean c\u1ee7a n\u00fat kia hay kh\u00f4ng. Do \u0111\u00f3, m\u1ed7i truy v\u1ea5n c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c tr\u1ea3 l\u1eddi trong $O(\\log N)$.</p>","tags":["Translated"]},{"location":"graph/lca_binary_lifting.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<pre><code>int n, l;\nvector&lt;vector&lt;int&gt;&gt; adj;\n\nint timer;\nvector&lt;int&gt; tin, tout;\nvector&lt;vector&lt;int&gt;&gt; up;\n\nvoid dfs(int v, int p)\n{\n    tin[v] = ++timer;\n    up[v][0] = p;\n    for (int i = 1; i &lt;= l; ++i)\n        up[v][i] = up[up[v][i-1]][i-1];\n\n    for (int u : adj[v]) {\n        if (u != p)\n            dfs(u, v);\n    }\n\n    tout[v] = ++timer;\n}\n\nbool is_ancestor(int u, int v)\n{\n    return tin[u] &lt;= tin[v] &amp;&amp; tout[u] &gt;= tout[v];\n}\n\nint lca(int u, int v)\n{\n    if (is_ancestor(u, v))\n        return u;\n    if (is_ancestor(v, u))\n        return v;\n    for (int i = l; i &gt;= 0; --i) {\n        if (!is_ancestor(up[u][i], v))\n            u = up[u][i];\n    }\n    return up[u][0];\n}\n\nvoid preprocess(int root) {\n    tin.resize(n);\n    tout.resize(n);\n    timer = 0;\n    l = ceil(log2(n));\n    up.assign(n, vector&lt;int&gt;(l + 1));\n    dfs(root, root);\n}\n</code></pre>","tags":["Translated"]},{"location":"graph/lca_binary_lifting.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>LeetCode -  Kth Ancestor of a Tree Node</li> <li>Codechef - Longest Good Segment</li> <li>HackerEarth - Optimal Connectivity</li> </ul>","tags":["Translated"]},{"location":"graph/lca_farachcoltonbender.html","title":"T\u1ed5 ti\u00ean chung th\u1ea5p nh\u1ea5t - Thu\u1eadt to\u00e1n Farach-Colton v\u00e0 Bender (Lowest Common Ancestor - Farach-Colton and Bender Algorithm)","text":"<p>Cho $G$ l\u00e0 m\u1ed9t c\u00e2y. \u0110\u1ed1i v\u1edbi m\u1ed7i truy v\u1ea5n c\u00f3 d\u1ea1ng $(u, v)$ ch\u00fang ta mu\u1ed1n t\u00ecm t\u1ed5 ti\u00ean chung th\u1ea5p nh\u1ea5t c\u1ee7a c\u00e1c n\u00fat $u$ v\u00e0 $v$, t\u1ee9c l\u00e0 ch\u00fang ta mu\u1ed1n t\u00ecm m\u1ed9t n\u00fat $w$ n\u1eb1m tr\u00ean \u0111\u01b0\u1eddng \u0111i t\u1eeb $u$ \u0111\u1ebfn n\u00fat g\u1ed1c, n\u1eb1m tr\u00ean \u0111\u01b0\u1eddng \u0111i t\u1eeb $v$ \u0111\u1ebfn n\u00fat g\u1ed1c, v\u00e0 n\u1ebfu c\u00f3 nhi\u1ec1u n\u00fat nh\u01b0 v\u1eady, ch\u00fang ta ch\u1ecdn n\u00fat xa n\u00fat g\u1ed1c nh\u1ea5t. N\u00f3i c\u00e1ch kh\u00e1c, n\u00fat $w$ mong mu\u1ed1n l\u00e0 t\u1ed5 ti\u00ean th\u1ea5p nh\u1ea5t c\u1ee7a $u$ v\u00e0 $v$. \u0110\u1eb7c bi\u1ec7t n\u1ebfu $u$ l\u00e0 t\u1ed5 ti\u00ean c\u1ee7a $v$, th\u00ec $u$ l\u00e0 t\u1ed5 ti\u00ean chung th\u1ea5p nh\u1ea5t c\u1ee7a ch\u00fang.</p> <p>Thu\u1eadt to\u00e1n s\u1ebd \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 trong b\u00e0i vi\u1ebft n\u00e0y \u0111\u01b0\u1ee3c ph\u00e1t tri\u1ec3n b\u1edfi Farach-Colton v\u00e0 Bender. N\u00f3 l\u00e0 t\u1ed1i \u01b0u ti\u1ec7m c\u1eadn.</p>","tags":["Translated"]},{"location":"graph/lca_farachcoltonbender.html#algorithm","title":"Thu\u1eadt to\u00e1n (Algorithm)","text":"<p>Ch\u00fang ta s\u1eed d\u1ee5ng ph\u00e9p quy gi\u1ea3n c\u1ed5 \u0111i\u1ec3n c\u1ee7a b\u00e0i to\u00e1n LCA v\u1ec1 b\u00e0i to\u00e1n RMQ. Ch\u00fang ta duy\u1ec7t t\u1ea5t c\u1ea3 c\u00e1c n\u00fat c\u1ee7a c\u00e2y b\u1eb1ng DFS v\u00e0 gi\u1eef m\u1ed9t m\u1ea3ng v\u1edbi t\u1ea5t c\u1ea3 c\u00e1c n\u00fat \u0111\u00e3 th\u0103m v\u00e0 \u0111\u1ed9 cao c\u1ee7a c\u00e1c n\u00fat n\u00e0y. LCA c\u1ee7a hai n\u00fat $u$ v\u00e0 $v$ l\u00e0 n\u00fat n\u1eb1m gi\u1eefa c\u00e1c l\u1ea7n xu\u1ea5t hi\u1ec7n c\u1ee7a $u$ v\u00e0 $v$ trong h\u00e0nh tr\u00ecnh (tour), c\u00f3 \u0111\u1ed9 cao nh\u1ecf nh\u1ea5t.</p> <p>Trong h\u00ecnh d\u01b0\u1edbi \u0111\u00e2y, b\u1ea1n c\u00f3 th\u1ec3 th\u1ea5y m\u1ed9t Euler-Tour c\u00f3 th\u1ec3 c\u00f3 c\u1ee7a m\u1ed9t \u0111\u1ed3 th\u1ecb v\u00e0 trong danh s\u00e1ch b\u00ean d\u01b0\u1edbi, b\u1ea1n c\u00f3 th\u1ec3 th\u1ea5y c\u00e1c n\u00fat \u0111\u00e3 th\u0103m v\u00e0 \u0111\u1ed9 cao c\u1ee7a ch\u00fang.</p> $$\\begin{array}{|l|c|c|c|c|c|c|c|c|c|c|c|c|c|} \\hline \\text{Nodes:}   &amp; 1 &amp; 2 &amp; 5 &amp; 2 &amp; 6 &amp; 2 &amp; 1 &amp; 3 &amp; 1 &amp; 4 &amp; 7 &amp; 4 &amp; 1 \\\\ \\hline \\text{Heights:} &amp; 1 &amp; 2 &amp; 3 &amp; 2 &amp; 3 &amp; 2 &amp; 1 &amp; 2 &amp; 1 &amp; 2 &amp; 3 &amp; 2 &amp; 1 \\\\ \\hline \\end{array}$$ <p>B\u1ea1n c\u00f3 th\u1ec3 \u0111\u1ecdc th\u00eam v\u1ec1 s\u1ef1 quy gi\u1ea3n n\u00e0y trong b\u00e0i vi\u1ebft T\u1ed5 ti\u00ean chung th\u1ea5p nh\u1ea5t. Trong b\u00e0i vi\u1ebft \u0111\u00f3, gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t c\u1ee7a m\u1ed9t ph\u1ea1m vi \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y b\u1eb1ng ph\u00e2n r\u00e3 c\u0103n b\u1eadc hai trong $O(\\sqrt{N})$ ho\u1eb7c trong $O(\\log N)$ s\u1eed d\u1ee5ng Segment tree. Trong b\u00e0i vi\u1ebft n\u00e0y, ch\u00fang ta xem x\u00e9t c\u00e1ch ch\u00fang ta c\u00f3 th\u1ec3 gi\u1ea3i quy\u1ebft c\u00e1c truy v\u1ea5n gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t trong ph\u1ea1m vi \u0111\u00e3 cho trong th\u1eddi gian $O(1)$, trong khi v\u1eabn ch\u1ec9 m\u1ea5t th\u1eddi gian $O(N)$ \u0111\u1ec3 ti\u1ec1n x\u1eed l\u00fd.</p> <p>L\u01b0u \u00fd r\u1eb1ng b\u00e0i to\u00e1n RMQ \u0111\u01b0\u1ee3c quy gi\u1ea3n r\u1ea5t c\u1ee5 th\u1ec3: b\u1ea5t k\u1ef3 hai ph\u1ea7n t\u1eed li\u1ec1n k\u1ec1 n\u00e0o trong m\u1ea3ng \u0111\u1ec1u kh\u00e1c nhau ch\u00ednh x\u00e1c m\u1ed9t \u0111\u01a1n v\u1ecb (v\u00ec c\u00e1c ph\u1ea7n t\u1eed c\u1ee7a m\u1ea3ng kh\u00f4ng g\u00ec kh\u00e1c h\u01a1n l\u00e0 \u0111\u1ed9 cao c\u1ee7a c\u00e1c n\u00fat \u0111\u01b0\u1ee3c th\u0103m theo th\u1ee9 t\u1ef1 duy\u1ec7t, v\u00e0 ch\u00fang ta ho\u1eb7c \u0111i \u0111\u1ebfn m\u1ed9t h\u1eadu du\u1ec7, trong tr\u01b0\u1eddng h\u1ee3p \u0111\u00f3 ph\u1ea7n t\u1eed ti\u1ebfp theo l\u1edbn h\u01a1n m\u1ed9t, ho\u1eb7c quay l\u1ea1i t\u1ed5 ti\u00ean, trong tr\u01b0\u1eddng h\u1ee3p \u0111\u00f3 ph\u1ea7n t\u1eed ti\u1ebfp theo nh\u1ecf h\u01a1n m\u1ed9t). Thu\u1eadt to\u00e1n Farach-Colton v\u00e0 Bender m\u00f4 t\u1ea3 m\u1ed9t gi\u1ea3i ph\u00e1p cho ch\u00ednh x\u00e1c b\u00e0i to\u00e1n RMQ chuy\u00ean bi\u1ec7t n\u00e0y.</p> <p>G\u1ecdi $A$ l\u00e0 m\u1ea3ng m\u00e0 ch\u00fang ta mu\u1ed1n th\u1ef1c hi\u1ec7n c\u00e1c truy v\u1ea5n gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t trong ph\u1ea1m vi. V\u00e0 $N$ s\u1ebd l\u00e0 k\u00edch th\u01b0\u1edbc c\u1ee7a $A$.</p> <p>C\u00f3 m\u1ed9t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u d\u1ec5 d\u00e0ng m\u00e0 ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng \u0111\u1ec3 gi\u1ea3i quy\u1ebft b\u00e0i to\u00e1n RMQ v\u1edbi ti\u1ec1n x\u1eed l\u00fd $O(N \\log N)$ v\u00e0 $O(1)$ cho m\u1ed7i truy v\u1ea5n: B\u1ea3ng th\u01b0a (Sparse Table). Ch\u00fang ta t\u1ea1o m\u1ed9t b\u1ea3ng $T$ trong \u0111\u00f3 m\u1ed7i ph\u1ea7n t\u1eed $T[i][j]$ b\u1eb1ng gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t c\u1ee7a $A$ trong kho\u1ea3ng $[i, i + 2^j - 1]$. R\u00f5 r\u00e0ng $0 \\leq j \\leq \\lceil \\log N \\rceil$, v\u00e0 do \u0111\u00f3 k\u00edch th\u01b0\u1edbc c\u1ee7a B\u1ea3ng th\u01b0a s\u1ebd l\u00e0 $O(N \\log N)$. B\u1ea1n c\u00f3 th\u1ec3 x\u00e2y d\u1ef1ng b\u1ea3ng d\u1ec5 d\u00e0ng trong $O(N \\log N)$ b\u1eb1ng c\u00e1ch l\u01b0u \u00fd r\u1eb1ng $T[i][j] = \\min(T[i][j-1], T[i+2^{j-1}][j-1])$.</p> <p>L\u00e0m th\u1ebf n\u00e0o ch\u00fang ta c\u00f3 th\u1ec3 tr\u1ea3 l\u1eddi m\u1ed9t truy v\u1ea5n RMQ trong $O(1)$ s\u1eed d\u1ee5ng c\u1ea5u tr\u00fac d\u1eef li\u1ec7u n\u00e0y? Gi\u1ea3 s\u1eed truy v\u1ea5n nh\u1eadn \u0111\u01b0\u1ee3c l\u00e0 $[l, r]$, th\u00ec c\u00e2u tr\u1ea3 l\u1eddi l\u00e0 $\\min(T[l][\\text{sz}], T[r-2^{\\text{sz}}+1][\\text{sz}])$, trong \u0111\u00f3 $\\text{sz}$ l\u00e0 s\u1ed1 m\u0169 l\u1edbn nh\u1ea5t sao cho $2^{\\text{sz}}$ kh\u00f4ng l\u1edbn h\u01a1n \u0111\u1ed9 d\u00e0i ph\u1ea1m vi $r-l+1$. Th\u1eadt v\u1eady, ch\u00fang ta c\u00f3 th\u1ec3 l\u1ea5y ph\u1ea1m vi $[l, r]$ v\u00e0 ph\u1ee7 n\u00f3 b\u1eb1ng hai \u0111o\u1ea1n c\u00f3 \u0111\u1ed9 d\u00e0i $2^{\\text{sz}}$ - m\u1ed9t \u0111o\u1ea1n b\u1eaft \u0111\u1ea7u t\u1eeb $l$ v\u00e0 \u0111o\u1ea1n kia k\u1ebft th\u00fac t\u1ea1i $r$. C\u00e1c \u0111o\u1ea1n n\u00e0y ch\u1ed3ng ch\u00e9o l\u00ean nhau, nh\u01b0ng \u0111i\u1ec1u n\u00e0y kh\u00f4ng \u1ea3nh h\u01b0\u1edfng \u0111\u1ebfn vi\u1ec7c t\u00ednh to\u00e1n c\u1ee7a ch\u00fang ta. \u0110\u1ec3 th\u1ef1c s\u1ef1 \u0111\u1ea1t \u0111\u01b0\u1ee3c \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian l\u00e0 $O(1)$ cho m\u1ed7i truy v\u1ea5n, ch\u00fang ta c\u1ea7n bi\u1ebft c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a $\\text{sz}$ cho t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ed9 d\u00e0i c\u00f3 th\u1ec3 t\u1eeb $1$ \u0111\u1ebfn $N$. Nh\u01b0ng \u0111i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n tr\u01b0\u1edbc.</p> <p>B\u00e2y gi\u1edd ch\u00fang ta mu\u1ed1n c\u1ea3i thi\u1ec7n \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a qu\u00e1 tr\u00ecnh ti\u1ec1n x\u1eed l\u00fd xu\u1ed1ng c\u00f2n $O(N)$.</p> <p>Ch\u00fang ta chia m\u1ea3ng $A$ th\u00e0nh c\u00e1c kh\u1ed1i c\u00f3 k\u00edch th\u01b0\u1edbc $K = 0.5 \\log N$ v\u1edbi $\\log$ l\u00e0 logarit c\u01a1 s\u1ed1 2. \u0110\u1ed1i v\u1edbi m\u1ed7i kh\u1ed1i, ch\u00fang ta t\u00ednh to\u00e1n ph\u1ea7n t\u1eed nh\u1ecf nh\u1ea5t v\u00e0 l\u01b0u tr\u1eef ch\u00fang trong m\u1ed9t m\u1ea3ng $B$. $B$ c\u00f3 k\u00edch th\u01b0\u1edbc $\\frac{N}{K}$. Ch\u00fang ta x\u00e2y d\u1ef1ng m\u1ed9t b\u1ea3ng th\u01b0a t\u1eeb m\u1ea3ng $B$. K\u00edch th\u01b0\u1edbc v\u00e0 \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian c\u1ee7a n\u00f3 s\u1ebd l\u00e0:</p> $$\\frac{N}{K}\\log\\left(\\frac{N}{K}\\right) = \\frac{2N}{\\log(N)} \\log\\left(\\frac{2N}{\\log(N)}\\right) =$$ $$= \\frac{2N}{\\log(N)} \\left(1 + \\log\\left(\\frac{N}{\\log(N)}\\right)\\right) \\leq \\frac{2N}{\\log(N)} + 2N = O(N)$$ <p>B\u00e2y gi\u1edd ch\u00fang ta ch\u1ec9 ph\u1ea3i h\u1ecdc c\u00e1ch tr\u1ea3 l\u1eddi nhanh c\u00e1c truy v\u1ea5n gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t trong ph\u1ea1m vi b\u00ean trong m\u1ed7i kh\u1ed1i. Tr\u00ean th\u1ef1c t\u1ebf, n\u1ebfu truy v\u1ea5n gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t trong ph\u1ea1m vi nh\u1eadn \u0111\u01b0\u1ee3c l\u00e0 $[l, r]$ v\u00e0 $l$ v\u00e0 $r$ n\u1eb1m trong c\u00e1c kh\u1ed1i kh\u00e1c nhau th\u00ec c\u00e2u tr\u1ea3 l\u1eddi l\u00e0 gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t c\u1ee7a ba gi\u00e1 tr\u1ecb sau: gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t c\u1ee7a ph\u1ea7n h\u1eadu t\u1ed1 c\u1ee7a kh\u1ed1i c\u1ee7a $l$ b\u1eaft \u0111\u1ea7u t\u1ea1i $l$, gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t c\u1ee7a ph\u1ea7n ti\u1ec1n t\u1ed1 c\u1ee7a kh\u1ed1i c\u1ee7a $r$ k\u1ebft th\u00fac t\u1ea1i $r$, v\u00e0 gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t c\u1ee7a c\u00e1c kh\u1ed1i n\u1eb1m gi\u1eefa ch\u00fang. Gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t c\u1ee7a c\u00e1c kh\u1ed1i \u1edf gi\u1eefa c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c tr\u1ea3 l\u1eddi trong $O(1)$ b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng B\u1ea3ng th\u01b0a. V\u00ec v\u1eady, \u0111i\u1ec1u n\u00e0y ch\u1ec9 \u0111\u1ec3 l\u1ea1i cho ch\u00fang ta c\u00e1c truy v\u1ea5n gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t trong ph\u1ea1m vi b\u00ean trong c\u00e1c kh\u1ed1i.</p> <p>\u1ede \u0111\u00e2y ch\u00fang ta s\u1ebd khai th\u00e1c t\u00ednh ch\u1ea5t c\u1ee7a m\u1ea3ng. H\u00e3y nh\u1edb r\u1eb1ng c\u00e1c gi\u00e1 tr\u1ecb trong m\u1ea3ng - v\u1ed1n ch\u1ec9 l\u00e0 c\u00e1c gi\u00e1 tr\u1ecb \u0111\u1ed9 cao trong c\u00e2y - s\u1ebd lu\u00f4n kh\u00e1c nhau m\u1ed9t \u0111\u01a1n v\u1ecb. N\u1ebfu ch\u00fang ta lo\u1ea1i b\u1ecf ph\u1ea7n t\u1eed \u0111\u1ea7u ti\u00ean c\u1ee7a m\u1ed9t kh\u1ed1i, v\u00e0 tr\u1eeb n\u00f3 kh\u1ecfi m\u1ecdi ph\u1ea7n t\u1eed kh\u00e1c trong kh\u1ed1i, m\u1ed7i kh\u1ed1i c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh b\u1edfi m\u1ed9t chu\u1ed7i c\u00f3 \u0111\u1ed9 d\u00e0i $K - 1$ bao g\u1ed3m s\u1ed1 $+1$ v\u00e0 $-1$. B\u1edfi v\u00ec c\u00e1c kh\u1ed1i n\u00e0y qu\u00e1 nh\u1ecf, ch\u1ec9 c\u00f3 m\u1ed9t v\u00e0i chu\u1ed7i kh\u00e1c nhau c\u00f3 th\u1ec3 x\u1ea3y ra. S\u1ed1 l\u01b0\u1ee3ng chu\u1ed7i c\u00f3 th\u1ec3 l\u00e0:</p> $$2^{K-1} = 2^{0.5 \\log(N) - 1} = 0.5 \\left(2^{\\log(N)}\\right)^{0.5} = 0.5 \\sqrt{N}$$ <p>Do \u0111\u00f3 s\u1ed1 l\u01b0\u1ee3ng c\u00e1c kh\u1ed1i kh\u00e1c nhau l\u00e0 $O(\\sqrt{N})$, v\u00e0 do \u0111\u00f3 ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh to\u00e1n tr\u01b0\u1edbc k\u1ebft qu\u1ea3 c\u1ee7a c\u00e1c truy v\u1ea5n gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t trong ph\u1ea1m vi b\u00ean trong t\u1ea5t c\u1ea3 c\u00e1c kh\u1ed1i kh\u00e1c nhau trong th\u1eddi gian $O(\\sqrt{N} K^2) = O(\\sqrt{N} \\log^2(N)) = O(N)$. \u0110\u1ec3 c\u00e0i \u0111\u1eb7t, ch\u00fang ta c\u00f3 th\u1ec3 \u0111\u1eb7c tr\u01b0ng h\u00f3a m\u1ed9t kh\u1ed1i b\u1eb1ng m\u1ed9t bitmask c\u00f3 \u0111\u1ed9 d\u00e0i $K-1$ (s\u1ebd v\u1eeba trong m\u1ed9t int ti\u00eau chu\u1ea9n) v\u00e0 l\u01b0u tr\u1eef ch\u1ec9 s\u1ed1 c\u1ee7a gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t trong m\u1ed9t m\u1ea3ng $\\text{block}[\\text{mask}][l][r]$ c\u00f3 k\u00edch th\u01b0\u1edbc $O(\\sqrt{N} \\log^2(N))$.</p> <p>V\u00ec v\u1eady, ch\u00fang ta \u0111\u00e3 h\u1ecdc c\u00e1ch t\u00ednh to\u00e1n tr\u01b0\u1edbc c\u00e1c truy v\u1ea5n gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t trong ph\u1ea1m vi b\u00ean trong m\u1ed7i kh\u1ed1i, c\u0169ng nh\u01b0 c\u00e1c truy v\u1ea5n gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t trong ph\u1ea1m vi tr\u00ean m\u1ed9t ph\u1ea1m vi c\u00e1c kh\u1ed1i, t\u1ea5t c\u1ea3 trong $O(N)$. V\u1edbi c\u00e1c t\u00ednh to\u00e1n tr\u01b0\u1edbc n\u00e0y, ch\u00fang ta c\u00f3 th\u1ec3 tr\u1ea3 l\u1eddi m\u1ed7i truy v\u1ea5n trong $O(1)$, b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng t\u1ed1i \u0111a b\u1ed1n gi\u00e1 tr\u1ecb \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n tr\u01b0\u1edbc: gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t c\u1ee7a kh\u1ed1i ch\u1ee9a <code>l</code>, gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t c\u1ee7a kh\u1ed1i ch\u1ee9a <code>r</code>, v\u00e0 hai gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t c\u1ee7a c\u00e1c \u0111o\u1ea1n ch\u1ed3ng ch\u00e9o c\u1ee7a c\u00e1c kh\u1ed1i gi\u1eefa ch\u00fang.</p>","tags":["Translated"]},{"location":"graph/lca_farachcoltonbender.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<pre><code>int n;\nvector&lt;vector&lt;int&gt;&gt; adj;\n\nint block_size, block_cnt;\nvector&lt;int&gt; first_visit;\nvector&lt;int&gt; euler_tour;\nvector&lt;int&gt; height;\nvector&lt;int&gt; log_2;\nvector&lt;vector&lt;int&gt;&gt; st;\nvector&lt;vector&lt;vector&lt;int&gt;&gt;&gt; blocks;\nvector&lt;int&gt; block_mask;\n\nvoid dfs(int v, int p, int h) {\n    first_visit[v] = euler_tour.size();\n    euler_tour.push_back(v);\n    height[v] = h;\n\n    for (int u : adj[v]) {\n        if (u == p)\n            continue;\n        dfs(u, v, h + 1);\n        euler_tour.push_back(v);\n    }\n}\n\nint min_by_h(int i, int j) {\n    return height[euler_tour[i]] &lt; height[euler_tour[j]] ? i : j;\n}\n\nvoid precompute_lca(int root) {\n    // l\u1ea5y euler tour &amp; ch\u1ec9 s\u1ed1 c\u1ee7a l\u1ea7n xu\u1ea5t hi\u1ec7n \u0111\u1ea7u ti\u00ean\n    first_visit.assign(n, -1);\n    height.assign(n, 0);\n    euler_tour.reserve(2 * n);\n    dfs(root, -1, 0);\n\n    // t\u00ednh to\u00e1n tr\u01b0\u1edbc t\u1ea5t c\u1ea3 c\u00e1c gi\u00e1 tr\u1ecb log\n    int m = euler_tour.size();\n    log_2.reserve(m + 1);\n    log_2.push_back(-1);\n    for (int i = 1; i &lt;= m; i++)\n        log_2.push_back(log_2[i / 2] + 1);\n\n    block_size = max(1, log_2[m] / 2);\n    block_cnt = (m + block_size - 1) / block_size;\n\n    // t\u00ednh to\u00e1n tr\u01b0\u1edbc gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t c\u1ee7a m\u1ed7i kh\u1ed1i v\u00e0 x\u00e2y d\u1ef1ng b\u1ea3ng th\u01b0a\n    st.assign(block_cnt, vector&lt;int&gt;(log_2[block_cnt] + 1));\n    for (int i = 0, j = 0, b = 0; i &lt; m; i++, j++) {\n        if (j == block_size)\n            j = 0, b++;\n        if (j == 0 || min_by_h(i, st[b][0]) == i)\n            st[b][0] = i;\n    }\n    for (int l = 1; l &lt;= log_2[block_cnt]; l++) {\n        for (int i = 0; i &lt; block_cnt; i++) {\n            int ni = i + (1 &lt;&lt; (l - 1));\n            if (ni &gt;= block_cnt)\n                st[i][l] = st[i][l-1];\n            else\n                st[i][l] = min_by_h(st[i][l-1], st[ni][l-1]);\n        }\n    }\n\n    // t\u00ednh to\u00e1n tr\u01b0\u1edbc mask cho m\u1ed7i kh\u1ed1i\n    block_mask.assign(block_cnt, 0);\n    for (int i = 0, j = 0, b = 0; i &lt; m; i++, j++) {\n        if (j == block_size)\n            j = 0, b++;\n        if (j &gt; 0 &amp;&amp; (i &gt;= m || min_by_h(i - 1, i) == i - 1))\n            block_mask[b] += 1 &lt;&lt; (j - 1);\n    }\n\n    // t\u00ednh to\u00e1n tr\u01b0\u1edbc RMQ cho m\u1ed7i kh\u1ed1i duy nh\u1ea5t\n    int possibilities = 1 &lt;&lt; (block_size - 1);\n    blocks.resize(possibilities);\n    for (int b = 0; b &lt; block_cnt; b++) {\n        int mask = block_mask[b];\n        if (!blocks[mask].empty())\n            continue;\n        blocks[mask].assign(block_size, vector&lt;int&gt;(block_size));\n        for (int l = 0; l &lt; block_size; l++) {\n            blocks[mask][l][l] = l;\n            for (int r = l + 1; r &lt; block_size; r++) {\n                blocks[mask][l][r] = blocks[mask][l][r - 1];\n                if (b * block_size + r &lt; m)\n                    blocks[mask][l][r] = min_by_h(b * block_size + blocks[mask][l][r], \n                            b * block_size + r) - b * block_size;\n            }\n        }\n    }\n}\n\nint lca_in_block(int b, int l, int r) {\n    return blocks[block_mask[b]][l][r] + b * block_size;\n}\n\nint lca(int v, int u) {\n    int l = first_visit[v];\n    int r = first_visit[u];\n    if (l &gt; r)\n        swap(l, r);\n    int bl = l / block_size;\n    int br = r / block_size;\n    if (bl == br)\n        return euler_tour[lca_in_block(bl, l % block_size, r % block_size)];\n    int ans1 = lca_in_block(bl, l % block_size, block_size - 1);\n    int ans2 = lca_in_block(br, 0, r % block_size);\n    int ans = min_by_h(ans1, ans2);\n    if (bl + 1 &lt; br) {\n        int l = log_2[br - bl - 1];\n        int ans3 = st[bl+1][l];\n        int ans4 = st[br - (1 &lt;&lt; l)][l];\n        ans = min_by_h(ans, min_by_h(ans3, ans4));\n    }\n    return euler_tour[ans];\n}\n</code></pre>","tags":["Translated"]},{"location":"graph/lca_tarjan.html","title":"T\u1ed5 ti\u00ean chung th\u1ea5p nh\u1ea5t - Thu\u1eadt to\u00e1n off-line c\u1ee7a Tarjan (Lowest Common Ancestor - Tarjan's off-line algorithm)","text":"<p>Ch\u00fang ta c\u00f3 m\u1ed9t c\u00e2y $G$ v\u1edbi $n$ n\u00fat v\u00e0 ch\u00fang ta c\u00f3 $m$ truy v\u1ea5n c\u00f3 d\u1ea1ng $(u, v)$. \u0110\u1ed1i v\u1edbi m\u1ed7i truy v\u1ea5n $(u, v)$ ch\u00fang ta mu\u1ed1n t\u00ecm t\u1ed5 ti\u00ean chung th\u1ea5p nh\u1ea5t c\u1ee7a c\u00e1c \u0111\u1ec9nh $u$ v\u00e0 $v$, t\u1ee9c l\u00e0 n\u00fat l\u00e0 t\u1ed5 ti\u00ean c\u1ee7a c\u1ea3 $u$ v\u00e0 $v$ v\u00e0 c\u00f3 \u0111\u1ed9 s\u00e2u l\u1edbn nh\u1ea5t trong c\u00e2y. N\u00fat $v$ c\u0169ng l\u00e0 t\u1ed5 ti\u00ean c\u1ee7a $v$, v\u00ec v\u1eady LCA c\u0169ng c\u00f3 th\u1ec3 l\u00e0 m\u1ed9t trong hai n\u00fat.</p> <p>Trong b\u00e0i vi\u1ebft n\u00e0y, ch\u00fang ta s\u1ebd gi\u1ea3i quy\u1ebft b\u00e0i to\u00e1n off-line, t\u1ee9c l\u00e0 ch\u00fang ta gi\u1ea3 \u0111\u1ecbnh r\u1eb1ng t\u1ea5t c\u1ea3 c\u00e1c truy v\u1ea5n \u0111\u1ec1u \u0111\u01b0\u1ee3c bi\u1ebft tr\u01b0\u1edbc, v\u00e0 do \u0111\u00f3 ch\u00fang ta tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n theo b\u1ea5t k\u1ef3 th\u1ee9 t\u1ef1 n\u00e0o ch\u00fang ta mu\u1ed1n. Thu\u1eadt to\u00e1n sau \u0111\u00e2y cho ph\u00e9p tr\u1ea3 l\u1eddi t\u1ea5t c\u1ea3 $m$ truy v\u1ea5n trong t\u1ed5ng th\u1eddi gian $O(n + m)$, t\u1ee9c l\u00e0 v\u1edbi $m$ \u0111\u1ee7 l\u1edbn trong $O(1)$ cho m\u1ed7i truy v\u1ea5n.</p>","tags":["Translated"]},{"location":"graph/lca_tarjan.html#algorithm","title":"Thu\u1eadt to\u00e1n (Algorithm)","text":"<p>Thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c \u0111\u1eb7t theo t\u00ean c\u1ee7a Robert Tarjan, ng\u01b0\u1eddi \u0111\u00e3 ph\u00e1t hi\u1ec7n ra n\u00f3 v\u00e0o n\u0103m 1979 v\u00e0 c\u0169ng c\u00f3 nhi\u1ec1u \u0111\u00f3ng g\u00f3p kh\u00e1c cho c\u1ea5u tr\u00fac d\u1eef li\u1ec7u Disjoint Set Union, v\u1ed1n s\u1ebd \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng r\u1ea5t nhi\u1ec1u trong thu\u1eadt to\u00e1n n\u00e0y.</p> <p>Thu\u1eadt to\u00e1n tr\u1ea3 l\u1eddi t\u1ea5t c\u1ea3 c\u00e1c truy v\u1ea5n b\u1eb1ng m\u1ed9t l\u1ea7n duy\u1ec7t DFS tr\u00ean c\u00e2y. C\u1ee5 th\u1ec3, m\u1ed9t truy v\u1ea5n $(u, v)$ \u0111\u01b0\u1ee3c tr\u1ea3 l\u1eddi t\u1ea1i n\u00fat $u$, n\u1ebfu n\u00fat $v$ \u0111\u00e3 \u0111\u01b0\u1ee3c th\u0103m tr\u01b0\u1edbc \u0111\u00f3, ho\u1eb7c ng\u01b0\u1ee3c l\u1ea1i.</p> <p>V\u00ec v\u1eady, gi\u1ea3 s\u1eed ch\u00fang ta hi\u1ec7n \u0111ang \u1edf n\u00fat $v$, ch\u00fang ta \u0111\u00e3 th\u1ef1c hi\u1ec7n c\u00e1c l\u1ec7nh g\u1ecdi DFS \u0111\u1ec7 quy, v\u00e0 c\u0169ng \u0111\u00e3 th\u0103m n\u00fat th\u1ee9 hai $u$ t\u1eeb truy v\u1ea5n $(u, v)$. Ch\u00fang ta h\u00e3y t\u00ecm hi\u1ec3u c\u00e1ch t\u00ecm LCA c\u1ee7a hai n\u00fat n\u00e0y.</p> <p>L\u01b0u \u00fd r\u1eb1ng $\\text{LCA}(u, v)$ l\u00e0 n\u00fat $v$ ho\u1eb7c m\u1ed9t trong c\u00e1c t\u1ed5 ti\u00ean c\u1ee7a n\u00f3. V\u00ec v\u1eady, ch\u00fang ta c\u1ea7n t\u00ecm n\u00fat th\u1ea5p nh\u1ea5t trong s\u1ed1 c\u00e1c t\u1ed5 ti\u00ean c\u1ee7a $v$ (bao g\u1ed3m c\u1ea3 $v$), m\u00e0 n\u00fat $u$ l\u00e0 h\u1eadu du\u1ec7 c\u1ee7a n\u00f3. C\u0169ng l\u01b0u \u00fd r\u1eb1ng \u0111\u1ed1i v\u1edbi m\u1ed9t $v$ c\u1ed1 \u0111\u1ecbnh, c\u00e1c n\u00fat \u0111\u00e3 th\u0103m c\u1ee7a c\u00e2y chia th\u00e0nh m\u1ed9t t\u1eadp h\u1ee3p c\u00e1c t\u1eadp h\u1ee3p r\u1eddi r\u1ea1c. M\u1ed7i t\u1ed5 ti\u00ean $p$ c\u1ee7a n\u00fat $v$ c\u00f3 t\u1eadp h\u1ee3p ri\u00eang ch\u1ee9a n\u00fat n\u00e0y v\u00e0 t\u1ea5t c\u1ea3 c\u00e1c c\u00e2y con c\u00f3 g\u1ed1c trong s\u1ed1 c\u00e1c con c\u1ee7a n\u00f3 kh\u00f4ng ph\u1ea3i l\u00e0 m\u1ed9t ph\u1ea7n c\u1ee7a \u0111\u01b0\u1eddng \u0111i t\u1eeb $v$ \u0111\u1ebfn g\u1ed1c c\u1ee7a c\u00e2y. T\u1eadp h\u1ee3p ch\u1ee9a n\u00fat $u$ x\u00e1c \u0111\u1ecbnh $\\text{LCA}(u, v)$: LCA l\u00e0 \u0111\u1ea1i di\u1ec7n c\u1ee7a t\u1eadp h\u1ee3p, c\u1ee5 th\u1ec3 l\u00e0 n\u00fat n\u1eb1m tr\u00ean \u0111\u01b0\u1eddng \u0111i gi\u1eefa $v$ v\u00e0 g\u1ed1c c\u1ee7a c\u00e2y.</p> <p>Ch\u00fang ta ch\u1ec9 c\u1ea7n h\u1ecdc c\u00e1ch duy tr\u00ec hi\u1ec7u qu\u1ea3 t\u1ea5t c\u1ea3 c\u00e1c t\u1eadp h\u1ee3p n\u00e0y. Cho m\u1ee5c \u0111\u00edch n\u00e0y, ch\u00fang ta \u00e1p d\u1ee5ng c\u1ea5u tr\u00fac d\u1eef li\u1ec7u DSU. \u0110\u1ec3 c\u00f3 th\u1ec3 \u00e1p d\u1ee5ng Union by rank, ch\u00fang ta l\u01b0u tr\u1eef \u0111\u1ea1i di\u1ec7n th\u1ef1c (gi\u00e1 tr\u1ecb tr\u00ean \u0111\u01b0\u1eddng \u0111i gi\u1eefa $v$ v\u00e0 g\u1ed1c c\u1ee7a c\u00e2y) c\u1ee7a m\u1ed7i t\u1eadp h\u1ee3p trong m\u1ea3ng <code>ancestor</code>.</p> <p>Ch\u00fang ta h\u00e3y th\u1ea3o lu\u1eadn v\u1ec1 vi\u1ec7c c\u00e0i \u0111\u1eb7t DFS. Gi\u1ea3 s\u1eed ch\u00fang ta \u0111ang th\u0103m n\u00fat $v$. Ch\u00fang ta \u0111\u1eb7t n\u00fat v\u00e0o m\u1ed9t t\u1eadp h\u1ee3p m\u1edbi trong DSU, <code>ancestor[v] = v</code>. Nh\u01b0 th\u01b0\u1eddng l\u1ec7 ch\u00fang ta x\u1eed l\u00fd t\u1ea5t c\u1ea3 c\u00e1c con c\u1ee7a $v$. \u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y, tr\u01b0\u1edbc ti\u00ean ch\u00fang ta ph\u1ea3i g\u1ecdi \u0111\u1ec7 quy DFS t\u1eeb n\u00fat \u0111\u00f3, v\u00e0 sau \u0111\u00f3 th\u00eam n\u00fat n\u00e0y c\u00f9ng v\u1edbi t\u1ea5t c\u1ea3 c\u00e2y con c\u1ee7a n\u00f3 v\u00e0o t\u1eadp h\u1ee3p c\u1ee7a $v$. \u0110i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n v\u1edbi h\u00e0m <code>union_sets</code> v\u00e0 ph\u00e9p g\u00e1n sau <code>ancestor[find_set(v)] = v</code> (\u0111i\u1ec1u n\u00e0y l\u00e0 c\u1ea7n thi\u1ebft, v\u00ec <code>union_sets</code> c\u00f3 th\u1ec3 thay \u0111\u1ed5i \u0111\u1ea1i di\u1ec7n c\u1ee7a t\u1eadp h\u1ee3p).</p> <p>Cu\u1ed1i c\u00f9ng sau khi x\u1eed l\u00fd t\u1ea5t c\u1ea3 c\u00e1c con, ch\u00fang ta c\u00f3 th\u1ec3 tr\u1ea3 l\u1eddi t\u1ea5t c\u1ea3 c\u00e1c truy v\u1ea5n c\u00f3 d\u1ea1ng $(u, v)$ m\u00e0 $u$ \u0111\u00e3 \u0111\u01b0\u1ee3c th\u0103m. C\u00e2u tr\u1ea3 l\u1eddi cho truy v\u1ea5n, t\u1ee9c l\u00e0 LCA c\u1ee7a $u$ v\u00e0 $v$, s\u1ebd l\u00e0 n\u00fat <code>ancestor[find_set(u)]</code>. D\u1ec5 d\u00e0ng th\u1ea5y r\u1eb1ng m\u1ed9t truy v\u1ea5n s\u1ebd ch\u1ec9 \u0111\u01b0\u1ee3c tr\u1ea3 l\u1eddi m\u1ed9t l\u1ea7n.</p> <p>Ch\u00fang ta h\u00e3y x\u00e1c \u0111\u1ecbnh \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian c\u1ee7a thu\u1eadt to\u00e1n n\u00e0y. \u0110\u1ea7u ti\u00ean ch\u00fang ta c\u00f3 $O(n)$ v\u00ec DFS. Th\u1ee9 hai ch\u00fang ta c\u00f3 c\u00e1c l\u1ec7nh g\u1ecdi h\u00e0m c\u1ee7a <code>union_sets</code> x\u1ea3y ra $n$ l\u1ea7n, c\u0169ng d\u1eabn \u0111\u1ebfn $O(n)$. V\u00e0 th\u1ee9 ba ch\u00fang ta c\u00f3 c\u00e1c l\u1ec7nh g\u1ecdi <code>find_set</code> cho m\u1ed7i truy v\u1ea5n, \u0111i\u1ec1u n\u00e0y mang l\u1ea1i $O(m)$. V\u00ec v\u1eady, t\u1ed5ng \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian l\u00e0 $O(n + m)$, c\u00f3 ngh\u0129a l\u00e0 v\u1edbi $m$ \u0111\u1ee7 l\u1edbn, \u0111i\u1ec1u n\u00e0y t\u01b0\u01a1ng \u1ee9ng v\u1edbi $O(1)$ \u0111\u1ec3 tr\u1ea3 l\u1eddi m\u1ed9t truy v\u1ea5n.</p>","tags":["Translated"]},{"location":"graph/lca_tarjan.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u1ed9t c\u00e0i \u0111\u1eb7t c\u1ee7a thu\u1eadt to\u00e1n n\u00e0y. Vi\u1ec7c c\u00e0i \u0111\u1eb7t DSU \u0111\u00e3 kh\u00f4ng \u0111\u01b0\u1ee3c bao g\u1ed3m, v\u00ec n\u00f3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng m\u00e0 kh\u00f4ng c\u1ea7n s\u1eeda \u0111\u1ed5i g\u00ec.</p> <pre><code>vector&lt;vector&lt;int&gt;&gt; adj;\nvector&lt;vector&lt;int&gt;&gt; queries;\nvector&lt;int&gt; ancestor;\nvector&lt;bool&gt; visited;\n\nvoid dfs(int v)\n{\n    visited[v] = true;\n    ancestor[v] = v;\n    for (int u : adj[v]) {\n        if (!visited[u]) {\n            dfs(u);\n            union_sets(v, u);\n            ancestor[find_set(v)] = v;\n        }\n    }\n    for (int other_node : queries[v]) {\n        if (visited[other_node])\n            cout &lt;&lt; \"LCA of \" &lt;&lt; v &lt;&lt; \" and \" &lt;&lt; other_node\n                 &lt;&lt; \" is \" &lt;&lt; ancestor[find_set(other_node)] &lt;&lt; \".\\n\";\n    }\n}\n\nvoid compute_LCAs() {\n    // kh\u1edfi t\u1ea1o n, adj v\u00e0 DSU\n    // for (each query (u, v)) {\n    //    queries[u].push_back(v);\n    //    queries[v].push_back(u);\n    // }\n\n    ancestor.resize(n);\n    visited.assign(n, false);\n    dfs(0);\n}\n</code></pre>","tags":["Translated"]},{"location":"graph/min_cost_flow.html","title":"Lu\u1ed3ng chi ph\u00ed nh\u1ecf nh\u1ea5t - Thu\u1eadt to\u00e1n \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t li\u00ean ti\u1ebfp (Minimum-cost flow - Successive shortest path algorithm)","text":"<p>Cho m\u1ed9t m\u1ea1ng $G$ bao g\u1ed3m $n$ \u0111\u1ec9nh v\u00e0 $m$ c\u1ea1nh. \u0110\u1ed1i v\u1edbi m\u1ed7i c\u1ea1nh (n\u00f3i chung l\u00e0 c\u00e1c c\u1ea1nh c\u00f3 h\u01b0\u1edbng, nh\u01b0ng xem b\u00ean d\u01b0\u1edbi), dung l\u01b0\u1ee3ng (m\u1ed9t s\u1ed1 nguy\u00ean kh\u00f4ng \u00e2m) v\u00e0 chi ph\u00ed tr\u00ean m\u1ed9t \u0111\u01a1n v\u1ecb lu\u1ed3ng d\u1ecdc theo c\u1ea1nh n\u00e0y (m\u1ed9t s\u1ed1 nguy\u00ean n\u00e0o \u0111\u00f3) \u0111\u01b0\u1ee3c \u0111\u01b0a ra. Ngu\u1ed3n $s$ v\u00e0 \u0111\u00edch $t$ c\u0169ng \u0111\u01b0\u1ee3c \u0111\u00e1nh d\u1ea5u.</p> <p>V\u1edbi m\u1ed9t gi\u00e1 tr\u1ecb $K$ cho tr\u01b0\u1edbc, ch\u00fang ta ph\u1ea3i t\u00ecm m\u1ed9t lu\u1ed3ng c\u00f3 l\u01b0\u1ee3ng n\u00e0y, v\u00e0 trong s\u1ed1 t\u1ea5t c\u1ea3 c\u00e1c lu\u1ed3ng c\u00f3 l\u01b0\u1ee3ng n\u00e0y, ch\u00fang ta ph\u1ea3i ch\u1ecdn lu\u1ed3ng c\u00f3 chi ph\u00ed th\u1ea5p nh\u1ea5t. Nhi\u1ec7m v\u1ee5 n\u00e0y \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 b\u00e0i to\u00e1n lu\u1ed3ng chi ph\u00ed nh\u1ecf nh\u1ea5t (minimum-cost flow problem).</p> <p>\u0110\u00f4i khi nhi\u1ec7m v\u1ee5 \u0111\u01b0\u1ee3c \u0111\u01b0a ra h\u01a1i kh\u00e1c m\u1ed9t ch\u00fat: b\u1ea1n mu\u1ed1n t\u00ecm lu\u1ed3ng c\u1ef1c \u0111\u1ea1i, v\u00e0 trong s\u1ed1 t\u1ea5t c\u1ea3 c\u00e1c lu\u1ed3ng c\u1ef1c \u0111\u1ea1i, ch\u00fang ta mu\u1ed1n t\u00ecm lu\u1ed3ng c\u00f3 chi ph\u00ed th\u1ea5p nh\u1ea5t. \u0110\u00e2y \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 b\u00e0i to\u00e1n lu\u1ed3ng c\u1ef1c \u0111\u1ea1i chi ph\u00ed nh\u1ecf nh\u1ea5t (minimum-cost maximum-flow problem).</p> <p>C\u1ea3 hai b\u00e0i to\u00e1n n\u00e0y \u0111\u1ec1u c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i quy\u1ebft hi\u1ec7u qu\u1ea3 b\u1eb1ng thu\u1eadt to\u00e1n \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t li\u00ean ti\u1ebfp.</p>","tags":["Translated"]},{"location":"graph/min_cost_flow.html#algorithm","title":"Thu\u1eadt to\u00e1n (Algorithm)","text":"<p>Thu\u1eadt to\u00e1n n\u00e0y r\u1ea5t gi\u1ed1ng v\u1edbi Edmonds-Karp \u0111\u1ec3 t\u00ednh to\u00e1n lu\u1ed3ng c\u1ef1c \u0111\u1ea1i.</p>","tags":["Translated"]},{"location":"graph/min_cost_flow.html#simplest-case","title":"Tr\u01b0\u1eddng h\u1ee3p \u0111\u01a1n gi\u1ea3n nh\u1ea5t (Simplest case)","text":"<p>Tr\u01b0\u1edbc ti\u00ean, ch\u00fang ta ch\u1ec9 xem x\u00e9t tr\u01b0\u1eddng h\u1ee3p \u0111\u01a1n gi\u1ea3n nh\u1ea5t, trong \u0111\u00f3 \u0111\u1ed3 th\u1ecb c\u00f3 h\u01b0\u1edbng v\u00e0 c\u00f3 t\u1ed1i \u0111a m\u1ed9t c\u1ea1nh gi\u1eefa b\u1ea5t k\u1ef3 c\u1eb7p \u0111\u1ec9nh n\u00e0o (v\u00ed d\u1ee5: n\u1ebfu $(i, j)$ l\u00e0 m\u1ed9t c\u1ea1nh trong \u0111\u1ed3 th\u1ecb, th\u00ec $(j, i)$ c\u0169ng kh\u00f4ng th\u1ec3 l\u00e0 m\u1ed9t ph\u1ea7n trong \u0111\u00f3).</p> <p>G\u1ecdi $U_{i j}$ l\u00e0 dung l\u01b0\u1ee3ng c\u1ee7a m\u1ed9t c\u1ea1nh $(i, j)$ n\u1ebfu c\u1ea1nh n\u00e0y t\u1ed3n t\u1ea1i. V\u00e0 g\u1ecdi $C_{i j}$ l\u00e0 chi ph\u00ed tr\u00ean m\u1ed9t \u0111\u01a1n v\u1ecb lu\u1ed3ng d\u1ecdc theo c\u1ea1nh n\u00e0y $(i, j)$. V\u00e0 cu\u1ed1i c\u00f9ng g\u1ecdi $F_{i, j}$ l\u00e0 lu\u1ed3ng d\u1ecdc theo c\u1ea1nh $(i, j)$. Ban \u0111\u1ea7u t\u1ea5t c\u1ea3 c\u00e1c gi\u00e1 tr\u1ecb lu\u1ed3ng l\u00e0 s\u1ed1 kh\u00f4ng.</p> <p>Ch\u00fang ta s\u1eeda \u0111\u1ed5i m\u1ea1ng nh\u01b0 sau: \u0111\u1ed1i v\u1edbi m\u1ed7i c\u1ea1nh $(i, j)$ ch\u00fang ta th\u00eam c\u1ea1nh ng\u01b0\u1ee3c $(j, i)$ v\u00e0o m\u1ea1ng v\u1edbi dung l\u01b0\u1ee3ng $U_{j i} = 0$ v\u00e0 chi ph\u00ed $C_{j i} = -C_{i j}$. V\u00ec, theo c\u00e1c h\u1ea1n ch\u1ebf c\u1ee7a ch\u00fang t\u00f4i, c\u1ea1nh $(j, i)$ kh\u00f4ng c\u00f3 trong m\u1ea1ng tr\u01b0\u1edbc \u0111\u00f3, n\u00ean ch\u00fang ta v\u1eabn c\u00f3 m\u1ed9t m\u1ea1ng kh\u00f4ng ph\u1ea3i l\u00e0 \u0111a \u0111\u1ed3 th\u1ecb (\u0111\u1ed3 th\u1ecb c\u00f3 nhi\u1ec1u c\u1ea1nh). Ngo\u00e0i ra ch\u00fang ta s\u1ebd lu\u00f4n gi\u1eef \u0111i\u1ec1u ki\u1ec7n $F_{j i} = -F_{i j}$ \u0111\u00fang trong c\u00e1c b\u01b0\u1edbc c\u1ee7a thu\u1eadt to\u00e1n.</p> <p>Ch\u00fang ta \u0111\u1ecbnh ngh\u0129a m\u1ea1ng d\u01b0 (residual network) cho m\u1ed9t lu\u1ed3ng c\u1ed1 \u0111\u1ecbnh $F$ nh\u01b0 sau (gi\u1ed1ng nh\u01b0 trong thu\u1eadt to\u00e1n Ford-Fulkerson): m\u1ea1ng d\u01b0 ch\u1ec9 ch\u1ee9a c\u00e1c c\u1ea1nh ch\u01b0a b\u00e3o h\u00f2a (t\u1ee9c l\u00e0 c\u00e1c c\u1ea1nh trong \u0111\u00f3 $F_{i j} &lt; U_{i j}$), v\u00e0 dung l\u01b0\u1ee3ng d\u01b0 c\u1ee7a m\u1ed7i c\u1ea1nh nh\u01b0 v\u1eady l\u00e0 $R_{i j} = U_{i j} - F_{i j}$.</p> <p>B\u00e2y gi\u1edd ch\u00fang ta c\u00f3 th\u1ec3 n\u00f3i v\u1ec1 thu\u1eadt to\u00e1n \u0111\u1ec3 t\u00ednh to\u00e1n lu\u1ed3ng chi ph\u00ed nh\u1ecf nh\u1ea5t. \u1ede m\u1ed7i l\u1ea7n l\u1eb7p c\u1ee7a thu\u1eadt to\u00e1n, ch\u00fang ta t\u00ecm \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t trong \u0111\u1ed3 th\u1ecb d\u01b0 t\u1eeb $s$ \u0111\u1ebfn $t$. Ng\u01b0\u1ee3c l\u1ea1i v\u1edbi Edmonds-Karp, ch\u00fang ta t\u00ecm ki\u1ebfm \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t theo chi ph\u00ed c\u1ee7a \u0111\u01b0\u1eddng \u0111i thay v\u00ec s\u1ed1 l\u01b0\u1ee3ng c\u1ea1nh. N\u1ebfu kh\u00f4ng t\u1ed3n t\u1ea1i \u0111\u01b0\u1eddng \u0111i n\u00e0o n\u1eefa, th\u00ec thu\u1eadt to\u00e1n k\u1ebft th\u00fac, v\u00e0 lu\u1ed3ng $F$ l\u00e0 lu\u1ed3ng mong mu\u1ed1n. N\u1ebfu m\u1ed9t \u0111\u01b0\u1eddng \u0111i \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y, ch\u00fang ta t\u0103ng lu\u1ed3ng d\u1ecdc theo n\u00f3 nhi\u1ec1u nh\u1ea5t c\u00f3 th\u1ec3 (t\u1ee9c l\u00e0 ch\u00fang ta t\u00ecm dung l\u01b0\u1ee3ng d\u01b0 t\u1ed1i thi\u1ec3u $R$ c\u1ee7a \u0111\u01b0\u1eddng \u0111i, v\u00e0 t\u0103ng lu\u1ed3ng theo n\u00f3, v\u00e0 gi\u1ea3m c\u00e1c c\u1ea1nh ng\u01b0\u1ee3c m\u1ed9t l\u01b0\u1ee3ng t\u01b0\u01a1ng t\u1ef1). N\u1ebfu t\u1ea1i m\u1ed9t th\u1eddi \u0111i\u1ec3m n\u00e0o \u0111\u00f3 lu\u1ed3ng \u0111\u1ea1t \u0111\u1ebfn gi\u00e1 tr\u1ecb $K$, th\u00ec ch\u00fang ta d\u1eebng thu\u1eadt to\u00e1n (l\u01b0u \u00fd r\u1eb1ng trong l\u1ea7n l\u1eb7p cu\u1ed1i c\u00f9ng c\u1ee7a thu\u1eadt to\u00e1n, c\u1ea7n t\u0103ng lu\u1ed3ng ch\u1ec9 b\u1eb1ng m\u1ed9t l\u01b0\u1ee3ng sao cho gi\u00e1 tr\u1ecb lu\u1ed3ng cu\u1ed1i c\u00f9ng kh\u00f4ng v\u01b0\u1ee3t qu\u00e1 $K$).</p> <p>Kh\u00f4ng kh\u00f3 \u0111\u1ec3 th\u1ea5y r\u1eb1ng, n\u1ebfu ch\u00fang ta \u0111\u1eb7t $K$ th\u00e0nh v\u00f4 c\u00f9ng, th\u00ec thu\u1eadt to\u00e1n s\u1ebd t\u00ecm th\u1ea5y lu\u1ed3ng c\u1ef1c \u0111\u1ea1i chi ph\u00ed nh\u1ecf nh\u1ea5t. V\u00ec v\u1eady, c\u1ea3 hai bi\u1ebfn th\u1ec3 c\u1ee7a b\u00e0i to\u00e1n \u0111\u1ec1u c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i quy\u1ebft b\u1eb1ng c\u00f9ng m\u1ed9t thu\u1eadt to\u00e1n.</p>","tags":["Translated"]},{"location":"graph/min_cost_flow.html#undirected-graphs-multigraphs","title":"\u0110\u1ed3 th\u1ecb v\u00f4 h\u01b0\u1edbng / \u0111a \u0111\u1ed3 th\u1ecb (Undirected graphs / multigraphs)","text":"<p>Tr\u01b0\u1eddng h\u1ee3p \u0111\u1ed3 th\u1ecb v\u00f4 h\u01b0\u1edbng ho\u1eb7c \u0111a \u0111\u1ed3 th\u1ecb kh\u00f4ng kh\u00e1c bi\u1ec7t v\u1ec1 m\u1eb7t kh\u00e1i ni\u1ec7m so v\u1edbi thu\u1eadt to\u00e1n tr\u00ean. Thu\u1eadt to\u00e1n c\u0169ng s\u1ebd ho\u1ea1t \u0111\u1ed9ng tr\u00ean c\u00e1c \u0111\u1ed3 th\u1ecb n\u00e0y. Tuy nhi\u00ean, vi\u1ec7c c\u00e0i \u0111\u1eb7t n\u00f3 tr\u1edf n\u00ean kh\u00f3 kh\u0103n h\u01a1n m\u1ed9t ch\u00fat.</p> <p>M\u1ed9t c\u1ea1nh v\u00f4 h\u01b0\u1edbng $(i, j)$ th\u1ef1c s\u1ef1 gi\u1ed1ng nh\u01b0 hai c\u1ea1nh c\u00f3 h\u01b0\u1edbng $(i, j)$ v\u00e0 $(j, i)$ c\u00f3 c\u00f9ng dung l\u01b0\u1ee3ng v\u00e0 gi\u00e1 tr\u1ecb. V\u00ec thu\u1eadt to\u00e1n lu\u1ed3ng chi ph\u00ed nh\u1ecf nh\u1ea5t \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 \u1edf tr\u00ean t\u1ea1o ra m\u1ed9t c\u1ea1nh ng\u01b0\u1ee3c cho m\u1ed7i c\u1ea1nh c\u00f3 h\u01b0\u1edbng, n\u00ean n\u00f3 chia c\u1ea1nh v\u00f4 h\u01b0\u1edbng th\u00e0nh $4$ c\u1ea1nh c\u00f3 h\u01b0\u1edbng, v\u00e0 ch\u00fang ta th\u1ef1c s\u1ef1 nh\u1eadn \u0111\u01b0\u1ee3c m\u1ed9t \u0111a \u0111\u1ed3 th\u1ecb.</p> <p>L\u00e0m th\u1ebf n\u00e0o \u0111\u1ec3 ch\u00fang ta \u0111\u1ed1i ph\u00f3 v\u1edbi nhi\u1ec1u c\u1ea1nh? Th\u1ee9 nh\u1ea5t, lu\u1ed3ng cho m\u1ed7i c\u1ea1nh trong s\u1ed1 nhi\u1ec1u c\u1ea1nh ph\u1ea3i \u0111\u01b0\u1ee3c gi\u1eef ri\u00eang bi\u1ec7t. Th\u1ee9 hai, khi t\u00ecm ki\u1ebfm \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t, c\u1ea7n ph\u1ea3i t\u00ednh \u0111\u1ebfn vi\u1ec7c c\u1ea1nh n\u00e0o trong s\u1ed1 nhi\u1ec1u c\u1ea1nh \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng trong \u0111\u01b0\u1eddng \u0111i l\u00e0 quan tr\u1ecdng. Do \u0111\u00f3, thay v\u00ec m\u1ea3ng t\u1ed5 ti\u00ean th\u00f4ng th\u01b0\u1eddng, ch\u00fang ta ph\u1ea3i l\u01b0u tr\u1eef th\u00eam s\u1ed1 c\u1ea1nh m\u00e0 t\u1eeb \u0111\u00f3 ch\u00fang ta \u0111\u1ebfn c\u00f9ng v\u1edbi t\u1ed5 ti\u00ean. Th\u1ee9 ba, khi lu\u1ed3ng t\u0103ng d\u1ecdc theo m\u1ed9t c\u1ea1nh nh\u1ea5t \u0111\u1ecbnh, c\u1ea7n ph\u1ea3i gi\u1ea3m lu\u1ed3ng d\u1ecdc theo c\u1ea1nh ng\u01b0\u1ee3c l\u1ea1i. V\u00ec ch\u00fang ta c\u00f3 nhi\u1ec1u c\u1ea1nh, ch\u00fang ta ph\u1ea3i l\u01b0u tr\u1eef s\u1ed1 c\u1ea1nh cho c\u1ea1nh \u0111\u1ea3o ng\u01b0\u1ee3c cho m\u1ed7i c\u1ea1nh.</p> <p>Kh\u00f4ng c\u00f3 tr\u1edf ng\u1ea1i n\u00e0o kh\u00e1c v\u1edbi \u0111\u1ed3 th\u1ecb v\u00f4 h\u01b0\u1edbng ho\u1eb7c \u0111a \u0111\u1ed3 th\u1ecb.</p>","tags":["Translated"]},{"location":"graph/min_cost_flow.html#complexity","title":"\u0110\u1ed9 ph\u1ee9c t\u1ea1p (Complexity)","text":"<p>Thu\u1eadt to\u00e1n \u1edf \u0111\u00e2y n\u00f3i chung l\u00e0 s\u1ed1 m\u0169 theo k\u00edch th\u01b0\u1edbc c\u1ee7a \u0111\u1ea7u v\u00e0o. C\u1ee5 th\u1ec3 h\u01a1n, trong tr\u01b0\u1eddng h\u1ee3p x\u1ea5u nh\u1ea5t, n\u00f3 c\u00f3 th\u1ec3 ch\u1ec9 \u0111\u1ea9y nhi\u1ec1u nh\u1ea5t l\u00e0 $1$ \u0111\u01a1n v\u1ecb lu\u1ed3ng tr\u00ean m\u1ed7i l\u1ea7n l\u1eb7p, m\u1ea5t $O(F)$ l\u1ea7n l\u1eb7p \u0111\u1ec3 t\u00ecm m\u1ed9t lu\u1ed3ng chi ph\u00ed t\u1ed1i thi\u1ec3u c\u00f3 k\u00edch th\u01b0\u1edbc $F$, l\u00e0m cho t\u1ed5ng th\u1eddi gian ch\u1ea1y l\u00e0 $O(F \\cdot T)$, trong \u0111\u00f3 $T$ l\u00e0 th\u1eddi gian c\u1ea7n thi\u1ebft \u0111\u1ec3 t\u00ecm \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t t\u1eeb ngu\u1ed3n \u0111\u1ebfn \u0111\u00edch.</p> <p>N\u1ebfu thu\u1eadt to\u00e1n Bellman-Ford \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng cho vi\u1ec7c n\u00e0y, n\u00f3 l\u00e0m cho th\u1eddi gian ch\u1ea1y l\u00e0 $O(F mn)$. C\u0169ng c\u00f3 th\u1ec3 s\u1eeda \u0111\u1ed5i thu\u1eadt to\u00e1n Dijkstra, \u0111\u1ec3 n\u00f3 c\u1ea7n $O(nm)$ ti\u1ec1n x\u1eed l\u00fd nh\u01b0 m\u1ed9t b\u01b0\u1edbc \u0111\u1ea7u ti\u00ean v\u00e0 sau \u0111\u00f3 ho\u1ea1t \u0111\u1ed9ng trong $O(m \\log n)$ m\u1ed7i l\u1ea7n l\u1eb7p, l\u00e0m cho t\u1ed5ng th\u1eddi gian ch\u1ea1y chung l\u00e0 $O(mn + F m \\log n)$. T\u1ea1i \u0111\u00e2y l\u00e0 m\u1ed9t b\u1ed9 t\u1ea1o \u0111\u1ed3 th\u1ecb, tr\u00ean \u0111\u00f3 thu\u1eadt to\u00e1n nh\u01b0 v\u1eady s\u1ebd y\u00eau c\u1ea7u th\u1eddi gian $O(2^{n/2} n^2 \\log n)$.</p> <p>Thu\u1eadt to\u00e1n Dijkstra s\u1eeda \u0111\u1ed5i s\u1eed d\u1ee5ng c\u00e1i g\u1ecdi l\u00e0 th\u1ebf n\u0103ng t\u1eeb thu\u1eadt to\u00e1n Johnson. C\u00f3 th\u1ec3 k\u1ebft h\u1ee3p c\u00e1c \u00fd t\u01b0\u1edfng c\u1ee7a thu\u1eadt to\u00e1n n\u00e0y v\u00e0 thu\u1eadt to\u00e1n Dinic \u0111\u1ec3 gi\u1ea3m s\u1ed1 l\u1ea7n l\u1eb7p t\u1eeb $F$ xu\u1ed1ng $\\min(F, nC)$, trong \u0111\u00f3 $C$ l\u00e0 chi ph\u00ed t\u1ed1i \u0111a \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y gi\u1eefa c\u00e1c c\u1ea1nh. B\u1ea1n c\u00f3 th\u1ec3 \u0111\u1ecdc th\u00eam v\u1ec1 th\u1ebf n\u0103ng v\u00e0 s\u1ef1 k\u1ebft h\u1ee3p c\u1ee7a ch\u00fang v\u1edbi thu\u1eadt to\u00e1n Dinic t\u1ea1i \u0111\u00e2y.</p>","tags":["Translated"]},{"location":"graph/min_cost_flow.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u1ed9t c\u00e0i \u0111\u1eb7t s\u1eed d\u1ee5ng thu\u1eadt to\u00e1n SPFA cho tr\u01b0\u1eddng h\u1ee3p \u0111\u01a1n gi\u1ea3n nh\u1ea5t.</p> <pre><code>struct Edge\n{\n    int from, to, capacity, cost;\n};\n\nvector&lt;vector&lt;int&gt;&gt; adj, cost, capacity;\n\nconst int INF = 1e9;\n\nvoid shortest_paths(int n, int v0, vector&lt;int&gt;&amp; d, vector&lt;int&gt;&amp; p) {\n    d.assign(n, INF);\n    d[v0] = 0;\n    vector&lt;bool&gt; inq(n, false);\n    queue&lt;int&gt; q;\n    q.push(v0);\n    p.assign(n, -1);\n\n    while (!q.empty()) {\n        int u = q.front();\n        q.pop();\n        inq[u] = false;\n        for (int v : adj[u]) {\n            if (capacity[u][v] &gt; 0 &amp;&amp; d[v] &gt; d[u] + cost[u][v]) {\n                d[v] = d[u] + cost[u][v];\n                p[v] = u;\n                if (!inq[v]) {\n                    inq[v] = true;\n                    q.push(v);\n                }\n            }\n        }\n    }\n}\n\nint min_cost_flow(int N, vector&lt;Edge&gt; edges, int K, int s, int t) {\n    adj.assign(N, vector&lt;int&gt;());\n    cost.assign(N, vector&lt;int&gt;(N, 0));\n    capacity.assign(N, vector&lt;int&gt;(N, 0));\n    for (Edge e : edges) {\n        adj[e.from].push_back(e.to);\n        adj[e.to].push_back(e.from);\n        cost[e.from][e.to] = e.cost;\n        cost[e.to][e.from] = -e.cost;\n        capacity[e.from][e.to] = e.capacity;\n    }\n\n    int flow = 0;\n    int cost = 0;\n    vector&lt;int&gt; d, p;\n    while (flow &lt; K) {\n        shortest_paths(N, s, d, p);\n        if (d[t] == INF)\n            break;\n\n        // find max flow on that path\n        int f = K - flow;\n        int cur = t;\n        while (cur != s) {\n            f = min(f, capacity[p[cur]][cur]);\n            cur = p[cur];\n        }\n\n        // apply flow\n        flow += f;\n        cost += f * d[t];\n        cur = t;\n        while (cur != s) {\n            capacity[p[cur]][cur] -= f;\n            capacity[cur][p[cur]] += f;\n            cur = p[cur];\n        }\n    }\n\n    if (flow &lt; K)\n        return -1;\n    else\n        return cost;\n}\n</code></pre>","tags":["Translated"]},{"location":"graph/min_cost_flow.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>CSES - Task Assignment</li> <li>CSES - Grid Puzzle II</li> <li>AtCoder - Dream Team</li> </ul>","tags":["Translated"]},{"location":"graph/mpm.html","title":"Lu\u1ed3ng c\u1ef1c \u0111\u1ea1i - Thu\u1eadt to\u00e1n MPM (Maximum flow - MPM algorithm)","text":"<p>Thu\u1eadt to\u00e1n MPM (Malhotra, Pramodh-Kumar v\u00e0 Maheshwari) gi\u1ea3i quy\u1ebft b\u00e0i to\u00e1n lu\u1ed3ng c\u1ef1c \u0111\u1ea1i trong $O(V^3)$. Thu\u1eadt to\u00e1n n\u00e0y t\u01b0\u01a1ng t\u1ef1 nh\u01b0 thu\u1eadt to\u00e1n Dinic.</p>","tags":["Original"]},{"location":"graph/mpm.html#algorithm","title":"Thu\u1eadt to\u00e1n (Algorithm)","text":"<p>Gi\u1ed1ng nh\u01b0 thu\u1eadt to\u00e1n Dinic, MPM ch\u1ea1y theo c\u00e1c pha, trong m\u1ed7i pha ch\u00fang ta t\u00ecm lu\u1ed3ng ch\u1eafn trong m\u1ea1ng ph\u00e2n l\u1edbp c\u1ee7a m\u1ea1ng d\u01b0 c\u1ee7a $G$. S\u1ef1 kh\u00e1c bi\u1ec7t ch\u00ednh so v\u1edbi Dinic l\u00e0 c\u00e1ch ch\u00fang ta t\u00ecm lu\u1ed3ng ch\u1eafn. Xem x\u00e9t m\u1ea1ng ph\u00e2n l\u1edbp $L$. \u0110\u1ed1i v\u1edbi m\u1ed7i n\u00fat, ch\u00fang ta \u0111\u1ecbnh ngh\u0129a th\u1ebf n\u0103ng trong (inner potential) v\u00e0 th\u1ebf n\u0103ng ngo\u00e0i (outer potential) c\u1ee7a n\u00f3 nh\u01b0 sau:</p> $$\\begin{align} p_{in}(v) &amp;= \\sum\\limits_{(u, v)\\in L}(c(u, v) - f(u, v)) \\\\\\\\ p_{out}(v) &amp;= \\sum\\limits_{(v, u)\\in L}(c(v, u) - f(v, u)) \\end{align}$$ <p>Ch\u00fang ta c\u0169ng \u0111\u1eb7t $p_{in}(s) = p_{out}(t) = \\infty$. V\u1edbi $p_{in}$ v\u00e0 $p_{out}$ \u0111\u00e3 cho, ch\u00fang ta \u0111\u1ecbnh ngh\u0129a th\u1ebf n\u0103ng (potential) l\u00e0 $p(v) = \\min(p_{in}(v), p_{out}(v))$. Ch\u00fang ta g\u1ecdi m\u1ed9t n\u00fat $r$ l\u00e0 n\u00fat tham chi\u1ebfu (reference node) n\u1ebfu $p(r) = \\min\\{p(v)\\}$. Xem x\u00e9t m\u1ed9t n\u00fat tham chi\u1ebfu $r$. Ch\u00fang ta kh\u1eb3ng \u0111\u1ecbnh r\u1eb1ng lu\u1ed3ng c\u00f3 th\u1ec3 t\u0103ng th\u00eam $p(r)$ theo c\u00e1ch m\u00e0 $p(r)$ tr\u1edf th\u00e0nh $0$. \u0110i\u1ec1u n\u00e0y \u0111\u00fang v\u00ec $L$ l\u00e0 kh\u00f4ng c\u00f3 chu tr\u00ecnh, v\u00ec v\u1eady ch\u00fang ta c\u00f3 th\u1ec3 \u0111\u1ea9y lu\u1ed3ng ra kh\u1ecfi $r$ b\u1eb1ng c\u00e1c c\u1ea1nh \u0111i ra v\u00e0 n\u00f3 s\u1ebd \u0111\u1ebfn $t$ v\u00ec m\u1ed7i n\u00fat c\u00f3 \u0111\u1ee7 th\u1ebf n\u0103ng ngo\u00e0i \u0111\u1ec3 \u0111\u1ea9y lu\u1ed3ng ra khi n\u00f3 \u0111\u1ebfn \u0111\u00f3. T\u01b0\u01a1ng t\u1ef1, ch\u00fang ta c\u00f3 th\u1ec3 k\u00e9o lu\u1ed3ng t\u1eeb $s$. Vi\u1ec7c x\u00e2y d\u1ef1ng lu\u1ed3ng ch\u1eafn d\u1ef1a tr\u00ean th\u1ef1c t\u1ebf n\u00e0y. Tr\u00ean m\u1ed7i l\u1ea7n l\u1eb7p, ch\u00fang ta t\u00ecm m\u1ed9t n\u00fat tham chi\u1ebfu v\u00e0 \u0111\u1ea9y lu\u1ed3ng t\u1eeb $s$ \u0111\u1ebfn $t$ qua $r$. Qu\u00e1 tr\u00ecnh n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c m\u00f4 ph\u1ecfng b\u1edfi BFS. T\u1ea5t c\u1ea3 c\u00e1c cung b\u00e3o h\u00f2a ho\u00e0n to\u00e0n c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c x\u00f3a kh\u1ecfi $L$ v\u00ec d\u00f9 sao ch\u00fang c\u0169ng s\u1ebd kh\u00f4ng \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng sau n\u00e0y trong pha n\u00e0y. T\u01b0\u01a1ng t\u1ef1 nh\u01b0 v\u1eady, t\u1ea5t c\u1ea3 c\u00e1c n\u00fat kh\u00e1c $s$ v\u00e0 $t$ kh\u00f4ng c\u00f3 cung \u0111i ra ho\u1eb7c \u0111i v\u00e0o \u0111\u1ec1u c\u00f3 th\u1ec3 b\u1ecb x\u00f3a.</p> <p>M\u1ed7i pha ho\u1ea1t \u0111\u1ed9ng trong $O(V^2)$ v\u00ec c\u00f3 t\u1ed1i \u0111a $V$ l\u1ea7n l\u1eb7p (v\u00ec \u00edt nh\u1ea5t n\u00fat tham chi\u1ebfu \u0111\u00e3 ch\u1ecdn b\u1ecb x\u00f3a), v\u00e0 tr\u00ean m\u1ed7i l\u1ea7n l\u1eb7p, ch\u00fang ta x\u00f3a t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh ch\u00fang ta \u0111\u00e3 \u0111i qua ngo\u1ea1i tr\u1eeb t\u1ed1i \u0111a $V$. C\u1ed9ng l\u1ea1i, ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c $O(V^2 + E) = O(V^2)$. V\u00ec c\u00f3 \u00edt h\u01a1n $V$ pha (xem ch\u1ee9ng minh t\u1ea1i \u0111\u00e2y), MPM ho\u1ea1t \u0111\u1ed9ng trong t\u1ed5ng s\u1ed1 $O(V^3)$.</p>","tags":["Original"]},{"location":"graph/mpm.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<pre><code>struct MPM{\n    struct FlowEdge{\n        int v, u;\n        long long cap, flow;\n        FlowEdge(){}\n        FlowEdge(int _v, int _u, long long _cap, long long _flow)\n            : v(_v), u(_u), cap(_cap), flow(_flow){}\n        FlowEdge(int _v, int _u, long long _cap)\n            : v(_v), u(_u), cap(_cap), flow(0ll){}\n    };\n    const long long flow_inf = 1e18;\n    vector&lt;FlowEdge&gt; edges;\n    vector&lt;char&gt; alive;\n    vector&lt;long long&gt; pin, pout;\n    vector&lt;list&lt;int&gt; &gt; in, out;\n    vector&lt;vector&lt;int&gt; &gt; adj;\n    vector&lt;long long&gt; ex;\n    int n, m = 0;\n    int s, t;\n    vector&lt;int&gt; level;\n    vector&lt;int&gt; q;\n    int qh, qt;\n    void resize(int _n){\n        n = _n;\n        ex.resize(n);\n        q.resize(n);\n        pin.resize(n);\n        pout.resize(n);\n        adj.resize(n);\n        level.resize(n);\n        in.resize(n);\n        out.resize(n);\n    }\n    MPM(){}\n    MPM(int _n, int _s, int _t){resize(_n); s = _s; t = _t;}\n    void add_edge(int v, int u, long long cap){\n        edges.push_back(FlowEdge(v, u, cap));\n        edges.push_back(FlowEdge(u, v, 0));\n        adj[v].push_back(m);\n        adj[u].push_back(m + 1);\n        m += 2;\n    }\n    bool bfs(){\n        while(qh &lt; qt){\n            int v = q[qh++];\n            for(int id : adj[v]){\n                if(edges[id].cap - edges[id].flow &lt; 1)continue;\n                if(level[edges[id].u] != -1)continue;\n                level[edges[id].u] = level[v] + 1;\n                q[qt++] = edges[id].u;\n            }\n        }\n        return level[t] != -1;\n    }\n    long long pot(int v){\n        return min(pin[v], pout[v]);\n    }\n    void remove_node(int v){\n        for(int i : in[v]){\n            int u = edges[i].v;\n            auto it = find(out[u].begin(), out[u].end(), i);\n            out[u].erase(it);\n            pout[u] -= edges[i].cap - edges[i].flow;\n        }\n        for(int i : out[v]){\n            int u = edges[i].u;\n            auto it = find(in[u].begin(), in[u].end(), i);\n            in[u].erase(it);\n            pin[u] -= edges[i].cap - edges[i].flow;\n        }\n    }\n    void push(int from, int to, long long f, bool forw){\n        qh = qt = 0;\n        ex.assign(n, 0);\n        ex[from] = f;\n        q[qt++] = from;\n        while(qh &lt; qt){\n            int v = q[qh++];\n            if(v == to)\n                break;\n            long long must = ex[v];\n            auto it = forw ? out[v].begin() : in[v].begin();\n            while(true){\n                int u = forw ? edges[*it].u : edges[*it].v;\n                long long pushed = min(must, edges[*it].cap - edges[*it].flow);\n                if(pushed == 0)break;\n                if(forw){\n                    pout[v] -= pushed;\n                    pin[u] -= pushed;\n                }\n                else{\n                    pin[v] -= pushed;\n                    pout[u] -= pushed;\n                }\n                if(ex[u] == 0)\n                    q[qt++] = u;\n                ex[u] += pushed;\n                edges[*it].flow += pushed;\n                edges[(*it)^1].flow -= pushed;\n                must -= pushed;\n                if(edges[*it].cap - edges[*it].flow == 0){\n                    auto jt = it;\n                    ++jt;\n                    if(forw){\n                        in[u].erase(find(in[u].begin(), in[u].end(), *it));\n                        out[v].erase(it);\n                    }\n                    else{\n                        out[u].erase(find(out[u].begin(), out[u].end(), *it));\n                        in[v].erase(it);\n                    }\n                    it = jt;\n                }\n                else break;\n                if(!must)break;\n            }\n        }\n    }\n    long long flow(){\n        long long ans = 0;\n        while(true){\n            pin.assign(n, 0);\n            pout.assign(n, 0);\n            level.assign(n, -1);\n            alive.assign(n, true);\n            level[s] = 0;\n            qh = 0; qt = 1;\n            q[0] = s;\n            if(!bfs())\n                break;\n            for(int i = 0; i &lt; n; i++){\n                out[i].clear();\n                in[i].clear();\n            }\n            for(int i = 0; i &lt; m; i++){\n                if(edges[i].cap - edges[i].flow == 0)\n                    continue;\n                int v = edges[i].v, u = edges[i].u;\n                if(level[v] + 1 == level[u] &amp;&amp; (level[u] &lt; level[t] || u == t)){\n                    in[u].push_back(i);\n                    out[v].push_back(i);\n                    pin[u] += edges[i].cap - edges[i].flow;\n                    pout[v] += edges[i].cap - edges[i].flow;\n                }\n            }\n            pin[s] = pout[t] = flow_inf;\n            while(true){\n                int v = -1;\n                for(int i = 0; i &lt; n; i++){\n                    if(!alive[i])continue;\n                    if(v == -1 || pot(i) &lt; pot(v))\n                        v = i;\n                }\n                if(v == -1)\n                    break;\n                if(pot(v) == 0){\n                    alive[v] = false;\n                    remove_node(v);\n                    continue;\n                }\n                long long f = pot(v);\n                ans += f;\n                push(v, s, f, false);\n                push(v, t, f, true);\n                alive[v] = false;\n                remove_node(v);\n            }\n        }\n        return ans;\n    }\n};\n</code></pre>","tags":["Original"]},{"location":"graph/mst_kruskal.html","title":"C\u00e2y khung nh\u1ecf nh\u1ea5t - Thu\u1eadt to\u00e1n Kruskal (Minimum spanning tree - Kruskal's algorithm)","text":"<p>Cho m\u1ed9t \u0111\u1ed3 th\u1ecb v\u00f4 h\u01b0\u1edbng c\u00f3 tr\u1ecdng s\u1ed1. Ch\u00fang ta mu\u1ed1n t\u00ecm m\u1ed9t c\u00e2y con c\u1ee7a \u0111\u1ed3 th\u1ecb n\u00e0y k\u1ebft n\u1ed1i t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh (t\u1ee9c l\u00e0 n\u00f3 l\u00e0 m\u1ed9t c\u00e2y khung) v\u00e0 c\u00f3 tr\u1ecdng s\u1ed1 nh\u1ecf nh\u1ea5t (t\u1ee9c l\u00e0 t\u1ed5ng tr\u1ecdng s\u1ed1 c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh l\u00e0 nh\u1ecf nh\u1ea5t) trong s\u1ed1 t\u1ea5t c\u1ea3 c\u00e1c c\u00e2y khung c\u00f3 th\u1ec3 c\u00f3. C\u00e2y khung n\u00e0y \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 c\u00e2y khung nh\u1ecf nh\u1ea5t (minimum spanning tree).</p> <p>Trong h\u00ecnh b\u00ean tr\u00e1i b\u1ea1n c\u00f3 th\u1ec3 th\u1ea5y m\u1ed9t \u0111\u1ed3 th\u1ecb v\u00f4 h\u01b0\u1edbng c\u00f3 tr\u1ecdng s\u1ed1, v\u00e0 trong h\u00ecnh b\u00ean ph\u1ea3i b\u1ea1n c\u00f3 th\u1ec3 th\u1ea5y c\u00e2y khung nh\u1ecf nh\u1ea5t t\u01b0\u01a1ng \u1ee9ng.</p> <p> </p> <p>B\u00e0i vi\u1ebft n\u00e0y s\u1ebd th\u1ea3o lu\u1eadn v\u1ec1 m\u1ed9t v\u00e0i th\u1ef1c t\u1ebf quan tr\u1ecdng li\u00ean quan \u0111\u1ebfn c\u00e2y khung nh\u1ecf nh\u1ea5t, v\u00e0 sau \u0111\u00f3 s\u1ebd \u0111\u01b0a ra c\u00e0i \u0111\u1eb7t \u0111\u01a1n gi\u1ea3n nh\u1ea5t c\u1ee7a thu\u1eadt to\u00e1n Kruskal \u0111\u1ec3 t\u00ecm c\u00e2y khung nh\u1ecf nh\u1ea5t.</p>","tags":["Translated"]},{"location":"graph/mst_kruskal.html#properties-of-the-minimum-spanning-tree","title":"T\u00ednh ch\u1ea5t c\u1ee7a c\u00e2y khung nh\u1ecf nh\u1ea5t (Properties of the minimum spanning tree)","text":"<ul> <li>M\u1ed9t c\u00e2y khung nh\u1ecf nh\u1ea5t c\u1ee7a m\u1ed9t \u0111\u1ed3 th\u1ecb l\u00e0 duy nh\u1ea5t, n\u1ebfu tr\u1ecdng s\u1ed1 c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh l\u00e0 kh\u00e1c nhau. Ng\u01b0\u1ee3c l\u1ea1i, c\u00f3 th\u1ec3 c\u00f3 nhi\u1ec1u c\u00e2y khung nh\u1ecf nh\u1ea5t.   (C\u00e1c thu\u1eadt to\u00e1n c\u1ee5 th\u1ec3 th\u01b0\u1eddng xu\u1ea5t ra m\u1ed9t trong nh\u1eefng c\u00e2y khung nh\u1ecf nh\u1ea5t c\u00f3 th\u1ec3).</li> <li>C\u00e2y khung nh\u1ecf nh\u1ea5t c\u0169ng l\u00e0 c\u00e2y c\u00f3 t\u00edch c\u00e1c tr\u1ecdng s\u1ed1 c\u1ee7a c\u00e1c c\u1ea1nh l\u00e0 nh\u1ecf nh\u1ea5t.   (\u0110i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng \u0111\u01b0\u1ee3c ch\u1ee9ng minh b\u1eb1ng c\u00e1ch thay th\u1ebf tr\u1ecdng s\u1ed1 c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh b\u1eb1ng logarit c\u1ee7a ch\u00fang)</li> <li>Trong m\u1ed9t c\u00e2y khung nh\u1ecf nh\u1ea5t c\u1ee7a m\u1ed9t \u0111\u1ed3 th\u1ecb, tr\u1ecdng s\u1ed1 l\u1edbn nh\u1ea5t c\u1ee7a m\u1ed9t c\u1ea1nh l\u00e0 nh\u1ecf nh\u1ea5t c\u00f3 th\u1ec3 t\u1eeb t\u1ea5t c\u1ea3 c\u00e1c c\u00e2y khung c\u00f3 th\u1ec3 c\u00f3 c\u1ee7a \u0111\u1ed3 th\u1ecb \u0111\u00f3.   (\u0110i\u1ec1u n\u00e0y suy ra t\u1eeb t\u00ednh \u0111\u00fang \u0111\u1eafn c\u1ee7a thu\u1eadt to\u00e1n Kruskal).</li> <li>C\u00e2y khung l\u1edbn nh\u1ea5t (maximum spanning tree) (c\u00e2y khung v\u1edbi t\u1ed5ng tr\u1ecdng s\u1ed1 c\u1ee7a c\u00e1c c\u1ea1nh l\u00e0 l\u1edbn nh\u1ea5t) c\u1ee7a m\u1ed9t \u0111\u1ed3 th\u1ecb c\u00f3 th\u1ec3 thu \u0111\u01b0\u1ee3c t\u01b0\u01a1ng t\u1ef1 nh\u01b0 c\u00e2y khung nh\u1ecf nh\u1ea5t, b\u1eb1ng c\u00e1ch thay \u0111\u1ed5i d\u1ea5u c\u1ee7a tr\u1ecdng s\u1ed1 c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh th\u00e0nh ng\u01b0\u1ee3c l\u1ea1i v\u00e0 sau \u0111\u00f3 \u00e1p d\u1ee5ng b\u1ea5t k\u1ef3 thu\u1eadt to\u00e1n c\u00e2y khung nh\u1ecf nh\u1ea5t n\u00e0o.</li> </ul>","tags":["Translated"]},{"location":"graph/mst_kruskal.html#kruskals-algorithm","title":"Thu\u1eadt to\u00e1n Kruskal (Kruskal's algorithm)","text":"<p>Thu\u1eadt to\u00e1n n\u00e0y \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 b\u1edfi Joseph Bernard Kruskal, Jr. v\u00e0o n\u0103m 1956.</p> <p>Thu\u1eadt to\u00e1n Kruskal ban \u0111\u1ea7u \u0111\u1eb7t t\u1ea5t c\u1ea3 c\u00e1c n\u00fat c\u1ee7a \u0111\u1ed3 th\u1ecb ban \u0111\u1ea7u c\u00f4 l\u1eadp v\u1edbi nhau, \u0111\u1ec3 t\u1ea1o th\u00e0nh m\u1ed9t r\u1eebng c\u00e1c c\u00e2y n\u00fat \u0111\u01a1n l\u1ebb, v\u00e0 sau \u0111\u00f3 d\u1ea7n d\u1ea7n h\u1ee3p nh\u1ea5t c\u00e1c c\u00e2y n\u00e0y, k\u1ebft h\u1ee3p \u1edf m\u1ed7i l\u1ea7n l\u1eb7p b\u1ea5t k\u1ef3 hai trong s\u1ed1 t\u1ea5t c\u1ea3 c\u00e1c c\u00e2y v\u1edbi m\u1ed9t c\u1ea1nh n\u00e0o \u0111\u00f3 c\u1ee7a \u0111\u1ed3 th\u1ecb ban \u0111\u1ea7u. Tr\u01b0\u1edbc khi th\u1ef1c hi\u1ec7n thu\u1eadt to\u00e1n, t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp theo tr\u1ecdng s\u1ed1 (theo th\u1ee9 t\u1ef1 kh\u00f4ng gi\u1ea3m). Sau \u0111\u00f3 b\u1eaft \u0111\u1ea7u qu\u00e1 tr\u00ecnh h\u1ee3p nh\u1ea5t: ch\u1ecdn t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh t\u1eeb \u0111\u1ea7u \u0111\u1ebfn cu\u1ed1i (theo th\u1ee9 t\u1ef1 \u0111\u00e3 s\u1eafp x\u1ebfp), v\u00e0 n\u1ebfu c\u00e1c \u0111\u1ea7u c\u1ee7a c\u1ea1nh \u0111\u01b0\u1ee3c ch\u1ecdn hi\u1ec7n t\u1ea1i thu\u1ed9c v\u1ec1 c\u00e1c c\u00e2y con kh\u00e1c nhau, c\u00e1c c\u00e2y con n\u00e0y \u0111\u01b0\u1ee3c k\u1ebft h\u1ee3p, v\u00e0 c\u1ea1nh \u0111\u01b0\u1ee3c th\u00eam v\u00e0o c\u00e2u tr\u1ea3 l\u1eddi. Sau khi l\u1eb7p qua t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh, t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh s\u1ebd thu\u1ed9c v\u1ec1 c\u00f9ng m\u1ed9t c\u00e2y con, v\u00e0 ch\u00fang ta s\u1ebd nh\u1eadn \u0111\u01b0\u1ee3c c\u00e2u tr\u1ea3 l\u1eddi.</p>","tags":["Translated"]},{"location":"graph/mst_kruskal.html#the-simplest-implementation","title":"C\u00e0i \u0111\u1eb7t \u0111\u01a1n gi\u1ea3n nh\u1ea5t (The simplest implementation)","text":"<p>M\u00e3 sau \u0111\u00e2y c\u00e0i \u0111\u1eb7t tr\u1ef1c ti\u1ebfp thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 \u1edf tr\u00ean, v\u00e0 c\u00f3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian $O(M \\log M + N^2)$. S\u1eafp x\u1ebfp c\u00e1c c\u1ea1nh y\u00eau c\u1ea7u $O(M \\log N)$ (gi\u1ed1ng nh\u01b0 $O(M \\log M)$) thao t\u00e1c. Th\u00f4ng tin li\u00ean quan \u0111\u1ebfn c\u00e2y con m\u00e0 m\u1ed9t \u0111\u1ec9nh thu\u1ed9c v\u1ec1 \u0111\u01b0\u1ee3c duy tr\u00ec v\u1edbi s\u1ef1 tr\u1ee3 gi\u00fap c\u1ee7a m\u1ed9t m\u1ea3ng <code>tree_id[]</code> - \u0111\u1ed1i v\u1edbi m\u1ed7i \u0111\u1ec9nh <code>v</code>, <code>tree_id[v]</code> l\u01b0u tr\u1eef s\u1ed1 c\u1ee7a c\u00e2y, m\u00e0 <code>v</code> thu\u1ed9c v\u1ec1. \u0110\u1ed1i v\u1edbi m\u1ed7i c\u1ea1nh, li\u1ec7u n\u00f3 c\u00f3 thu\u1ed9c v\u1ec1 c\u00e1c \u0111\u1ea7u c\u1ee7a c\u00e1c c\u00e2y kh\u00e1c nhau hay kh\u00f4ng, c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh trong $O(1)$. Cu\u1ed1i c\u00f9ng, s\u1ef1 h\u1ee3p nh\u1ea5t c\u1ee7a hai c\u00e2y \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong $O(N)$ b\u1eb1ng m\u1ed9t l\u1ea7n duy\u1ec7t \u0111\u01a1n gi\u1ea3n qua m\u1ea3ng <code>tree_id[]</code>. Gi\u1ea3 s\u1eed r\u1eb1ng t\u1ed5ng s\u1ed1 thao t\u00e1c h\u1ee3p nh\u1ea5t l\u00e0 $N-1$, ch\u00fang ta thu \u0111\u01b0\u1ee3c h\u00e0nh vi ti\u1ec7m c\u1eadn c\u1ee7a $O(M \\log N + N^2)$.</p> <pre><code>struct Edge {\n    int u, v, weight;\n    bool operator&lt;(Edge const&amp; other) {\n        return weight &lt; other.weight;\n    }\n};\n\nint n;\nvector&lt;Edge&gt; edges;\n\nint cost = 0;\nvector&lt;int&gt; tree_id(n);\nvector&lt;Edge&gt; result;\nfor (int i = 0; i &lt; n; i++)\n    tree_id[i] = i;\n\nsort(edges.begin(), edges.end());\n\nfor (Edge e : edges) {\n    if (tree_id[e.u] != tree_id[e.v]) {\n        cost += e.weight;\n        result.push_back(e);\n\n        int old_id = tree_id[e.u], new_id = tree_id[e.v];\n        for (int i = 0; i &lt; n; i++) {\n            if (tree_id[i] == old_id)\n                tree_id[i] = new_id;\n        }\n    }\n}\n</code></pre>","tags":["Translated"]},{"location":"graph/mst_kruskal.html#proof-of-correctness","title":"Ch\u1ee9ng minh t\u00ednh \u0111\u00fang \u0111\u1eafn (Proof of correctness)","text":"<p>T\u1ea1i sao thu\u1eadt to\u00e1n Kruskal cho ch\u00fang ta k\u1ebft qu\u1ea3 ch\u00ednh x\u00e1c?</p> <p>N\u1ebfu \u0111\u1ed3 th\u1ecb ban \u0111\u1ea7u li\u00ean th\u00f4ng, th\u00ec \u0111\u1ed3 th\u1ecb k\u1ebft qu\u1ea3 c\u0169ng s\u1ebd li\u00ean th\u00f4ng. B\u1edfi v\u00ec n\u1ebfu kh\u00f4ng s\u1ebd c\u00f3 hai th\u00e0nh ph\u1ea7n c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c k\u1ebft n\u1ed1i v\u1edbi \u00edt nh\u1ea5t m\u1ed9t c\u1ea1nh. M\u1eb7c d\u00f9 \u0111i\u1ec1u n\u00e0y l\u00e0 kh\u00f4ng th\u1ec3, b\u1edfi v\u00ec Kruskal s\u1ebd ch\u1ecdn m\u1ed9t trong nh\u1eefng c\u1ea1nh n\u00e0y, v\u00ec id c\u1ee7a c\u00e1c th\u00e0nh ph\u1ea7n l\u00e0 kh\u00e1c nhau. Ngo\u00e0i ra \u0111\u1ed3 th\u1ecb k\u1ebft qu\u1ea3 kh\u00f4ng ch\u1ee9a b\u1ea5t k\u1ef3 chu tr\u00ecnh n\u00e0o, v\u00ec ch\u00fang ta c\u1ea5m \u0111i\u1ec1u n\u00e0y m\u1ed9t c\u00e1ch r\u00f5 r\u00e0ng trong thu\u1eadt to\u00e1n. Do \u0111\u00f3 thu\u1eadt to\u00e1n t\u1ea1o ra m\u1ed9t c\u00e2y khung.</p> <p>V\u1eady t\u1ea1i sao thu\u1eadt to\u00e1n n\u00e0y cho ch\u00fang ta m\u1ed9t c\u00e2y khung nh\u1ecf nh\u1ea5t?</p> <p>Ch\u00fang ta c\u00f3 th\u1ec3 ch\u1ec9 ra \u0111\u1ec1 xu\u1ea5t \"n\u1ebfu $F$ l\u00e0 m\u1ed9t t\u1eadp h\u1ee3p c\u00e1c c\u1ea1nh \u0111\u01b0\u1ee3c ch\u1ecdn b\u1edfi thu\u1eadt to\u00e1n \u1edf b\u1ea5t k\u1ef3 giai \u0111o\u1ea1n n\u00e0o trong thu\u1eadt to\u00e1n, th\u00ec t\u1ed3n t\u1ea1i m\u1ed9t MST ch\u1ee9a t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh c\u1ee7a $F$\" b\u1eb1ng quy n\u1ea1p.</p> <p>\u0110\u1ec1 xu\u1ea5t r\u00f5 r\u00e0ng l\u00e0 \u0111\u00fang \u1edf l\u00fac b\u1eaft \u0111\u1ea7u, t\u1eadp h\u1ee3p r\u1ed7ng l\u00e0 m\u1ed9t t\u1eadp h\u1ee3p con c\u1ee7a b\u1ea5t k\u1ef3 MST n\u00e0o.</p> <p>B\u00e2y gi\u1edd gi\u1ea3 s\u1eed $F$ l\u00e0 m\u1ed9t t\u1eadp h\u1ee3p c\u1ea1nh n\u00e0o \u0111\u00f3 \u1edf b\u1ea5t k\u1ef3 giai \u0111o\u1ea1n n\u00e0o c\u1ee7a thu\u1eadt to\u00e1n, $T$ l\u00e0 m\u1ed9t MST ch\u1ee9a $F$ v\u00e0 $e$ l\u00e0 c\u1ea1nh m\u1edbi ch\u00fang ta mu\u1ed1n th\u00eam b\u1eb1ng Kruskal.</p> <p>N\u1ebfu $e$ t\u1ea1o ra m\u1ed9t chu tr\u00ecnh, th\u00ec ch\u00fang ta kh\u00f4ng th\u00eam n\u00f3, v\u00e0 v\u00ec v\u1eady \u0111\u1ec1 xu\u1ea5t v\u1eabn \u0111\u00fang sau b\u01b0\u1edbc n\u00e0y.</p> <p>Trong tr\u01b0\u1eddng h\u1ee3p $T$ \u0111\u00e3 ch\u1ee9a $e$, \u0111\u1ec1 xu\u1ea5t c\u0169ng \u0111\u00fang sau b\u01b0\u1edbc n\u00e0y.</p> <p>Trong tr\u01b0\u1eddng h\u1ee3p $T$ kh\u00f4ng ch\u1ee9a c\u1ea1nh $e$, th\u00ec $T + e$ s\u1ebd ch\u1ee9a m\u1ed9t chu tr\u00ecnh $C$. Chu tr\u00ecnh n\u00e0y s\u1ebd ch\u1ee9a \u00edt nh\u1ea5t m\u1ed9t c\u1ea1nh $f$, kh\u00f4ng n\u1eb1m trong $F$. T\u1eadp h\u1ee3p c\u00e1c c\u1ea1nh $T - f + e$ c\u0169ng s\u1ebd l\u00e0 m\u1ed9t c\u00e2y khung. L\u01b0u \u00fd r\u1eb1ng tr\u1ecdng s\u1ed1 c\u1ee7a $f$ kh\u00f4ng th\u1ec3 nh\u1ecf h\u01a1n tr\u1ecdng s\u1ed1 c\u1ee7a $e$, b\u1edfi v\u00ec n\u1ebfu kh\u00f4ng Kruskal \u0111\u00e3 ch\u1ecdn $f$ s\u1edbm h\u01a1n. N\u00f3 c\u0169ng kh\u00f4ng th\u1ec3 c\u00f3 tr\u1ecdng s\u1ed1 l\u1edbn h\u01a1n, v\u00ec \u0111i\u1ec1u \u0111\u00f3 s\u1ebd l\u00e0m cho t\u1ed5ng tr\u1ecdng s\u1ed1 c\u1ee7a $T - f + e$ nh\u1ecf h\u01a1n t\u1ed5ng tr\u1ecdng s\u1ed1 c\u1ee7a $T$, \u0111i\u1ec1u n\u00e0y l\u00e0 kh\u00f4ng th\u1ec3 v\u00ec $T$ \u0111\u00e3 l\u00e0 m\u1ed9t MST. \u0110i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 tr\u1ecdng s\u1ed1 c\u1ee7a $e$ ph\u1ea3i gi\u1ed1ng nh\u01b0 tr\u1ecdng s\u1ed1 c\u1ee7a $f$. Do \u0111\u00f3 $T - f + e$ c\u0169ng l\u00e0 m\u1ed9t MST, v\u00e0 n\u00f3 ch\u1ee9a t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh t\u1eeb $F + e$. V\u00ec v\u1eady \u1edf \u0111\u00e2y \u0111\u1ec1 xu\u1ea5t c\u0169ng v\u1eabn \u0111\u01b0\u1ee3c ho\u00e0n th\u00e0nh sau b\u01b0\u1edbc n\u00e0y.</p> <p>\u0110i\u1ec1u n\u00e0y ch\u1ee9ng minh \u0111\u1ec1 xu\u1ea5t. \u0110i\u1ec1u \u0111\u00f3 c\u00f3 ngh\u0129a l\u00e0 sau khi l\u1eb7p qua t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh, t\u1eadp h\u1ee3p c\u1ea1nh k\u1ebft qu\u1ea3 s\u1ebd li\u00ean th\u00f4ng, v\u00e0 s\u1ebd \u0111\u01b0\u1ee3c ch\u1ee9a trong m\u1ed9t MST, \u0111i\u1ec1u \u0111\u00f3 c\u00f3 ngh\u0129a l\u00e0 n\u00f3 \u0111\u00e3 ph\u1ea3i l\u00e0 m\u1ed9t MST r\u1ed3i.</p>","tags":["Translated"]},{"location":"graph/mst_kruskal.html#improved-implementation","title":"C\u00e0i \u0111\u1eb7t c\u1ea3i ti\u1ebfn (Improved implementation)","text":"<p>Ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng c\u1ea5u tr\u00fac d\u1eef li\u1ec7u Disjoint Set Union (DSU) \u0111\u1ec3 vi\u1ebft m\u1ed9t b\u1ea3n c\u00e0i \u0111\u1eb7t nhanh h\u01a1n c\u1ee7a thu\u1eadt to\u00e1n Kruskal v\u1edbi \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian kho\u1ea3ng $O(M \\log N)$. B\u00e0i vi\u1ebft n\u00e0y tr\u00ecnh b\u00e0y chi ti\u1ebft v\u1ec1 c\u00e1ch ti\u1ebfp c\u1eadn nh\u01b0 v\u1eady.</p>","tags":["Translated"]},{"location":"graph/mst_kruskal.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>SPOJ - Koicost</li> <li>SPOJ - MaryBMW</li> <li>Codechef - Fullmetal Alchemist</li> <li>Codeforces - Edges in MST</li> <li>UVA 12176 - Bring Your Own Horse</li> <li>UVA 10600 - ACM Contest and Blackout</li> <li>UVA 10724 - Road Construction</li> <li>Hackerrank - Roads in HackerLand</li> <li>UVA 11710 - Expensive subway</li> <li>Codechef - Chefland and Electricity</li> <li>UVA 10307 - Killing Aliens in Borg Maze</li> <li>Codeforces - Flea</li> <li>Codeforces - Igon in Museum</li> <li>Codeforces - Hongcow Builds a Nation</li> <li>UVA - 908 - Re-connecting Computer Sites</li> <li>UVA 1208 - Oreon</li> <li>UVA 1235 - Anti Brute Force Lock</li> <li>UVA 10034 - Freckles</li> <li>UVA 11228 - Transportation system</li> <li>UVA 11631 - Dark roads</li> <li>UVA 11733 - Airports</li> <li>UVA 11747 - Heavy Cycle Edges</li> <li>SPOJ - Blinet</li> <li>SPOJ - Help the Old King</li> <li>Codeforces - Hierarchy</li> <li>SPOJ - Modems</li> <li>CSES - Road Reparation</li> <li>CSES - Road Construction</li> </ul>","tags":["Translated"]},{"location":"graph/mst_kruskal_with_dsu.html","title":"C\u00e2y khung nh\u1ecf nh\u1ea5t - Kruskal v\u1edbi Disjoint Set Union (Minimum spanning tree - Kruskal with Disjoint Set Union)","text":"<p>\u0110\u1ec3 gi\u1ea3i th\u00edch v\u1ec1 b\u00e0i to\u00e1n MST v\u00e0 thu\u1eadt to\u00e1n Kruskal, tr\u01b0\u1edbc ti\u00ean h\u00e3y xem b\u00e0i vi\u1ebft ch\u00ednh v\u1ec1 thu\u1eadt to\u00e1n Kruskal.</p> <p>Trong b\u00e0i vi\u1ebft n\u00e0y, ch\u00fang ta s\u1ebd xem x\u00e9t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u \"Disjoint Set Union\" \u0111\u1ec3 c\u00e0i \u0111\u1eb7t thu\u1eadt to\u00e1n Kruskal, cho ph\u00e9p thu\u1eadt to\u00e1n \u0111\u1ea1t \u0111\u01b0\u1ee3c \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian l\u00e0 $O(M \\log N)$.</p>","tags":["Translated"]},{"location":"graph/mst_kruskal_with_dsu.html#description","title":"M\u00f4 t\u1ea3 (Description)","text":"<p>C\u0169ng gi\u1ed1ng nh\u01b0 trong phi\u00ean b\u1ea3n \u0111\u01a1n gi\u1ea3n c\u1ee7a thu\u1eadt to\u00e1n Kruskal, ch\u00fang ta s\u1eafp x\u1ebfp t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh c\u1ee7a \u0111\u1ed3 th\u1ecb theo th\u1ee9 t\u1ef1 tr\u1ecdng s\u1ed1 kh\u00f4ng gi\u1ea3m. Sau \u0111\u00f3 \u0111\u1eb7t m\u1ed7i \u0111\u1ec9nh v\u00e0o c\u00e2y ri\u00eang c\u1ee7a n\u00f3 (t\u1ee9c l\u00e0 t\u1eadp h\u1ee3p c\u1ee7a n\u00f3) th\u00f4ng qua c\u00e1c l\u1ec7nh g\u1ecdi \u0111\u1ebfn h\u00e0m <code>make_set</code> - t\u1ed5ng c\u1ed9ng s\u1ebd m\u1ea5t $O(N)$. Ch\u00fang ta l\u1eb7p qua t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh (theo th\u1ee9 t\u1ef1 \u0111\u00e3 s\u1eafp x\u1ebfp) v\u00e0 \u0111\u1ed1i v\u1edbi m\u1ed7i c\u1ea1nh x\u00e1c \u0111\u1ecbnh xem c\u00e1c \u0111\u1ea7u m\u00fat c\u00f3 thu\u1ed9c v\u1ec1 c\u00e1c c\u00e2y kh\u00e1c nhau hay kh\u00f4ng (v\u1edbi hai l\u1ec7nh g\u1ecdi <code>find_set</code> trong $O(1)$ m\u1ed7i l\u1ec7nh). Cu\u1ed1i c\u00f9ng, ch\u00fang ta c\u1ea7n th\u1ef1c hi\u1ec7n h\u1ee3p nh\u1ea5t hai c\u00e2y (t\u1eadp h\u1ee3p), m\u00e0 h\u00e0m DSU <code>union_sets</code> s\u1ebd \u0111\u01b0\u1ee3c g\u1ecdi - c\u0169ng trong $O(1)$. V\u00ec v\u1eady, ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c t\u1ed5ng \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian l\u00e0 $O(M \\log N + N + M)$ = $O(M \\log N)$.</p>","tags":["Translated"]},{"location":"graph/mst_kruskal_with_dsu.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 c\u00e0i \u0111\u1eb7t thu\u1eadt to\u00e1n Kruskal v\u1edbi Union by Rank.</p> <pre><code>vector&lt;int&gt; parent, rank;\n\nvoid make_set(int v) {\n    parent[v] = v;\n    rank[v] = 0;\n}\n\nint find_set(int v) {\n    if (v == parent[v])\n        return v;\n    return parent[v] = find_set(parent[v]);\n}\n\nvoid union_sets(int a, int b) {\n    a = find_set(a);\n    b = find_set(b);\n    if (a != b) {\n        if (rank[a] &lt; rank[b])\n            swap(a, b);\n        parent[b] = a;\n        if (rank[a] == rank[b])\n            rank[a]++;\n    }\n}\n\nstruct Edge {\n    int u, v, weight;\n    bool operator&lt;(Edge const&amp; other) {\n        return weight &lt; other.weight;\n    }\n};\n\nint n;\nvector&lt;Edge&gt; edges;\n\nint cost = 0;\nvector&lt;Edge&gt; result;\nparent.resize(n);\nrank.resize(n);\nfor (int i = 0; i &lt; n; i++)\n    make_set(i);\n\nsort(edges.begin(), edges.end());\n\nfor (Edge e : edges) {\n    if (find_set(e.u) != find_set(e.v)) {\n        cost += e.weight;\n        result.push_back(e);\n        union_sets(e.u, e.v);\n    }\n}\n</code></pre> <p>L\u01b0u \u00fd: v\u00ec MST s\u1ebd ch\u1ee9a ch\u00ednh x\u00e1c $N-1$ c\u1ea1nh, ch\u00fang ta c\u00f3 th\u1ec3 d\u1eebng v\u00f2ng l\u1eb7p for khi ch\u00fang ta t\u00ecm th\u1ea5y \u0111\u1ee7 s\u1ed1 l\u01b0\u1ee3ng \u0111\u00f3.</p>","tags":["Translated"]},{"location":"graph/mst_kruskal_with_dsu.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<p>Xem b\u00e0i vi\u1ebft ch\u00ednh v\u1ec1 thu\u1eadt to\u00e1n Kruskal \u0111\u1ec3 bi\u1ebft danh s\u00e1ch c\u00e1c b\u00e0i t\u1eadp v\u1ec1 ch\u1ee7 \u0111\u1ec1 n\u00e0y.</p>","tags":["Translated"]},{"location":"graph/mst_prim.html","title":"C\u00e2y khung nh\u1ecf nh\u1ea5t - Thu\u1eadt to\u00e1n Prim (Minimum spanning tree - Prim's algorithm)","text":"<p>Cho m\u1ed9t \u0111\u1ed3 th\u1ecb v\u00f4 h\u01b0\u1edbng c\u00f3 tr\u1ecdng s\u1ed1 $G$ v\u1edbi $n$ \u0111\u1ec9nh v\u00e0 $m$ c\u1ea1nh. B\u1ea1n mu\u1ed1n t\u00ecm m\u1ed9t c\u00e2y khung (spanning tree) c\u1ee7a \u0111\u1ed3 th\u1ecb n\u00e0y k\u1ebft n\u1ed1i t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh v\u00e0 c\u00f3 tr\u1ecdng s\u1ed1 nh\u1ecf nh\u1ea5t (t\u1ee9c l\u00e0 t\u1ed5ng tr\u1ecdng s\u1ed1 c\u1ee7a c\u00e1c c\u1ea1nh l\u00e0 nh\u1ecf nh\u1ea5t). M\u1ed9t c\u00e2y khung l\u00e0 m\u1ed9t t\u1eadp h\u1ee3p c\u00e1c c\u1ea1nh sao cho b\u1ea5t k\u1ef3 \u0111\u1ec9nh n\u00e0o c\u0169ng c\u00f3 th\u1ec3 \u0111\u1ebfn b\u1ea5t k\u1ef3 \u0111\u1ec9nh n\u00e0o kh\u00e1c b\u1eb1ng ch\u00ednh x\u00e1c m\u1ed9t \u0111\u01b0\u1eddng \u0111i \u0111\u01a1n gi\u1ea3n. C\u00e2y khung c\u00f3 tr\u1ecdng s\u1ed1 nh\u1ecf nh\u1ea5t \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 c\u00e2y khung nh\u1ecf nh\u1ea5t (minimum spanning tree - MST).</p> <p>Trong h\u00ecnh b\u00ean tr\u00e1i b\u1ea1n c\u00f3 th\u1ec3 th\u1ea5y m\u1ed9t \u0111\u1ed3 th\u1ecb v\u00f4 h\u01b0\u1edbng c\u00f3 tr\u1ecdng s\u1ed1, v\u00e0 trong h\u00ecnh b\u00ean ph\u1ea3i b\u1ea1n c\u00f3 th\u1ec3 th\u1ea5y c\u00e2y khung nh\u1ecf nh\u1ea5t t\u01b0\u01a1ng \u1ee9ng.</p> <p>D\u1ec5 d\u00e0ng th\u1ea5y r\u1eb1ng b\u1ea5t k\u1ef3 c\u00e2y khung n\u00e0o c\u0169ng nh\u1ea5t thi\u1ebft ch\u1ee9a $n-1$ c\u1ea1nh.</p> <p>B\u00e0i to\u00e1n n\u00e0y xu\u1ea5t hi\u1ec7n kh\u00e1 t\u1ef1 nhi\u00ean trong r\u1ea5t nhi\u1ec1u b\u00e0i to\u00e1n. V\u00ed d\u1ee5 trong b\u00e0i to\u00e1n sau: c\u00f3 $n$ th\u00e0nh ph\u1ed1 v\u00e0 v\u1edbi m\u1ed7i c\u1eb7p th\u00e0nh ph\u1ed1 ch\u00fang ta \u0111\u01b0\u1ee3c cho chi ph\u00ed \u0111\u1ec3 x\u00e2y d\u1ef1ng m\u1ed9t con \u0111\u01b0\u1eddng gi\u1eefa ch\u00fang (ho\u1eb7c ch\u00fang ta bi\u1ebft r\u1eb1ng v\u1ec1 m\u1eb7t v\u1eadt l\u00fd l\u00e0 kh\u00f4ng th\u1ec3 x\u00e2y d\u1ef1ng m\u1ed9t con \u0111\u01b0\u1eddng gi\u1eefa ch\u00fang). Ch\u00fang ta ph\u1ea3i x\u00e2y d\u1ef1ng c\u00e1c con \u0111\u01b0\u1eddng, sao cho ch\u00fang ta c\u00f3 th\u1ec3 \u0111i t\u1eeb m\u1ed7i th\u00e0nh ph\u1ed1 \u0111\u1ebfn m\u1ecdi th\u00e0nh ph\u1ed1 kh\u00e1c, v\u00e0 chi ph\u00ed \u0111\u1ec3 x\u00e2y d\u1ef1ng t\u1ea5t c\u1ea3 c\u00e1c con \u0111\u01b0\u1eddng l\u00e0 nh\u1ecf nh\u1ea5t.</p>","tags":["Translated"]},{"location":"graph/mst_prim.html#prims-algorithm","title":"Thu\u1eadt to\u00e1n Prim (Prim's Algorithm)","text":"<p>Thu\u1eadt to\u00e1n n\u00e0y ban \u0111\u1ea7u \u0111\u01b0\u1ee3c ph\u00e1t hi\u1ec7n b\u1edfi nh\u00e0 to\u00e1n h\u1ecdc ng\u01b0\u1eddi S\u00e9c Vojt\u011bch Jarn\u00edk v\u00e0o n\u0103m 1930. Tuy nhi\u00ean thu\u1eadt to\u00e1n n\u00e0y ch\u1ee7 y\u1ebfu \u0111\u01b0\u1ee3c bi\u1ebft \u0111\u1ebfn v\u1edbi t\u00ean g\u1ecdi thu\u1eadt to\u00e1n Prim theo t\u00ean nh\u00e0 to\u00e1n h\u1ecdc ng\u01b0\u1eddi M\u1ef9 Robert Clay Prim, ng\u01b0\u1eddi \u0111\u00e3 ph\u00e1t hi\u1ec7n l\u1ea1i v\u00e0 xu\u1ea5t b\u1ea3n n\u00f3 v\u00e0o n\u0103m 1957. Ngo\u00e0i ra Edsger Dijkstra \u0111\u00e3 xu\u1ea5t b\u1ea3n thu\u1eadt to\u00e1n n\u00e0y v\u00e0o n\u0103m 1959.</p>","tags":["Translated"]},{"location":"graph/mst_prim.html#mo-ta-thuat-toan-algorithm-description","title":"M\u00f4 t\u1ea3 thu\u1eadt to\u00e1n (Algorithm description)","text":"<p>\u1ede \u0111\u00e2y ch\u00fang t\u00f4i m\u00f4 t\u1ea3 thu\u1eadt to\u00e1n \u1edf d\u1ea1ng \u0111\u01a1n gi\u1ea3n nh\u1ea5t c\u1ee7a n\u00f3. C\u00e2y khung nh\u1ecf nh\u1ea5t \u0111\u01b0\u1ee3c x\u00e2y d\u1ef1ng d\u1ea7n d\u1ea7n b\u1eb1ng c\u00e1ch th\u00eam t\u1eebng c\u1ea1nh m\u1ed9t. Ban \u0111\u1ea7u c\u00e2y khung ch\u1ec9 bao g\u1ed3m m\u1ed9t \u0111\u1ec9nh duy nh\u1ea5t (\u0111\u01b0\u1ee3c ch\u1ecdn t\u00f9y \u00fd). Sau \u0111\u00f3 c\u1ea1nh c\u00f3 tr\u1ecdng s\u1ed1 nh\u1ecf nh\u1ea5t \u0111i ra t\u1eeb \u0111\u1ec9nh n\u00e0y \u0111\u01b0\u1ee3c ch\u1ecdn v\u00e0 th\u00eam v\u00e0o c\u00e2y khung. Sau \u0111\u00f3 c\u00e2y khung \u0111\u00e3 bao g\u1ed3m hai \u0111\u1ec9nh. B\u00e2y gi\u1edd ch\u1ecdn v\u00e0 th\u00eam c\u1ea1nh c\u00f3 tr\u1ecdng s\u1ed1 nh\u1ecf nh\u1ea5t c\u00f3 m\u1ed9t \u0111\u1ea7u \u1edf m\u1ed9t \u0111\u1ec9nh \u0111\u00e3 ch\u1ecdn (t\u1ee9c l\u00e0 m\u1ed9t \u0111\u1ec9nh \u0111\u00e3 l\u00e0 m\u1ed9t ph\u1ea7n c\u1ee7a c\u00e2y khung), v\u00e0 \u0111\u1ea7u kia \u1edf m\u1ed9t \u0111\u1ec9nh ch\u01b0a \u0111\u01b0\u1ee3c ch\u1ecdn. V\u00e0 c\u1ee9 th\u1ebf, t\u1ee9c l\u00e0 m\u1ed7i l\u1ea7n ch\u00fang ta ch\u1ecdn v\u00e0 th\u00eam c\u1ea1nh v\u1edbi tr\u1ecdng s\u1ed1 nh\u1ecf nh\u1ea5t n\u1ed1i m\u1ed9t \u0111\u1ec9nh \u0111\u00e3 ch\u1ecdn v\u1edbi m\u1ed9t \u0111\u1ec9nh ch\u01b0a ch\u1ecdn. Qu\u00e1 tr\u00ecnh n\u00e0y \u0111\u01b0\u1ee3c l\u1eb7p l\u1ea1i cho \u0111\u1ebfn khi c\u00e2y khung ch\u1ee9a t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh (ho\u1eb7c t\u01b0\u01a1ng \u0111\u01b0\u01a1ng cho \u0111\u1ebfn khi ch\u00fang ta c\u00f3 $n - 1$ c\u1ea1nh).</p> <p>Cu\u1ed1i c\u00f9ng c\u00e2y khung \u0111\u01b0\u1ee3c x\u00e2y d\u1ef1ng s\u1ebd l\u00e0 nh\u1ecf nh\u1ea5t. N\u1ebfu \u0111\u1ed3 th\u1ecb ban \u0111\u1ea7u kh\u00f4ng li\u00ean th\u00f4ng, th\u00ec kh\u00f4ng t\u1ed3n t\u1ea1i c\u00e2y khung, v\u00ec v\u1eady s\u1ed1 l\u01b0\u1ee3ng c\u1ea1nh \u0111\u01b0\u1ee3c ch\u1ecdn s\u1ebd \u00edt h\u01a1n $n - 1$.</p>","tags":["Translated"]},{"location":"graph/mst_prim.html#chung-minh-proof","title":"Ch\u1ee9ng minh (Proof)","text":"<p>Gi\u1ea3 s\u1eed \u0111\u1ed3 th\u1ecb $G$ li\u00ean th\u00f4ng, t\u1ee9c l\u00e0 c\u00e2u tr\u1ea3 l\u1eddi t\u1ed3n t\u1ea1i. Ch\u00fang t\u00f4i k\u00fd hi\u1ec7u $T$ l\u00e0 \u0111\u1ed3 th\u1ecb k\u1ebft qu\u1ea3 \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y b\u1edfi thu\u1eadt to\u00e1n Prim, v\u00e0 $S$ l\u00e0 c\u00e2y khung nh\u1ecf nh\u1ea5t. R\u00f5 r\u00e0ng $T$ th\u1ef1c s\u1ef1 l\u00e0 m\u1ed9t c\u00e2y khung v\u00e0 m\u1ed9t \u0111\u1ed3 th\u1ecb con c\u1ee7a $G$. Ch\u00fang ta ch\u1ec9 c\u1ea7n ch\u1ec9 ra r\u1eb1ng tr\u1ecdng s\u1ed1 c\u1ee7a $S$ v\u00e0 $T$ tr\u00f9ng nhau.</p> <p>H\u00e3y xem x\u00e9t l\u1ea7n \u0111\u1ea7u ti\u00ean trong thu\u1eadt to\u00e1n khi ch\u00fang ta th\u00eam m\u1ed9t c\u1ea1nh v\u00e0o $T$ m\u00e0 kh\u00f4ng ph\u1ea3i l\u00e0 m\u1ed9t ph\u1ea7n c\u1ee7a $S$. H\u00e3y k\u00fd hi\u1ec7u c\u1ea1nh n\u00e0y l\u00e0 $e$, c\u00e1c \u0111\u1ea7u c\u1ee7a n\u00f3 l\u00e0 $a$ v\u00e0 $b$, v\u00e0 t\u1eadp h\u1ee3p c\u00e1c \u0111\u1ec9nh \u0111\u00e3 \u0111\u01b0\u1ee3c ch\u1ecdn l\u00e0 $V$ ($a \\in V$ v\u00e0 $b \\notin V$, ho\u1eb7c ng\u01b0\u1ee3c l\u1ea1i).</p> <p>Trong c\u00e2y khung nh\u1ecf nh\u1ea5t $S$ c\u00e1c \u0111\u1ec9nh $a$ v\u00e0 $b$ \u0111\u01b0\u1ee3c k\u1ebft n\u1ed1i b\u1edfi m\u1ed9t \u0111\u01b0\u1eddng \u0111i $P$ n\u00e0o \u0111\u00f3. Tr\u00ean \u0111\u01b0\u1eddng \u0111i n\u00e0y, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm th\u1ea5y m\u1ed9t c\u1ea1nh $f$ sao cho m\u1ed9t \u0111\u1ea7u c\u1ee7a $f$ n\u1eb1m trong $V$ v\u00e0 \u0111\u1ea7u kia th\u00ec kh\u00f4ng. V\u00ec thu\u1eadt to\u00e1n \u0111\u00e3 ch\u1ecdn $e$ thay v\u00ec $f$, \u0111i\u1ec1u \u0111\u00f3 c\u00f3 ngh\u0129a l\u00e0 tr\u1ecdng s\u1ed1 c\u1ee7a $f$ l\u1edbn h\u01a1n ho\u1eb7c b\u1eb1ng tr\u1ecdng s\u1ed1 c\u1ee7a $e$.</p> <p>Ch\u00fang ta th\u00eam c\u1ea1nh $e$ v\u00e0o c\u00e2y khung nh\u1ecf nh\u1ea5t $S$ v\u00e0 lo\u1ea1i b\u1ecf c\u1ea1nh $f$. B\u1eb1ng c\u00e1ch th\u00eam $e$ ch\u00fang ta \u0111\u00e3 t\u1ea1o ra m\u1ed9t chu tr\u00ecnh, v\u00e0 v\u00ec $f$ c\u0169ng l\u00e0 m\u1ed9t ph\u1ea7n c\u1ee7a chu tr\u00ecnh duy nh\u1ea5t \u0111\u00f3, b\u1eb1ng c\u00e1ch lo\u1ea1i b\u1ecf n\u00f3, \u0111\u1ed3 th\u1ecb k\u1ebft qu\u1ea3 l\u1ea1i kh\u00f4ng c\u00f3 chu tr\u00ecnh. V\u00e0 b\u1edfi v\u00ec ch\u00fang ta ch\u1ec9 lo\u1ea1i b\u1ecf m\u1ed9t c\u1ea1nh kh\u1ecfi m\u1ed9t chu tr\u00ecnh, \u0111\u1ed3 th\u1ecb k\u1ebft qu\u1ea3 v\u1eabn li\u00ean th\u00f4ng.</p> <p>C\u00e2y khung k\u1ebft qu\u1ea3 kh\u00f4ng th\u1ec3 c\u00f3 t\u1ed5ng tr\u1ecdng s\u1ed1 l\u1edbn h\u01a1n, v\u00ec tr\u1ecdng s\u1ed1 c\u1ee7a $e$ kh\u00f4ng l\u1edbn h\u01a1n tr\u1ecdng s\u1ed1 c\u1ee7a $f$, v\u00e0 n\u00f3 c\u0169ng kh\u00f4ng th\u1ec3 c\u00f3 tr\u1ecdng s\u1ed1 nh\u1ecf h\u01a1n v\u00ec $S$ l\u00e0 m\u1ed9t c\u00e2y khung nh\u1ecf nh\u1ea5t. \u0110i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 b\u1eb1ng c\u00e1ch thay th\u1ebf c\u1ea1nh $f$ b\u1eb1ng $e$ ch\u00fang ta \u0111\u00e3 t\u1ea1o ra m\u1ed9t c\u00e2y khung nh\u1ecf nh\u1ea5t kh\u00e1c. V\u00e0 $e$ ph\u1ea3i c\u00f3 c\u00f9ng tr\u1ecdng s\u1ed1 v\u1edbi $f$.</p> <p>Do \u0111\u00f3, t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh ch\u00fang ta ch\u1ecdn trong thu\u1eadt to\u00e1n Prim \u0111\u1ec1u c\u00f3 tr\u1ecdng s\u1ed1 gi\u1ed1ng nh\u01b0 c\u00e1c c\u1ea1nh c\u1ee7a b\u1ea5t k\u1ef3 c\u00e2y khung nh\u1ecf nh\u1ea5t n\u00e0o, \u0111i\u1ec1u \u0111\u00f3 c\u00f3 ngh\u0129a l\u00e0 thu\u1eadt to\u00e1n Prim th\u1ef1c s\u1ef1 t\u1ea1o ra m\u1ed9t c\u00e2y khung nh\u1ecf nh\u1ea5t.</p>","tags":["Translated"]},{"location":"graph/mst_prim.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a thu\u1eadt to\u00e1n ph\u1ee5 thu\u1ed9c v\u00e0o c\u00e1ch ch\u00fang ta t\u00ecm ki\u1ebfm c\u1ea1nh nh\u1ecf nh\u1ea5t ti\u1ebfp theo trong s\u1ed1 c\u00e1c c\u1ea1nh th\u00edch h\u1ee3p. C\u00f3 nhi\u1ec1u c\u00e1ch ti\u1ebfp c\u1eadn d\u1eabn \u0111\u1ebfn \u0111\u1ed9 ph\u1ee9c t\u1ea1p kh\u00e1c nhau v\u00e0 c\u00e1c c\u00e1ch c\u00e0i \u0111\u1eb7t kh\u00e1c nhau.</p>","tags":["Translated"]},{"location":"graph/mst_prim.html#cai-at-tam-thuong-on-m-va-on2-m-log-n-trivial-implementations-on-m-and-on2-m-log-n","title":"C\u00e0i \u0111\u1eb7t t\u1ea7m th\u01b0\u1eddng: $O(n m)$ v\u00e0 $O(n^2 + m \\log n)$ (Trivial implementations: $O(n m)$ and $O(n^2 + m \\log n)$)","text":"<p>N\u1ebfu ch\u00fang ta t\u00ecm ki\u1ebfm c\u1ea1nh b\u1eb1ng c\u00e1ch l\u1eb7p qua t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh c\u00f3 th\u1ec3, th\u00ec m\u1ea5t $O(m)$ th\u1eddi gian \u0111\u1ec3 t\u00ecm c\u1ea1nh c\u00f3 tr\u1ecdng s\u1ed1 nh\u1ecf nh\u1ea5t. T\u1ed5ng \u0111\u1ed9 ph\u1ee9c t\u1ea1p s\u1ebd l\u00e0 $O(n m)$. Trong tr\u01b0\u1eddng h\u1ee3p x\u1ea5u nh\u1ea5t, \u0111\u00e2y l\u00e0 $O(n^3)$, th\u1ef1c s\u1ef1 ch\u1eadm.</p> <p>Thu\u1eadt to\u00e1n n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c c\u1ea3i thi\u1ec7n n\u1ebfu ch\u00fang ta ch\u1ec9 nh\u00ecn v\u00e0o m\u1ed9t c\u1ea1nh t\u1eeb m\u1ed7i \u0111\u1ec9nh \u0111\u00e3 \u0111\u01b0\u1ee3c ch\u1ecdn. V\u00ed d\u1ee5, ch\u00fang ta c\u00f3 th\u1ec3 s\u1eafp x\u1ebfp c\u00e1c c\u1ea1nh t\u1eeb m\u1ed7i \u0111\u1ec9nh theo th\u1ee9 t\u1ef1 t\u0103ng d\u1ea7n c\u1ee7a tr\u1ecdng s\u1ed1 c\u1ee7a ch\u00fang, v\u00e0 l\u01b0u tr\u1eef m\u1ed9t con tr\u1ecf \u0111\u1ebfn c\u1ea1nh h\u1ee3p l\u1ec7 \u0111\u1ea7u ti\u00ean (t\u1ee9c l\u00e0 m\u1ed9t c\u1ea1nh \u0111i \u0111\u1ebfn m\u1ed9t \u0111\u1ec9nh ch\u01b0a \u0111\u01b0\u1ee3c ch\u1ecdn). Sau \u0111\u00f3, sau khi t\u00ecm v\u00e0 ch\u1ecdn c\u1ea1nh nh\u1ecf nh\u1ea5t, ch\u00fang ta c\u1eadp nh\u1eadt c\u00e1c con tr\u1ecf. \u0110i\u1ec1u n\u00e0y \u0111\u01b0a ra \u0111\u1ed9 ph\u1ee9c t\u1ea1p l\u00e0 $O(n^2 + m)$, v\u00e0 \u0111\u1ec3 s\u1eafp x\u1ebfp c\u00e1c c\u1ea1nh th\u00eam $O(m \\log n)$, \u0111\u01b0a ra \u0111\u1ed9 ph\u1ee9c t\u1ea1p $O(n^2 \\log n)$ trong tr\u01b0\u1eddng h\u1ee3p x\u1ea5u nh\u1ea5t.</p> <p>D\u01b0\u1edbi \u0111\u00e2y ch\u00fang t\u00f4i xem x\u00e9t hai thu\u1eadt to\u00e1n h\u01a1i kh\u00e1c nhau, m\u1ed9t cho \u0111\u1ed3 th\u1ecb d\u00e0y v\u00e0 m\u1ed9t cho \u0111\u1ed3 th\u1ecb th\u01b0a, c\u1ea3 hai \u0111\u1ec1u c\u00f3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p t\u1ed1t h\u01a1n.</p>","tags":["Translated"]},{"location":"graph/mst_prim.html#o-thi-day-on2-dense-graphs-on2","title":"\u0110\u1ed3 th\u1ecb d\u00e0y: $O(n^2)$ (Dense graphs: $O(n^2)$)","text":"<p>Ch\u00fang ta ti\u1ebfp c\u1eadn v\u1ea5n \u0111\u1ec1 n\u00e0y t\u1eeb m\u1ed9t g\u00f3c \u0111\u1ed9 kh\u00e1c: \u0111\u1ed1i v\u1edbi m\u1ed7i \u0111\u1ec9nh ch\u01b0a \u0111\u01b0\u1ee3c ch\u1ecdn, ch\u00fang ta s\u1ebd l\u01b0u tr\u1eef c\u1ea1nh nh\u1ecf nh\u1ea5t \u0111\u1ebfn m\u1ed9t \u0111\u1ec9nh \u0111\u00e3 \u0111\u01b0\u1ee3c ch\u1ecdn.</p> <p>Sau \u0111\u00f3, trong m\u1ed9t b\u01b0\u1edbc, ch\u00fang ta ch\u1ec9 ph\u1ea3i nh\u00ecn v\u00e0o c\u00e1c c\u1ea1nh c\u00f3 tr\u1ecdng s\u1ed1 nh\u1ecf nh\u1ea5t n\u00e0y, s\u1ebd c\u00f3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p l\u00e0 $O(n)$.</p> <p>Sau khi th\u00eam m\u1ed9t c\u1ea1nh, m\u1ed9t s\u1ed1 con tr\u1ecf c\u1ea1nh nh\u1ecf nh\u1ea5t ph\u1ea3i \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n l\u1ea1i. L\u01b0u \u00fd r\u1eb1ng tr\u1ecdng s\u1ed1 ch\u1ec9 c\u00f3 th\u1ec3 gi\u1ea3m, t\u1ee9c l\u00e0 c\u1ea1nh c\u00f3 tr\u1ecdng s\u1ed1 nh\u1ecf nh\u1ea5t c\u1ee7a m\u1ed7i \u0111\u1ec9nh ch\u01b0a \u0111\u01b0\u1ee3c ch\u1ecdn c\u00f3 th\u1ec3 gi\u1eef nguy\u00ean, ho\u1eb7c n\u00f3 s\u1ebd \u0111\u01b0\u1ee3c c\u1eadp nh\u1eadt b\u1edfi m\u1ed9t c\u1ea1nh \u0111\u1ebfn \u0111\u1ec9nh m\u1edbi \u0111\u01b0\u1ee3c ch\u1ecdn. Do \u0111\u00f3 giai \u0111o\u1ea1n n\u00e0y c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong $O(n)$.</p> <p>Do \u0111\u00f3 ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c m\u1ed9t phi\u00ean b\u1ea3n c\u1ee7a thu\u1eadt to\u00e1n Prim v\u1edbi \u0111\u1ed9 ph\u1ee9c t\u1ea1p $O(n^2)$.</p> <p>\u0110\u1eb7c bi\u1ec7t vi\u1ec7c c\u00e0i \u0111\u1eb7t n\u00e0y r\u1ea5t thu\u1eadn ti\u1ec7n cho b\u00e0i to\u00e1n C\u00e2y khung nh\u1ecf nh\u1ea5t Euclide: ch\u00fang ta c\u00f3 $n$ \u0111i\u1ec3m tr\u00ean m\u1ed9t m\u1eb7t ph\u1eb3ng v\u00e0 kho\u1ea3ng c\u00e1ch gi\u1eefa m\u1ed7i c\u1eb7p \u0111i\u1ec3m l\u00e0 kho\u1ea3ng c\u00e1ch Euclide gi\u1eefa ch\u00fang, v\u00e0 ch\u00fang ta mu\u1ed1n t\u00ecm m\u1ed9t c\u00e2y khung nh\u1ecf nh\u1ea5t cho \u0111\u1ed3 th\u1ecb \u0111\u1ea7y \u0111\u1ee7 n\u00e0y. Nhi\u1ec7m v\u1ee5 n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i quy\u1ebft b\u1eb1ng thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 v\u1edbi th\u1eddi gian $O(n^2)$ v\u00e0 b\u1ed9 nh\u1edb $O(n)$, \u0111i\u1ec1u n\u00e0y kh\u00f4ng th\u1ec3 th\u1ef1c hi\u1ec7n \u0111\u01b0\u1ee3c v\u1edbi thu\u1eadt to\u00e1n Kruskal.</p> <pre><code>int n;\nvector&lt;vector&lt;int&gt;&gt; adj; // ma tr\u1eadn k\u1ec1 c\u1ee7a \u0111\u1ed3 th\u1ecb\nconst int INF = 1000000000; // tr\u1ecdng s\u1ed1 INF c\u00f3 ngh\u0129a l\u00e0 kh\u00f4ng c\u00f3 c\u1ea1nh\n\nstruct Edge {\n    int w = INF, to = -1;\n};\n\nvoid prim() {\n    int total_weight = 0;\n    vector&lt;bool&gt; selected(n, false);\n    vector&lt;Edge&gt; min_e(n);\n    min_e[0].w = 0;\n\n    for (int i=0; i&lt;n; ++i) {\n        int v = -1;\n        for (int j = 0; j &lt; n; ++j) {\n            if (!selected[j] &amp;&amp; (v == -1 || min_e[j].w &lt; min_e[v].w))\n                v = j;\n        }\n\n        if (min_e[v].w == INF) {\n            cout &lt;&lt; \"No MST!\" &lt;&lt; endl;\n            exit(0);\n        }\n\n        selected[v] = true;\n        total_weight += min_e[v].w;\n        if (min_e[v].to != -1)\n            cout &lt;&lt; v &lt;&lt; \" \" &lt;&lt; min_e[v].to &lt;&lt; endl;\n\n        for (int to = 0; to &lt; n; ++to) {\n            if (adj[v][to] &lt; min_e[to].w)\n                min_e[to] = {adj[v][to], v};\n        }\n    }\n\n    cout &lt;&lt; total_weight &lt;&lt; endl;\n}\n</code></pre> <p>Ma tr\u1eadn k\u1ec1 <code>adj[][]</code> c\u00f3 k\u00edch th\u01b0\u1edbc $n \\times n$ l\u01b0u tr\u1eef tr\u1ecdng s\u1ed1 c\u1ee7a c\u00e1c c\u1ea1nh, v\u00e0 n\u00f3 s\u1eed d\u1ee5ng tr\u1ecdng s\u1ed1 <code>INF</code> n\u1ebfu kh\u00f4ng t\u1ed3n t\u1ea1i c\u1ea1nh gi\u1eefa hai \u0111\u1ec9nh. Thu\u1eadt to\u00e1n s\u1eed d\u1ee5ng hai m\u1ea3ng: c\u1edd <code>selected[]</code>, cho bi\u1ebft \u0111\u1ec9nh n\u00e0o ch\u00fang ta \u0111\u00e3 ch\u1ecdn, v\u00e0 m\u1ea3ng <code>min_e[]</code> l\u01b0u tr\u1eef c\u1ea1nh v\u1edbi tr\u1ecdng s\u1ed1 nh\u1ecf nh\u1ea5t \u0111\u1ebfn m\u1ed9t \u0111\u1ec9nh \u0111\u00e3 ch\u1ecdn cho m\u1ed7i \u0111\u1ec9nh ch\u01b0a \u0111\u01b0\u1ee3c ch\u1ecdn (n\u00f3 l\u01b0u tr\u1eef tr\u1ecdng s\u1ed1 v\u00e0 \u0111\u1ec9nh \u0111\u00edch). Thu\u1eadt to\u00e1n th\u1ef1c hi\u1ec7n $n$ b\u01b0\u1edbc, trong m\u1ed7i l\u1ea7n l\u1eb7p, \u0111\u1ec9nh c\u00f3 tr\u1ecdng s\u1ed1 c\u1ea1nh nh\u1ecf nh\u1ea5t \u0111\u01b0\u1ee3c ch\u1ecdn, v\u00e0 <code>min_e[]</code> c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh kh\u00e1c \u0111\u01b0\u1ee3c c\u1eadp nh\u1eadt.</p>","tags":["Translated"]},{"location":"graph/mst_prim.html#o-thi-thua-om-log-n-sparse-graphs-om-log-n","title":"\u0110\u1ed3 th\u1ecb th\u01b0a: $O(m \\log n)$ (Sparse graphs: $O(m \\log n)$)","text":"<p>Trong thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 \u1edf tr\u00ean, c\u00f3 th\u1ec3 di\u1ec5n gi\u1ea3i c\u00e1c thao t\u00e1c t\u00ecm ki\u1ebfm gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t v\u00e0 s\u1eeda \u0111\u1ed5i m\u1ed9t s\u1ed1 gi\u00e1 tr\u1ecb l\u00e0 c\u00e1c thao t\u00e1c t\u1eadp h\u1ee3p. Hai thao t\u00e1c c\u1ed5 \u0111i\u1ec3n n\u00e0y \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3 b\u1edfi nhi\u1ec1u c\u1ea5u tr\u00fac d\u1eef li\u1ec7u, v\u00ed d\u1ee5 nh\u01b0 b\u1edfi <code>set</code> trong C++ (\u0111\u01b0\u1ee3c c\u00e0i \u0111\u1eb7t th\u00f4ng qua c\u00e2y \u0111\u1ecf-\u0111en).</p> <p>Thu\u1eadt to\u00e1n ch\u00ednh v\u1eabn gi\u1eef nguy\u00ean, nh\u01b0ng b\u00e2y gi\u1edd ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm c\u1ea1nh nh\u1ecf nh\u1ea5t trong th\u1eddi gian $O(\\log n)$. M\u1eb7t kh\u00e1c, vi\u1ec7c t\u00ednh to\u00e1n l\u1ea1i c\u00e1c con tr\u1ecf b\u00e2y gi\u1edd s\u1ebd m\u1ea5t $O(n \\log n)$ th\u1eddi gian, t\u1ec7 h\u01a1n so v\u1edbi thu\u1eadt to\u00e1n tr\u01b0\u1edbc \u0111\u00f3.</p> <p>Nh\u01b0ng khi ch\u00fang ta xem x\u00e9t r\u1eb1ng ch\u00fang ta ch\u1ec9 c\u1ea7n c\u1eadp nh\u1eadt t\u1ed5ng c\u1ed9ng $O(m)$ l\u1ea7n, v\u00e0 th\u1ef1c hi\u1ec7n $O(n)$ t\u00ecm ki\u1ebfm c\u1ea1nh nh\u1ecf nh\u1ea5t, th\u00ec t\u1ed5ng \u0111\u1ed9 ph\u1ee9c t\u1ea1p s\u1ebd l\u00e0 $O(m \\log n)$. \u0110\u1ed1i v\u1edbi \u0111\u1ed3 th\u1ecb th\u01b0a, \u0111i\u1ec1u n\u00e0y t\u1ed1t h\u01a1n thu\u1eadt to\u00e1n tr\u00ean, nh\u01b0ng \u0111\u1ed1i v\u1edbi \u0111\u1ed3 th\u1ecb d\u00e0y, \u0111i\u1ec1u n\u00e0y s\u1ebd ch\u1eadm h\u01a1n.</p> <pre><code>const int INF = 1000000000;\n\nstruct Edge {\n    int w = INF, to = -1;\n    bool operator&lt;(Edge const&amp; other) const {\n        return make_pair(w, to) &lt; make_pair(other.w, other.to);\n    }\n};\n\nint n;\nvector&lt;vector&lt;Edge&gt;&gt; adj;\n\nvoid prim() {\n    int total_weight = 0;\n    vector&lt;Edge&gt; min_e(n);\n    min_e[0].w = 0;\n    set&lt;Edge&gt; q;\n    q.insert({0, 0});\n    vector&lt;bool&gt; selected(n, false);\n    for (int i = 0; i &lt; n; ++i) {\n        if (q.empty()) {\n            cout &lt;&lt; \"No MST!\" &lt;&lt; endl;\n            exit(0);\n        }\n\n        int v = q.begin()-&gt;to;\n        selected[v] = true;\n        total_weight += q.begin()-&gt;w;\n        q.erase(q.begin());\n\n        if (min_e[v].to != -1)\n            cout &lt;&lt; v &lt;&lt; \" \" &lt;&lt; min_e[v].to &lt;&lt; endl;\n\n        for (Edge e : adj[v]) {\n            if (!selected[e.to] &amp;&amp; e.w &lt; min_e[e.to].w) {\n                q.erase({min_e[e.to].w, e.to});\n                min_e[e.to] = {e.w, v};\n                q.insert({e.w, e.to});\n            }\n        }\n    }\n\n    cout &lt;&lt; total_weight &lt;&lt; endl;\n}\n</code></pre> <p>\u1ede \u0111\u00e2y \u0111\u1ed3 th\u1ecb \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n th\u00f4ng qua m\u1ed9t danh s\u00e1ch k\u1ec1 <code>adj[]</code>, trong \u0111\u00f3 <code>adj[v]</code> ch\u1ee9a t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh (d\u01b0\u1edbi d\u1ea1ng c\u1eb7p tr\u1ecdng s\u1ed1 v\u00e0 \u0111\u00edch) cho \u0111\u1ec9nh <code>v</code>. <code>min_e[v]</code> s\u1ebd l\u01b0u tr\u1eef tr\u1ecdng s\u1ed1 c\u1ee7a c\u1ea1nh nh\u1ecf nh\u1ea5t t\u1eeb \u0111\u1ec9nh <code>v</code> \u0111\u1ebfn m\u1ed9t \u0111\u1ec9nh \u0111\u00e3 \u0111\u01b0\u1ee3c ch\u1ecdn (m\u1ed9t l\u1ea7n n\u1eefa d\u01b0\u1edbi d\u1ea1ng c\u1eb7p tr\u1ecdng s\u1ed1 v\u00e0 \u0111\u00edch). Ngo\u00e0i ra h\u00e0ng \u0111\u1ee3i <code>q</code> \u0111\u01b0\u1ee3c \u0111i\u1ec1n v\u1edbi t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh ch\u01b0a \u0111\u01b0\u1ee3c ch\u1ecdn theo th\u1ee9 t\u1ef1 tr\u1ecdng s\u1ed1 <code>min_e</code> t\u0103ng d\u1ea7n. Thu\u1eadt to\u00e1n th\u1ef1c hi\u1ec7n <code>n</code> b\u01b0\u1edbc, tr\u00ean m\u1ed7i b\u01b0\u1edbc n\u00f3 ch\u1ecdn \u0111\u1ec9nh <code>v</code> c\u00f3 tr\u1ecdng s\u1ed1 <code>min_e</code> nh\u1ecf nh\u1ea5t (b\u1eb1ng c\u00e1ch tr\u00edch xu\u1ea5t n\u00f3 t\u1eeb \u0111\u1ea7u h\u00e0ng \u0111\u1ee3i), v\u00e0 sau \u0111\u00f3 xem qua t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh t\u1eeb \u0111\u1ec9nh n\u00e0y v\u00e0 c\u1eadp nh\u1eadt c\u00e1c gi\u00e1 tr\u1ecb trong <code>min_e</code> (trong qu\u00e1 tr\u00ecnh c\u1eadp nh\u1eadt, ch\u00fang ta c\u0169ng c\u1ea7n lo\u1ea1i b\u1ecf c\u1ea1nh c\u0169 kh\u1ecfi h\u00e0ng \u0111\u1ee3i <code>q</code> v\u00e0 \u0111\u01b0a v\u00e0o c\u1ea1nh m\u1edbi).</p>","tags":["Translated"]},{"location":"graph/pruefer_code.html","title":"M\u00e3 Pr\u00fcfer (Pr\u00fcfer code)","text":"<p>Trong b\u00e0i vi\u1ebft n\u00e0y, ch\u00fang ta s\u1ebd t\u00ecm hi\u1ec3u v\u1ec1 c\u00e1i g\u1ecdi l\u00e0 m\u00e3 Pr\u00fcfer (ho\u1eb7c chu\u1ed7i Pr\u00fcfer), m\u1ed9t c\u00e1ch m\u00e3 h\u00f3a m\u1ed9t c\u00e2y c\u00f3 nh\u00e3n th\u00e0nh m\u1ed9t d\u00e3y s\u1ed1 theo m\u1ed9t c\u00e1ch duy nh\u1ea5t.</p> <p>V\u1edbi s\u1ef1 tr\u1ee3 gi\u00fap c\u1ee7a m\u00e3 Pr\u00fcfer, ch\u00fang ta s\u1ebd ch\u1ee9ng minh C\u00f4ng th\u1ee9c Cayley (x\u00e1c \u0111\u1ecbnh s\u1ed1 l\u01b0\u1ee3ng c\u00e2y khung trong m\u1ed9t \u0111\u1ed3 th\u1ecb \u0111\u1ea7y \u0111\u1ee7). Ch\u00fang t\u00f4i c\u0169ng ch\u1ec9 ra gi\u1ea3i ph\u00e1p cho b\u00e0i to\u00e1n \u0111\u1ebfm s\u1ed1 c\u00e1ch th\u00eam c\u00e1c c\u1ea1nh v\u00e0o m\u1ed9t \u0111\u1ed3 th\u1ecb \u0111\u1ec3 l\u00e0m cho n\u00f3 li\u00ean th\u00f4ng.</p> <p>L\u01b0u \u00fd, ch\u00fang t\u00f4i s\u1ebd kh\u00f4ng xem x\u00e9t c\u00e1c c\u00e2y bao g\u1ed3m m\u1ed9t \u0111\u1ec9nh duy nh\u1ea5t - \u0111\u00e2y l\u00e0 m\u1ed9t tr\u01b0\u1eddng h\u1ee3p \u0111\u1eb7c bi\u1ec7t m\u00e0 nhi\u1ec1u ph\u00e1t bi\u1ec3u b\u1ecb xung \u0111\u1ed9t.</p>","tags":["Translated"]},{"location":"graph/pruefer_code.html#pruefer-code","title":"M\u00e3 Pr\u00fcfer (Pr\u00fcfer code)","text":"<p>M\u00e3 Pr\u00fcfer l\u00e0 m\u1ed9t c\u00e1ch m\u00e3 h\u00f3a m\u1ed9t c\u00e2y c\u00f3 nh\u00e3n v\u1edbi $n$ \u0111\u1ec9nh b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng m\u1ed9t d\u00e3y g\u1ed3m $n - 2$ s\u1ed1 nguy\u00ean trong kho\u1ea3ng $[0; n-1]$. C\u00e1ch m\u00e3 h\u00f3a n\u00e0y c\u0169ng ho\u1ea1t \u0111\u1ed9ng nh\u01b0 m\u1ed9t song \u00e1nh (bijection) gi\u1eefa t\u1ea5t c\u1ea3 c\u00e1c c\u00e2y khung c\u1ee7a m\u1ed9t \u0111\u1ed3 th\u1ecb \u0111\u1ea7y \u0111\u1ee7 v\u00e0 c\u00e1c d\u00e3y s\u1ed1.</p> <p>M\u1eb7c d\u00f9 s\u1eed d\u1ee5ng m\u00e3 Pr\u00fcfer \u0111\u1ec3 l\u01b0u tr\u1eef v\u00e0 thao t\u00e1c tr\u00ean c\u00e2y l\u00e0 kh\u00f4ng th\u1ef1c t\u1ebf do \u0111\u1eb7c \u0111i\u1ec3m k\u1ef9 thu\u1eadt c\u1ee7a bi\u1ec3u di\u1ec5n, m\u00e3 Pr\u00fcfer \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng th\u01b0\u1eddng xuy\u00ean: ch\u1ee7 y\u1ebfu trong vi\u1ec7c gi\u1ea3i quy\u1ebft c\u00e1c b\u00e0i to\u00e1n t\u1ed5 h\u1ee3p.</p> <p>Ng\u01b0\u1eddi ph\u00e1t minh - Heinz Pr\u00fcfer - \u0111\u00e3 \u0111\u1ec1 xu\u1ea5t m\u00e3 n\u00e0y v\u00e0o n\u0103m 1918 nh\u01b0 m\u1ed9t ch\u1ee9ng minh cho c\u00f4ng th\u1ee9c Cayley.</p>","tags":["Translated"]},{"location":"graph/pruefer_code.html#xay-dung-ma-prufer-cho-mot-cay-a-cho-building-the-prufer-code-for-a-given-tree","title":"X\u00e2y d\u1ef1ng m\u00e3 Pr\u00fcfer cho m\u1ed9t c\u00e2y \u0111\u00e3 cho (Building the Pr\u00fcfer code for a given tree)","text":"<p>M\u00e3 Pr\u00fcfer \u0111\u01b0\u1ee3c x\u00e2y d\u1ef1ng nh\u01b0 sau. Ch\u00fang ta s\u1ebd l\u1eb7p l\u1ea1i quy tr\u00ecnh sau $n - 2$ l\u1ea7n: ch\u00fang ta ch\u1ecdn l\u00e1 c\u1ee7a c\u00e2y c\u00f3 s\u1ed1 nh\u1ecf nh\u1ea5t, lo\u1ea1i b\u1ecf n\u00f3 kh\u1ecfi c\u00e2y v\u00e0 ghi l\u1ea1i s\u1ed1 c\u1ee7a \u0111\u1ec9nh \u0111\u00e3 \u0111\u01b0\u1ee3c k\u1ebft n\u1ed1i v\u1edbi n\u00f3. Sau $n - 2$ l\u1ea7n l\u1eb7p s\u1ebd ch\u1ec9 c\u00f2n l\u1ea1i $2$ \u0111\u1ec9nh, v\u00e0 thu\u1eadt to\u00e1n k\u1ebft th\u00fac.</p> <p>Do \u0111\u00f3, m\u00e3 Pr\u00fcfer cho m\u1ed9t c\u00e2y \u0111\u00e3 cho l\u00e0 m\u1ed9t d\u00e3y g\u1ed3m $n - 2$ s\u1ed1, trong \u0111\u00f3 m\u1ed7i s\u1ed1 l\u00e0 s\u1ed1 c\u1ee7a \u0111\u1ec9nh \u0111\u01b0\u1ee3c k\u1ebft n\u1ed1i, t\u1ee9c l\u00e0 s\u1ed1 n\u00e0y n\u1eb1m trong kho\u1ea3ng $[0, n-1]$.</p> <p>Thu\u1eadt to\u00e1n t\u00ednh to\u00e1n m\u00e3 Pr\u00fcfer c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c c\u00e0i \u0111\u1eb7t d\u1ec5 d\u00e0ng v\u1edbi \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian $O(n \\log n)$, \u0111\u01a1n gi\u1ea3n b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng c\u1ea5u tr\u00fac d\u1eef li\u1ec7u \u0111\u1ec3 tr\u00edch xu\u1ea5t gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t (v\u00ed d\u1ee5: <code>set</code> ho\u1eb7c <code>priority_queue</code> trong C++), ch\u1ee9a danh s\u00e1ch t\u1ea5t c\u1ea3 c\u00e1c l\u00e1 hi\u1ec7n t\u1ea1i.</p> <pre><code>vector&lt;vector&lt;int&gt;&gt; adj;\n\nvector&lt;int&gt; pruefer_code() {\n    int n = adj.size();\n    set&lt;int&gt; leafs;\n    vector&lt;int&gt; degree(n);\n    vector&lt;bool&gt; killed(n, false);\n    for (int i = 0; i &lt; n; i++) {\n        degree[i] = adj[i].size();\n        if (degree[i] == 1)\n            leafs.insert(i);\n    }\n\n    vector&lt;int&gt; code(n - 2);\n    for (int i = 0; i &lt; n - 2; i++) {\n        int leaf = *leafs.begin();\n        leafs.erase(leafs.begin());\n        killed[leaf] = true;\n\n        int v;\n        for (int u : adj[leaf]) {\n            if (!killed[u])\n                v = u;\n        }\n\n        code[i] = v;\n        if (--degree[v] == 1)\n            leafs.insert(v);\n    }\n\n    return code;\n}\n</code></pre> <p>Tuy nhi\u00ean, vi\u1ec7c x\u00e2y d\u1ef1ng c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong th\u1eddi gian tuy\u1ebfn t\u00ednh. C\u00e1ch ti\u1ebfp c\u1eadn nh\u01b0 v\u1eady \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 trong ph\u1ea7n ti\u1ebfp theo.</p>","tags":["Translated"]},{"location":"graph/pruefer_code.html#xay-dung-ma-prufer-cho-mot-cay-a-cho-trong-thoi-gian-tuyen-tinh-building-the-prufer-code-for-a-given-tree-in-linear-time","title":"X\u00e2y d\u1ef1ng m\u00e3 Pr\u00fcfer cho m\u1ed9t c\u00e2y \u0111\u00e3 cho trong th\u1eddi gian tuy\u1ebfn t\u00ednh (Building the Pr\u00fcfer code for a given tree in linear time)","text":"<p>B\u1ea3n ch\u1ea5t c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 s\u1eed d\u1ee5ng m\u1ed9t con tr\u1ecf di chuy\u1ec3n, con tr\u1ecf n\u00e0y s\u1ebd lu\u00f4n tr\u1ecf \u0111\u1ebfn \u0111\u1ec9nh l\u00e1 hi\u1ec7n t\u1ea1i m\u00e0 ch\u00fang ta mu\u1ed1n lo\u1ea1i b\u1ecf.</p> <p>Tho\u1ea1t nh\u00ecn \u0111i\u1ec1u n\u00e0y c\u00f3 v\u1ebb kh\u00f4ng th\u1ec3, b\u1edfi v\u00ec trong qu\u00e1 tr\u00ecnh x\u00e2y d\u1ef1ng m\u00e3 Pr\u00fcfer, s\u1ed1 l\u00e1 c\u00f3 th\u1ec3 t\u0103ng v\u00e0 gi\u1ea3m. Tuy nhi\u00ean, sau khi xem x\u00e9t k\u1ef9 h\u01a1n, \u0111i\u1ec1u n\u00e0y th\u1ef1c s\u1ef1 kh\u00f4ng \u0111\u00fang. S\u1ed1 l\u01b0\u1ee3ng l\u00e1 s\u1ebd kh\u00f4ng t\u0103ng. S\u1ed1 l\u01b0\u1ee3ng gi\u1ea3m \u0111i m\u1ed9t (ch\u00fang ta lo\u1ea1i b\u1ecf m\u1ed9t \u0111\u1ec9nh l\u00e1 v\u00e0 kh\u00f4ng nh\u1eadn \u0111\u01b0\u1ee3c \u0111\u1ec9nh m\u1edbi n\u00e0o), ho\u1eb7c gi\u1eef nguy\u00ean (ch\u00fang ta lo\u1ea1i b\u1ecf m\u1ed9t \u0111\u1ec9nh l\u00e1 v\u00e0 nh\u1eadn \u0111\u01b0\u1ee3c m\u1ed9t \u0111\u1ec9nh kh\u00e1c). Trong tr\u01b0\u1eddng h\u1ee3p \u0111\u1ea7u ti\u00ean, kh\u00f4ng c\u00f3 c\u00e1ch n\u00e0o kh\u00e1c ngo\u00e0i vi\u1ec7c t\u00ecm ki\u1ebfm \u0111\u1ec9nh l\u00e1 nh\u1ecf nh\u1ea5t ti\u1ebfp theo. Tuy nhi\u00ean, trong tr\u01b0\u1eddng h\u1ee3p th\u1ee9 hai, ch\u00fang ta c\u00f3 th\u1ec3 quy\u1ebft \u0111\u1ecbnh trong th\u1eddi gian $O(1)$, li\u1ec7u ch\u00fang ta c\u00f3 th\u1ec3 ti\u1ebfp t\u1ee5c s\u1eed d\u1ee5ng \u0111\u1ec9nh \u0111\u00e3 tr\u1edf th\u00e0nh \u0111\u1ec9nh l\u00e1 m\u1edbi hay kh\u00f4ng, hay ch\u00fang ta ph\u1ea3i t\u00ecm ki\u1ebfm \u0111\u1ec9nh l\u00e1 nh\u1ecf nh\u1ea5t ti\u1ebfp theo. V\u00e0 trong kh\u00e1 nhi\u1ec1u l\u1ea7n ch\u00fang ta c\u00f3 th\u1ec3 ti\u1ebfp t\u1ee5c v\u1edbi \u0111\u1ec9nh l\u00e1 m\u1edbi.</p> <p>\u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y, ch\u00fang ta s\u1ebd s\u1eed d\u1ee5ng m\u1ed9t bi\u1ebfn $\\text{ptr}$, bi\u1ebfn n\u00e0y s\u1ebd ch\u1ec9 ra r\u1eb1ng trong t\u1eadp h\u1ee3p c\u00e1c \u0111\u1ec9nh gi\u1eefa $0$ v\u00e0 $\\text{ptr}$ t\u1ed1i \u0111a c\u00f3 m\u1ed9t \u0111\u1ec9nh l\u00e1, c\u1ee5 th\u1ec3 l\u00e0 \u0111\u1ec9nh hi\u1ec7n t\u1ea1i. T\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh kh\u00e1c trong ph\u1ea1m vi \u0111\u00f3 ho\u1eb7c \u0111\u00e3 b\u1ecb lo\u1ea1i b\u1ecf kh\u1ecfi c\u00e2y, ho\u1eb7c v\u1eabn c\u00f3 nhi\u1ec1u h\u01a1n m\u1ed9t \u0111\u1ec9nh k\u1ec1. \u0110\u1ed3ng th\u1eddi ch\u00fang ta c\u0169ng n\u00f3i r\u1eb1ng, ch\u00fang ta ch\u01b0a lo\u1ea1i b\u1ecf b\u1ea5t k\u1ef3 \u0111\u1ec9nh l\u00e1 n\u00e0o l\u1edbn h\u01a1n $\\text{ptr}$.</p> <p>Bi\u1ebfn n\u00e0y \u0111\u00e3 r\u1ea5t h\u1eefu \u00edch trong tr\u01b0\u1eddng h\u1ee3p \u0111\u1ea7u ti\u00ean. Sau khi lo\u1ea1i b\u1ecf n\u00fat l\u00e1 hi\u1ec7n t\u1ea1i, ch\u00fang ta bi\u1ebft r\u1eb1ng kh\u00f4ng th\u1ec3 c\u00f3 m\u1ed9t n\u00fat l\u00e1 gi\u1eefa $0$ v\u00e0 $\\text{ptr}$, do \u0111\u00f3 ch\u00fang ta c\u00f3 th\u1ec3 b\u1eaft \u0111\u1ea7u t\u00ecm ki\u1ebfm n\u00fat ti\u1ebfp theo tr\u1ef1c ti\u1ebfp t\u1ea1i $\\text{ptr} + 1$, v\u00e0 ch\u00fang ta kh\u00f4ng ph\u1ea3i b\u1eaft \u0111\u1ea7u t\u00ecm ki\u1ebfm l\u1ea1i t\u1ea1i \u0111\u1ec9nh $0$. V\u00e0 trong tr\u01b0\u1eddng h\u1ee3p th\u1ee9 hai, ch\u00fang ta c\u00f3 th\u1ec3 ph\u00e2n bi\u1ec7t th\u00eam hai tr\u01b0\u1eddng h\u1ee3p: Ho\u1eb7c \u0111\u1ec9nh l\u00e1 m\u1edbi nh\u1eadn \u0111\u01b0\u1ee3c nh\u1ecf h\u01a1n $\\text{ptr}$, th\u00ec \u0111\u00e2y ph\u1ea3i l\u00e0 \u0111\u1ec9nh l\u00e1 ti\u1ebfp theo, v\u00ec ch\u00fang ta bi\u1ebft r\u1eb1ng kh\u00f4ng c\u00f3 \u0111\u1ec9nh n\u00e0o kh\u00e1c nh\u1ecf h\u01a1n $\\text{ptr}$. Ho\u1eb7c \u0111\u1ec9nh l\u00e1 m\u1edbi nh\u1eadn \u0111\u01b0\u1ee3c l\u1edbn h\u01a1n. Nh\u01b0ng sau \u0111\u00f3 ch\u00fang ta c\u0169ng bi\u1ebft r\u1eb1ng n\u00f3 ph\u1ea3i l\u1edbn h\u01a1n $\\text{ptr}$, v\u00e0 c\u00f3 th\u1ec3 b\u1eaft \u0111\u1ea7u t\u00ecm ki\u1ebfm l\u1ea1i t\u1ea1i $\\text{ptr} + 1$.</p> <p>M\u1eb7c d\u00f9 ch\u00fang ta c\u00f3 th\u1ec3 ph\u1ea3i th\u1ef1c hi\u1ec7n nhi\u1ec1u t\u00ecm ki\u1ebfm tuy\u1ebfn t\u00ednh cho \u0111\u1ec9nh l\u00e1 ti\u1ebfp theo, con tr\u1ecf $\\text{ptr}$ ch\u1ec9 t\u0103ng l\u00ean v\u00e0 do \u0111\u00f3 t\u1ed5ng \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian l\u00e0 $O(n)$.</p> <pre><code>vector&lt;vector&lt;int&gt;&gt; adj;\nvector&lt;int&gt; parent;\n\nvoid dfs(int v) {\n    for (int u : adj[v]) {\n        if (u != parent[v]) {\n            parent[u] = v;\n            dfs(u);\n        }\n    }\n}\n\nvector&lt;int&gt; pruefer_code() {\n    int n = adj.size();\n    parent.resize(n);\n    parent[n-1] = -1;\n    dfs(n-1);\n\n    int ptr = -1;\n    vector&lt;int&gt; degree(n);\n    for (int i = 0; i &lt; n; i++) {\n        degree[i] = adj[i].size();\n        if (degree[i] == 1 &amp;&amp; ptr == -1)\n            ptr = i;\n    }\n\n    vector&lt;int&gt; code(n - 2);\n    int leaf = ptr;\n    for (int i = 0; i &lt; n - 2; i++) {\n        int next = parent[leaf];\n        code[i] = next;\n        if (--degree[next] == 1 &amp;&amp; next &lt; ptr) {\n            leaf = next;\n        } else {\n            ptr++;\n            while (degree[ptr] != 1)\n                ptr++;\n            leaf = ptr;\n        }\n    }\n\n    return code;\n}\n</code></pre> <p>Trong m\u00e3, tr\u01b0\u1edbc ti\u00ean ch\u00fang ta t\u00ecm t\u1ed5 ti\u00ean <code>parent[i]</code> cho m\u1ed7i \u0111\u1ec9nh, t\u1ee9c l\u00e0 t\u1ed5 ti\u00ean m\u00e0 \u0111\u1ec9nh n\u00e0y s\u1ebd c\u00f3 khi ch\u00fang ta lo\u1ea1i b\u1ecf n\u00f3 kh\u1ecfi c\u00e2y. Ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm th\u1ea5y t\u1ed5 ti\u00ean n\u00e0y b\u1eb1ng c\u00e1ch ch\u1ecdn g\u1ed1c c\u00e2y t\u1ea1i \u0111\u1ec9nh $n-1$. \u0110i\u1ec1u n\u00e0y l\u00e0 c\u00f3 th\u1ec3 v\u00ec \u0111\u1ec9nh $n-1$ s\u1ebd kh\u00f4ng bao gi\u1edd b\u1ecb x\u00f3a kh\u1ecfi c\u00e2y. Ch\u00fang ta c\u0169ng t\u00ednh to\u00e1n b\u1eadc cho m\u1ed7i \u0111\u1ec9nh. <code>ptr</code> l\u00e0 con tr\u1ecf ch\u1ec9 ra k\u00edch th\u01b0\u1edbc t\u1ed1i thi\u1ec3u c\u1ee7a c\u00e1c \u0111\u1ec9nh l\u00e1 c\u00f2n l\u1ea1i (ngo\u1ea1i tr\u1eeb \u0111\u1ec9nh hi\u1ec7n t\u1ea1i <code>leaf</code>). Ch\u00fang ta s\u1ebd g\u00e1n \u0111\u1ec9nh l\u00e1 hi\u1ec7n t\u1ea1i b\u1eb1ng <code>next</code>, n\u1ebfu \u0111\u1ec9nh n\u00e0y c\u0169ng l\u00e0 \u0111\u1ec9nh l\u00e1 v\u00e0 n\u00f3 nh\u1ecf h\u01a1n <code>ptr</code>, ho\u1eb7c ch\u00fang ta b\u1eaft \u0111\u1ea7u t\u00ecm ki\u1ebfm tuy\u1ebfn t\u00ednh cho \u0111\u1ec9nh l\u00e1 nh\u1ecf nh\u1ea5t b\u1eb1ng c\u00e1ch t\u0103ng con tr\u1ecf.</p> <p>C\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng th\u1ea5y r\u1eb1ng, m\u00e3 n\u00e0y c\u00f3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p $O(n)$.</p>","tags":["Translated"]},{"location":"graph/pruefer_code.html#some-properties-of-the-pruefer-code","title":"M\u1ed9t s\u1ed1 t\u00ednh ch\u1ea5t c\u1ee7a m\u00e3 Pr\u00fcfer (Some properties of the Pr\u00fcfer code)","text":"<ul> <li>Sau khi x\u00e2y d\u1ef1ng m\u00e3 Pr\u00fcfer, hai \u0111\u1ec9nh s\u1ebd c\u00f2n l\u1ea1i.   M\u1ed9t trong s\u1ed1 ch\u00fang l\u00e0 \u0111\u1ec9nh cao nh\u1ea5t $n-1$, nh\u01b0ng kh\u00f4ng th\u1ec3 n\u00f3i g\u00ec kh\u00e1c v\u1ec1 \u0111\u1ec9nh c\u00f2n l\u1ea1i.</li> <li>M\u1ed7i \u0111\u1ec9nh xu\u1ea5t hi\u1ec7n trong m\u00e3 Pr\u00fcfer ch\u00ednh x\u00e1c m\u1ed9t s\u1ed1 l\u1ea7n c\u1ed1 \u0111\u1ecbnh - b\u1eadc c\u1ee7a n\u00f3 tr\u1eeb \u0111i m\u1ed9t.   \u0110i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c ki\u1ec3m tra d\u1ec5 d\u00e0ng, v\u00ec b\u1eadc s\u1ebd nh\u1ecf h\u01a1n m\u1ed7i l\u1ea7n ch\u00fang ta ghi l\u1ea1i nh\u00e3n c\u1ee7a n\u00f3 trong m\u00e3, v\u00e0 ch\u00fang ta lo\u1ea1i b\u1ecf n\u00f3 khi b\u1eadc l\u00e0 $1$.   \u0110\u1ed1i v\u1edbi hai \u0111\u1ec9nh c\u00f2n l\u1ea1i, th\u1ef1c t\u1ebf n\u00e0y c\u0169ng \u0111\u00fang.</li> </ul>","tags":["Translated"]},{"location":"graph/pruefer_code.html#restoring-the-tree-using-the-pruefer-code","title":"Kh\u00f4i ph\u1ee5c c\u00e2y b\u1eb1ng m\u00e3 Pr\u00fcfer (Restoring the tree using the Pr\u00fcfer code)","text":"<p>\u0110\u1ec3 kh\u00f4i ph\u1ee5c c\u00e2y, ch\u1ec9 c\u1ea7n t\u1eadp trung v\u00e0o thu\u1ed9c t\u00ednh \u0111\u01b0\u1ee3c th\u1ea3o lu\u1eadn trong ph\u1ea7n tr\u01b0\u1edbc. Ch\u00fang ta \u0111\u00e3 bi\u1ebft b\u1eadc c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh trong c\u00e2y mong mu\u1ed1n. Do \u0111\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm th\u1ea5y t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh l\u00e1, v\u00e0 c\u1ea3 l\u00e1 \u0111\u1ea7u ti\u00ean b\u1ecb lo\u1ea1i b\u1ecf trong b\u01b0\u1edbc \u0111\u1ea7u ti\u00ean (n\u00f3 ph\u1ea3i l\u00e0 l\u00e1 nh\u1ecf nh\u1ea5t). \u0110\u1ec9nh l\u00e1 n\u00e0y \u0111\u01b0\u1ee3c k\u1ebft n\u1ed1i v\u1edbi \u0111\u1ec9nh t\u01b0\u01a1ng \u1ee9ng v\u1edbi s\u1ed1 trong \u00f4 \u0111\u1ea7u ti\u00ean c\u1ee7a m\u00e3 Pr\u00fcfer.</p> <p>Do \u0111\u00f3, ch\u00fang ta \u0111\u00e3 t\u00ecm th\u1ea5y c\u1ea1nh \u0111\u1ea7u ti\u00ean b\u1ecb lo\u1ea1i b\u1ecf b\u1edfi khi \u0111\u00f3 m\u00e3 Pr\u00fcfer \u0111\u01b0\u1ee3c t\u1ea1o ra. Ch\u00fang ta c\u00f3 th\u1ec3 th\u00eam c\u1ea1nh n\u00e0y v\u00e0o c\u00e2u tr\u1ea3 l\u1eddi v\u00e0 gi\u1ea3m b\u1eadc \u1edf c\u1ea3 hai \u0111\u1ea7u c\u1ee7a c\u1ea1nh.</p> <p>Ch\u00fang ta s\u1ebd l\u1eb7p l\u1ea1i thao t\u00e1c n\u00e0y cho \u0111\u1ebfn khi ch\u00fang ta s\u1eed d\u1ee5ng h\u1ebft t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 c\u1ee7a m\u00e3 Pr\u00fcfer: ch\u00fang ta t\u00ecm \u0111\u1ec9nh nh\u1ecf nh\u1ea5t c\u00f3 b\u1eadc b\u1eb1ng $1$, k\u1ebft n\u1ed1i n\u00f3 v\u1edbi \u0111\u1ec9nh ti\u1ebfp theo t\u1eeb m\u00e3 Pr\u00fcfer, v\u00e0 gi\u1ea3m b\u1eadc.</p> <p>Cu\u1ed1i c\u00f9ng ch\u00fang ta ch\u1ec9 c\u00f2n l\u1ea1i hai \u0111\u1ec9nh c\u00f3 b\u1eadc b\u1eb1ng $1$. \u0110\u00e2y l\u00e0 nh\u1eefng \u0111\u1ec9nh kh\u00f4ng b\u1ecb lo\u1ea1i b\u1ecf b\u1edfi quy tr\u00ecnh m\u00e3 Pr\u00fcfer. Ch\u00fang ta k\u1ebft n\u1ed1i ch\u00fang \u0111\u1ec3 c\u00f3 \u0111\u01b0\u1ee3c c\u1ea1nh cu\u1ed1i c\u00f9ng c\u1ee7a c\u00e2y. M\u1ed9t trong s\u1ed1 ch\u00fang s\u1ebd lu\u00f4n l\u00e0 \u0111\u1ec9nh $n-1$.</p> <p>Thu\u1eadt to\u00e1n n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c c\u00e0i \u0111\u1eb7t d\u1ec5 d\u00e0ng trong $O(n \\log n)$: ch\u00fang ta s\u1eed d\u1ee5ng c\u1ea5u tr\u00fac d\u1eef li\u1ec7u h\u1ed7 tr\u1ee3 tr\u00edch xu\u1ea5t gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t (v\u00ed d\u1ee5: <code>set&lt;&gt;</code> ho\u1eb7c <code>priority_queue&lt;&gt;</code> trong C++) \u0111\u1ec3 l\u01b0u tr\u1eef t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh l\u00e1.</p> <p>C\u00e0i \u0111\u1eb7t sau \u0111\u00e2y tr\u1ea3 v\u1ec1 danh s\u00e1ch c\u00e1c c\u1ea1nh t\u01b0\u01a1ng \u1ee9ng v\u1edbi c\u00e2y.</p> <pre><code>vector&lt;pair&lt;int, int&gt;&gt; pruefer_decode(vector&lt;int&gt; const&amp; code) {\n    int n = code.size() + 2;\n    vector&lt;int&gt; degree(n, 1);\n    for (int i : code)\n        degree[i]++;\n\n    set&lt;int&gt; leaves;\n    for (int i = 0; i &lt; n; i++) {\n        if (degree[i] == 1)\n            leaves.insert(i);\n    }\n\n    vector&lt;pair&lt;int, int&gt;&gt; edges;\n    for (int v : code) {\n        int leaf = *leaves.begin();\n        leaves.erase(leaves.begin());\n\n        edges.emplace_back(leaf, v);\n        if (--degree[v] == 1)\n            leaves.insert(v);\n    }\n    edges.emplace_back(*leaves.begin(), n-1);\n    return edges;\n}\n</code></pre>","tags":["Translated"]},{"location":"graph/pruefer_code.html#restoring-the-tree-using-the-pruefer-code-in-linear-time","title":"Kh\u00f4i ph\u1ee5c c\u00e2y b\u1eb1ng m\u00e3 Pr\u00fcfer trong th\u1eddi gian tuy\u1ebfn t\u00ednh (Restoring the tree using the Pr\u00fcfer code in linear time)","text":"<p>\u0110\u1ec3 c\u00f3 \u0111\u01b0\u1ee3c c\u00e2y trong th\u1eddi gian tuy\u1ebfn t\u00ednh, ch\u00fang ta c\u00f3 th\u1ec3 \u00e1p d\u1ee5ng k\u1ef9 thu\u1eadt t\u01b0\u01a1ng t\u1ef1 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 l\u1ea5y m\u00e3 Pr\u00fcfer trong th\u1eddi gian tuy\u1ebfn t\u00ednh.</p> <p>Ch\u00fang ta kh\u00f4ng c\u1ea7n c\u1ea5u tr\u00fac d\u1eef li\u1ec7u \u0111\u1ec3 tr\u00edch xu\u1ea5t gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t. Thay v\u00e0o \u0111\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 nh\u1eadn th\u1ea5y r\u1eb1ng, sau khi x\u1eed l\u00fd c\u1ea1nh hi\u1ec7n t\u1ea1i, ch\u1ec9 c\u00f3 m\u1ed9t \u0111\u1ec9nh tr\u1edf th\u00e0nh l\u00e1. Do \u0111\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 ti\u1ebfp t\u1ee5c v\u1edbi \u0111\u1ec9nh n\u00e0y, ho\u1eb7c ch\u00fang ta t\u00ecm m\u1ed9t \u0111\u1ec9nh nh\u1ecf h\u01a1n b\u1eb1ng t\u00ecm ki\u1ebfm tuy\u1ebfn t\u00ednh b\u1eb1ng c\u00e1ch di chuy\u1ec3n m\u1ed9t con tr\u1ecf.</p> <pre><code>vector&lt;pair&lt;int, int&gt;&gt; pruefer_decode(vector&lt;int&gt; const&amp; code) {\n    int n = code.size() + 2;\n    vector&lt;int&gt; degree(n, 1);\n    for (int i : code)\n        degree[i]++;\n\n    int ptr = 0;\n    while (degree[ptr] != 1)\n        ptr++;\n    int leaf = ptr;\n\n    vector&lt;pair&lt;int, int&gt;&gt; edges;\n    for (int v : code) {\n        edges.emplace_back(leaf, v);\n        if (--degree[v] == 1 &amp;&amp; v &lt; ptr) {\n            leaf = v;\n        } else {\n            ptr++;\n            while (degree[ptr] != 1)\n                ptr++;\n            leaf = ptr;\n        }\n    }\n    edges.emplace_back(leaf, n-1);\n    return edges;\n}\n</code></pre>","tags":["Translated"]},{"location":"graph/pruefer_code.html#bijection-between-trees-and-pruefer-codes","title":"Song \u00e1nh gi\u1eefa c\u00e2y v\u00e0 m\u00e3 Pr\u00fcfer (Bijection between trees and Pr\u00fcfer codes)","text":"<p>\u0110\u1ed1i v\u1edbi m\u1ed7i c\u00e2y, t\u1ed3n t\u1ea1i m\u1ed9t m\u00e3 Pr\u00fcfer t\u01b0\u01a1ng \u1ee9ng v\u1edbi n\u00f3. V\u00e0 \u0111\u1ed1i v\u1edbi m\u1ed7i m\u00e3 Pr\u00fcfer, ch\u00fang ta c\u00f3 th\u1ec3 kh\u00f4i ph\u1ee5c c\u00e2y ban \u0111\u1ea7u.</p> <p>\u0110i\u1ec1u \u0111\u00f3 \u0111i theo vi\u1ec7c m\u1ed7i m\u00e3 Pr\u00fcfer (t\u1ee9c l\u00e0 m\u1ed9t d\u00e3y g\u1ed3m $n-2$ s\u1ed1 trong kho\u1ea3ng $[0; n - 1]$) c\u0169ng t\u01b0\u01a1ng \u1ee9ng v\u1edbi m\u1ed9t c\u00e2y.</p> <p>Do \u0111\u00f3 t\u1ea5t c\u1ea3 c\u00e1c c\u00e2y v\u00e0 t\u1ea5t c\u1ea3 c\u00e1c m\u00e3 Pr\u00fcfer t\u1ea1o th\u00e0nh m\u1ed9t song \u00e1nh (m\u1ed9t s\u1ef1 t\u01b0\u01a1ng \u1ee9ng 1-1).</p>","tags":["Translated"]},{"location":"graph/pruefer_code.html#cayleys-formula","title":"C\u00f4ng th\u1ee9c Cayley (Cayley's formula)","text":"<p>C\u00f4ng th\u1ee9c Cayley n\u00f3i r\u1eb1ng s\u1ed1 l\u01b0\u1ee3ng c\u00e2y khung trong m\u1ed9t \u0111\u1ed3 th\u1ecb \u0111\u1ea7y \u0111\u1ee7 c\u00f3 nh\u00e3n v\u1edbi $n$ \u0111\u1ec9nh b\u1eb1ng:</p> $$n^{n-2}$$ <p>C\u00f3 nhi\u1ec1u ch\u1ee9ng minh cho c\u00f4ng th\u1ee9c n\u00e0y. S\u1eed d\u1ee5ng kh\u00e1i ni\u1ec7m m\u00e3 Pr\u00fcfer, ph\u00e1t bi\u1ec3u n\u00e0y \u0111\u1ebfn m\u00e0 kh\u00f4ng c\u00f3 b\u1ea5t k\u1ef3 s\u1ef1 ng\u1ea1c nhi\u00ean n\u00e0o.</p> <p>Tr\u00ean th\u1ef1c t\u1ebf, b\u1ea5t k\u1ef3 m\u00e3 Pr\u00fcfer n\u00e0o v\u1edbi $n-2$ s\u1ed1 t\u1eeb kho\u1ea3ng $[0; n-1]$ t\u01b0\u01a1ng \u1ee9ng v\u1edbi m\u1ed9t c\u00e2y n\u00e0o \u0111\u00f3 v\u1edbi $n$ \u0111\u1ec9nh. V\u00ec v\u1eady, ch\u00fang ta c\u00f3 $n^{n-2}$ m\u00e3 Pr\u00fcfer kh\u00e1c nhau nh\u01b0 v\u1eady. V\u00ec m\u1ed7i c\u00e2y nh\u01b0 v\u1eady l\u00e0 m\u1ed9t c\u00e2y khung c\u1ee7a m\u1ed9t \u0111\u1ed3 th\u1ecb \u0111\u1ea7y \u0111\u1ee7 v\u1edbi $n$ \u0111\u1ec9nh, s\u1ed1 l\u01b0\u1ee3ng c\u00e2y khung nh\u01b0 v\u1eady c\u0169ng l\u00e0 $n^{n-2}$.</p>","tags":["Translated"]},{"location":"graph/pruefer_code.html#number-of-ways-to-make-a-graph-connected","title":"S\u1ed1 c\u00e1ch \u0111\u1ec3 l\u00e0m cho \u0111\u1ed3 th\u1ecb li\u00ean th\u00f4ng (Number of ways to make a graph connected)","text":"<p>Kh\u00e1i ni\u1ec7m v\u1ec1 m\u00e3 Pr\u00fcfer th\u1eadm ch\u00ed c\u00f2n m\u1ea1nh m\u1ebd h\u01a1n. N\u00f3 cho ph\u00e9p t\u1ea1o ra nhi\u1ec1u c\u00f4ng th\u1ee9c t\u1ed5ng qu\u00e1t h\u01a1n so v\u1edbi c\u00f4ng th\u1ee9c Cayley.</p> <p>Trong b\u00e0i to\u00e1n n\u00e0y, ch\u00fang ta \u0111\u01b0\u1ee3c cho m\u1ed9t \u0111\u1ed3 th\u1ecb v\u1edbi $n$ \u0111\u1ec9nh v\u00e0 $m$ c\u1ea1nh. \u0110\u1ed3 th\u1ecb hi\u1ec7n c\u00f3 $k$ th\u00e0nh ph\u1ea7n. Ch\u00fang ta mu\u1ed1n t\u00ednh s\u1ed1 c\u00e1ch th\u00eam $k-1$ c\u1ea1nh sao cho \u0111\u1ed3 th\u1ecb tr\u1edf n\u00ean li\u00ean th\u00f4ng (r\u00f5 r\u00e0ng $k-1$ l\u00e0 s\u1ed1 l\u01b0\u1ee3ng t\u1ed1i thi\u1ec3u c\u1ea7n thi\u1ebft \u0111\u1ec3 l\u00e0m cho \u0111\u1ed3 th\u1ecb li\u00ean th\u00f4ng).</p> <p>H\u00e3y \u0111\u1ec3 ch\u00fang t\u00f4i t\u00ecm ra m\u1ed9t c\u00f4ng th\u1ee9c \u0111\u1ec3 gi\u1ea3i quy\u1ebft b\u00e0i to\u00e1n n\u00e0y.</p> <p>Ch\u00fang ta s\u1eed d\u1ee5ng $s_1, \\dots, s_k$ cho k\u00edch th\u01b0\u1edbc c\u1ee7a c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng trong \u0111\u1ed3 th\u1ecb. Ch\u00fang ta kh\u00f4ng th\u1ec3 th\u00eam c\u00e1c c\u1ea1nh trong m\u1ed9t th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng. Do \u0111\u00f3, h\u00f3a ra b\u00e0i to\u00e1n n\u00e0y r\u1ea5t gi\u1ed1ng v\u1edbi vi\u1ec7c t\u00ecm ki\u1ebfm s\u1ed1 l\u01b0\u1ee3ng c\u00e2y khung c\u1ee7a m\u1ed9t \u0111\u1ed3 th\u1ecb \u0111\u1ea7y \u0111\u1ee7 v\u1edbi $k$ \u0111\u1ec9nh. S\u1ef1 kh\u00e1c bi\u1ec7t duy nh\u1ea5t l\u00e0 m\u1ed7i \u0111\u1ec9nh th\u1ef1c s\u1ef1 c\u00f3 k\u00edch th\u01b0\u1edbc $s_i$: m\u1ed7i c\u1ea1nh k\u1ebft n\u1ed1i \u0111\u1ec9nh $i$, th\u1ef1c s\u1ef1 nh\u00e2n c\u00e2u tr\u1ea3 l\u1eddi v\u1edbi $s_i$.</p> <p>Do \u0111\u00f3, \u0111\u1ec3 t\u00ednh s\u1ed1 c\u00e1ch c\u00f3 th\u1ec3, \u0111i\u1ec1u quan tr\u1ecdng l\u00e0 ph\u1ea3i \u0111\u1ebfm t\u1ea7n su\u1ea5t m\u1ed7i \u0111\u1ec9nh trong s\u1ed1 $k$ \u0111\u1ec9nh \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng trong c\u00e2y k\u1ebft n\u1ed1i. \u0110\u1ec3 c\u00f3 \u0111\u01b0\u1ee3c m\u1ed9t c\u00f4ng th\u1ee9c cho b\u00e0i to\u00e1n, c\u1ea7n ph\u1ea3i t\u00ednh t\u1ed5ng c\u00e2u tr\u1ea3 l\u1eddi tr\u00ean t\u1ea5t c\u1ea3 c\u00e1c b\u1eadc c\u00f3 th\u1ec3.</p> <p>G\u1ecdi $d_1, \\dots, d_k$ l\u00e0 b\u1eadc c\u1ee7a c\u00e1c \u0111\u1ec9nh trong c\u00e2y sau khi k\u1ebft n\u1ed1i c\u00e1c \u0111\u1ec9nh. T\u1ed5ng c\u1ee7a c\u00e1c b\u1eadc g\u1ea5p \u0111\u00f4i s\u1ed1 c\u1ea1nh:</p> $$\\sum_{i=1}^k d_i = 2k - 2$$ <p>N\u1ebfu \u0111\u1ec9nh $i$ c\u00f3 b\u1eadc $d_i$, th\u00ec n\u00f3 xu\u1ea5t hi\u1ec7n $d_i - 1$ l\u1ea7n trong m\u00e3 Pr\u00fcfer. M\u00e3 Pr\u00fcfer cho m\u1ed9t c\u00e2y c\u00f3 $k$ \u0111\u1ec9nh c\u00f3 \u0111\u1ed9 d\u00e0i $k-2$. V\u00ec v\u1eady, s\u1ed1 c\u00e1ch ch\u1ecdn m\u1ed9t m\u00e3 c\u00f3 $k-2$ s\u1ed1 trong \u0111\u00f3 s\u1ed1 $i$ xu\u1ea5t hi\u1ec7n ch\u00ednh x\u00e1c $d_i - 1$ l\u1ea7n b\u1eb1ng v\u1edbi h\u1ec7 s\u1ed1 \u0111a th\u1ee9c</p> $$\\binom{k-2}{d_1-1, d_2-1, \\dots, d_k-1} = \\frac{(k-2)!}{(d_1-1)! (d_2-1)! \\cdots (d_k-1)!}.$$ <p>Th\u1ef1c t\u1ebf l\u00e0 m\u1ed7i c\u1ea1nh k\u1ec1 v\u1edbi \u0111\u1ec9nh $i$ nh\u00e2n c\u00e2u tr\u1ea3 l\u1eddi v\u1edbi $s_i$, ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c c\u00e2u tr\u1ea3 l\u1eddi, gi\u1ea3 s\u1eed r\u1eb1ng b\u1eadc c\u1ee7a c\u00e1c \u0111\u1ec9nh l\u00e0 $d_1, \\dots, d_k$:</p> $$s_1^{d_1} \\cdot s_2^{d_2} \\cdots s_k^{d_k} \\cdot \\binom{k-2}{d_1-1, d_2-1, \\dots, d_k-1}$$ <p>\u0110\u1ec3 c\u00f3 \u0111\u01b0\u1ee3c c\u00e2u tr\u1ea3 l\u1eddi cu\u1ed1i c\u00f9ng, ch\u00fang ta c\u1ea7n t\u00ednh t\u1ed5ng s\u1ed1 n\u00e0y cho t\u1ea5t c\u1ea3 c\u00e1c c\u00e1ch ch\u1ecdn b\u1eadc c\u00f3 th\u1ec3:</p> $$\\sum_{\\substack{d_i \\ge 1 \\\\\\\\ \\sum_{i=1}^k d_i = 2k -2}} s_1^{d_1} \\cdot s_2^{d_2} \\cdots s_k^{d_k} \\cdot \\binom{k-2}{d_1-1, d_2-1, \\dots, d_k-1}$$ <p>Hi\u1ec7n t\u1ea1i \u0111i\u1ec1u n\u00e0y tr\u00f4ng gi\u1ed1ng nh\u01b0 m\u1ed9t c\u00e2u tr\u1ea3 l\u1eddi th\u1ef1c s\u1ef1 kinh kh\u1ee7ng, tuy nhi\u00ean ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng \u0111\u1ecbnh l\u00fd \u0111a th\u1ee9c, trong \u0111\u00f3 n\u00f3i r\u1eb1ng:</p> $$(x_1 + \\dots + x_m)^p = \\sum_{\\substack{c_i \\ge 0 \\\\\\\\ \\sum_{i=1}^m c_i = p}} x_1^{c_1} \\cdot x_2^{c_2} \\cdots x_m^{c_m} \\cdot \\binom{p}{c_1, c_2, \\dots c_m}$$ <p>\u0110i\u1ec1u n\u00e0y tr\u00f4ng kh\u00e1 gi\u1ed1ng nhau. \u0110\u1ec3 s\u1eed d\u1ee5ng n\u00f3, ch\u00fang ta ch\u1ec9 c\u1ea7n thay th\u1ebf v\u1edbi $e_i = d_i - 1$:</p> $$\\sum_{\\substack{e_i \\ge 0 \\\\\\\\ \\sum_{i=1}^k e_i = k - 2}} s_1^{e_1+1} \\cdot s_2^{e_2+1} \\cdots s_k^{e_k+1} \\cdot \\binom{k-2}{e_1, e_2, \\dots, e_k}$$ <p>Sau khi \u00e1p d\u1ee5ng \u0111\u1ecbnh l\u00fd \u0111a th\u1ee9c, ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c c\u00e2u tr\u1ea3 l\u1eddi cho b\u00e0i to\u00e1n:</p> $$s_1 \\cdot s_2 \\cdots s_k \\cdot (s_1 + s_2 + \\dots + s_k)^{k-2} = s_1 \\cdot s_2 \\cdots s_k \\cdot n^{k-2}$$ <p>Th\u1eadt t\u00ecnh c\u1edd, c\u00f4ng th\u1ee9c n\u00e0y c\u0169ng \u0111\u00fang v\u1edbi $k = 1$.</p>","tags":["Translated"]},{"location":"graph/pruefer_code.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice problems)","text":"<ul> <li>UVA #10843 - Anne's game</li> <li>Timus #1069 - Prufer Code</li> <li>Codeforces - Clues</li> <li>Topcoder - TheCitiesAndRoadsDivTwo</li> </ul>","tags":["Translated"]},{"location":"graph/push-relabel-faster.html","title":"Lu\u1ed3ng c\u1ef1c \u0111\u1ea1i - Ph\u01b0\u01a1ng ph\u00e1p Push-relabel c\u1ea3i ti\u1ebfn (Maximum flow - Push-relabel method improved)","text":"<p>Ch\u00fang ta s\u1ebd s\u1eeda \u0111\u1ed5i ph\u01b0\u01a1ng ph\u00e1p push-relabel \u0111\u1ec3 \u0111\u1ea1t \u0111\u01b0\u1ee3c th\u1eddi gian ch\u1ea1y t\u1ed1t h\u01a1n.</p>","tags":["Translated"]},{"location":"graph/push-relabel-faster.html#description","title":"M\u00f4 t\u1ea3 (Description)","text":"<p>S\u1eeda \u0111\u1ed5i c\u1ef1c k\u1ef3 \u0111\u01a1n gi\u1ea3n: Trong b\u00e0i vi\u1ebft tr\u01b0\u1edbc ch\u00fang ta \u0111\u00e3 ch\u1ecdn m\u1ed9t \u0111\u1ec9nh c\u00f3 d\u01b0 th\u1eeba m\u00e0 kh\u00f4ng c\u00f3 b\u1ea5t k\u1ef3 quy t\u1eafc c\u1ee5 th\u1ec3 n\u00e0o. Nh\u01b0ng h\u00f3a ra, n\u1ebfu ch\u00fang ta lu\u00f4n ch\u1ecdn c\u00e1c \u0111\u1ec9nh c\u00f3 \u0111\u1ed9 cao l\u1edbn nh\u1ea5t, v\u00e0 \u00e1p d\u1ee5ng c\u00e1c thao t\u00e1c push v\u00e0 relabel tr\u00ean ch\u00fang, th\u00ec \u0111\u1ed9 ph\u1ee9c t\u1ea1p s\u1ebd tr\u1edf n\u00ean t\u1ed1t h\u01a1n. H\u01a1n n\u1eefa, \u0111\u1ec3 ch\u1ecdn c\u00e1c \u0111\u1ec9nh c\u00f3 \u0111\u1ed9 cao l\u1edbn nh\u1ea5t, ch\u00fang ta th\u1ef1c s\u1ef1 kh\u00f4ng c\u1ea7n b\u1ea5t k\u1ef3 c\u1ea5u tr\u00fac d\u1eef li\u1ec7u n\u00e0o, ch\u00fang ta ch\u1ec9 c\u1ea7n l\u01b0u tr\u1eef c\u00e1c \u0111\u1ec9nh c\u00f3 \u0111\u1ed9 cao l\u1edbn nh\u1ea5t trong m\u1ed9t danh s\u00e1ch, v\u00e0 t\u00ednh to\u00e1n l\u1ea1i danh s\u00e1ch sau khi t\u1ea5t c\u1ea3 ch\u00fang \u0111\u00e3 \u0111\u01b0\u1ee3c x\u1eed l\u00fd (sau \u0111\u00f3 c\u00e1c \u0111\u1ec9nh c\u00f3 \u0111\u1ed9 cao th\u1ea5p h\u01a1n s\u1ebd \u0111\u01b0\u1ee3c th\u00eam v\u00e0o danh s\u00e1ch), ho\u1eb7c b\u1ea5t c\u1ee9 khi n\u00e0o xu\u1ea5t hi\u1ec7n m\u1ed9t \u0111\u1ec9nh m\u1edbi c\u00f3 d\u01b0 th\u1eeba v\u00e0 \u0111\u1ed9 cao l\u1edbn h\u01a1n (sau khi g\u00e1n l\u1ea1i nh\u00e3n cho m\u1ed9t \u0111\u1ec9nh).</p> <p>B\u1ea5t ch\u1ea5p s\u1ef1 \u0111\u01a1n gi\u1ea3n, s\u1eeda \u0111\u1ed5i n\u00e0y l\u00e0m gi\u1ea3m \u0111\u1ed9 ph\u1ee9c t\u1ea1p \u0111i r\u1ea5t nhi\u1ec1u. Ch\u00ednh x\u00e1c h\u01a1n, \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a thu\u1eadt to\u00e1n thu \u0111\u01b0\u1ee3c l\u00e0 $O(V E + V^2 \\sqrt{E})$, trong tr\u01b0\u1eddng h\u1ee3p x\u1ea5u nh\u1ea5t l\u00e0 $O(V^3)$.</p> <p>S\u1eeda \u0111\u1ed5i n\u00e0y \u0111\u01b0\u1ee3c \u0111\u1ec1 xu\u1ea5t b\u1edfi Cheriyan v\u00e0 Maheshwari v\u00e0o n\u0103m 1989.</p>","tags":["Translated"]},{"location":"graph/push-relabel-faster.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<pre><code>const int inf = 1000000000;\n\nint n;\nvector&lt;vector&lt;int&gt;&gt; capacity, flow;\nvector&lt;int&gt; height, excess;\n\nvoid push(int u, int v)\n{\n    int d = min(excess[u], capacity[u][v] - flow[u][v]);\n    flow[u][v] += d;\n    flow[v][u] -= d;\n    excess[u] -= d;\n    excess[v] += d;\n}\n\nvoid relabel(int u)\n{\n    int d = inf;\n    for (int i = 0; i &lt; n; i++) {\n        if (capacity[u][i] - flow[u][i] &gt; 0)\n            d = min(d, height[i]);\n    }\n    if (d &lt; inf)\n        height[u] = d + 1;\n}\n\nvector&lt;int&gt; find_max_height_vertices(int s, int t) {\n    vector&lt;int&gt; max_height;\n    for (int i = 0; i &lt; n; i++) {\n        if (i != s &amp;&amp; i != t &amp;&amp; excess[i] &gt; 0) {\n            if (!max_height.empty() &amp;&amp; height[i] &gt; height[max_height[0]])\n                max_height.clear();\n            if (max_height.empty() || height[i] == height[max_height[0]])\n                max_height.push_back(i);\n        }\n    }\n    return max_height;\n}\n\nint max_flow(int s, int t)\n{\n    height.assign(n, 0);\n    height[s] = n;\n    flow.assign(n, vector&lt;int&gt;(n, 0));\n    excess.assign(n, 0);\n    excess[s] = inf;\n    for (int i = 0; i &lt; n; i++) {\n        if (i != s)\n            push(s, i);\n    }\n\n    vector&lt;int&gt; current;\n    while (!(current = find_max_height_vertices(s, t)).empty()) {\n        for (int i : current) {\n            bool pushed = false;\n            for (int j = 0; j &lt; n &amp;&amp; excess[i]; j++) {\n                if (capacity[i][j] - flow[i][j] &gt; 0 &amp;&amp; height[i] == height[j] + 1) {\n                    push(i, j);\n                    pushed = true;\n                }\n            }\n            if (!pushed) {\n                relabel(i);\n                break;\n            }\n        }\n    }\n\n    return excess[t];\n}\n</code></pre>","tags":["Translated"]},{"location":"graph/push-relabel.html","title":"Lu\u1ed3ng c\u1ef1c \u0111\u1ea1i - Thu\u1eadt to\u00e1n Push-relabel (Maximum flow - Push-relabel algorithm)","text":"<p>Thu\u1eadt to\u00e1n Push-relabel (hay c\u00f2n \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 thu\u1eadt to\u00e1n Preflow-push) l\u00e0 m\u1ed9t thu\u1eadt to\u00e1n \u0111\u1ec3 t\u00ednh to\u00e1n lu\u1ed3ng c\u1ef1c \u0111\u1ea1i c\u1ee7a m\u1ed9t m\u1ea1ng lu\u1ed3ng. \u0110\u1ecbnh ngh\u0129a ch\u00ednh x\u00e1c c\u1ee7a b\u00e0i to\u00e1n m\u00e0 ch\u00fang ta mu\u1ed1n gi\u1ea3i quy\u1ebft c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y trong b\u00e0i vi\u1ebft Lu\u1ed3ng c\u1ef1c \u0111\u1ea1i - Ford-Fulkerson v\u00e0 Edmonds-Karp.</p> <p>Trong b\u00e0i vi\u1ebft n\u00e0y, ch\u00fang ta s\u1ebd xem x\u00e9t gi\u1ea3i quy\u1ebft b\u00e0i to\u00e1n b\u1eb1ng c\u00e1ch \u0111\u1ea9y m\u1ed9t lu\u1ed3ng ti\u1ec1n (preflow) qua m\u1ea1ng, thu\u1eadt to\u00e1n s\u1ebd ch\u1ea1y trong th\u1eddi gian $O(V^4)$, ho\u1eb7c ch\u00ednh x\u00e1c h\u01a1n l\u00e0 trong $O(V^2 E)$. Thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c thi\u1ebft k\u1ebf b\u1edfi Andrew Goldberg v\u00e0 Robert Tarjan v\u00e0o n\u0103m 1985.</p>","tags":["Translated"]},{"location":"graph/push-relabel.html#definitions","title":"\u0110\u1ecbnh ngh\u0129a (Definitions)","text":"<p>Trong qu\u00e1 tr\u00ecnh thu\u1eadt to\u00e1n, ch\u00fang ta s\u1ebd ph\u1ea3i x\u1eed l\u00fd m\u1ed9t lu\u1ed3ng ti\u1ec1n (preflow) - t\u1ee9c l\u00e0 m\u1ed9t h\u00e0m $f$ t\u01b0\u01a1ng t\u1ef1 nh\u01b0 h\u00e0m lu\u1ed3ng, nh\u01b0ng kh\u00f4ng nh\u1ea5t thi\u1ebft ph\u1ea3i th\u1ecfa m\u00e3n r\u00e0ng bu\u1ed9c b\u1ea3o to\u00e0n lu\u1ed3ng. \u0110\u1ed1i v\u1edbi n\u00f3 ch\u1ec9 c\u1ea7n c\u00e1c r\u00e0ng bu\u1ed9c sau:</p> $$0 \\le f(e) \\le c(e)$$ <p>v\u00e0</p> $$\\sum_{(v, u) \\in E} f((v, u)) \\ge \\sum_{(u, v) \\in E} f((u, v))$$ <p>ph\u1ea3i \u0111\u01b0\u1ee3c th\u1ecfa m\u00e3n.</p> <p>V\u00ec v\u1eady, m\u1ed9t s\u1ed1 \u0111\u1ec9nh c\u00f3 th\u1ec3 nh\u1eadn nhi\u1ec1u lu\u1ed3ng h\u01a1n n\u00f3 ph\u00e2n ph\u1ed1i. Ch\u00fang ta n\u00f3i r\u1eb1ng \u0111\u1ec9nh n\u00e0y c\u00f3 m\u1ed9t l\u01b0\u1ee3ng lu\u1ed3ng d\u01b0 th\u1eeba n\u00e0o \u0111\u00f3, v\u00e0 \u0111\u1ecbnh ngh\u0129a l\u01b0\u1ee3ng d\u01b0 th\u1eeba \u0111\u00f3 b\u1eb1ng h\u00e0m d\u01b0 th\u1eeba (excess) $x(u) =\\sum_{(v, u) \\in E} f((v, u)) - \\sum_{(u, v) \\in E} f((u, v))$.</p> <p>Theo c\u00e1ch t\u01b0\u01a1ng t\u1ef1 nh\u01b0 v\u1edbi h\u00e0m lu\u1ed3ng, ch\u00fang ta c\u00f3 th\u1ec3 \u0111\u1ecbnh ngh\u0129a c\u00e1c dung l\u01b0\u1ee3ng d\u01b0 v\u00e0 \u0111\u1ed3 th\u1ecb d\u01b0 v\u1edbi h\u00e0m lu\u1ed3ng ti\u1ec1n.</p> <p>Thu\u1eadt to\u00e1n s\u1ebd b\u1eaft \u0111\u1ea7u v\u1edbi m\u1ed9t lu\u1ed3ng ti\u1ec1n ban \u0111\u1ea7u (m\u1ed9t s\u1ed1 \u0111\u1ec9nh c\u00f3 d\u01b0 th\u1eeba), v\u00e0 trong qu\u00e1 tr\u00ecnh th\u1ef1c thi, lu\u1ed3ng ti\u1ec1n s\u1ebd \u0111\u01b0\u1ee3c x\u1eed l\u00fd v\u00e0 s\u1eeda \u0111\u1ed5i. Ti\u1ebft l\u1ed9 m\u1ed9t s\u1ed1 chi ti\u1ebft, thu\u1eadt to\u00e1n s\u1ebd ch\u1ecdn m\u1ed9t \u0111\u1ec9nh c\u00f3 d\u01b0 th\u1eeba v\u00e0 \u0111\u1ea9y ph\u1ea7n d\u01b0 th\u1eeba sang c\u00e1c \u0111\u1ec9nh l\u00e2n c\u1eadn. N\u00f3 s\u1ebd l\u1eb7p l\u1ea1i \u0111i\u1ec1u n\u00e0y cho \u0111\u1ebfn khi t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh, ngo\u1ea1i tr\u1eeb ngu\u1ed3n v\u00e0 \u0111\u00edch, kh\u00f4ng c\u00f2n d\u01b0 th\u1eeba. D\u1ec5 d\u00e0ng th\u1ea5y r\u1eb1ng, m\u1ed9t lu\u1ed3ng ti\u1ec1n kh\u00f4ng c\u00f3 d\u01b0 th\u1eeba l\u00e0 m\u1ed9t lu\u1ed3ng h\u1ee3p l\u1ec7. \u0110i\u1ec1u n\u00e0y l\u00e0m cho thu\u1eadt to\u00e1n k\u1ebft th\u00fac v\u1edbi m\u1ed9t lu\u1ed3ng th\u1ef1c t\u1ebf.</p> <p>V\u1eabn c\u00f2n hai v\u1ea5n \u0111\u1ec1 m\u00e0 ch\u00fang ta ph\u1ea3i gi\u1ea3i quy\u1ebft. Th\u1ee9 nh\u1ea5t, l\u00e0m th\u1ebf n\u00e0o ch\u00fang ta \u0111\u1ea3m b\u1ea3o r\u1eb1ng \u0111i\u1ec1u n\u00e0y th\u1ef1c s\u1ef1 k\u1ebft th\u00fac? V\u00e0 th\u1ee9 hai, l\u00e0m th\u1ebf n\u00e0o \u0111\u1ec3 ch\u00fang ta \u0111\u1ea3m b\u1ea3o r\u1eb1ng \u0111i\u1ec1u n\u00e0y s\u1ebd th\u1ef1c s\u1ef1 mang l\u1ea1i cho ch\u00fang ta m\u1ed9t lu\u1ed3ng c\u1ef1c \u0111\u1ea1i, ch\u1ee9 kh\u00f4ng ch\u1ec9 l\u00e0 b\u1ea5t k\u1ef3 lu\u1ed3ng ng\u1eabu nhi\u00ean n\u00e0o?</p> <p>\u0110\u1ec3 gi\u1ea3i quy\u1ebft nh\u1eefng v\u1ea5n \u0111\u1ec1 n\u00e0y, ch\u00fang ta c\u1ea7n s\u1ef1 tr\u1ee3 gi\u00fap c\u1ee7a m\u1ed9t h\u00e0m kh\u00e1c, c\u1ee5 th\u1ec3 l\u00e0 h\u00e0m g\u00e1n nh\u00e3n (labeling) $h$, th\u01b0\u1eddng \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 h\u00e0m \u0111\u1ed9 cao (height), g\u00e1n cho m\u1ed7i \u0111\u1ec9nh m\u1ed9t s\u1ed1 nguy\u00ean. Ch\u00fang ta g\u1ecdi m\u1ed9t c\u00e1ch g\u00e1n nh\u00e3n l\u00e0 h\u1ee3p l\u1ec7, n\u1ebfu $h(s) = |V|$, $h(t) = 0$, v\u00e0 $h(u) \\le h(v) + 1$ n\u1ebfu c\u00f3 m\u1ed9t c\u1ea1nh $(u, v)$ trong \u0111\u1ed3 th\u1ecb d\u01b0 - t\u1ee9c l\u00e0 c\u1ea1nh $(u, v)$ c\u00f3 dung l\u01b0\u1ee3ng d\u01b0\u01a1ng trong \u0111\u1ed3 th\u1ecb d\u01b0. N\u00f3i c\u00e1ch kh\u00e1c, n\u1ebfu c\u00f3 th\u1ec3 t\u0103ng lu\u1ed3ng t\u1eeb $u$ \u0111\u1ebfn $v$, th\u00ec \u0111\u1ed9 cao c\u1ee7a $v$ c\u00f3 th\u1ec3 nh\u1ecf h\u01a1n \u0111\u1ed9 cao c\u1ee7a $u$ t\u1ed1i \u0111a l\u00e0 m\u1ed9t, nh\u01b0ng n\u00f3 c\u00f3 th\u1ec3 b\u1eb1ng ho\u1eb7c th\u1eadm ch\u00ed cao h\u01a1n.</p> <p>\u0110i\u1ec1u quan tr\u1ecdng c\u1ea7n l\u01b0u \u00fd l\u00e0 n\u1ebfu t\u1ed3n t\u1ea1i m\u1ed9t h\u00e0m g\u00e1n nh\u00e3n h\u1ee3p l\u1ec7, th\u00ec kh\u00f4ng t\u1ed3n t\u1ea1i m\u1ed9t \u0111\u01b0\u1eddng t\u0103ng lu\u1ed3ng t\u1eeb $s$ \u0111\u1ebfn $t$ trong \u0111\u1ed3 th\u1ecb d\u01b0. B\u1edfi v\u00ec m\u1ed9t \u0111\u01b0\u1eddng \u0111i nh\u01b0 v\u1eady s\u1ebd c\u00f3 \u0111\u1ed9 d\u00e0i t\u1ed1i \u0111a l\u00e0 $|V| - 1$ c\u1ea1nh, v\u00e0 m\u1ed7i c\u1ea1nh ch\u1ec9 c\u00f3 th\u1ec3 l\u00e0m gi\u1ea3m \u0111\u1ed9 cao t\u1ed1i \u0111a l\u00e0 m\u1ed9t, \u0111i\u1ec1u n\u00e0y l\u00e0 kh\u00f4ng th\u1ec3 n\u1ebfu \u0111\u1ed9 cao \u0111\u1ea7u ti\u00ean l\u00e0 $h(s) = |V|$ v\u00e0 \u0111\u1ed9 cao cu\u1ed1i c\u00f9ng l\u00e0 $h(t) = 0$.</p> <p>S\u1eed d\u1ee5ng h\u00e0m g\u00e1n nh\u00e3n n\u00e0y, ch\u00fang ta c\u00f3 th\u1ec3 n\u00eau chi\u1ebfn l\u01b0\u1ee3c c\u1ee7a thu\u1eadt to\u00e1n push-relabel: Ch\u00fang ta b\u1eaft \u0111\u1ea7u v\u1edbi m\u1ed9t lu\u1ed3ng ti\u1ec1n h\u1ee3p l\u1ec7 v\u00e0 m\u1ed9t h\u00e0m g\u00e1n nh\u00e3n h\u1ee3p l\u1ec7. Trong m\u1ed7i b\u01b0\u1edbc, ch\u00fang ta \u0111\u1ea9y m\u1ed9t s\u1ed1 d\u01b0 th\u1eeba gi\u1eefa c\u00e1c \u0111\u1ec9nh, v\u00e0 c\u1eadp nh\u1eadt nh\u00e3n c\u1ee7a c\u00e1c \u0111\u1ec9nh. Ch\u00fang ta ph\u1ea3i \u0111\u1ea3m b\u1ea3o r\u1eb1ng, sau m\u1ed7i b\u01b0\u1edbc, lu\u1ed3ng ti\u1ec1n v\u00e0 c\u00e1ch g\u00e1n nh\u00e3n v\u1eabn h\u1ee3p l\u1ec7. N\u1ebfu sau \u0111\u00f3 thu\u1eadt to\u00e1n x\u00e1c \u0111\u1ecbnh, lu\u1ed3ng ti\u1ec1n l\u00e0 m\u1ed9t lu\u1ed3ng h\u1ee3p l\u1ec7. V\u00e0 b\u1edfi v\u00ec ch\u00fang ta c\u0169ng c\u00f3 m\u1ed9t c\u00e1ch g\u00e1n nh\u00e3n h\u1ee3p l\u1ec7, n\u00ean kh\u00f4ng t\u1ed3n t\u1ea1i \u0111\u01b0\u1eddng \u0111i gi\u1eefa $s$ v\u00e0 $t$ trong \u0111\u1ed3 th\u1ecb d\u01b0, \u0111i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 lu\u1ed3ng th\u1ef1c s\u1ef1 l\u00e0 lu\u1ed3ng c\u1ef1c \u0111\u1ea1i.</p> <p>N\u1ebfu ch\u00fang ta so s\u00e1nh thu\u1eadt to\u00e1n Ford-Fulkerson v\u1edbi thu\u1eadt to\u00e1n push-relabel, c\u00f3 v\u1ebb nh\u01b0 c\u00e1c thu\u1eadt to\u00e1n l\u00e0 \u0111\u1ed1i ng\u1eabu c\u1ee7a nhau. Thu\u1eadt to\u00e1n Ford-Fulkerson gi\u1eef m\u1ed9t lu\u1ed3ng h\u1ee3p l\u1ec7 m\u1ecdi l\u00fac v\u00e0 c\u1ea3i thi\u1ec7n n\u00f3 cho \u0111\u1ebfn khi kh\u00f4ng c\u00f2n t\u1ed3n t\u1ea1i \u0111\u01b0\u1eddng t\u0103ng lu\u1ed3ng n\u00e0o n\u1eefa, trong khi trong thu\u1eadt to\u00e1n push-relabel, kh\u00f4ng t\u1ed3n t\u1ea1i \u0111\u01b0\u1eddng t\u0103ng lu\u1ed3ng n\u00e0o v\u00e0o b\u1ea5t k\u1ef3 l\u00fac n\u00e0o, v\u00e0 ch\u00fang ta s\u1ebd c\u1ea3i thi\u1ec7n lu\u1ed3ng ti\u1ec1n cho \u0111\u1ebfn khi n\u00f3 l\u00e0 m\u1ed9t lu\u1ed3ng h\u1ee3p l\u1ec7.</p>","tags":["Translated"]},{"location":"graph/push-relabel.html#algorithm","title":"Thu\u1eadt to\u00e1n (Algorithm)","text":"<p>\u0110\u1ea7u ti\u00ean ch\u00fang ta ph\u1ea3i kh\u1edfi t\u1ea1o \u0111\u1ed3 th\u1ecb v\u1edbi m\u1ed9t lu\u1ed3ng ti\u1ec1n h\u1ee3p l\u1ec7 v\u00e0 h\u00e0m g\u00e1n nh\u00e3n h\u1ee3p l\u1ec7.</p> <p>S\u1eed d\u1ee5ng lu\u1ed3ng ti\u1ec1n r\u1ed7ng - gi\u1ed1ng nh\u01b0 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong thu\u1eadt to\u00e1n Ford-Fulkerson - l\u00e0 kh\u00f4ng th\u1ec3, b\u1edfi v\u00ec sau \u0111\u00f3 s\u1ebd c\u00f3 m\u1ed9t \u0111\u01b0\u1eddng t\u0103ng lu\u1ed3ng v\u00e0 \u0111i\u1ec1u n\u00e0y ng\u1ee5 \u00fd r\u1eb1ng kh\u00f4ng t\u1ed3n t\u1ea1i m\u1ed9t c\u00e1ch g\u00e1n nh\u00e3n h\u1ee3p l\u1ec7. Do \u0111\u00f3, ch\u00fang ta s\u1ebd kh\u1edfi t\u1ea1o m\u1ed7i c\u1ea1nh \u0111i ra t\u1eeb $s$ v\u1edbi dung l\u01b0\u1ee3ng t\u1ed1i \u0111a c\u1ee7a n\u00f3: $f((s, u)) = c((s, u))$. V\u00e0 t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh kh\u00e1c v\u1edbi kh\u00f4ng. Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y t\u1ed3n t\u1ea1i m\u1ed9t c\u00e1ch g\u00e1n nh\u00e3n h\u1ee3p l\u1ec7, c\u1ee5 th\u1ec3 l\u00e0 $h(s) = |V|$ cho \u0111\u1ec9nh ngu\u1ed3n v\u00e0 $h(u) = 0$ cho t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh kh\u00e1c.</p> <p>B\u00e2y gi\u1edd h\u00e3y m\u00f4 t\u1ea3 hai thao t\u00e1c chi ti\u1ebft h\u01a1n.</p> <p>V\u1edbi thao t\u00e1c <code>push</code> (\u0111\u1ea9y), ch\u00fang ta c\u1ed1 g\u1eafng \u0111\u1ea9y c\u00e0ng nhi\u1ec1u lu\u1ed3ng d\u01b0 th\u1eeba t\u1eeb m\u1ed9t \u0111\u1ec9nh $u$ sang m\u1ed9t \u0111\u1ec9nh l\u00e2n c\u1eadn $v$. Ch\u00fang ta c\u00f3 m\u1ed9t quy t\u1eafc: ch\u00fang ta ch\u1ec9 \u0111\u01b0\u1ee3c ph\u00e9p \u0111\u1ea9y lu\u1ed3ng t\u1eeb $u$ sang $v$ n\u1ebfu $h(u) = h(v) + 1$. Theo thu\u1eadt ng\u1eef th\u00f4ng th\u01b0\u1eddng, lu\u1ed3ng d\u01b0 th\u1eeba ph\u1ea3i ch\u1ea3y xu\u1ed1ng d\u01b0\u1edbi, nh\u01b0ng kh\u00f4ng qu\u00e1 d\u1ed1c. T\u1ea5t nhi\u00ean ch\u00fang ta ch\u1ec9 c\u00f3 th\u1ec3 \u0111\u1ea9y $\\min(x(u), c((u, v)) - f((u, v)))$ lu\u1ed3ng.</p> <p>N\u1ebfu m\u1ed9t \u0111\u1ec9nh c\u00f3 d\u01b0 th\u1eeba, nh\u01b0ng kh\u00f4ng th\u1ec3 \u0111\u1ea9y ph\u1ea7n d\u01b0 th\u1eeba sang b\u1ea5t k\u1ef3 \u0111\u1ec9nh li\u1ec1n k\u1ec1 n\u00e0o, th\u00ec ch\u00fang ta c\u1ea7n t\u0103ng \u0111\u1ed9 cao c\u1ee7a \u0111\u1ec9nh n\u00e0y. Ch\u00fang ta g\u1ecdi thao t\u00e1c n\u00e0y l\u00e0 <code>relabel</code> (g\u00e1n l\u1ea1i nh\u00e3n). Ch\u00fang ta s\u1ebd t\u0103ng n\u00f3 nhi\u1ec1u nh\u1ea5t c\u00f3 th\u1ec3, trong khi v\u1eabn duy tr\u00ec t\u00ednh h\u1ee3p l\u1ec7 c\u1ee7a vi\u1ec7c g\u00e1n nh\u00e3n.</p> <p>T\u00f3m l\u1ea1i, thu\u1eadt to\u00e1n v\u1eafn t\u1eaft l\u00e0: Ch\u00fang ta kh\u1edfi t\u1ea1o m\u1ed9t lu\u1ed3ng ti\u1ec1n h\u1ee3p l\u1ec7 v\u00e0 m\u1ed9t c\u00e1ch g\u00e1n nh\u00e3n h\u1ee3p l\u1ec7. Trong khi ch\u00fang ta c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n c\u00e1c thao t\u00e1c push ho\u1eb7c relabel, ch\u00fang ta th\u1ef1c hi\u1ec7n ch\u00fang. Sau \u0111\u00f3, lu\u1ed3ng ti\u1ec1n th\u1ef1c s\u1ef1 l\u00e0 m\u1ed9t lu\u1ed3ng v\u00e0 ch\u00fang ta tr\u1ea3 v\u1ec1 n\u00f3.</p>","tags":["Translated"]},{"location":"graph/push-relabel.html#complexity","title":"\u0110\u1ed9 ph\u1ee9c t\u1ea1p (Complexity)","text":"<p>D\u1ec5 d\u00e0ng ch\u1ec9 ra r\u1eb1ng, nh\u00e3n c\u1ef1c \u0111\u1ea1i c\u1ee7a m\u1ed9t \u0111\u1ec9nh l\u00e0 $2|V| - 1$. T\u1ea1i th\u1eddi \u0111i\u1ec3m n\u00e0y, t\u1ea5t c\u1ea3 d\u01b0 th\u1eeba c\u00f2n l\u1ea1i c\u00f3 th\u1ec3 v\u00e0 s\u1ebd \u0111\u01b0\u1ee3c \u0111\u1ea9y ng\u01b0\u1ee3c l\u1ea1i ngu\u1ed3n. \u0110i\u1ec1u n\u00e0y mang l\u1ea1i t\u1ed1i \u0111a $O(V^2)$ thao t\u00e1c relabel.</p> <p>C\u0169ng c\u00f3 th\u1ec3 ch\u1ec9 ra r\u1eb1ng, s\u1ebd c\u00f3 t\u1ed1i \u0111a $O(V E)$ l\u1ea7n \u0111\u1ea9y b\u00e3o h\u00f2a (m\u1ed9t l\u1ea7n \u0111\u1ea9y m\u00e0 t\u1ed5ng dung l\u01b0\u1ee3ng c\u1ee7a c\u1ea1nh \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng) v\u00e0 t\u1ed1i \u0111a $O(V^2 E)$ l\u1ea7n \u0111\u1ea9y kh\u00f4ng b\u00e3o h\u00f2a (m\u1ed9t l\u1ea7n \u0111\u1ea9y m\u00e0 dung l\u01b0\u1ee3ng c\u1ee7a m\u1ed9t c\u1ea1nh kh\u00f4ng \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng h\u1ebft) \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n. N\u1ebfu ch\u00fang ta ch\u1ecdn m\u1ed9t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u cho ph\u00e9p ch\u00fang ta t\u00ecm \u0111\u1ec9nh ti\u1ebfp theo c\u00f3 d\u01b0 th\u1eeba trong th\u1eddi gian $O(1)$, th\u00ec t\u1ed5ng \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 $O(V^2 E)$.</p>","tags":["Translated"]},{"location":"graph/push-relabel.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<pre><code>const int inf = 1000000000;\n\nint n;\nvector&lt;vector&lt;int&gt;&gt; capacity, flow;\nvector&lt;int&gt; height, excess, seen;\nqueue&lt;int&gt; excess_vertices;\n\nvoid push(int u, int v) {\n    int d = min(excess[u], capacity[u][v] - flow[u][v]);\n    flow[u][v] += d;\n    flow[v][u] -= d;\n    excess[u] -= d;\n    excess[v] += d;\n    if (d &amp;&amp; excess[v] == d)\n        excess_vertices.push(v);\n}\n\nvoid relabel(int u) {\n    int d = inf;\n    for (int i = 0; i &lt; n; i++) {\n        if (capacity[u][i] - flow[u][i] &gt; 0)\n            d = min(d, height[i]);\n    }\n    if (d &lt; inf)\n        height[u] = d + 1;\n}\n\nvoid discharge(int u) {\n    while (excess[u] &gt; 0) {\n        if (seen[u] &lt; n) {\n            int v = seen[u];\n            if (capacity[u][v] - flow[u][v] &gt; 0 &amp;&amp; height[u] &gt; height[v])\n                push(u, v);\n            else \n                seen[u]++;\n        } else {\n            relabel(u);\n            seen[u] = 0;\n        }\n    }\n}\n\nint max_flow(int s, int t) {\n    height.assign(n, 0);\n    height[s] = n;\n    flow.assign(n, vector&lt;int&gt;(n, 0));\n    excess.assign(n, 0);\n    excess[s] = inf;\n    for (int i = 0; i &lt; n; i++) {\n        if (i != s)\n            push(s, i);\n    }\n    seen.assign(n, 0);\n\n    while (!excess_vertices.empty()) {\n        int u = excess_vertices.front();\n        excess_vertices.pop();\n        if (u != s &amp;&amp; u != t)\n            discharge(u);\n    }\n\n    int max_flow = 0;\n    for (int i = 0; i &lt; n; i++)\n        max_flow += flow[i][t];\n    return max_flow;\n}\n</code></pre> <p>\u1ede \u0111\u00e2y ch\u00fang ta s\u1eed d\u1ee5ng h\u00e0ng \u0111\u1ee3i <code>excess_vertices</code> \u0111\u1ec3 l\u01b0u tr\u1eef t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh hi\u1ec7n \u0111ang c\u00f3 d\u01b0 th\u1eeba. Theo c\u00e1ch \u0111\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 ch\u1ecdn \u0111\u1ec9nh ti\u1ebfp theo cho thao t\u00e1c push ho\u1eb7c relabel trong th\u1eddi gian h\u1eb1ng s\u1ed1.</p> <p>V\u00e0 \u0111\u1ec3 \u0111\u1ea3m b\u1ea3o r\u1eb1ng ch\u00fang ta kh\u00f4ng d\u00e0nh qu\u00e1 nhi\u1ec1u th\u1eddi gian \u0111\u1ec3 t\u00ecm \u0111\u1ec9nh li\u1ec1n k\u1ec1 m\u00e0 ch\u00fang ta c\u00f3 th\u1ec3 \u0111\u1ea9y t\u1edbi, ch\u00fang ta s\u1eed d\u1ee5ng m\u1ed9t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 cung hi\u1ec7n t\u1ea1i (current-arc). V\u1ec1 c\u01a1 b\u1ea3n, ch\u00fang ta s\u1ebd l\u1eb7p qua c\u00e1c c\u1ea1nh theo th\u1ee9 t\u1ef1 v\u00f2ng tr\u00f2n v\u00e0 lu\u00f4n l\u01b0u tr\u1eef c\u1ea1nh cu\u1ed1i c\u00f9ng m\u00e0 ch\u00fang ta \u0111\u00e3 s\u1eed d\u1ee5ng. Theo c\u00e1ch n\u00e0y, \u0111\u1ed1i v\u1edbi m\u1ed9t gi\u00e1 tr\u1ecb nh\u00e3n nh\u1ea5t \u0111\u1ecbnh, ch\u00fang ta s\u1ebd ch\u1ec9 chuy\u1ec3n \u0111\u1ed5i c\u1ea1nh hi\u1ec7n t\u1ea1i $O(n)$ l\u1ea7n. V\u00e0 v\u00ec relabel \u0111\u00e3 m\u1ea5t th\u1eddi gian $O(n)$, ch\u00fang ta kh\u00f4ng l\u00e0m cho \u0111\u1ed9 ph\u1ee9c t\u1ea1p t\u1ed3i t\u1ec7 h\u01a1n.</p>","tags":["Translated"]},{"location":"graph/rmq_linear.html","title":"Gi\u1ea3i RMQ (Truy v\u1ea5n gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t trong ph\u1ea1m vi) b\u1eb1ng c\u00e1ch t\u00ecm LCA (T\u1ed5 ti\u00ean chung th\u1ea5p nh\u1ea5t) (Solve RMQ (Range Minimum Query) by finding LCA (Lowest Common Ancestor))","text":"<p>Cho m\u1ed9t m\u1ea3ng <code>A[0..N-1]</code>. \u0110\u1ed1i v\u1edbi m\u1ed7i truy v\u1ea5n c\u00f3 d\u1ea1ng <code>[L, R]</code>, ch\u00fang ta mu\u1ed1n t\u00ecm gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t trong m\u1ea3ng <code>A</code> b\u1eaft \u0111\u1ea7u t\u1eeb v\u1ecb tr\u00ed <code>L</code> v\u00e0 k\u1ebft th\u00fac b\u1eb1ng v\u1ecb tr\u00ed <code>R</code>. Ch\u00fang ta s\u1ebd gi\u1ea3 \u0111\u1ecbnh r\u1eb1ng m\u1ea3ng <code>A</code> kh\u00f4ng thay \u0111\u1ed5i trong qu\u00e1 tr\u00ecnh, t\u1ee9c l\u00e0 b\u00e0i vi\u1ebft n\u00e0y m\u00f4 t\u1ea3 m\u1ed9t gi\u1ea3i ph\u00e1p cho b\u00e0i to\u00e1n RMQ t\u0129nh.</p> <p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u00f4 t\u1ea3 v\u1ec1 m\u1ed9t gi\u1ea3i ph\u00e1p t\u1ed1i \u01b0u ti\u1ec7m c\u1eadn. N\u00f3 \u0111\u1ee9ng t\u00e1ch bi\u1ec7t v\u1edbi c\u00e1c gi\u1ea3i ph\u00e1p kh\u00e1c cho b\u00e0i to\u00e1n RMQ, v\u00ec n\u00f3 r\u1ea5t kh\u00e1c bi\u1ec7t v\u1edbi ch\u00fang: n\u00f3 quy gi\u1ea3m b\u00e0i to\u00e1n RMQ th\u00e0nh b\u00e0i to\u00e1n LCA, v\u00e0 sau \u0111\u00f3 s\u1eed d\u1ee5ng thu\u1eadt to\u00e1n Farach-Colton v\u00e0 Bender, v\u1ed1n quy gi\u1ea3m b\u00e0i to\u00e1n LCA tr\u1edf l\u1ea1i th\u00e0nh m\u1ed9t b\u00e0i to\u00e1n RMQ chuy\u00ean bi\u1ec7t v\u00e0 gi\u1ea3i quy\u1ebft n\u00f3.</p>","tags":["Translated"]},{"location":"graph/rmq_linear.html#algorithm","title":"Thu\u1eadt to\u00e1n (Algorithm)","text":"<p>Ch\u00fang ta x\u00e2y d\u1ef1ng m\u1ed9t c\u00e2y Cartesian t\u1eeb m\u1ea3ng <code>A</code>. C\u00e2y Cartesian c\u1ee7a m\u1ed9t m\u1ea3ng <code>A</code> l\u00e0 m\u1ed9t c\u00e2y nh\u1ecb ph\u00e2n c\u00f3 thu\u1ed9c t\u00ednh min-heap (gi\u00e1 tr\u1ecb c\u1ee7a n\u00fat cha ph\u1ea3i nh\u1ecf h\u01a1n ho\u1eb7c b\u1eb1ng gi\u00e1 tr\u1ecb c\u1ee7a c\u00e1c con c\u1ee7a n\u00f3) sao cho vi\u1ec7c duy\u1ec7t c\u00e2y theo th\u1ee9 t\u1ef1 gi\u1eefa (in-order traversal) s\u1ebd th\u0103m c\u00e1c n\u00fat theo c\u00f9ng th\u1ee9 t\u1ef1 nh\u01b0 ch\u00fang n\u1eb1m trong m\u1ea3ng <code>A</code>.</p> <p>N\u00f3i c\u00e1ch kh\u00e1c, c\u00e2y Cartesian l\u00e0 m\u1ed9t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u \u0111\u1ec7 quy. M\u1ea3ng <code>A</code> s\u1ebd \u0111\u01b0\u1ee3c ph\u00e2n chia th\u00e0nh 3 ph\u1ea7n: ti\u1ec1n t\u1ed1 c\u1ee7a m\u1ea3ng cho \u0111\u1ebfn gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t, gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t, v\u00e0 h\u1eadu t\u1ed1 c\u00f2n l\u1ea1i. G\u1ed1c c\u1ee7a c\u00e2y s\u1ebd l\u00e0 m\u1ed9t n\u00fat t\u01b0\u01a1ng \u1ee9ng v\u1edbi ph\u1ea7n t\u1eed nh\u1ecf nh\u1ea5t c\u1ee7a m\u1ea3ng <code>A</code>, c\u00e2y con b\u00ean tr\u00e1i s\u1ebd l\u00e0 c\u00e2y Cartesian c\u1ee7a ti\u1ec1n t\u1ed1, v\u00e0 c\u00e2y con b\u00ean ph\u1ea3i s\u1ebd l\u00e0 c\u00e2y Cartesian c\u1ee7a h\u1eadu t\u1ed1.</p> <p>Trong h\u00ecnh \u1ea3nh sau \u0111\u00e2y, b\u1ea1n c\u00f3 th\u1ec3 th\u1ea5y m\u1ed9t m\u1ea3ng c\u00f3 \u0111\u1ed9 d\u00e0i 10 v\u00e0 c\u00e2y Cartesian t\u01b0\u01a1ng \u1ee9ng.</p> <p>Truy v\u1ea5n gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t trong ph\u1ea1m vi <code>[l, r]</code> t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi truy v\u1ea5n t\u1ed5 ti\u00ean chung th\u1ea5p nh\u1ea5t <code>[l', r']</code>, trong \u0111\u00f3 <code>l'</code> l\u00e0 n\u00fat t\u01b0\u01a1ng \u1ee9ng v\u1edbi ph\u1ea7n t\u1eed <code>A[l]</code> v\u00e0 <code>r'</code> l\u00e0 n\u00fat t\u01b0\u01a1ng \u1ee9ng v\u1edbi ph\u1ea7n t\u1eed <code>A[r]</code>. Th\u1eadt v\u1eady, n\u00fat t\u01b0\u01a1ng \u1ee9ng v\u1edbi ph\u1ea7n t\u1eed nh\u1ecf nh\u1ea5t trong ph\u1ea1m vi ph\u1ea3i l\u00e0 t\u1ed5 ti\u00ean c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c n\u00fat trong ph\u1ea1m vi, do \u0111\u00f3 c\u0169ng t\u1eeb <code>l'</code> v\u00e0 <code>r'</code>. \u0110i\u1ec1u n\u00e0y t\u1ef1 \u0111\u1ed9ng theo sau t\u1eeb thu\u1ed9c t\u00ednh min-heap. V\u00e0 n\u00f3 c\u0169ng ph\u1ea3i l\u00e0 t\u1ed5 ti\u00ean th\u1ea5p nh\u1ea5t, b\u1edfi v\u00ec n\u1ebfu kh\u00f4ng <code>l'</code> v\u00e0 <code>r'</code> s\u1ebd \u0111\u1ec1u \u1edf trong c\u00e2y con b\u00ean tr\u00e1i ho\u1eb7c b\u00ean ph\u1ea3i, \u0111i\u1ec1u n\u00e0y t\u1ea1o ra m\u1ed9t m\u00e2u thu\u1eabn v\u00ec trong tr\u01b0\u1eddng h\u1ee3p nh\u01b0 v\u1eady gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t th\u1eadm ch\u00ed s\u1ebd kh\u00f4ng n\u1eb1m trong ph\u1ea1m vi.</p> <p>Trong h\u00ecnh \u1ea3nh sau \u0111\u00e2y, b\u1ea1n c\u00f3 th\u1ec3 th\u1ea5y c\u00e1c truy v\u1ea5n LCA cho c\u00e1c truy v\u1ea5n RMQ <code>[1, 3]</code> v\u00e0 <code>[5, 9]</code>. Trong truy v\u1ea5n \u0111\u1ea7u ti\u00ean, LCA c\u1ee7a c\u00e1c n\u00fat <code>A[1]</code> v\u00e0 <code>A[3]</code> l\u00e0 n\u00fat t\u01b0\u01a1ng \u1ee9ng v\u1edbi <code>A[2]</code> c\u00f3 gi\u00e1 tr\u1ecb 2, v\u00e0 trong truy v\u1ea5n th\u1ee9 hai, LCA c\u1ee7a <code>A[5]</code> v\u00e0 <code>A[9]</code> l\u00e0 n\u00fat t\u01b0\u01a1ng \u1ee9ng v\u1edbi <code>A[8]</code> c\u00f3 gi\u00e1 tr\u1ecb 3.</p> <p>M\u1ed9t c\u00e2y nh\u01b0 v\u1eady c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c x\u00e2y d\u1ef1ng trong th\u1eddi gian $O(N)$ v\u00e0 thu\u1eadt to\u00e1n Farach-Colton v\u00e0 Bender c\u00f3 th\u1ec3 ti\u1ec1n x\u1eed l\u00fd c\u00e2y trong $O(N)$ v\u00e0 t\u00ecm LCA trong $O(1)$.</p>","tags":["Translated"]},{"location":"graph/rmq_linear.html#construction-of-a-cartesian-tree","title":"X\u00e2y d\u1ef1ng c\u00e2y Cartesian (Construction of a Cartesian tree)","text":"<p>Ch\u00fang ta s\u1ebd x\u00e2y d\u1ef1ng c\u00e2y Cartesian b\u1eb1ng c\u00e1ch th\u00eam c\u00e1c ph\u1ea7n t\u1eed l\u1ea7n l\u01b0\u1ee3t t\u1eebng c\u00e1i m\u1ed9t. Trong m\u1ed7i b\u01b0\u1edbc, ch\u00fang ta duy tr\u00ec m\u1ed9t c\u00e2y Cartesian h\u1ee3p l\u1ec7 c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed \u0111\u00e3 x\u1eed l\u00fd. D\u1ec5 d\u00e0ng th\u1ea5y r\u1eb1ng, vi\u1ec7c th\u00eam m\u1ed9t ph\u1ea7n t\u1eed <code>s[i]</code> ch\u1ec9 c\u00f3 th\u1ec3 thay \u0111\u1ed5i c\u00e1c n\u00fat trong \u0111\u01b0\u1eddng \u0111i ngo\u00e0i c\u00f9ng b\u00ean ph\u1ea3i - b\u1eaft \u0111\u1ea7u t\u1eeb g\u1ed1c v\u00e0 l\u1eb7p \u0111i l\u1eb7p l\u1ea1i vi\u1ec7c l\u1ea5y con b\u00ean ph\u1ea3i - c\u1ee7a c\u00e2y. C\u00e2y con c\u1ee7a n\u00fat c\u00f3 gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t, nh\u01b0ng l\u1edbn h\u01a1n ho\u1eb7c b\u1eb1ng <code>s[i]</code>, tr\u1edf th\u00e0nh c\u00e2y con b\u00ean tr\u00e1i c\u1ee7a <code>s[i]</code>, v\u00e0 c\u00e2y c\u00f3 g\u1ed1c <code>s[i]</code> s\u1ebd tr\u1edf th\u00e0nh c\u00e2y con b\u00ean ph\u1ea3i m\u1edbi c\u1ee7a n\u00fat c\u00f3 gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t, nh\u01b0ng nh\u1ecf h\u01a1n <code>s[i]</code>.</p> <p>\u0110i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c c\u00e0i \u0111\u1eb7t b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng m\u1ed9t ng\u0103n x\u1ebfp \u0111\u1ec3 l\u01b0u tr\u1eef c\u00e1c ch\u1ec9 s\u1ed1 c\u1ee7a c\u00e1c n\u00fat ngo\u00e0i c\u00f9ng b\u00ean ph\u1ea3i.</p> <pre><code>vector&lt;int&gt; parent(n, -1);\nstack&lt;int&gt; s;\nfor (int i = 0; i &lt; n; i++) {\n    int last = -1;\n    while (!s.empty() &amp;&amp; A[s.top()] &gt;= A[i]) {\n        last = s.top();\n        s.pop();\n    }\n    if (!s.empty())\n        parent[i] = s.top();\n    if (last &gt;= 0)\n        parent[last] = i;\n    s.push(i);\n}\n</code></pre>","tags":["Translated"]},{"location":"graph/search-for-connected-components.html","title":"T\u00ecm c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng trong \u0111\u1ed3 th\u1ecb (Search for connected components in a graph)","text":"<p>Cho m\u1ed9t \u0111\u1ed3 th\u1ecb v\u00f4 h\u01b0\u1edbng $G$ v\u1edbi $n$ n\u00fat v\u00e0 $m$ c\u1ea1nh. Ch\u00fang ta \u0111\u01b0\u1ee3c y\u00eau c\u1ea7u t\u00ecm trong \u0111\u00f3 t\u1ea5t c\u1ea3 c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng, t\u1ee9c l\u00e0, m\u1ed9t v\u00e0i nh\u00f3m \u0111\u1ec9nh sao cho trong m\u1ed9t nh\u00f3m m\u1ed7i \u0111\u1ec9nh c\u00f3 th\u1ec3 \u0111\u1ebfn \u0111\u01b0\u1ee3c t\u1eeb \u0111\u1ec9nh kh\u00e1c v\u00e0 kh\u00f4ng c\u00f3 \u0111\u01b0\u1eddng \u0111i n\u00e0o t\u1ed3n t\u1ea1i gi\u1eefa c\u00e1c nh\u00f3m kh\u00e1c nhau.</p>","tags":["Translated"]},{"location":"graph/search-for-connected-components.html#an-algorithm-for-solving-the-problem","title":"M\u1ed9t thu\u1eadt to\u00e1n gi\u1ea3i quy\u1ebft b\u00e0i to\u00e1n (An algorithm for solving the problem)","text":"<ul> <li> <p>\u0110\u1ec3 gi\u1ea3i quy\u1ebft b\u00e0i to\u00e1n, ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng T\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u (Depth First Search) ho\u1eb7c T\u00ecm ki\u1ebfm theo chi\u1ec1u r\u1ed9ng (Breadth First Search).</p> </li> <li> <p>Tr\u00ean th\u1ef1c t\u1ebf, ch\u00fang ta s\u1ebd th\u1ef1c hi\u1ec7n m\u1ed9t lo\u1ea1t c\u00e1c v\u00f2ng DFS: V\u00f2ng \u0111\u1ea7u ti\u00ean s\u1ebd b\u1eaft \u0111\u1ea7u t\u1eeb n\u00fat \u0111\u1ea7u ti\u00ean v\u00e0 t\u1ea5t c\u1ea3 c\u00e1c n\u00fat trong th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng \u0111\u1ea7u ti\u00ean s\u1ebd \u0111\u01b0\u1ee3c duy\u1ec7t (t\u00ecm th\u1ea5y). Sau \u0111\u00f3, ch\u00fang ta t\u00ecm n\u00fat ch\u01b0a \u0111\u01b0\u1ee3c th\u0103m \u0111\u1ea7u ti\u00ean trong c\u00e1c n\u00fat c\u00f2n l\u1ea1i, v\u00e0 ch\u1ea1y T\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u tr\u00ean n\u00f3, do \u0111\u00f3 t\u00ecm th\u1ea5y m\u1ed9t th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng th\u1ee9 hai. V\u00e0 c\u1ee9 th\u1ebf, cho \u0111\u1ebfn khi t\u1ea5t c\u1ea3 c\u00e1c n\u00fat \u0111\u1ec1u \u0111\u01b0\u1ee3c th\u0103m.</p> </li> <li> <p>T\u1ed5ng th\u1eddi gian ch\u1ea1y ti\u1ec7m c\u1eadn c\u1ee7a thu\u1eadt to\u00e1n n\u00e0y l\u00e0 $O(n + m)$: S\u1ef1 th\u1eadt l\u00e0, thu\u1eadt to\u00e1n n\u00e0y s\u1ebd kh\u00f4ng ch\u1ea1y tr\u00ean c\u00f9ng m\u1ed9t \u0111\u1ec9nh hai l\u1ea7n, \u0111i\u1ec1u \u0111\u00f3 c\u00f3 ngh\u0129a l\u00e0 m\u1ed7i c\u1ea1nh s\u1ebd \u0111\u01b0\u1ee3c nh\u00ecn th\u1ea5y ch\u00ednh x\u00e1c hai l\u1ea7n (\u1edf \u0111\u1ea7u n\u00e0y v\u00e0 \u0111\u1ea7u kia).</p> </li> </ul>","tags":["Translated"]},{"location":"graph/search-for-connected-components.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<pre><code>int n;\nvector&lt;vector&lt;int&gt;&gt; adj;\nvector&lt;bool&gt; used;\nvector&lt;int&gt; comp;\n\nvoid dfs(int v) {\n    used[v] = true;\n    comp.push_back(v);\n    for (int u : adj[v]) {\n        if (!used[u])\n            dfs(u);\n    }\n}\n\nvoid find_comps() {\n    used.assign(n, false);\n    for (int v = 0; v &lt; n; ++v) {\n        if (!used[v]) {\n            comp.clear();\n            dfs(v);\n            cout &lt;&lt; \"Component:\" ;\n            for (int u : comp)\n                cout &lt;&lt; ' ' &lt;&lt; u;\n            cout &lt;&lt; endl ;\n        }\n    }\n}\n</code></pre> <ul> <li> <p>H\u00e0m quan tr\u1ecdng nh\u1ea5t \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng l\u00e0 <code>find_comps()</code> t\u00ecm v\u00e0 hi\u1ec3n th\u1ecb c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng c\u1ee7a \u0111\u1ed3 th\u1ecb.</p> </li> <li> <p>\u0110\u1ed3 th\u1ecb \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef trong bi\u1ec3u di\u1ec5n danh s\u00e1ch k\u1ec1, t\u1ee9c l\u00e0 <code>adj[v]</code> ch\u1ee9a danh s\u00e1ch c\u00e1c \u0111\u1ec9nh c\u00f3 c\u1ea1nh t\u1eeb \u0111\u1ec9nh <code>v</code>.</p> </li> <li> <p>Vector <code>comp</code> ch\u1ee9a danh s\u00e1ch c\u00e1c n\u00fat trong th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng hi\u1ec7n t\u1ea1i.</p> </li> </ul>","tags":["Translated"]},{"location":"graph/search-for-connected-components.html#iterative-implementation-of-the-code","title":"C\u00e0i \u0111\u1eb7t l\u1eb7p c\u1ee7a m\u00e3 (Iterative implementation of the code)","text":"<p>C\u00e1c h\u00e0m \u0111\u1ec7 quy s\u00e2u n\u00f3i chung l\u00e0 t\u1ec7. M\u1ed7i cu\u1ed9c g\u1ecdi \u0111\u1ec7 quy s\u1ebd y\u00eau c\u1ea7u m\u1ed9t ch\u00fat b\u1ed9 nh\u1edb trong stack, v\u00e0 theo m\u1eb7c \u0111\u1ecbnh c\u00e1c ch\u01b0\u01a1ng tr\u00ecnh ch\u1ec9 c\u00f3 m\u1ed9t l\u01b0\u1ee3ng kh\u00f4ng gian stack h\u1ea1n ch\u1ebf. V\u00ec v\u1eady, khi b\u1ea1n th\u1ef1c hi\u1ec7n DFS \u0111\u1ec7 quy tr\u00ean m\u1ed9t \u0111\u1ed3 th\u1ecb li\u00ean th\u00f4ng v\u1edbi h\u00e0ng tri\u1ec7u n\u00fat, b\u1ea1n c\u00f3 th\u1ec3 g\u1eb7p ph\u1ea3i l\u1ed7i tr\u00e0n stack (stack overflows).</p> <p>Lu\u00f4n c\u00f3 th\u1ec3 chuy\u1ec3n \u0111\u1ed5i m\u1ed9t ch\u01b0\u01a1ng tr\u00ecnh \u0111\u1ec7 quy th\u00e0nh m\u1ed9t ch\u01b0\u01a1ng tr\u00ecnh l\u1eb7p, b\u1eb1ng c\u00e1ch duy tr\u00ec th\u1ee7 c\u00f4ng m\u1ed9t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u stack. V\u00ec c\u1ea5u tr\u00fac d\u1eef li\u1ec7u n\u00e0y \u0111\u01b0\u1ee3c c\u1ea5p ph\u00e1t tr\u00ean heap, s\u1ebd kh\u00f4ng x\u1ea3y ra tr\u00e0n stack.</p> <pre><code>int n;\nvector&lt;vector&lt;int&gt;&gt; adj;\nvector&lt;bool&gt; used;\nvector&lt;int&gt; comp;\n\nvoid dfs(int v) {\n    stack&lt;int&gt; st;\n    st.push(v);\n\n    while (!st.empty()) {\n        int curr = st.top();\n        st.pop();\n        if (!used[curr]) {\n            used[curr] = true;\n            comp.push_back(curr);\n            for (int i = adj[curr].size() - 1; i &gt;= 0; i--) {\n                st.push(adj[curr][i]);\n            }\n        }\n    }\n}\n\nvoid find_comps() {\n    used.assign(n, false);\n    for (int v = 0; v &lt; n ; ++v) {\n        if (!used[v]) {\n            comp.clear();\n            dfs(v);\n            cout &lt;&lt; \"Component:\" ;\n            for (int u : comp)\n                cout &lt;&lt; ' ' &lt;&lt; u;\n            cout &lt;&lt; endl ;\n        }\n    }\n}\n</code></pre>","tags":["Translated"]},{"location":"graph/search-for-connected-components.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>SPOJ: CT23E</li> <li>CODECHEF: GERALD07</li> <li>CSES : Building Roads</li> </ul>","tags":["Translated"]},{"location":"graph/second_best_mst.html","title":"C\u00e2y khung nh\u1ecf nh\u1ea5t t\u1ed1t th\u1ee9 hai (Second Best Minimum Spanning Tree)","text":"<p>C\u00e2y khung nh\u1ecf nh\u1ea5t (MST) $T$ l\u00e0 m\u1ed9t c\u00e2y cho \u0111\u1ed3 th\u1ecb $G$ \u0111\u00e3 cho, c\u00e2y ph\u1ee7 t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh c\u1ee7a \u0111\u1ed3 th\u1ecb v\u00e0 c\u00f3 t\u1ed5ng tr\u1ecdng s\u1ed1 c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh l\u00e0 nh\u1ecf nh\u1ea5t, trong s\u1ed1 t\u1ea5t c\u1ea3 c\u00e1c c\u00e2y khung c\u00f3 th\u1ec3 c\u00f3. C\u00e2y khung nh\u1ecf nh\u1ea5t t\u1ed1t th\u1ee9 hai (Second best MST) $T'$ l\u00e0 m\u1ed9t c\u00e2y khung c\u00f3 t\u1ed5ng tr\u1ecdng s\u1ed1 c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh l\u00e0 nh\u1ecf th\u1ee9 hai, trong s\u1ed1 t\u1ea5t c\u1ea3 c\u00e1c c\u00e2y khung c\u00f3 th\u1ec3 c\u00f3 c\u1ee7a \u0111\u1ed3 th\u1ecb $G$.</p>","tags":["Translated"]},{"location":"graph/second_best_mst.html#observation","title":"Quan s\u00e1t (Observation)","text":"<p>Gi\u1ea3 s\u1eed $T$ l\u00e0 C\u00e2y khung nh\u1ecf nh\u1ea5t c\u1ee7a \u0111\u1ed3 th\u1ecb $G$. C\u00f3 th\u1ec3 quan s\u00e1t th\u1ea5y r\u1eb1ng, C\u00e2y khung nh\u1ecf nh\u1ea5t t\u1ed1t th\u1ee9 hai ch\u1ec9 kh\u00e1c v\u1edbi $T$ b\u1edfi vi\u1ec7c thay th\u1ebf m\u1ed9t c\u1ea1nh. (\u0110\u1ec3 xem ch\u1ee9ng minh cho ph\u00e1t bi\u1ec3u n\u00e0y h\u00e3y tham kh\u1ea3o b\u00e0i to\u00e1n 23-1 t\u1ea1i \u0111\u00e2y).</p> <p>V\u00ec v\u1eady, ch\u00fang ta c\u1ea7n t\u00ecm m\u1ed9t c\u1ea1nh $e_{new}$ kh\u00f4ng n\u1eb1m trong $T$, v\u00e0 thay th\u1ebf n\u00f3 b\u1eb1ng m\u1ed9t c\u1ea1nh trong $T$ (g\u1ecdi l\u00e0 $e_{old}$) sao cho \u0111\u1ed3 th\u1ecb m\u1edbi $T' = (T \\cup \\{e_{new}\\}) \\setminus \\{e_{old}\\}$ l\u00e0 m\u1ed9t c\u00e2y khung v\u00e0 hi\u1ec7u tr\u1ecdng s\u1ed1 ($e_{new} - e_{old}$) l\u00e0 nh\u1ecf nh\u1ea5t.</p>","tags":["Translated"]},{"location":"graph/second_best_mst.html#using-kruskals-algorithm","title":"S\u1eed d\u1ee5ng thu\u1eadt to\u00e1n Kruskal (Using Kruskal's Algorithm)","text":"<p>Ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng thu\u1eadt to\u00e1n Kruskal \u0111\u1ec3 t\u00ecm MST tr\u01b0\u1edbc, sau \u0111\u00f3 ch\u1ec9 c\u1ea7n th\u1eed lo\u1ea1i b\u1ecf m\u1ed9t c\u1ea1nh duy nh\u1ea5t kh\u1ecfi n\u00f3 v\u00e0 thay th\u1ebf b\u1eb1ng m\u1ed9t c\u1ea1nh kh\u00e1c.</p> <ol> <li>S\u1eafp x\u1ebfp c\u00e1c c\u1ea1nh trong $O(E \\log E)$, sau \u0111\u00f3 t\u00ecm MST b\u1eb1ng Kruskal trong $O(E)$.</li> <li>\u0110\u1ed1i v\u1edbi m\u1ed7i c\u1ea1nh trong MST (ch\u00fang ta s\u1ebd c\u00f3 $V-1$ c\u1ea1nh trong \u0111\u00f3) t\u1ea1m th\u1eddi lo\u1ea1i tr\u1eeb n\u00f3 kh\u1ecfi danh s\u00e1ch c\u1ea1nh \u0111\u1ec3 n\u00f3 kh\u00f4ng th\u1ec3 \u0111\u01b0\u1ee3c ch\u1ecdn.</li> <li>Sau \u0111\u00f3, th\u1eed t\u00ecm l\u1ea1i MST trong $O(E)$ b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng c\u00e1c c\u1ea1nh c\u00f2n l\u1ea1i.</li> <li>L\u00e0m \u0111i\u1ec1u n\u00e0y cho t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh trong MST, v\u00e0 l\u1ea5y k\u1ebft qu\u1ea3 t\u1ed1t nh\u1ea5t trong s\u1ed1 t\u1ea5t c\u1ea3.</li> </ol> <p>L\u01b0u \u00fd: ch\u00fang ta kh\u00f4ng c\u1ea7n s\u1eafp x\u1ebfp l\u1ea1i c\u00e1c c\u1ea1nh trong B\u01b0\u1edbc 3.</p> <p>V\u00ec v\u1eady, t\u1ed5ng \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian s\u1ebd l\u00e0 $O(E \\log V + E + V E)$ = $O(V E)$.</p>","tags":["Translated"]},{"location":"graph/second_best_mst.html#modeling-into-a-lowest-common-ancestor-lca-problem","title":"M\u00f4 h\u00ecnh h\u00f3a th\u00e0nh b\u00e0i to\u00e1n T\u1ed5 ti\u00ean chung th\u1ea5p nh\u1ea5t (LCA) (Modeling into a Lowest Common Ancestor (LCA) problem)","text":"<p>Trong c\u00e1ch ti\u1ebfp c\u1eadn tr\u01b0\u1edbc, ch\u00fang ta \u0111\u00e3 th\u1eed t\u1ea5t c\u1ea3 c\u00e1c kh\u1ea3 n\u0103ng lo\u1ea1i b\u1ecf m\u1ed9t c\u1ea1nh c\u1ee7a MST. \u1ede \u0111\u00e2y ch\u00fang ta s\u1ebd l\u00e0m ng\u01b0\u1ee3c l\u1ea1i ho\u00e0n to\u00e0n. Ch\u00fang ta c\u1ed1 g\u1eafng th\u00eam m\u1ecdi c\u1ea1nh ch\u01b0a c\u00f3 trong MST.</p> <ol> <li>S\u1eafp x\u1ebfp c\u00e1c c\u1ea1nh trong $O(E \\log E)$, sau \u0111\u00f3 t\u00ecm MST b\u1eb1ng Kruskal trong $O(E)$.</li> <li>\u0110\u1ed1i v\u1edbi m\u1ed7i c\u1ea1nh $e$ ch\u01b0a c\u00f3 trong MST, t\u1ea1m th\u1eddi th\u00eam n\u00f3 v\u00e0o MST, t\u1ea1o ra m\u1ed9t chu tr\u00ecnh. Chu tr\u00ecnh s\u1ebd \u0111i qua LCA.</li> <li>T\u00ecm c\u1ea1nh $k$ c\u00f3 tr\u1ecdng s\u1ed1 c\u1ef1c \u0111\u1ea1i trong chu tr\u00ecnh m\u00e0 kh\u00f4ng b\u1eb1ng $e$, b\u1eb1ng c\u00e1ch \u0111i theo cha c\u1ee7a c\u00e1c n\u00fat c\u1ee7a c\u1ea1nh $e$, l\u00ean \u0111\u1ebfn LCA.</li> <li>Lo\u1ea1i b\u1ecf $k$ t\u1ea1m th\u1eddi, t\u1ea1o ra m\u1ed9t c\u00e2y khung m\u1edbi.</li> <li>T\u00ednh hi\u1ec7u tr\u1ecdng s\u1ed1 $\\delta = weight(e) - weight(k)$, v\u00e0 ghi nh\u1edb n\u00f3 c\u00f9ng v\u1edbi c\u1ea1nh \u0111\u00e3 thay \u0111\u1ed5i.</li> <li>L\u1eb7p l\u1ea1i b\u01b0\u1edbc 2 cho t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh kh\u00e1c, v\u00e0 tr\u1ea3 v\u1ec1 c\u00e2y khung c\u00f3 hi\u1ec7u tr\u1ecdng s\u1ed1 nh\u1ecf nh\u1ea5t so v\u1edbi MST.</li> </ol> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian c\u1ee7a thu\u1eadt to\u00e1n ph\u1ee5 thu\u1ed9c v\u00e0o c\u00e1ch ch\u00fang ta t\u00ednh to\u00e1n c\u00e1c $k$, l\u00e0 c\u00e1c c\u1ea1nh c\u00f3 tr\u1ecdng s\u1ed1 l\u1edbn nh\u1ea5t trong b\u01b0\u1edbc 2 c\u1ee7a thu\u1eadt to\u00e1n n\u00e0y. M\u1ed9t c\u00e1ch \u0111\u1ec3 t\u00ednh to\u00e1n ch\u00fang hi\u1ec7u qu\u1ea3 trong $O(E \\log V)$ l\u00e0 chuy\u1ec3n \u0111\u1ed5i b\u00e0i to\u00e1n th\u00e0nh b\u00e0i to\u00e1n T\u1ed5 ti\u00ean chung th\u1ea5p nh\u1ea5t (LCA).</p> <p>Ch\u00fang ta s\u1ebd ti\u1ec1n x\u1eed l\u00fd LCA b\u1eb1ng c\u00e1ch ch\u1ecdn g\u1ed1c cho MST v\u00e0 c\u0169ng s\u1ebd t\u00ednh to\u00e1n tr\u1ecdng s\u1ed1 c\u1ea1nh l\u1edbn nh\u1ea5t cho m\u1ed7i n\u00fat tr\u00ean \u0111\u01b0\u1eddng \u0111i \u0111\u1ebfn t\u1ed5 ti\u00ean c\u1ee7a ch\u00fang. \u0110i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng Binary Lifting cho LCA.</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian cu\u1ed1i c\u00f9ng c\u1ee7a c\u00e1ch ti\u1ebfp c\u1eadn n\u00e0y l\u00e0 $O(E \\log V)$.</p> <p>V\u00ed d\u1ee5:</p>   *Trong h\u00ecnh b\u00ean tr\u00e1i l\u00e0 MST v\u00e0 b\u00ean ph\u1ea3i l\u00e0 MST t\u1ed1t th\u1ee9 hai.*  <p>Trong \u0111\u1ed3 th\u1ecb \u0111\u00e3 cho, gi\u1ea3 s\u1eed ch\u00fang ta ch\u1ecdn g\u1ed1c MST t\u1ea1i \u0111\u1ec9nh m\u00e0u xanh lam tr\u00ean c\u00f9ng, v\u00e0 sau \u0111\u00f3 ch\u1ea1y thu\u1eadt to\u00e1n b\u1eb1ng c\u00e1ch b\u1eaft \u0111\u1ea7u ch\u1ecdn c\u00e1c c\u1ea1nh kh\u00f4ng c\u00f3 trong MST. Gi\u1ea3 s\u1eed c\u1ea1nh \u0111\u01b0\u1ee3c ch\u1ecdn \u0111\u1ea7u ti\u00ean l\u00e0 c\u1ea1nh $(u, v)$ v\u1edbi tr\u1ecdng s\u1ed1 36. Th\u00eam c\u1ea1nh n\u00e0y v\u00e0o c\u00e2y t\u1ea1o th\u00e0nh m\u1ed9t chu tr\u00ecnh 36 - 7 - 2 - 34.</p> <p>B\u00e2y gi\u1edd ch\u00fang ta s\u1ebd t\u00ecm c\u1ea1nh c\u00f3 tr\u1ecdng s\u1ed1 l\u1edbn nh\u1ea5t trong chu tr\u00ecnh n\u00e0y b\u1eb1ng c\u00e1ch t\u00ecm $\\text{LCA}(u, v) = p$. Ch\u00fang ta t\u00ednh tr\u1ecdng s\u1ed1 c\u1ea1nh l\u1edbn nh\u1ea5t tr\u00ean c\u00e1c \u0111\u01b0\u1eddng \u0111i t\u1eeb $u$ \u0111\u1ebfn $p$ v\u00e0 t\u1eeb $v$ \u0111\u1ebfn $p$. L\u01b0u \u00fd: $\\text{LCA}(u, v)$ c\u0169ng c\u00f3 th\u1ec3 b\u1eb1ng $u$ ho\u1eb7c $v$ trong m\u1ed9t s\u1ed1 tr\u01b0\u1eddng h\u1ee3p. Trong v\u00ed d\u1ee5 n\u00e0y, ch\u00fang ta s\u1ebd nh\u1eadn \u0111\u01b0\u1ee3c c\u1ea1nh c\u00f3 tr\u1ecdng s\u1ed1 34 l\u00e0 tr\u1ecdng s\u1ed1 c\u1ea1nh l\u1edbn nh\u1ea5t trong chu tr\u00ecnh. B\u1eb1ng c\u00e1ch lo\u1ea1i b\u1ecf c\u1ea1nh n\u00e0y, ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c m\u1ed9t c\u00e2y khung m\u1edbi, c\u00f3 hi\u1ec7u tr\u1ecdng s\u1ed1 ch\u1ec9 l\u00e0 2.</p> <p>Sau khi th\u1ef1c hi\u1ec7n \u0111i\u1ec1u n\u00e0y v\u1edbi t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh kh\u00e1c kh\u00f4ng ph\u1ea3i l\u00e0 m\u1ed9t ph\u1ea7n c\u1ee7a MST ban \u0111\u1ea7u, ch\u00fang ta c\u00f3 th\u1ec3 th\u1ea5y r\u1eb1ng c\u00e2y khung n\u00e0y c\u0169ng l\u00e0 c\u00e2y khung t\u1ed1t th\u1ee9 hai n\u00f3i chung. Ch\u1ecdn c\u1ea1nh c\u00f3 tr\u1ecdng s\u1ed1 14 s\u1ebd t\u0103ng tr\u1ecdng s\u1ed1 c\u1ee7a c\u00e2y l\u00ean 7, ch\u1ecdn c\u1ea1nh c\u00f3 tr\u1ecdng s\u1ed1 27 t\u0103ng l\u00ean 14, ch\u1ecdn c\u1ea1nh c\u00f3 tr\u1ecdng s\u1ed1 28 t\u0103ng l\u00ean 21, v\u00e0 ch\u1ecdn c\u1ea1nh c\u00f3 tr\u1ecdng s\u1ed1 39 s\u1ebd t\u0103ng c\u00e2y l\u00ean 5.</p>","tags":["Translated"]},{"location":"graph/second_best_mst.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<pre><code>struct edge {\n    int s, e, w, id;\n    bool operator&lt;(const struct edge&amp; other) { return w &lt; other.w; }\n};\ntypedef struct edge Edge;\n\nconst int N = 2e5 + 5;\nlong long res = 0, ans = 1e18;\nint n, m, a, b, w, id, l = 21;\nvector&lt;Edge&gt; edges;\nvector&lt;int&gt; h(N, 0), parent(N, -1), size(N, 0), present(N, 0);\nvector&lt;vector&lt;pair&lt;int, int&gt;&gt;&gt; adj(N), dp(N, vector&lt;pair&lt;int, int&gt;&gt;(l));\nvector&lt;vector&lt;int&gt;&gt; up(N, vector&lt;int&gt;(l, -1));\n\npair&lt;int, int&gt; combine(pair&lt;int, int&gt; a, pair&lt;int, int&gt; b) {\n    vector&lt;int&gt; v = {a.first, a.second, b.first, b.second};\n    int topTwo = -3, topOne = -2;\n    for (int c : v) {\n        if (c &gt; topOne) {\n            topTwo = topOne;\n            topOne = c;\n        } else if (c &gt; topTwo &amp;&amp; c &lt; topOne) {\n            topTwo = c;\n        }\n    }\n    return {topOne, topTwo};\n}\n\nvoid dfs(int u, int par, int d) {\n    h[u] = 1 + h[par];\n    up[u][0] = par;\n    dp[u][0] = {d, -1};\n    for (auto v : adj[u]) {\n        if (v.first != par) {\n            dfs(v.first, u, v.second);\n        }\n    }\n}\n\npair&lt;int, int&gt; lca(int u, int v) {\n    pair&lt;int, int&gt; ans = {-2, -3};\n    if (h[u] &lt; h[v]) {\n        swap(u, v);\n    }\n    for (int i = l - 1; i &gt;= 0; i--) {\n        if (h[u] - h[v] &gt;= (1 &lt;&lt; i)) {\n            ans = combine(ans, dp[u][i]);\n            u = up[u][i];\n        }\n    }\n    if (u == v) {\n        return ans;\n    }\n    for (int i = l - 1; i &gt;= 0; i--) {\n        if (up[u][i] != -1 &amp;&amp; up[v][i] != -1 &amp;&amp; up[u][i] != up[v][i]) {\n            ans = combine(ans, combine(dp[u][i], dp[v][i]));\n            u = up[u][i];\n            v = up[v][i];\n        }\n    }\n    ans = combine(ans, combine(dp[u][0], dp[v][0]));\n    return ans;\n}\n\nint main(void) {\n    cin &gt;&gt; n &gt;&gt; m;\n    for (int i = 1; i &lt;= n; i++) {\n        parent[i] = i;\n        size[i] = 1;\n    }\n    for (int i = 1; i &lt;= m; i++) {\n        cin &gt;&gt; a &gt;&gt; b &gt;&gt; w; // 1-indexed\n        edges.push_back({a, b, w, i - 1});\n    }\n    sort(edges.begin(), edges.end());\n    for (int i = 0; i &lt;= m - 1; i++) {\n        a = edges[i].s;\n        b = edges[i].e;\n        w = edges[i].w;\n        id = edges[i].id;\n        if (unite_set(a, b)) { \n            adj[a].emplace_back(b, w);\n            adj[b].emplace_back(a, w);\n            present[id] = 1;\n            res += w;\n        }\n    }\n    dfs(1, 0, 0);\n    for (int i = 1; i &lt;= l - 1; i++) {\n        for (int j = 1; j &lt;= n; ++j) {\n            if (up[j][i - 1] != -1) {\n                int v = up[j][i - 1];\n                up[j][i] = up[v][i - 1];\n                dp[j][i] = combine(dp[j][i - 1], dp[v][i - 1]);\n            }\n        }\n    }\n    for (int i = 0; i &lt;= m - 1; i++) {\n        id = edges[i].id;\n        w = edges[i].w;\n        if (!present[id]) {\n            auto rem = lca(edges[i].s, edges[i].e);\n            if (rem.first != w) {\n                if (ans &gt; res + w - rem.first) {\n                    ans = res + w - rem.first;\n                }\n            } else if (rem.second != -1) {\n                if (ans &gt; res + w - rem.second) {\n                    ans = res + w - rem.second;\n                }\n            }\n        }\n    }\n    cout &lt;&lt; ans &lt;&lt; \"\\n\";\n    return 0;\n}\n</code></pre>","tags":["Translated"]},{"location":"graph/second_best_mst.html#references","title":"T\u00e0i li\u1ec7u tham kh\u1ea3o (References)","text":"<ol> <li>Competitive Programming-3, by Steven Halim</li> <li>web.mit.edu</li> </ol>","tags":["Translated"]},{"location":"graph/second_best_mst.html#problems","title":"B\u00e0i t\u1eadp (Problems)","text":"<ul> <li>Codeforces - Minimum spanning tree for each edge</li> </ul>","tags":["Translated"]},{"location":"graph/strong-orientation.html","title":"\u0110\u1ecbnh h\u01b0\u1edbng m\u1ea1nh (Strong Orientation)","text":"<p>M\u1ed9t \u0111\u1ecbnh h\u01b0\u1edbng m\u1ea1nh c\u1ee7a m\u1ed9t \u0111\u1ed3 th\u1ecb v\u00f4 h\u01b0\u1edbng l\u00e0 m\u1ed9t ph\u00e9p g\u00e1n h\u01b0\u1edbng cho m\u1ed7i c\u1ea1nh sao cho n\u00f3 tr\u1edf th\u00e0nh m\u1ed9t \u0111\u1ed3 th\u1ecb li\u00ean th\u00f4ng m\u1ea1nh. Ngh\u0129a l\u00e0, sau khi \u0111\u1ecbnh h\u01b0\u1edbng ch\u00fang ta c\u00f3 th\u1ec3 th\u0103m b\u1ea5t k\u1ef3 \u0111\u1ec9nh n\u00e0o t\u1eeb b\u1ea5t k\u1ef3 \u0111\u1ec9nh n\u00e0o b\u1eb1ng c\u00e1ch \u0111i theo c\u00e1c c\u1ea1nh c\u00f3 h\u01b0\u1edbng.</p>","tags":["Translated"]},{"location":"graph/strong-orientation.html#solution","title":"Gi\u1ea3i ph\u00e1p (Solution)","text":"<p>T\u1ea5t nhi\u00ean, \u0111i\u1ec1u n\u00e0y kh\u00f4ng th\u1ec3 th\u1ef1c hi\u1ec7n \u0111\u01b0\u1ee3c v\u1edbi m\u1ecdi \u0111\u1ed3 th\u1ecb. H\u00e3y xem x\u00e9t m\u1ed9t c\u1ea7u (bridge) trong m\u1ed9t \u0111\u1ed3 th\u1ecb. Ch\u00fang ta ph\u1ea3i g\u00e1n m\u1ed9t h\u01b0\u1edbng cho n\u00f3 v\u00e0 b\u1eb1ng c\u00e1ch l\u00e0m nh\u01b0 v\u1eady, ch\u00fang ta l\u00e0m cho c\u1ea7u n\u00e0y ch\u1ec9 c\u00f3 th\u1ec3 \"\u0111i qua\" theo m\u1ed9t h\u01b0\u1edbng. \u0110i\u1ec1u \u0111\u00f3 c\u00f3 ngh\u0129a l\u00e0 ch\u00fang ta kh\u00f4ng th\u1ec3 \u0111i t\u1eeb m\u1ed9t \u0111\u1ea7u c\u1ee7a c\u1ea7u \u0111\u1ebfn \u0111\u1ea7u kia, v\u00ec v\u1eady ch\u00fang ta kh\u00f4ng th\u1ec3 l\u00e0m cho \u0111\u1ed3 th\u1ecb li\u00ean th\u00f4ng m\u1ea1nh.</p> <p>B\u00e2y gi\u1edd h\u00e3y xem x\u00e9t m\u1ed9t DFS qua m\u1ed9t \u0111\u1ed3 th\u1ecb li\u00ean th\u00f4ng kh\u00f4ng c\u00f3 c\u1ea7u. R\u00f5 r\u00e0ng, ch\u00fang ta s\u1ebd th\u0103m m\u1ed7i \u0111\u1ec9nh. V\u00e0 v\u00ec kh\u00f4ng c\u00f3 c\u1ea7u, ch\u00fang ta c\u00f3 th\u1ec3 lo\u1ea1i b\u1ecf b\u1ea5t k\u1ef3 c\u1ea1nh c\u00e2y DFS n\u00e0o v\u00e0 v\u1eabn c\u00f3 th\u1ec3 \u0111i t\u1eeb b\u00ean d\u01b0\u1edbi c\u1ea1nh \u0111\u1ebfn b\u00ean tr\u00ean c\u1ea1nh b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng m\u1ed9t \u0111\u01b0\u1eddng \u0111i ch\u1ee9a \u00edt nh\u1ea5t m\u1ed9t c\u1ea1nh ng\u01b0\u1ee3c. T\u1eeb \u0111\u00f3 suy ra r\u1eb1ng t\u1eeb b\u1ea5t k\u1ef3 \u0111\u1ec9nh n\u00e0o ch\u00fang ta c\u00f3 th\u1ec3 \u0111i \u0111\u1ebfn g\u1ed1c c\u1ee7a c\u00e2y DFS. Ngo\u00e0i ra, t\u1eeb g\u1ed1c c\u1ee7a c\u00e2y DFS ch\u00fang ta c\u00f3 th\u1ec3 th\u0103m b\u1ea5t k\u1ef3 \u0111\u1ec9nh n\u00e0o ch\u00fang ta ch\u1ecdn. Ch\u00fang ta \u0111\u00e3 t\u00ecm th\u1ea5y m\u1ed9t \u0111\u1ecbnh h\u01b0\u1edbng m\u1ea1nh!</p> <p>N\u00f3i c\u00e1ch kh\u00e1c, \u0111\u1ec3 \u0111\u1ecbnh h\u01b0\u1edbng m\u1ea1nh m\u1ed9t \u0111\u1ed3 th\u1ecb li\u00ean th\u00f4ng kh\u00f4ng c\u00f3 c\u1ea7u, h\u00e3y ch\u1ea1y m\u1ed9t DFS tr\u00ean n\u00f3 v\u00e0 \u0111\u1ec3 c\u00e1c c\u1ea1nh c\u00e2y DFS h\u01b0\u1edbng ra xa kh\u1ecfi g\u1ed1c DFS v\u00e0 t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh kh\u00e1c t\u1eeb h\u1eadu du\u1ec7 \u0111\u1ebfn t\u1ed5 ti\u00ean trong c\u00e2y DFS.</p> <p>K\u1ebft qu\u1ea3 cho th\u1ea5y r\u1eb1ng c\u00e1c \u0111\u1ed3 th\u1ecb li\u00ean th\u00f4ng kh\u00f4ng c\u00f3 c\u1ea7u ch\u00ednh x\u00e1c l\u00e0 c\u00e1c \u0111\u1ed3 th\u1ecb c\u00f3 \u0111\u1ecbnh h\u01b0\u1edbng m\u1ea1nh \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 \u0111\u1ecbnh l\u00fd Robbins.</p>","tags":["Translated"]},{"location":"graph/strong-orientation.html#problem-extension","title":"M\u1edf r\u1ed9ng b\u00e0i to\u00e1n (Problem extension)","text":"<p>H\u00e3y xem x\u00e9t b\u00e0i to\u00e1n t\u00ecm \u0111\u1ecbnh h\u01b0\u1edbng \u0111\u1ed3 th\u1ecb sao cho s\u1ed1 l\u01b0\u1ee3ng SCC l\u00e0 t\u1ed1i thi\u1ec3u.</p> <p>T\u1ea5t nhi\u00ean, m\u1ed7i th\u00e0nh ph\u1ea7n \u0111\u1ed3 th\u1ecb c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c xem x\u00e9t ri\u00eang bi\u1ec7t. B\u00e2y gi\u1edd, v\u00ec ch\u1ec9 c\u00e1c \u0111\u1ed3 th\u1ecb kh\u00f4ng c\u00f3 c\u1ea7u m\u1edbi c\u00f3 th\u1ec3 \u0111\u1ecbnh h\u01b0\u1edbng m\u1ea1nh, h\u00e3y t\u1ea1m th\u1eddi lo\u1ea1i b\u1ecf t\u1ea5t c\u1ea3 c\u00e1c c\u1ea7u. Ch\u00fang ta k\u1ebft th\u00fac v\u1edbi m\u1ed9t s\u1ed1 l\u01b0\u1ee3ng c\u00e1c th\u00e0nh ph\u1ea7n kh\u00f4ng c\u00f3 c\u1ea7u (ch\u00ednh x\u00e1c l\u00e0 c\u00f3 bao nhi\u00eau th\u00e0nh ph\u1ea7n l\u00fac \u0111\u1ea7u + c\u00f3 bao nhi\u00eau c\u1ea7u)  v\u00e0 ch\u00fang ta bi\u1ebft r\u1eb1ng ch\u00fang ta c\u00f3 th\u1ec3 \u0111\u1ecbnh h\u01b0\u1edbng m\u1ea1nh m\u1ed7i th\u00e0nh ph\u1ea7n \u0111\u00f3.</p> <p>Ch\u00fang ta ch\u1ec9 \u0111\u01b0\u1ee3c ph\u00e9p \u0111\u1ecbnh h\u01b0\u1edbng c\u00e1c c\u1ea1nh, kh\u00f4ng \u0111\u01b0\u1ee3c lo\u1ea1i b\u1ecf ch\u00fang, nh\u01b0ng h\u00f3a ra ch\u00fang ta c\u00f3 th\u1ec3 \u0111\u1ecbnh h\u01b0\u1edbng c\u00e1c c\u1ea7u m\u1ed9t c\u00e1ch t\u00f9y \u00fd. T\u1ea5t nhi\u00ean, c\u00e1ch d\u1ec5 nh\u1ea5t \u0111\u1ec3 \u0111\u1ecbnh h\u01b0\u1edbng ch\u00fang l\u00e0 ch\u1ea1y thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 \u1edf tr\u00ean m\u00e0 kh\u00f4ng s\u1eeda \u0111\u1ed5i tr\u00ean m\u1ed7i th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng ban \u0111\u1ea7u.</p>","tags":["Translated"]},{"location":"graph/strong-orientation.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>\u1ede \u0111\u00e2y, \u0111\u1ea7u v\u00e0o l\u00e0 n \u2014 s\u1ed1 l\u01b0\u1ee3ng \u0111\u1ec9nh, m \u2014 s\u1ed1 l\u01b0\u1ee3ng c\u1ea1nh, sau \u0111\u00f3 m d\u00f2ng m\u00f4 t\u1ea3 c\u00e1c c\u1ea1nh.</p> <p>\u0110\u1ea7u ra l\u00e0 s\u1ed1 l\u01b0\u1ee3ng t\u1ed1i thi\u1ec3u c\u00e1c SCC tr\u00ean d\u00f2ng \u0111\u1ea7u ti\u00ean v\u00e0 tr\u00ean d\u00f2ng th\u1ee9 hai l\u00e0 m\u1ed9t chu\u1ed7i g\u1ed3m m k\u00fd t\u1ef1, ho\u1eb7c <code>&gt;</code> \u2014 cho ch\u00fang ta bi\u1ebft r\u1eb1ng c\u1ea1nh t\u01b0\u01a1ng \u1ee9ng t\u1eeb \u0111\u1ea7u v\u00e0o \u0111\u01b0\u1ee3c \u0111\u1ecbnh h\u01b0\u1edbng t\u1eeb \u0111\u1ec9nh b\u00ean tr\u00e1i sang \u0111\u1ec9nh b\u00ean ph\u1ea3i (nh\u01b0 trong \u0111\u1ea7u v\u00e0o), ho\u1eb7c <code>&lt;</code> \u2014 ng\u01b0\u1ee3c l\u1ea1i.</p> <p>\u0110\u00e2y l\u00e0 m\u1ed9t thu\u1eadt to\u00e1n t\u00ecm ki\u1ebfm c\u1ea7u \u0111\u01b0\u1ee3c s\u1eeda \u0111\u1ed5i \u0111\u1ec3 c\u0169ng \u0111\u1ecbnh h\u01b0\u1edbng c\u00e1c c\u1ea1nh, b\u1ea1n c\u0169ng c\u00f3 th\u1ec3 \u0111\u1ecbnh h\u01b0\u1edbng c\u00e1c c\u1ea1nh nh\u01b0 m\u1ed9t b\u01b0\u1edbc \u0111\u1ea7u ti\u00ean v\u00e0 \u0111\u1ebfm c\u00e1c SCC tr\u00ean \u0111\u1ed3 th\u1ecb c\u00f3 h\u01b0\u1edbng nh\u01b0 m\u1ed9t b\u01b0\u1edbc th\u1ee9 hai.</p> <pre><code>vector&lt;vector&lt;pair&lt;int, int&gt;&gt;&gt; adj; // adjacency list - vertex and edge pairs\nvector&lt;pair&lt;int, int&gt;&gt; edges;\n\nvector&lt;int&gt; tin, low;\nint bridge_cnt;\nstring orient;\nvector&lt;bool&gt; edge_used;\nvoid find_bridges(int v) {\n    static int time = 0;\n    low[v] = tin[v] = time++;\n    for (auto p : adj[v]) {\n        if (edge_used[p.second]) continue;\n        edge_used[p.second] = true;\n        orient[p.second] = v == edges[p.second].first ? '&gt;' : '&lt;';\n        int nv = p.first;\n        if (tin[nv] == -1) { // if nv is not visited yet\n            find_bridges(nv);\n            low[v] = min(low[v], low[nv]);\n            if (low[nv] &gt; tin[v]) {\n                // a bridge between v and nv\n                bridge_cnt++;\n            }\n        } else {\n            low[v] = min(low[v], tin[nv]);\n        }\n    }\n}\n\nint main() {\n    int n, m;\n    scanf(\"%d %d\", &amp;n, &amp;m);\n    adj.resize(n);\n    tin.resize(n, -1);\n    low.resize(n, -1);\n    orient.resize(m);\n    edges.resize(m);\n    edge_used.resize(m);\n    for (int i = 0; i &lt; m; i++) {\n        int a, b;\n        scanf(\"%d %d\", &amp;a, &amp;b);\n        a--; b--;\n        adj[a].push_back({b, i});\n        adj[b].push_back({a, i});\n        edges[i] = {a, b};\n    }\n    int comp_cnt = 0;\n    for (int v = 0; v &lt; n; v++) {\n        if (tin[v] == -1) {\n            comp_cnt++;\n            find_bridges(v);\n        }\n    }\n    printf(\"%d\\n%s\\n\", comp_cnt + bridge_cnt, orient.c_str());\n}\n</code></pre>","tags":["Translated"]},{"location":"graph/strong-orientation.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>26th Polish OI - Osiedla</li> </ul>","tags":["Translated"]},{"location":"graph/strongly-connected-components.html","title":"Th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh v\u00e0 \u0111\u1ed3 th\u1ecb n\u00e9n (Strongly connected components and the condensation graph)","text":"","tags":["Translated"]},{"location":"graph/strongly-connected-components.html#definitions","title":"\u0110\u1ecbnh ngh\u0129a (Definitions)","text":"<p>Cho $G=(V,E)$ l\u00e0 m\u1ed9t \u0111\u1ed3 th\u1ecb c\u00f3 h\u01b0\u1edbng v\u1edbi c\u00e1c \u0111\u1ec9nh $V$ v\u00e0 c\u00e1c c\u1ea1nh $E \\subseteq V \\times V$. Ch\u00fang ta k\u00fd hi\u1ec7u $n=|V|$ l\u00e0 s\u1ed1 l\u01b0\u1ee3ng \u0111\u1ec9nh v\u00e0 $m=|E|$ l\u00e0 s\u1ed1 l\u01b0\u1ee3ng c\u1ea1nh trong $G$. R\u1ea5t d\u1ec5 d\u00e0ng \u0111\u1ec3 m\u1edf r\u1ed9ng t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ecbnh ngh\u0129a trong b\u00e0i vi\u1ebft n\u00e0y cho \u0111a \u0111\u1ed3 th\u1ecb, nh\u01b0ng ch\u00fang ta s\u1ebd kh\u00f4ng t\u1eadp trung v\u00e0o \u0111i\u1ec1u \u0111\u00f3.</p> <p>M\u1ed9t t\u1eadp h\u1ee3p con c\u00e1c \u0111\u1ec9nh $C \\subseteq V$ \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 m\u1ed9t th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh n\u1ebfu c\u00e1c \u0111i\u1ec1u ki\u1ec7n sau \u0111\u01b0\u1ee3c th\u1ecfa m\u00e3n:</p> <ul> <li>v\u1edbi m\u1ecdi $u,v\\in C$, n\u1ebfu $u \\neq v$ t\u1ed3n t\u1ea1i m\u1ed9t \u0111\u01b0\u1eddng \u0111i t\u1eeb $u$ \u0111\u1ebfn $v$ v\u00e0 m\u1ed9t \u0111\u01b0\u1eddng \u0111i t\u1eeb $v$ \u0111\u1ebfn $u$, v\u00e0</li> <li>$C$ l\u00e0 c\u1ef1c \u0111\u1ea1i, theo ngh\u0129a l\u00e0 kh\u00f4ng c\u00f3 \u0111\u1ec9nh n\u00e0o c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u00eam v\u00e0o m\u00e0 kh\u00f4ng vi ph\u1ea1m \u0111i\u1ec1u ki\u1ec7n tr\u00ean.</li> </ul> <p>Ch\u00fang ta k\u00fd hi\u1ec7u $\\text{SCC}(G)$ l\u00e0 t\u1eadp h\u1ee3p c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh c\u1ee7a $G$. C\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh n\u00e0y kh\u00f4ng giao nhau, v\u00e0 bao ph\u1ee7 t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh trong \u0111\u1ed3 th\u1ecb. Do \u0111\u00f3, t\u1eadp h\u1ee3p $\\text{SCC}(G)$ l\u00e0 m\u1ed9t ph\u00e2n ho\u1ea1ch c\u1ee7a $V$.</p> <p>Xem x\u00e9t \u0111\u1ed3 th\u1ecb $G_\\text{example}$ n\u00e0y, trong \u0111\u00f3 c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh \u0111\u01b0\u1ee3c l\u00e0m n\u1ed5i b\u1eadt:</p> <p>\u1ede \u0111\u00e2y ch\u00fang ta c\u00f3 $\\text{SCC}(G_\\text{example})=\\{\\{0,7\\},\\{1,2,3,5,6\\},\\{4,9\\},\\{8\\}\\}.$ Ch\u00fang ta c\u00f3 th\u1ec3 x\u00e1c nh\u1eadn r\u1eb1ng trong m\u1ed7i th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh, t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh \u0111\u1ec1u c\u00f3 th\u1ec3 truy c\u1eadp \u0111\u01b0\u1ee3c t\u1eeb nhau.</p> <p>Ch\u00fang ta \u0111\u1ecbnh ngh\u0129a \u0111\u1ed3 th\u1ecb n\u00e9n (condensation graph) $G^{\\text{SCC}}=(V^{\\text{SCC}}, E^{\\text{SCC}})$ nh\u01b0 sau:</p> <ul> <li>c\u00e1c \u0111\u1ec9nh c\u1ee7a $G^{\\text{SCC}}$ l\u00e0 c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh c\u1ee7a $G$; t\u1ee9c l\u00e0, $V^{\\text{SCC}} = \\text{SCC}(G)$, v\u00e0</li> <li>\u0111\u1ed1i v\u1edbi t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh $C_i,C_j$ c\u1ee7a \u0111\u1ed3 th\u1ecb n\u00e9n, c\u00f3 m\u1ed9t c\u1ea1nh t\u1eeb $C_i$ \u0111\u1ebfn $C_j$ khi v\u00e0 ch\u1ec9 khi $C_i \\neq C_j$ v\u00e0 t\u1ed3n t\u1ea1i $a\\in C_i$ v\u00e0 $b\\in C_j$ sao cho c\u00f3 m\u1ed9t c\u1ea1nh t\u1eeb $a$ \u0111\u1ebfn $b$ trong $G$.</li> </ul> <p>\u0110\u1ed3 th\u1ecb n\u00e9n c\u1ee7a $G_\\text{example}$ tr\u00f4ng nh\u01b0 sau:</p> <p>Thu\u1ed9c t\u00ednh quan tr\u1ecdng nh\u1ea5t c\u1ee7a \u0111\u1ed3 th\u1ecb n\u00e9n l\u00e0 n\u00f3 kh\u00f4ng c\u00f3 chu tr\u00ecnh (acyclic). Th\u1eadt v\u1eady, kh\u00f4ng c\u00f3 'v\u00f2ng t\u1ef1 th\u00e2n' (self-loops) n\u00e0o trong \u0111\u1ed3 th\u1ecb n\u00e9n theo \u0111\u1ecbnh ngh\u0129a, v\u00e0 n\u1ebfu c\u00f3 m\u1ed9t chu tr\u00ecnh \u0111i qua hai ho\u1eb7c nhi\u1ec1u \u0111\u1ec9nh (th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh) trong \u0111\u1ed3 th\u1ecb n\u00e9n, th\u00ec do t\u00ednh kh\u1ea3 truy, h\u1ee3p c\u1ee7a c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh n\u00e0y s\u1ebd l\u00e0 m\u1ed9t th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh: m\u00e2u thu\u1eabn.</p> <p>Thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 trong ph\u1ea7n ti\u1ebfp theo t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh trong m\u1ed9t \u0111\u1ed3 th\u1ecb \u0111\u00e3 cho. Sau \u0111\u00f3, \u0111\u1ed3 th\u1ecb n\u00e9n c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c x\u00e2y d\u1ef1ng.</p>","tags":["Translated"]},{"location":"graph/strongly-connected-components.html#kosarajus-algorithm","title":"Thu\u1eadt to\u00e1n c\u1ee7a Kosaraju (Kosaraju's algorithm)","text":"","tags":["Translated"]},{"location":"graph/strongly-connected-components.html#mo-ta-thuat-toan-description-of-the-algorithm","title":"M\u00f4 t\u1ea3 thu\u1eadt to\u00e1n (Description of the algorithm)","text":"<p>Thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 \u0111\u00e3 \u0111\u01b0\u1ee3c \u0111\u1ec1 xu\u1ea5t \u0111\u1ed9c l\u1eadp b\u1edfi Kosaraju v\u00e0 Sharir v\u00e0o kho\u1ea3ng n\u0103m 1980. N\u00f3 d\u1ef1a tr\u00ean hai lo\u1ea1t t\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u, v\u1edbi th\u1eddi gian ch\u1ea1y l\u00e0 $O(n + m)$.</p> <p>Trong b\u01b0\u1edbc \u0111\u1ea7u ti\u00ean c\u1ee7a thu\u1eadt to\u00e1n, ch\u00fang ta th\u1ef1c hi\u1ec7n m\u1ed9t chu\u1ed7i c\u00e1c t\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u (<code>dfs</code>), th\u0103m to\u00e0n b\u1ed9 \u0111\u1ed3 th\u1ecb. T\u1ee9c l\u00e0, mi\u1ec5n l\u00e0 v\u1eabn c\u00f2n c\u00e1c \u0111\u1ec9nh ch\u01b0a \u0111\u01b0\u1ee3c th\u0103m, ch\u00fang ta l\u1ea5y m\u1ed9t trong s\u1ed1 ch\u00fang, v\u00e0 b\u1eaft \u0111\u1ea7u m\u1ed9t t\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u t\u1eeb \u0111\u1ec9nh \u0111\u00f3. \u0110\u1ed1i v\u1edbi m\u1ed7i \u0111\u1ec9nh, ch\u00fang ta theo d\u00f5i th\u1eddi gian tho\u00e1t (exit time) $t_\\text{out}[v]$. \u0110\u00e2y l\u00e0 'd\u1ea5u th\u1eddi gian' m\u00e0 t\u1ea1i \u0111\u00f3 vi\u1ec7c th\u1ef1c thi <code>dfs</code> tr\u00ean \u0111\u1ec9nh $v$ k\u1ebft th\u00fac, t\u1ee9c l\u00e0 th\u1eddi \u0111i\u1ec3m m\u00e0 t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh c\u00f3 th\u1ec3 truy c\u1eadp t\u1eeb $v$ \u0111\u00e3 \u0111\u01b0\u1ee3c th\u0103m v\u00e0 thu\u1eadt to\u00e1n quay l\u1ea1i $v$. B\u1ed9 \u0111\u1ebfm d\u1ea5u th\u1eddi gian kh\u00f4ng n\u00ean \u0111\u01b0\u1ee3c \u0111\u1eb7t l\u1ea1i gi\u1eefa c\u00e1c l\u1ea7n g\u1ecdi li\u00ean ti\u1ebfp \u0111\u1ebfn <code>dfs</code>. Th\u1eddi gian tho\u00e1t \u0111\u00f3ng m\u1ed9t vai tr\u00f2 quan tr\u1ecdng trong thu\u1eadt to\u00e1n, \u0111i\u1ec1u n\u00e0y s\u1ebd tr\u1edf n\u00ean r\u00f5 r\u00e0ng khi ch\u00fang ta th\u1ea3o lu\u1eadn v\u1ec1 \u0111\u1ecbnh l\u00fd sau.</p> <p>\u0110\u1ea7u ti\u00ean, ch\u00fang ta \u0111\u1ecbnh ngh\u0129a th\u1eddi gian tho\u00e1t $t_\\text{out}[C]$ c\u1ee7a m\u1ed9t th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh $C$ l\u00e0 gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t c\u1ee7a c\u00e1c gi\u00e1 tr\u1ecb $t_\\text{out}[v]$ cho t\u1ea5t c\u1ea3 $v \\in C.$ H\u01a1n n\u1eefa, trong ch\u1ee9ng minh c\u1ee7a \u0111\u1ecbnh l\u00fd, ch\u00fang ta s\u1ebd \u0111\u1ec1 c\u1eadp \u0111\u1ebfn th\u1eddi gian v\u00e0o (entry time) $t_{\\text{in}}[v]$ cho m\u1ed7i \u0111\u1ec9nh $v\\in G$. S\u1ed1 $t_{\\text{in}}[v]$ \u0111\u1ea1i di\u1ec7n cho 'd\u1ea5u th\u1eddi gian' m\u00e0 t\u1ea1i \u0111\u00f3 h\u00e0m \u0111\u1ec7 quy <code>dfs</code> \u0111\u01b0\u1ee3c g\u1ecdi tr\u00ean \u0111\u1ec9nh $v$ trong b\u01b0\u1edbc \u0111\u1ea7u ti\u00ean c\u1ee7a thu\u1eadt to\u00e1n. \u0110\u1ed1i v\u1edbi m\u1ed9t th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh $C$, ch\u00fang ta \u0111\u1ecbnh ngh\u0129a $t_{\\text{in}}[C]$ l\u00e0 gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t c\u1ee7a c\u00e1c gi\u00e1 tr\u1ecb $t_{\\text{in}}[v]$ cho t\u1ea5t c\u1ea3 $v \\in C$.</p> <p>\u0110\u1ecbnh l\u00fd</p> <p>G\u1ecdi $C$ v\u00e0 $C'$ l\u00e0 hai th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh kh\u00e1c nhau, v\u00e0 gi\u1ea3 s\u1eed c\u00f3 m\u1ed9t c\u1ea1nh t\u1eeb $C$ \u0111\u1ebfn $C'$ trong \u0111\u1ed3 th\u1ecb n\u00e9n. Khi \u0111\u00f3, $t_\\text{out}[C] &gt; t_\\text{out}[C']$.</p> Ch\u1ee9ng minh <p>C\u00f3 hai tr\u01b0\u1eddng h\u1ee3p kh\u00e1c nhau, t\u00f9y thu\u1ed9c v\u00e0o th\u00e0nh ph\u1ea7n n\u00e0o s\u1ebd \u0111\u01b0\u1ee3c ti\u1ebfp c\u1eadn tr\u01b0\u1edbc b\u1edfi t\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u:</p> <ul> <li> <p>Tr\u01b0\u1eddng h\u1ee3p 1: th\u00e0nh ph\u1ea7n $C$ \u0111\u01b0\u1ee3c ti\u1ebfp c\u1eadn tr\u01b0\u1edbc (t\u1ee9c l\u00e0, $t_{\\text{in}}[C] &lt; t_{\\text{in}}[C']$). Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, t\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u th\u0103m m\u1ed9t \u0111\u1ec9nh $v \\in C$ t\u1ea1i m\u1ed9t th\u1eddi \u0111i\u1ec3m n\u00e0o \u0111\u00f3 m\u00e0 t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh kh\u00e1c c\u1ee7a c\u00e1c th\u00e0nh ph\u1ea7n $C$ v\u00e0 $C'$ ch\u01b0a \u0111\u01b0\u1ee3c th\u0103m. V\u00ec c\u00f3 m\u1ed9t c\u1ea1nh t\u1eeb $C$ \u0111\u1ebfn $C'$ trong \u0111\u1ed3 th\u1ecb n\u00e9n, kh\u00f4ng ch\u1ec9 t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh kh\u00e1c trong $C$ \u0111\u1ec1u c\u00f3 th\u1ec3 truy c\u1eadp \u0111\u01b0\u1ee3c t\u1eeb $v$ trong $G$, m\u00e0 t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh trong $C'$ c\u0169ng c\u00f3 th\u1ec3 truy c\u1eadp \u0111\u01b0\u1ee3c. \u0110i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 vi\u1ec7c th\u1ef1c thi <code>dfs</code> n\u00e0y, \u0111ang ch\u1ea1y t\u1eeb \u0111\u1ec9nh $v$, c\u0169ng s\u1ebd th\u0103m t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh kh\u00e1c c\u1ee7a c\u00e1c th\u00e0nh ph\u1ea7n $C$ v\u00e0 $C'$ trong t\u01b0\u01a1ng lai, v\u00ec v\u1eady c\u00e1c \u0111\u1ec9nh n\u00e0y s\u1ebd l\u00e0 h\u1eadu du\u1ec7 c\u1ee7a $v$ trong c\u00e2y t\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u. \u0110i\u1ec1u n\u00e0y ng\u1ee5 \u00fd r\u1eb1ng \u0111\u1ed1i v\u1edbi m\u1ed7i \u0111\u1ec9nh $u \\in (C \\cup C')\\setminus \\{v\\},$ ch\u00fang ta c\u00f3 $t_\\text{out}[v] &gt; t_\\text{out}[u]$. Do \u0111\u00f3, $t_\\text{out}[C] &gt; t_\\text{out}[C']$, ho\u00e0n th\u00e0nh tr\u01b0\u1eddng h\u1ee3p n\u00e0y c\u1ee7a ch\u1ee9ng minh.</p> </li> <li> <p>Tr\u01b0\u1eddng h\u1ee3p 2: th\u00e0nh ph\u1ea7n $C'$ \u0111\u01b0\u1ee3c ti\u1ebfp c\u1eadn tr\u01b0\u1edbc (t\u1ee9c l\u00e0, $t_{\\text{in}}[C] &gt; t_{\\text{in}}[C']$). Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, t\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u th\u0103m m\u1ed9t \u0111\u1ec9nh $v \\in C'$ t\u1ea1i m\u1ed9t th\u1eddi \u0111i\u1ec3m n\u00e0o \u0111\u00f3 m\u00e0 t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh kh\u00e1c c\u1ee7a c\u00e1c th\u00e0nh ph\u1ea7n $C$ v\u00e0 $C'$ ch\u01b0a \u0111\u01b0\u1ee3c th\u0103m. V\u00ec c\u00f3 m\u1ed9t c\u1ea1nh t\u1eeb $C$ \u0111\u1ebfn $C'$ trong \u0111\u1ed3 th\u1ecb n\u00e9n, $C$ kh\u00f4ng th\u1ec3 ti\u1ebfp c\u1eadn \u0111\u01b0\u1ee3c t\u1eeb $C'$, theo t\u00ednh ch\u1ea5t kh\u00f4ng c\u00f3 chu tr\u00ecnh. Do \u0111\u00f3, vi\u1ec7c th\u1ef1c thi <code>dfs</code> \u0111ang ch\u1ea1y t\u1eeb \u0111\u1ec9nh $v$ s\u1ebd kh\u00f4ng ti\u1ebfp c\u1eadn b\u1ea5t k\u1ef3 \u0111\u1ec9nh n\u00e0o c\u1ee7a $C$, nh\u01b0ng n\u00f3 s\u1ebd th\u0103m t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh c\u1ee7a $C'$. C\u00e1c \u0111\u1ec9nh c\u1ee7a $C$ s\u1ebd \u0111\u01b0\u1ee3c th\u0103m b\u1edfi m\u1ed9t s\u1ed1 l\u1ea7n th\u1ef1c thi <code>dfs</code> sau n\u00e0y trong b\u01b0\u1edbc n\u00e0y c\u1ee7a thu\u1eadt to\u00e1n, v\u00ec v\u1eady ch\u00fang ta th\u1ef1c s\u1ef1 c\u00f3 $t_\\text{out}[C] &gt; t_\\text{out}[C']$. \u0110i\u1ec1u n\u00e0y ho\u00e0n th\u00e0nh ch\u1ee9ng minh.</p> </li> </ul> <p>\u0110\u1ecbnh l\u00fd \u0111\u00e3 ch\u1ee9ng minh l\u00e0 r\u1ea5t quan tr\u1ecdng \u0111\u1ec3 t\u00ecm c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh. N\u00f3 c\u00f3 ngh\u0129a l\u00e0 b\u1ea5t k\u1ef3 c\u1ea1nh n\u00e0o trong \u0111\u1ed3 th\u1ecb n\u00e9n \u0111\u1ec1u \u0111i t\u1eeb m\u1ed9t th\u00e0nh ph\u1ea7n c\u00f3 gi\u00e1 tr\u1ecb $t_\\text{out}$ l\u1edbn h\u01a1n \u0111\u1ebfn m\u1ed9t th\u00e0nh ph\u1ea7n c\u00f3 gi\u00e1 tr\u1ecb nh\u1ecf h\u01a1n.</p> <p>N\u1ebfu ch\u00fang ta s\u1eafp x\u1ebfp t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh $v \\in V$ theo th\u1ee9 t\u1ef1 gi\u1ea3m d\u1ea7n c\u1ee7a th\u1eddi gian tho\u00e1t $t_\\text{out}[v]$, th\u00ec \u0111\u1ec9nh \u0111\u1ea7u ti\u00ean $u$ s\u1ebd thu\u1ed9c v\u1ec1 th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh \"g\u1ed1c\", kh\u00f4ng c\u00f3 c\u1ea1nh \u0111i v\u00e0o trong \u0111\u1ed3 th\u1ecb n\u00e9n. B\u00e2y gi\u1edd ch\u00fang ta mu\u1ed1n ch\u1ea1y m\u1ed9t lo\u1ea1i t\u00ecm ki\u1ebfm n\u00e0o \u0111\u00f3 t\u1eeb \u0111\u1ec9nh $u$ n\u00e0y sao cho n\u00f3 s\u1ebd th\u0103m t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh trong th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh c\u1ee7a n\u00f3, nh\u01b0ng kh\u00f4ng ph\u1ea3i c\u00e1c \u0111\u1ec9nh kh\u00e1c. B\u1eb1ng c\u00e1ch l\u1eb7p l\u1ea1i vi\u1ec7c n\u00e0y, ch\u00fang ta c\u00f3 th\u1ec3 d\u1ea7n d\u1ea7n t\u00ecm th\u1ea5y t\u1ea5t c\u1ea3 c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh: ch\u00fang ta lo\u1ea1i b\u1ecf t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh thu\u1ed9c v\u1ec1 th\u00e0nh ph\u1ea7n \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y \u0111\u1ea7u ti\u00ean, sau \u0111\u00f3 ch\u00fang ta t\u00ecm \u0111\u1ec9nh c\u00f2n l\u1ea1i ti\u1ebfp theo v\u1edbi gi\u00e1 tr\u1ecb $t_\\text{out}$ l\u1edbn nh\u1ea5t, v\u00e0 ch\u1ea1y t\u00ecm ki\u1ebfm n\u00e0y t\u1eeb n\u00f3, v\u00e0 c\u1ee9 th\u1ebf. Cu\u1ed1i c\u00f9ng, ch\u00fang ta s\u1ebd t\u00ecm th\u1ea5y t\u1ea5t c\u1ea3 c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh. \u0110\u1ec3 t\u00ecm m\u1ed9t ph\u01b0\u01a1ng ph\u00e1p t\u00ecm ki\u1ebfm ho\u1ea1t \u0111\u1ed9ng nh\u01b0 ch\u00fang ta mu\u1ed1n, ch\u00fang ta xem x\u00e9t \u0111\u1ecbnh l\u00fd sau:</p> <p>\u0110\u1ecbnh l\u00fd</p> <p>G\u1ecdi $G^T$ l\u00e0 \u0111\u1ed3 th\u1ecb chuy\u1ec3n v\u1ecb (transpose graph) c\u1ee7a $G$, thu \u0111\u01b0\u1ee3c b\u1eb1ng c\u00e1ch \u0111\u1ea3o ng\u01b0\u1ee3c h\u01b0\u1edbng c\u1ea1nh trong $G$. Khi \u0111\u00f3, $\\text{SCC}(G)=\\text{SCC}(G^T)$. H\u01a1n n\u1eefa, \u0111\u1ed3 th\u1ecb n\u00e9n c\u1ee7a $G^T$ l\u00e0 chuy\u1ec3n v\u1ecb c\u1ee7a \u0111\u1ed3 th\u1ecb n\u00e9n c\u1ee7a $G$.</p> <p>Ch\u1ee9ng minh \u0111\u01b0\u1ee3c b\u1ecf qua (nh\u01b0ng \u0111\u01a1n gi\u1ea3n). Nh\u01b0 m\u1ed9t h\u1ec7 qu\u1ea3 c\u1ee7a \u0111\u1ecbnh l\u00fd n\u00e0y, s\u1ebd kh\u00f4ng c\u00f3 c\u1ea1nh n\u00e0o t\u1eeb th\u00e0nh ph\u1ea7n \"g\u1ed1c\" \u0111\u1ebfn c\u00e1c th\u00e0nh ph\u1ea7n kh\u00e1c trong \u0111\u1ed3 th\u1ecb n\u00e9n c\u1ee7a $G^T$. Do \u0111\u00f3, \u0111\u1ec3 th\u0103m to\u00e0n b\u1ed9 th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh \"g\u1ed1c\", ch\u1ee9a \u0111\u1ec9nh $v$, ch\u00fang ta ch\u1ec9 c\u1ea7n ch\u1ea1y m\u1ed9t t\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u t\u1eeb \u0111\u1ec9nh $v$ trong \u0111\u1ed3 th\u1ecb chuy\u1ec3n v\u1ecb $G^T$! \u0110i\u1ec1u n\u00e0y s\u1ebd th\u0103m ch\u00ednh x\u00e1c t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh c\u1ee7a th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh n\u00e0y. Nh\u01b0 \u0111\u00e3 \u0111\u1ec1 c\u1eadp tr\u01b0\u1edbc \u0111\u00f3, sau \u0111\u00f3 ch\u00fang ta c\u00f3 th\u1ec3 lo\u1ea1i b\u1ecf c\u00e1c \u0111\u1ec9nh n\u00e0y kh\u1ecfi \u0111\u1ed3 th\u1ecb. Sau \u0111\u00f3, ch\u00fang ta t\u00ecm \u0111\u1ec9nh ti\u1ebfp theo v\u1edbi gi\u00e1 tr\u1ecb c\u1ef1c \u0111\u1ea1i c\u1ee7a $t_\\text{out}[v]$, v\u00e0 ch\u1ea1y t\u00ecm ki\u1ebfm trong \u0111\u1ed3 th\u1ecb chuy\u1ec3n v\u1ecb b\u1eaft \u0111\u1ea7u t\u1eeb \u0111\u1ec9nh \u0111\u00f3 \u0111\u1ec3 t\u00ecm th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh ti\u1ebfp theo. L\u1eb7p l\u1ea1i \u0111i\u1ec1u n\u00e0y, ch\u00fang ta t\u00ecm th\u1ea5y t\u1ea5t c\u1ea3 c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh.</p> <p>Do \u0111\u00f3, t\u00f3m l\u1ea1i, ch\u00fang ta \u0111\u00e3 th\u1ea3o lu\u1eadn v\u1ec1 thu\u1eadt to\u00e1n sau \u0111\u1ec3 t\u00ecm c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh:</p> <ul> <li> <p>B\u01b0\u1edbc 1. Ch\u1ea1y m\u1ed9t chu\u1ed7i c\u00e1c t\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u tr\u00ean $G$, s\u1ebd t\u1ea1o ra m\u1ed9t danh s\u00e1ch (v\u00ed d\u1ee5 <code>order</code>) c\u00e1c \u0111\u1ec9nh, \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp theo th\u1eddi gian tho\u00e1t $t_\\text{out}$ t\u0103ng d\u1ea7n.</p> </li> <li> <p>B\u01b0\u1edbc 2. X\u00e2y d\u1ef1ng \u0111\u1ed3 th\u1ecb chuy\u1ec3n v\u1ecb $G^T$, v\u00e0 ch\u1ea1y m\u1ed9t lo\u1ea1t c\u00e1c t\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u tr\u00ean c\u00e1c \u0111\u1ec9nh theo th\u1ee9 t\u1ef1 ng\u01b0\u1ee3c l\u1ea1i (t\u1ee9c l\u00e0, theo th\u1ee9 t\u1ef1 gi\u1ea3m d\u1ea7n c\u1ee7a th\u1eddi gian tho\u00e1t). M\u1ed7i t\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u s\u1ebd t\u1ea1o ra m\u1ed9t th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh.</p> </li> <li> <p>B\u01b0\u1edbc 3 (t\u00f9y ch\u1ecdn). X\u00e2y d\u1ef1ng \u0111\u1ed3 th\u1ecb n\u00e9n.</p> </li> </ul> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian ch\u1ea1y c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 $O(n + m)$, b\u1edfi v\u00ec t\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n hai l\u1ea7n. X\u00e2y d\u1ef1ng \u0111\u1ed3 th\u1ecb n\u00e9n c\u0169ng l\u00e0 $O(n+m).$</p> <p>Cu\u1ed1i c\u00f9ng, th\u1eadt th\u00edch h\u1ee3p \u0111\u1ec3 \u0111\u1ec1 c\u1eadp \u0111\u1ebfn s\u1eafp x\u1ebfp topo \u1edf \u0111\u00e2y. Trong b\u01b0\u1edbc 1, ch\u00fang ta t\u00ecm c\u00e1c \u0111\u1ec9nh theo th\u1ee9 t\u1ef1 th\u1eddi gian tho\u00e1t t\u0103ng d\u1ea7n. N\u1ebfu $G$ kh\u00f4ng c\u00f3 chu tr\u00ecnh, \u0111i\u1ec1u n\u00e0y t\u01b0\u01a1ng \u1ee9ng v\u1edbi m\u1ed9t s\u1eafp x\u1ebfp topo (ng\u01b0\u1ee3c) c\u1ee7a $G$. Trong b\u01b0\u1edbc 2, thu\u1eadt to\u00e1n t\u00ecm c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh theo th\u1ee9 t\u1ef1 gi\u1ea3m d\u1ea7n c\u1ee7a th\u1eddi gian tho\u00e1t. Do \u0111\u00f3, n\u00f3 t\u00ecm c\u00e1c th\u00e0nh ph\u1ea7n - c\u00e1c \u0111\u1ec9nh c\u1ee7a \u0111\u1ed3 th\u1ecb n\u00e9n - theo th\u1ee9 t\u1ef1 t\u01b0\u01a1ng \u1ee9ng v\u1edbi s\u1eafp x\u1ebfp topo c\u1ee7a \u0111\u1ed3 th\u1ecb n\u00e9n.</p>","tags":["Translated"]},{"location":"graph/strongly-connected-components.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<pre><code>vector&lt;bool&gt; visited; // theo d\u00f5i c\u00e1c \u0111\u1ec9nh \u0111\u00e3 \u0111\u01b0\u1ee3c th\u0103m\n\n// ch\u1ea1y t\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u b\u1eaft \u0111\u1ea7u t\u1ea1i \u0111\u1ec9nh v.\n// m\u1ed7i \u0111\u1ec9nh \u0111\u01b0\u1ee3c th\u0103m \u0111\u01b0\u1ee3c th\u00eam v\u00e0o vector \u0111\u1ea7u ra khi dfs r\u1eddi kh\u1ecfi n\u00f3.\nvoid dfs(int v, vector&lt;vector&lt;int&gt;&gt; const&amp; adj, vector&lt;int&gt; &amp;output) {\n    visited[v] = true;\n    for (auto u : adj[v])\n        if (!visited[u])\n            dfs(u, adj, output);\n    output.push_back(v);\n}\n\n// \u0111\u1ea7u v\u00e0o: adj -- danh s\u00e1ch k\u1ec1 c\u1ee7a G\n// \u0111\u1ea7u ra: components -- c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh trong G\n// \u0111\u1ea7u ra: adj_cond -- danh s\u00e1ch k\u1ec1 c\u1ee7a G^SCC (theo c\u00e1c \u0111\u1ec9nh g\u1ed1c)\nvoid strongly_connected_components(vector&lt;vector&lt;int&gt;&gt; const&amp; adj,\n                                  vector&lt;vector&lt;int&gt;&gt; &amp;components,\n                                  vector&lt;vector&lt;int&gt;&gt; &amp;adj_cond) {\n    int n = adj.size();\n    components.clear(), adj_cond.clear();\n\n    vector&lt;int&gt; order; // s\u1ebd l\u00e0 danh s\u00e1ch c\u00e1c \u0111\u1ec9nh c\u1ee7a G \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp theo th\u1eddi gian tho\u00e1t\n\n    visited.assign(n, false);\n\n    // chu\u1ed7i t\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u \u0111\u1ea7u ti\u00ean\n    for (int i = 0; i &lt; n; i++)\n        if (!visited[i])\n            dfs(i, adj, order);\n\n    // t\u1ea1o danh s\u00e1ch k\u1ec1 c\u1ee7a G^T\n    vector&lt;vector&lt;int&gt;&gt; adj_rev(n);\n    for (int v = 0; v &lt; n; v++)\n        for (int u : adj[v])\n            adj_rev[u].push_back(v);\n\n    visited.assign(n, false);\n    reverse(order.begin(), order.end());\n\n    vector&lt;int&gt; roots(n, 0); // cung c\u1ea5p \u0111\u1ec9nh g\u1ed1c c\u1ee7a SCC c\u1ee7a m\u1ed9t \u0111\u1ec9nh\n\n    // chu\u1ed7i t\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u th\u1ee9 hai\n    for (auto v : order)\n        if (!visited[v]) {\n            std::vector&lt;int&gt; component;\n            dfs(v, adj_rev, component);\n            components.push_back(component);\n            int root = *component.begin();\n            for (auto u : component)\n                roots[u] = root;\n        }\n\n    // th\u00eam c\u1ea1nh v\u00e0o \u0111\u1ed3 th\u1ecb n\u00e9n\n    adj_cond.assign(n, {});\n    for (int v = 0; v &lt; n; v++)\n        for (auto u : adj[v])\n            if (roots[v] != roots[u])\n                adj_cond[roots[v]].push_back(roots[u]);\n}\n</code></pre> <p>H\u00e0m <code>dfs</code> th\u1ef1c hi\u1ec7n t\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u. N\u00f3 nh\u1eadn \u0111\u1ea7u v\u00e0o l\u00e0 m\u1ed9t danh s\u00e1ch k\u1ec1 v\u00e0 m\u1ed9t \u0111\u1ec9nh b\u1eaft \u0111\u1ea7u. N\u00f3 c\u0169ng nh\u1eadn m\u1ed9t tham chi\u1ebfu \u0111\u1ebfn vector <code>output</code>: m\u1ed7i \u0111\u1ec9nh \u0111\u01b0\u1ee3c th\u0103m s\u1ebd \u0111\u01b0\u1ee3c th\u00eam v\u00e0o <code>output</code> khi <code>dfs</code> r\u1eddi kh\u1ecfi \u0111\u1ec9nh \u0111\u00f3.</p> <p>L\u01b0u \u00fd r\u1eb1ng ch\u00fang ta s\u1eed d\u1ee5ng h\u00e0m <code>dfs</code> c\u1ea3 trong b\u01b0\u1edbc \u0111\u1ea7u ti\u00ean v\u00e0 b\u01b0\u1edbc th\u1ee9 hai c\u1ee7a thu\u1eadt to\u00e1n. Trong b\u01b0\u1edbc \u0111\u1ea7u ti\u00ean, ch\u00fang ta truy\u1ec1n v\u00e0o danh s\u00e1ch k\u1ec1 c\u1ee7a $G$, v\u00e0 trong c\u00e1c l\u1ea7n g\u1ecdi li\u00ean ti\u1ebfp \u0111\u1ebfn <code>dfs</code>, ch\u00fang ta ti\u1ebfp t\u1ee5c truy\u1ec1n v\u00e0o c\u00f9ng m\u1ed9t 'vector \u0111\u1ea7u ra' <code>order</code>, \u0111\u1ec3 cu\u1ed1i c\u00f9ng ch\u00fang ta c\u00f3 \u0111\u01b0\u1ee3c m\u1ed9t danh s\u00e1ch c\u00e1c \u0111\u1ec9nh theo th\u1ee9 t\u1ef1 th\u1eddi gian tho\u00e1t t\u0103ng d\u1ea7n. Trong b\u01b0\u1edbc th\u1ee9 hai, ch\u00fang ta truy\u1ec1n v\u00e0o danh s\u00e1ch k\u1ec1 c\u1ee7a $G^T$, v\u00e0 trong m\u1ed7i l\u1ea7n g\u1ecdi, ch\u00fang ta truy\u1ec1n v\u00e0o m\u1ed9t 'vector \u0111\u1ea7u ra' tr\u1ed1ng <code>component</code>, vector n\u00e0y s\u1ebd cung c\u1ea5p cho ch\u00fang ta m\u1ed9t th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh t\u1ea1i m\u1ed9t th\u1eddi \u0111i\u1ec3m.</p>","tags":["Translated"]},{"location":"graph/strongly-connected-components.html#tarjans-strongly-connected-components-algorithm","title":"Thu\u1eadt to\u00e1n th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh c\u1ee7a Tarjan (Tarjan's strongly connected components algorithm)","text":"","tags":["Translated"]},{"location":"graph/strongly-connected-components.html#mo-ta-thuat-toan-description-of-the-algorithm_1","title":"M\u00f4 t\u1ea3 thu\u1eadt to\u00e1n (Description of the algorithm)","text":"<p>Thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 l\u1ea7n \u0111\u1ea7u ti\u00ean \u0111\u01b0\u1ee3c \u0111\u1ec1 xu\u1ea5t b\u1edfi Tarjan v\u00e0o n\u0103m 1972. N\u00f3 d\u1ef1a tr\u00ean vi\u1ec7c th\u1ef1c hi\u1ec7n m\u1ed9t chu\u1ed7i c\u00e1c cu\u1ed9c g\u1ecdi DFS, s\u1eed d\u1ee5ng th\u00f4ng tin v\u1ed1n c\u00f3 trong c\u1ea5u tr\u00fac c\u1ee7a n\u00f3 \u0111\u1ec3 x\u00e1c \u0111\u1ecbnh c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh (SCC), v\u1edbi th\u1eddi gian ch\u1ea1y l\u00e0 $O(n+m)$.</p> <p>Khi \u00e1p d\u1ee5ng DFS tr\u00ean m\u1ed9t \u0111\u1ec9nh, ch\u00fang ta s\u1ebd duy\u1ec7t qua danh s\u00e1ch k\u1ec1 c\u1ee7a n\u00f3, v\u00e0 trong tr\u01b0\u1eddng h\u1ee3p ch\u00fang ta t\u00ecm th\u1ea5y m\u1ed9t \u0111\u1ec9nh ch\u01b0a \u0111\u01b0\u1ee3c th\u0103m, ch\u00fang ta s\u1ebd \u00e1p d\u1ee5ng \u0111\u1ec7 quy DFS cho n\u00f3.</p> <p>H\u00e3y xem x\u00e9t c\u00e2y \u0111\u01b0\u1ee3c t\u1ea1o ra b\u1edfi chu\u1ed7i c\u00e1c cu\u1ed9c g\u1ecdi DFS, m\u00e0 ch\u00fang ta s\u1ebd g\u1ecdi l\u00e0 c\u00e2y DFS. Khi ch\u00fang ta l\u1ea7n \u0111\u1ea7u ti\u00ean g\u1ecdi m\u1ed9t DFS tr\u00ean m\u1ed9t \u0111\u1ec9nh t\u1eeb m\u1ed9t SCC, t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh c\u1ee7a SCC \u0111\u00f3 s\u1ebd \u0111\u01b0\u1ee3c th\u0103m tr\u01b0\u1edbc khi cu\u1ed9c g\u1ecdi n\u00e0y k\u1ebft th\u00fac, v\u00ec t\u1ea5t c\u1ea3 ch\u00fang \u0111\u1ec1u c\u00f3 th\u1ec3 truy c\u1eadp \u0111\u01b0\u1ee3c t\u1eeb nhau. Trong c\u00e2y DFS, \u0111\u1ec9nh \u0111\u1ea7u ti\u00ean n\u00e0y s\u1ebd l\u00e0 t\u1ed5 ti\u00ean chung cho t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh kh\u00e1c c\u1ee7a SCC; ch\u00fang ta \u0111\u1ecbnh ngh\u0129a \u0111\u1ec9nh n\u00e0y l\u00e0 g\u1ed1c c\u1ee7a SCC.</p> <p>\u0110\u1ecbnh l\u00fd</p> <p>T\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh c\u1ee7a m\u1ed9t SCC t\u1ea1o ra m\u1ed9t \u0111\u1ed3 th\u1ecb con li\u00ean th\u00f4ng c\u1ee7a c\u00e2y DFS.</p> Ch\u1ee9ng minh <p>Ch\u00fang ta \u0111\u00e3 x\u00e1c \u0111\u1ecbnh r\u1eb1ng t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh c\u1ee7a m\u1ed9t SCC c\u00f3 m\u1ed9t t\u1ed5 ti\u00ean chung, \u0111\u1ec9nh \u0111\u1ea7u ti\u00ean \u0111\u01b0\u1ee3c th\u0103m b\u1edfi m\u1ed9t cu\u1ed9c g\u1ecdi DFS. H\u00e3y xem x\u00e9t m\u1ed9t \u0111\u1ec9nh $v$ v\u00e0 g\u1ed1c c\u1ee7a n\u00f3, \u0111\u1ec9nh $r$. T\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh trong \u0111\u01b0\u1eddng \u0111i t\u1eeb $r$ \u0111\u1ebfn $v$ thu\u1ed9c v\u1ec1 c\u00f9ng m\u1ed9t SCC. T\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh n\u00e0y \u0111\u1ec1u c\u00f3 th\u1ec3 truy c\u1eadp \u0111\u01b0\u1ee3c t\u1eeb $r$, v\u00e0 t\u1ea5t c\u1ea3 ch\u00fang \u0111\u1ec1u ti\u1ebfp c\u1eadn \u0111\u01b0\u1ee3c $v$, v\u00e0 v\u00ec theo \u0111\u1ecbnh ngh\u0129a $v$ ti\u1ebfp c\u1eadn $r$, t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh n\u00e0y \u0111\u1ec1u ti\u1ebfp c\u1eadn \u0111\u01b0\u1ee3c nhau. V\u00ec t\u1ea5t c\u1ea3 c\u00e1c \u0111\u01b0\u1eddng \u0111i t\u1eeb m\u1ed9t g\u1ed1c \u0111\u1ebfn m\u1ecdi \u0111\u1ec9nh kh\u00e1c c\u1ee7a SCC thu\u1ed9c v\u1ec1 c\u00f9ng m\u1ed9t SCC, \u0111\u1ed3 th\u1ecb con \u0111\u01b0\u1ee3c h\u00ecnh th\u00e0nh l\u00e0 li\u00ean th\u00f4ng.</p> <p>L\u01b0u \u00fd r\u1eb1ng c\u00e1c SCC chia t\u00e1ch c\u00e2y DFS ho\u00e0n h\u1ea3o th\u00e0nh c\u00e1c \u0111\u1ed3 th\u1ecb con li\u00ean th\u00f4ng.</p> <p>\u00dd t\u01b0\u1edfng c\u1ee7a thu\u1eadt to\u00e1n sau \u0111\u00f3 l\u00e0 nh\u01b0 sau:</p> <ul> <li> <p>Ch\u00fang ta th\u1ef1c hi\u1ec7n m\u1ed9t chu\u1ed7i c\u00e1c cu\u1ed9c g\u1ecdi DFS, \u00e1p d\u1ee5ng \u0111\u1ec7 quy ch\u00fang cho c\u00e1c \u0111\u1ec9nh c\u1ee7a danh s\u00e1ch k\u1ec1.</p> </li> <li> <p>Khi ch\u00fang ta k\u1ebft th\u00fac vi\u1ec7c duy\u1ec7t danh s\u00e1ch k\u1ec1 c\u1ee7a m\u1ed9t \u0111\u1ec9nh, ch\u00fang ta b\u1eb1ng c\u00e1ch n\u00e0o \u0111\u00f3 c\u00f3 th\u1ec3 x\u00e1c \u0111\u1ecbnh xem n\u00f3 c\u00f3 ph\u1ea3i l\u00e0 g\u1ed1c hay kh\u00f4ng. Ph\u01b0\u01a1ng ph\u00e1p n\u00e0y s\u1ebd \u0111\u01b0\u1ee3c gi\u1ea3i th\u00edch sau.</p> </li> <li> <p>Trong tr\u01b0\u1eddng h\u1ee3p \u0111\u1ec9nh l\u00e0 g\u1ed1c, ch\u00fang ta sau \u0111\u00f3 s\u1ebd ngay l\u1eadp t\u1ee9c t\u00ecm v\u00e0 x\u00e1c nh\u1eadn t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh c\u1ee7a SCC c\u1ee7a n\u00f3.</p> </li> </ul> <p>Khi t\u1ea5t c\u1ea3 c\u00e1c cu\u1ed9c g\u1ecdi k\u1ebft th\u00fac, t\u1ea5t c\u1ea3 c\u00e1c g\u1ed1c s\u1ebd \u0111\u01b0\u1ee3c ph\u00e1t hi\u1ec7n v\u00e0 t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh s\u1ebd \u0111\u01b0\u1ee3c x\u00e1c nh\u1eadn l\u00e0 m\u1ed9t ph\u1ea7n c\u1ee7a m\u1ed9t s\u1ed1 SCC.</p> <p>B\u00e2y gi\u1edd ch\u00fang ta h\u00e3y ph\u00e2n t\u00edch c\u00e1c t\u00ednh ch\u1ea5t c\u1ee7a DFS khi quy tr\u00ecnh x\u00e1c nh\u1eadn n\u00e0y \u0111\u01b0\u1ee3c gi\u1edbi thi\u1ec7u.</p> <p>\u0110\u1ecbnh l\u00fd</p> <p>H\u00e3y xem x\u00e9t \u0111\u1ec9nh $v$ v\u00e0 gi\u1ea3 s\u1eed ch\u00fang ta v\u1eeba ho\u00e0n th\u00e0nh vi\u1ec7c duy\u1ec7t danh s\u00e1ch k\u1ec1 c\u1ee7a n\u00f3. T\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh ch\u01b0a \u0111\u01b0\u1ee3c x\u00e1c nh\u1eadn trong c\u00e2y con c\u1ee7a n\u00f3 thu\u1ed9c v\u1ec1 c\u00f9ng m\u1ed9t SCC.</p> Ch\u1ee9ng minh <p>Thu\u1eadt to\u00e1n s\u1ebd x\u00e1c nh\u1eadn c\u00e1c \u0111\u1ec9nh c\u1ee7a m\u1ed9t SCC khi g\u1ed1c c\u1ee7a n\u00f3 \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y. V\u00ec danh s\u00e1ch k\u1ec1 c\u1ee7a $v$ \u0111\u00e3 \u0111\u01b0\u1ee3c duy\u1ec7t, t\u1ea5t c\u1ea3 c\u00e1c cu\u1ed9c g\u1ecdi DFS tr\u00ean c\u00e2y con c\u1ee7a n\u00f3 \u0111\u00e3 k\u1ebft th\u00fac, c\u00e1c g\u1ed1c \u0111\u00e3 \u0111\u01b0\u1ee3c ph\u00e1t hi\u1ec7n v\u00e0 c\u00e1c \u0111\u1ec9nh thu\u1ed9c v\u1ec1 SCC c\u1ee7a ch\u00fang \u0111\u00e3 \u0111\u01b0\u1ee3c x\u00e1c nh\u1eadn. G\u1ed1c c\u1ee7a c\u00e1c \u0111\u1ec9nh ch\u01b0a \u0111\u01b0\u1ee3c x\u00e1c nh\u1eadn c\u00f2n l\u1ea1i s\u1ebd l\u00e0 m\u1ed9t t\u1ed5 ti\u00ean c\u00f3 quy tr\u00ecnh x\u00e1c nh\u1eadn ch\u01b0a \u0111\u01b0\u1ee3c th\u1ef1c thi, v\u00ec v\u1eady n\u00f3 l\u00e0 $v$ ho\u1eb7c m\u1ed9t t\u1ed5 ti\u00ean c\u1ee7a $v$. V\u00ec $v$ n\u1eb1m trong \u0111\u01b0\u1eddng \u0111i t\u1eeb t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh \u0111\u1ebfn g\u1ed1c c\u1ee7a ch\u00fang v\u00e0 c\u00e1c SCC ph\u1ea3i t\u1ea1o ra m\u1ed9t \u0111\u1ed3 th\u1ecb con li\u00ean th\u00f4ng c\u1ee7a c\u00e2y, c\u1ea3 $v$ v\u00e0 t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh c\u00f2n l\u1ea1i thu\u1ed9c v\u1ec1 c\u00f9ng m\u1ed9t SCC.</p> <p>\u0110\u1ecbnh l\u00fd</p> <p>H\u00e3y xem x\u00e9t \u0111\u1ec9nh $v$ v\u00e0 gi\u1ea3 s\u1eed ch\u00fang ta \u0111ang duy\u1ec7t danh s\u00e1ch k\u1ec1 c\u1ee7a n\u00f3, hi\u1ec7n \u0111ang x\u1eed l\u00fd c\u1ea1nh $(v, u)$. N\u1ebfu $u$ \u0111\u00e3 \u0111\u01b0\u1ee3c th\u0103m b\u1edfi m\u1ed9t s\u1ed1 cu\u1ed9c g\u1ecdi DFS v\u00e0 v\u1eabn ch\u01b0a \u0111\u01b0\u1ee3c x\u00e1c nh\u1eadn, $v$ v\u00e0 $u$ thu\u1ed9c v\u1ec1 c\u00f9ng m\u1ed9t SCC.</p> Ch\u1ee9ng minh <p>C\u00f3 c\u00e1c tr\u01b0\u1eddng h\u1ee3p kh\u00e1c nhau t\u00f9y thu\u1ed9c v\u00e0o lo\u1ea1i c\u1ea1nh:</p> <ul> <li> <p>C\u1ea1nh c\u00e2y (Tree-edge): n\u1ebfu \u0111\u00e2y l\u00e0 m\u1ed9t c\u1ea1nh c\u00e2y, \u0111\u00e2y l\u00e0 l\u1ea7n \u0111\u1ea7u ti\u00ean ch\u00fang ta t\u00ecm th\u1ea5y \u0111\u1ec9nh $u$. \u0110i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 tr\u01b0\u1edbc ti\u00ean ch\u00fang ta ph\u1ea3i \u00e1p d\u1ee5ng \u0111\u1ec7 quy cu\u1ed9c g\u1ecdi DFS tr\u00ean $u$ v\u00e0 xem x\u00e9t n\u00f3 sau khi cu\u1ed9c g\u1ecdi DFS c\u1ee7a n\u00f3 \u0111\u00e3 k\u1ebft th\u00fac. N\u1ebfu \u0111\u1ec9nh $u$ v\u1eabn ch\u01b0a \u0111\u01b0\u1ee3c x\u00e1c nh\u1eadn, g\u1ed1c c\u1ee7a n\u00f3 l\u00e0 $v$ ho\u1eb7c m\u1ed9t t\u1ed5 ti\u00ean c\u1ee7a $v$, v\u00ec v\u1eady ch\u00fang ph\u1ea3i thu\u1ed9c v\u1ec1 c\u00f9ng m\u1ed9t SCC.</p> </li> <li> <p>C\u1ea1nh ng\u01b0\u1ee3c (Back-edge): \u0111\u00e2y l\u00e0 tr\u01b0\u1eddng h\u1ee3p \u0111\u01a1n gi\u1ea3n h\u01a1n, n\u1ebfu $u$ l\u00e0 t\u1ed5 ti\u00ean c\u1ee7a $v$, ch\u00fang c\u00f3 th\u1ec3 truy c\u1eadp \u0111\u01b0\u1ee3c t\u1eeb nhau v\u00e0 theo \u0111\u1ecbnh ngh\u0129a thu\u1ed9c v\u1ec1 c\u00f9ng m\u1ed9t SCC.</p> </li> <li> <p>C\u1ea1nh ti\u1ebfn (Forward-edge): tr\u01b0\u1edbc khi c\u1ea1nh n\u00e0y \u0111\u01b0\u1ee3c x\u1eed l\u00fd, \u0111\u00e3 c\u00f3 m\u1ed9t chu\u1ed7i c\u00e1c cu\u1ed9c g\u1ecdi DFS k\u1ebft th\u00fac m\u00e0 kh\u00f4ng t\u00ecm th\u1ea5y g\u1ed1c c\u1ee7a $u$, \u0111\u00e3 quay tr\u1edf l\u1ea1i $v$ m\u00e0 cu\u1ed9c g\u1ecdi DFS c\u1ee7a n\u00f3 \u0111\u00e3 ti\u1ebfp t\u1ee5c. G\u1ed1c c\u1ee7a $u$ sau \u0111\u00f3 s\u1ebd l\u00e0 m\u1ed9t t\u1ed5 ti\u00ean m\u00e0 quy tr\u00ecnh x\u00e1c nh\u1eadn c\u1ee7a n\u00f3 ch\u01b0a \u0111\u01b0\u1ee3c th\u1ef1c thi, v\u00ec v\u1eady n\u00f3 l\u00e0 $v$ ho\u1eb7c m\u1ed9t t\u1ed5 ti\u00ean c\u1ee7a $v$, v\u00ec v\u1eady ch\u00fang ph\u1ea3i thu\u1ed9c v\u1ec1 c\u00f9ng m\u1ed9t SCC.</p> </li> <li> <p>C\u1ea1nh ch\u00e9o (Cross-edge): t\u01b0\u01a1ng t\u1ef1, tr\u01b0\u1edbc khi c\u1ea1nh n\u00e0y \u0111\u01b0\u1ee3c x\u1eed l\u00fd, \u0111\u00e3 c\u00f3 m\u1ed9t chu\u1ed7i c\u00e1c cu\u1ed9c g\u1ecdi DFS k\u1ebft th\u00fac m\u00e0 kh\u00f4ng t\u00ecm th\u1ea5y g\u1ed1c c\u1ee7a $u$, \u0111\u00e3 quay tr\u1edf l\u1ea1i m\u1ed9t t\u1ed5 ti\u00ean chung c\u1ee7a $u$ v\u00e0 $v$ m\u00e0 cu\u1ed9c g\u1ecdi DFS c\u1ee7a n\u00f3 \u0111\u00e3 ti\u1ebfp t\u1ee5c v\u00e0 b\u1eaft \u0111\u1ea7u m\u1ed9t chu\u1ed7i c\u00e1c cu\u1ed9c g\u1ecdi DFS m\u1edbi d\u1eabn \u0111\u1ebfn m\u1ed9t cu\u1ed9c g\u1ecdi tr\u00ean $v$. G\u1ed1c c\u1ee7a $u$ sau \u0111\u00f3 s\u1ebd l\u00e0 m\u1ed9t t\u1ed5 ti\u00ean m\u00e0 quy tr\u00ecnh x\u00e1c nh\u1eadn c\u1ee7a n\u00f3 ch\u01b0a \u0111\u01b0\u1ee3c th\u1ef1c thi, v\u00e0 t\u1ea5t c\u1ea3 c\u00e1c \u1ee9ng c\u1eed vi\u00ean c\u00f3 th\u1ec3 l\u00e0 t\u1ed5 ti\u00ean chung v\u1edbi $v$. V\u00ec g\u1ed1c c\u1ee7a $u$ l\u00e0 t\u1ed5 ti\u00ean c\u1ee7a $v$, n\u00f3 ti\u1ebfp c\u1eadn $v$, v\u00e0 v\u00ec $v$ b\u00e2y gi\u1edd ti\u1ebfp c\u1eadn $u$, ch\u00fang ph\u1ea3i thu\u1ed9c v\u1ec1 c\u00f9ng m\u1ed9t SCC.</p> </li> </ul> <p>L\u01b0u \u00fd, khi hai \u0111\u1ec9nh thu\u1ed9c v\u1ec1 c\u00f9ng m\u1ed9t th\u00e0nh ph\u1ea7n, g\u1ed1c c\u1ee7a ch\u00fang ph\u1ea3i l\u00e0 m\u1ed9t t\u1ed5 ti\u00ean chung c\u1ee7a c\u1ea3 hai \u0111\u1ec9nh.</p> <p>\u0110\u1ecbnh l\u00fd</p> <p>Cho $v$ l\u00e0 m\u1ed9t \u0111\u1ec9nh. C\u00e1c ph\u00e1t bi\u1ec3u sau l\u00e0 t\u01b0\u01a1ng \u0111\u01b0\u01a1ng:</p> <ol> <li>M\u1ed9t s\u1ed1 \u0111\u1ec9nh trong c\u00e2y con c\u1ee7a $v$ ti\u1ebfp c\u1eadn m\u1ed9t \u0111\u1ec9nh ch\u01b0a \u0111\u01b0\u1ee3c x\u00e1c nh\u1eadn b\u00ean ngo\u00e0i c\u00e2y con.</li> <li>$v$ kh\u00f4ng ph\u1ea3i l\u00e0 g\u1ed1c c\u1ee7a m\u1ed9t SCC.</li> </ol> Ch\u1ee9ng minh <ul> <li> <p>$1. \\implies 2.$: Gi\u1ea3 s\u1eed m\u1ed9t s\u1ed1 \u0111\u1ec9nh $u$ trong c\u00e2y con c\u1ee7a $v$ ti\u1ebfp c\u1eadn m\u1ed9t \u0111\u1ec9nh ch\u01b0a \u0111\u01b0\u1ee3c x\u00e1c nh\u1eadn $w$ b\u00ean ngo\u00e0i c\u00e2y con. Ch\u00fang ta \u0111\u00e3 thi\u1ebft l\u1eadp r\u1eb1ng $u$ v\u00e0 $w$ thu\u1ed9c v\u1ec1 c\u00f9ng m\u1ed9t SCC v\u00e0 g\u1ed1c c\u1ee7a ch\u00fang ph\u1ea3i l\u00e0 m\u1ed9t t\u1ed5 ti\u00ean chung cho c\u1ea3 hai. T\u1ed5 ti\u00ean chung n\u00e0y nh\u1ea5t thi\u1ebft ph\u1ea3i \u1edf b\u00ean ngo\u00e0i c\u00e2y con, v\u00e0 n\u00f3 c\u0169ng s\u1ebd l\u00e0 t\u1ed5 ti\u00ean c\u1ee7a $v$. V\u00ec $v$ n\u1eb1m trong \u0111\u01b0\u1eddng \u0111i t\u1eeb g\u1ed1c \u0111\u1ebfn $u$, n\u00f3 ph\u1ea3i thu\u1ed9c v\u1ec1 c\u00f9ng m\u1ed9t SCC, g\u1ed1c c\u1ee7a n\u00f3 kh\u00f4ng ph\u1ea3i l\u00e0 $v$.</p> </li> <li> <p>$\\neg 1. \\implies \\neg 2.$: Gi\u1ea3 s\u1eed kh\u00f4ng c\u00f3 \u0111\u1ec9nh n\u00e0o trong c\u00e2y con c\u1ee7a $v$ ti\u1ebfp c\u1eadn m\u1ed9t \u0111\u1ec9nh ch\u01b0a \u0111\u01b0\u1ee3c x\u00e1c nh\u1eadn b\u00ean ngo\u00e0i c\u00e2y con. \u0110i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 kh\u00f4ng c\u00f3 \u0111\u1ec9nh n\u00e0o trong c\u00e2y con c\u1ee7a $v$ ti\u1ebfp c\u1eadn m\u1ed9t t\u1ed5 ti\u00ean c\u1ee7a $v$. C\u00e1c c\u1ea1nh duy nh\u1ea5t c\u00f3 th\u1ec3 \u0111\u1ebfn c\u00e1c \u0111\u1ec9nh b\u00ean ngo\u00e0i c\u00e2y con l\u00e0 c\u00e1c c\u1ea1nh ch\u00e9o \u0111\u1ebfn c\u00e1c \u0111\u1ec9nh \u0111\u00e3 \u0111\u01b0\u1ee3c x\u00e1c nh\u1eadn; c\u00e1c \u0111\u1ec9nh n\u00e0y kh\u00f4ng th\u1ec3 ti\u1ebfp c\u1eadn m\u1ed9t t\u1ed5 ti\u00ean c\u1ee7a $v$, v\u00ec n\u1ebfu ch\u00fang l\u00e0m v\u1eady, ch\u00fang s\u1ebd thu\u1ed9c v\u1ec1 c\u00f9ng m\u1ed9t SCC nh\u01b0 $v$, \u0111i\u1ec1u n\u00e0y l\u00e0 kh\u00f4ng th\u1ec3 v\u00ec SCC c\u1ee7a ch\u00fang \u0111\u00e3 \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh. V\u00ec kh\u00f4ng c\u00f3 t\u1ed5 ti\u00ean n\u00e0o c\u1ee7a $v$ c\u00f3 th\u1ec3 truy c\u1eadp \u0111\u01b0\u1ee3c t\u1eeb c\u00e2y con c\u1ee7a n\u00f3, g\u1ed1c c\u1ee7a $v$ ph\u1ea3i l\u00e0 ch\u00ednh $v$.</p> </li> </ul> <p>B\u00e2y gi\u1edd, ch\u00fang ta ph\u1ea3i t\u00ecm ph\u01b0\u01a1ng ph\u00e1p cho ph\u00e9p ch\u00fang ta x\u00e1c \u0111\u1ecbnh xem m\u1ed9t \u0111\u1ec9nh c\u00f3 ph\u1ea3i l\u00e0 g\u1ed1c hay kh\u00f4ng, v\u00e0 c\u00e1c thu\u1ed9c t\u00ednh quy tr\u00ecnh x\u00e1c nh\u1eadn l\u00e0 c\u1ea7n thi\u1ebft cho s\u1ef1 ch\u00ednh x\u00e1c c\u1ee7a n\u00f3. \u0110\u1ec3 \u0111\u1ea1t \u0111\u01b0\u1ee3c m\u1ee5c \u0111\u00edch n\u00e0y, ch\u00fang ta \u0111\u1ecbnh ngh\u0129a th\u1eddi gian v\u00e0o $t_{in}[v]$ cho m\u1ed7i \u0111\u1ec9nh $v \\in G$ t\u01b0\u01a1ng \u1ee9ng v\u1edbi 'd\u1ea5u th\u1eddi gian' m\u00e0 t\u1ea1i \u0111\u00f3 DFS \u0111\u01b0\u1ee3c g\u1ecdi tr\u00ean $v$. Theo \u0111\u1ecbnh ngh\u0129a, g\u1ed1c l\u00e0 \u0111\u1ec9nh \u0111\u1ea7u ti\u00ean c\u1ee7a m\u1ed9t SCC \u0111\u01b0\u1ee3c DFS th\u0103m n\u00ean n\u00f3 s\u1ebd c\u00f3 gi\u00e1 tr\u1ecb $t_{in}$ nh\u1ecf nh\u1ea5t c\u1ee7a SCC c\u1ee7a n\u00f3.</p> <p>G\u1ecdi $v$ l\u00e0 m\u1ed9t \u0111\u1ec9nh v\u00e0 h\u00e3y xem x\u00e9t c\u00e2y con c\u1ee7a n\u00f3. T\u1ea1i th\u1eddi \u0111i\u1ec3m ch\u00fang ta k\u1ebft th\u00fac vi\u1ec7c duy\u1ec7t danh s\u00e1ch k\u1ec1 c\u1ee7a n\u00f3, b\u1ea5t k\u1ef3 \u0111\u1ec9nh n\u00e0o \u0111\u00e3 \u0111\u01b0\u1ee3c DFS th\u0103m b\u00ean ngo\u00e0i c\u00e2y con s\u1ebd c\u00f3 gi\u00e1 tr\u1ecb $t_{in}$ nh\u1ecf h\u01a1n, v\u00ec DFS \u0111\u00e3 \u0111\u01b0\u1ee3c g\u1ecdi l\u1ea7n \u0111\u1ea7u ti\u00ean tr\u00ean ch\u00fang tr\u01b0\u1edbc khi n\u00f3 b\u1eaft \u0111\u1ea7u tr\u00ean $v$.</p> <p>Khi xem x\u00e9t quy tr\u00ecnh x\u00e1c nh\u1eadn, gi\u00e1 tr\u1ecb $t_{in}$ c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh ch\u01b0a \u0111\u01b0\u1ee3c x\u00e1c nh\u1eadn b\u00ean ngo\u00e0i c\u00e2y con c\u1ee7a $v$ nh\u1ecf h\u01a1n $t_{in}[v]$. B\u00e2y gi\u1edd ch\u00fang ta c\u00f3 th\u1ec3 th\u1ea5y c\u00e1ch s\u1eed d\u1ee5ng $t_{in}$ \u0111\u1ec3 x\u00e1c \u0111\u1ecbnh c\u00e1c g\u1ed1c. Ch\u00fang ta xem x\u00e9t gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t c\u1ee7a $t_{in}$ c\u1ee7a c\u00e1c \u0111\u1ec9nh ch\u01b0a \u0111\u01b0\u1ee3c x\u00e1c nh\u1eadn m\u00e0 ch\u00fang ta c\u00f3 th\u1ec3 ti\u1ebfp c\u1eadn v\u00e0 ch\u00fang ta truy\u1ec1n th\u00f4ng tin n\u00e0y \u0111\u1ebfn c\u00e1c t\u1ed5 ti\u00ean th\u00f4ng qua c\u00e1c c\u1ea1nh c\u00e2y. Ch\u00fang ta s\u1ebd g\u1ecdi gi\u00e1 tr\u1ecb \u0111\u01b0\u1ee3c truy\u1ec1n l\u00e0 $t_{low}$.</p> <p>Ch\u00ednh th\u1ee9c h\u01a1n, ch\u00fang ta \u0111\u1ecbnh ngh\u0129a $t_{low}[v]$ l\u00e0 gi\u00e1 tr\u1ecb th\u1ea5p nh\u1ea5t c\u1ee7a $t_{in}$ m\u00e0 m\u1ed9t \u0111\u1ec9nh trong c\u00e2y con c\u1ee7a $v$ c\u00f3 th\u1ec3 ti\u1ebfp c\u1eadn th\u00f4ng qua m\u1ed9t c\u1ea1nh tr\u1ef1c ti\u1ebfp. Do \u0111\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 ph\u00e1t hi\u1ec7n xem m\u1ed9t \u0111\u1ec9nh $v$ c\u00f3 ph\u1ea3i l\u00e0 g\u1ed1c hay kh\u00f4ng b\u1eb1ng c\u00e1ch ki\u1ec3m tra xem $t_{low}[v] &lt; t_{in}[v]$.</p> <p>Cu\u1ed1i c\u00f9ng, \u0111\u1ec3 x\u00e1c nh\u1eadn c\u00e1c \u0111\u1ec9nh, c\u00f3 nhi\u1ec1u c\u00e1ch \u0111\u1ec3 th\u1ef1c hi\u1ec7n, ch\u1eb3ng h\u1ea1n nh\u01b0 m\u1ed9t thu\u1eadt to\u00e1n duy\u1ec7t \u0111\u1ed3 th\u1ecb kh\u00e1c, nh\u01b0ng c\u0169ng c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng m\u1ed9t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u \u0111\u01a1n gi\u1ea3n \u0111\u1ec3 theo d\u00f5i c\u00e1c \u0111\u1ec9nh ch\u01b0a \u0111\u01b0\u1ee3c x\u00e1c nh\u1eadn. \u0110\u1ec3 x\u00e1c \u0111\u1ecbnh c\u1ea5u tr\u00fac d\u1eef li\u1ec7u t\u1eeb c\u00e1c nguy\u00ean t\u1eafc \u0111\u1ea7u ti\u00ean, h\u00e3y \u0111i qua c\u00e1c ph\u01b0\u01a1ng th\u1ee9c m\u00e0 n\u00f3 ph\u1ea3i th\u1ef1c hi\u1ec7n, ch\u1ec9 c\u00f3 hai:</p> <ul> <li> <p>Khi ch\u00fang ta l\u1ea7n \u0111\u1ea7u ti\u00ean th\u0103m m\u1ed9t \u0111\u1ec9nh, ch\u00fang ta ch\u1ec9 c\u1ea7n ch\u00e8n n\u00f3 v\u00e0o c\u1ea5u tr\u00fac d\u1eef li\u1ec7u, v\u00ec \u0111\u1ec9nh n\u00e0y ch\u01b0a \u0111\u01b0\u1ee3c x\u00e1c nh\u1eadn.</p> </li> <li> <p>Khi ch\u00fang ta t\u00ecm th\u1ea5y m\u1ed9t g\u1ed1c, ch\u00fang ta ph\u1ea3i t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh ch\u01b0a \u0111\u01b0\u1ee3c x\u00e1c nh\u1eadn c\u00f2n l\u1ea1i trong c\u00e2y con c\u1ee7a n\u00f3 v\u00e0 lo\u1ea1i b\u1ecf ch\u00fang kh\u1ecfi c\u1ea5u tr\u00fac d\u1eef li\u1ec7u.</p> </li> </ul> <p>Ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm m\u1ed9t c\u00e1ch thay th\u1ebf \u0111\u1ec3 m\u00f4 t\u1ea3 thao t\u00e1c lo\u1ea1i b\u1ecf b\u1eb1ng c\u00e1ch nh\u1eadn th\u1ea5y r\u1eb1ng ngay sau khi duy\u1ec7t danh s\u00e1ch k\u1ec1 c\u1ee7a m\u1ed9t \u0111\u1ec9nh $v$, t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh \u0111\u01b0\u1ee3c \u0111\u1eb7t trong c\u1ea5u tr\u00fac d\u1eef li\u1ec7u sau $v$ \u0111\u1ec1u thu\u1ed9c v\u1ec1 c\u00e2y con c\u1ee7a n\u00f3. N\u1ebfu $v$ l\u00e0 g\u1ed1c, t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh c\u00f2n l\u1ea1i \u0111\u01b0\u1ee3c ch\u00e8n sau $v$ ph\u1ea3i \u0111\u01b0\u1ee3c lo\u1ea1i b\u1ecf. V\u00ec v\u1eady, thao t\u00e1c lo\u1ea1i b\u1ecf thay v\u00e0o \u0111\u00f3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 l\u00e0:</p> <ul> <li>Khi ch\u00fang ta t\u00ecm th\u1ea5y m\u1ed9t g\u1ed1c, ch\u00fang ta ph\u1ea3i t\u00ecm v\u00e0 lo\u1ea1i b\u1ecf t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh c\u00f2n l\u1ea1i \u0111\u01b0\u1ee3c ch\u00e8n sau n\u00f3.</li> </ul> <p>B\u00e2y gi\u1edd ch\u00fang ta c\u00f3 th\u1ec3 th\u1ea5y r\u1eb1ng \u0111i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n v\u1edbi m\u1ed9t ng\u0103n x\u1ebfp (stack):</p> <ul> <li> <p>Khi ch\u00fang ta l\u1ea7n \u0111\u1ea7u ti\u00ean th\u0103m m\u1ed9t \u0111\u1ec9nh, ch\u00fang ta \u0111\u1ea9y n\u00f3 v\u00e0o ng\u0103n x\u1ebfp.</p> </li> <li> <p>Khi ch\u00fang ta t\u00ecm th\u1ea5y m\u1ed9t g\u1ed1c, ch\u00fang ta l\u1ea5y ra t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed cho \u0111\u1ebfn khi ch\u00fang ta l\u1ea5y ra ch\u00ednh g\u1ed1c \u0111\u00f3.</p> </li> </ul> <p>\u0110i\u1ec1u n\u00e0y cu\u1ed1i c\u00f9ng cho ph\u00e9p ch\u00fang ta c\u00e0i \u0111\u1eb7t thu\u1eadt to\u00e1n.</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian ch\u1ea1y c\u1ee7a chu\u1ed7i c\u00e1c cu\u1ed9c g\u1ecdi DFS l\u00e0 $O(n + m)$. Xem x\u00e9t ng\u0103n x\u1ebfp, \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a n\u00f3 kh\u1ea5u hao th\u00e0nh $O(n)$ v\u00ec m\u1ed7i n\u00fat ch\u1ec9 \u0111\u01b0\u1ee3c \u0111\u1ea9y v\u00e0 l\u1ea5y ra m\u1ed9t l\u1ea7n. Do \u0111\u00f3, t\u1ed5ng \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian ch\u1ea1y l\u00e0 $O(n + m)$.</p> <p>Nh\u01b0 m\u1ed9t nh\u1eadn x\u00e9t b\u1ed5 sung, c\u00e1c g\u1ed1c \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y theo th\u1ee9 t\u1ef1 topo ng\u01b0\u1ee3c. Trong thu\u1eadt to\u00e1n, \u0111\u1ec9nh l\u00e0 g\u1ed1c n\u1ebfu kh\u00f4ng c\u00f3 c\u1ea1nh n\u00e0o \u0111\u1ebfn c\u00e1c \u0111\u1ec9nh ch\u01b0a \u0111\u01b0\u1ee3c x\u00e1c nh\u1eadn b\u00ean ngo\u00e0i c\u00e2y con c\u1ee7a n\u00f3, ngh\u0129a l\u00e0 t\u1ea5t c\u1ea3 c\u00e1c th\u00e0nh ph\u1ea7n c\u00f3 th\u1ec3 truy c\u1eadp kh\u00e1c \u0111\u1ec1u n\u1eb1m trong c\u00e2y con c\u1ee7a n\u00f3 (v\u00e0 do \u0111\u00f3 g\u1ed1c c\u1ee7a ch\u00fang \u0111\u00e3 \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y) ho\u1eb7c ch\u00fang k\u1ebft n\u1ed1i v\u1edbi c\u00e1c \u0111\u1ec9nh \u0111\u00e3 \u0111\u01b0\u1ee3c x\u00e1c nh\u1eadn b\u00ean ngo\u00e0i c\u00e2y con (m\u00e0 g\u1ed1c c\u1ee7a ch\u00fang c\u0169ng \u0111\u00e3 \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y). V\u00ec v\u1eady, t\u1ea5t c\u1ea3 c\u00e1c th\u00e0nh ph\u1ea7n c\u00f3 th\u1ec3 truy c\u1eadp \u0111\u00e3 \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y, ngh\u0129a l\u00e0 ch\u00fang \u0111\u01b0\u1ee3c gi\u1edbi thi\u1ec7u theo th\u1ee9 t\u1ef1 topo ng\u01b0\u1ee3c h\u1ee3p l\u1ec7 c\u1ee7a \u0111\u1ed3 th\u1ecb n\u00e9n.</p>","tags":["Translated"]},{"location":"graph/strongly-connected-components.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<pre><code>vector&lt;int&gt; st;    // - ng\u0103n x\u1ebfp ch\u1ee9a c\u00e1c \u0111\u1ec9nh ch\u01b0a \u0111\u01b0\u1ee3c x\u00e1c nh\u1eadn\nvector&lt;int&gt; roots; // - theo d\u00f5i c\u00e1c g\u1ed1c SCC c\u1ee7a c\u00e1c \u0111\u1ec9nh\nint timer;         // - b\u1ed9 \u0111\u1ebfm d\u1ea5u th\u1eddi gian dfs\nvector&lt;int&gt; t_in;  // - theo d\u00f5i d\u1ea5u th\u1eddi gian dfs c\u1ee7a c\u00e1c \u0111\u1ec9nh\nvector&lt;int&gt; t_low; // - theo d\u00f5i t_in th\u1ea5p nh\u1ea5t c\u1ee7a c\u00e1c \u0111\u1ec9nh ch\u01b0a \u0111\u01b0\u1ee3c x\u00e1c nh\u1eadn\n                   // c\u00f3 th\u1ec3 truy c\u1eadp trong c\u00e2y con\n\n// th\u1ef1c hi\u1ec7n thu\u1eadt to\u00e1n tarjan cho c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh\nvoid dfs(int v, vector&lt;vector&lt;int&gt;&gt; const &amp;adj, vector&lt;vector&lt;int&gt;&gt; &amp;components) {\n\n  t_low[v] = t_in[v] = timer++;\n  st.push_back(v);\n\n  for (auto u : adj[v]) {\n    if (t_in[u] == -1) { // tree-edge\n      dfs(u, adj, components);\n      t_low[v] = min(t_low[v], t_low[u]);\n    } else if (roots[u] == -1) { // back-edge, cross-edge ho\u1eb7c forward-edge \u0111\u1ebfn m\u1ed9t \u0111\u1ec9nh ch\u01b0a \u0111\u01b0\u1ee3c x\u00e1c nh\u1eadn\n      t_low[v] = min(t_low[v], t_in[u]);\n    }\n  }\n\n  if (t_low[v] == t_in[v]) { // \u0111\u1ec9nh l\u00e0 m\u1ed9t g\u1ed1c\n    components.push_back({v}); // kh\u1edfi t\u1ea1o m\u1ed9t th\u00e0nh ph\u1ea7n m\u1edbi v\u1edbi g\u1ed1c v\n    while (true) {\n      int u = st.back();\n      st.pop_back();\n      roots[u] = v; // x\u00e1c nh\u1eadn \u0111\u1ec9nh\n      if (u == v)\n        break;\n      components.back().push_back(u); // th\u00eam \u0111\u1ec9nh u v\u00e0o th\u00e0nh ph\u1ea7n c\u1ee7a v\n    }\n  }\n}\n\n// \u0111\u1ea7u v\u00e0o: adj -- danh s\u00e1ch k\u1ec1 c\u1ee7a G\n// \u0111\u1ea7u ra: components -- c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh trong G\n// \u0111\u1ea7u ra: adj_cond -- danh s\u00e1ch k\u1ec1 c\u1ee7a G^SCC (theo c\u00e1c \u0111\u1ec9nh g\u1ed1c)\nvoid strongly_connected_components(vector&lt;vector&lt;int&gt;&gt; const &amp;adj,\n                                   vector&lt;vector&lt;int&gt;&gt; &amp;components,\n                                   vector&lt;vector&lt;int&gt;&gt; &amp;adj_cond) {\n  components.clear();\n  adj_cond.clear();\n\n  int n = adj.size();\n\n  st.clear();\n  roots.assign(n, -1);\n  timer = 0;\n  t_in.assign(n, -1);\n  t_low.assign(n, -1);\n\n  // \u00e1p d\u1ee5ng thu\u1eadt to\u00e1n tarjan cho t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh\n  // th\u00eam c\u00e1c \u0111\u1ec9nh v\u00e0o c\u00e1c th\u00e0nh ph\u1ea7n theo th\u1ee9 t\u1ef1 topo ng\u01b0\u1ee3c\n  for (int v = 0; v &lt; n; v++) {\n    if (t_in[v] == -1) {\n      dfs(v, adj, components);\n    }\n  }\n\n  // th\u00eam c\u00e1c c\u1ea1nh v\u00e0o \u0111\u1ed3 th\u1ecb n\u00e9n\n  adj_cond.assign(n, {});\n  for (int v = 0; v &lt; n; v++) {\n    for (auto u : adj[v])\n      if (roots[v] != roots[u])\n        adj_cond[roots[v]].push_back(roots[u]);\n  }\n}\n</code></pre> <p>Ch\u00fang t\u00f4i c\u00f3 m\u1ed9t b\u00e0i n\u1ed9p \u0111\u01b0\u1ee3c ch\u1ea5p nh\u1eadn v\u1edbi m\u00e3 n\u00e0y trong Th\u01b0 vi\u1ec7n Ki\u1ec3m tra (Library Checker).</p> <p>Nh\u01b0 m\u1ed9t nh\u1eadn x\u00e9t cu\u1ed1i c\u00f9ng, c\u00f3 m\u1ed9t c\u00e1ch thay th\u1ebf \u0111\u1ec3 l\u1eb7p qua danh s\u00e1ch k\u1ec1. Hi\u1ec7n t\u1ea1i, ch\u00fang ta \u0111ang th\u1ef1c hi\u1ec7n nh\u01b0 sau:</p> <pre><code>for (auto u : adj[v]) {\n  if (t_in[u] == -1) { // tree-edge\n    dfs(u, adj);\n    t_low[v] = min(t_low[v], t_low[u]);\n  } else if (roots[u] == -1) { // back-edge, cross-edge ho\u1eb7c forward-edge \u0111\u1ebfn m\u1ed9t \u0111\u1ec9nh ch\u01b0a \u0111\u01b0\u1ee3c x\u00e1c nh\u1eadn\n    t_low[v] = min(t_low[v], t_in[u]);\n  }\n}\n</code></pre> <p>Ngo\u00e0i ra, ch\u00fang ta c\u00f3 th\u1ec3 l\u00e0m:</p> <pre><code>for (auto u : adj[v]) {\n  if (t_in[u] == -1) // \u0111\u1ec9nh ch\u01b0a \u0111\u01b0\u1ee3c th\u0103m\n    dfs(u, adj);\n  if (roots[u] == -1) // \u0111\u1ec9nh ch\u01b0a \u0111\u01b0\u1ee3c x\u00e1c nh\u1eadn\n    t_low[v] = min(t_low[v], t_low[u]);\n}\n</code></pre> <p>$t_{low}$ \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 truy\u1ec1n th\u00f4ng tin \u0111\u1ebfn g\u1ed1c, v\u00e0 khi ch\u00fang ta th\u1ef1c hi\u1ec7n <code>t_low[v] = min(t_low[v], t_in[u])</code>, ch\u00fang ta bi\u1ebft r\u1eb1ng $u$ v\u00e0 $v$ thu\u1ed9c v\u1ec1 c\u00f9ng m\u1ed9t SCC. N\u1ebfu $t_{low}[u]$ \u0111\u01b0\u1ee3c truy\u1ec1n cho \u0111\u1ebfn g\u1ed1c c\u1ee7a $u$, n\u00f3 c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c truy\u1ec1n qua $v$ v\u00ec g\u1ed1c l\u00e0 gi\u1ed1ng nhau. V\u00ec $t_{low}[u] \\leq t_{in}[u]$, \u0111i\u1ec1u n\u00e0y kh\u00f4ng g\u00e2y ra b\u1ea5t k\u1ef3 xung \u0111\u1ed9t n\u00e0o, thay v\u00e0o \u0111\u00f3 ch\u1ec9 c\u1ea3i thi\u1ec7n gi\u1edbi h\u1ea1n tr\u00ean g\u1ed1c c\u1ee7a $v$.</p>","tags":["Translated"]},{"location":"graph/strongly-connected-components.html#building-the-condensation-graph","title":"X\u00e2y d\u1ef1ng \u0110\u1ed3 th\u1ecb N\u00e9n (Building the Condensation Graph)","text":"<p>Khi x\u00e2y d\u1ef1ng danh s\u00e1ch k\u1ec1 c\u1ee7a \u0111\u1ed3 th\u1ecb n\u00e9n, ch\u00fang ta ch\u1ecdn g\u1ed1c c\u1ee7a m\u1ed7i th\u00e0nh ph\u1ea7n l\u00e0m \u0111\u1ec9nh \u0111\u1ea7u ti\u00ean trong danh s\u00e1ch c\u00e1c \u0111\u1ec9nh c\u1ee7a n\u00f3 (\u0111\u00e2y l\u00e0 m\u1ed9t l\u1ef1a ch\u1ecdn t\u00f9y \u00fd). \u0110\u1ec9nh g\u1ed1c n\u00e0y \u0111\u1ea1i di\u1ec7n cho to\u00e0n b\u1ed9 SCC c\u1ee7a n\u00f3. \u0110\u1ed1i v\u1edbi m\u1ed7i \u0111\u1ec9nh <code>v</code>, gi\u00e1 tr\u1ecb <code>roots[v]</code> ch\u1ec9 ra \u0111\u1ec9nh g\u1ed1c c\u1ee7a SCC m\u00e0 <code>v</code> thu\u1ed9c v\u1ec1.</p> <p>\u0110\u1ed3 th\u1ecb n\u00e9n c\u1ee7a ch\u00fang ta b\u00e2y gi\u1edd \u0111\u01b0\u1ee3c \u0111\u01b0a ra b\u1edfi c\u00e1c \u0111\u1ec9nh <code>components</code> (m\u1ed9t th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh t\u01b0\u01a1ng \u1ee9ng v\u1edbi m\u1ed9t \u0111\u1ec9nh trong \u0111\u1ed3 th\u1ecb n\u00e9n), v\u00e0 danh s\u00e1ch k\u1ec1 \u0111\u01b0\u1ee3c \u0111\u01b0a ra b\u1edfi <code>adj_cond</code>, ch\u1ec9 s\u1eed d\u1ee5ng c\u00e1c \u0111\u1ec9nh g\u1ed1c c\u1ee7a c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh. L\u01b0u \u00fd r\u1eb1ng ch\u00fang ta t\u1ea1o m\u1ed9t c\u1ea1nh t\u1eeb $C$ \u0111\u1ebfn $C'$ trong $G^\\text{SCC}$ cho m\u1ed7i c\u1ea1nh t\u1eeb m\u1ed9t s\u1ed1 $a\\in C$ \u0111\u1ebfn m\u1ed9t s\u1ed1 $b\\in C'$ trong $G$ (n\u1ebfu $C\\neq C'$). \u0110i\u1ec1u n\u00e0y ng\u1ee5 \u00fd r\u1eb1ng trong c\u00e0i \u0111\u1eb7t c\u1ee7a ch\u00fang ta, ch\u00fang ta c\u00f3 th\u1ec3 c\u00f3 nhi\u1ec1u c\u1ea1nh gi\u1eefa hai th\u00e0nh ph\u1ea7n trong \u0111\u1ed3 th\u1ecb n\u00e9n.</p>","tags":["Translated"]},{"location":"graph/strongly-connected-components.html#literature","title":"T\u00e0i li\u1ec7u (Literature)","text":"<ul> <li>Thomas Cormen, Charles Leiserson, Ronald Rivest, Clifford Stein. Introduction to Algorithms [2005].</li> <li>M. Sharir. A strong-connectivity algorithm and its applications in data-flow analysis [1979].</li> <li>Robert Tarjan. Depth-first search and linear graph algorithms [1972].</li> </ul>","tags":["Translated"]},{"location":"graph/strongly-connected-components.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>SPOJ - Good Travels</li> <li>SPOJ - Lego</li> <li>Codechef - Chef and Round Run</li> <li>UVA - 11838 - Come and Go</li> <li>UVA 247 - Calling Circles</li> <li>UVA 13057 - Prove Them All</li> <li>UVA 12645 - Water Supply</li> <li>UVA 11770 - Lighting Away</li> <li>UVA 12926 - Trouble in Terrorist Town</li> <li>UVA 11324 - The Largest Clique</li> <li>UVA 11709 - Trust groups</li> <li>UVA 12745 - Wishmaster</li> <li>SPOJ - True Friends</li> <li>SPOJ - Capital City</li> <li>Codeforces - Scheme</li> <li>SPOJ - Ada and Panels</li> <li>CSES - Flight Routes Check</li> <li>CSES - Planets and Kingdoms</li> <li>CSES - Coin Collector</li> <li>Codeforces - Checkposts</li> </ul>","tags":["Translated"]},{"location":"graph/topological-sort.html","title":"S\u1eafp x\u1ebfp Topo (Topological Sorting)","text":"<p>B\u1ea1n \u0111\u01b0\u1ee3c cho m\u1ed9t \u0111\u1ed3 th\u1ecb c\u00f3 h\u01b0\u1edbng v\u1edbi $n$ \u0111\u1ec9nh v\u00e0 $m$ c\u1ea1nh. B\u1ea1n ph\u1ea3i t\u00ecm m\u1ed9t th\u1ee9 t\u1ef1 c\u1ee7a c\u00e1c \u0111\u1ec9nh, sao cho m\u1ecdi c\u1ea1nh \u0111\u1ec1u d\u1eabn t\u1eeb \u0111\u1ec9nh c\u00f3 ch\u1ec9 s\u1ed1 nh\u1ecf h\u01a1n \u0111\u1ebfn \u0111\u1ec9nh c\u00f3 ch\u1ec9 s\u1ed1 l\u1edbn h\u01a1n.</p> <p>N\u00f3i c\u00e1ch kh\u00e1c, b\u1ea1n mu\u1ed1n t\u00ecm m\u1ed9t ho\u00e1n v\u1ecb c\u1ee7a c\u00e1c \u0111\u1ec9nh (th\u1ee9 t\u1ef1 topo) t\u01b0\u01a1ng \u1ee9ng v\u1edbi th\u1ee9 t\u1ef1 \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh b\u1edfi t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh c\u1ee7a \u0111\u1ed3 th\u1ecb.</p> <p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u1ed9t \u0111\u1ed3 th\u1ecb \u0111\u00e3 cho c\u00f9ng v\u1edbi th\u1ee9 t\u1ef1 topo c\u1ee7a n\u00f3:</p> <p>Th\u1ee9 t\u1ef1 topo c\u00f3 th\u1ec3 l\u00e0 kh\u00f4ng duy nh\u1ea5t (v\u00ed d\u1ee5, n\u1ebfu t\u1ed3n t\u1ea1i ba \u0111\u1ec9nh $a$, $b$, $c$ m\u00e0 c\u00f3 c\u00e1c \u0111\u01b0\u1eddng \u0111i t\u1eeb $a$ \u0111\u1ebfn $b$ v\u00e0 t\u1eeb $a$ \u0111\u1ebfn $c$ nh\u01b0ng kh\u00f4ng c\u00f3 \u0111\u01b0\u1eddng \u0111i t\u1eeb $b$ \u0111\u1ebfn $c$ ho\u1eb7c t\u1eeb $c$ \u0111\u1ebfn $b$). \u0110\u1ed3 th\u1ecb v\u00ed d\u1ee5 c\u0169ng c\u00f3 nhi\u1ec1u th\u1ee9 t\u1ef1 topo, th\u1ee9 t\u1ef1 topo th\u1ee9 hai nh\u01b0 sau:</p> <p>Th\u1ee9 t\u1ef1 topo c\u00f3 th\u1ec3 kh\u00f4ng t\u1ed3n t\u1ea1i ch\u00fat n\u00e0o. N\u00f3 ch\u1ec9 t\u1ed3n t\u1ea1i n\u1ebfu \u0111\u1ed3 th\u1ecb c\u00f3 h\u01b0\u1edbng kh\u00f4ng ch\u1ee9a chu tr\u00ecnh. Ng\u01b0\u1ee3c l\u1ea1i, c\u00f3 m\u1ed9t m\u00e2u thu\u1eabn: n\u1ebfu c\u00f3 m\u1ed9t chu tr\u00ecnh ch\u1ee9a c\u00e1c \u0111\u1ec9nh $a$ v\u00e0 $b$, th\u00ec $a$ c\u1ea7n c\u00f3 ch\u1ec9 s\u1ed1 nh\u1ecf h\u01a1n $b$ (v\u00ec b\u1ea1n c\u00f3 th\u1ec3 ti\u1ebfp c\u1eadn $b$ t\u1eeb $a$) v\u00e0 c\u0169ng l\u1edbn h\u01a1n (v\u00ec b\u1ea1n c\u00f3 th\u1ec3 ti\u1ebfp c\u1eadn $a$ t\u1eeb $b$). Thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 trong b\u00e0i vi\u1ebft n\u00e0y c\u0169ng cho th\u1ea5y b\u1eb1ng c\u00e1ch x\u00e2y d\u1ef1ng, r\u1eb1ng m\u1ecdi \u0111\u1ed3 th\u1ecb c\u00f3 h\u01b0\u1edbng kh\u00f4ng c\u00f3 chu tr\u00ecnh (DAG) \u0111\u1ec1u ch\u1ee9a \u00edt nh\u1ea5t m\u1ed9t th\u1ee9 t\u1ef1 topo.</p> <p>M\u1ed9t b\u00e0i to\u00e1n ph\u1ed5 bi\u1ebfn trong \u0111\u00f3 s\u1eafp x\u1ebfp topo x\u1ea3y ra l\u00e0 nh\u01b0 sau. C\u00f3 $n$ bi\u1ebfn v\u1edbi c\u00e1c gi\u00e1 tr\u1ecb ch\u01b0a bi\u1ebft. \u0110\u1ed1i v\u1edbi m\u1ed9t s\u1ed1 bi\u1ebfn, ch\u00fang ta bi\u1ebft r\u1eb1ng bi\u1ebfn n\u00e0y nh\u1ecf h\u01a1n bi\u1ebfn kia. B\u1ea1n ph\u1ea3i ki\u1ec3m tra xem c\u00e1c r\u00e0ng bu\u1ed9c n\u00e0y c\u00f3 m\u00e2u thu\u1eabn hay kh\u00f4ng, v\u00e0 n\u1ebfu kh\u00f4ng, h\u00e3y xu\u1ea5t ra c\u00e1c bi\u1ebfn theo th\u1ee9 t\u1ef1 t\u0103ng d\u1ea7n (n\u1ebfu c\u00f3 th\u1ec3 c\u00f3 nhi\u1ec1u c\u00e2u tr\u1ea3 l\u1eddi, h\u00e3y xu\u1ea5t ra b\u1ea5t k\u1ef3 c\u00e2u tr\u1ea3 l\u1eddi n\u00e0o). D\u1ec5 d\u00e0ng nh\u1eadn th\u1ea5y r\u1eb1ng \u0111\u00e2y ch\u00ednh x\u00e1c l\u00e0 b\u00e0i to\u00e1n t\u00ecm th\u1ee9 t\u1ef1 topo c\u1ee7a m\u1ed9t \u0111\u1ed3 th\u1ecb v\u1edbi $n$ \u0111\u1ec9nh.</p>","tags":["Translated"]},{"location":"graph/topological-sort.html#the-algorithm","title":"Thu\u1eadt to\u00e1n (The Algorithm)","text":"<p>\u0110\u1ec3 gi\u1ea3i quy\u1ebft b\u00e0i to\u00e1n n\u00e0y, ch\u00fang ta s\u1ebd s\u1eed d\u1ee5ng t\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u.</p> <p>Gi\u1ea3 s\u1eed r\u1eb1ng \u0111\u1ed3 th\u1ecb kh\u00f4ng c\u00f3 chu tr\u00ecnh. T\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u l\u00e0m g\u00ec?</p> <p>Khi b\u1eaft \u0111\u1ea7u t\u1eeb m\u1ed9t \u0111\u1ec9nh $v$ n\u00e0o \u0111\u00f3, DFS c\u1ed1 g\u1eafng \u0111i qua t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh \u0111i ra t\u1eeb $v$. N\u00f3 d\u1eebng l\u1ea1i \u1edf c\u00e1c c\u1ea1nh m\u00e0 c\u00e1c \u0111\u1ea7u c\u1ee7a ch\u00fang \u0111\u00e3 \u0111\u01b0\u1ee3c th\u0103m tr\u01b0\u1edbc \u0111\u00f3, v\u00e0 \u0111i qua c\u00e1c c\u1ea1nh c\u00f2n l\u1ea1i v\u00e0 ti\u1ebfp t\u1ee5c \u0111\u1ec7 quy t\u1ea1i c\u00e1c \u0111\u1ea7u c\u1ee7a ch\u00fang.</p> <p>Do \u0111\u00f3, v\u00e0o th\u1eddi \u0111i\u1ec3m l\u1ec7nh g\u1ecdi h\u00e0m $\\text{dfs}(v)$ k\u1ebft th\u00fac, t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh c\u00f3 th\u1ec3 truy c\u1eadp t\u1eeb $v$ \u0111\u00e3 \u0111\u01b0\u1ee3c th\u0103m tr\u1ef1c ti\u1ebfp (th\u00f4ng qua m\u1ed9t c\u1ea1nh) ho\u1eb7c gi\u00e1n ti\u1ebfp b\u1edfi t\u00ecm ki\u1ebfm.</p> <p>H\u00e3y th\u00eam \u0111\u1ec9nh $v$ v\u00e0o m\u1ed9t danh s\u00e1ch, khi ch\u00fang ta k\u1ebft th\u00fac $\\text{dfs}(v)$. V\u00ec t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh c\u00f3 th\u1ec3 truy c\u1eadp \u0111\u00e3 \u0111\u01b0\u1ee3c th\u0103m, ch\u00fang s\u1ebd n\u1eb1m trong danh s\u00e1ch khi ch\u00fang ta th\u00eam $v$. H\u00e3y l\u00e0m \u0111i\u1ec1u n\u00e0y cho m\u1ecdi \u0111\u1ec9nh trong \u0111\u1ed3 th\u1ecb, v\u1edbi m\u1ed9t ho\u1eb7c nhi\u1ec1u l\u1ea7n ch\u1ea1y t\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u. \u0110\u1ed1i v\u1edbi m\u1ed7i c\u1ea1nh c\u00f3 h\u01b0\u1edbng $v \\rightarrow u$ trong \u0111\u1ed3 th\u1ecb, $u$ s\u1ebd xu\u1ea5t hi\u1ec7n s\u1edbm h\u01a1n trong danh s\u00e1ch n\u00e0y so v\u1edbi $v$, b\u1edfi v\u00ec $u$ c\u00f3 th\u1ec3 truy c\u1eadp \u0111\u01b0\u1ee3c t\u1eeb $v$. V\u00ec v\u1eady, n\u1ebfu ch\u00fang ta ch\u1ec9 \u0111\u00e1nh d\u1ea5u c\u00e1c \u0111\u1ec9nh trong danh s\u00e1ch n\u00e0y v\u1edbi $n-1, n-2, \\dots, 1, 0$, ch\u00fang ta \u0111\u00e3 t\u00ecm th\u1ea5y m\u1ed9t th\u1ee9 t\u1ef1 topo c\u1ee7a \u0111\u1ed3 th\u1ecb. N\u00f3i c\u00e1ch kh\u00e1c, danh s\u00e1ch \u0111\u1ea1i di\u1ec7n cho th\u1ee9 t\u1ef1 topo b\u1ecb \u0111\u1ea3o ng\u01b0\u1ee3c.</p> <p>Nh\u1eefng gi\u1ea3i th\u00edch n\u00e0y c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c tr\u00ecnh b\u00e0y d\u01b0\u1edbi d\u1ea1ng th\u1eddi gian tho\u00e1t (exit times) c\u1ee7a thu\u1eadt to\u00e1n DFS. Th\u1eddi gian tho\u00e1t cho \u0111\u1ec9nh $v$ l\u00e0 th\u1eddi gian m\u00e0 l\u1ec7nh g\u1ecdi h\u00e0m $\\text{dfs}(v)$ k\u1ebft th\u00fac (th\u1eddi gian c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c \u0111\u00e1nh s\u1ed1 t\u1eeb $0$ \u0111\u1ebfn $n-1$). D\u1ec5 hi\u1ec3u l\u00e0 th\u1eddi gian tho\u00e1t c\u1ee7a b\u1ea5t k\u1ef3 \u0111\u1ec9nh $v$ n\u00e0o lu\u00f4n l\u1edbn h\u01a1n th\u1eddi gian tho\u00e1t c\u1ee7a b\u1ea5t k\u1ef3 \u0111\u1ec9nh n\u00e0o c\u00f3 th\u1ec3 truy c\u1eadp t\u1eeb n\u00f3 (v\u00ec ch\u00fang \u0111\u00e3 \u0111\u01b0\u1ee3c th\u0103m tr\u01b0\u1edbc khi g\u1ecdi $\\text{dfs}(v)$ ho\u1eb7c trong qu\u00e1 tr\u00ecnh \u0111\u00f3). Do \u0111\u00f3, th\u1ee9 t\u1ef1 topo mong mu\u1ed1n l\u00e0 c\u00e1c \u0111\u1ec9nh theo th\u1ee9 t\u1ef1 gi\u1ea3m d\u1ea7n c\u1ee7a th\u1eddi gian tho\u00e1t c\u1ee7a ch\u00fang.</p>","tags":["Translated"]},{"location":"graph/topological-sort.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u1ed9t c\u00e0i \u0111\u1eb7t gi\u1ea3 \u0111\u1ecbnh r\u1eb1ng \u0111\u1ed3 th\u1ecb kh\u00f4ng c\u00f3 chu tr\u00ecnh, t\u1ee9c l\u00e0 th\u1ee9 t\u1ef1 topo mong mu\u1ed1n t\u1ed3n t\u1ea1i. N\u1ebfu c\u1ea7n thi\u1ebft, b\u1ea1n c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng ki\u1ec3m tra xem \u0111\u1ed3 th\u1ecb c\u00f3 kh\u00f4ng c\u00f3 chu tr\u00ecnh hay kh\u00f4ng, nh\u01b0 \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 trong b\u00e0i vi\u1ebft v\u1ec1 t\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u.</p> <pre><code>int n; // s\u1ed1 l\u01b0\u1ee3ng \u0111\u1ec9nh\nvector&lt;vector&lt;int&gt;&gt; adj; // danh s\u00e1ch k\u1ec1 c\u1ee7a \u0111\u1ed3 th\u1ecb\nvector&lt;bool&gt; visited;\nvector&lt;int&gt; ans;\n\nvoid dfs(int v) {\n    visited[v] = true;\n    for (int u : adj[v]) {\n        if (!visited[u]) {\n            dfs(u);\n        }\n    }\n    ans.push_back(v);\n}\n\nvoid topological_sort() {\n    visited.assign(n, false);\n    ans.clear();\n    for (int i = 0; i &lt; n; ++i) {\n        if (!visited[i]) {\n            dfs(i);\n        }\n    }\n    reverse(ans.begin(), ans.end());\n}\n</code></pre> <p>H\u00e0m ch\u00ednh c\u1ee7a gi\u1ea3i ph\u00e1p l\u00e0 <code>topological_sort</code>, kh\u1edfi t\u1ea1o c\u00e1c bi\u1ebfn DFS, kh\u1edfi ch\u1ea1y DFS v\u00e0 nh\u1eadn c\u00e2u tr\u1ea3 l\u1eddi trong vector <code>ans</code>. C\u1ea7n l\u01b0u \u00fd r\u1eb1ng khi \u0111\u1ed3 th\u1ecb kh\u00f4ng ph\u1ea3i l\u00e0 kh\u00f4ng c\u00f3 chu tr\u00ecnh (t\u1ee9c l\u00e0 c\u00f3 chu tr\u00ecnh), k\u1ebft qu\u1ea3 <code>topological_sort</code> v\u1eabn s\u1ebd c\u00f3 \u00fd ngh\u0129a \u1edf m\u1ed9t kh\u00eda c\u1ea1nh n\u00e0o \u0111\u00f3 l\u00e0 n\u1ebfu m\u1ed9t \u0111\u1ec9nh $u$ c\u00f3 th\u1ec3 truy c\u1eadp t\u1eeb \u0111\u1ec9nh $v$, nh\u01b0ng kh\u00f4ng ng\u01b0\u1ee3c l\u1ea1i (not vice versa), th\u00ec \u0111\u1ec9nh $v$ s\u1ebd lu\u00f4n \u0111i tr\u01b0\u1edbc trong m\u1ea3ng k\u1ebft qu\u1ea3. Thu\u1ed9c t\u00ednh n\u00e0y c\u1ee7a c\u00e0i \u0111\u1eb7t \u0111\u01b0\u1ee3c cung c\u1ea5p \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng trong thu\u1eadt to\u00e1n Kosaraju \u0111\u1ec3 tr\u00edch xu\u1ea5t c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1ea1nh v\u00e0 s\u1eafp x\u1ebfp topo c\u1ee7a ch\u00fang trong m\u1ed9t \u0111\u1ed3 th\u1ecb c\u00f3 h\u01b0\u1edbng c\u00f3 chu tr\u00ecnh.</p>","tags":["Translated"]},{"location":"graph/topological-sort.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>SPOJ TOPOSORT - Topological Sorting [difficulty: easy]</li> <li>UVA 10305 - Ordering Tasks [difficulty: easy]</li> <li>UVA 124 - Following Orders [difficulty: easy]</li> <li>UVA 200 - Rare Order [difficulty: easy]</li> <li>Codeforces 510C - Fox and Names [difficulty: easy]</li> <li>SPOJ RPLA - Answer the boss!</li> <li>CSES - Course Schedule</li> <li>CSES - Longest Flight Route</li> <li>CSES - Game Routes</li> </ul>","tags":["Translated"]},{"location":"graph/tree_painting.html","title":"T\u00f4 m\u00e0u c\u00e1c c\u1ea1nh c\u1ee7a c\u00e2y (Paint the edges of the tree)","text":"<p>\u0110\u00e2y l\u00e0 m\u1ed9t nhi\u1ec7m v\u1ee5 kh\u00e1 ph\u1ed5 bi\u1ebfn. Cho m\u1ed9t c\u00e2y $G$ v\u1edbi $N$ \u0111\u1ec9nh. C\u00f3 hai lo\u1ea1i truy v\u1ea5n: truy v\u1ea5n \u0111\u1ea7u ti\u00ean l\u00e0 t\u00f4 m\u00e0u m\u1ed9t c\u1ea1nh, truy v\u1ea5n th\u1ee9 hai l\u00e0 truy v\u1ea5n s\u1ed1 l\u01b0\u1ee3ng c\u1ea1nh \u0111\u01b0\u1ee3c t\u00f4 m\u00e0u gi\u1eefa hai \u0111\u1ec9nh.</p> <p>\u1ede \u0111\u00e2y ch\u00fang ta s\u1ebd m\u00f4 t\u1ea3 m\u1ed9t gi\u1ea3i ph\u00e1p kh\u00e1 \u0111\u01a1n gi\u1ea3n (s\u1eed d\u1ee5ng segment tree) s\u1ebd tr\u1ea3 l\u1eddi m\u1ed7i truy v\u1ea5n trong th\u1eddi gian $O(\\log N)$. B\u01b0\u1edbc ti\u1ec1n x\u1eed l\u00fd s\u1ebd m\u1ea5t th\u1eddi gian $O(N)$.</p>","tags":["Translated"]},{"location":"graph/tree_painting.html#algorithm","title":"Thu\u1eadt to\u00e1n (Algorithm)","text":"<p>\u0110\u1ea7u ti\u00ean, ch\u00fang ta c\u1ea7n t\u00ecm LCA \u0111\u1ec3 gi\u1ea3m m\u1ed7i truy v\u1ea5n lo\u1ea1i th\u1ee9 hai $(i,j)$ th\u00e0nh hai truy v\u1ea5n $(l,i)$ v\u00e0 $(l,j)$, trong \u0111\u00f3 $l$ l\u00e0 LCA c\u1ee7a $i$ v\u00e0 $j$. C\u00e2u tr\u1ea3 l\u1eddi c\u1ee7a truy v\u1ea5n $(i,j)$ s\u1ebd l\u00e0 t\u1ed5ng c\u1ee7a c\u1ea3 hai truy v\u1ea5n con. C\u1ea3 hai truy v\u1ea5n n\u00e0y \u0111\u1ec1u c\u00f3 c\u1ea5u tr\u00fac \u0111\u1eb7c bi\u1ec7t, \u0111\u1ec9nh \u0111\u1ea7u ti\u00ean l\u00e0 t\u1ed5 ti\u00ean c\u1ee7a \u0111\u1ec9nh th\u1ee9 hai. Trong ph\u1ea7n c\u00f2n l\u1ea1i c\u1ee7a b\u00e0i vi\u1ebft, ch\u00fang ta s\u1ebd ch\u1ec9 n\u00f3i v\u1ec1 lo\u1ea1i truy v\u1ea5n \u0111\u1eb7c bi\u1ec7t n\u00e0y.</p> <p>Ch\u00fang ta s\u1ebd b\u1eaft \u0111\u1ea7u b\u1eb1ng c\u00e1ch m\u00f4 t\u1ea3 b\u01b0\u1edbc ti\u1ec1n x\u1eed l\u00fd. Ch\u1ea1y t\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u (DFS) t\u1eeb g\u1ed1c c\u1ee7a c\u00e2y v\u00e0 ghi l\u1ea1i Euler tour c\u1ee7a t\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u n\u00e0y (m\u1ed7i \u0111\u1ec9nh \u0111\u01b0\u1ee3c th\u00eam v\u00e0o danh s\u00e1ch khi t\u00ecm ki\u1ebfm th\u0103m n\u00f3 l\u1ea7n \u0111\u1ea7u ti\u00ean v\u00e0 m\u1ed7i l\u1ea7n ch\u00fang ta quay l\u1ea1i t\u1eeb m\u1ed9t trong c\u00e1c con c\u1ee7a n\u00f3). K\u1ef9 thu\u1eadt t\u01b0\u01a1ng t\u1ef1 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng trong ti\u1ec1n x\u1eed l\u00fd LCA.</p> <p>Danh s\u00e1ch n\u00e0y s\u1ebd ch\u1ee9a m\u1ed7i c\u1ea1nh (theo ngh\u0129a l\u00e0 n\u1ebfu $i$ v\u00e0 $j$ l\u00e0 c\u00e1c \u0111\u1ea7u c\u1ee7a c\u1ea1nh, th\u00ec s\u1ebd c\u00f3 m\u1ed9t ch\u1ed7 trong danh s\u00e1ch m\u00e0 $i$ v\u00e0 $j$ l\u00e0 h\u00e0ng x\u00f3m trong danh s\u00e1ch), v\u00e0 n\u00f3 xu\u1ea5t hi\u1ec7n ch\u00ednh x\u00e1c hai l\u1ea7n: theo h\u01b0\u1edbng thu\u1eadn (t\u1eeb $i$ \u0111\u1ebfn $j$, trong \u0111\u00f3 \u0111\u1ec9nh $i$ g\u1ea7n g\u1ed1c h\u01a1n \u0111\u1ec9nh $j$) v\u00e0 theo h\u01b0\u1edbng ng\u01b0\u1ee3c l\u1ea1i (t\u1eeb $j$ \u0111\u1ebfn $i$).</p> <p>Ch\u00fang ta s\u1ebd x\u00e2y d\u1ef1ng hai danh s\u00e1ch cho c\u00e1c c\u1ea1nh n\u00e0y. Danh s\u00e1ch \u0111\u1ea7u ti\u00ean s\u1ebd l\u01b0u tr\u1eef m\u00e0u c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh theo h\u01b0\u1edbng thu\u1eadn, v\u00e0 danh s\u00e1ch th\u1ee9 hai l\u01b0u tr\u1eef m\u00e0u c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh theo h\u01b0\u1edbng ng\u01b0\u1ee3c l\u1ea1i. Ch\u00fang ta s\u1ebd s\u1eed d\u1ee5ng $1$ n\u1ebfu c\u1ea1nh \u0111\u01b0\u1ee3c t\u00f4 m\u00e0u, v\u00e0 $0$ n\u1ebfu ng\u01b0\u1ee3c l\u1ea1i. Tr\u00ean hai danh s\u00e1ch n\u00e0y, ch\u00fang ta s\u1ebd x\u00e2y d\u1ef1ng m\u1ed7i danh s\u00e1ch m\u1ed9t c\u00e2y ph\u00e2n \u0111o\u1ea1n (segment tree) (cho t\u1ed5ng v\u1edbi m\u1ed9t s\u1eeda \u0111\u1ed5i \u0111\u01a1n l\u1ebb), h\u00e3y g\u1ecdi ch\u00fang l\u00e0 $T1$ v\u00e0 $T2$.</p> <p>H\u00e3y \u0111\u1ec3 ch\u00fang t\u00f4i tr\u1ea3 l\u1eddi m\u1ed9t truy v\u1ea5n c\u00f3 d\u1ea1ng $(i,j)$, trong \u0111\u00f3 $i$ l\u00e0 t\u1ed5 ti\u00ean c\u1ee7a $j$. Ch\u00fang ta c\u1ea7n x\u00e1c \u0111\u1ecbnh c\u00f3 bao nhi\u00eau c\u1ea1nh \u0111\u01b0\u1ee3c t\u00f4 m\u00e0u tr\u00ean \u0111\u01b0\u1eddng \u0111i gi\u1eefa $i$ v\u00e0 $j$. H\u00e3y t\u00ecm $i$ v\u00e0 $j$ trong Euler tour l\u1ea7n \u0111\u1ea7u ti\u00ean, gi\u1ea3 s\u1eed \u0111\u00f3 l\u00e0 c\u00e1c v\u1ecb tr\u00ed $p$ v\u00e0 $q$ (vi\u1ec7c n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong $O(1)$ n\u1ebfu ch\u00fang ta t\u00ednh to\u00e1n c\u00e1c v\u1ecb tr\u00ed n\u00e0y tr\u01b0\u1edbc trong qu\u00e1 tr\u00ecnh ti\u1ec1n x\u1eed l\u00fd). Khi \u0111\u00f3 c\u00e2u tr\u1ea3 l\u1eddi cho truy v\u1ea5n l\u00e0 t\u1ed5ng $T1[p..q-1]$ tr\u1eeb \u0111i t\u1ed5ng $T2[p..q-1]$.</p> <p>T\u1ea1i sao? Xem x\u00e9t \u0111o\u1ea1n $[p;q]$ trong Euler tour. N\u00f3 ch\u1ee9a t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh c\u1ee7a \u0111\u01b0\u1eddng \u0111i ch\u00fang ta c\u1ea7n t\u1eeb $i$ \u0111\u1ebfn $j$ nh\u01b0ng c\u0169ng ch\u1ee9a m\u1ed9t t\u1eadp h\u1ee3p c\u00e1c c\u1ea1nh n\u1eb1m tr\u00ean c\u00e1c \u0111\u01b0\u1eddng \u0111i kh\u00e1c t\u1eeb $i$. Tuy nhi\u00ean, c\u00f3 m\u1ed9t s\u1ef1 kh\u00e1c bi\u1ec7t l\u1edbn gi\u1eefa c\u00e1c c\u1ea1nh ch\u00fang ta c\u1ea7n v\u00e0 c\u00e1c c\u1ea1nh c\u00f2n l\u1ea1i: c\u00e1c c\u1ea1nh ch\u00fang ta c\u1ea7n s\u1ebd ch\u1ec9 \u0111\u01b0\u1ee3c li\u1ec7t k\u00ea m\u1ed9t l\u1ea7n theo h\u01b0\u1edbng thu\u1eadn, v\u00e0 t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh kh\u00e1c xu\u1ea5t hi\u1ec7n hai l\u1ea7n: m\u1ed9t l\u1ea7n theo h\u01b0\u1edbng thu\u1eadn v\u00e0 m\u1ed9t l\u1ea7n theo h\u01b0\u1edbng ng\u01b0\u1ee3c l\u1ea1i. Do \u0111\u00f3, hi\u1ec7u $T1[p..q-1] - T2[p..q-1]$ s\u1ebd cho ch\u00fang ta c\u00e2u tr\u1ea3 l\u1eddi ch\u00ednh x\u00e1c (tr\u1eeb m\u1ed9t l\u00e0 c\u1ea7n thi\u1ebft v\u00ec n\u1ebfu kh\u00f4ng, ch\u00fang ta s\u1ebd b\u1eaft th\u00eam m\u1ed9t c\u1ea1nh \u0111i ra t\u1eeb \u0111\u1ec9nh $j$). Truy v\u1ea5n t\u1ed5ng trong segment tree \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong $O(\\log N)$.</p> <p>Tr\u1ea3 l\u1eddi lo\u1ea1i truy v\u1ea5n \u0111\u1ea7u ti\u00ean (t\u00f4 m\u00e0u m\u1ed9t c\u1ea1nh) th\u1eadm ch\u00ed c\u00f2n d\u1ec5 d\u00e0ng h\u01a1n - ch\u00fang ta ch\u1ec9 c\u1ea7n c\u1eadp nh\u1eadt $T1$ v\u00e0 $T2$, c\u1ee5 th\u1ec3 l\u00e0 th\u1ef1c hi\u1ec7n m\u1ed9t b\u1ea3n c\u1eadp nh\u1eadt duy nh\u1ea5t c\u1ee7a ph\u1ea7n t\u1eed t\u01b0\u01a1ng \u1ee9ng v\u1edbi c\u1ea1nh c\u1ee7a ch\u00fang ta (t\u00ecm c\u1ea1nh trong danh s\u00e1ch, m\u1ed9t l\u1ea7n n\u1eefa, l\u00e0 c\u00f3 th\u1ec3 trong $O(1)$, n\u1ebfu b\u1ea1n th\u1ef1c hi\u1ec7n t\u00ecm ki\u1ebfm n\u00e0y trong qu\u00e1 tr\u00ecnh ti\u1ec1n x\u1eed l\u00fd). M\u1ed9t s\u1eeda \u0111\u1ed5i \u0111\u01a1n l\u1ebb trong segment tree \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong $O(\\log N)$.</p>","tags":["Translated"]},{"location":"graph/tree_painting.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 c\u00e0i \u0111\u1eb7t \u0111\u1ea7y \u0111\u1ee7 c\u1ee7a gi\u1ea3i ph\u00e1p, bao g\u1ed3m c\u1ea3 t\u00ednh to\u00e1n LCA:</p> <pre><code>const int INF = 1000 * 1000 * 1000;\n\ntypedef vector&lt;vector&lt;int&gt;&gt; graph;\n\nvector&lt;int&gt; dfs_list;\nvector&lt;int&gt; edges_list;\nvector&lt;int&gt; h;\n\nvoid dfs(int v, const graph&amp; g, const graph&amp; edge_ids, int cur_h = 1) {\n    h[v] = cur_h;\n    dfs_list.push_back(v);\n    for (size_t i = 0; i &lt; g[v].size(); ++i) {\n        if (h[g[v][i]] == -1) {\n            edges_list.push_back(edge_ids[v][i]);\n            dfs(g[v][i], g, edge_ids, cur_h + 1);\n            edges_list.push_back(edge_ids[v][i]);\n            dfs_list.push_back(v);\n        }\n    }\n}\n\nvector&lt;int&gt; lca_tree;\nvector&lt;int&gt; first;\n\nvoid lca_tree_build(int i, int l, int r) {\n    if (l == r) {\n        lca_tree[i] = dfs_list[l];\n    } else {\n        int m = (l + r) &gt;&gt; 1;\n        lca_tree_build(i + i, l, m);\n        lca_tree_build(i + i + 1, m + 1, r);\n        int lt = lca_tree[i + i], rt = lca_tree[i + i + 1];\n        lca_tree[i] = h[lt] &lt; h[rt] ? lt : rt;\n    }\n}\n\nvoid lca_prepare(int n) {\n    lca_tree.assign(dfs_list.size() * 8, -1);\n    lca_tree_build(1, 0, (int)dfs_list.size() - 1);\n\n    first.assign(n, -1);\n    for (int i = 0; i &lt; (int)dfs_list.size(); ++i) {\n        int v = dfs_list[i];\n        if (first[v] == -1)\n            first[v] = i;\n    }\n}\n\nint lca_tree_query(int i, int tl, int tr, int l, int r) {\n    if (tl == l &amp;&amp; tr == r)\n        return lca_tree[i];\n    int m = (tl + tr) &gt;&gt; 1;\n    if (r &lt;= m)\n        return lca_tree_query(i + i, tl, m, l, r);\n    if (l &gt; m)\n        return lca_tree_query(i + i + 1, m + 1, tr, l, r);\n    int lt = lca_tree_query(i + i, tl, m, l, m);\n    int rt = lca_tree_query(i + i + 1, m + 1, tr, m + 1, r);\n    return h[lt] &lt; h[rt] ? lt : rt;\n}\n\nint lca(int a, int b) {\n    if (first[a] &gt; first[b])\n        swap(a, b);\n    return lca_tree_query(1, 0, (int)dfs_list.size() - 1, first[a], first[b]);\n}\n\nvector&lt;int&gt; first1, first2;\nvector&lt;char&gt; edge_used;\nvector&lt;int&gt; tree1, tree2;\n\nvoid query_prepare(int n) {\n    first1.resize(n - 1, -1);\n    first2.resize(n - 1, -1);\n    for (int i = 0; i &lt; (int)edges_list.size(); ++i) {\n        int j = edges_list[i];\n        if (first1[j] == -1)\n            first1[j] = i;\n        else\n            first2[j] = i;\n    }\n\n    edge_used.resize(n - 1);\n    tree1.resize(edges_list.size() * 8);\n    tree2.resize(edges_list.size() * 8);\n}\n\nvoid sum_tree_update(vector&lt;int&gt;&amp; tree, int i, int l, int r, int j, int delta) {\n    tree[i] += delta;\n    if (l &lt; r) {\n        int m = (l + r) &gt;&gt; 1;\n        if (j &lt;= m)\n            sum_tree_update(tree, i + i, l, m, j, delta);\n        else\n            sum_tree_update(tree, i + i + 1, m + 1, r, j, delta);\n    }\n}\n\nint sum_tree_query(const vector&lt;int&gt;&amp; tree, int i, int tl, int tr, int l, int r) {\n    if (l &gt; r || tl &gt; tr)\n        return 0;\n    if (tl == l &amp;&amp; tr == r)\n        return tree[i];\n    int m = (tl + tr) &gt;&gt; 1;\n    if (r &lt;= m)\n        return sum_tree_query(tree, i + i, tl, m, l, r);\n    if (l &gt; m)\n        return sum_tree_query(tree, i + i + 1, m + 1, tr, l, r);\n    return sum_tree_query(tree, i + i, tl, m, l, m) +\n           sum_tree_query(tree, i + i + 1, m + 1, tr, m + 1, r);\n}\n\nint query(int v1, int v2) {\n    return sum_tree_query(tree1, 1, 0, (int)edges_list.size() - 1, first[v1], first[v2] - 1) -\n           sum_tree_query(tree2, 1, 0, (int)edges_list.size() - 1, first[v1], first[v2] - 1);\n}\n\nint main() {\n    // reading the graph\n    int n;\n    scanf(\"%d\", &amp;n);\n    graph g(n), edge_ids(n);\n    for (int i = 0; i &lt; n - 1; ++i) {\n        int v1, v2;\n        scanf(\"%d%d\", &amp;v1, &amp;v2);\n        --v1, --v2;\n        g[v1].push_back(v2);\n        g[v2].push_back(v1);\n        edge_ids[v1].push_back(i);\n        edge_ids[v2].push_back(i);\n    }\n\n    h.assign(n, -1);\n    dfs(0, g, edge_ids);\n    lca_prepare(n);\n    query_prepare(n);\n\n    for (;;) {\n        if () {\n            // request for painting edge x;\n            // if start = true, then the edge is painted, otherwise the painting\n            // is removed\n            edge_used[x] = start;\n            sum_tree_update(tree1, 1, 0, (int)edges_list.size() - 1, first1[x],\n                            start ? 1 : -1);\n            sum_tree_update(tree2, 1, 0, (int)edges_list.size() - 1, first2[x],\n                            start ? 1 : -1);\n        } else {\n            // query the number of colored edges on the path between v1 and v2\n            int l = lca(v1, v2);\n            int result = query(l, v1) + query(l, v2);\n            // result - the answer to the request\n        }\n    }\n}\n</code></pre>","tags":["Translated"]},{"location":"linear_algebra/determinant-gauss.html","title":"T\u00ednh \u0111\u1ecbnh th\u1ee9c c\u1ee7a ma tr\u1eadn b\u1eb1ng ph\u01b0\u01a1ng ph\u00e1p Gauss (Calculating the determinant of a matrix by Gauss)","text":"<p>B\u00e0i to\u00e1n: Cho ma tr\u1eadn $A$ k\u00edch th\u01b0\u1edbc $N \\times N$. T\u00ednh \u0111\u1ecbnh th\u1ee9c c\u1ee7a n\u00f3.</p>","tags":["Translated"]},{"location":"linear_algebra/determinant-gauss.html#algorithm","title":"Thu\u1eadt to\u00e1n (Algorithm)","text":"<p>Ch\u00fang t\u00f4i s\u1eed d\u1ee5ng \u00fd t\u01b0\u1edfng c\u1ee7a Ph\u01b0\u01a1ng ph\u00e1p Gauss \u0111\u1ec3 gi\u1ea3i h\u1ec7 ph\u01b0\u01a1ng tr\u00ecnh tuy\u1ebfn t\u00ednh</p> <p>Ch\u00fang ta s\u1ebd th\u1ef1c hi\u1ec7n c\u00e1c b\u01b0\u1edbc gi\u1ed1ng nh\u01b0 trong gi\u1ea3i h\u1ec7 ph\u01b0\u01a1ng tr\u00ecnh tuy\u1ebfn t\u00ednh, ch\u1ec9 lo\u1ea1i tr\u1eeb vi\u1ec7c chia d\u00f2ng hi\u1ec7n t\u1ea1i cho $a_{ij}$. C\u00e1c ph\u00e9p to\u00e1n n\u00e0y s\u1ebd kh\u00f4ng thay \u0111\u1ed5i gi\u00e1 tr\u1ecb tuy\u1ec7t \u0111\u1ed1i c\u1ee7a \u0111\u1ecbnh th\u1ee9c c\u1ee7a ma tr\u1eadn. Tuy nhi\u00ean, khi ch\u00fang ta trao \u0111\u1ed5i hai d\u00f2ng c\u1ee7a ma tr\u1eadn, d\u1ea5u c\u1ee7a \u0111\u1ecbnh th\u1ee9c c\u00f3 th\u1ec3 thay \u0111\u1ed5i.</p> <p>Sau khi \u00e1p d\u1ee5ng Gauss tr\u00ean ma tr\u1eadn, ch\u00fang t\u00f4i nh\u1eadn \u0111\u01b0\u1ee3c m\u1ed9t ma tr\u1eadn \u0111\u01b0\u1eddng ch\u00e9o, c\u00f3 \u0111\u1ecbnh th\u1ee9c ch\u1ec9 l\u00e0 t\u00edch c\u1ee7a c\u00e1c ph\u1ea7n t\u1eed tr\u00ean \u0111\u01b0\u1eddng ch\u00e9o. D\u1ea5u, nh\u01b0 \u0111\u00e3 \u0111\u1ec1 c\u1eadp tr\u01b0\u1edbc \u0111\u00e2y, c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh b\u1edfi s\u1ed1 l\u01b0\u1ee3ng d\u00f2ng \u0111\u01b0\u1ee3c trao \u0111\u1ed5i (n\u1ebfu l\u1ebb, th\u00ec d\u1ea5u c\u1ee7a \u0111\u1ecbnh th\u1ee9c n\u00ean \u0111\u01b0\u1ee3c \u0111\u1ea3o ng\u01b0\u1ee3c). Do \u0111\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng thu\u1eadt to\u00e1n Gauss \u0111\u1ec3 t\u00ednh to\u00e1n \u0111\u1ecbnh th\u1ee9c c\u1ee7a ma tr\u1eadn v\u1edbi \u0111\u1ed9 ph\u1ee9c t\u1ea1p $O(N^3)$.</p> <p>C\u1ea7n l\u01b0u \u00fd r\u1eb1ng n\u1ebfu t\u1ea1i m\u1ed9t th\u1eddi \u0111i\u1ec3m n\u00e0o \u0111\u00f3, ch\u00fang ta kh\u00f4ng t\u00ecm th\u1ea5y \u00f4 kh\u00e1c kh\u00f4ng trong c\u1ed9t hi\u1ec7n t\u1ea1i, thu\u1eadt to\u00e1n s\u1ebd d\u1eebng v\u00e0 tr\u1ea3 v\u1ec1 0.</p>","tags":["Translated"]},{"location":"linear_algebra/determinant-gauss.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<pre><code>const double EPS = 1E-9;\nint n;\nvector &lt; vector&lt;double&gt; &gt; a (n, vector&lt;double&gt; (n));\n\ndouble det = 1;\nfor (int i=0; i&lt;n; ++i) {\n    int k = i;\n    for (int j=i+1; j&lt;n; ++j)\n        if (abs (a[j][i]) &gt; abs (a[k][i]))\n            k = j;\n    if (abs (a[k][i]) &lt; EPS) {\n        det = 0;\n        break;\n    }\n    swap (a[i], a[k]);\n    if (i != k)\n        det = -det;\n    det *= a[i][i];\n    for (int j=i+1; j&lt;n; ++j)\n        a[i][j] /= a[i][i];\n    for (int j=0; j&lt;n; ++j)\n        if (j != i &amp;&amp; abs (a[j][i]) &gt; EPS)\n            for (int k=i+1; k&lt;n; ++k)\n                a[j][k] -= a[i][k] * a[j][i];\n}\n\ncout &lt;&lt; det;\n</code></pre>","tags":["Translated"]},{"location":"linear_algebra/determinant-gauss.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>Codeforces - Wizards and Bets</li> </ul>","tags":["Translated"]},{"location":"linear_algebra/determinant-kraut.html","title":"T\u00ednh \u0111\u1ecbnh th\u1ee9c b\u1eb1ng ph\u01b0\u01a1ng ph\u00e1p Kraut trong $O(N^3)$ (Calculating the determinant using Kraut method in $O(N^3)$)","text":"<p>Trong b\u00e0i vi\u1ebft n\u00e0y, ch\u00fang t\u00f4i s\u1ebd m\u00f4 t\u1ea3 c\u00e1ch t\u00ecm \u0111\u1ecbnh th\u1ee9c c\u1ee7a ma tr\u1eadn b\u1eb1ng ph\u01b0\u01a1ng ph\u00e1p Kraut, ph\u01b0\u01a1ng ph\u00e1p n\u00e0y ho\u1ea1t \u0111\u1ed9ng trong $O(N^3)$.</p> <p>Thu\u1eadt to\u00e1n Kraut t\u00ecm c\u00e1ch ph\u00e2n r\u00e3 ma tr\u1eadn $A$ d\u01b0\u1edbi d\u1ea1ng $A = L U$ trong \u0111\u00f3 $L$ l\u00e0 ma tr\u1eadn tam gi\u00e1c d\u01b0\u1edbi v\u00e0 $U$ l\u00e0 ma tr\u1eadn tam gi\u00e1c tr\u00ean. Kh\u00f4ng m\u1ea5t t\u00ednh t\u1ed5ng qu\u00e1t, ch\u00fang ta c\u00f3 th\u1ec3 gi\u1ea3 \u0111\u1ecbnh r\u1eb1ng t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed \u0111\u01b0\u1eddng ch\u00e9o c\u1ee7a $L$ \u0111\u1ec1u b\u1eb1ng 1. M\u1ed9t khi ch\u00fang ta bi\u1ebft c\u00e1c ma tr\u1eadn n\u00e0y, th\u1eadt d\u1ec5 d\u00e0ng \u0111\u1ec3 t\u00ednh to\u00e1n \u0111\u1ecbnh th\u1ee9c c\u1ee7a $A$: n\u00f3 b\u1eb1ng t\u00edch c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed tr\u00ean \u0111\u01b0\u1eddng ch\u00e9o ch\u00ednh c\u1ee7a ma tr\u1eadn $U$.</p> <p>C\u00f3 m\u1ed9t \u0111\u1ecbnh l\u00fd n\u00f3i r\u1eb1ng b\u1ea5t k\u1ef3 ma tr\u1eadn ngh\u1ecbch \u0111\u1ea3o n\u00e0o c\u0169ng c\u00f3 ph\u00e2n r\u00e3 LU, v\u00e0 n\u00f3 l\u00e0 duy nh\u1ea5t, khi v\u00e0 ch\u1ec9 khi t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ecbnh th\u1ee9c con ch\u00ednh c\u1ee7a n\u00f3 \u0111\u1ec1u kh\u00e1c kh\u00f4ng. Ch\u00fang t\u00f4i ch\u1ec9 xem x\u00e9t ph\u00e2n r\u00e3 nh\u01b0 v\u1eady trong \u0111\u00f3 \u0111\u01b0\u1eddng ch\u00e9o c\u1ee7a ma tr\u1eadn $L$ bao g\u1ed3m c\u00e1c s\u1ed1 m\u1ed9t.</p> <p>G\u1ecdi $A$ l\u00e0 ma tr\u1eadn v\u00e0 $N$ - k\u00edch th\u01b0\u1edbc c\u1ee7a n\u00f3. Ch\u00fang ta s\u1ebd t\u00ecm c\u00e1c ph\u1ea7n t\u1eed c\u1ee7a ma tr\u1eadn $L$ v\u00e0 $U$ b\u1eb1ng c\u00e1c b\u01b0\u1edbc sau:</p> <ol> <li>\u0110\u1eb7t $L_{i i} = 1$ cho $i = 1, 2, ..., N$.</li> <li> <p>\u0110\u1ed1i v\u1edbi m\u1ed7i $j = 1, 2, ..., N$ th\u1ef1c hi\u1ec7n:</p> <ul> <li> <p>\u0110\u1ed1i v\u1edbi $i = 1, 2, ..., j$ t\u00ecm c\u00e1c gi\u00e1 tr\u1ecb </p> $$U_{ij} = A_{ij} - \\sum_{k=1}^{i-1} L_{ik} \\cdot U_{kj}$$ </li> <li> <p>Ti\u1ebfp theo, \u0111\u1ed1i v\u1edbi $i = j+1, j+2, ..., N$ t\u00ecm c\u00e1c gi\u00e1 tr\u1ecb</p> $$L_{ij} = \\frac{1}{U_{jj}} \\left(A_{ij} - \\sum_{k=1}^{j-1} L_{ik} \\cdot U_{kj} \\right).$$ </li> </ul> </li> </ol>","tags":["Original"]},{"location":"linear_algebra/determinant-kraut.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<pre><code>static BigInteger det (BigDecimal a [][], int n) {\n    try {\n\n    for (int i=0; i&lt;n; i++) {\n        boolean nonzero = false;\n        for (int j=0; j&lt;n; j++)\n            if (a[i][j].compareTo (new BigDecimal (BigInteger.ZERO)) &gt; 0)\n                nonzero = true;\n        if (!nonzero)\n            return BigInteger.ZERO;\n    }\n\n    BigDecimal scaling [] = new BigDecimal [n];\n    for (int i=0; i&lt;n; i++) {\n        BigDecimal big = new BigDecimal (BigInteger.ZERO);\n        for (int j=0; j&lt;n; j++)\n            if (a[i][j].abs().compareTo (big) &gt; 0)\n                big = a[i][j].abs();\n        scaling[i] = (new BigDecimal (BigInteger.ONE)) .divide\n            (big, 100, BigDecimal.ROUND_HALF_EVEN);\n    }\n\n    int sign = 1;\n\n    for (int j=0; j&lt;n; j++) {\n        for (int i=0; i&lt;j; i++) {\n            BigDecimal sum = a[i][j];\n            for (int k=0; k&lt;i; k++)\n                sum = sum.subtract (a[i][k].multiply (a[k][j]));\n            a[i][j] = sum;\n        }\n\n        BigDecimal big = new BigDecimal (BigInteger.ZERO);\n        int imax = -1;\n        for (int i=j; i&lt;n; i++) {\n            BigDecimal sum = a[i][j];\n            for (int k=0; k&lt;j; k++)\n                sum = sum.subtract (a[i][k].multiply (a[k][j]));\n            a[i][j] = sum;\n            BigDecimal cur = sum.abs();\n            cur = cur.multiply (scaling[i]);\n            if (cur.compareTo (big) &gt;= 0) {\n                big = cur;\n                imax = i;\n            }\n        }\n\n        if (j != imax) {\n            for (int k=0; k&lt;n; k++) {\n                BigDecimal t = a[j][k];\n                a[j][k] = a[imax][k];\n                a[imax][k] = t;\n            }\n\n            BigDecimal t = scaling[imax];\n            scaling[imax] = scaling[j];\n            scaling[j] = t;\n\n            sign = -sign;\n        }\n\n        if (j != n-1)\n            for (int i=j+1; i&lt;n; i++)\n                a[i][j] = a[i][j].divide\n                    (a[j][j], 100, BigDecimal.ROUND_HALF_EVEN);\n\n    }\n\n    BigDecimal result = new BigDecimal (1);\n    if (sign == -1)\n        result = result.negate();\n    for (int i=0; i&lt;n; i++)\n        result = result.multiply (a[i][i]);\n\n    return result.divide\n        (BigDecimal.valueOf(1), 0, BigDecimal.ROUND_HALF_EVEN).toBigInteger();\n    }\n    catch (Exception e) {\n        return BigInteger.ZERO;\n    }\n}\n</code></pre>","tags":["Original"]},{"location":"linear_algebra/linear-system-gauss.html","title":"Ph\u01b0\u01a1ng ph\u00e1p Gauss \u0111\u1ec3 gi\u1ea3i h\u1ec7 ph\u01b0\u01a1ng tr\u00ecnh tuy\u1ebfn t\u00ednh (Gauss method for solving system of linear equations)","text":"<p>Cho m\u1ed9t h\u1ec7 g\u1ed3m $n$ ph\u01b0\u01a1ng tr\u00ecnh \u0111\u1ea1i s\u1ed1 tuy\u1ebfn t\u00ednh (System of Linear Algebraic Equations - SLAE) v\u1edbi $m$ \u1ea9n s\u1ed1. B\u1ea1n \u0111\u01b0\u1ee3c y\u00eau c\u1ea7u gi\u1ea3i h\u1ec7 ph\u01b0\u01a1ng tr\u00ecnh: x\u00e1c \u0111\u1ecbnh xem n\u00f3 kh\u00f4ng c\u00f3 nghi\u1ec7m, c\u00f3 \u0111\u00fang m\u1ed9t nghi\u1ec7m hay c\u00f3 v\u00f4 s\u1ed1 nghi\u1ec7m. V\u00e0 trong tr\u01b0\u1eddng h\u1ee3p n\u00f3 c\u00f3 \u00edt nh\u1ea5t m\u1ed9t nghi\u1ec7m, h\u00e3y t\u00ecm b\u1ea5t k\u1ef3 nghi\u1ec7m n\u00e0o trong s\u1ed1 \u0111\u00f3.</p> <p>M\u1ed9t c\u00e1ch h\u00ecnh th\u1ee9c, b\u00e0i to\u00e1n \u0111\u01b0\u1ee3c ph\u00e1t bi\u1ec3u nh\u01b0 sau: gi\u1ea3i h\u1ec7 ph\u01b0\u01a1ng tr\u00ecnh:</p> $$\\begin{align} a_{11} x_1 + a_{12} x_2 + &amp;\\dots + a_{1m} x_m = b_1 \\\\ a_{21} x_1 + a_{22} x_2 + &amp;\\dots + a_{2m} x_m = b_2\\\\ &amp;\\vdots \\\\ a_{n1} x_1 + a_{n2} x_2 + &amp;\\dots + a_{nm} x_m = b_n \\end{align}$$ <p>trong \u0111\u00f3 c\u00e1c h\u1ec7 s\u1ed1 $a_{ij}$ (v\u1edbi $i$ t\u1eeb 1 \u0111\u1ebfn $n$, $j$ t\u1eeb 1 \u0111\u1ebfn $m$) v\u00e0 $b_i$ ($i$ t\u1eeb 1 \u0111\u1ebfn $n$) \u0111\u00e3 bi\u1ebft v\u00e0 c\u00e1c bi\u1ebfn s\u1ed1 $x_i$ ($i$ t\u1eeb 1 \u0111\u1ebfn $m$) l\u00e0 \u1ea9n s\u1ed1.</p> <p>B\u00e0i to\u00e1n n\u00e0y c\u0169ng c\u00f3 bi\u1ec3u di\u1ec5n ma tr\u1eadn \u0111\u01a1n gi\u1ea3n:</p> $$Ax = b,$$ <p>trong \u0111\u00f3 $A$ l\u00e0 ma tr\u1eadn k\u00edch th\u01b0\u1edbc $n \\times m$ c\u1ee7a c\u00e1c h\u1ec7 s\u1ed1 $a_{ij}$ v\u00e0 $b$ l\u00e0 vect\u01a1 c\u1ed9t k\u00edch th\u01b0\u1edbc $n$.</p> <p>C\u1ea7n l\u01b0u \u00fd r\u1eb1ng ph\u01b0\u01a1ng ph\u00e1p \u0111\u01b0\u1ee3c tr\u00ecnh b\u00e0y trong b\u00e0i vi\u1ebft n\u00e0y c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 gi\u1ea3i ph\u01b0\u01a1ng tr\u00ecnh \u0111\u1ed3ng d\u01b0 modulo p b\u1ea5t k\u1ef3, t\u1ee9c l\u00e0:</p> $$\\begin{align} a_{11} x_1 + a_{12} x_2 + &amp;\\dots + a_{1m} x_m \\equiv b_1 \\pmod p \\\\ a_{21} x_1 + a_{22} x_2 + &amp;\\dots + a_{2m} x_m \\equiv b_2 \\pmod p \\\\ &amp;\\vdots \\\\ a_{n1} x_1 + a_{n2} x_2 + &amp;\\dots + a_{nm} x_m \\equiv b_n \\pmod p \\end{align}$$","tags":["Translated"]},{"location":"linear_algebra/linear-system-gauss.html#gauss","title":"Gauss","text":"<p>N\u00f3i m\u1ed9t c\u00e1ch ch\u00ednh x\u00e1c, ph\u01b0\u01a1ng ph\u00e1p \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 d\u01b0\u1edbi \u0111\u00e2y n\u00ean \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 \"Gauss-Jordan\", ho\u1eb7c kh\u1eed Gauss-Jordan (Gauss-Jordan elimination), b\u1edfi v\u00ec n\u00f3 l\u00e0 m\u1ed9t bi\u1ebfn th\u1ec3 c\u1ee7a ph\u01b0\u01a1ng ph\u00e1p Gauss, \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 b\u1edfi Jordan v\u00e0o n\u0103m 1887.</p>","tags":["Translated"]},{"location":"linear_algebra/linear-system-gauss.html#overview","title":"T\u1ed5ng quan (Overview)","text":"<p>Thu\u1eadt to\u00e1n l\u00e0 m\u1ed9t s\u1ef1 <code>kh\u1eed tu\u1ea7n t\u1ef1</code> (<code>sequential elimination</code>) c\u00e1c bi\u1ebfn trong m\u1ed7i ph\u01b0\u01a1ng tr\u00ecnh, cho \u0111\u1ebfn khi m\u1ed7i ph\u01b0\u01a1ng tr\u00ecnh ch\u1ec9 c\u00f2n l\u1ea1i m\u1ed9t bi\u1ebfn. N\u1ebfu $n = m$, b\u1ea1n c\u00f3 th\u1ec3 ngh\u0129 v\u1ec1 n\u00f3 nh\u01b0 l\u00e0 bi\u1ebfn \u0111\u1ed5i ma tr\u1eadn $A$ th\u00e0nh ma tr\u1eadn \u0111\u01a1n v\u1ecb, v\u00e0 gi\u1ea3i ph\u01b0\u01a1ng tr\u00ecnh trong tr\u01b0\u1eddng h\u1ee3p hi\u1ec3n nhi\u00ean n\u00e0y, trong \u0111\u00f3 nghi\u1ec7m l\u00e0 duy nh\u1ea5t v\u00e0 b\u1eb1ng h\u1ec7 s\u1ed1 $b_i$.</p> <p>Kh\u1eed Gaussian d\u1ef1a tr\u00ean hai ph\u00e9p bi\u1ebfn \u0111\u1ed5i \u0111\u01a1n gi\u1ea3n:</p> <ul> <li>C\u00f3 th\u1ec3 ho\u00e1n \u0111\u1ed5i hai ph\u01b0\u01a1ng tr\u00ecnh</li> <li>B\u1ea5t k\u1ef3 ph\u01b0\u01a1ng tr\u00ecnh n\u00e0o c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c thay th\u1ebf b\u1eb1ng t\u1ed5 h\u1ee3p tuy\u1ebfn t\u00ednh c\u1ee7a h\u00e0ng \u0111\u00f3 (v\u1edbi h\u1ec7 s\u1ed1 kh\u00e1c kh\u00f4ng), v\u00e0 m\u1ed9t s\u1ed1 h\u00e0ng kh\u00e1c (v\u1edbi c\u00e1c h\u1ec7 s\u1ed1 t\u00f9y \u00fd).</li> </ul> <p>Trong b\u01b0\u1edbc \u0111\u1ea7u ti\u00ean, thu\u1eadt to\u00e1n Gauss-Jordan chia h\u00e0ng \u0111\u1ea7u ti\u00ean cho $a_{11}$. Sau \u0111\u00f3, thu\u1eadt to\u00e1n c\u1ed9ng h\u00e0ng \u0111\u1ea7u ti\u00ean v\u00e0o c\u00e1c h\u00e0ng c\u00f2n l\u1ea1i sao cho c\u00e1c h\u1ec7 s\u1ed1 trong c\u1ed9t \u0111\u1ea7u ti\u00ean tr\u1edf th\u00e0nh t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 kh\u00f4ng. \u0110\u1ec3 \u0111\u1ea1t \u0111\u01b0\u1ee3c \u0111i\u1ec1u n\u00e0y, tr\u00ean h\u00e0ng th\u1ee9 $i$, ch\u00fang ta ph\u1ea3i th\u00eam h\u00e0ng \u0111\u1ea7u ti\u00ean nh\u00e2n v\u1edbi $- a_{i1}$. L\u01b0u \u00fd r\u1eb1ng, thao t\u00e1c n\u00e0y c\u0169ng ph\u1ea3i \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n tr\u00ean vect\u01a1 $b$. Theo m\u1ed9t ngh\u0129a n\u00e0o \u0111\u00f3, n\u00f3 ho\u1ea1t \u0111\u1ed9ng nh\u01b0 th\u1ec3 vect\u01a1 $b$ l\u00e0 c\u1ed9t th\u1ee9 $m+1$ c\u1ee7a ma tr\u1eadn $A$.</p> <p>K\u1ebft qu\u1ea3 l\u00e0, sau b\u01b0\u1edbc \u0111\u1ea7u ti\u00ean, c\u1ed9t \u0111\u1ea7u ti\u00ean c\u1ee7a ma tr\u1eadn $A$ s\u1ebd bao g\u1ed3m $1$ tr\u00ean h\u00e0ng \u0111\u1ea7u ti\u00ean v\u00e0 $0$ \u1edf c\u00e1c h\u00e0ng kh\u00e1c.</p> <p>T\u01b0\u01a1ng t\u1ef1, ch\u00fang ta th\u1ef1c hi\u1ec7n b\u01b0\u1edbc th\u1ee9 hai c\u1ee7a thu\u1eadt to\u00e1n, trong \u0111\u00f3 ch\u00fang ta xem x\u00e9t c\u1ed9t th\u1ee9 hai c\u1ee7a h\u00e0ng th\u1ee9 hai. \u0110\u1ea7u ti\u00ean, h\u00e0ng \u0111\u01b0\u1ee3c chia cho $a_{22}$, sau \u0111\u00f3 n\u00f3 \u0111\u01b0\u1ee3c tr\u1eeb \u0111i t\u1eeb c\u00e1c h\u00e0ng kh\u00e1c sao cho t\u1ea5t c\u1ea3 c\u1ed9t th\u1ee9 hai tr\u1edf th\u00e0nh $0$ (ngo\u1ea1i tr\u1eeb h\u00e0ng th\u1ee9 hai).</p> <p>Ch\u00fang ta ti\u1ebfp t\u1ee5c qu\u00e1 tr\u00ecnh n\u00e0y cho t\u1ea5t c\u1ea3 c\u00e1c c\u1ed9t c\u1ee7a ma tr\u1eadn $A$. N\u1ebfu $n = m$, th\u00ec $A$ s\u1ebd tr\u1edf th\u00e0nh ma tr\u1eadn \u0111\u01a1n v\u1ecb.</p>","tags":["Translated"]},{"location":"linear_algebra/linear-system-gauss.html#search-for-the-pivoting-element","title":"T\u00ecm ki\u1ebfm ph\u1ea7n t\u1eed tr\u1ee5 (Search for the pivoting element)","text":"<p>L\u01b0\u1ee3c \u0111\u1ed3 \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 \u0111\u00e3 b\u1ecf qua nhi\u1ec1u chi ti\u1ebft. T\u1ea1i b\u01b0\u1edbc th\u1ee9 $i$, n\u1ebfu $a_{ii}$ b\u1eb1ng kh\u00f4ng, ch\u00fang ta kh\u00f4ng th\u1ec3 \u00e1p d\u1ee5ng tr\u1ef1c ti\u1ebfp ph\u01b0\u01a1ng ph\u00e1p \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3. Thay v\u00e0o \u0111\u00f3, tr\u01b0\u1edbc ti\u00ean ch\u00fang ta ph\u1ea3i <code>ch\u1ecdn m\u1ed9t h\u00e0ng tr\u1ee5</code> (<code>select a pivoting row</code>): t\u00ecm m\u1ed9t h\u00e0ng c\u1ee7a ma tr\u1eadn m\u00e0 c\u1ed9t th\u1ee9 $i$ kh\u00e1c kh\u00f4ng, sau \u0111\u00f3 tr\u00e1o \u0111\u1ed5i hai h\u00e0ng.</p> <p>L\u01b0u \u00fd r\u1eb1ng, \u1edf \u0111\u00e2y ch\u00fang ta tr\u00e1o \u0111\u1ed5i c\u00e1c h\u00e0ng nh\u01b0ng kh\u00f4ng tr\u00e1o \u0111\u1ed5i c\u00e1c c\u1ed9t. \u0110i\u1ec1u n\u00e0y l\u00e0 do n\u1ebfu b\u1ea1n tr\u00e1o \u0111\u1ed5i c\u00e1c c\u1ed9t, th\u00ec khi b\u1ea1n t\u00ecm th\u1ea5y m\u1ed9t nghi\u1ec7m, b\u1ea1n ph\u1ea3i nh\u1edb tr\u00e1o \u0111\u1ed5i l\u1ea1i \u0111\u00fang v\u1ecb tr\u00ed. Do \u0111\u00f3, vi\u1ec7c tr\u00e1o \u0111\u1ed5i c\u00e1c h\u00e0ng d\u1ec5 th\u1ef1c hi\u1ec7n h\u01a1n nhi\u1ec1u.</p> <p>Trong nhi\u1ec1u tri\u1ec3n khai, khi $a_{ii} \\neq 0$, b\u1ea1n c\u00f3 th\u1ec3 th\u1ea5y m\u1ecdi ng\u01b0\u1eddi v\u1eabn tr\u00e1o \u0111\u1ed5i h\u00e0ng th\u1ee9 $i$ v\u1edbi m\u1ed9t s\u1ed1 h\u00e0ng tr\u1ee5, s\u1eed d\u1ee5ng m\u1ed9t s\u1ed1 ph\u1ecfng \u0111o\u00e1n (heuristics) ch\u1eb3ng h\u1ea1n nh\u01b0 ch\u1ecdn h\u00e0ng tr\u1ee5 c\u00f3 gi\u00e1 tr\u1ecb tuy\u1ec7t \u0111\u1ed1i l\u1edbn nh\u1ea5t c\u1ee7a $a_{ji}$. Ph\u1ecfng \u0111o\u00e1n n\u00e0y \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 gi\u1ea3m ph\u1ea1m vi gi\u00e1 tr\u1ecb c\u1ee7a ma tr\u1eadn trong c\u00e1c b\u01b0\u1edbc sau. N\u1ebfu kh\u00f4ng c\u00f3 ph\u1ecfng \u0111o\u00e1n n\u00e0y, ngay c\u1ea3 \u0111\u1ed1i v\u1edbi c\u00e1c ma tr\u1eadn c\u00f3 k\u00edch th\u01b0\u1edbc kho\u1ea3ng $20$, sai s\u1ed1 s\u1ebd qu\u00e1 l\u1edbn v\u00e0 c\u00f3 th\u1ec3 g\u00e2y tr\u00e0n s\u1ed1 \u0111\u1ed1i v\u1edbi c\u00e1c lo\u1ea1i d\u1eef li\u1ec7u d\u1ea5u ph\u1ea9y \u0111\u1ed9ng c\u1ee7a C++.</p>","tags":["Translated"]},{"location":"linear_algebra/linear-system-gauss.html#degenerate-cases","title":"C\u00e1c tr\u01b0\u1eddng h\u1ee3p suy bi\u1ebfn (Degenerate cases)","text":"<p>Trong tr\u01b0\u1eddng h\u1ee3p $m = n$ v\u00e0 h\u1ec7 th\u1ed1ng kh\u00f4ng suy bi\u1ebfn (t\u1ee9c l\u00e0 n\u00f3 c\u00f3 \u0111\u1ecbnh th\u1ee9c kh\u00e1c kh\u00f4ng v\u00e0 c\u00f3 nghi\u1ec7m duy nh\u1ea5t), thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 \u1edf tr\u00ean s\u1ebd bi\u1ebfn \u0111\u1ed5i $A$ th\u00e0nh ma tr\u1eadn \u0111\u01a1n v\u1ecb.</p> <p>B\u00e2y gi\u1edd ch\u00fang ta xem x\u00e9t <code>tr\u01b0\u1eddng h\u1ee3p t\u1ed5ng qu\u00e1t</code> (<code>general case</code>), trong \u0111\u00f3 $n$ v\u00e0 $m$ kh\u00f4ng nh\u1ea5t thi\u1ebft ph\u1ea3i b\u1eb1ng nhau v\u00e0 h\u1ec7 th\u1ed1ng c\u00f3 th\u1ec3 b\u1ecb suy bi\u1ebfn. Trong nh\u1eefng tr\u01b0\u1eddng h\u1ee3p n\u00e0y, ph\u1ea7n t\u1eed tr\u1ee5 trong b\u01b0\u1edbc th\u1ee9 $i$ c\u00f3 th\u1ec3 kh\u00f4ng t\u00ecm th\u1ea5y. \u0110i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 tr\u00ean c\u1ed9t th\u1ee9 $i$, b\u1eaft \u0111\u1ea7u t\u1eeb d\u00f2ng hi\u1ec7n t\u1ea1i, t\u1ea5t c\u1ea3 \u0111\u1ec1u ch\u1ee9a s\u1ed1 kh\u00f4ng. Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, ho\u1eb7c kh\u00f4ng c\u00f3 gi\u00e1 tr\u1ecb n\u00e0o c\u1ee7a bi\u1ebfn $x_i$ (ngh\u0129a l\u00e0 SLAE kh\u00f4ng c\u00f3 nghi\u1ec7m), ho\u1eb7c $x_i$ l\u00e0 m\u1ed9t bi\u1ebfn \u0111\u1ed9c l\u1eadp v\u00e0 c\u00f3 th\u1ec3 nh\u1eadn gi\u00e1 tr\u1ecb t\u00f9y \u00fd. Khi tri\u1ec3n khai Gauss-Jordan, b\u1ea1n n\u00ean ti\u1ebfp t\u1ee5c c\u00f4ng vi\u1ec7c cho c\u00e1c bi\u1ebfn ti\u1ebfp theo v\u00e0 ch\u1ec9 c\u1ea7n b\u1ecf qua c\u1ed9t th\u1ee9 $i$ (\u0111i\u1ec1u n\u00e0y t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi vi\u1ec7c x\u00f3a c\u1ed9t th\u1ee9 $i$ c\u1ee7a ma tr\u1eadn).</p> <p>V\u00ec v\u1eady, m\u1ed9t s\u1ed1 bi\u1ebfn trong qu\u00e1 tr\u00ecnh c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c coi l\u00e0 \u0111\u1ed9c l\u1eadp. Khi s\u1ed1 l\u01b0\u1ee3ng bi\u1ebfn, $m$ l\u1edbn h\u01a1n s\u1ed1 l\u01b0\u1ee3ng ph\u01b0\u01a1ng tr\u00ecnh, $n$, th\u00ec \u00edt nh\u1ea5t $m - n$ bi\u1ebfn \u0111\u1ed9c l\u1eadp s\u1ebd \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y.</p> <p>Nh\u00ecn chung, n\u1ebfu b\u1ea1n t\u00ecm th\u1ea5y \u00edt nh\u1ea5t m\u1ed9t bi\u1ebfn \u0111\u1ed9c l\u1eadp, n\u00f3 c\u00f3 th\u1ec3 nh\u1eadn b\u1ea5t k\u1ef3 gi\u00e1 tr\u1ecb t\u00f9y \u00fd n\u00e0o, trong khi c\u00e1c bi\u1ebfn kh\u00e1c (ph\u1ee5 thu\u1ed9c) \u0111\u01b0\u1ee3c bi\u1ec3u th\u1ecb qua n\u00f3. \u0110i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 khi ch\u00fang ta l\u00e0m vi\u1ec7c trong tr\u01b0\u1eddng s\u1ed1 th\u1ef1c, h\u1ec7 th\u1ed1ng c\u00f3 kh\u1ea3 n\u0103ng c\u00f3 v\u00f4 s\u1ed1 nghi\u1ec7m. Nh\u01b0ng b\u1ea1n n\u00ean nh\u1edb r\u1eb1ng khi c\u00f3 c\u00e1c bi\u1ebfn \u0111\u1ed9c l\u1eadp, SLAE ho\u00e0n to\u00e0n c\u00f3 th\u1ec3 kh\u00f4ng c\u00f3 nghi\u1ec7m. \u0110i\u1ec1u n\u00e0y x\u1ea3y ra khi c\u00e1c ph\u01b0\u01a1ng tr\u00ecnh ch\u01b0a \u0111\u01b0\u1ee3c x\u1eed l\u00fd c\u00f2n l\u1ea1i c\u00f3 \u00edt nh\u1ea5t m\u1ed9t h\u1eb1ng s\u1ed1 kh\u00e1c kh\u00f4ng. B\u1ea1n c\u00f3 th\u1ec3 ki\u1ec3m tra \u0111i\u1ec1u n\u00e0y b\u1eb1ng c\u00e1ch g\u00e1n s\u1ed1 kh\u00f4ng cho t\u1ea5t c\u1ea3 c\u00e1c bi\u1ebfn \u0111\u1ed9c l\u1eadp, t\u00ednh to\u00e1n c\u00e1c bi\u1ebfn kh\u00e1c v\u00e0 sau \u0111\u00f3 thay v\u00e0o SLAE ban \u0111\u1ea7u \u0111\u1ec3 ki\u1ec3m tra xem ch\u00fang c\u00f3 th\u1ecfa m\u00e3n n\u00f3 hay kh\u00f4ng.</p>","tags":["Translated"]},{"location":"linear_algebra/linear-system-gauss.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>Sau \u0111\u00e2y l\u00e0 m\u1ed9t tri\u1ec3n khai c\u1ee7a Gauss-Jordan. Vi\u1ec7c ch\u1ecdn h\u00e0ng tr\u1ee5 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n v\u1edbi ph\u1ecfng \u0111o\u00e1n: ch\u1ecdn gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t trong c\u1ed9t hi\u1ec7n t\u1ea1i.</p> <p>\u0110\u1ea7u v\u00e0o cho h\u00e0m <code>gauss</code> l\u00e0 ma tr\u1eadn h\u1ec7 th\u1ed1ng $a$. C\u1ed9t cu\u1ed1i c\u00f9ng c\u1ee7a ma tr\u1eadn n\u00e0y l\u00e0 vect\u01a1 $b$.</p> <p>H\u00e0m tr\u1ea3 v\u1ec1 s\u1ed1 l\u01b0\u1ee3ng nghi\u1ec7m c\u1ee7a h\u1ec7 th\u1ed1ng $(0, 1,\\textrm{ho\u1eb7c } \\infty)$. N\u1ebfu t\u1ed3n t\u1ea1i \u00edt nh\u1ea5t m\u1ed9t nghi\u1ec7m, th\u00ec n\u00f3 \u0111\u01b0\u1ee3c tr\u1ea3 v\u1ec1 trong vect\u01a1 $ans$.</p> <pre><code>const double EPS = 1e-9;\nconst int INF = 2; // n\u00f3 th\u1ef1c s\u1ef1 kh\u00f4ng c\u1ea7n ph\u1ea3i l\u00e0 v\u00f4 c\u00f9ng ho\u1eb7c m\u1ed9t s\u1ed1 l\u1edbn\n\nint gauss (vector &lt; vector&lt;double&gt; &gt; a, vector&lt;double&gt; &amp; ans) {\n    int n = (int) a.size();\n    int m = (int) a[0].size() - 1;\n\n    vector&lt;int&gt; where (m, -1);\n    for (int col=0, row=0; col&lt;m &amp;&amp; row&lt;n; ++col) {\n        int sel = row;\n        for (int i=row; i&lt;n; ++i)\n            if (abs (a[i][col]) &gt; abs (a[sel][col]))\n                sel = i;\n        if (abs (a[sel][col]) &lt; EPS)\n            continue;\n        for (int i=col; i&lt;=m; ++i)\n            swap (a[sel][i], a[row][i]);\n        where[col] = row;\n\n        for (int i=0; i&lt;n; ++i)\n            if (i != row) {\n                double c = a[i][col] / a[row][col];\n                for (int j=col; j&lt;=m; ++j)\n                    a[i][j] -= a[row][j] * c;\n            }\n        ++row;\n    }\n\n    ans.assign (m, 0);\n    for (int i=0; i&lt;m; ++i)\n        if (where[i] != -1)\n            ans[i] = a[where[i]][m] / a[where[i]][i];\n    for (int i=0; i&lt;n; ++i) {\n        double sum = 0;\n        for (int j=0; j&lt;m; ++j)\n            sum += ans[j] * a[i][j];\n        if (abs (sum - a[i][m]) &gt; EPS)\n            return 0;\n    }\n\n    for (int i=0; i&lt;m; ++i)\n        if (where[i] == -1)\n            return INF;\n    return 1;\n}\n</code></pre> <p>Ghi ch\u00fa tri\u1ec3n khai:</p> <ul> <li>H\u00e0m s\u1eed d\u1ee5ng hai con tr\u1ecf - c\u1ed9t hi\u1ec7n t\u1ea1i $col$ v\u00e0 h\u00e0ng hi\u1ec7n t\u1ea1i $row$.</li> <li>\u0110\u1ed1i v\u1edbi m\u1ed7i bi\u1ebfn $x_i$, gi\u00e1 tr\u1ecb $where(i)$ l\u00e0 d\u00f2ng m\u00e0 c\u1ed9t n\u00e0y kh\u00f4ng b\u1eb1ng kh\u00f4ng. Vect\u01a1 n\u00e0y l\u00e0 c\u1ea7n thi\u1ebft v\u00ec m\u1ed9t s\u1ed1 bi\u1ebfn c\u00f3 th\u1ec3 \u0111\u1ed9c l\u1eadp.</li> <li>Trong tri\u1ec3n khai n\u00e0y, d\u00f2ng th\u1ee9 $i$ hi\u1ec7n t\u1ea1i kh\u00f4ng chia cho $a_{ii}$ nh\u01b0 m\u00f4 t\u1ea3 \u1edf tr\u00ean, v\u00ec v\u1eady cu\u1ed1i c\u00f9ng ma tr\u1eadn kh\u00f4ng ph\u1ea3i l\u00e0 ma tr\u1eadn \u0111\u01a1n v\u1ecb (m\u1eb7c d\u00f9 r\u00f5 r\u00e0ng vi\u1ec7c chia d\u00f2ng th\u1ee9 $i$ c\u00f3 th\u1ec3 gi\u00fap gi\u1ea3m sai s\u1ed1).</li> <li>Sau khi t\u00ecm th\u1ea5y m\u1ed9t nghi\u1ec7m, n\u00f3 \u0111\u01b0\u1ee3c ch\u00e8n l\u1ea1i v\u00e0o ma tr\u1eadn - \u0111\u1ec3 ki\u1ec3m tra xem h\u1ec7 th\u1ed1ng c\u00f3 \u00edt nh\u1ea5t m\u1ed9t nghi\u1ec7m hay kh\u00f4ng. N\u1ebfu nghi\u1ec7m th\u1eed nghi\u1ec7m th\u00e0nh c\u00f4ng, th\u00ec h\u00e0m tr\u1ea3 v\u1ec1 1 ho\u1eb7c $\\inf$, t\u00f9y thu\u1ed9c v\u00e0o vi\u1ec7c c\u00f3 \u00edt nh\u1ea5t m\u1ed9t bi\u1ebfn \u0111\u1ed9c l\u1eadp hay kh\u00f4ng.</li> </ul>","tags":["Translated"]},{"location":"linear_algebra/linear-system-gauss.html#complexity","title":"\u0110\u1ed9 ph\u1ee9c t\u1ea1p (Complexity)","text":"<p>B\u00e2y gi\u1edd ch\u00fang ta n\u00ean \u01b0\u1edbc t\u00ednh \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a thu\u1eadt to\u00e1n n\u00e0y. Thu\u1eadt to\u00e1n bao g\u1ed3m $m$ giai \u0111o\u1ea1n, trong m\u1ed7i giai \u0111o\u1ea1n:</p> <ul> <li>T\u00ecm ki\u1ebfm v\u00e0 tr\u00e1o \u0111\u1ed5i h\u00e0ng tr\u1ee5. Vi\u1ec7c n\u00e0y m\u1ea5t $O(n + m)$ khi s\u1eed d\u1ee5ng ph\u1ecfng \u0111o\u00e1n \u0111\u01b0\u1ee3c \u0111\u1ec1 c\u1eadp \u1edf tr\u00ean.</li> <li>N\u1ebfu ph\u1ea7n t\u1eed tr\u1ee5 trong c\u1ed9t hi\u1ec7n t\u1ea1i \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y - th\u00ec ch\u00fang ta ph\u1ea3i th\u00eam ph\u01b0\u01a1ng tr\u00ecnh n\u00e0y v\u00e0o t\u1ea5t c\u1ea3 c\u00e1c ph\u01b0\u01a1ng tr\u00ecnh kh\u00e1c, m\u1ea5t th\u1eddi gian $O(nm)$.</li> </ul> <p>V\u00ec v\u1eady, \u0111\u1ed9 ph\u1ee9c t\u1ea1p cu\u1ed1i c\u00f9ng c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 $O(\\min (n, m) . nm)$. Trong tr\u01b0\u1eddng h\u1ee3p $n = m$, \u0111\u1ed9 ph\u1ee9c t\u1ea1p \u0111\u01a1n gi\u1ea3n l\u00e0 $O(n^3)$.</p> <p>L\u01b0u \u00fd r\u1eb1ng khi SLAE kh\u00f4ng n\u1eb1m tr\u00ean s\u1ed1 th\u1ef1c, m\u00e0 \u1edf modulo 2, th\u00ec h\u1ec7 th\u1ed1ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i nhanh h\u01a1n nhi\u1ec1u, \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 b\u00ean d\u01b0\u1edbi.</p>","tags":["Translated"]},{"location":"linear_algebra/linear-system-gauss.html#acceleration-of-the-algorithm","title":"T\u0103ng t\u1ed1c thu\u1eadt to\u00e1n (Acceleration of the algorithm)","text":"<p>Vi\u1ec7c tri\u1ec3n khai tr\u01b0\u1edbc \u0111\u00f3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u0103ng t\u1ed1c g\u1ea5p hai l\u1ea7n, b\u1eb1ng c\u00e1ch chia thu\u1eadt to\u00e1n th\u00e0nh hai giai \u0111o\u1ea1n: thu\u1eadn (forward) v\u00e0 ngh\u1ecbch (reverse):</p> <ul> <li>Giai \u0111o\u1ea1n thu\u1eadn: T\u01b0\u01a1ng t\u1ef1 nh\u01b0 tri\u1ec3n khai tr\u01b0\u1edbc, nh\u01b0ng h\u00e0ng hi\u1ec7n t\u1ea1i ch\u1ec9 \u0111\u01b0\u1ee3c th\u00eam v\u00e0o c\u00e1c h\u00e0ng sau n\u00f3. K\u1ebft qu\u1ea3 l\u00e0, ch\u00fang ta thu \u0111\u01b0\u1ee3c m\u1ed9t ma tr\u1eadn tam gi\u00e1c thay v\u00ec ma tr\u1eadn \u0111\u01b0\u1eddng ch\u00e9o.</li> <li>Giai \u0111o\u1ea1n ngh\u1ecbch: Khi ma tr\u1eadn l\u00e0 tam gi\u00e1c, \u0111\u1ea7u ti\u00ean ch\u00fang ta t\u00ednh gi\u00e1 tr\u1ecb c\u1ee7a bi\u1ebfn cu\u1ed1i c\u00f9ng. Sau \u0111\u00f3 thay gi\u00e1 tr\u1ecb n\u00e0y \u0111\u1ec3 t\u00ecm gi\u00e1 tr\u1ecb c\u1ee7a bi\u1ebfn ti\u1ebfp theo. Sau \u0111\u00f3 thay hai gi\u00e1 tr\u1ecb n\u00e0y \u0111\u1ec3 t\u00ecm c\u00e1c bi\u1ebfn ti\u1ebfp theo...</li> </ul> <p>Giai \u0111o\u1ea1n ngh\u1ecbch ch\u1ec9 m\u1ea5t $O(nm)$, nhanh h\u01a1n nhi\u1ec1u so v\u1edbi giai \u0111o\u1ea1n thu\u1eadn. Trong giai \u0111o\u1ea1n thu\u1eadn, ch\u00fang ta gi\u1ea3m m\u1ed9t n\u1eeda s\u1ed1 l\u01b0\u1ee3ng ph\u00e9p to\u00e1n, do \u0111\u00f3 gi\u1ea3m th\u1eddi gian ch\u1ea1y c\u1ee7a tri\u1ec3n khai.</p>","tags":["Translated"]},{"location":"linear_algebra/linear-system-gauss.html#solving-modular-slae","title":"Gi\u1ea3i SLAE m\u00f4-\u0111un (Solving modular SLAE)","text":"<p>\u0110\u1ec3 gi\u1ea3i SLAE trong m\u1ed9t m\u00f4-\u0111un n\u00e0o \u0111\u00f3, ch\u00fang ta v\u1eabn c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3. Tuy nhi\u00ean, trong tr\u01b0\u1eddng h\u1ee3p m\u00f4-\u0111un b\u1eb1ng 2, ch\u00fang ta c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n kh\u1eed Gauss-Jordan hi\u1ec7u qu\u1ea3 h\u01a1n nhi\u1ec1u b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng c\u00e1c ph\u00e9p to\u00e1n bit v\u00e0 ki\u1ec3u d\u1eef li\u1ec7u bitset c\u1ee7a C++:</p> <pre><code>int gauss (vector &lt; bitset&lt;N&gt; &gt; a, int n, int m, bitset&lt;N&gt; &amp; ans) {\n    vector&lt;int&gt; where (m, -1);\n    for (int col=0, row=0; col&lt;m &amp;&amp; row&lt;n; ++col) {\n        for (int i=row; i&lt;n; ++i)\n            if (a[i][col]) {\n                swap (a[i], a[row]);\n                break;\n            }\n        if (! a[row][col])\n            continue;\n        where[col] = row;\n\n        for (int i=0; i&lt;n; ++i)\n            if (i != row &amp;&amp; a[i][col])\n                a[i] ^= a[row];\n        ++row;\n    }\n        // Ph\u1ea7n c\u00f2n l\u1ea1i c\u1ee7a vi\u1ec7c tri\u1ec3n khai t\u01b0\u01a1ng t\u1ef1 nh\u01b0 tr\u00ean\n}\n</code></pre> <p>V\u00ec ch\u00fang ta s\u1eed d\u1ee5ng n\u00e9n bit, vi\u1ec7c tri\u1ec3n khai kh\u00f4ng ch\u1ec9 ng\u1eafn h\u01a1n m\u00e0 c\u00f2n nhanh h\u01a1n 32 l\u1ea7n.</p>","tags":["Translated"]},{"location":"linear_algebra/linear-system-gauss.html#heuristics","title":"M\u1ed9t ch\u00fat l\u01b0u \u00fd v\u1ec1 c\u00e1c ph\u1ecfng \u0111o\u00e1n kh\u00e1c nhau c\u1ee7a vi\u1ec7c ch\u1ecdn h\u00e0ng tr\u1ee5 (A little note about different heuristics of choosing pivoting row)","text":"<p>Kh\u00f4ng c\u00f3 quy t\u1eafc chung cho nh\u1eefng ph\u1ecfng \u0111o\u00e1n n\u00e0o \u0111\u1ec3 s\u1eed d\u1ee5ng.</p> <p>C\u00e1c ph\u1ecfng \u0111o\u00e1n \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng trong tri\u1ec3n khai tr\u01b0\u1edbc ho\u1ea1t \u0111\u1ed9ng kh\u00e1 t\u1ed1t trong th\u1ef1c t\u1ebf. N\u00f3 c\u0169ng cho ra k\u1ebft qu\u1ea3 g\u1ea7n nh\u01b0 gi\u1ed1ng h\u1ec7t nh\u01b0 \"tr\u1ee5 \u0111\u1ea7y \u0111\u1ee7\" (\"full pivoting\") - trong \u0111\u00f3 h\u00e0ng tr\u1ee5 \u0111\u01b0\u1ee3c t\u00ecm ki\u1ebfm gi\u1eefa t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed c\u1ee7a ma tr\u1eadn con (t\u1eeb h\u00e0ng hi\u1ec7n t\u1ea1i v\u00e0 c\u1ed9t hi\u1ec7n t\u1ea1i).</p> <p>Tuy nhi\u00ean, b\u1ea1n n\u00ean l\u01b0u \u00fd r\u1eb1ng c\u1ea3 hai ph\u1ecfng \u0111o\u00e1n \u0111\u1ec1u ph\u1ee5 thu\u1ed9c v\u00e0o m\u1ee9c \u0111\u1ed9 c\u00e1c ph\u01b0\u01a1ng tr\u00ecnh ban \u0111\u1ea7u \u0111\u01b0\u1ee3c thu ph\u00f3ng. V\u00ed d\u1ee5, n\u1ebfu m\u1ed9t trong c\u00e1c ph\u01b0\u01a1ng tr\u00ecnh \u0111\u01b0\u1ee3c nh\u00e2n v\u1edbi $10^6$, th\u00ec ph\u01b0\u01a1ng tr\u00ecnh n\u00e0y g\u1ea7n nh\u01b0 ch\u1eafc ch\u1eafn \u0111\u01b0\u1ee3c ch\u1ecdn l\u00e0m tr\u1ee5 trong b\u01b0\u1edbc \u0111\u1ea7u ti\u00ean. \u0110i\u1ec1u n\u00e0y c\u00f3 v\u1ebb kh\u00e1 l\u1ea1, v\u00ec v\u1eady c\u00f3 v\u1ebb h\u1ee3p l\u00fd khi chuy\u1ec3n sang m\u1ed9t ph\u1ecfng \u0111o\u00e1n ph\u1ee9c t\u1ea1p h\u01a1n, \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 <code>tr\u1ee5 ng\u1ea7m \u0111\u1ecbnh</code> (<code>implicit pivoting</code>).</p> <p>Tr\u1ee5 ng\u1ea7m \u0111\u1ecbnh so s\u00e1nh c\u00e1c ph\u1ea7n t\u1eed nh\u01b0 th\u1ec3 c\u1ea3 hai d\u00f2ng \u0111\u1ec1u \u0111\u01b0\u1ee3c chu\u1ea9n h\u00f3a, sao cho ph\u1ea7n t\u1eed l\u1edbn nh\u1ea5t s\u1ebd l\u00e0 \u0111\u01a1n v\u1ecb. \u0110\u1ec3 th\u1ef1c hi\u1ec7n k\u1ef9 thu\u1eadt n\u00e0y, ng\u01b0\u1eddi ta c\u1ea7n duy tr\u00ec gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t trong m\u1ed7i h\u00e0ng (ho\u1eb7c duy tr\u00ec t\u1eebng d\u00f2ng sao cho gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t l\u00e0 \u0111\u01a1n v\u1ecb, nh\u01b0ng \u0111i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 d\u1eabn \u0111\u1ebfn s\u1ef1 gia t\u0103ng sai s\u1ed1 t\u00edch l\u0169y).</p>","tags":["Translated"]},{"location":"linear_algebra/linear-system-gauss.html#improve-the-solution","title":"C\u1ea3i thi\u1ec7n nghi\u1ec7m (Improve the solution)","text":"<p>B\u1ea5t ch\u1ea5p c\u00e1c ph\u1ecfng \u0111o\u00e1n kh\u00e1c nhau, thu\u1eadt to\u00e1n Gauss-Jordan v\u1eabn c\u00f3 th\u1ec3 d\u1eabn \u0111\u1ebfn sai s\u1ed1 l\u1edbn trong c\u00e1c ma tr\u1eadn \u0111\u1eb7c bi\u1ec7t th\u1eadm ch\u00ed c\u00f3 k\u00edch th\u01b0\u1edbc $50 - 100$.</p> <p>Do \u0111\u00f3, gi\u1ea3i ph\u00e1p Gauss-Jordan k\u1ebft qu\u1ea3 \u0111\u00f4i khi ph\u1ea3i \u0111\u01b0\u1ee3c c\u1ea3i thi\u1ec7n b\u1eb1ng c\u00e1ch \u00e1p d\u1ee5ng m\u1ed9t ph\u01b0\u01a1ng ph\u00e1p s\u1ed1 \u0111\u01a1n gi\u1ea3n - v\u00ed d\u1ee5, ph\u01b0\u01a1ng ph\u00e1p l\u1eb7p \u0111\u01a1n.</p> <p>Do \u0111\u00f3, gi\u1ea3i ph\u00e1p bi\u1ebfn th\u00e0nh hai b\u01b0\u1edbc: \u0110\u1ea7u ti\u00ean, thu\u1eadt to\u00e1n Gauss-Jordan \u0111\u01b0\u1ee3c \u00e1p d\u1ee5ng, v\u00e0 sau \u0111\u00f3 m\u1ed9t ph\u01b0\u01a1ng ph\u00e1p s\u1ed1 l\u1ea5y nghi\u1ec7m ban \u0111\u1ea7u l\u00e0m nghi\u1ec7m trong b\u01b0\u1edbc \u0111\u1ea7u ti\u00ean.</p>","tags":["Translated"]},{"location":"linear_algebra/linear-system-gauss.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>Spoj - Xor Maximization</li> <li>Codechef - Knight Moving</li> <li>Lightoj - Graph Coloring</li> <li>UVA 12910 - Snakes and Ladders</li> <li>TIMUS1042 Central Heating</li> <li>TIMUS1766 Humpty Dumpty</li> <li>TIMUS1266 Kirchhoff's Law</li> <li>Codeforces - No game no life</li> </ul>","tags":["Translated"]},{"location":"linear_algebra/rank-matrix.html","title":"T\u00ecm h\u1ea1ng c\u1ee7a ma tr\u1eadn (Finding the rank of a matrix)","text":"<p>H\u1ea1ng c\u1ee7a ma tr\u1eadn (The rank of a matrix) l\u00e0 s\u1ed1 l\u01b0\u1ee3ng l\u1edbn nh\u1ea5t c\u00e1c h\u00e0ng/c\u1ed9t \u0111\u1ed9c l\u1eadp tuy\u1ebfn t\u00ednh c\u1ee7a ma tr\u1eadn. H\u1ea1ng kh\u00f4ng ch\u1ec9 \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh cho ma tr\u1eadn vu\u00f4ng.</p> <p>H\u1ea1ng c\u1ee7a ma tr\u1eadn c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a l\u00e0 b\u1eadc l\u1edbn nh\u1ea5t c\u1ee7a b\u1ea5t k\u1ef3 \u0111\u1ecbnh th\u1ee9c con (minor) kh\u00e1c kh\u00f4ng n\u00e0o trong ma tr\u1eadn.</p> <p>Gi\u1ea3 s\u1eed ma tr\u1eadn l\u00e0 h\u00ecnh ch\u1eef nh\u1eadt v\u00e0 c\u00f3 k\u00edch th\u01b0\u1edbc $N \\times M$. L\u01b0u \u00fd r\u1eb1ng n\u1ebfu ma tr\u1eadn l\u00e0 ma tr\u1eadn vu\u00f4ng v\u00e0 \u0111\u1ecbnh th\u1ee9c c\u1ee7a n\u00f3 kh\u00e1c kh\u00f4ng, th\u00ec h\u1ea1ng l\u00e0 $N$ ($=M$); n\u1ebfu kh\u00f4ng n\u00f3 s\u1ebd nh\u1ecf h\u01a1n. N\u00f3i chung, h\u1ea1ng c\u1ee7a ma tr\u1eadn kh\u00f4ng v\u01b0\u1ee3t qu\u00e1 $\\min (N, M)$.</p>","tags":["Translated"]},{"location":"linear_algebra/rank-matrix.html#algorithm","title":"Thu\u1eadt to\u00e1n (Algorithm)","text":"<p>B\u1ea1n c\u00f3 th\u1ec3 t\u00ecm ki\u1ebfm h\u1ea1ng b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng kh\u1eed Gaussian. Ch\u00fang ta s\u1ebd th\u1ef1c hi\u1ec7n c\u00e1c thao t\u00e1c t\u01b0\u01a1ng t\u1ef1 nh\u01b0 khi gi\u1ea3i h\u1ec7 th\u1ed1ng ho\u1eb7c t\u00ecm \u0111\u1ecbnh th\u1ee9c c\u1ee7a n\u00f3. Nh\u01b0ng n\u1ebfu \u1edf b\u1ea5t k\u1ef3 b\u01b0\u1edbc n\u00e0o trong c\u1ed9t th\u1ee9 $i$ kh\u00f4ng c\u00f3 h\u00e0ng n\u00e0o c\u00f3 m\u1ee5c kh\u00e1c r\u1ed7ng trong s\u1ed1 nh\u1eefng h\u00e0ng m\u00e0 ch\u00fang ta ch\u01b0a ch\u1ecdn, th\u00ec ch\u00fang ta b\u1ecf qua b\u01b0\u1edbc n\u00e0y. Ng\u01b0\u1ee3c l\u1ea1i, n\u1ebfu ch\u00fang ta t\u00ecm th\u1ea5y m\u1ed9t h\u00e0ng c\u00f3 ph\u1ea7n t\u1eed kh\u00e1c kh\u00f4ng trong c\u1ed9t th\u1ee9 $i$ trong b\u01b0\u1edbc th\u1ee9 $i$, th\u00ec ch\u00fang ta \u0111\u00e1nh d\u1ea5u h\u00e0ng n\u00e0y l\u00e0 h\u00e0ng \u0111\u00e3 ch\u1ecdn, t\u0103ng h\u1ea1ng l\u00ean m\u1ed9t (ban \u0111\u1ea7u h\u1ea1ng \u0111\u01b0\u1ee3c \u0111\u1eb7t b\u1eb1ng $0$), v\u00e0 th\u1ef1c hi\u1ec7n c\u00e1c thao t\u00e1c th\u00f4ng th\u01b0\u1eddng l\u00e0 tr\u1eeb h\u00e0ng n\u00e0y kh\u1ecfi ph\u1ea7n c\u00f2n l\u1ea1i.</p>","tags":["Translated"]},{"location":"linear_algebra/rank-matrix.html#complexity","title":"\u0110\u1ed9 ph\u1ee9c t\u1ea1p (Complexity)","text":"<p>Thu\u1eadt to\u00e1n n\u00e0y ch\u1ea1y trong $\\mathcal{O}(n^3)$.</p>","tags":["Translated"]},{"location":"linear_algebra/rank-matrix.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<pre><code>const double EPS = 1E-9;\n\nint compute_rank(vector&lt;vector&lt;double&gt;&gt; A) {\n    int n = A.size();\n    int m = A[0].size();\n\n    int rank = 0;\n    vector&lt;bool&gt; row_selected(n, false);\n    for (int i = 0; i &lt; m; ++i) {\n        int j;\n        for (j = 0; j &lt; n; ++j) {\n            if (!row_selected[j] &amp;&amp; abs(A[j][i]) &gt; EPS)\n                break;\n        }\n\n        if (j != n) {\n            ++rank;\n            row_selected[j] = true;\n            for (int p = i + 1; p &lt; m; ++p)\n                A[j][p] /= A[j][i];\n            for (int k = 0; k &lt; n; ++k) {\n                if (k != j &amp;&amp; abs(A[k][i]) &gt; EPS) {\n                    for (int p = i + 1; p &lt; m; ++p)\n                        A[k][p] -= A[j][p] * A[k][i];\n                }\n            }\n        }\n    }\n    return rank;\n}\n</code></pre>","tags":["Translated"]},{"location":"linear_algebra/rank-matrix.html#problems","title":"B\u00e0i t\u1eadp (Problems)","text":"<ul> <li>TIMUS1041 Nikifor</li> </ul>","tags":["Translated"]},{"location":"num_methods/binary_search.html","title":"T\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n (Binary search)","text":"<p>T\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n l\u00e0 m\u1ed9t ph\u01b0\u01a1ng ph\u00e1p cho ph\u00e9p t\u00ecm ki\u1ebfm th\u1ee9 g\u00ec \u0111\u00f3 nhanh h\u01a1n b\u1eb1ng c\u00e1ch chia kho\u1ea3ng t\u00ecm ki\u1ebfm l\u00e0m hai. \u1ee8ng d\u1ee5ng ph\u1ed5 bi\u1ebfn nh\u1ea5t c\u1ee7a n\u00f3 l\u00e0 t\u00ecm ki\u1ebfm c\u00e1c gi\u00e1 tr\u1ecb trong c\u00e1c m\u1ea3ng \u0111\u00e3 ph\u00e2n lo\u1ea1i, tuy nhi\u00ean \u00fd t\u01b0\u1edfng chia nh\u1ecf r\u1ea5t quan tr\u1ecdng trong nhi\u1ec1u t\u00e1c v\u1ee5 \u0111i\u1ec3n h\u00ecnh kh\u00e1c.</p>","tags":["Translated"]},{"location":"num_methods/binary_search.html#search-in-sorted-arrays","title":"T\u00ecm ki\u1ebfm trong m\u1ea3ng \u0111\u00e3 s\u1eafp x\u1ebfp (Search in sorted arrays)","text":"<p>V\u1ea5n \u0111\u1ec1 \u0111i\u1ec3n h\u00ecnh nh\u1ea5t d\u1eabn \u0111\u1ebfn t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n nh\u01b0 sau. B\u1ea1n \u0111\u01b0\u1ee3c cho m\u1ed9t m\u1ea3ng \u0111\u00e3 s\u1eafp x\u1ebfp $A_0 \\leq A_1 \\leq \\dots \\leq A_{n-1}$, h\u00e3y ki\u1ec3m tra xem $k$ c\u00f3 hi\u1ec7n di\u1ec7n trong chu\u1ed7i hay kh\u00f4ng. Gi\u1ea3i ph\u00e1p \u0111\u01a1n gi\u1ea3n nh\u1ea5t s\u1ebd l\u00e0 ki\u1ec3m tra t\u1eebng ph\u1ea7n t\u1eed m\u1ed9t v\u00e0 so s\u00e1nh n\u00f3 v\u1edbi $k$ (c\u00e1i g\u1ecdi l\u00e0 t\u00ecm ki\u1ebfm tuy\u1ebfn t\u00ednh). C\u00e1ch ti\u1ebfp c\u1eadn n\u00e0y ho\u1ea1t \u0111\u1ed9ng trong $O(n)$, nh\u01b0ng kh\u00f4ng t\u1eadn d\u1ee5ng th\u1ef1c t\u1ebf l\u00e0 m\u1ea3ng \u0111\u00e3 \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp.</p> T\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n gi\u00e1 tr\u1ecb $7$ trong m\u1ed9t m\u1ea3ng.  H\u00ecnh \u1ea3nh b\u1edfi AlwaysAngry \u0111\u01b0\u1ee3c ph\u00e2n ph\u1ed1i d\u01b0\u1edbi gi\u1ea5y ph\u00e9p CC BY-SA 4.0.  <p>B\u00e2y gi\u1edd gi\u1ea3 s\u1eed r\u1eb1ng ch\u00fang ta bi\u1ebft hai ch\u1ec9 s\u1ed1 $L &lt; R$ sao cho $A_L \\leq k \\leq A_R$. B\u1edfi v\u00ec m\u1ea3ng \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp, ch\u00fang ta c\u00f3 th\u1ec3 suy lu\u1eadn r\u1eb1ng $k$ ho\u1eb7c x\u1ea3y ra gi\u1eefa $A_L, A_{L+1}, \\dots, A_R$ ho\u1eb7c ho\u00e0n to\u00e0n kh\u00f4ng x\u1ea3y ra trong m\u1ea3ng. N\u1ebfu ch\u00fang ta ch\u1ecdn m\u1ed9t ch\u1ec9 s\u1ed1 $M$ t\u00f9y \u00fd sao cho $L &lt; M &lt; R$ v\u00e0 ki\u1ec3m tra xem $k$ nh\u1ecf h\u01a1n hay l\u1edbn h\u01a1n $A_M$. Ch\u00fang t\u00f4i c\u00f3 hai tr\u01b0\u1eddng h\u1ee3p c\u00f3 th\u1ec3 x\u1ea3y ra:</p> <ol> <li>$A_L \\leq k \\leq A_M$. Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, ch\u00fang t\u00f4i gi\u1ea3m b\u00e0i to\u00e1n t\u1eeb $[L, R]$ xu\u1ed1ng $[L, M]$;</li> <li>$A_M \\leq k \\leq A_R$. Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, ch\u00fang t\u00f4i gi\u1ea3m b\u00e0i to\u00e1n t\u1eeb $[L, R]$ xu\u1ed1ng $[M, R]$.</li> </ol> <p>Khi kh\u00f4ng th\u1ec3 ch\u1ecdn $M$, ngh\u0129a l\u00e0 khi $R = L + 1$, ch\u00fang ta so s\u00e1nh tr\u1ef1c ti\u1ebfp $k$ v\u1edbi $A_L$ v\u00e0 $A_R$. M\u1eb7t kh\u00e1c, ch\u00fang ta mu\u1ed1n ch\u1ecdn $M$ theo c\u00e1ch m\u00e0 n\u00f3 l\u00e0m gi\u1ea3m \u0111o\u1ea1n ho\u1ea1t \u0111\u1ed9ng th\u00e0nh m\u1ed9t ph\u1ea7n t\u1eed duy nh\u1ea5t nhanh nh\u1ea5t c\u00f3 th\u1ec3 trong tr\u01b0\u1eddng h\u1ee3p x\u1ea5u nh\u1ea5t.</p> <p>V\u00ec trong tr\u01b0\u1eddng h\u1ee3p x\u1ea5u nh\u1ea5t, ch\u00fang ta s\u1ebd lu\u00f4n gi\u1ea3m xu\u1ed1ng \u0111o\u1ea1n l\u1edbn h\u01a1n c\u1ee7a $[L, M]$ v\u00e0 $[M, R]$. Do \u0111\u00f3, trong k\u1ecbch b\u1ea3n tr\u01b0\u1eddng h\u1ee3p x\u1ea5u nh\u1ea5t, m\u1ee9c gi\u1ea3m s\u1ebd l\u00e0 t\u1eeb $R-L$ xu\u1ed1ng $\\max(M-L, R-M)$. \u0110\u1ec3 gi\u1ea3m thi\u1ec3u gi\u00e1 tr\u1ecb n\u00e0y, ch\u00fang ta n\u00ean ch\u1ecdn $M \\approx \\frac{L+R}{2}$, sau \u0111\u00f3</p> $$ M-L \\approx \\frac{R-L}{2} \\approx R-M. $$ <p>N\u00f3i c\u00e1ch kh\u00e1c, t\u1eeb g\u00f3c \u0111\u1ed9 k\u1ecbch b\u1ea3n tr\u01b0\u1eddng h\u1ee3p x\u1ea5u nh\u1ea5t, t\u1ed1i \u01b0u nh\u1ea5t l\u00e0 lu\u00f4n ch\u1ecdn $M$ \u1edf gi\u1eefa $[L, R]$ v\u00e0 chia \u0111\u00f4i n\u00f3. Do \u0111\u00f3, \u0111o\u1ea1n ho\u1ea1t \u0111\u1ed9ng gi\u1ea3m m\u1ed9t n\u1eeda tr\u00ean m\u1ed7i b\u01b0\u1edbc cho \u0111\u1ebfn khi n\u00f3 c\u00f3 k\u00edch th\u01b0\u1edbc $1$. V\u00ec v\u1eady, n\u1ebfu qu\u00e1 tr\u00ecnh c\u1ea7n $h$ b\u01b0\u1edbc, cu\u1ed1i c\u00f9ng n\u00f3 s\u1ebd gi\u1ea3m s\u1ef1 kh\u00e1c bi\u1ec7t gi\u1eefa $R$ v\u00e0 $L$ t\u1eeb $R-L$ xu\u1ed1ng $\\frac{R-L}{2^h} \\approx 1$, cho ch\u00fang ta ph\u01b0\u01a1ng tr\u00ecnh $2^h \\approx R-L$.</p> <p>L\u1ea5y $\\log_2$ \u1edf c\u1ea3 hai v\u1ebf, ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c $h \\approx \\log_2(R-L) \\in O(\\log n)$.</p> <p>S\u1ed1 l\u01b0\u1ee3ng c\u00e1c b\u01b0\u1edbc logarit t\u1ed1t h\u01a1n nhi\u1ec1u so v\u1edbi t\u00ecm ki\u1ebfm tuy\u1ebfn t\u00ednh. V\u00ed d\u1ee5, \u0111\u1ed1i v\u1edbi $n \\approx 2^{20} \\approx 10^6$, b\u1ea1n s\u1ebd c\u1ea7n th\u1ef1c hi\u1ec7n kho\u1ea3ng m\u1ed9t tri\u1ec7u thao t\u00e1c \u0111\u1ec3 t\u00ecm ki\u1ebfm tuy\u1ebfn t\u00ednh, nh\u01b0ng ch\u1ec9 kho\u1ea3ng $20$ thao t\u00e1c v\u1edbi t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n.</p>","tags":["Translated"]},{"location":"num_methods/binary_search.html#lower-bound-and-upper-bound","title":"C\u1eadn d\u01b0\u1edbi v\u00e0 c\u1eadn tr\u00ean (Lower bound and upper bound)","text":"<p>Th\u01b0\u1eddng thu\u1eadn ti\u1ec7n \u0111\u1ec3 t\u00ecm v\u1ecb tr\u00ed c\u1ee7a ph\u1ea7n t\u1eed \u0111\u1ea7u ti\u00ean l\u1edbn h\u01a1n ho\u1eb7c b\u1eb1ng $k$ (g\u1ecdi l\u00e0 c\u1eadn d\u01b0\u1edbi - lower bound c\u1ee7a $k$ trong m\u1ea3ng) ho\u1eb7c v\u1ecb tr\u00ed c\u1ee7a ph\u1ea7n t\u1eed \u0111\u1ea7u ti\u00ean l\u1edbn h\u01a1n $k$ (g\u1ecdi l\u00e0 c\u1eadn tr\u00ean - upper bound c\u1ee7a $k$) thay v\u00ec v\u1ecb tr\u00ed ch\u00ednh x\u00e1c c\u1ee7a ph\u1ea7n t\u1eed.</p> <p>C\u00f9ng v\u1edbi nhau, c\u1eadn d\u01b0\u1edbi v\u00e0 c\u1eadn tr\u00ean t\u1ea1o ra m\u1ed9t n\u1eeda kho\u1ea3ng c\u00f3 th\u1ec3 r\u1ed7ng c\u1ee7a c\u00e1c ph\u1ea7n t\u1eed m\u1ea3ng b\u1eb1ng $k$. \u0110\u1ec3 ki\u1ec3m tra xem $k$ c\u00f3 hi\u1ec7n di\u1ec7n trong m\u1ea3ng hay kh\u00f4ng, ch\u1ec9 c\u1ea7n t\u00ecm c\u1eadn d\u01b0\u1edbi c\u1ee7a n\u00f3 v\u00e0 ki\u1ec3m tra xem ph\u1ea7n t\u1eed t\u01b0\u01a1ng \u1ee9ng c\u00f3 b\u1eb1ng $k$ hay kh\u00f4ng.</p>","tags":["Translated"]},{"location":"num_methods/binary_search.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>L\u1eddi gi\u1ea3i th\u00edch \u1edf tr\u00ean cung c\u1ea5p m\u1ed9t m\u00f4 t\u1ea3 s\u01a1 b\u1ed9 v\u1ec1 thu\u1eadt to\u00e1n. \u0110\u1ed1i v\u1edbi c\u00e1c chi ti\u1ebft c\u00e0i \u0111\u1eb7t, ch\u00fang ta c\u1ea7n ph\u1ea3i ch\u00ednh x\u00e1c h\u01a1n.</p> <p>Ch\u00fang t\u00f4i s\u1ebd duy tr\u00ec m\u1ed9t c\u1eb7p $L &lt; R$ sao cho $A_L \\leq k &lt; A_R$. C\u00f3 ngh\u0129a l\u00e0 kho\u1ea3ng t\u00ecm ki\u1ebfm \u0111ang ho\u1ea1t \u0111\u1ed9ng l\u00e0 $[L, R)$. Ch\u00fang t\u00f4i s\u1eed d\u1ee5ng n\u1eeda kho\u1ea3ng \u1edf \u0111\u00e2y thay v\u00ec m\u1ed9t \u0111o\u1ea1n $[L, R]$ v\u00ec h\u00f3a ra n\u00f3 y\u00eau c\u1ea7u \u00edt c\u00f4ng vi\u1ec7c v\u1edbi tr\u01b0\u1eddng h\u1ee3p bi\u00ean h\u01a1n.</p> <p>Khi $R = L+1$, ch\u00fang ta c\u00f3 th\u1ec3 suy ra t\u1eeb c\u00e1c \u0111\u1ecbnh ngh\u0129a \u1edf tr\u00ean r\u1eb1ng $R$ l\u00e0 c\u1eadn tr\u00ean c\u1ee7a $k$. S\u1ebd thu\u1eadn ti\u1ec7n khi kh\u1edfi t\u1ea1o $R$ v\u1edbi ch\u1ec9 s\u1ed1 ngay sau khi k\u1ebft th\u00fac, t\u1ee9c l\u00e0 $R=n$ v\u00e0 $L$ v\u1edbi ch\u1ec9 s\u1ed1 ngay tr\u01b0\u1edbc khi b\u1eaft \u0111\u1ea7u, t\u1ee9c l\u00e0 $L=-1$. S\u1ebd \u1ed5n mi\u1ec5n l\u00e0 ch\u00fang ta kh\u00f4ng bao gi\u1edd \u0111\u00e1nh gi\u00e1 $A_L$ v\u00e0 $A_R$ trong thu\u1eadt to\u00e1n c\u1ee7a m\u00ecnh tr\u1ef1c ti\u1ebfp, v\u1ec1 m\u1eb7t h\u00ecnh th\u1ee9c coi n\u00f3 l\u00e0 $A_L = -\\infty$ v\u00e0 $A_R = +\\infty$.</p> <p>Cu\u1ed1i c\u00f9ng, \u0111\u1ec3 c\u1ee5 th\u1ec3 v\u1ec1 gi\u00e1 tr\u1ecb c\u1ee7a $M$ ch\u00fang ta ch\u1ecdn, ch\u00fang ta s\u1ebd g\u1eafn b\u00f3 v\u1edbi $M = \\lfloor \\frac{L+R}{2} \\rfloor$.</p> <p>Sau \u0111\u00f3, vi\u1ec7c tri\u1ec3n khai c\u00f3 th\u1ec3 tr\u00f4ng gi\u1ed1ng nh\u01b0 th\u1ebf n\u00e0y:</p> <pre><code>// m\u1ea3ng \u0111\u00e3 s\u1eafp x\u1ebfp \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef d\u01b0\u1edbi d\u1ea1ng a[0], a[1], ..., a[n-1]\nint l = -1, r = n;\nwhile (r - l &gt; 1) {\n    int m = (l + r) / 2;\n    if (k &lt; a[m]) {\n        r = m; // a[l] &lt;= k &lt; a[m] &lt;= a[r]\n    } else {\n        l = m; // a[l] &lt;= a[m] &lt;= k &lt; a[r]\n    }\n}\n</code></pre> <p>Trong qu\u00e1 tr\u00ecnh th\u1ef1c thi thu\u1eadt to\u00e1n, ch\u00fang ta kh\u00f4ng bao gi\u1edd \u0111\u00e1nh gi\u00e1 $A_L$ c\u0169ng nh\u01b0 $A_R$, v\u00ec $L &lt; M &lt; R$. Cu\u1ed1i c\u00f9ng, $L$ s\u1ebd l\u00e0 ch\u1ec9 s\u1ed1 c\u1ee7a ph\u1ea7n t\u1eed cu\u1ed1i c\u00f9ng kh\u00f4ng l\u1edbn h\u01a1n $k$ (ho\u1eb7c $-1$ n\u1ebfu kh\u00f4ng c\u00f3 ph\u1ea7n t\u1eed n\u00e0o nh\u01b0 v\u1eady) v\u00e0 $R$ s\u1ebd l\u00e0 ch\u1ec9 s\u1ed1 c\u1ee7a ph\u1ea7n t\u1eed \u0111\u1ea7u ti\u00ean l\u1edbn h\u01a1n $k$ (ho\u1eb7c $n$ n\u1ebfu kh\u00f4ng c\u00f3 ph\u1ea7n t\u1eed n\u00e0o nh\u01b0 v\u1eady).</p> <p>L\u01b0u \u00fd. Vi\u1ec7c t\u00ednh to\u00e1n <code>m</code> l\u00e0 <code>m = (r + l) / 2</code> c\u00f3 th\u1ec3 d\u1eabn \u0111\u1ebfn tr\u00e0n s\u1ed1 n\u1ebfu <code>l</code> v\u00e0 <code>r</code> l\u00e0 hai s\u1ed1 nguy\u00ean d\u01b0\u01a1ng, v\u00e0 l\u1ed7i n\u00e0y \u0111\u00e3 t\u1ed3n t\u1ea1i kho\u1ea3ng 9 n\u0103m trong JDK nh\u01b0 \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 trong b\u00e0i \u0111\u0103ng tr\u00ean blog. M\u1ed9t s\u1ed1 c\u00e1ch ti\u1ebfp c\u1eadn thay th\u1ebf bao g\u1ed3m v\u00ed d\u1ee5: vi\u1ebft <code>m = l + (r - l) / 2</code> lu\u00f4n ho\u1ea1t \u0111\u1ed9ng \u0111\u1ed1i v\u1edbi s\u1ed1 nguy\u00ean d\u01b0\u01a1ng <code>l</code> v\u00e0 <code>r</code>, nh\u01b0ng v\u1eabn c\u00f3 th\u1ec3 tr\u00e0n n\u1ebfu <code>l</code> l\u00e0 m\u1ed9t s\u1ed1 \u00e2m. N\u1ebfu b\u1ea1n s\u1eed d\u1ee5ng C++20, n\u00f3 cung c\u1ea5p m\u1ed9t gi\u1ea3i ph\u00e1p thay th\u1ebf d\u01b0\u1edbi d\u1ea1ng <code>m = std::midpoint(l, r)</code> lu\u00f4n ho\u1ea1t \u0111\u1ed9ng ch\u00ednh x\u00e1c.</p>","tags":["Translated"]},{"location":"num_methods/binary_search.html#search-on-arbitrary-predicate","title":"T\u00ecm ki\u1ebfm tr\u00ean v\u1ecb t\u1eeb t\u00f9y \u00fd (Search on arbitrary predicate)","text":"<p>Cho $f : \\{0,1,\\dots, n-1\\} \\to \\{0, 1\\}$ l\u00e0 m\u1ed9t h\u00e0m boolean \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh tr\u00ean $0,1,\\dots,n-1$ sao cho n\u00f3 t\u0103ng \u0111\u01a1n \u0111i\u1ec7u, t\u1ee9c l\u00e0</p> $$ f(0) \\leq f(1) \\leq \\dots \\leq f(n-1). $$ <p>T\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n, theo c\u00e1ch \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 \u1edf tr\u00ean, t\u00ecm ph\u00e2n ho\u1ea1ch c\u1ee7a m\u1ea3ng theo v\u1ecb t\u1eeb $f(M)$, gi\u1eef gi\u00e1 tr\u1ecb boolean c\u1ee7a bi\u1ec3u th\u1ee9c $k &lt; A_M$. C\u00f3 th\u1ec3 s\u1eed d\u1ee5ng v\u1ecb t\u1eeb \u0111\u01a1n \u0111i\u1ec7u t\u00f9y \u00fd thay v\u00ec $k &lt; A_M$. N\u00f3 \u0111\u1eb7c bi\u1ec7t h\u1eefu \u00edch khi vi\u1ec7c t\u00ednh to\u00e1n $f(k)$ \u0111\u00f2i h\u1ecfi qu\u00e1 nhi\u1ec1u th\u1eddi gian \u0111\u1ec3 th\u1ef1c s\u1ef1 t\u00ednh to\u00e1n n\u00f3 cho m\u1ecdi gi\u00e1 tr\u1ecb c\u00f3 th\u1ec3. N\u00f3i c\u00e1ch kh\u00e1c, t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n t\u00ecm ch\u1ec9 s\u1ed1 duy nh\u1ea5t $L$ sao cho $f(L) = 0$ v\u00e0 $f(R)=f(L+1)=1$ n\u1ebfu t\u1ed3n t\u1ea1i m\u1ed9t \u0111i\u1ec3m chuy\u1ec3n ti\u1ebfp nh\u01b0 v\u1eady, ho\u1eb7c cho ch\u00fang ta $L = n-1$ n\u1ebfu $f(0) = \\dots = f(n-1) = 0$ ho\u1eb7c $L = -1$ n\u1ebfu $f(0) = \\dots = f(n-1) = 1$.</p> <p>B\u1eb1ng ch\u1ee9ng v\u1ec1 t\u00ednh ch\u00ednh x\u00e1c gi\u1ea3 s\u1eed c\u00f3 m\u1ed9t \u0111i\u1ec3m chuy\u1ec3n ti\u1ebfp t\u1ed3n t\u1ea1i, t\u1ee9c l\u00e0 $f(0)=0$ v\u00e0 $f(n-1)=1$: Vi\u1ec7c tri\u1ec3n khai duy tr\u00ec B\u1ea5t bi\u1ebfn v\u00f2ng l\u1eb7p (loop invariant) $f(l)=0, f(r)=1$. Khi $r - l &gt; 1$, vi\u1ec7c ch\u1ecdn $m$ c\u00f3 ngh\u0129a l\u00e0 $r-l$ s\u1ebd lu\u00f4n gi\u1ea3m. V\u00f2ng l\u1eb7p k\u1ebft th\u00fac khi $r - l = 1$, cho ch\u00fang ta \u0111i\u1ec3m chuy\u1ec3n ti\u1ebfp mong mu\u1ed1n c\u1ee7a m\u00ecnh.</p> <pre><code>// f(i) l\u00e0 m\u1ed9t h\u00e0m boolean sao cho f(0) &lt;= ... &lt;= f(n-1)\nint l = -1, r = n;\nwhile (r - l &gt; 1) {\n    int m = (l + r) / 2;\n    if (f(m)) {\n        r = m; // 0 = f(l) &lt; f(m) = 1\n    } else {\n        l = m; // 0 = f(m) &lt; f(r) = 1\n    }\n}\n</code></pre>","tags":["Translated"]},{"location":"num_methods/binary_search.html#binary-search-on-the-answer","title":"T\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n tr\u00ean c\u00e2u tr\u1ea3 l\u1eddi (Binary search on the answer)","text":"<p>T\u00ecnh hu\u1ed1ng nh\u01b0 v\u1eady th\u01b0\u1eddng x\u1ea3y ra khi ch\u00fang ta \u0111\u01b0\u1ee3c y\u00eau c\u1ea7u t\u00ednh to\u00e1n m\u1ed9t s\u1ed1 gi\u00e1 tr\u1ecb, nh\u01b0ng ch\u00fang ta ch\u1ec9 c\u00f3 kh\u1ea3 n\u0103ng ki\u1ec3m tra xem gi\u00e1 tr\u1ecb n\u00e0y c\u00f3 \u00edt nh\u1ea5t l\u00e0 $i$ hay kh\u00f4ng. V\u00ed d\u1ee5, b\u1ea1n \u0111\u01b0\u1ee3c cho m\u1ed9t m\u1ea3ng $a_1,\\dots,a_n$ v\u00e0 b\u1ea1n \u0111\u01b0\u1ee3c y\u00eau c\u1ea7u t\u00ecm t\u1ed5ng trung b\u00ecnh s\u00e0n l\u1edbn nh\u1ea5t</p> $$ \\left \\lfloor \\frac{a_l + a_{l+1} + \\dots + a_r}{r-l+1} \\right\\rfloor $$ <p>trong s\u1ed1 t\u1ea5t c\u1ea3 c\u00e1c c\u1eb7p $l,r$ kh\u1ea3 thi sao cho $r-l \\geq x$. M\u1ed9t trong nh\u1eefng c\u00e1ch \u0111\u01a1n gi\u1ea3n \u0111\u1ec3 gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 n\u00e0y l\u00e0 ki\u1ec3m tra xem c\u00e2u tr\u1ea3 l\u1eddi c\u00f3 \u00edt nh\u1ea5t l\u00e0 $\\lambda$ hay kh\u00f4ng, ngh\u0129a l\u00e0 n\u1ebfu c\u00f3 m\u1ed9t c\u1eb7p $l, r$ sao cho \u0111i\u1ec1u sau \u0111\u00e2y l\u00e0 \u0111\u00fang:</p> $$ \\frac{a_l + a_{l+1} + \\dots + a_r}{r-l+1} \\geq \\lambda. $$ <p>T\u01b0\u01a1ng \u0111\u01b0\u01a1ng, n\u00f3 vi\u1ebft l\u1ea1i th\u00e0nh</p> $$ (a_l - \\lambda) + (a_{l+1} - \\lambda) + \\dots + (a_r - \\lambda) \\geq 0, $$ <p>v\u00ec v\u1eady b\u00e2y gi\u1edd ch\u00fang ta c\u1ea7n ki\u1ec3m tra xem c\u00f3 m\u1ed9t m\u1ea3ng con c\u1ee7a m\u1ed9t m\u1ea3ng m\u1edbi $a_i - \\lambda$ c\u00f3 \u0111\u1ed9 d\u00e0i \u00edt nh\u1ea5t $x+1$ v\u1edbi t\u1ed5ng kh\u00f4ng \u00e2m hay kh\u00f4ng, \u0111i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n \u0111\u01b0\u1ee3c v\u1edbi m\u1ed9t s\u1ed1 t\u1ed5ng ti\u1ec1n t\u1ed1.</p>","tags":["Translated"]},{"location":"num_methods/binary_search.html#continuous-search","title":"T\u00ecm ki\u1ebfm li\u00ean t\u1ee5c (Continuous search)","text":"<p>Cho $f : \\mathbb R \\to \\mathbb R$ l\u00e0 m\u1ed9t h\u00e0m gi\u00e1 tr\u1ecb th\u1ef1c li\u00ean t\u1ee5c tr\u00ean m\u1ed9t \u0111o\u1ea1n $[L, R]$.</p> <p>Kh\u00f4ng m\u1ea5t t\u00ednh t\u1ed5ng qu\u00e1t gi\u1ea3 s\u1eed r\u1eb1ng $f(L) \\leq f(R)$. T\u1eeb \u0111\u1ecbnh l\u00fd gi\u00e1 tr\u1ecb trung gian suy ra r\u1eb1ng \u0111\u1ed1i v\u1edbi b\u1ea5t k\u1ef3 $y \\in [f(L), f(R)]$ \u0111\u1ec1u c\u00f3 $x \\in [L, R]$ sao cho $f(x) = y$. L\u01b0u \u00fd r\u1eb1ng, kh\u00f4ng gi\u1ed1ng nh\u01b0 c\u00e1c \u0111o\u1ea1n tr\u01b0\u1edbc, h\u00e0m kh\u00f4ng b\u1eaft bu\u1ed9c ph\u1ea3i \u0111\u01a1n \u0111i\u1ec7u.</p> <p>Gi\u00e1 tr\u1ecb $x$ c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c x\u1ea5p x\u1ec9 l\u00ean \u0111\u1ebfn $\\pm\\delta$ trong th\u1eddi gian $O\\left(\\log \\frac{R-L}{\\delta}\\right)$ cho b\u1ea5t k\u1ef3 gi\u00e1 tr\u1ecb c\u1ee5 th\u1ec3 n\u00e0o c\u1ee7a $\\delta$. \u00dd t\u01b0\u1edfng v\u1ec1 c\u01a1 b\u1ea3n l\u00e0 gi\u1ed1ng nhau, n\u1ebfu ch\u00fang ta l\u1ea5y $M \\in (L, R)$ th\u00ec ch\u00fang ta c\u00f3 th\u1ec3 gi\u1ea3m kho\u1ea3ng t\u00ecm ki\u1ebfm xu\u1ed1ng c\u00f2n $[L, M]$ ho\u1eb7c $[M, R]$ t\u00f9y thu\u1ed9c v\u00e0o vi\u1ec7c $f(M)$ c\u00f3 l\u1edbn h\u01a1n $y$ hay kh\u00f4ng. M\u1ed9t v\u00ed d\u1ee5 ph\u1ed5 bi\u1ebfn \u1edf \u0111\u00e2y l\u00e0 t\u00ecm nghi\u1ec7m c\u1ee7a \u0111a th\u1ee9c b\u1eadc l\u1ebb.</p> <p>V\u00ed d\u1ee5, g\u1ecdi $f(x)=x^3 + ax^2 + bx + c$. Khi \u0111\u00f3 $f(L) \\to -\\infty$ v\u00e0 $f(R) \\to +\\infty$ v\u1edbi $L \\to -\\infty$ v\u00e0 $R \\to +\\infty$. C\u00f3 ngh\u0129a l\u00e0 lu\u00f4n lu\u00f4n c\u00f3 th\u1ec3 t\u00ecm th\u1ea5y $L$ \u0111\u1ee7 nh\u1ecf v\u00e0 $R$ \u0111\u1ee7 l\u1edbn \u0111\u1ec3 $f(L) &lt; 0$ v\u00e0 $f(R) &gt; 0$. Sau \u0111\u00f3, c\u00f3 th\u1ec3 t\u00ecm th\u1ea5y b\u1eb1ng t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n kho\u1ea3ng th\u1eddi gian nh\u1ecf t\u00f9y \u00fd ch\u1ee9a $x$ sao cho $f(x)=0$.</p>","tags":["Translated"]},{"location":"num_methods/binary_search.html#search-with-powers-of-2","title":"T\u00ecm ki\u1ebfm v\u1edbi l\u0169y th\u1eeba c\u1ee7a 2 (Search with powers of 2)","text":"<p>M\u1ed9t c\u00e1ch \u0111\u00e1ng ch\u00fa \u00fd kh\u00e1c \u0111\u1ec3 th\u1ef1c hi\u1ec7n t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n l\u00e0 thay v\u00ec duy tr\u00ec m\u1ed9t ph\u00e2n \u0111o\u1ea1n ho\u1ea1t \u0111\u1ed9ng, h\u00e3y duy tr\u00ec con tr\u1ecf hi\u1ec7n t\u1ea1i $i$ v\u00e0 l\u0169y th\u1eeba hi\u1ec7n t\u1ea1i $k$. Con tr\u1ecf b\u1eaft \u0111\u1ea7u t\u1ea1i $i=L$ v\u00e0 sau \u0111\u00f3 tr\u00ean m\u1ed7i l\u1ea7n l\u1eb7p, ng\u01b0\u1eddi ta ki\u1ec3m tra v\u1ecb t\u1eeb t\u1ea1i \u0111i\u1ec3m $i+2^k$. N\u1ebfu v\u1ecb t\u1eeb v\u1eabn l\u00e0 $0$, con tr\u1ecf \u0111\u01b0\u1ee3c n\u00e2ng cao t\u1eeb $i$ \u0111\u1ebfn $i+2^k$, n\u1ebfu kh\u00f4ng n\u00f3 v\u1eabn gi\u1eef nguy\u00ean, th\u00ec l\u0169y th\u1eeba $k$ gi\u1ea3m \u0111i $1$.</p> <p>M\u00f4 h\u00ecnh n\u00e0y \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng r\u1ed9ng r\u00e3i trong c\u00e1c nhi\u1ec7m v\u1ee5 xung quanh c\u00e2y, ch\u1eb3ng h\u1ea1n nh\u01b0 t\u00ecm t\u1ed5 ti\u00ean chung th\u1ea5p nh\u1ea5t c\u1ee7a hai \u0111\u1ec9nh ho\u1eb7c t\u00ecm t\u1ed5 ti\u00ean c\u1ee7a m\u1ed9t \u0111\u1ec9nh c\u1ee5 th\u1ec3 c\u00f3 chi\u1ec1u cao nh\u1ea5t \u0111\u1ecbnh. N\u00f3 c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c \u0111i\u1ec1u ch\u1ec9nh \u0111\u1ec3 v\u00ed d\u1ee5: t\u00ecm ph\u1ea7n t\u1eed kh\u00e1c kh\u00f4ng th\u1ee9 $k$ trong c\u00e2y Fenwick.</p>","tags":["Translated"]},{"location":"num_methods/binary_search.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>LeetCode -  Find First and Last Position of Element in Sorted Array</li> <li>LeetCode -  Search Insert Position</li> <li>LeetCode -  First Bad Version</li> <li>LeetCode -  Valid Perfect Square</li> <li>LeetCode -  Find Peak Element</li> <li>LeetCode -  Search in Rotated Sorted Array</li> <li>LeetCode -  Find Right Interval</li> <li>Codeforces - Interesting Drink</li> <li>Codeforces - Magic Powder - 1</li> <li>Codeforces - Another Problem on Strings</li> <li>Codeforces - Frodo and pillows</li> <li>Codeforces - GukiZ hates Boxes</li> <li>Codeforces - Enduring Exodus</li> <li>Codeforces - Chip 'n Dale Rescue Rangers</li> </ul>","tags":["Translated"]},{"location":"num_methods/roots_newton.html","title":"Ph\u01b0\u01a1ng ph\u00e1p Newton \u0111\u1ec3 t\u00ecm nghi\u1ec7m (Newton's method for finding roots)","text":"<p>\u0110\u00e2y l\u00e0 m\u1ed9t ph\u01b0\u01a1ng ph\u00e1p l\u1eb7p \u0111\u01b0\u1ee3c Isaac Newton ph\u00e1t minh v\u00e0o kho\u1ea3ng n\u0103m 1664. Tuy nhi\u00ean, ph\u01b0\u01a1ng ph\u00e1p n\u00e0y \u0111\u00f4i khi c\u00f2n \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 ph\u01b0\u01a1ng ph\u00e1p Raphson, v\u00ec Raphson \u0111\u00e3 ph\u00e1t minh ra c\u00f9ng m\u1ed9t thu\u1eadt to\u00e1n m\u1ed9t v\u00e0i n\u0103m sau Newton, nh\u01b0ng b\u00e0i b\u00e1o c\u1ee7a \u00f4ng \u0111\u00e3 \u0111\u01b0\u1ee3c xu\u1ea5t b\u1ea3n s\u1edbm h\u01a1n nhi\u1ec1u.</p> <p>Nhi\u1ec7m v\u1ee5 nh\u01b0 sau. Cho ph\u01b0\u01a1ng tr\u00ecnh sau:</p> $$f(x) = 0$$ <p>Ch\u00fang t\u00f4i mu\u1ed1n gi\u1ea3i ph\u01b0\u01a1ng tr\u00ecnh. Ch\u00ednh x\u00e1c h\u01a1n, ch\u00fang t\u00f4i mu\u1ed1n t\u00ecm m\u1ed9t trong nh\u1eefng nghi\u1ec7m c\u1ee7a n\u00f3 (gi\u1ea3 s\u1eed r\u1eb1ng nghi\u1ec7m t\u1ed3n t\u1ea1i). Gi\u1ea3 s\u1eed r\u1eb1ng $f(x)$ li\u00ean t\u1ee5c v\u00e0 c\u00f3 th\u1ec3 vi ph\u00e2n tr\u00ean m\u1ed9t kho\u1ea3ng $[a, b]$.</p>","tags":["Translated"]},{"location":"num_methods/roots_newton.html#algorithm","title":"Thu\u1eadt to\u00e1n (Algorithm)","text":"<p>C\u00e1c tham s\u1ed1 \u0111\u1ea7u v\u00e0o c\u1ee7a thu\u1eadt to\u00e1n kh\u00f4ng ch\u1ec9 bao g\u1ed3m h\u00e0m $f(x)$ m\u00e0 c\u00f2n c\u1ea3 x\u1ea5p x\u1ec9 ban \u0111\u1ea7u - m\u1ed9t s\u1ed1 $x_0$, m\u00e0 thu\u1eadt to\u00e1n b\u1eaft \u0111\u1ea7u v\u1edbi n\u00f3.</p> <p> </p> <p>Gi\u1ea3 s\u1eed ch\u00fang ta \u0111\u00e3 t\u00ednh to\u00e1n $x_i$, h\u00e3y t\u00ednh $x_{i+1}$ nh\u01b0 sau. V\u1ebd ti\u1ebfp tuy\u1ebfn v\u1edbi \u0111\u1ed3 th\u1ecb c\u1ee7a h\u00e0m $f(x)$ t\u1ea1i \u0111i\u1ec3m $x = x_i$, v\u00e0 t\u00ecm \u0111i\u1ec3m giao nhau c\u1ee7a ti\u1ebfp tuy\u1ebfn n\u00e0y v\u1edbi tr\u1ee5c $x$. $x_{i+1}$ \u0111\u01b0\u1ee3c \u0111\u1eb7t b\u1eb1ng to\u1ea1 \u0111\u1ed9 $x$ c\u1ee7a \u0111i\u1ec3m t\u00ecm \u0111\u01b0\u1ee3c, v\u00e0 ch\u00fang ta l\u1eb7p l\u1ea1i to\u00e0n b\u1ed9 qu\u00e1 tr\u00ecnh t\u1eeb \u0111\u1ea7u.</p> <p>Kh\u00f4ng kh\u00f3 \u0111\u1ec3 c\u00f3 \u0111\u01b0\u1ee3c c\u00f4ng th\u1ee9c sau,</p> $$ x_{i+1} = x_i - \\frac{f(x_i)}{f^\\prime(x_i)} $$ <p>\u0110\u1ea7u ti\u00ean, ch\u00fang ta t\u00ednh \u0111\u1ed9 d\u1ed1c $f'(x)$, \u0111\u1ea1o h\u00e0m c\u1ee7a $f(x)$, v\u00e0 sau \u0111\u00f3 x\u00e1c \u0111\u1ecbnh ph\u01b0\u01a1ng tr\u00ecnh c\u1ee7a ti\u1ebfp tuy\u1ebfn l\u00e0,</p> $$ y - f(x_i) = f'(x_i)(x - x_i) $$ <p>Ti\u1ebfp tuy\u1ebfn giao v\u1edbi tr\u1ee5c x t\u1ea1i t\u1ecda \u0111\u1ed9, $y = 0$ v\u00e0 $x = x_{i+1}$,</p> $$ - f(x_i) = f'(x_i)(x_{i+1} - x_i) $$ <p>B\u00e2y gi\u1edd, gi\u1ea3i ph\u01b0\u01a1ng tr\u00ecnh ta \u0111\u01b0\u1ee3c gi\u00e1 tr\u1ecb c\u1ee7a $x_{i+1}$.</p> <p>V\u1ec1 m\u1eb7t tr\u1ef1c quan, r\u00f5 r\u00e0ng l\u00e0 n\u1ebfu h\u00e0m $f(x)$ l\u00e0 \"t\u1ed1t\" (tr\u01a1n), v\u00e0 $x_i$ \u0111\u1ee7 g\u1ea7n v\u1edbi nghi\u1ec7m, th\u00ec $x_{i+1}$ th\u1eadm ch\u00ed s\u1ebd g\u1ea7n h\u01a1n v\u1edbi nghi\u1ec7m mong mu\u1ed1n.</p> <p>T\u1ed1c \u0111\u1ed9 h\u1ed9i t\u1ee5 l\u00e0 b\u1eadc hai, n\u00f3i m\u1ed9t c\u00e1ch c\u00f3 \u0111i\u1ec1u ki\u1ec7n, c\u00f3 ngh\u0129a l\u00e0 s\u1ed1 l\u01b0\u1ee3ng ch\u1eef s\u1ed1 ch\u00ednh x\u00e1c trong gi\u00e1 tr\u1ecb g\u1ea7n \u0111\u00fang $x_i$ t\u0103ng g\u1ea5p \u0111\u00f4i sau m\u1ed7i l\u1ea7n l\u1eb7p.</p>","tags":["Translated"]},{"location":"num_methods/roots_newton.html#application-for-calculating-the-square-root","title":"\u1ee8ng d\u1ee5ng \u0111\u1ec3 t\u00ednh c\u0103n b\u1eadc hai (Application for calculating the square root)","text":"<p>H\u00e3y s\u1eed d\u1ee5ng ph\u00e9p t\u00ednh c\u0103n b\u1eadc hai l\u00e0m v\u00ed d\u1ee5 v\u1ec1 ph\u01b0\u01a1ng ph\u00e1p Newton.</p> <p>N\u1ebfu ch\u00fang ta thay th\u1ebf $f(x) = x^2 - n$, th\u00ec sau khi \u0111\u01a1n gi\u1ea3n h\u00f3a bi\u1ec3u th\u1ee9c, ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c:</p> $$ x_{i+1} = \\frac{x_i + \\frac{n}{x_i}}{2} $$ <p>Bi\u1ebfn th\u1ec3 \u0111i\u1ec3n h\u00ecnh \u0111\u1ea7u ti\u00ean c\u1ee7a b\u00e0i to\u00e1n l\u00e0 khi m\u1ed9t s\u1ed1 h\u1eefu t\u1ec9 $n$ \u0111\u01b0\u1ee3c \u0111\u01b0a ra, v\u00e0 c\u0103n b\u1eadc c\u1ee7a n\u00f3 ph\u1ea3i \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n v\u1edbi \u0111\u1ed9 ch\u00ednh x\u00e1c n\u00e0o \u0111\u00f3 <code>eps</code>:</p> <pre><code>double sqrt_newton(double n) {\n    const double eps = 1E-15;\n    double x = 1;\n    for (;;) {\n        double nx = (x + n / x) / 2;\n        if (abs(x - nx) &lt; eps)\n            break;\n        x = nx;\n    }\n    return x;\n}\n</code></pre> <p>M\u1ed9t bi\u1ebfn th\u1ec3 ph\u1ed5 bi\u1ebfn kh\u00e1c c\u1ee7a b\u00e0i to\u00e1n l\u00e0 khi ch\u00fang ta c\u1ea7n t\u00ednh c\u0103n b\u1eadc hai nguy\u00ean (\u0111\u1ed1i v\u1edbi $n$ \u0111\u00e3 cho t\u00ecm $x$ l\u1edbn nh\u1ea5t sao cho $x^2 \\le n$). \u1ede \u0111\u00e2y c\u1ea7n thay \u0111\u1ed5i m\u1ed9t ch\u00fat \u0111i\u1ec1u ki\u1ec7n ch\u1ea5m d\u1ee9t c\u1ee7a thu\u1eadt to\u00e1n, v\u00ec c\u00f3 th\u1ec3 x\u1ea3y ra tr\u01b0\u1eddng h\u1ee3p $x$ s\u1ebd b\u1eaft \u0111\u1ea7u \"nh\u1ea3y\" g\u1ea7n c\u00e2u tr\u1ea3 l\u1eddi. Do \u0111\u00f3, ch\u00fang t\u00f4i th\u00eam m\u1ed9t \u0111i\u1ec1u ki\u1ec7n r\u1eb1ng n\u1ebfu gi\u00e1 tr\u1ecb $x$ \u0111\u00e3 gi\u1ea3m trong b\u01b0\u1edbc tr\u01b0\u1edbc \u0111\u00f3, v\u00e0 n\u00f3 c\u1ed1 g\u1eafng t\u0103ng \u1edf b\u01b0\u1edbc hi\u1ec7n t\u1ea1i, th\u00ec thu\u1eadt to\u00e1n ph\u1ea3i d\u1eebng l\u1ea1i.</p> <pre><code>int isqrt_newton(int n) {\n    int x = 1;\n    bool decreased = false;\n    for (;;) {\n        int nx = (x + n / x) &gt;&gt; 1;\n        if (x == nx || nx &gt; x &amp;&amp; decreased)\n            break;\n        decreased = nx &lt; x;\n        x = nx;\n    }\n    return x;\n}\n</code></pre> <p>Cu\u1ed1i c\u00f9ng, ch\u00fang ta \u0111\u01b0\u1ee3c \u0111\u01b0a ra bi\u1ebfn th\u1ec3 th\u1ee9 ba - cho tr\u01b0\u1eddng h\u1ee3p s\u1ed1 h\u1ecdc s\u1ed1 l\u1edbn (bignum arithmetic). V\u00ec s\u1ed1 $n$ c\u00f3 th\u1ec3 \u0111\u1ee7 l\u1edbn, n\u00ean ch\u00fa \u00fd \u0111\u1ebfn x\u1ea5p x\u1ec9 ban \u0111\u1ea7u. R\u00f5 r\u00e0ng, c\u00e0ng g\u1ea7n nghi\u1ec7m, k\u1ebft qu\u1ea3 s\u1ebd c\u00e0ng nhanh \u0111\u1ea1t \u0111\u01b0\u1ee3c. \u0110\u1ee7 \u0111\u01a1n gi\u1ea3n v\u00e0 hi\u1ec7u qu\u1ea3 \u0111\u1ec3 l\u1ea5y x\u1ea5p x\u1ec9 ban \u0111\u1ea7u l\u00e0 s\u1ed1 $2^{\\textrm{bits}/2}$, trong \u0111\u00f3 $\\textrm{bits}$ l\u00e0 s\u1ed1 bit trong s\u1ed1 $n$. \u0110\u00e2y l\u00e0 m\u00e3 Java th\u1ec3 hi\u1ec7n bi\u1ebfn th\u1ec3 n\u00e0y:</p> <pre><code>public static BigInteger isqrtNewton(BigInteger n) {\n    BigInteger a = BigInteger.ONE.shiftLeft(n.bitLength() / 2);\n    boolean p_dec = false;\n    for (;;) {\n        BigInteger b = n.divide(a).add(a).shiftRight(1);\n        if (a.compareTo(b) == 0 || a.compareTo(b) &lt; 0 &amp;&amp; p_dec)\n            break;\n        p_dec = a.compareTo(b) &gt; 0;\n        a = b;\n    }\n    return a;\n}\n</code></pre> <p>V\u00ed d\u1ee5, m\u00e3 n\u00e0y \u0111\u01b0\u1ee3c th\u1ef1c thi trong $60$ mili gi\u00e2y cho $n = 10^{1000}$, v\u00e0 n\u1ebfu ch\u00fang ta lo\u1ea1i b\u1ecf l\u1ef1a ch\u1ecdn c\u1ea3i ti\u1ebfn c\u1ee7a x\u1ea5p x\u1ec9 ban \u0111\u1ea7u (ch\u1ec9 b\u1eaft \u0111\u1ea7u b\u1eb1ng $1$), th\u00ec n\u00f3 s\u1ebd \u0111\u01b0\u1ee3c th\u1ef1c thi trong kho\u1ea3ng $120$ mili gi\u00e2y.</p>","tags":["Translated"]},{"location":"num_methods/roots_newton.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>UVa 10428 - The Roots</li> </ul>","tags":["Translated"]},{"location":"num_methods/simpson-integration.html","title":"T\u00edch ph\u00e2n b\u1eb1ng c\u00f4ng th\u1ee9c Simpson (Integration by Simpson's formula)","text":"<p>Ch\u00fang ta s\u1ebd t\u00ednh gi\u00e1 tr\u1ecb c\u1ee7a m\u1ed9t t\u00edch ph\u00e2n x\u00e1c \u0111\u1ecbnh</p> $$\\int_a ^ b f (x) dx$$ <p>Gi\u1ea3i ph\u00e1p \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 \u1edf \u0111\u00e2y \u0111\u00e3 \u0111\u01b0\u1ee3c xu\u1ea5t b\u1ea3n trong m\u1ed9t trong nh\u1eefng lu\u1eadn v\u0103n c\u1ee7a Thomas Simpson v\u00e0o n\u0103m 1743.</p>","tags":["Translated"]},{"location":"num_methods/simpson-integration.html#simpsons-formula","title":"C\u00f4ng th\u1ee9c Simpson (Simpson's formula)","text":"<p>Cho $n$ l\u00e0 m\u1ed9t s\u1ed1 t\u1ef1 nhi\u00ean n\u00e0o \u0111\u00f3. Ch\u00fang ta chia \u0111o\u1ea1n t\u00edch ph\u00e2n $[a, b]$ th\u00e0nh $2n$ ph\u1ea7n b\u1eb1ng nhau:</p> $$x_i = a + i h, ~~ i = 0 \\ldots 2n,$$ $$h = \\frac {b-a} {2n}.$$ <p>B\u00e2y gi\u1edd ch\u00fang ta t\u00ednh t\u00edch ph\u00e2n ri\u00eang bi\u1ec7t tr\u00ean m\u1ed7i \u0111o\u1ea1n $[x_ {2i-2}, x_ {2i}]$, $i = 1 \\ldots n$, v\u00e0 sau \u0111\u00f3 c\u1ed9ng t\u1ea5t c\u1ea3 c\u00e1c gi\u00e1 tr\u1ecb l\u1ea1i.</p> <p>V\u00ec v\u1eady, gi\u1ea3 s\u1eed ch\u00fang ta xem x\u00e9t \u0111o\u1ea1n ti\u1ebfp theo $[x_ {2i-2}, x_ {2i}],  i = 1 \\ldots n$. Thay th\u1ebf h\u00e0m $f(x)$ tr\u00ean \u0111\u00f3 b\u1eb1ng m\u1ed9t parabol $P(x)$ \u0111i qua 3 \u0111i\u1ec3m $(x_ {2i-2}, x_ {2i-1}, x_ {2i})$. M\u1ed9t parabol nh\u01b0 v\u1eady lu\u00f4n t\u1ed3n t\u1ea1i v\u00e0 l\u00e0 duy nh\u1ea5t; n\u00f3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y b\u1eb1ng gi\u1ea3i t\u00edch. V\u00ed d\u1ee5, ch\u00fang ta c\u00f3 th\u1ec3 x\u00e2y d\u1ef1ng n\u00f3 b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng n\u1ed9i suy \u0111a th\u1ee9c Lagrange. \u0110i\u1ec1u duy nh\u1ea5t c\u00f2n l\u1ea1i ph\u1ea3i l\u00e0m l\u00e0 t\u00edch ph\u00e2n \u0111a th\u1ee9c n\u00e0y. N\u1ebfu b\u1ea1n l\u00e0m \u0111i\u1ec1u n\u00e0y cho m\u1ed9t h\u00e0m t\u1ed5ng qu\u00e1t $f$, b\u1ea1n s\u1ebd nh\u1eadn \u0111\u01b0\u1ee3c m\u1ed9t bi\u1ec3u th\u1ee9c \u0111\u01a1n gi\u1ea3n \u0111\u00e1ng k\u1ec3:</p> $$\\int_{x_ {2i-2}} ^ {x_ {2i}} f (x) ~dx \\approx \\int_{x_ {2i-2}} ^ {x_ {2i}} P (x) ~dx = \\left(f(x_{2i-2}) + 4f(x_{2i-1})+(f(x_{2i})\\right)\\frac {h} {3} $$ <p>C\u1ed9ng c\u00e1c gi\u00e1 tr\u1ecb n\u00e0y tr\u00ean t\u1ea5t c\u1ea3 c\u00e1c \u0111o\u1ea1n, ch\u00fang ta thu \u0111\u01b0\u1ee3c c\u00f4ng th\u1ee9c Simpson cu\u1ed1i c\u00f9ng:</p> $$\\int_a ^ b f (x) dx \\approx \\left(f (x_0) + 4 f (x_1) + 2 f (x_2) + 4f(x_3) + 2 f(x_4) + \\ldots + 4 f(x_{2N-1}) + f(x_{2N}) \\right)\\frac {h} {3} $$","tags":["Translated"]},{"location":"num_methods/simpson-integration.html#error","title":"Sai s\u1ed1 (Error)","text":"<p>Sai s\u1ed1 trong vi\u1ec7c t\u00ednh g\u1ea7n \u0111\u00fang t\u00edch ph\u00e2n theo c\u00f4ng th\u1ee9c Simpson l\u00e0</p> $$ -\\tfrac{1}{90} \\left(\\tfrac{b-a}{2}\\right)^5 f^{(4)}(\\xi)$$ <p>trong \u0111\u00f3 $\\xi$ l\u00e0 m\u1ed9t s\u1ed1 n\u00e0o \u0111\u00f3 gi\u1eefa $a$ v\u00e0 $b$.</p> <p>Sai s\u1ed1 t\u1ef7 l\u1ec7 thu\u1eadn theo ti\u1ec7m c\u1eadn v\u1edbi $(b-a)^5$. Tuy nhi\u00ean, c\u00e1c d\u1eabn xu\u1ea5t \u1edf tr\u00ean g\u1ee3i \u00fd m\u1ed9t sai s\u1ed1 t\u1ef7 l\u1ec7 v\u1edbi $(b-a)^4$. Quy t\u1eafc Simpson c\u00f3 th\u00eam m\u1ed9t b\u1eadc v\u00ec c\u00e1c \u0111i\u1ec3m m\u00e0 t\u00edch ph\u00e2n \u0111\u01b0\u1ee3c \u0111\u00e1nh gi\u00e1 \u0111\u01b0\u1ee3c ph\u00e2n ph\u1ed1i \u0111\u1ed1i x\u1ee9ng trong kho\u1ea3ng $[a, b]$.</p>","tags":["Translated"]},{"location":"num_methods/simpson-integration.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>\u1ede \u0111\u00e2y, $f(x)$ l\u00e0 m\u1ed9t h\u00e0m ng\u01b0\u1eddi d\u00f9ng \u0111\u1ecbnh ngh\u0129a n\u00e0o \u0111\u00f3.</p> <pre><code>const int N = 1000 * 1000; // s\u1ed1 l\u01b0\u1ee3ng b\u01b0\u1edbc (\u0111\u00e3 nh\u00e2n v\u1edbi 2)\n\ndouble simpson_integration(double a, double b){\n    double h = (b - a) / N;\n    double s = f(a) + f(b); // a = x_0 and b = x_2n\n    for (int i = 1; i &lt;= N - 1; ++i) { // Tham kh\u1ea3o c\u00f4ng th\u1ee9c Simpson cu\u1ed1i c\u00f9ng\n        double x = a + h * i;\n        s += f(x) * ((i &amp; 1) ? 4 : 2);\n    }\n    s *= h / 3;\n    return s;\n}\n</code></pre>","tags":["Translated"]},{"location":"num_methods/simpson-integration.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>Latin American Regionals 2012 - Environment Protection</li> </ul>","tags":["Translated"]},{"location":"num_methods/simulated_annealing.html","title":"Luy\u1ec7n kim m\u00f4 ph\u1ecfng (Simulated Annealing)","text":"<p>Luy\u1ec7n kim m\u00f4 ph\u1ecfng (Simulated Annealing - SA) l\u00e0 m\u1ed9t thu\u1eadt to\u00e1n ng\u1eabu nhi\u00ean, x\u1ea5p x\u1ec9 t\u1ed1i \u01b0u to\u00e0n c\u1ee5c c\u1ee7a m\u1ed9t h\u00e0m. N\u00f3 \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 thu\u1eadt to\u00e1n ng\u1eabu nhi\u00ean, b\u1edfi v\u00ec n\u00f3 s\u1eed d\u1ee5ng m\u1ed9t l\u01b0\u1ee3ng ng\u1eabu nhi\u00ean nh\u1ea5t \u0111\u1ecbnh trong t\u00ecm ki\u1ebfm c\u1ee7a m\u00ecnh v\u00e0 do \u0111\u00f3 \u0111\u1ea7u ra c\u1ee7a n\u00f3 c\u00f3 th\u1ec3 thay \u0111\u1ed5i \u0111\u1ed1i v\u1edbi c\u00f9ng m\u1ed9t \u0111\u1ea7u v\u00e0o.</p>","tags":["Original"]},{"location":"num_methods/simulated_annealing.html#the-problem","title":"V\u1ea5n \u0111\u1ec1 (The problem)","text":"<p>Ch\u00fang ta \u0111\u01b0\u1ee3c cho m\u1ed9t h\u00e0m $E(s)$, t\u00ednh to\u00e1n n\u0103ng l\u01b0\u1ee3ng c\u1ee7a tr\u1ea1ng th\u00e1i $s$. Ch\u00fang t\u00f4i c\u00f3 nhi\u1ec7m v\u1ee5 t\u00ecm tr\u1ea1ng th\u00e1i $s_{best}$ t\u1ea1i \u0111\u00f3 $E(s)$ \u0111\u01b0\u1ee3c gi\u1ea3m thi\u1ec3u. SA ph\u00f9 h\u1ee3p v\u1edbi c\u00e1c b\u00e0i to\u00e1n trong \u0111\u00f3 c\u00e1c tr\u1ea1ng th\u00e1i l\u00e0 r\u1eddi r\u1ea1c v\u00e0 $E(s)$ c\u00f3 nhi\u1ec1u c\u1ef1c ti\u1ec3u \u0111\u1ecba ph\u01b0\u01a1ng. Ch\u00fang t\u00f4i s\u1ebd l\u1ea5y v\u00ed d\u1ee5 v\u1ec1 V\u1ea5n \u0111\u1ec1 ng\u01b0\u1eddi b\u00e1n h\u00e0ng (Travelling Salesman Problem - TSP). </p>","tags":["Original"]},{"location":"num_methods/simulated_annealing.html#travelling-salesman-problem-tsp","title":"V\u1ea5n \u0111\u1ec1 ng\u01b0\u1eddi b\u00e1n h\u00e0ng (Travelling Salesman Problem - TSP)","text":"<p>B\u1ea1n \u0111\u01b0\u1ee3c cung c\u1ea5p m\u1ed9t t\u1eadp h\u1ee3p c\u00e1c n\u00fat trong kh\u00f4ng gian 2 chi\u1ec1u. M\u1ed7i n\u00fat \u0111\u01b0\u1ee3c \u0111\u1eb7c tr\u01b0ng b\u1edfi t\u1ecda \u0111\u1ed9 $x$ v\u00e0 $y$ c\u1ee7a n\u00f3. Nhi\u1ec7m v\u1ee5 c\u1ee7a b\u1ea1n l\u00e0 t\u00ecm th\u1ee9 t\u1ef1 c\u1ee7a c\u00e1c n\u00fat, th\u1ee9 t\u1ef1 n\u00e0y s\u1ebd gi\u1ea3m thi\u1ec3u kho\u1ea3ng c\u00e1ch di chuy\u1ec3n khi truy c\u1eadp c\u00e1c n\u00fat n\u00e0y theo th\u1ee9 t\u1ef1 \u0111\u00f3.</p>","tags":["Original"]},{"location":"num_methods/simulated_annealing.html#motivation","title":"\u0110\u1ed9ng l\u1ef1c (Motivation)","text":"<p>Luy\u1ec7n kim (Annealing) l\u00e0 m\u1ed9t qu\u00e1 tr\u00ecnh luy\u1ec7n kim, trong \u0111\u00f3 v\u1eadt li\u1ec7u \u0111\u01b0\u1ee3c nung n\u00f3ng v\u00e0 \u0111\u1ec3 ngu\u1ed9i, \u0111\u1ec3 cho ph\u00e9p c\u00e1c nguy\u00ean t\u1eed b\u00ean trong t\u1ef1 s\u1eafp x\u1ebfp l\u1ea1i theo m\u1ed9t s\u1ef1 s\u1eafp x\u1ebfp v\u1edbi n\u0103ng l\u01b0\u1ee3ng b\u00ean trong t\u1ed1i thi\u1ec3u, \u0111i\u1ec1u n\u00e0y l\u00e0m cho v\u1eadt li\u1ec7u c\u00f3 c\u00e1c t\u00ednh ch\u1ea5t kh\u00e1c nhau. Tr\u1ea1ng th\u00e1i l\u00e0 s\u1ef1 s\u1eafp x\u1ebfp c\u1ee7a c\u00e1c nguy\u00ean t\u1eed v\u00e0 n\u0103ng l\u01b0\u1ee3ng b\u00ean trong l\u00e0 h\u00e0m \u0111\u01b0\u1ee3c c\u1ef1c ti\u1ec3u h\u00f3a. Ch\u00fang ta c\u00f3 th\u1ec3 ngh\u0129 v\u1ec1 tr\u1ea1ng th\u00e1i ban \u0111\u1ea7u c\u1ee7a c\u00e1c nguy\u00ean t\u1eed, nh\u01b0 m\u1ed9t c\u1ef1c ti\u1ec3u \u0111\u1ecba ph\u01b0\u01a1ng cho n\u0103ng l\u01b0\u1ee3ng b\u00ean trong c\u1ee7a n\u00f3. \u0110\u1ec3 l\u00e0m cho v\u1eadt li\u1ec7u s\u1eafp x\u1ebfp l\u1ea1i c\u00e1c nguy\u00ean t\u1eed c\u1ee7a n\u00f3, ch\u00fang ta c\u1ea7n th\u00fac \u0111\u1ea9y n\u00f3 \u0111i qua m\u1ed9t v\u00f9ng m\u00e0 n\u0103ng l\u01b0\u1ee3ng b\u00ean trong c\u1ee7a n\u00f3 kh\u00f4ng \u0111\u01b0\u1ee3c gi\u1ea3m thi\u1ec3u \u0111\u1ec3 \u0111\u1ea1t \u0111\u01b0\u1ee3c c\u1ef1c ti\u1ec3u to\u00e0n c\u1ee5c. \u0110\u1ed9ng l\u1ef1c n\u00e0y \u0111\u01b0\u1ee3c \u0111\u01b0a ra b\u1eb1ng c\u00e1ch nung n\u00f3ng v\u1eadt li\u1ec7u \u0111\u1ebfn nhi\u1ec7t \u0111\u1ed9 cao h\u01a1n.</p> <p>Luy\u1ec7n kim m\u00f4 ph\u1ecfng, theo ngh\u0129a \u0111en, m\u00f4 ph\u1ecfng qu\u00e1 tr\u00ecnh n\u00e0y. Ch\u00fang ta b\u1eaft \u0111\u1ea7u v\u1edbi m\u1ed9t s\u1ed1 tr\u1ea1ng th\u00e1i ng\u1eabu nhi\u00ean (v\u1eadt li\u1ec7u) v\u00e0 thi\u1ebft l\u1eadp nhi\u1ec7t \u0111\u1ed9 cao (l\u00e0m n\u00f3ng n\u00f3). B\u00e2y gi\u1edd, thu\u1eadt to\u00e1n \u0111\u00e3 s\u1eb5n s\u00e0ng ch\u1ea5p nh\u1eadn c\u00e1c tr\u1ea1ng th\u00e1i c\u00f3 n\u0103ng l\u01b0\u1ee3ng cao h\u01a1n tr\u1ea1ng th\u00e1i hi\u1ec7n t\u1ea1i, v\u00ec n\u00f3 \u0111\u01b0\u1ee3c th\u00fac \u0111\u1ea9y b\u1edfi nhi\u1ec7t \u0111\u1ed9 cao. \u0110i\u1ec1u n\u00e0y ng\u0103n thu\u1eadt to\u00e1n b\u1ecb k\u1eb9t b\u00ean trong c\u1ef1c ti\u1ec3u c\u1ee5c b\u1ed9 v\u00e0 di chuy\u1ec3n v\u1ec1 ph\u00eda c\u1ef1c ti\u1ec3u to\u00e0n c\u1ee5c. Khi th\u1eddi gian tr\u00f4i qua, thu\u1eadt to\u00e1n ngu\u1ed9i \u0111i v\u00e0 t\u1eeb ch\u1ed1i c\u00e1c tr\u1ea1ng th\u00e1i c\u00f3 n\u0103ng l\u01b0\u1ee3ng cao h\u01a1n v\u00e0 di chuy\u1ec3n v\u00e0o c\u1ef1c ti\u1ec3u g\u1ea7n nh\u1ea5t m\u00e0 n\u00f3 t\u00ecm th\u1ea5y.</p>","tags":["Original"]},{"location":"num_methods/simulated_annealing.html#energy-function-e-s","title":"H\u00e0m n\u0103ng l\u01b0\u1ee3ng E(s)","text":"<p>$E(s)$ l\u00e0 h\u00e0m c\u1ea7n \u0111\u01b0\u1ee3c c\u1ef1c ti\u1ec3u h\u00f3a (ho\u1eb7c c\u1ef1c \u0111\u1ea1i h\u00f3a). N\u00f3 \u00e1nh x\u1ea1 m\u1ecdi tr\u1ea1ng th\u00e1i \u0111\u1ebfn m\u1ed9t s\u1ed1 th\u1ef1c. Trong tr\u01b0\u1eddng h\u1ee3p c\u1ee7a TSP, $E(s)$ tr\u1ea3 v\u1ec1 kho\u1ea3ng c\u00e1ch \u0111i m\u1ed9t v\u00f2ng tr\u00f2n \u0111\u1ea7y \u0111\u1ee7 theo th\u1ee9 t\u1ef1 c\u00e1c n\u00fat \u1edf tr\u1ea1ng th\u00e1i \u0111\u00f3.</p>","tags":["Original"]},{"location":"num_methods/simulated_annealing.html#state","title":"Tr\u1ea1ng th\u00e1i (State)","text":"<p>Kh\u00f4ng gian tr\u1ea1ng th\u00e1i l\u00e0 mi\u1ec1n c\u1ee7a h\u00e0m n\u0103ng l\u01b0\u1ee3ng, $E(s)$, v\u00e0 tr\u1ea1ng th\u00e1i l\u00e0 b\u1ea5t k\u1ef3 ph\u1ea7n t\u1eed n\u00e0o thu\u1ed9c v\u1ec1 kh\u00f4ng gian tr\u1ea1ng th\u00e1i. Trong tr\u01b0\u1eddng h\u1ee3p c\u1ee7a TSP, t\u1ea5t c\u1ea3 c\u00e1c \u0111\u01b0\u1eddng \u0111i c\u00f3 th\u1ec3 m\u00e0 ch\u00fang ta c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n \u0111\u1ec3 truy c\u1eadp t\u1ea5t c\u1ea3 c\u00e1c n\u00fat l\u00e0 kh\u00f4ng gian tr\u1ea1ng th\u00e1i v\u00e0 b\u1ea5t k\u1ef3 \u0111\u01b0\u1eddng \u0111i n\u00e0o trong s\u1ed1 n\u00e0y c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c coi l\u00e0 m\u1ed9t tr\u1ea1ng th\u00e1i.</p>","tags":["Original"]},{"location":"num_methods/simulated_annealing.html#neighbouring-state","title":"Tr\u1ea1ng th\u00e1i l\u00e2n c\u1eadn (Neighbouring state)","text":"<p>N\u00f3 l\u00e0 m\u1ed9t tr\u1ea1ng th\u00e1i trong kh\u00f4ng gian tr\u1ea1ng th\u00e1i g\u1ea7n v\u1edbi tr\u1ea1ng th\u00e1i tr\u01b0\u1edbc \u0111\u00f3. \u0110i\u1ec1u n\u00e0y th\u01b0\u1eddng c\u00f3 ngh\u0129a l\u00e0 ch\u00fang ta c\u00f3 th\u1ec3 thu \u0111\u01b0\u1ee3c tr\u1ea1ng th\u00e1i l\u00e2n c\u1eadn t\u1eeb tr\u1ea1ng th\u00e1i ban \u0111\u1ea7u b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng m\u1ed9t ph\u00e9p bi\u1ebfn \u0111\u1ed5i \u0111\u01a1n gi\u1ea3n. Trong tr\u01b0\u1eddng h\u1ee3p c\u1ee7a b\u00e0i to\u00e1n ng\u01b0\u1eddi b\u00e1n h\u00e0ng, tr\u1ea1ng th\u00e1i l\u00e2n c\u1eadn thu \u0111\u01b0\u1ee3c b\u1eb1ng c\u00e1ch ch\u1ecdn ng\u1eabu nhi\u00ean 2 n\u00fat v\u00e0 ho\u00e1n \u0111\u1ed5i v\u1ecb tr\u00ed c\u1ee7a ch\u00fang \u1edf tr\u1ea1ng th\u00e1i hi\u1ec7n t\u1ea1i.</p>","tags":["Original"]},{"location":"num_methods/simulated_annealing.html#algorithm","title":"Thu\u1eadt to\u00e1n (Algorithm)","text":"<p>Ch\u00fang ta b\u1eaft \u0111\u1ea7u v\u1edbi m\u1ed9t tr\u1ea1ng th\u00e1i ng\u1eabu nhi\u00ean $s$. Trong m\u1ed7i b\u01b0\u1edbc, ch\u00fang t\u00f4i ch\u1ecdn m\u1ed9t tr\u1ea1ng th\u00e1i l\u00e2n c\u1eadn $s_{next}$ c\u1ee7a tr\u1ea1ng th\u00e1i hi\u1ec7n t\u1ea1i $s$. N\u1ebfu $E(s_{next}) &lt; E(s)$, th\u00ec ch\u00fang ta c\u1eadp nh\u1eadt $s = s_{next}$. N\u1ebfu kh\u00f4ng, ch\u00fang ta s\u1eed d\u1ee5ng h\u00e0m ch\u1ea5p nh\u1eadn x\u00e1c su\u1ea5t (Probability Acceptance Function) $P(E(s),E(s_{next}),T)$ \u0111\u1ec3 quy\u1ebft \u0111\u1ecbnh xem ch\u00fang ta n\u00ean chuy\u1ec3n sang $s_{next}$ hay \u1edf l\u1ea1i $s$. T \u1edf \u0111\u00e2y l\u00e0 nhi\u1ec7t \u0111\u1ed9, ban \u0111\u1ea7u \u0111\u01b0\u1ee3c \u0111\u1eb7t th\u00e0nh gi\u00e1 tr\u1ecb cao v\u00e0 ph\u00e2n r\u00e3 ch\u1eadm theo t\u1eebng b\u01b0\u1edbc. Nhi\u1ec7t \u0111\u1ed9 c\u00e0ng cao, c\u00e0ng c\u00f3 nhi\u1ec1u kh\u1ea3 n\u0103ng di chuy\u1ec3n \u0111\u1ebfn $s_{next}$. \u0110\u1ed3ng th\u1eddi, ch\u00fang t\u00f4i c\u0169ng theo d\u00f5i tr\u1ea1ng th\u00e1i t\u1ed1t nh\u1ea5t $s_{best}$ qua t\u1ea5t c\u1ea3 c\u00e1c l\u1ea7n l\u1eb7p. Ti\u1ebfp t\u1ee5c cho \u0111\u1ebfn khi h\u1ed9i t\u1ee5 ho\u1eb7c h\u1ebft th\u1eddi gian.</p> Bi\u1ec3u di\u1ec5n tr\u1ef1c quan v\u1ec1 Luy\u1ec7n kim m\u00f4 ph\u1ecfng, t\u00ecm ki\u1ebfm c\u1ef1c \u0111\u1ea1i c\u1ee7a h\u00e0m n\u00e0y v\u1edbi nhi\u1ec1u c\u1ef1c \u0111\u1ea1i c\u1ee5c b\u1ed9.","tags":["Original"]},{"location":"num_methods/simulated_annealing.html#temperature-t-and-decay-u","title":"Nhi\u1ec7t \u0111\u1ed9 (T) v\u00e0 ph\u00e2n r\u00e3 (u)","text":"<p>Nhi\u1ec7t \u0111\u1ed9 c\u1ee7a h\u1ec7 th\u1ed1ng \u0111\u1ecbnh l\u01b0\u1ee3ng s\u1ef1 s\u1eb5n s\u00e0ng c\u1ee7a thu\u1eadt to\u00e1n \u0111\u1ec3 ch\u1ea5p nh\u1eadn m\u1ed9t tr\u1ea1ng th\u00e1i c\u00f3 n\u0103ng l\u01b0\u1ee3ng cao h\u01a1n. S\u1ef1 ph\u00e2n r\u00e3 l\u00e0 m\u1ed9t h\u1eb1ng s\u1ed1 \u0111\u1ecbnh l\u01b0\u1ee3ng \"t\u1ed1c \u0111\u1ed9 l\u00e0m m\u00e1t\" c\u1ee7a thu\u1eadt to\u00e1n. T\u1ed1c \u0111\u1ed9 l\u00e0m m\u00e1t ch\u1eadm ($u$ l\u1edbn h\u01a1n) \u0111\u01b0\u1ee3c bi\u1ebft l\u00e0 cho k\u1ebft qu\u1ea3 t\u1ed1t h\u01a1n.</p>","tags":["Original"]},{"location":"num_methods/simulated_annealing.html#probability-acceptance-function-paf","title":"H\u00e0m ch\u1ea5p nh\u1eadn x\u00e1c su\u1ea5t (Probability Acceptance Function - PAF)","text":"<p>$P(E,E_{next},T) =      \\begin{cases}        \\text{True} &amp;\\quad\\text{n\u1ebfu }  \\mathcal{U}_{[0,1]} \\le \\exp(-\\frac{E_{next}-E}{T}) \\\\        \\text{False} &amp;\\quad\\text{ng\u01b0\u1ee3c l\u1ea1i}\\\\      \\end{cases}$</p> <p>\u1ede \u0111\u00e2y, $\\mathcal{U}_{[0,1]}$ l\u00e0 m\u1ed9t gi\u00e1 tr\u1ecb ng\u1eabu nhi\u00ean th\u1ed1ng nh\u1ea5t li\u00ean t\u1ee5c tr\u00ean $[0,1]$. H\u00e0m n\u00e0y nh\u1eadn tr\u1ea1ng th\u00e1i hi\u1ec7n t\u1ea1i, tr\u1ea1ng th\u00e1i ti\u1ebfp theo v\u00e0 nhi\u1ec7t \u0111\u1ed9, tr\u1ea3 v\u1ec1 gi\u00e1 tr\u1ecb boolean, cho bi\u1ebft t\u00ecm ki\u1ebfm c\u1ee7a ch\u00fang t\u00f4i li\u1ec7u n\u00f3 c\u00f3 n\u00ean chuy\u1ec3n \u0111\u1ebfn $s_{next}$ hay \u1edf l\u1ea1i $s$. L\u01b0u \u00fd r\u1eb1ng \u0111\u1ed1i v\u1edbi $E_{next} &lt; E$ , h\u00e0m n\u00e0y s\u1ebd lu\u00f4n tr\u1ea3 v\u1ec1 True, n\u1ebfu kh\u00f4ng, n\u00f3 v\u1eabn c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n di chuy\u1ec3n v\u1edbi x\u00e1c su\u1ea5t $\\exp(-\\frac{E_{next}-E}{T})$, t\u01b0\u01a1ng \u1ee9ng v\u1edbi th\u01b0\u1edbc \u0111o Gibbs.</p> <pre><code>bool P(double E,double E_next,double T,mt19937 rng){\n    double prob =  exp(-(E_next-E)/T);\n    if(prob &gt; 1) return true;\n    else{\n        bernoulli_distribution d(prob); \n        return d(rng);\n    }\n}\n</code></pre>","tags":["Original"]},{"location":"num_methods/simulated_annealing.html#code-template","title":"M\u1eabu Code (Code Template)","text":"<pre><code>class state {\n    public:\n    state() {\n        // T\u1ea1o tr\u1ea1ng th\u00e1i ban \u0111\u1ea7u\n    }\n    state next() {\n        state s_next;\n        // S\u1eeda \u0111\u1ed5i s_next th\u00e0nh tr\u1ea1ng th\u00e1i l\u00e2n c\u1eadn ng\u1eabu nhi\u00ean\n        return s_next;\n    }\n    double E() {\n        // C\u00e0i \u0111\u1eb7t h\u00e0m n\u0103ng l\u01b0\u1ee3ng \u1edf \u0111\u00e2y\n    };\n};\n\n\npair&lt;double, state&gt; simAnneal() {\n    state s = state();\n    state best = s;\n    double T = 10000; // Nhi\u1ec7t \u0111\u1ed9 ban \u0111\u1ea7u\n    double u = 0.995; // T\u1ef7 l\u1ec7 ph\u00e2n r\u00e3\n    double E = s.E();\n    double E_next;\n    double E_best = E;\n    mt19937 rng(chrono::steady_clock::now().time_since_epoch().count());\n    while (T &gt; 1) {\n        state next = s.next();\n        E_next = next.E();\n        if (P(E, E_next, T, rng)) {\n            s = next;\n            if (E_next &lt; E_best) {\n                best = s;\n                E_best = E_next;\n            }\n            E = E_next;\n        }\n        T *= u;\n    }\n    return {E_best, best};\n}\n</code></pre>","tags":["Original"]},{"location":"num_methods/simulated_annealing.html#how-to-use","title":"C\u00e1ch s\u1eed d\u1ee5ng (How to use)","text":"<p>\u0110i\u1ec1n v\u00e0o c\u00e1c h\u00e0m l\u1edbp tr\u1ea1ng th\u00e1i khi th\u00edch h\u1ee3p. N\u1ebfu b\u1ea1n \u0111ang c\u1ed1 g\u1eafng t\u00ecm c\u1ef1c \u0111\u1ea1i to\u00e0n c\u1ee5c ch\u1ee9 kh\u00f4ng ph\u1ea3i c\u1ef1c ti\u1ec3u, h\u00e3y \u0111\u1ea3m b\u1ea3o r\u1eb1ng h\u00e0m $E()$ tr\u1ea3 v\u1ec1 s\u1ed1 \u00e2m c\u1ee7a h\u00e0m b\u1ea1n \u0111ang t\u1ed1i \u0111a h\u00f3a v\u00e0 in ra $-E_{best}$ cu\u1ed1i c\u00f9ng. \u0110\u1eb7t c\u00e1c tham s\u1ed1 d\u01b0\u1edbi \u0111\u00e2y theo nhu c\u1ea7u c\u1ee7a b\u1ea1n.</p>","tags":["Original"]},{"location":"num_methods/simulated_annealing.html#parameters","title":"Tham s\u1ed1 (Parameters)","text":"<ul> <li>$T$ : Nhi\u1ec7t \u0111\u1ed9 ban \u0111\u1ea7u. \u0110\u1eb7t n\u00f3 th\u00e0nh gi\u00e1 tr\u1ecb cao h\u01a1n n\u1ebfu b\u1ea1n mu\u1ed1n t\u00ecm ki\u1ebfm ch\u1ea1y trong th\u1eddi gian d\u00e0i h\u01a1n.</li> <li>$u$ : Ph\u00e2n r\u00e3. Quy\u1ebft \u0111\u1ecbnh t\u1ed1c \u0111\u1ed9 l\u00e0m m\u00e1t. T\u1ed1c \u0111\u1ed9 l\u00e0m m\u00e1t ch\u1eadm h\u01a1n (gi\u00e1 tr\u1ecb u l\u1edbn h\u01a1n) th\u01b0\u1eddng cho k\u1ebft qu\u1ea3 t\u1ed1t h\u01a1n v\u1edbi chi ph\u00ed ch\u1ea1y trong th\u1eddi gian d\u00e0i h\u01a1n. \u0110\u1ea3m b\u1ea3o $u &lt; 1$. </li> </ul> <p>S\u1ed1 l\u1ea7n l\u1eb7p m\u00e0 v\u00f2ng l\u1eb7p s\u1ebd ch\u1ea1y \u0111\u01b0\u1ee3c cho b\u1edfi bi\u1ec3u th\u1ee9c</p> <p>$N =   \\lceil -\\log_{u}{T} \\rceil$ </p> <p>M\u1eb9o ch\u1ecdn $T$ v\u00e0 $u$ : N\u1ebfu c\u00f3 nhi\u1ec1u c\u1ef1c ti\u1ec3u c\u1ee5c b\u1ed9 v\u00e0 kh\u00f4ng gian tr\u1ea1ng th\u00e1i r\u1ed9ng, h\u00e3y \u0111\u1eb7t $u = 0.999$, \u0111\u1ed1i v\u1edbi t\u1ed1c \u0111\u1ed9 l\u00e0m m\u00e1t ch\u1eadm, \u0111i\u1ec1u n\u00e0y s\u1ebd cho ph\u00e9p thu\u1eadt to\u00e1n kh\u00e1m ph\u00e1 nhi\u1ec1u kh\u1ea3 n\u0103ng h\u01a1n. M\u1eb7t kh\u00e1c, n\u1ebfu kh\u00f4ng gian tr\u1ea1ng th\u00e1i h\u1eb9p h\u01a1n, $u = 0.99$ l\u00e0 \u0111\u1ee7. N\u1ebfu b\u1ea1n kh\u00f4ng ch\u1eafc ch\u1eafn, h\u00e3y ch\u01a1i an to\u00e0n b\u1eb1ng c\u00e1ch \u0111\u1eb7t $u = 0.998$ ho\u1eb7c cao h\u01a1n. T\u00ednh to\u00e1n \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian c\u1ee7a m\u1ed9t l\u1ea7n l\u1eb7p duy nh\u1ea5t c\u1ee7a thu\u1eadt to\u00e1n v\u00e0 s\u1eed d\u1ee5ng gi\u00e1 tr\u1ecb n\u00e0y \u0111\u1ec3 \u01b0\u1edbc t\u00ednh gi\u00e1 tr\u1ecb c\u1ee7a $N$ \u0111\u1ec3 ng\u0103n TLE, sau \u0111\u00f3 s\u1eed d\u1ee5ng c\u00f4ng th\u1ee9c d\u01b0\u1edbi \u0111\u00e2y \u0111\u1ec3 thu \u0111\u01b0\u1ee3c $T$.</p> <p>$T = u^{-N}$</p>","tags":["Original"]},{"location":"num_methods/simulated_annealing.html#example-implementation-for-tsp","title":"V\u00ed d\u1ee5 c\u00e0i \u0111\u1eb7t cho TSP (Example implementation for TSP)","text":"<pre><code>class state {\n    public:\n    vector&lt;pair&lt;int, int&gt;&gt; points;\n    std::mt19937 mt{ static_cast&lt;std::mt19937::result_type&gt;(\n        std::chrono::steady_clock::now().time_since_epoch().count()\n        ) };\n    state() {\n        points = {{0,0},{2,2},{0,2},{2,0},{0,1},{1,2},{2,1},{1,0}};\n    }\n    state next() {\n        state s_next;\n        s_next.points = points;\n        uniform_int_distribution&lt;&gt; choose(0, points.size()-1);\n        int a = choose(mt);\n        int b = choose(mt);\n        s_next.points[a].swap(s_next.points[b]);\n        return s_next;\n    }\n\n    double euclidean(pair&lt;int, int&gt; a, pair&lt;int, int&gt; b) {\n        return hypot(a.first - b.first, a.second - b.second);\n    }\n\n    double E() {\n        double dist = 0;\n        int n = points.size();\n        for (int i = 0;i &lt; n; i++)\n            dist += euclidean(points[i], points[(i+1)%n]);\n        return dist;\n    };\n};\n\nint main() {\n    pair&lt;double, state&gt; res;\n    res = simAnneal();\n    double E_best = res.first;\n    state best = res.second;\n    cout &lt;&lt; \"Lenght of shortest path found : \" &lt;&lt; E_best &lt;&lt; \"\\n\";\n    cout &lt;&lt; \"Order of points in shortest path : \\n\";\n    for(auto x: best.points) {\n        cout &lt;&lt; x.first &lt;&lt; \" \" &lt;&lt; x.second &lt;&lt; \"\\n\";\n    }\n}\n</code></pre>","tags":["Original"]},{"location":"num_methods/simulated_annealing.html#further-modifications-to-the-algorithm","title":"C\u00e1c s\u1eeda \u0111\u1ed5i kh\u00e1c \u0111\u1ed1i v\u1edbi thu\u1eadt to\u00e1n (Further modifications to the algorithm)","text":"<ul> <li>Th\u00eam \u0111i\u1ec1u ki\u1ec7n tho\u00e1t d\u1ef1a tr\u00ean th\u1eddi gian v\u00e0o v\u00f2ng l\u1eb7p while \u0111\u1ec3 ng\u0103n TLE</li> <li>S\u1ef1 ph\u00e2n r\u00e3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n \u1edf tr\u00ean l\u00e0 ph\u00e2n r\u00e3 theo c\u1ea5p s\u1ed1 nh\u00e2n. B\u1ea1n lu\u00f4n c\u00f3 th\u1ec3 thay th\u1ebf \u0111i\u1ec1u n\u00e0y b\u1eb1ng m\u1ed9t h\u00e0m ph\u00e2n r\u00e3 theo nhu c\u1ea7u c\u1ee7a b\u1ea1n.</li> <li>H\u00e0m ch\u1ea5p nh\u1eadn x\u00e1c su\u1ea5t \u0111\u01b0\u1ee3c \u0111\u01b0a ra \u1edf tr\u00ean, th\u00edch ch\u1ea5p nh\u1eadn c\u00e1c tr\u1ea1ng th\u00e1i c\u00f3 n\u0103ng l\u01b0\u1ee3ng th\u1ea5p h\u01a1n v\u00ec th\u1eeba s\u1ed1 $E_{next} - E$ trong t\u1eed s\u1ed1 c\u1ee7a s\u1ed1 m\u0169. B\u1ea1n c\u00f3 th\u1ec3 ch\u1ec9 c\u1ea7n lo\u1ea1i b\u1ecf y\u1ebfu t\u1ed1 n\u00e0y \u0111\u1ec3 l\u00e0m cho PAF \u0111\u1ed9c l\u1eadp v\u1edbi s\u1ef1 kh\u00e1c bi\u1ec7t v\u1ec1 n\u0103ng l\u01b0\u1ee3ng.</li> <li>\u1ea2nh h\u01b0\u1edfng c\u1ee7a s\u1ef1 kh\u00e1c bi\u1ec7t v\u1ec1 n\u0103ng l\u01b0\u1ee3ng, $E_{next} - E$, tr\u00ean PAF c\u00f3 th\u1ec3 t\u0103ng/gi\u1ea3m b\u1eb1ng c\u00e1ch t\u0103ng/gi\u1ea3m c\u01a1 s\u1ed1 c\u1ee7a s\u1ed1 m\u0169 nh\u01b0 h\u00ecnh d\u01b0\u1edbi \u0111\u00e2y:  <pre><code>bool P(double E, double E_next, double T, mt19937 rng) {\n    double e = 2; // \u0111\u1eb7t e th\u00e0nh b\u1ea5t k\u1ef3 s\u1ed1 th\u1ef1c n\u00e0o l\u1edbn h\u01a1n 1\n    double prob =  pow(e,-(E_next-E)/T);\n    if (prob &gt; 1)\n        return true;\n    else {\n        bernoulli_distribution d(prob); \n        return d(rng);\n    }\n}\n</code></pre></li> </ul>","tags":["Original"]},{"location":"num_methods/simulated_annealing.html#problems","title":"B\u00e0i t\u1eadp (Problems)","text":"<ul> <li>USACO Jan 2017 - Subsequence Reversal</li> <li>Deltix Summer 2021 - DIY Tree</li> <li>AtCoder Contest Scheduling</li> </ul>","tags":["Original"]},{"location":"num_methods/ternary_search.html","title":"T\u00ecm ki\u1ebfm tam ph\u00e2n (Ternary Search)","text":"<p>Ch\u00fang ta \u0111\u01b0\u1ee3c cho m\u1ed9t h\u00e0m $f(x)$ \u0111\u01a1n mode (unimodal) tr\u00ean m\u1ed9t kho\u1ea3ng $[l, r]$. H\u00e0m \u0111\u01a1n mode c\u00f3 ngh\u0129a l\u00e0 h\u00e0m c\u00f3 m\u1ed9t trong hai h\u00e0nh vi sau:</p> <ol> <li> <p>H\u00e0m t\u0103ng nghi\u00eam ng\u1eb7t tr\u01b0\u1edbc, \u0111\u1ea1t c\u1ef1c \u0111\u1ea1i (t\u1ea1i m\u1ed9t \u0111i\u1ec3m ho\u1eb7c tr\u00ean m\u1ed9t kho\u1ea3ng), v\u00e0 sau \u0111\u00f3 gi\u1ea3m nghi\u00eam ng\u1eb7t.</p> </li> <li> <p>H\u00e0m gi\u1ea3m nghi\u00eam ng\u1eb7t tr\u01b0\u1edbc, \u0111\u1ea1t c\u1ef1c ti\u1ec3u, v\u00e0 sau \u0111\u00f3 t\u0103ng nghi\u00eam ng\u1eb7t.</p> </li> </ol> <p>Trong b\u00e0i vi\u1ebft n\u00e0y, ch\u00fang t\u00f4i s\u1ebd gi\u1ea3 \u0111\u1ecbnh k\u1ecbch b\u1ea3n \u0111\u1ea7u ti\u00ean. K\u1ecbch b\u1ea3n th\u1ee9 hai ho\u00e0n to\u00e0n \u0111\u1ed1i x\u1ee9ng v\u1edbi k\u1ecbch b\u1ea3n \u0111\u1ea7u ti\u00ean.</p> <p>Nhi\u1ec7m v\u1ee5 l\u00e0 t\u00ecm gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t c\u1ee7a h\u00e0m $f(x)$ tr\u00ean kho\u1ea3ng $[l, r]$.</p>","tags":["Translated"]},{"location":"num_methods/ternary_search.html#algorithm","title":"Thu\u1eadt to\u00e1n (Algorithm)","text":"<p>Xem x\u00e9t b\u1ea5t k\u1ef3 2 \u0111i\u1ec3m $m_1$, v\u00e0 $m_2$ trong kho\u1ea3ng n\u00e0y: $l &lt; m_1 &lt; m_2 &lt; r$. Ch\u00fang ta \u0111\u00e1nh gi\u00e1 h\u00e0m t\u1ea1i $m_1$ v\u00e0 $m_2$, t\u1ee9c l\u00e0 t\u00ecm c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a $f(m_1)$ v\u00e0 $f(m_2)$. B\u00e2y gi\u1edd, ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c m\u1ed9t trong ba t\u00f9y ch\u1ecdn:</p> <ul> <li> <p>$f(m_1) &lt; f(m_2)$</p> <p>C\u1ef1c \u0111\u1ea1i mong mu\u1ed1n kh\u00f4ng th\u1ec3 n\u1eb1m \u1edf ph\u00eda b\u00ean tr\u00e1i c\u1ee7a $m_1$, t\u1ee9c l\u00e0 tr\u00ean kho\u1ea3ng $[l, m_1]$, v\u00ec c\u1ea3 hai \u0111i\u1ec3m $m_1$ v\u00e0 $m_2$ ho\u1eb7c ch\u1ec9 $m_1$ thu\u1ed9c v\u1ec1 khu v\u1ef1c m\u00e0 h\u00e0m t\u0103ng. Trong c\u1ea3 hai tr\u01b0\u1eddng h\u1ee3p, \u0111i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 ch\u00fang ta ph\u1ea3i t\u00ecm ki\u1ebfm c\u1ef1c \u0111\u1ea1i trong \u0111o\u1ea1n $[m_1, r]$.</p> </li> <li> <p>$f(m_1) &gt; f(m_2)$</p> <p>T\u00ecnh hu\u1ed1ng n\u00e0y \u0111\u1ed1i x\u1ee9ng v\u1edbi t\u00ecnh hu\u1ed1ng tr\u01b0\u1edbc: c\u1ef1c \u0111\u1ea1i kh\u00f4ng th\u1ec3 n\u1eb1m \u1edf ph\u00eda b\u00ean ph\u1ea3i c\u1ee7a $m_2$, t\u1ee9c l\u00e0 tr\u00ean kho\u1ea3ng $[m_2, r]$, v\u00e0 kh\u00f4ng gian t\u00ecm ki\u1ebfm gi\u1ea3m xu\u1ed1ng \u0111o\u1ea1n $[l, m_2]$.</p> </li> <li> <p>$f(m_1) = f(m_2)$</p> <p>Ch\u00fang ta c\u00f3 th\u1ec3 th\u1ea5y r\u1eb1ng ho\u1eb7c c\u1ea3 hai \u0111i\u1ec3m n\u00e0y thu\u1ed9c v\u1ec1 khu v\u1ef1c m\u00e0 gi\u00e1 tr\u1ecb c\u1ee7a h\u00e0m \u0111\u01b0\u1ee3c t\u1ed1i \u0111a h\u00f3a, ho\u1eb7c $m_1$ n\u1eb1m trong khu v\u1ef1c c\u00f3 gi\u00e1 tr\u1ecb t\u0103ng v\u00e0 $m_2$ n\u1eb1m trong khu v\u1ef1c c\u00f3 gi\u00e1 tr\u1ecb gi\u1ea3m (\u1edf \u0111\u00e2y ch\u00fang ta \u0111\u00e3 s\u1eed d\u1ee5ng t\u00ednh nghi\u00eam ng\u1eb7t c\u1ee7a h\u00e0m t\u0103ng/gi\u1ea3m). Do \u0111\u00f3, kh\u00f4ng gian t\u00ecm ki\u1ebfm gi\u1ea3m xu\u1ed1ng c\u00f2n $[m_1, m_2]$. \u0110\u1ec3 \u0111\u01a1n gi\u1ea3n h\u00f3a m\u00e3, tr\u01b0\u1eddng h\u1ee3p n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c k\u1ebft h\u1ee3p v\u1edbi b\u1ea5t k\u1ef3 tr\u01b0\u1eddng h\u1ee3p n\u00e0o tr\u01b0\u1edbc \u0111\u00f3.</p> </li> </ul> <p>Do \u0111\u00f3, d\u1ef1a tr\u00ean so s\u00e1nh c\u00e1c gi\u00e1 tr\u1ecb trong hai \u0111i\u1ec3m b\u00ean trong, ch\u00fang ta c\u00f3 th\u1ec3 thay th\u1ebf kho\u1ea3ng hi\u1ec7n t\u1ea1i $[l, r]$ b\u1eb1ng m\u1ed9t kho\u1ea3ng m\u1edbi, ng\u1eafn h\u01a1n $[l^\\prime, r^\\prime]$. \u00c1p d\u1ee5ng l\u1eb7p \u0111i l\u1eb7p l\u1ea1i quy tr\u00ecnh \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 cho kho\u1ea3ng, ch\u00fang ta c\u00f3 th\u1ec3 nh\u1eadn \u0111\u01b0\u1ee3c m\u1ed9t kho\u1ea3ng ng\u1eafn t\u00f9y \u00fd. Cu\u1ed1i c\u00f9ng, \u0111\u1ed9 d\u00e0i c\u1ee7a n\u00f3 s\u1ebd nh\u1ecf h\u01a1n m\u1ed9t h\u1eb1ng s\u1ed1 \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh tr\u01b0\u1edbc nh\u1ea5t \u0111\u1ecbnh (\u0111\u1ed9 ch\u00ednh x\u00e1c) v\u00e0 qu\u00e1 tr\u00ecnh c\u00f3 th\u1ec3 d\u1eebng l\u1ea1i. \u0110\u00e2y l\u00e0 m\u1ed9t ph\u01b0\u01a1ng ph\u00e1p s\u1ed1, v\u00ec v\u1eady ch\u00fang ta c\u00f3 th\u1ec3 gi\u1ea3 \u0111\u1ecbnh r\u1eb1ng sau \u0111\u00f3 h\u00e0m \u0111\u1ea1t c\u1ef1c \u0111\u1ea1i t\u1ea1i t\u1ea5t c\u1ea3 c\u00e1c \u0111i\u1ec3m c\u1ee7a kho\u1ea3ng cu\u1ed1i c\u00f9ng $[l, r]$. Kh\u00f4ng m\u1ea5t t\u00ednh t\u1ed5ng qu\u00e1t, ch\u00fang ta c\u00f3 th\u1ec3 l\u1ea5y $f(l)$ l\u00e0m gi\u00e1 tr\u1ecb tr\u1ea3 v\u1ec1.</p> <p>Ch\u00fang t\u00f4i \u0111\u00e3 kh\u00f4ng \u00e1p \u0111\u1eb7t b\u1ea5t k\u1ef3 h\u1ea1n ch\u1ebf n\u00e0o \u0111\u1ed1i v\u1edbi vi\u1ec7c ch\u1ecdn \u0111i\u1ec3m $m_1$ v\u00e0 $m_2$. L\u1ef1a ch\u1ecdn n\u00e0y s\u1ebd x\u00e1c \u0111\u1ecbnh t\u1ed1c \u0111\u1ed9 h\u1ed9i t\u1ee5 v\u00e0 \u0111\u1ed9 ch\u00ednh x\u00e1c c\u1ee7a vi\u1ec7c tri\u1ec3n khai. C\u00e1ch ph\u1ed5 bi\u1ebfn nh\u1ea5t l\u00e0 ch\u1ecdn c\u00e1c \u0111i\u1ec3m sao cho ch\u00fang chia kho\u1ea3ng $[l, r]$ th\u00e0nh ba ph\u1ea7n b\u1eb1ng nhau. V\u00ec v\u1eady, ch\u00fang ta c\u00f3</p> $$m_1 = l + \\frac{(r - l)}{3}$$ $$m_2 = r - \\frac{(r - l)}{3}$$ <p>N\u1ebfu $m_1$ v\u00e0 $m_2$ \u0111\u01b0\u1ee3c ch\u1ecdn g\u1ea7n nhau h\u01a1n, t\u1ed1c \u0111\u1ed9 h\u1ed9i t\u1ee5 s\u1ebd t\u0103ng nh\u1eb9.</p>","tags":["Translated"]},{"location":"num_methods/ternary_search.html#run-time-analysis","title":"Ph\u00e2n t\u00edch th\u1eddi gian ch\u1ea1y (Run time analysis)","text":"$$T(n) = T({2n}/{3}) + O(1) = \\Theta(\\log n)$$ <p>N\u00f3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c h\u00ecnh dung nh\u01b0 sau: m\u1ed7i l\u1ea7n sau khi \u0111\u00e1nh gi\u00e1 h\u00e0m t\u1ea1i c\u00e1c \u0111i\u1ec3m $m_1$ v\u00e0 $m_2$, v\u1ec1 c\u01a1 b\u1ea3n ch\u00fang ta \u0111ang b\u1ecf qua kho\u1ea3ng m\u1ed9t ph\u1ea7n ba kho\u1ea3ng, b\u00ean tr\u00e1i ho\u1eb7c b\u00ean ph\u1ea3i. Do \u0111\u00f3, k\u00edch th\u01b0\u1edbc c\u1ee7a kh\u00f4ng gian t\u00ecm ki\u1ebfm l\u00e0 ${2n}/{3}$ so v\u1edbi ban \u0111\u1ea7u.</p> <p>\u00c1p d\u1ee5ng \u0110\u1ecbnh l\u00fd Th\u1ee3, ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c \u01b0\u1edbc t\u00ednh \u0111\u1ed9 ph\u1ee9c t\u1ea1p mong mu\u1ed1n.</p>","tags":["Translated"]},{"location":"num_methods/ternary_search.html#the-case-of-the-integer-arguments","title":"Tr\u01b0\u1eddng h\u1ee3p \u0111\u1ed1i s\u1ed1 nguy\u00ean (The case of the integer arguments)","text":"<p>N\u1ebfu $f(x)$ nh\u1eadn tham s\u1ed1 nguy\u00ean, kho\u1ea3ng $[l, r]$ tr\u1edf n\u00ean r\u1eddi r\u1ea1c. V\u00ec ch\u00fang t\u00f4i kh\u00f4ng \u00e1p \u0111\u1eb7t b\u1ea5t k\u1ef3 h\u1ea1n ch\u1ebf n\u00e0o \u0111\u1ed1i v\u1edbi vi\u1ec7c l\u1ef1a ch\u1ecdn \u0111i\u1ec3m $m_1$ v\u00e0 $m_2$, t\u00ednh ch\u00ednh x\u00e1c c\u1ee7a thu\u1eadt to\u00e1n kh\u00f4ng b\u1ecb \u1ea3nh h\u01b0\u1edfng. $m_1$ v\u00e0 $m_2$ v\u1eabn c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c ch\u1ecdn \u0111\u1ec3 chia $[l, r]$ th\u00e0nh 3 ph\u1ea7n x\u1ea5p x\u1ec9 b\u1eb1ng nhau.</p> <p>S\u1ef1 kh\u00e1c bi\u1ec7t x\u1ea3y ra trong ti\u00eau ch\u00ed d\u1eebng c\u1ee7a thu\u1eadt to\u00e1n. T\u00ecm ki\u1ebfm tam ph\u00e2n s\u1ebd ph\u1ea3i d\u1eebng khi $(r - l) &lt; 3$, b\u1edfi v\u00ec trong tr\u01b0\u1eddng h\u1ee3p \u0111\u00f3 ch\u00fang ta kh\u00f4ng th\u1ec3 ch\u1ecdn $m_1$ v\u00e0 $m_2$ kh\u00e1c nhau c\u0169ng nh\u01b0 kh\u00e1c v\u1edbi $l$ v\u00e0 $r$, v\u00e0 \u0111i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 g\u00e2y ra v\u00f2ng l\u1eb7p v\u00f4 h\u1ea1n. Khi $(r - l) &lt; 3$, nh\u00f3m \u0111i\u1ec3m \u1ee9ng c\u1eed vi\u00ean c\u00f2n l\u1ea1i $(l, l + 1, \\ldots, r)$ c\u1ea7n \u0111\u01b0\u1ee3c ki\u1ec3m tra \u0111\u1ec3 t\u00ecm \u0111i\u1ec3m t\u1ea1o ra gi\u00e1 tr\u1ecb c\u1ef1c \u0111\u1ea1i $f(x)$.</p>","tags":["Translated"]},{"location":"num_methods/ternary_search.html#golden-section-search","title":"T\u00ecm ki\u1ebfm t\u1ef7 l\u1ec7 v\u00e0ng (Golden section search)","text":"<p>Trong m\u1ed9t s\u1ed1 tr\u01b0\u1eddng h\u1ee3p, t\u00ednh to\u00e1n $f(x)$ c\u00f3 th\u1ec3 kh\u00e1 ch\u1eadm, nh\u01b0ng vi\u1ec7c gi\u1ea3m s\u1ed1 l\u1ea7n l\u1eb7p l\u00e0 kh\u00f4ng kh\u1ea3 thi do c\u00e1c v\u1ea5n \u0111\u1ec1 v\u1ec1 \u0111\u1ed9 ch\u00ednh x\u00e1c. May m\u1eafn thay, c\u00f3 th\u1ec3 ch\u1ec9 t\u00ednh to\u00e1n $f(x)$ m\u1ed9t l\u1ea7n \u1edf m\u1ed7i l\u1ea7n l\u1eb7p (ngo\u1ea1i tr\u1eeb l\u1ea7n \u0111\u1ea7u ti\u00ean).</p> <p>\u0110\u1ec3 xem c\u00e1ch th\u1ef1c hi\u1ec7n vi\u1ec7c n\u00e0y, h\u00e3y xem l\u1ea1i ph\u01b0\u01a1ng ph\u00e1p l\u1ef1a ch\u1ecdn cho $m_1$ v\u00e0 $m_2$. Gi\u1ea3 s\u1eed r\u1eb1ng ch\u00fang ta ch\u1ecdn $m_1$ v\u00e0 $m_2$ tr\u00ean $[l, r]$ theo c\u00e1ch m\u00e0 $\\frac{r - l}{r - m_1} = \\frac{r - l}{m_2 - l} = \\varphi$ trong \u0111\u00f3 $\\varphi$ l\u00e0 m\u1ed9t h\u1eb1ng s\u1ed1 n\u00e0o \u0111\u00f3. \u0110\u1ec3 gi\u1ea3m l\u01b0\u1ee3ng t\u00ednh to\u00e1n, ch\u00fang t\u00f4i mu\u1ed1n ch\u1ecdn $\\varphi$ sao cho trong l\u1ea7n l\u1eb7p ti\u1ebfp theo, m\u1ed9t trong c\u00e1c \u0111i\u1ec3m \u0111\u00e1nh gi\u00e1 m\u1edbi $m_1'$, $m_2'$ s\u1ebd tr\u00f9ng v\u1edbi $m_1$ ho\u1eb7c $m_2$, \u0111\u1ec3 ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng l\u1ea1i gi\u00e1 tr\u1ecb h\u00e0m \u0111\u00e3 t\u00ednh to\u00e1n.</p> <p>B\u00e2y gi\u1edd gi\u1ea3 s\u1eed r\u1eb1ng sau l\u1ea7n l\u1eb7p hi\u1ec7n t\u1ea1i, ch\u00fang ta \u0111\u1eb7t $l = m_1$. Khi \u0111\u00f3 \u0111i\u1ec3m $m_1'$ s\u1ebd th\u1ecfa m\u00e3n $\\frac{r - m_1}{r - m_1'} = \\varphi$. Ch\u00fang t\u00f4i mu\u1ed1n \u0111i\u1ec3m n\u00e0y tr\u00f9ng v\u1edbi $m_2$, ngh\u0129a l\u00e0 $\\frac{r - m_1}{r - m_2} = \\varphi$.</p> <p>Nh\u00e2n c\u1ea3 hai v\u1ebf c\u1ee7a $\\frac{r - m_1}{r - m_2} = \\varphi$ v\u1edbi $\\frac{r - m_2}{r - l}$ ch\u00fang ta thu \u0111\u01b0\u1ee3c $\\frac{r - m_1}{r - l} = \\varphi\\frac{r - m_2}{r - l}$. L\u01b0u \u00fd r\u1eb1ng $\\frac{r - m_1}{r - l} = \\frac{1}{\\varphi}$ v\u00e0 $\\frac{r - m_2}{r - l} = \\frac{r - l + l - m_2}{r - l} = 1 - \\frac{1}{\\varphi}$. Thay th\u1ebf v\u00e0 nh\u00e2n v\u1edbi $\\varphi$, ch\u00fang ta thu \u0111\u01b0\u1ee3c ph\u01b0\u01a1ng tr\u00ecnh sau:</p> <p>$\\varphi^2 - \\varphi - 1 = 0$</p> <p>\u0110\u00e2y l\u00e0 m\u1ed9t ph\u01b0\u01a1ng tr\u00ecnh t\u1ef7 l\u1ec7 v\u00e0ng n\u1ed5i ti\u1ebfng. Gi\u1ea3i n\u00f3 mang l\u1ea1i $\\frac{1 \\pm \\sqrt{5}}{2}$. V\u00ec $\\varphi$ ph\u1ea3i d\u01b0\u01a1ng, ch\u00fang ta thu \u0111\u01b0\u1ee3c $\\varphi = \\frac{1 + \\sqrt{5}}{2}$. B\u1eb1ng c\u00e1ch \u00e1p d\u1ee5ng c\u00f9ng m\u1ed9t logic cho tr\u01b0\u1eddng h\u1ee3p khi ch\u00fang ta \u0111\u1eb7t $r = m_2$ v\u00e0 mu\u1ed1n $m_2'$ tr\u00f9ng v\u1edbi $m_1$, ch\u00fang ta c\u0169ng thu \u0111\u01b0\u1ee3c c\u00f9ng m\u1ed9t gi\u00e1 tr\u1ecb c\u1ee7a $\\varphi$. V\u00ec v\u1eady, n\u1ebfu ch\u00fang ta ch\u1ecdn $m_1 = l + \\frac{r - l}{1 + \\varphi}$ v\u00e0 $m_2 = r - \\frac{r - l}{1 + \\varphi}$, tr\u00ean m\u1ed7i l\u1ea7n l\u1eb7p, ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng l\u1ea1i m\u1ed9t trong c\u00e1c gi\u00e1 tr\u1ecb $f(x)$ \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n trong l\u1ea7n l\u1eb7p tr\u01b0\u1edbc \u0111\u00f3.</p>","tags":["Translated"]},{"location":"num_methods/ternary_search.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<pre><code>double ternary_search(double l, double r) {\n    double eps = 1e-9;              //\u0111\u1eb7t gi\u1edbi h\u1ea1n sai s\u1ed1 \u1edf \u0111\u00e2y\n    while (r - l &gt; eps) {\n        double m1 = l + (r - l) / 3;\n        double m2 = r - (r - l) / 3;\n        double f1 = f(m1);      //\u0111\u00e1nh gi\u00e1 h\u00e0m t\u1ea1i m1\n        double f2 = f(m2);      //\u0111\u00e1nh gi\u00e1 h\u00e0m t\u1ea1i m2\n        if (f1 &lt; f2)\n            l = m1;\n        else\n            r = m2;\n    }\n    return f(l);                    //tr\u1ea3 v\u1ec1 c\u1ef1c \u0111\u1ea1i c\u1ee7a f(x) trong [l, r]\n}\n</code></pre> <p>\u1ede \u0111\u00e2y <code>eps</code> th\u1ef1c t\u1ebf l\u00e0 sai s\u1ed1 tuy\u1ec7t \u0111\u1ed1i (kh\u00f4ng t\u00ednh \u0111\u1ebfn sai s\u1ed1 do t\u00ednh to\u00e1n kh\u00f4ng ch\u00ednh x\u00e1c c\u1ee7a h\u00e0m).</p> <p>Thay v\u00ec ti\u00eau ch\u00ed <code>r - l &gt; eps</code>, ch\u00fang ta c\u00f3 th\u1ec3 ch\u1ecdn m\u1ed9t s\u1ed1 kh\u00f4ng \u0111\u1ed5i l\u1ea7n l\u1eb7p l\u00e0m ti\u00eau ch\u00ed d\u1eebng. S\u1ed1 l\u1ea7n l\u1eb7p n\u00ean \u0111\u01b0\u1ee3c ch\u1ecdn \u0111\u1ec3 \u0111\u1ea3m b\u1ea3o \u0111\u1ed9 ch\u00ednh x\u00e1c c\u1ea7n thi\u1ebft. Th\u00f4ng th\u01b0\u1eddng, trong h\u1ea7u h\u1ebft c\u00e1c th\u1eed th\u00e1ch l\u1eadp tr\u00ecnh, gi\u1edbi h\u1ea1n sai s\u1ed1 l\u00e0 ${10}^{-6}$ v\u00e0 do \u0111\u00f3 200 - 300 l\u1ea7n l\u1eb7p l\u00e0 \u0111\u1ee7. Ngo\u00e0i ra, s\u1ed1 l\u1ea7n l\u1eb7p kh\u00f4ng ph\u1ee5 thu\u1ed9c v\u00e0o c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a $l$ v\u00e0 $r$, v\u00ec v\u1eady s\u1ed1 l\u1ea7n l\u1eb7p t\u01b0\u01a1ng \u1ee9ng v\u1edbi sai s\u1ed1 t\u01b0\u01a1ng \u0111\u1ed1i c\u1ea7n thi\u1ebft.</p>","tags":["Translated"]},{"location":"num_methods/ternary_search.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>Codeforces - New Bakery</li> <li>Codechef - Race time</li> <li>Hackerearth - Rescuer</li> <li>Spoj - Building Construction</li> <li>Codeforces - Weakness and Poorness</li> <li>LOJ - Closest Distance</li> <li>GYM - Dome of Circus (D)</li> <li>UVA - Galactic Taxes</li> <li>GYM - Chasing the Cheetahs (A)</li> <li>UVA - 12197 - Trick or Treat</li> <li>SPOJ - Building Construction</li> <li>Codeforces - Devu and his Brother</li> <li>Codechef - Is This JEE </li> <li>Codeforces - Restorer Distance</li> <li>TIMUS 1058 Chocolate</li> <li>TIMUS 1436 Billboard</li> <li>TIMUS 1451 Beerhouse Tale</li> <li>TIMUS 1719 Kill the Shaitan-Boss</li> <li>TIMUS 1913 Titan Ruins: Alignment of Forces</li> </ul>","tags":["Translated"]},{"location":"num_methods/ternary_search.html#checklist","title":"Checklist","text":"<ul> <li>[x] D\u1ecbch c\u00e1c kh\u00e1i ni\u1ec7m k\u1ef9 thu\u1eadt sang ti\u1ebfng Vi\u1ec7t ch\u00ednh x\u00e1c.</li> <li>[x] \u0110\u00e3 c\u1eadp nh\u1eadt c\u00e1c li\u00ean k\u1ebft n\u1ed9i b\u1ed9 (\u0111\u1ebfn 127.0.0.1:8000).</li> <li>[x] \u0110\u1ecbnh d\u1ea1ng l\u1ea1i c\u00e1c c\u00f4ng th\u1ee9c to\u00e1n h\u1ecdc v\u00e0 code block.</li> <li>[x] Ki\u1ec3m tra ch\u00ednh t\u1ea3 v\u00e0 ng\u1eef ph\u00e1p.</li> <li>[x] \u0110\u1ea3m b\u1ea3o t\u00ednh nh\u1ea5t qu\u00e1n v\u1edbi c\u00e1c thu\u1eadt ng\u1eef \u0111\u00e3 d\u1ecbch kh\u00e1c.</li> </ul>","tags":["Translated"]},{"location":"others/15-puzzle.html","title":"Tr\u00f2 ch\u01a1i 15 Puzzle: S\u1ef1 t\u1ed3n t\u1ea1i c\u1ee7a l\u1eddi gi\u1ea3i (15 Puzzle Game: Existence Of The Solution)","text":"<p>Tr\u00f2 ch\u01a1i n\u00e0y \u0111\u01b0\u1ee3c ch\u01a1i tr\u00ean m\u1ed9t b\u1ea3ng $4 \\times 4$. Tr\u00ean b\u1ea3ng n\u00e0y c\u00f3 $15$ \u00f4 vu\u00f4ng \u0111\u01b0\u1ee3c \u0111\u00e1nh s\u1ed1 t\u1eeb 1 \u0111\u1ebfn 15. M\u1ed9t \u00f4 \u0111\u01b0\u1ee3c \u0111\u1ec3 tr\u1ed1ng (k\u00fd hi\u1ec7u l\u00e0 0). B\u1ea1n c\u1ea7n \u0111\u01b0a b\u1ea3ng v\u1ec1 v\u1ecb tr\u00ed \u0111\u01b0\u1ee3c tr\u00ecnh b\u00e0y b\u00ean d\u01b0\u1edbi b\u1eb1ng c\u00e1ch di chuy\u1ec3n l\u1eb7p \u0111i l\u1eb7p l\u1ea1i m\u1ed9t trong c\u00e1c \u00f4 vu\u00f4ng v\u00e0o kh\u00f4ng gian tr\u1ed1ng:</p> $$\\begin{matrix} 1 &amp; 2 &amp; 3 &amp; 4 \\\\ 5 &amp; 6 &amp; 7 &amp; 8 \\\\ 9 &amp; 10 &amp; 11 &amp; 12 \\\\ 13 &amp; 14 &amp; 15 &amp; 0 \\end{matrix}$$ <p>Tr\u00f2 ch\u01a1i \"15 Puzzle\" \u0111\u01b0\u1ee3c t\u1ea1o ra b\u1edfi Noyes Chapman v\u00e0o n\u0103m 1880.</p>","tags":["Translated"]},{"location":"others/15-puzzle.html#existence-of-the-solution","title":"S\u1ef1 t\u1ed3n t\u1ea1i c\u1ee7a l\u1eddi gi\u1ea3i (Existence Of The Solution)","text":"<p>H\u00e3y xem x\u00e9t b\u00e0i to\u00e1n n\u00e0y: cho m\u1ed9t v\u1ecb tr\u00ed tr\u00ean b\u1ea3ng, x\u00e1c \u0111\u1ecbnh xem c\u00f3 t\u1ed3n t\u1ea1i m\u1ed9t chu\u1ed7i c\u00e1c b\u01b0\u1edbc di chuy\u1ec3n d\u1eabn \u0111\u1ebfn l\u1eddi gi\u1ea3i hay kh\u00f4ng.</p> <p>Gi\u1ea3 s\u1eed ch\u00fang ta c\u00f3 m\u1ed9t v\u1ecb tr\u00ed n\u00e0o \u0111\u00f3 tr\u00ean b\u1ea3ng:</p> $$\\begin{matrix} a_1 &amp; a_2 &amp; a_3 &amp; a_4 \\\\ a_5 &amp; a_6 &amp; a_7 &amp; a_8 \\\\ a_9 &amp; a_{10} &amp; a_{11} &amp; a_{12} \\\\ a_{13} &amp; a_{14} &amp; a_{15} &amp; a_{16} \\end{matrix}$$ <p>trong \u0111\u00f3 m\u1ed9t trong c\u00e1c ph\u1ea7n t\u1eed b\u1eb1ng kh\u00f4ng v\u00e0 bi\u1ec3u th\u1ecb m\u1ed9t \u00f4 tr\u1ed1ng $a_z  = 0$</p> <p>H\u00e3y xem x\u00e9t ho\u00e1n v\u1ecb:</p> $$a_1 a_2 ... a_{z-1} a_{z+1} ... a_{15} a_{16}$$ <p>t\u1ee9c l\u00e0 ho\u00e1n v\u1ecb c\u1ee7a c\u00e1c s\u1ed1 t\u01b0\u01a1ng \u1ee9ng v\u1edbi v\u1ecb tr\u00ed tr\u00ean b\u1ea3ng m\u00e0 kh\u00f4ng c\u00f3 ph\u1ea7n t\u1eed kh\u00f4ng.</p> <p>G\u1ecdi $N$ l\u00e0 s\u1ed1 l\u01b0\u1ee3ng ngh\u1ecbch \u0111\u1ea3o trong ho\u00e1n v\u1ecb n\u00e0y (t\u1ee9c l\u00e0 s\u1ed1 l\u01b0\u1ee3ng c\u00e1c ph\u1ea7n t\u1eed $a_i$ v\u00e0 $a_j$ sao cho $i &lt; j$, nh\u01b0ng $a_i  &gt; a_j$).</p> <p>Gi\u1ea3 s\u1eed $K$ l\u00e0 ch\u1ec9 s\u1ed1 c\u1ee7a h\u00e0ng n\u01a1i ph\u1ea7n t\u1eed tr\u1ed1ng to\u1ea1 l\u1ea1c (t\u1ee9c l\u00e0 s\u1eed d\u1ee5ng quy \u01b0\u1edbc c\u1ee7a ch\u00fang ta, $K = (z - 1) \\div \\ 4 + 1$).</p> <p>Khi \u0111\u00f3, l\u1eddi gi\u1ea3i t\u1ed3n t\u1ea1i khi v\u00e0 ch\u1ec9 khi $N + K$ l\u00e0 s\u1ed1 ch\u1eb5n.</p>","tags":["Translated"]},{"location":"others/15-puzzle.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>Thu\u1eadt to\u00e1n tr\u00ean c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c minh h\u1ecda b\u1eb1ng m\u00e3 ch\u01b0\u01a1ng tr\u00ecnh sau:</p> <pre><code>int a[16];\nfor (int i=0; i&lt;16; ++i)\n    cin &gt;&gt; a[i];\n\nint inv = 0;\nfor (int i=0; i&lt;16; ++i)\n    if (a[i])\n        for (int j=0; j&lt;i; ++j)\n            if (a[j] &gt; a[i])\n                ++inv;\nfor (int i=0; i&lt;16; ++i)\n    if (a[i] == 0)\n        inv += 1 + i / 4;\n\nputs ((inv &amp; 1) ? \"No Solution\" : \"Solution Exists\");\n</code></pre>","tags":["Translated"]},{"location":"others/15-puzzle.html#proof","title":"Ch\u1ee9ng minh (Proof)","text":"<p>N\u0103m 1879 Johnson \u0111\u00e3 ch\u1ee9ng minh r\u1eb1ng n\u1ebfu $N + K$ l\u00e0 l\u1ebb, th\u00ec l\u1eddi gi\u1ea3i kh\u00f4ng t\u1ed3n t\u1ea1i, v\u00e0 c\u00f9ng n\u0103m \u0111\u00f3 Story \u0111\u00e3 ch\u1ee9ng minh r\u1eb1ng t\u1ea5t c\u1ea3 c\u00e1c v\u1ecb tr\u00ed khi $N + K$ l\u00e0 ch\u1eb5n \u0111\u1ec1u c\u00f3 l\u1eddi gi\u1ea3i.</p> <p>Tuy nhi\u00ean, t\u1ea5t c\u1ea3 c\u00e1c ch\u1ee9ng minh n\u00e0y \u0111\u1ec1u kh\u00e1 ph\u1ee9c t\u1ea1p.</p> <p>N\u0103m 1999 Archer \u0111\u00e3 \u0111\u1ec1 xu\u1ea5t m\u1ed9t ch\u1ee9ng minh \u0111\u01a1n gi\u1ea3n h\u01a1n nhi\u1ec1u (b\u1ea1n c\u00f3 th\u1ec3 t\u1ea3i xu\u1ed1ng b\u00e0i vi\u1ebft c\u1ee7a \u00f4ng t\u1ea1i \u0111\u00e2y).</p>","tags":["Translated"]},{"location":"others/15-puzzle.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>Hackerrank - N-puzzle</li> </ul>","tags":["Translated"]},{"location":"others/15-puzzle.html#checklist","title":"Checklist","text":"<ul> <li>[x] D\u1ecbch c\u00e1c kh\u00e1i ni\u1ec7m k\u1ef9 thu\u1eadt sang ti\u1ebfng Vi\u1ec7t ch\u00ednh x\u00e1c.</li> <li>[x] \u0110\u00e3 c\u1eadp nh\u1eadt c\u00e1c li\u00ean k\u1ebft n\u1ed9i b\u1ed9 (\u0111\u1ebfn 127.0.0.1:8000).</li> <li>[x] \u0110\u1ecbnh d\u1ea1ng l\u1ea1i c\u00e1c c\u00f4ng th\u1ee9c to\u00e1n h\u1ecdc v\u00e0 code block.</li> <li>[x] Ki\u1ec3m tra ch\u00ednh t\u1ea3 v\u00e0 ng\u1eef ph\u00e1p.</li> <li>[x] \u0110\u1ea3m b\u1ea3o t\u00ednh nh\u1ea5t qu\u00e1n v\u1edbi c\u00e1c thu\u1eadt ng\u1eef \u0111\u00e3 d\u1ecbch kh\u00e1c.</li> </ul>","tags":["Translated"]},{"location":"others/josephus_problem.html","title":"B\u00e0i to\u00e1n Josephus (Josephus Problem)","text":"","tags":["Translated"]},{"location":"others/josephus_problem.html#statement","title":"\u0110\u1ec1 b\u00e0i (Statement)","text":"<p>Ch\u00fang ta \u0111\u01b0\u1ee3c cho c\u00e1c s\u1ed1 t\u1ef1 nhi\u00ean $n$ v\u00e0 $k$. T\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 t\u1ef1 nhi\u00ean t\u1eeb $1$ \u0111\u1ebfn $n$ \u0111\u01b0\u1ee3c vi\u1ebft theo m\u1ed9t v\u00f2ng tr\u00f2n.  \u0110\u1ea7u ti\u00ean, \u0111\u1ebfm s\u1ed1 th\u1ee9 $k$ b\u1eaft \u0111\u1ea7u t\u1eeb s\u1ed1 \u0111\u1ea7u ti\u00ean v\u00e0 x\u00f3a n\u00f3. Sau \u0111\u00f3 $k$ s\u1ed1 \u0111\u01b0\u1ee3c \u0111\u1ebfm b\u1eaft \u0111\u1ea7u t\u1eeb s\u1ed1 ti\u1ebfp theo v\u00e0 s\u1ed1 th\u1ee9 $k$ l\u1ea1i b\u1ecb lo\u1ea1i b\u1ecf, v.v. Qu\u00e1 tr\u00ecnh d\u1eebng l\u1ea1i khi c\u00f2n l\u1ea1i m\u1ed9t s\u1ed1. Y\u00eau c\u1ea7u t\u00ecm s\u1ed1 cu\u1ed1i c\u00f9ng.</p> <p>Nhi\u1ec7m v\u1ee5 n\u00e0y \u0111\u01b0\u1ee3c \u0111\u1eb7t ra b\u1edfi Flavius Josephus v\u00e0o th\u1ebf k\u1ef7 th\u1ee9 1 (m\u1eb7c d\u00f9 trong m\u1ed9t c\u00f4ng th\u1ee9c h\u1eb9p h\u01a1n m\u1ed9t ch\u00fat: \u0111\u1ed1i v\u1edbi $k = 2$).</p> <p>B\u00e0i to\u00e1n n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i quy\u1ebft b\u1eb1ng c\u00e1ch m\u00f4 h\u00ecnh h\u00f3a th\u1ee7 t\u1ee5c. M\u00f4 h\u00ecnh h\u00f3a Brute force s\u1ebd ho\u1ea1t \u0111\u1ed9ng $O(n^{2})$. S\u1eed d\u1ee5ng Segment Tree, ch\u00fang ta c\u00f3 th\u1ec3 c\u1ea3i thi\u1ec7n n\u00f3 l\u00ean $O(n \\log n)$. Tuy nhi\u00ean, ch\u00fang t\u00f4i mu\u1ed1n m\u1ed9t c\u00e1i g\u00ec \u0111\u00f3 t\u1ed1t h\u01a1n.</p>","tags":["Translated"]},{"location":"others/josephus_problem.html#modeling-a-o-n-solution","title":"M\u00f4 h\u00ecnh h\u00f3a gi\u1ea3i ph\u00e1p $O(n)$ (Modeling a $O(n)$ solution)","text":"<p>Ch\u00fang t\u00f4i s\u1ebd c\u1ed1 g\u1eafng t\u00ecm m\u1ed9t m\u1eabu bi\u1ec3u th\u1ecb c\u00e2u tr\u1ea3 l\u1eddi cho b\u00e0i to\u00e1n $J_{n, k}$ th\u00f4ng qua gi\u1ea3i ph\u00e1p c\u1ee7a c\u00e1c b\u00e0i to\u00e1n tr\u01b0\u1edbc \u0111\u00f3.</p> <p>S\u1eed d\u1ee5ng m\u00f4 h\u00ecnh h\u00f3a brute force, ch\u00fang ta c\u00f3 th\u1ec3 x\u00e2y d\u1ef1ng m\u1ed9t b\u1ea3ng gi\u00e1 tr\u1ecb, v\u00ed d\u1ee5, nh\u01b0 sau:</p> $$\\begin{array}{ccccccccccc} n\\setminus k &amp; 1 &amp; 2 &amp; 3 &amp; 4 &amp; 5 &amp; 6 &amp; 7 &amp; 8 &amp; 9 &amp; 10 \\\\ 1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 \\\\ 2 &amp; 2 &amp; 1 &amp; 2 &amp; 1 &amp; 2 &amp; 1 &amp; 2 &amp; 1 &amp; 2 &amp; 1 \\\\ 3 &amp; 3 &amp; 3 &amp; 2 &amp; 2 &amp; 1 &amp; 1 &amp; 3 &amp; 3 &amp; 2 &amp; 2 \\\\ 4 &amp; 4 &amp; 1 &amp; 1 &amp; 2 &amp; 2 &amp; 3 &amp; 2 &amp; 3 &amp; 3 &amp; 4 \\\\ 5 &amp; 5 &amp; 3 &amp; 4 &amp; 1 &amp; 2 &amp; 4 &amp; 4 &amp; 1 &amp; 2 &amp; 4 \\\\ 6 &amp; 6 &amp; 5 &amp; 1 &amp; 5 &amp; 1 &amp; 4 &amp; 5 &amp; 3 &amp; 5 &amp; 2 \\\\ 7 &amp; 7 &amp; 7 &amp; 4 &amp; 2 &amp; 6 &amp; 3 &amp; 5 &amp; 4 &amp; 7 &amp; 5 \\\\ 8 &amp; 8 &amp; 1 &amp; 7 &amp; 6 &amp; 3 &amp; 1 &amp; 4 &amp; 4 &amp; 8 &amp; 7 \\\\ 9 &amp; 9 &amp; 3 &amp; 1 &amp; 1 &amp; 8 &amp; 7 &amp; 2 &amp; 3 &amp; 8 &amp; 8 \\\\ 10 &amp; 10 &amp; 5 &amp; 4 &amp; 5 &amp; 3 &amp; 3 &amp; 9 &amp; 1 &amp; 7 &amp; 8 \\\\ \\end{array}$$ <p>V\u00e0 \u1edf \u0111\u00e2y ch\u00fang ta c\u00f3 th\u1ec3 th\u1ea5y r\u00f5 r\u00e0ng m\u1eabu sau:</p> $$J_{n,k} = \\left( (J_{n-1,k} + k - 1) \\bmod n \\right) + 1$$ $$J_{1,k} = 1$$ <p>\u1ede \u0111\u00e2y, ch\u1ec9 m\u1ee5c b\u1eaft \u0111\u1ea7u t\u1eeb 1 t\u1ea1o ra m\u1ed9t c\u00f4ng th\u1ee9c h\u01a1i l\u1ed9n x\u1ed9n; n\u1ebfu thay v\u00e0o \u0111\u00f3 b\u1ea1n \u0111\u00e1nh s\u1ed1 c\u00e1c v\u1ecb tr\u00ed t\u1eeb 0, b\u1ea1n s\u1ebd nh\u1eadn \u0111\u01b0\u1ee3c m\u1ed9t c\u00f4ng th\u1ee9c r\u1ea5t thanh l\u1ecbch:</p> $$J_{n,k} = (J_{n-1,k} + k) \\bmod n$$ <p>V\u00ec v\u1eady, ch\u00fang t\u00f4i \u0111\u00e3 t\u00ecm th\u1ea5y m\u1ed9t gi\u1ea3i ph\u00e1p cho b\u00e0i to\u00e1n Josephus, ho\u1ea1t \u0111\u1ed9ng trong $O(n)$ ph\u00e9p to\u00e1n.</p>","tags":["Translated"]},{"location":"others/josephus_problem.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>C\u00e0i \u0111\u1eb7t \u0111\u1ec7 quy \u0111\u01a1n gi\u1ea3n (trong ch\u1ec9 m\u1ee5c b\u1eaft \u0111\u1ea7u t\u1eeb 1)</p> <pre><code>int josephus(int n, int k) {\n    return n &gt; 1 ? (josephus(n-1, k) + k - 1) % n + 1 : 1;\n}\n</code></pre> <p>D\u1ea1ng kh\u00f4ng \u0111\u1ec7 quy :</p> <pre><code>int josephus(int n, int k) {\n    int res = 0;\n    for (int i = 1; i &lt;= n; ++i)\n      res = (res + k) % i;\n    return res + 1;\n}\n</code></pre> <p>C\u00f4ng th\u1ee9c n\u00e0y c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y b\u1eb1ng gi\u1ea3i t\u00edch. M\u1ed9t l\u1ea7n n\u1eefa \u1edf \u0111\u00e2y ch\u00fang ta gi\u1ea3 s\u1eed ch\u1ec9 m\u1ee5c b\u1eaft \u0111\u1ea7u t\u1eeb 0. Sau khi ch\u00fang t\u00f4i x\u00f3a s\u1ed1 \u0111\u1ea7u ti\u00ean, ch\u00fang t\u00f4i c\u00f2n l\u1ea1i $n-1$ s\u1ed1. Khi ch\u00fang t\u00f4i l\u1eb7p l\u1ea1i th\u1ee7 t\u1ee5c, ch\u00fang t\u00f4i s\u1ebd b\u1eaft \u0111\u1ea7u v\u1edbi s\u1ed1 ban \u0111\u1ea7u c\u00f3 ch\u1ec9 s\u1ed1 $k \\bmod n$. $J_{n-1, k}$ s\u1ebd l\u00e0 c\u00e2u tr\u1ea3 l\u1eddi cho v\u00f2ng tr\u00f2n c\u00f2n l\u1ea1i, n\u1ebfu ch\u00fang ta b\u1eaft \u0111\u1ea7u \u0111\u1ebfm t\u1ea1i $0$, nh\u01b0ng v\u00ec ch\u00fang ta th\u1ef1c s\u1ef1 b\u1eaft \u0111\u1ea7u v\u1edbi $k$ n\u00ean ch\u00fang ta c\u00f3 $J_{n, k} = (J_{n-1,k} + k) \\ \\bmod n$.</p>","tags":["Translated"]},{"location":"others/josephus_problem.html#modeling-a-o-k-log-n-solution","title":"M\u00f4 h\u00ecnh h\u00f3a gi\u1ea3i ph\u00e1p $O(k \\log n)$ (Modeling a $O(k \\log n)$ solution)","text":"<p>\u0110\u1ed1i v\u1edbi $k$ t\u01b0\u01a1ng \u0111\u1ed1i nh\u1ecf, ch\u00fang ta c\u00f3 th\u1ec3 \u0111\u01b0a ra gi\u1ea3i ph\u00e1p t\u1ed1t h\u01a1n gi\u1ea3i ph\u00e1p \u0111\u1ec7 quy \u1edf tr\u00ean trong $O(n)$. N\u1ebfu $k$ nh\u1ecf h\u01a1n nhi\u1ec1u so v\u1edbi $n$, th\u00ec ch\u00fang ta c\u00f3 th\u1ec3 x\u00f3a nhi\u1ec1u s\u1ed1 ($\\lfloor \\frac{n}{k} \\rfloor$) trong m\u1ed9t l\u1ea7n ch\u1ea1y m\u00e0 kh\u00f4ng c\u1ea7n l\u1eb7p l\u1ea1i. Sau \u0111\u00f3, ch\u00fang ta c\u00f2n l\u1ea1i $n - \\lfloor \\frac{n}{k} \\rfloor$ s\u1ed1, v\u00e0 ch\u00fang ta b\u1eaft \u0111\u1ea7u v\u1edbi s\u1ed1 th\u1ee9 $(\\lfloor \\frac{n}{k} \\rfloor \\cdot k)$. V\u00ec v\u1eady, ch\u00fang ta ph\u1ea3i d\u1ecbch chuy\u1ec3n t\u1eebng \u0111\u00f3. Ch\u00fang ta c\u00f3 th\u1ec3 nh\u1eadn th\u1ea5y r\u1eb1ng $\\lfloor \\frac{n}{k} \\rfloor \\cdot k$ ch\u1ec9 \u0111\u01a1n gi\u1ea3n l\u00e0 $-n \\bmod k$. V\u00e0 b\u1edfi v\u00ec ch\u00fang ta \u0111\u00e3 x\u00f3a m\u1ecdi s\u1ed1 th\u1ee9 $k$, ch\u00fang ta ph\u1ea3i th\u00eam s\u1ed1 l\u01b0\u1ee3ng c\u00e1c s\u1ed1 m\u00e0 ch\u00fang ta \u0111\u00e3 x\u00f3a tr\u01b0\u1edbc ch\u1ec9 m\u1ee5c k\u1ebft qu\u1ea3. C\u00e1i m\u00e0 ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh to\u00e1n b\u1eb1ng c\u00e1ch chia ch\u1ec9 m\u1ee5c k\u1ebft qu\u1ea3 cho $k - 1$.</p> <p>Ngo\u00e0i ra, ch\u00fang ta c\u1ea7n x\u1eed l\u00fd tr\u01b0\u1eddng h\u1ee3p khi $n$ tr\u1edf n\u00ean nh\u1ecf h\u01a1n $k$. Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, t\u1ed1i \u01b0u h\u00f3a \u1edf tr\u00ean s\u1ebd g\u00e2y ra m\u1ed9t v\u00f2ng l\u1eb7p v\u00f4 h\u1ea1n.</p> <p>C\u00e0i \u0111\u1eb7t (\u0111\u1ec3 thu\u1eadn ti\u1ec7n trong ch\u1ec9 m\u1ee5c b\u1eaft \u0111\u1ea7u t\u1eeb 0):</p> <pre><code>int josephus(int n, int k) {\n    if (n == 1)\n        return 0;\n    if (k == 1)\n        return n-1;\n    if (k &gt; n)\n        return (josephus(n-1, k) + k) % n;\n    int cnt = n / k;\n    int res = josephus(n - cnt, k);\n    res -= n % k;\n    if (res &lt; 0)\n        res += n;\n    else\n        res += res / (k - 1);\n    return res;\n}\n</code></pre> <p>H\u00e3y \u01b0\u1edbc t\u00ednh \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a thu\u1eadt to\u00e1n n\u00e0y. L\u01b0u \u00fd ngay r\u1eb1ng tr\u01b0\u1eddng h\u1ee3p $n &lt; k$ \u0111\u01b0\u1ee3c ph\u00e2n t\u00edch b\u1eb1ng gi\u1ea3i ph\u00e1p c\u0169, s\u1ebd ho\u1ea1t \u0111\u1ed9ng trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y cho $O(k)$. B\u00e2y gi\u1edd h\u00e3y xem x\u00e9t ch\u00ednh thu\u1eadt to\u00e1n. Tr\u00ean th\u1ef1c t\u1ebf, sau m\u1ed7i l\u1ea7n l\u1eb7p, thay v\u00ec $n$ s\u1ed1, ch\u00fang ta c\u00f2n l\u1ea1i $n \\left( 1 - \\frac{1}{k} \\right)$ s\u1ed1, v\u00ec v\u1eady t\u1ed5ng s\u1ed1 l\u1ea7n l\u1eb7p $x$ c\u1ee7a thu\u1eadt to\u00e1n c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y g\u1ea7n \u0111\u00fang t\u1eeb ph\u01b0\u01a1ng tr\u00ecnh sau:</p> $$ n \\left(1 - \\frac{1}{k} \\right) ^ x = 1, $$ <p>l\u1ea5y logarit \u1edf c\u1ea3 hai v\u1ebf, ch\u00fang ta thu \u0111\u01b0\u1ee3c:</p> $$\\ln n + x \\ln \\left(1 - \\frac{1}{k} \\right) = 0,$$  $$x = - \\frac{\\ln n}{\\ln \\left(1 - \\frac{1}{k} \\right)},$$ <p>s\u1eed d\u1ee5ng khai tri\u1ec3n c\u1ee7a logarit th\u00e0nh chu\u1ed7i Taylor, ch\u00fang ta thu \u0111\u01b0\u1ee3c \u01b0\u1edbc t\u00ednh g\u1ea7n \u0111\u00fang:</p> $$x \\approx k \\ln n$$ <p>Do \u0111\u00f3, \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a thu\u1eadt to\u00e1n th\u1ef1c s\u1ef1 l\u00e0 $O (k \\log n)$.</p>","tags":["Translated"]},{"location":"others/josephus_problem.html#analytical-solution-for-k-2","title":"Gi\u1ea3i ph\u00e1p gi\u1ea3i t\u00edch cho $k = 2$ (Analytical solution for $k = 2$)","text":"<p>Trong tr\u01b0\u1eddng h\u1ee3p c\u1ee5 th\u1ec3 n\u00e0y (trong \u0111\u00f3 nhi\u1ec7m v\u1ee5 n\u00e0y \u0111\u01b0\u1ee3c \u0111\u1eb7t ra b\u1edfi Josephus Flavius), v\u1ea5n \u0111\u1ec1 \u0111\u01b0\u1ee3c gi\u1ea3i quy\u1ebft d\u1ec5 d\u00e0ng h\u01a1n nhi\u1ec1u.</p> <p>Trong tr\u01b0\u1eddng h\u1ee3p $n$ ch\u1eb5n, ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c r\u1eb1ng t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 ch\u1eb5n s\u1ebd b\u1ecb g\u1ea1ch b\u1ecf, v\u00e0 sau \u0111\u00f3 s\u1ebd c\u00f2n l\u1ea1i m\u1ed9t v\u1ea5n \u0111\u1ec1 cho $\\frac{n}{2}$, sau \u0111\u00f3 c\u00e2u tr\u1ea3 l\u1eddi cho $n$ s\u1ebd thu \u0111\u01b0\u1ee3c t\u1eeb c\u00e2u tr\u1ea3 l\u1eddi cho $\\frac{n}{2}$ b\u1eb1ng c\u00e1ch nh\u00e2n v\u1edbi hai v\u00e0 tr\u1eeb \u0111i m\u1ed9t (b\u1eb1ng c\u00e1ch d\u1ecbch chuy\u1ec3n v\u1ecb tr\u00ed):</p> $$ J_{2n, 2} = 2 J_{n, 2} - 1 $$ <p>T\u01b0\u01a1ng t\u1ef1, trong tr\u01b0\u1eddng h\u1ee3p $n$ l\u1ebb, t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 ch\u1eb5n s\u1ebd b\u1ecb g\u1ea1ch b\u1ecf, sau \u0111\u00f3 l\u00e0 s\u1ed1 \u0111\u1ea7u ti\u00ean, v\u00e0 v\u1ea5n \u0111\u1ec1 cho $\\frac{n-1}{2}$ s\u1ebd v\u1eabn c\u00f2n, v\u00e0 t\u00ednh \u0111\u1ebfn s\u1ef1 d\u1ecbch chuy\u1ec3n v\u1ecb tr\u00ed, ch\u00fang ta thu \u0111\u01b0\u1ee3c c\u00f4ng th\u1ee9c th\u1ee9 hai:</p> $$J_{2n+1,2} = 2 J_{n, 2} + 1 $$ <p>Ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng ph\u1ee5 thu\u1ed9c h\u1ed3i quy n\u00e0y tr\u1ef1c ti\u1ebfp trong qu\u00e1 tr\u00ecnh tri\u1ec3n khai c\u1ee7a m\u00ecnh. M\u1eabu n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c d\u1ecbch sang m\u1ed9t d\u1ea1ng kh\u00e1c: $J_{n, 2}$ \u0111\u1ea1i di\u1ec7n cho m\u1ed9t chu\u1ed7i t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 l\u1ebb, \"kh\u1edfi \u0111\u1ed9ng l\u1ea1i\" t\u1eeb m\u1ed9t b\u1ea5t c\u1ee9 khi n\u00e0o $n$ tr\u1edf th\u00e0nh l\u0169y th\u1eeba c\u1ee7a hai. \u0110i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c vi\u1ebft d\u01b0\u1edbi d\u1ea1ng m\u1ed9t c\u00f4ng th\u1ee9c duy nh\u1ea5t:</p> $$J_{n, 2} = 1 + 2 \\left(n-2^{\\lfloor \\log_2 n \\rfloor} \\right)$$","tags":["Translated"]},{"location":"others/josephus_problem.html#analytical-solution-for-k-2_1","title":"Gi\u1ea3i ph\u00e1p gi\u1ea3i t\u00edch cho $k &gt; 2$ (Analytical solution for $k &gt; 2$)","text":"<p>M\u1eb7c d\u00f9 d\u1ea1ng b\u00e0i to\u00e1n \u0111\u01a1n gi\u1ea3n v\u00e0 c\u00f3 m\u1ed9t s\u1ed1 l\u01b0\u1ee3ng l\u1edbn c\u00e1c b\u00e0i b\u00e1o v\u1ec1 v\u1ea5n \u0111\u1ec1 n\u00e0y v\u00e0 c\u00e1c v\u1ea5n \u0111\u1ec1 li\u00ean quan, nh\u01b0ng cho \u0111\u1ebfn nay v\u1eabn ch\u01b0a t\u00ecm th\u1ea5y m\u1ed9t bi\u1ec3u di\u1ec5n gi\u1ea3i t\u00edch \u0111\u01a1n gi\u1ea3n n\u00e0o cho gi\u1ea3i ph\u00e1p c\u1ee7a b\u00e0i to\u00e1n Josephus. \u0110\u1ed1i v\u1edbi $k$ nh\u1ecf, m\u1ed9t s\u1ed1 c\u00f4ng th\u1ee9c \u0111\u01b0\u1ee3c \u0111\u01b0a ra, nh\u01b0ng d\u01b0\u1eddng nh\u01b0 t\u1ea5t c\u1ea3 ch\u00fang \u0111\u1ec1u kh\u00f3 \u00e1p d\u1ee5ng trong th\u1ef1c t\u1ebf (v\u00ed d\u1ee5, xem Halbeisen, Hungerbuhler \"The Josephus Problem\" v\u00e0 Odlyzko, Wilf \"Functional iteration and the Josephus problem\").</p>","tags":["Translated"]},{"location":"others/josephus_problem.html#checklist","title":"Checklist","text":"<ul> <li>[x] D\u1ecbch c\u00e1c kh\u00e1i ni\u1ec7m k\u1ef9 thu\u1eadt sang ti\u1ebfng Vi\u1ec7t ch\u00ednh x\u00e1c.</li> <li>[x] \u0110\u00e3 c\u1eadp nh\u1eadt c\u00e1c li\u00ean k\u1ebft n\u1ed9i b\u1ed9 (\u0111\u1ebfn 127.0.0.1:8000).</li> <li>[x] \u0110\u1ecbnh d\u1ea1ng l\u1ea1i c\u00e1c c\u00f4ng th\u1ee9c to\u00e1n h\u1ecdc v\u00e0 code block.</li> <li>[x] Ki\u1ec3m tra ch\u00ednh t\u1ea3 v\u00e0 ng\u1eef ph\u00e1p.</li> <li>[x] \u0110\u1ea3m b\u1ea3o t\u00ednh nh\u1ea5t qu\u00e1n v\u1edbi c\u00e1c thu\u1eadt ng\u1eef \u0111\u00e3 d\u1ecbch kh\u00e1c.</li> </ul>","tags":["Translated"]},{"location":"others/maximum_average_segment.html","title":"T\u00ecm d\u00e3y con c\u00f3 t\u1ed5ng l\u1edbn nh\u1ea5t/nh\u1ecf nh\u1ea5t (Search the subarray with the maximum/minimum sum)","text":"<p>\u1ede \u0111\u00e2y, ch\u00fang t\u00f4i xem x\u00e9t b\u00e0i to\u00e1n t\u00ecm m\u1ed9t d\u00e3y con (m\u1ea3ng con) c\u00f3 t\u1ed5ng l\u1edbn nh\u1ea5t, c\u0169ng nh\u01b0 m\u1ed9t s\u1ed1 bi\u1ebfn th\u1ec3 c\u1ee7a n\u00f3 (bao g\u1ed3m thu\u1eadt to\u00e1n gi\u1ea3i b\u00e0i to\u00e1n n\u00e0y tr\u1ef1c tuy\u1ebfn - online).</p>","tags":["Translated"]},{"location":"others/maximum_average_segment.html#problem-statement","title":"\u0110\u1ec1 b\u00e0i (Problem statement)","text":"<p>Cho m\u1ed9t m\u1ea3ng c\u00e1c s\u1ed1 $a[1 \\ldots n]$. Y\u00eau c\u1ea7u t\u00ecm m\u1ed9t d\u00e3y con $a[l \\ldots r]$ c\u00f3 t\u1ed5ng c\u1ef1c \u0111\u1ea1i:</p> $$ \\max_{ 1 \\le l \\le r \\le n } \\sum_{i=l}^{r} a[i].$$ <p>V\u00ed d\u1ee5, n\u1ebfu t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 nguy\u00ean trong m\u1ea3ng $a[]$ kh\u00f4ng \u00e2m, th\u00ec c\u00e2u tr\u1ea3 l\u1eddi s\u1ebd l\u00e0 ch\u00ednh m\u1ea3ng \u0111\u00f3. Tuy nhi\u00ean, l\u1eddi gi\u1ea3i kh\u00f4ng t\u1ea7m th\u01b0\u1eddng khi m\u1ea3ng c\u00f3 th\u1ec3 ch\u1ee9a c\u1ea3 s\u1ed1 d\u01b0\u01a1ng v\u00e0 s\u1ed1 \u00e2m.</p> <p>R\u00f5 r\u00e0ng l\u00e0 b\u00e0i to\u00e1n t\u00ecm d\u00e3y con nh\u1ecf nh\u1ea5t v\u1ec1 c\u01a1 b\u1ea3n l\u00e0 gi\u1ed1ng nhau, b\u1ea1n ch\u1ec9 c\u1ea7n \u0111\u1ed5i d\u1ea5u c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1.</p>","tags":["Translated"]},{"location":"others/maximum_average_segment.html#algorithm-1","title":"Thu\u1eadt to\u00e1n 1 (Algorithm 1)","text":"<p>\u1ede \u0111\u00e2y ch\u00fang t\u00f4i xem x\u00e9t m\u1ed9t thu\u1eadt to\u00e1n g\u1ea7n nh\u01b0 hi\u1ec3n nhi\u00ean. (Ti\u1ebfp theo, ch\u00fang ta s\u1ebd xem x\u00e9t m\u1ed9t thu\u1eadt to\u00e1n kh\u00e1c, kh\u00f3 ngh\u0129 ra h\u01a1n m\u1ed9t ch\u00fat, nh\u01b0ng c\u00e1ch c\u00e0i \u0111\u1eb7t c\u1ee7a n\u00f3 th\u1eadm ch\u00ed c\u00f2n ng\u1eafn h\u01a1n.)</p>","tags":["Translated"]},{"location":"others/maximum_average_segment.html#algorithm-description","title":"M\u00f4 t\u1ea3 thu\u1eadt to\u00e1n (Algorithm description)","text":"<p>Thu\u1eadt to\u00e1n r\u1ea5t \u0111\u01a1n gi\u1ea3n.</p> <p>Ch\u00fang t\u00f4i gi\u1edbi thi\u1ec7u cho thu\u1eadn ti\u1ec7n k\u00fd hi\u1ec7u: $s[i] = \\sum_{j=1}^{i} a[j]$. T\u1ee9c l\u00e0, m\u1ea3ng $s[i]$ l\u00e0 m\u1ed9t m\u1ea3ng c\u00e1c t\u1ed5ng m\u1ed9t ph\u1ea7n c\u1ee7a m\u1ea3ng $a[]$. Ngo\u00e0i ra, \u0111\u1eb7t $s[0] = 0$.</p> <p>B\u00e2y gi\u1edd ch\u00fang ta h\u00e3y l\u1eb7p l\u1ea1i ch\u1ec9 s\u1ed1 $r = 1 \\ldots n$, v\u00e0 t\u00ecm hi\u1ec3u c\u00e1ch nhanh ch\u00f3ng t\u00ecm $l$ t\u1ed1i \u01b0u cho m\u1ed7i gi\u00e1 tr\u1ecb $r$ hi\u1ec7n t\u1ea1i, t\u1ea1i \u0111\u00f3 t\u1ed5ng c\u1ef1c \u0111\u1ea1i \u0111\u1ea1t \u0111\u01b0\u1ee3c tr\u00ean d\u00e3y con $[l, r]$.</p> <p>V\u1ec1 m\u1eb7t h\u00ecnh th\u1ee9c, \u0111i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 \u0111\u1ed1i v\u1edbi $r$ hi\u1ec7n t\u1ea1i, ch\u00fang ta c\u1ea7n t\u00ecm m\u1ed9t $l$ (kh\u00f4ng v\u01b0\u1ee3t qu\u00e1 $r$), sao cho gi\u00e1 tr\u1ecb c\u1ee7a $s[r] - s[l-1]$ l\u00e0 c\u1ef1c \u0111\u1ea1i. Sau m\u1ed9t ph\u00e9p bi\u1ebfn \u0111\u1ed5i t\u1ea7m th\u01b0\u1eddng, ch\u00fang ta c\u00f3 th\u1ec3 th\u1ea5y r\u1eb1ng ch\u00fang ta c\u1ea7n t\u00ecm trong m\u1ea3ng $s[]$ m\u1ed9t gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t tr\u00ean \u0111o\u1ea1n $[0, r-1]$.</p> <p>T\u1eeb \u0111\u00e2y, ch\u00fang ta ngay l\u1eadp t\u1ee9c c\u00f3 \u0111\u01b0\u1ee3c m\u1ed9t gi\u1ea3i ph\u00e1p: ch\u00fang ta ch\u1ec9 c\u1ea7n l\u01b0u tr\u1eef v\u1ecb tr\u00ed t\u1ed1i thi\u1ec3u hi\u1ec7n t\u1ea1i trong m\u1ea3ng $s[]$. S\u1eed d\u1ee5ng gi\u00e1 tr\u1ecb t\u1ed1i thi\u1ec3u n\u00e0y, ch\u00fang ta t\u00ecm th\u1ea5y ch\u1ec9 s\u1ed1 t\u1ed1i \u01b0u hi\u1ec7n t\u1ea1i $l$ trong $O(1)$, v\u00e0 khi chuy\u1ec3n t\u1eeb ch\u1ec9 s\u1ed1 hi\u1ec7n t\u1ea1i $r$ sang ch\u1ec9 s\u1ed1 ti\u1ebfp theo, ch\u00fang ta ch\u1ec9 c\u1ea7n c\u1eadp nh\u1eadt gi\u00e1 tr\u1ecb t\u1ed1i thi\u1ec3u n\u00e0y.</p> <p>R\u00f5 r\u00e0ng, thu\u1eadt to\u00e1n n\u00e0y ho\u1ea1t \u0111\u1ed9ng trong $O(n)$ v\u00e0 l\u00e0 t\u1ed1i \u01b0u ti\u1ec7m c\u1eadn.</p>","tags":["Translated"]},{"location":"others/maximum_average_segment.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>\u0110\u1ec3 c\u00e0i \u0111\u1eb7t n\u00f3, ch\u00fang ta th\u1eadm ch\u00ed kh\u00f4ng c\u1ea7n l\u01b0u tr\u1eef r\u00f5 r\u00e0ng m\u1ed9t m\u1ea3ng c\u00e1c t\u1ed5ng m\u1ed9t ph\u1ea7n $s[]$ \u2014 ch\u00fang ta s\u1ebd ch\u1ec9 c\u1ea7n ph\u1ea7n t\u1eed hi\u1ec7n t\u1ea1i t\u1eeb n\u00f3.</p> <p>Vi\u1ec7c c\u00e0i \u0111\u1eb7t \u0111\u01b0\u1ee3c \u0111\u01b0a ra trong c\u00e1c m\u1ea3ng \u0111\u00e1nh ch\u1ec9 s\u1ed1 t\u1eeb 0, kh\u00f4ng ph\u1ea3i trong \u0111\u00e1nh s\u1ed1 t\u1eeb 1 nh\u01b0 \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 \u1edf tr\u00ean.</p> <p>\u0110\u1ea7u ti\u00ean ch\u00fang t\u00f4i \u0111\u01b0a ra m\u1ed9t gi\u1ea3i ph\u00e1p t\u00ecm c\u00e2u tr\u1ea3 l\u1eddi s\u1ed1 \u0111\u01a1n gi\u1ea3n m\u00e0 kh\u00f4ng t\u00ecm th\u1ea5y c\u00e1c ch\u1ec9 s\u1ed1 c\u1ee7a \u0111o\u1ea1n mong mu\u1ed1n:</p> <pre><code>int ans = a[0], sum = 0, min_sum = 0;\n\nfor (int r = 0; r &lt; n; ++r) {\n    sum += a[r];\n    ans = max(ans, sum - min_sum);\n    min_sum = min(min_sum, sum);\n}\n</code></pre> <p>B\u00e2y gi\u1edd ch\u00fang t\u00f4i \u0111\u01b0a ra m\u1ed9t phi\u00ean b\u1ea3n \u0111\u1ea7y \u0111\u1ee7 c\u1ee7a gi\u1ea3i ph\u00e1p, trong \u0111\u00f3 c\u0169ng t\u00ecm th\u1ea5y ranh gi\u1edbi c\u1ee7a \u0111o\u1ea1n mong mu\u1ed1n:</p> <pre><code>int ans = a[0], ans_l = 0, ans_r = 0;\nint sum = 0, min_sum = 0, min_pos = -1;\n\nfor (int r = 0; r &lt; n; ++r) {\n    sum += a[r];\n    int cur = sum - min_sum;\n    if (cur &gt; ans) {\n        ans = cur;\n        ans_l = min_pos + 1;\n        ans_r = r;\n    }\n    if (sum &lt; min_sum) {\n        min_sum = sum;\n        min_pos = r;\n    }\n}\n</code></pre>","tags":["Translated"]},{"location":"others/maximum_average_segment.html#algorithm-2","title":"Thu\u1eadt to\u00e1n 2 (Algorithm 2)","text":"<p>\u1ede \u0111\u00e2y ch\u00fang t\u00f4i xem x\u00e9t m\u1ed9t thu\u1eadt to\u00e1n kh\u00e1c. N\u00f3 kh\u00f3 hi\u1ec3u h\u01a1n m\u1ed9t ch\u00fat, nh\u01b0ng n\u00f3 thanh l\u1ecbch h\u01a1n \u1edf tr\u00ean, v\u00e0 vi\u1ec7c c\u00e0i \u0111\u1eb7t c\u1ee7a n\u00f3 ng\u1eafn h\u01a1n m\u1ed9t ch\u00fat. Thu\u1eadt to\u00e1n n\u00e0y \u0111\u01b0\u1ee3c \u0111\u1ec1 xu\u1ea5t b\u1edfi Jay Kadane v\u00e0o n\u0103m 1984.</p>","tags":["Translated"]},{"location":"others/maximum_average_segment.html#algorithm-description-1","title":"M\u00f4 t\u1ea3 thu\u1eadt to\u00e1n (Algorithm description)","text":"<p>B\u1ea3n th\u00e2n thu\u1eadt to\u00e1n nh\u01b0 sau. H\u00e3y \u0111i qua m\u1ea3ng v\u00e0 t\u00edch l\u0169y t\u1ed5ng m\u1ed9t ph\u1ea7n hi\u1ec7n t\u1ea1i trong m\u1ed9t s\u1ed1 bi\u1ebfn $s$. N\u1ebfu t\u1ea1i m\u1ed9t th\u1eddi \u0111i\u1ec3m n\u00e0o \u0111\u00f3 $s$ \u00e2m, ch\u00fang ta ch\u1ec9 c\u1ea7n g\u00e1n $s=0$. Ng\u01b0\u1eddi ta l\u1eadp lu\u1eadn r\u1eb1ng gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t trong t\u1ea5t c\u1ea3 c\u00e1c gi\u00e1 tr\u1ecb m\u00e0 bi\u1ebfn $s$ \u0111\u01b0\u1ee3c g\u00e1n trong thu\u1eadt to\u00e1n s\u1ebd l\u00e0 c\u00e2u tr\u1ea3 l\u1eddi cho b\u00e0i to\u00e1n.</p> <p>Ch\u1ee9ng minh:</p> <p>Xem x\u00e9t ch\u1ec9 s\u1ed1 \u0111\u1ea7u ti\u00ean khi t\u1ed5ng c\u1ee7a $s$ tr\u1edf th\u00e0nh \u00e2m. \u0110i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 b\u1eaft \u0111\u1ea7u v\u1edbi t\u1ed5ng m\u1ed9t ph\u1ea7n b\u1eb1ng kh\u00f4ng, cu\u1ed1i c\u00f9ng ch\u00fang ta thu \u0111\u01b0\u1ee3c t\u1ed5ng m\u1ed9t ph\u1ea7n \u00e2m \u2014 v\u00ec v\u1eady to\u00e0n b\u1ed9 ti\u1ec1n t\u1ed1 n\u00e0y c\u1ee7a m\u1ea3ng, c\u0169ng nh\u01b0 b\u1ea5t k\u1ef3 h\u1eadu t\u1ed1 n\u00e0o, \u0111\u1ec1u c\u00f3 t\u1ed5ng \u00e2m. Do \u0111\u00f3, d\u00e3y con n\u00e0y kh\u00f4ng bao gi\u1edd \u0111\u00f3ng g\u00f3p v\u00e0o t\u1ed5ng m\u1ed9t ph\u1ea7n c\u1ee7a b\u1ea5t k\u1ef3 d\u00e3y con n\u00e0o m\u00e0 n\u00f3 l\u00e0 ti\u1ec1n t\u1ed1, v\u00e0 c\u00f3 th\u1ec3 \u0111\u01a1n gi\u1ea3n b\u1ecb lo\u1ea1i b\u1ecf.</p> <p>Tuy nhi\u00ean, \u0111i\u1ec1u n\u00e0y kh\u00f4ng \u0111\u1ee7 \u0111\u1ec3 ch\u1ee9ng minh thu\u1eadt to\u00e1n. Trong thu\u1eadt to\u00e1n, ch\u00fang ta th\u1ef1c s\u1ef1 b\u1ecb gi\u1edbi h\u1ea1n trong vi\u1ec7c t\u00ecm c\u00e2u tr\u1ea3 l\u1eddi ch\u1ec9 cho c\u00e1c ph\u00e2n \u0111o\u1ea1n b\u1eaft \u0111\u1ea7u ngay sau nh\u1eefng n\u01a1i khi $s&lt;0$ x\u1ea3y ra.</p> <p>Nh\u01b0ng, tr\u00ean th\u1ef1c t\u1ebf, xem x\u00e9t m\u1ed9t ph\u00e2n \u0111o\u1ea1n t\u00f9y \u00fd $[l, r]$, v\u00e0 $l$ kh\u00f4ng \u1edf v\u1ecb tr\u00ed \"quan tr\u1ecdng\" nh\u01b0 v\u1eady (t\u1ee9c l\u00e0 $l &gt; p+1$, trong \u0111\u00f3 $p$ l\u00e0 v\u1ecb tr\u00ed cu\u1ed1i c\u00f9ng nh\u01b0 v\u1eady, trong \u0111\u00f3 $s&lt;0$). V\u00ec v\u1ecb tr\u00ed quan tr\u1ecdng cu\u1ed1i c\u00f9ng ho\u00e0n to\u00e0n s\u1edbm h\u01a1n $l-1$, h\u00f3a ra t\u1ed5ng c\u1ee7a $a[p+1 \\ldots l-1]$ l\u00e0 kh\u00f4ng \u00e2m. \u0110i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 b\u1eb1ng c\u00e1ch di chuy\u1ec3n $l$ \u0111\u1ebfn v\u1ecb tr\u00ed $p+1$, ch\u00fang ta s\u1ebd t\u0103ng c\u00e2u tr\u1ea3 l\u1eddi ho\u1eb7c, trong tr\u01b0\u1eddng h\u1ee3p c\u1ef1c \u0111oan, ch\u00fang ta s\u1ebd kh\u00f4ng thay \u0111\u1ed5i n\u00f3.</p> <p>B\u1eb1ng c\u00e1ch n\u00e0y hay c\u00e1ch kh\u00e1c, h\u00f3a ra khi t\u00ecm ki\u1ebfm c\u00e2u tr\u1ea3 l\u1eddi, b\u1ea1n c\u00f3 th\u1ec3 t\u1ef1 gi\u1edbi h\u1ea1n m\u00ecnh ch\u1ec9 trong c\u00e1c ph\u00e2n \u0111o\u1ea1n b\u1eaft \u0111\u1ea7u ngay sau c\u00e1c v\u1ecb tr\u00ed m\u00e0 $s&lt;0$ xu\u1ea5t hi\u1ec7n. \u0110i\u1ec1u n\u00e0y ch\u1ee9ng minh r\u1eb1ng thu\u1eadt to\u00e1n l\u00e0 ch\u00ednh x\u00e1c.</p>","tags":["Translated"]},{"location":"others/maximum_average_segment.html#implementation-1","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>Gi\u1ed1ng nh\u01b0 trong thu\u1eadt to\u00e1n 1, ban \u0111\u1ea7u ch\u00fang t\u00f4i \u0111\u01b0a ra m\u1ed9t tri\u1ec3n khai \u0111\u01a1n gi\u1ea3n ch\u1ec9 t\u00ecm ki\u1ebfm c\u00e2u tr\u1ea3 l\u1eddi s\u1ed1 m\u00e0 kh\u00f4ng t\u00ecm th\u1ea5y ranh gi\u1edbi c\u1ee7a ph\u00e2n \u0111o\u1ea1n mong mu\u1ed1n:</p> <pre><code>int ans = a[0], sum = 0;\n\nfor (int r = 0; r &lt; n; ++r) {\n    sum += a[r];\n    ans = max(ans, sum);\n    sum = max(sum, 0);\n}\n</code></pre> <p>M\u1ed9t gi\u1ea3i ph\u00e1p ho\u00e0n ch\u1ec9nh, duy tr\u00ec c\u00e1c ch\u1ec9 s\u1ed1 c\u1ee7a ranh gi\u1edbi c\u1ee7a ph\u00e2n \u0111o\u1ea1n t\u01b0\u01a1ng \u1ee9ng:</p> <pre><code>int ans = a[0], ans_l = 0, ans_r = 0;\nint sum = 0, minus_pos = -1;\n\nfor (int r = 0; r &lt; n; ++r) {\n    sum += a[r];\n    if (sum &gt; ans) {\n        ans = sum;\n        ans_l = minus_pos + 1;\n        ans_r = r;\n    }\n    if (sum &lt; 0) {\n        sum = 0;\n        minus_pos = r;\n    }\n}\n</code></pre>","tags":["Translated"]},{"location":"others/maximum_average_segment.html#related-tasks","title":"C\u00e1c b\u00e0i to\u00e1n li\u00ean quan (Related tasks)","text":"","tags":["Translated"]},{"location":"others/maximum_average_segment.html#finding-the-maximum-minimum-subarray-with-constraints","title":"T\u00ecm d\u00e3y con l\u1edbn nh\u1ea5t/nh\u1ecf nh\u1ea5t c\u00f3 r\u00e0ng bu\u1ed9c (Finding the maximum/minimum subarray with constraints)","text":"<p>N\u1ebfu \u0111i\u1ec1u ki\u1ec7n b\u00e0i to\u00e1n \u00e1p \u0111\u1eb7t c\u00e1c h\u1ea1n ch\u1ebf b\u1ed5 sung cho ph\u00e2n \u0111o\u1ea1n $[l, r]$ \u0111\u01b0\u1ee3c y\u00eau c\u1ea7u (v\u00ed d\u1ee5, \u0111\u1ed9 d\u00e0i $r-l+1$ c\u1ee7a ph\u00e2n \u0111o\u1ea1n ph\u1ea3i n\u1eb1m trong gi\u1edbi h\u1ea1n \u0111\u00e3 ch\u1ec9 \u0111\u1ecbnh), th\u00ec thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 c\u00f3 kh\u1ea3 n\u0103ng d\u1ec5 d\u00e0ng kh\u00e1i qu\u00e1t h\u00f3a cho c\u00e1c tr\u01b0\u1eddng h\u1ee3p n\u00e0y \u2014 d\u00f9 sao, b\u00e0i to\u00e1n v\u1eabn s\u1ebd l\u00e0 t\u00ecm gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t trong m\u1ea3ng $s[]$ v\u1edbi c\u00e1c h\u1ea1n ch\u1ebf b\u1ed5 sung \u0111\u01b0\u1ee3c ch\u1ec9 \u0111\u1ecbnh.</p>","tags":["Translated"]},{"location":"others/maximum_average_segment.html#two-dimensional-case-of-the-problem","title":"Tr\u01b0\u1eddng h\u1ee3p hai chi\u1ec1u c\u1ee7a b\u00e0i to\u00e1n: t\u00ecm ki\u1ebfm ma tr\u1eadn con l\u1edbn nh\u1ea5t/nh\u1ecf nh\u1ea5t (Two-dimensional case of the problem: search for maximum/minimum submatrix)","text":"<p>B\u00e0i to\u00e1n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 trong b\u00e0i vi\u1ebft n\u00e0y \u0111\u01b0\u1ee3c kh\u00e1i qu\u00e1t h\u00f3a m\u1ed9t c\u00e1ch t\u1ef1 nhi\u00ean cho c\u00e1c k\u00edch th\u01b0\u1edbc l\u1edbn. V\u00ed d\u1ee5, trong tr\u01b0\u1eddng h\u1ee3p hai chi\u1ec1u, n\u00f3 bi\u1ebfn th\u00e0nh t\u00ecm ki\u1ebfm ma tr\u1eadn con $[l_1 \\ldots r_1, l_2 \\ldots r_2]$ c\u1ee7a m\u1ed9t ma tr\u1eadn \u0111\u00e3 cho, c\u00f3 t\u1ed5ng c\u00e1c s\u1ed1 trong \u0111\u00f3 l\u00e0 l\u1edbn nh\u1ea5t.</p> <p>S\u1eed d\u1ee5ng gi\u1ea3i ph\u00e1p cho tr\u01b0\u1eddng h\u1ee3p m\u1ed9t chi\u1ec1u, r\u1ea5t d\u1ec5 d\u00e0ng \u0111\u1ec3 c\u00f3 \u0111\u01b0\u1ee3c gi\u1ea3i ph\u00e1p trong $O(n^3)$ cho tr\u01b0\u1eddng h\u1ee3p hai chi\u1ec1u: ch\u00fang ta l\u1eb7p qua t\u1ea5t c\u1ea3 c\u00e1c gi\u00e1 tr\u1ecb c\u00f3 th\u1ec3 c\u00f3 c\u1ee7a $l_1$ v\u00e0 $r_1$, v\u00e0 t\u00ednh t\u1ed5ng t\u1eeb $l_1$ \u0111\u1ebfn $r_1$ trong m\u1ed7i h\u00e0ng c\u1ee7a ma tr\u1eadn. B\u00e2y gi\u1edd ch\u00fang ta c\u00f3 b\u00e0i to\u00e1n m\u1ed9t chi\u1ec1u t\u00ecm c\u00e1c ch\u1ec9 s\u1ed1 $l_2$ v\u00e0 $r_2$ trong m\u1ea3ng n\u00e0y, v\u1ed1n \u0111\u00e3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i quy\u1ebft trong th\u1eddi gian tuy\u1ebfn t\u00ednh.</p> <p>C\u00e1c thu\u1eadt to\u00e1n nhanh h\u01a1n \u0111\u1ec3 gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 n\u00e0y \u0111\u00e3 \u0111\u01b0\u1ee3c bi\u1ebft \u0111\u1ebfn, nh\u01b0ng ch\u00fang kh\u00f4ng nhanh h\u01a1n nhi\u1ec1u so v\u1edbi $O(n^3)$, v\u00e0 r\u1ea5t ph\u1ee9c t\u1ea1p (ph\u1ee9c t\u1ea1p \u0111\u1ebfn m\u1ee9c nhi\u1ec1u trong s\u1ed1 ch\u00fang k\u00e9m h\u01a1n thu\u1eadt to\u00e1n t\u1ea7m th\u01b0\u1eddng \u0111\u1ed1i v\u1edbi t\u1ea5t c\u1ea3 c\u00e1c r\u00e0ng bu\u1ed9c h\u1ee3p l\u00fd b\u1edfi h\u1eb1ng s\u1ed1 \u1ea9n). Hi\u1ec7n t\u1ea1i, thu\u1eadt to\u00e1n t\u1ed1t nh\u1ea5t \u0111\u01b0\u1ee3c bi\u1ebft \u0111\u1ebfn ho\u1ea1t \u0111\u1ed9ng trong th\u1eddi gian $O\\left(n^3 \\frac{ \\log^3 \\log n }{ \\log^2 n} \\right)$ (T. Chan 2007 \"More algorithms for all-pairs shortest paths in weighted graphs\")</p> <p>Thu\u1eadt to\u00e1n n\u00e0y c\u1ee7a Chan, c\u0169ng nh\u01b0 nhi\u1ec1u k\u1ebft qu\u1ea3 kh\u00e1c trong l\u0129nh v\u1ef1c n\u00e0y, th\u1ef1c s\u1ef1 m\u00f4 t\u1ea3 nh\u00e2n ma tr\u1eadn nhanh (trong \u0111\u00f3 nh\u00e2n ma tr\u1eadn c\u00f3 ngh\u0129a l\u00e0 ph\u00e9p nh\u00e2n \u0111\u01b0\u1ee3c s\u1eeda \u0111\u1ed5i: minimum \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng thay v\u00ec ph\u00e9p c\u1ed9ng, v\u00e0 ph\u00e9p c\u1ed9ng \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng thay v\u00ec ph\u00e9p nh\u00e2n). B\u00e0i to\u00e1n t\u00ecm ma tr\u1eadn con c\u00f3 t\u1ed5ng l\u1edbn nh\u1ea5t c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3m xu\u1ed1ng b\u00e0i to\u00e1n t\u00ecm \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t gi\u1eefa t\u1ea5t c\u1ea3 c\u00e1c c\u1eb7p \u0111\u1ec9nh, v\u00e0 b\u00e0i to\u00e1n n\u00e0y, \u0111\u1ebfn l\u01b0\u1ee3t n\u00f3, c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3m xu\u1ed1ng ph\u00e9p nh\u00e2n ma tr\u1eadn nh\u01b0 v\u1eady.</p>","tags":["Translated"]},{"location":"others/maximum_average_segment.html#search-for-a-subarray-with-a-maximum-minimum-average","title":"T\u00ecm ki\u1ebfm d\u00e3y con c\u00f3 trung b\u00ecnh l\u1edbn nh\u1ea5t/nh\u1ecf nh\u1ea5t (Search for a subarray with a maximum/minimum average)","text":"<p>B\u00e0i to\u00e1n n\u00e0y n\u1eb1m \u1edf vi\u1ec7c t\u00ecm ph\u00e2n \u0111o\u1ea1n $a[l, r]$ nh\u01b0 v\u1eady, sao cho gi\u00e1 tr\u1ecb trung b\u00ecnh l\u00e0 c\u1ef1c \u0111\u1ea1i:</p> $$ \\max_{l \\le r} \\frac{ 1 }{ r-l+1 } \\sum_{i=l}^{r} a[i].$$ <p>T\u1ea5t nhi\u00ean, n\u1ebfu kh\u00f4ng c\u00f3 \u0111i\u1ec1u ki\u1ec7n n\u00e0o kh\u00e1c \u0111\u01b0\u1ee3c \u00e1p \u0111\u1eb7t cho ph\u00e2n \u0111o\u1ea1n $[l, r]$ \u0111\u01b0\u1ee3c y\u00eau c\u1ea7u, th\u00ec gi\u1ea3i ph\u00e1p s\u1ebd lu\u00f4n l\u00e0 ph\u00e2n \u0111o\u1ea1n c\u00f3 \u0111\u1ed9 d\u00e0i $1$ t\u1ea1i ph\u1ea7n t\u1eed c\u1ef1c \u0111\u1ea1i c\u1ee7a m\u1ea3ng. B\u00e0i to\u00e1n ch\u1ec9 c\u00f3 \u00fd ngh\u0129a, n\u1ebfu c\u00f3 c\u00e1c h\u1ea1n ch\u1ebf b\u1ed5 sung (v\u00ed d\u1ee5, \u0111\u1ed9 d\u00e0i c\u1ee7a ph\u00e2n \u0111o\u1ea1n mong mu\u1ed1n b\u1ecb ch\u1eb7n d\u01b0\u1edbi).</p> <p>Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, ch\u00fang t\u00f4i \u00e1p d\u1ee5ng k\u1ef9 thu\u1eadt ti\u00eau chu\u1ea9n khi l\u00e0m vi\u1ec7c v\u1edbi c\u00e1c b\u00e0i to\u00e1n v\u1ec1 gi\u00e1 tr\u1ecb trung b\u00ecnh: ch\u00fang t\u00f4i s\u1ebd ch\u1ecdn gi\u00e1 tr\u1ecb trung b\u00ecnh c\u1ef1c \u0111\u1ea1i mong mu\u1ed1n b\u1eb1ng t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n.</p> <p>\u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y, ch\u00fang ta c\u1ea7n h\u1ecdc c\u00e1ch gi\u1ea3i quy\u1ebft b\u00e0i to\u00e1n con sau: cho s\u1ed1 $x$, v\u00e0 ch\u00fang ta c\u1ea7n ki\u1ec3m tra xem c\u00f3 d\u00e3y con n\u00e0o c\u1ee7a m\u1ea3ng $a[]$ (t\u1ea5t nhi\u00ean, th\u1ecfa m\u00e3n t\u1ea5t c\u1ea3 c\u00e1c r\u00e0ng bu\u1ed9c b\u1ed5 sung c\u1ee7a b\u00e0i to\u00e1n), trong \u0111\u00f3 gi\u00e1 tr\u1ecb trung b\u00ecnh l\u1edbn h\u01a1n $x$ hay kh\u00f4ng.</p> <p>\u0110\u1ec3 gi\u1ea3i quy\u1ebft b\u00e0i to\u00e1n con n\u00e0y, h\u00e3y tr\u1eeb $x$ kh\u1ecfi m\u1ed7i ph\u1ea7n t\u1eed c\u1ee7a m\u1ea3ng $a[]$. Sau \u0111\u00f3, b\u00e0i to\u00e1n con c\u1ee7a ch\u00fang ta th\u1ef1c s\u1ef1 bi\u1ebfn th\u00e0nh b\u00e0i to\u00e1n n\u00e0y: c\u00f3 hay kh\u00f4ng c\u00f3 c\u00e1c d\u00e3y con t\u1ed5ng d\u01b0\u01a1ng trong m\u1ea3ng n\u00e0y. V\u00e0 ch\u00fang ta \u0111\u00e3 bi\u1ebft c\u00e1ch gi\u1ea3i quy\u1ebft b\u00e0i to\u00e1n n\u00e0y.</p> <p>Do \u0111\u00f3, ch\u00fang t\u00f4i \u0111\u00e3 thu \u0111\u01b0\u1ee3c gi\u1ea3i ph\u00e1p cho ti\u1ec7m c\u1eadn $O(T(n) \\log W)$, trong \u0111\u00f3 $W$ l\u00e0 \u0111\u1ed9 ch\u00ednh x\u00e1c c\u1ea7n thi\u1ebft, $T(n)$ l\u00e0 th\u1eddi gian gi\u1ea3i quy\u1ebft b\u00e0i to\u00e1n con cho m\u1ed9t m\u1ea3ng c\u00f3 \u0111\u1ed9 d\u00e0i $n$ (c\u00f3 th\u1ec3 thay \u0111\u1ed5i t\u00f9y thu\u1ed9c v\u00e0o c\u00e1c h\u1ea1n ch\u1ebf b\u1ed5 sung c\u1ee5 th\u1ec3 \u0111\u01b0\u1ee3c \u00e1p \u0111\u1eb7t).</p>","tags":["Translated"]},{"location":"others/maximum_average_segment.html#solving-the-online-problem","title":"Gi\u1ea3i b\u00e0i to\u00e1n tr\u1ef1c tuy\u1ebfn (Solving the online problem)","text":"<p>\u0110i\u1ec1u ki\u1ec7n c\u1ee7a b\u00e0i to\u00e1n nh\u01b0 sau: cho m\u1ed9t m\u1ea3ng g\u1ed3m $n$ s\u1ed1 v\u00e0 m\u1ed9t s\u1ed1 $L$. C\u00f3 c\u00e1c truy v\u1ea5n c\u00f3 d\u1ea1ng $(l,r)$, v\u00e0 \u0111\u1ec3 tr\u1ea3 l\u1eddi cho m\u1ed7i truy v\u1ea5n, c\u1ea7n t\u00ecm m\u1ed9t d\u00e3y con c\u1ee7a \u0111o\u1ea1n $[l, r]$ c\u00f3 \u0111\u1ed9 d\u00e0i kh\u00f4ng nh\u1ecf h\u01a1n $L$ v\u1edbi trung b\u00ecnh c\u1ed9ng l\u1edbn nh\u1ea5t c\u00f3 th\u1ec3.</p> <p>Thu\u1eadt to\u00e1n gi\u1ea3i b\u00e0i to\u00e1n n\u00e0y kh\u00e1 ph\u1ee9c t\u1ea1p. KADR (Yaroslav Tverdokhleb) \u0111\u00e3 m\u00f4 t\u1ea3 thu\u1eadt to\u00e1n c\u1ee7a m\u00ecnh tr\u00ean di\u1ec5n \u0111\u00e0n Nga.</p>","tags":["Translated"]},{"location":"others/maximum_average_segment.html#checklist","title":"Checklist","text":"<ul> <li>[x] D\u1ecbch c\u00e1c kh\u00e1i ni\u1ec7m k\u1ef9 thu\u1eadt sang ti\u1ebfng Vi\u1ec7t ch\u00ednh x\u00e1c.</li> <li>[x] \u0110\u00e3 c\u1eadp nh\u1eadt c\u00e1c li\u00ean k\u1ebft n\u1ed9i b\u1ed9 (\u0111\u1ebfn 127.0.0.1:8000).</li> <li>[x] \u0110\u1ecbnh d\u1ea1ng l\u1ea1i c\u00e1c c\u00f4ng th\u1ee9c to\u00e1n h\u1ecdc v\u00e0 code block.</li> <li>[x] Ki\u1ec3m tra ch\u00ednh t\u1ea3 v\u00e0 ng\u1eef ph\u00e1p.</li> <li>[x] \u0110\u1ea3m b\u1ea3o t\u00ednh nh\u1ea5t qu\u00e1n v\u1edbi c\u00e1c thu\u1eadt ng\u1eef \u0111\u00e3 d\u1ecbch kh\u00e1c.</li> </ul>","tags":["Translated"]},{"location":"others/stern_brocot_tree_farey_sequences.html","title":"C\u00e2y Stern-Brocot v\u00e0 d\u00e3y Farey (The Stern-Brocot tree and Farey sequences)","text":"","tags":["Translated"]},{"location":"others/stern_brocot_tree_farey_sequences.html#stern-brocot-tree","title":"C\u00e2y Stern-Brocot (Stern-Brocot tree)","text":"<p>C\u00e2y Stern-Brocot l\u00e0 m\u1ed9t c\u1ea5u tr\u00fac thanh l\u1ecbch \u0111\u1ec3 bi\u1ec3u di\u1ec5n t\u1eadp h\u1ee3p t\u1ea5t c\u1ea3 c\u00e1c ph\u00e2n s\u1ed1 d\u01b0\u01a1ng. N\u00f3 \u0111\u01b0\u1ee3c ph\u00e1t hi\u1ec7n \u0111\u1ed9c l\u1eadp b\u1edfi nh\u00e0 to\u00e1n h\u1ecdc ng\u01b0\u1eddi \u0110\u1ee9c Moritz Stern v\u00e0o n\u0103m 1858 v\u00e0 b\u1edfi nh\u00e0 s\u1ea3n xu\u1ea5t \u0111\u1ed3ng h\u1ed3 ng\u01b0\u1eddi Ph\u00e1p Achille Brocot v\u00e0o n\u0103m 1861. Tuy nhi\u00ean, m\u1ed9t s\u1ed1 ngu\u1ed3n g\u00e1n s\u1ef1 ph\u00e1t hi\u1ec7n n\u00e0y cho nh\u00e0 to\u00e1n h\u1ecdc Hy L\u1ea1p c\u1ed5 \u0111\u1ea1i Eratosthenes.</p> <p>Vi\u1ec7c x\u00e2y d\u1ef1ng b\u1eaft \u0111\u1ea7u \u1edf l\u1ea7n l\u1eb7p th\u1ee9 0 v\u1edbi hai ph\u00e2n s\u1ed1</p> $$     \\frac{0}{1}, \\frac{1}{0} $$ <p>trong \u0111\u00f3 c\u1ea7n l\u01b0u \u00fd r\u1eb1ng \u0111\u1ea1i l\u01b0\u1ee3ng th\u1ee9 hai kh\u00f4ng ph\u1ea3i l\u00e0 m\u1ed9t ph\u00e2n s\u1ed1 \u0111\u00fang ngh\u0129a, nh\u01b0ng n\u00f3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c hi\u1ec3u l\u00e0 m\u1ed9t ph\u00e2n s\u1ed1 t\u1ed1i gi\u1ea3n \u0111\u1ea1i di\u1ec7n cho v\u00f4 c\u1ef1c.</p> <p>\u1ede m\u1ecdi l\u1ea7n l\u1eb7p ti\u1ebfp theo, h\u00e3y xem x\u00e9t t\u1ea5t c\u1ea3 c\u00e1c ph\u00e2n s\u1ed1 li\u1ec1n k\u1ec1 $\\frac{a}{b}$ v\u00e0 $\\frac{c}{d}$ v\u00e0 ch\u00e8n trung gian (mediant) $\\frac{a+c}{b+d}$ v\u00e0o gi\u1eefa ch\u00fang.</p> <p>M\u1ed9t v\u00e0i l\u1ea7n l\u1eb7p \u0111\u1ea7u ti\u00ean tr\u00f4ng nh\u01b0 th\u1ebf n\u00e0y:</p> $$     \\begin{array}{c}     \\dfrac{0}{1}, \\dfrac{1}{1}, \\dfrac{1}{0} \\\\     \\dfrac{0}{1}, \\dfrac{1}{2}, \\dfrac{1}{1}, \\dfrac{2}{1}, \\dfrac{1}{0} \\\\     \\dfrac{0}{1}, \\dfrac{1}{3}, \\dfrac{1}{2}, \\dfrac{2}{3}, \\dfrac{1}{1}, \\dfrac{3}{2}, \\dfrac{2}{1}, \\dfrac{3}{1}, \\dfrac{1}{0}     \\end{array} $$ <p>Ti\u1ebfp t\u1ee5c qu\u00e1 tr\u00ecnh n\u00e0y \u0111\u1ebfn v\u00f4 c\u00f9ng, n\u00f3 bao g\u1ed3m t\u1ea5t c\u1ea3 c\u00e1c ph\u00e2n s\u1ed1 d\u01b0\u01a1ng. Ngo\u00e0i ra, t\u1ea5t c\u1ea3 c\u00e1c ph\u00e2n s\u1ed1 s\u1ebd l\u00e0 duy nh\u1ea5t v\u00e0 t\u1ed1i gi\u1ea3n. Cu\u1ed1i c\u00f9ng, c\u00e1c ph\u00e2n s\u1ed1 c\u0169ng s\u1ebd xu\u1ea5t hi\u1ec7n theo th\u1ee9 t\u1ef1 t\u0103ng d\u1ea7n.</p> <p>Tr\u01b0\u1edbc khi ch\u1ee9ng minh c\u00e1c t\u00ednh ch\u1ea5t n\u00e0y, h\u00e3y th\u1ef1c s\u1ef1 hi\u1ec3n th\u1ecb m\u1ed9t h\u00ecnh dung v\u1ec1 c\u00e2y Stern-Brocot, thay v\u00ec bi\u1ec3u di\u1ec5n danh s\u00e1ch. M\u1ed7i ph\u00e2n s\u1ed1 trong c\u00e2y c\u00f3 hai con. M\u1ed7i con l\u00e0 trung gian c\u1ee7a t\u1ed5 ti\u00ean g\u1ea7n nh\u1ea5t \u1edf b\u00ean tr\u00e1i v\u00e0 t\u1ed5 ti\u00ean g\u1ea7n nh\u1ea5t \u1edf b\u00ean ph\u1ea3i.</p>","tags":["Translated"]},{"location":"others/stern_brocot_tree_farey_sequences.html#proofs","title":"Ch\u1ee9ng minh (Proofs)","text":"<p>Th\u1ee9 t\u1ef1 (Ordering). Ch\u1ee9ng minh th\u1ee9 t\u1ef1 r\u1ea5t \u0111\u01a1n gi\u1ea3n. Ch\u00fang t\u00f4i l\u01b0u \u00fd r\u1eb1ng trung gian c\u1ee7a hai ph\u00e2n s\u1ed1 lu\u00f4n n\u1eb1m gi\u1eefa c\u00e1c ph\u00e2n s\u1ed1</p> $$     \\frac{a}{b} \\le \\frac{a+c}{b+d} \\le \\frac{c}{d} $$ <p>v\u1edbi \u0111i\u1ec1u ki\u1ec7n l\u00e0</p> $$     \\frac{a}{b} \\le \\frac{c}{d}. $$ <p>Hai b\u1ea5t \u0111\u1eb3ng th\u1ee9c c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng \u0111\u01b0\u1ee3c ch\u1ec9 ra b\u1eb1ng c\u00e1ch vi\u1ebft l\u1ea1i c\u00e1c ph\u00e2n s\u1ed1 v\u1edbi m\u1eabu s\u1ed1 chung.</p> <p>V\u00ec th\u1ee9 t\u1ef1 t\u0103ng d\u1ea7n trong l\u1ea7n l\u1eb7p th\u1ee9 0, n\u00f3 s\u1ebd \u0111\u01b0\u1ee3c duy tr\u00ec \u1edf m\u1ecdi l\u1ea7n l\u1eb7p ti\u1ebfp theo.</p> <p>T\u00ednh t\u1ed1i gi\u1ea3n (Irreducibility). \u0110\u1ec3 ch\u1ee9ng minh \u0111i\u1ec1u n\u00e0y, ch\u00fang t\u00f4i s\u1ebd ch\u1ec9 ra r\u1eb1ng \u0111\u1ed1i v\u1edbi b\u1ea5t k\u1ef3 hai ph\u00e2n s\u1ed1 li\u1ec1n k\u1ec1 n\u00e0o $\\frac{a}{b}$ v\u00e0 $\\frac{c}{d}$ ch\u00fang ta c\u00f3</p> $$     bc - ad = 1. $$ <p>Nh\u1edb l\u1ea1i r\u1eb1ng m\u1ed9t ph\u01b0\u01a1ng tr\u00ecnh Diophantine v\u1edbi hai bi\u1ebfn $ax+by=c$ c\u00f3 nghi\u1ec7m khi v\u00e0 ch\u1ec9 khi $c$ l\u00e0 b\u1ed9i s\u1ed1 c\u1ee7a $\\gcd(a,b)$. Trong tr\u01b0\u1eddng h\u1ee3p c\u1ee7a ch\u00fang t\u00f4i, \u0111i\u1ec1u n\u00e0y ng\u1ee5 \u00fd r\u1eb1ng $\\gcd(a,b) = \\gcd(c,d) = 1$, \u0111\u00f3 l\u00e0 nh\u1eefng g\u00ec ch\u00fang t\u00f4i mu\u1ed1n ch\u1ee9ng minh.</p> <p>R\u00f5 r\u00e0ng \u1edf l\u1ea7n l\u1eb7p th\u1ee9 0 $bc - ad = 1$. \u0110i\u1ec1u c\u00f2n l\u1ea1i c\u1ea7n \u0111\u01b0\u1ee3c ch\u1ee9ng minh l\u00e0 c\u00e1c trung gian gi\u1eef \u0111\u01b0\u1ee3c thu\u1ed9c t\u00ednh n\u00e0y.</p> <p>Gi\u1ea3 s\u1eed hai ph\u00e2n s\u1ed1 li\u1ec1n k\u1ec1 c\u1ee7a ch\u00fang t\u00f4i duy tr\u00ec $bc - ad = 1$, sau khi trung gian \u0111\u01b0\u1ee3c th\u00eam v\u00e0o danh s\u00e1ch</p> $$     \\frac{a}{b}, \\frac{a+c}{b+d}, \\frac{c}{d} $$ <p>c\u00e1c bi\u1ec3u th\u1ee9c m\u1edbi tr\u1edf th\u00e0nh</p> $$\\begin{align}     b(a+c) - a(b+d) &amp;= 1 \\\\     c(b+d) - d(a+c) &amp;= 1 \\end{align}$$ <p>\u0111i\u1ec1u n\u00e0y, s\u1eed d\u1ee5ng $bc-ad=1$, c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng \u0111\u01b0\u1ee3c ch\u1ee9ng minh l\u00e0 \u0111\u00fang.</p> <p>T\u1eeb \u0111\u00e2y ch\u00fang ta th\u1ea5y r\u1eb1ng thu\u1ed9c t\u00ednh lu\u00f4n \u0111\u01b0\u1ee3c duy tr\u00ec v\u00e0 do \u0111\u00f3 t\u1ea5t c\u1ea3 c\u00e1c ph\u00e2n s\u1ed1 \u0111\u1ec1u t\u1ed1i gi\u1ea3n.</p> <p>S\u1ef1 hi\u1ec7n di\u1ec7n c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c ph\u00e2n s\u1ed1 (The presence of all fractions). B\u1eb1ng ch\u1ee9ng n\u00e0y li\u00ean quan ch\u1eb7t ch\u1ebd \u0111\u1ebfn vi\u1ec7c \u0111\u1ecbnh v\u1ecb m\u1ed9t ph\u00e2n s\u1ed1 trong c\u00e2y Stern-Brocot. T\u1eeb thu\u1ed9c t\u00ednh th\u1ee9 t\u1ef1, ch\u00fang ta c\u00f3 c\u00e2y con b\u00ean tr\u00e1i c\u1ee7a m\u1ed9t ph\u00e2n s\u1ed1 ch\u1ec9 ch\u1ee9a c\u00e1c ph\u00e2n s\u1ed1 nh\u1ecf h\u01a1n ph\u00e2n s\u1ed1 cha v\u00e0 c\u00e2y con b\u00ean ph\u1ea3i ch\u1ec9 ch\u1ee9a c\u00e1c ph\u00e2n s\u1ed1 l\u1edbn h\u01a1n ph\u00e2n s\u1ed1 cha. \u0110i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm ki\u1ebfm m\u1ed9t ph\u00e2n s\u1ed1 b\u1eb1ng c\u00e1ch duy\u1ec7t qua c\u00e2y t\u1eeb g\u1ed1c, \u0111i sang tr\u00e1i n\u1ebfu m\u1ee5c ti\u00eau nh\u1ecf h\u01a1n ph\u00e2n s\u1ed1 v\u00e0 \u0111i sang ph\u1ea3i n\u1ebfu m\u1ee5c ti\u00eau l\u1edbn h\u01a1n.</p> <p>Ch\u1ecdn m\u1ed9t ph\u00e2n s\u1ed1 m\u1ee5c ti\u00eau d\u01b0\u01a1ng t\u00f9y \u00fd $\\frac{x}{y}$. N\u00f3 r\u00f5 r\u00e0ng n\u1eb1m gi\u1eefa $\\frac{0}{1}$ v\u00e0 $\\frac{1}{0}$, v\u00ec v\u1eady c\u00e1ch duy nh\u1ea5t \u0111\u1ec3 ph\u00e2n s\u1ed1 kh\u00f4ng n\u1eb1m trong c\u00e2y l\u00e0 n\u1ebfu m\u1ea5t v\u00f4 s\u1ed1 b\u01b0\u1edbc \u0111\u1ec3 \u0111\u1ebfn \u0111\u01b0\u1ee3c n\u00f3.</p> <p>N\u1ebfu \u0111\u00fang nh\u01b0 v\u1eady, ch\u00fang t\u00f4i s\u1ebd t\u1ea1i t\u1ea5t c\u1ea3 c\u00e1c l\u1ea7n l\u1eb7p c\u00f3</p> $$     \\frac{a}{b} \\lt \\frac{x}{y} \\lt \\frac{c}{d} $$ <p>\u0111i\u1ec1u n\u00e0y (s\u1eed d\u1ee5ng th\u1ef1c t\u1ebf l\u00e0 m\u1ed9t s\u1ed1 nguy\u00ean $z \\gt 0 \\iff z \\ge 1$) c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c vi\u1ebft l\u1ea1i th\u00e0nh</p> $$ \\begin{align}     bx - ay &amp;\\ge 1 \\\\     cy - dx &amp;\\ge 1. \\end{align} $$ <p>B\u00e2y gi\u1edd nh\u00e2n b\u1ea5t \u0111\u1eb3ng th\u1ee9c \u0111\u1ea7u ti\u00ean v\u1edbi $c+d$ v\u00e0 th\u1ee9 hai v\u1edbi $a+b$ v\u00e0 c\u1ed9ng ch\u00fang \u0111\u1ec3 c\u00f3 \u0111\u01b0\u1ee3c</p> $$     (c+d)(bx - ay) + (a+b)(cy - dx) \\ge a+b+c+d. $$ <p>M\u1edf r\u1ed9ng \u0111i\u1ec1u n\u00e0y v\u00e0 s\u1eed d\u1ee5ng thu\u1ed9c t\u00ednh \u0111\u00e3 \u0111\u01b0\u1ee3c hi\u1ec3n th\u1ecb tr\u01b0\u1edbc \u0111\u00f3 $bc-ad=1$, ch\u00fang t\u00f4i nh\u1eadn \u0111\u01b0\u1ee3c r\u1eb1ng</p> $$     x+y \\ge a+b+c+d. $$ <p>V\u00e0 do t\u1ea1i m\u1ed7i l\u1ea7n l\u1eb7p, \u00edt nh\u1ea5t m\u1ed9t trong c\u00e1c $a,b,c,d$ s\u1ebd t\u0103ng l\u00ean, qu\u00e1 tr\u00ecnh t\u00ecm ki\u1ebfm ph\u00e2n s\u1ed1 s\u1ebd ch\u1ee9a kh\u00f4ng qu\u00e1 $x+y$ l\u1ea7n l\u1eb7p. \u0110i\u1ec1u n\u00e0y m\u00e2u thu\u1eabn v\u1edbi gi\u1ea3 \u0111\u1ecbnh r\u1eb1ng \u0111\u01b0\u1eddng \u0111\u1ebfn $\\frac{x}{y}$ l\u00e0 v\u00f4 h\u1ea1n v\u00e0 do \u0111\u00f3 $\\frac{x}{y}$ ph\u1ea3i l\u00e0 m\u1ed9t ph\u1ea7n c\u1ee7a c\u00e2y.</p>","tags":["Translated"]},{"location":"others/stern_brocot_tree_farey_sequences.html#tree-building-algorithm","title":"Thu\u1eadt to\u00e1n x\u00e2y d\u1ef1ng c\u00e2y (Tree Building Algorithm)","text":"<p>\u0110\u1ec3 x\u00e2y d\u1ef1ng b\u1ea5t k\u1ef3 c\u00e2y con n\u00e0o c\u1ee7a c\u00e2y Stern-Brocot, ch\u1ec9 c\u1ea7n bi\u1ebft t\u1ed5 ti\u00ean b\u00ean tr\u00e1i v\u00e0 b\u00ean ph\u1ea3i l\u00e0 \u0111\u1ee7. \u1ede c\u1ea5p \u0111\u1ed9 \u0111\u1ea7u ti\u00ean, t\u1ed5 ti\u00ean b\u00ean tr\u00e1i v\u00e0 b\u00ean ph\u1ea3i l\u1ea7n l\u01b0\u1ee3t l\u00e0 $\\frac{0}{1}$ v\u00e0 $\\frac{1}{0}$. S\u1eed d\u1ee5ng ch\u00fang, ch\u00fang t\u00f4i t\u00ednh to\u00e1n trung gian v\u00e0 ti\u1ebfn h\u00e0nh s\u00e2u h\u01a1n m\u1ed9t c\u1ea5p, v\u1edbi trung gian thay th\u1ebf t\u1ed5 ti\u00ean b\u00ean ph\u1ea3i trong c\u00e2y con b\u00ean tr\u00e1i v\u00e0 ng\u01b0\u1ee3c l\u1ea1i.</p> <p>M\u00e3 gi\u1ea3 n\u00e0y c\u1ed1 g\u1eafng x\u00e2y d\u1ef1ng to\u00e0n b\u1ed9 c\u00e2y v\u00f4 h\u1ea1n:</p> <pre><code>void build(int a = 0, int b = 1, int c = 1, int d = 0, int level = 1) {\n    int x = a + c, y = b + d;\n\n    ... output the current fraction x/y at the current level in the tree\n\n    build(a, b, x, y, level + 1);\n    build(x, y, c, d, level + 1);\n}\n</code></pre>","tags":["Translated"]},{"location":"others/stern_brocot_tree_farey_sequences.html#fraction-search-algorithm","title":"Thu\u1eadt to\u00e1n t\u00ecm ki\u1ebfm ph\u00e2n s\u1ed1 (Fraction Search Algorithm)","text":"<p>Thu\u1eadt to\u00e1n t\u00ecm ki\u1ebfm \u0111\u00e3 \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 trong b\u1eb1ng ch\u1ee9ng r\u1eb1ng t\u1ea5t c\u1ea3 c\u00e1c ph\u00e2n s\u1ed1 \u0111\u1ec1u xu\u1ea5t hi\u1ec7n trong c\u00e2y, nh\u01b0ng ch\u00fang t\u00f4i s\u1ebd l\u1eb7p l\u1ea1i \u1edf \u0111\u00e2y. Thu\u1eadt to\u00e1n l\u00e0 m\u1ed9t thu\u1eadt to\u00e1n t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n. Ban \u0111\u1ea7u ch\u00fang ta \u0111\u1ee9ng \u1edf g\u1ed1c c\u00e2y v\u00e0 so s\u00e1nh m\u1ee5c ti\u00eau c\u1ee7a m\u00ecnh v\u1edbi ph\u00e2n s\u1ed1 hi\u1ec7n t\u1ea1i. N\u1ebfu ch\u00fang gi\u1ed1ng nhau, ch\u00fang t\u00f4i \u0111\u00e3 ho\u00e0n t\u1ea5t v\u00e0 d\u1eebng qu\u00e1 tr\u00ecnh. N\u1ebfu m\u1ee5c ti\u00eau c\u1ee7a ch\u00fang t\u00f4i nh\u1ecf h\u01a1n, ch\u00fang t\u00f4i di chuy\u1ec3n \u0111\u1ebfn con b\u00ean tr\u00e1i, n\u1ebfu kh\u00f4ng ch\u00fang t\u00f4i di chuy\u1ec3n \u0111\u1ebfn con b\u00ean ph\u1ea3i.</p>","tags":["Translated"]},{"location":"others/stern_brocot_tree_farey_sequences.html#naive-search","title":"T\u00ecm ki\u1ebfm ng\u00e2y th\u01a1 (Naive search)","text":"<p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u1ed9t tri\u1ec3n khai tr\u1ea3 v\u1ec1 \u0111\u01b0\u1eddng d\u1eabn \u0111\u1ebfn m\u1ed9t ph\u00e2n s\u1ed1 nh\u1ea5t \u0111\u1ecbnh $\\frac{p}{q}$ d\u01b0\u1edbi d\u1ea1ng m\u1ed9t chu\u1ed7i c\u00e1c k\u00fd t\u1ef1 <code>'L'</code> v\u00e0 <code>'R'</code>, c\u00f3 ngh\u0129a l\u00e0 duy\u1ec7t \u0111\u1ebfn con b\u00ean tr\u00e1i v\u00e0 b\u00ean ph\u1ea3i t\u01b0\u01a1ng \u1ee9ng. Chu\u1ed7i k\u00fd t\u1ef1 n\u00e0y x\u00e1c \u0111\u1ecbnh duy nh\u1ea5t t\u1ea5t c\u1ea3 c\u00e1c ph\u00e2n s\u1ed1 d\u01b0\u01a1ng v\u00e0 \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 h\u1ec7 th\u1ed1ng s\u1ed1 Stern-Brocot.</p> <pre><code>string find(int p, int q) {\n    int pL = 0, qL = 1;\n    int pR = 1, qR = 0;\n    int pM = 1, qM = 1;\n    string res;\n    while(pM != p || qM != q) {\n        if(p * qM &lt; pM * q) {\n            res += 'L';\n            tie(pR, qR) = {pM, qM};\n        } else {\n            res += 'R';\n            tie(pL, qL) = {pM, qM};\n        }\n        tie(pM, qM) = pair{pL + pR, qL + qR};\n    }\n    return res;\n}\n</code></pre> <p>S\u1ed1 v\u00f4 t\u1ef7 trong h\u1ec7 th\u1ed1ng s\u1ed1 Stern-Brocot t\u01b0\u01a1ng \u1ee9ng v\u1edbi chu\u1ed7i k\u00fd t\u1ef1 v\u00f4 h\u1ea1n. D\u1ecdc theo con \u0111\u01b0\u1eddng v\u00f4 t\u1eadn h\u01b0\u1edbng t\u1edbi s\u1ed1 v\u00f4 t\u1ef7, thu\u1eadt to\u00e1n s\u1ebd t\u00ecm th\u1ea5y c\u00e1c ph\u00e2n s\u1ed1 r\u00fat g\u1ecdn v\u1edbi c\u00e1c m\u1eabu s\u1ed1 t\u0103ng d\u1ea7n cung c\u1ea5p x\u1ea5p x\u1ec9 ng\u00e0y c\u00e0ng t\u1ed1t h\u01a1n c\u1ee7a s\u1ed1 v\u00f4 t\u1ef7. V\u00ec v\u1eady, b\u1eb1ng c\u00e1ch l\u1ea5y m\u1ed9t ti\u1ec1n t\u1ed1 c\u1ee7a chu\u1ed7i v\u00f4 h\u1ea1n, c\u00e1c x\u1ea5p x\u1ec9 v\u1edbi b\u1ea5t k\u1ef3 \u0111\u1ed9 ch\u00ednh x\u00e1c mong mu\u1ed1n n\u00e0o \u0111\u1ec1u c\u00f3 th\u1ec3 \u0111\u1ea1t \u0111\u01b0\u1ee3c. \u1ee8ng d\u1ee5ng n\u00e0y r\u1ea5t quan tr\u1ecdng trong vi\u1ec7c ch\u1ebf t\u1ea1o \u0111\u1ed3ng h\u1ed3, gi\u1ea3i th\u00edch t\u1ea1i sao c\u00e2y \u0111\u01b0\u1ee3c ph\u00e1t hi\u1ec7n trong mi\u1ec1n \u0111\u00f3.</p> <p>L\u01b0u \u00fd r\u1eb1ng \u0111\u1ed1i v\u1edbi ph\u00e2n s\u1ed1 $\\frac{p}{q}$, \u0111\u1ed9 d\u00e0i c\u1ee7a chu\u1ed7i k\u1ebft qu\u1ea3 c\u00f3 th\u1ec3 l\u1edbn t\u1edbi $O(p+q)$, v\u00ed d\u1ee5 khi ph\u00e2n s\u1ed1 c\u00f3 d\u1ea1ng $\\frac{p}{1}$. \u0110i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 thu\u1eadt to\u00e1n tr\u00ean kh\u00f4ng n\u00ean \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng, tr\u1eeb khi \u0111\u00e2y l\u00e0 \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u00f3 th\u1ec3 ch\u1ea5p nh\u1eadn \u0111\u01b0\u1ee3c!</p>","tags":["Translated"]},{"location":"others/stern_brocot_tree_farey_sequences.html#logarithmic-search","title":"T\u00ecm ki\u1ebfm logarit (Logarithmic search)","text":"<p>May m\u1eafn thay, c\u00f3 th\u1ec3 t\u0103ng c\u01b0\u1eddng thu\u1eadt to\u00e1n tr\u00ean \u0111\u1ec3 \u0111\u1ea3m b\u1ea3o \u0111\u1ed9 ph\u1ee9c t\u1ea1p $O(\\log (p+q))$. \u0110\u1ed1i v\u1edbi \u0111i\u1ec1u n\u00e0y, ch\u00fang ta n\u00ean l\u01b0u \u00fd r\u1eb1ng n\u1ebfu c\u00e1c ph\u00e2n s\u1ed1 ranh gi\u1edbi hi\u1ec7n t\u1ea1i l\u00e0 $\\frac{p_L}{q_L}$ v\u00e0 $\\frac{p_R}{q_R}$, th\u00ec b\u1eb1ng c\u00e1ch th\u1ef1c hi\u1ec7n $a$ b\u01b0\u1edbc sang b\u00ean ph\u1ea3i, ch\u00fang ta di chuy\u1ec3n \u0111\u1ebfn ph\u00e2n s\u1ed1 $\\frac{p_L + a p_R}{q_L + a q_R}$, v\u00e0 b\u1eb1ng c\u00e1ch th\u1ef1c hi\u1ec7n $a$ b\u01b0\u1edbc sang b\u00ean tr\u00e1i, ch\u00fang ta di chuy\u1ec3n \u0111\u1ebfn ph\u00e2n s\u1ed1 $\\frac{a p_L + p_R}{a q_L + q_R}$.</p> <p>Do \u0111\u00f3, thay v\u00ec th\u1ef1c hi\u1ec7n t\u1eebng b\u01b0\u1edbc <code>L</code> ho\u1eb7c <code>R</code> m\u1ed9t, ch\u00fang ta c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n $k$ b\u01b0\u1edbc theo c\u00f9ng m\u1ed9t h\u01b0\u1edbng c\u00f9ng m\u1ed9t l\u00fac, sau \u0111\u00f3 ch\u00fang ta s\u1ebd chuy\u1ec3n sang \u0111i theo h\u01b0\u1edbng kh\u00e1c, v\u00e0 c\u1ee9 th\u1ebf. Theo c\u00e1ch n\u00e0y, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm th\u1ea5y \u0111\u01b0\u1eddng d\u1eabn \u0111\u1ebfn ph\u00e2n s\u1ed1 $\\frac{p}{q}$ d\u01b0\u1edbi d\u1ea1ng m\u00e3 h\u00f3a \u0111\u1ed9 d\u00e0i ch\u1ea1y (run-length encoding) c\u1ee7a n\u00f3.</p> <p>Khi c\u00e1c h\u01b0\u1edbng xen k\u1ebd theo c\u00e1ch n\u00e0y, ch\u00fang t\u00f4i s\u1ebd lu\u00f4n bi\u1ebft n\u00ean ch\u1ecdn h\u01b0\u1edbng n\u00e0o. V\u00ec v\u1eady, \u0111\u1ec3 thu\u1eadn ti\u1ec7n, ch\u00fang ta c\u00f3 th\u1ec3 bi\u1ec3u di\u1ec5n m\u1ed9t \u0111\u01b0\u1eddng d\u1eabn \u0111\u1ebfn ph\u00e2n s\u1ed1 $\\frac{p}{q}$ d\u01b0\u1edbi d\u1ea1ng m\u1ed9t d\u00e3y c\u00e1c ph\u00e2n s\u1ed1</p> $$ \\frac{p_0}{q_0}, \\frac{p_1}{q_1}, \\frac{p_2}{q_2}, \\dots, \\frac{p_n}{q_n}, \\frac{p_{n+1}}{q_{n+1}} = \\frac{p}{q} $$ <p>sao cho $\\frac{p_{k-1}}{q_{k-1}}$ v\u00e0 $\\frac{p_k}{q_k}$ l\u00e0 ranh gi\u1edbi c\u1ee7a kho\u1ea3ng t\u00ecm ki\u1ebfm \u1edf b\u01b0\u1edbc th\u1ee9 $k$, b\u1eaft \u0111\u1ea7u b\u1eb1ng $\\frac{p_0}{q_0} = \\frac{0}{1}$ v\u00e0 $\\frac{p_1}{q_1} = \\frac{1}{0}$. Sau \u0111\u00f3, sau b\u01b0\u1edbc th\u1ee9 $k$, ch\u00fang ta di chuy\u1ec3n \u0111\u1ebfn m\u1ed9t ph\u00e2n s\u1ed1</p> $$ \\frac{p_{k+1}}{q_{k+1}} = \\frac{p_{k-1} + a_k p_k}{q_{k-1} + a_k q_k}, $$ <p>trong \u0111\u00f3 $a_k$ l\u00e0 m\u1ed9t s\u1ed1 nguy\u00ean d\u01b0\u01a1ng. N\u1ebfu b\u1ea1n quen thu\u1ed9c v\u1edbi li\u00ean ph\u00e2n s\u1ed1 (continued fractions), b\u1ea1n s\u1ebd nh\u1eadn ra r\u1eb1ng d\u00e3y $\\frac{p_i}{q_i}$ l\u00e0 d\u00e3y c\u00e1c ph\u00e2n s\u1ed1 h\u1ed9i t\u1ee5 c\u1ee7a $\\frac{p}{q}$ v\u00e0 d\u00e3y $[a_1; a_2, \\dots, a_{n}, 1]$ \u0111\u1ea1i di\u1ec7n cho li\u00ean ph\u00e2n s\u1ed1 c\u1ee7a $\\frac{p}{q}$.</p> <p>\u0110i\u1ec1u n\u00e0y cho ph\u00e9p t\u00ecm m\u00e3 h\u00f3a \u0111\u1ed9 d\u00e0i ch\u1ea1y c\u1ee7a \u0111\u01b0\u1eddng d\u1eabn \u0111\u1ebfn $\\frac{p}{q}$ theo c\u00e1ch tu\u00e2n theo thu\u1eadt to\u00e1n t\u00ednh to\u00e1n bi\u1ec3u di\u1ec5n li\u00ean ph\u00e2n s\u1ed1 c\u1ee7a ph\u00e2n s\u1ed1 $\\frac{p}{q}$:</p> <pre><code>auto find(int p, int q) {\n    bool right = true;\n    vector&lt;pair&lt;int, char&gt;&gt; res;\n    while(q) {\n        res.emplace_back(p / q, right ? 'R' : 'L');\n        tie(p, q) = pair{q, p % q};\n        right ^= 1;\n    }\n    res.back().first--;\n    return res;\n}\n</code></pre> <p>Tuy nhi\u00ean, c\u00e1ch ti\u1ebfp c\u1eadn n\u00e0y ch\u1ec9 ho\u1ea1t \u0111\u1ed9ng n\u1ebfu ch\u00fang ta \u0111\u00e3 bi\u1ebft $\\frac{p}{q}$ v\u00e0 mu\u1ed1n t\u00ecm v\u1ecb tr\u00ed c\u1ee7a n\u00f3 trong c\u00e2y Stern-Brocot.</p> <p>Tr\u00ean th\u1ef1c t\u1ebf, th\u01b0\u1eddng th\u00ec tr\u01b0\u1eddng h\u1ee3p $\\frac{p}{q}$ kh\u00f4ng \u0111\u01b0\u1ee3c bi\u1ebft tr\u01b0\u1edbc, nh\u01b0ng ch\u00fang t\u00f4i c\u00f3 th\u1ec3 ki\u1ec3m tra xem c\u1ee5 th\u1ec3 $\\frac{x}{y}$ li\u1ec7u $\\frac{x}{y} &lt; \\frac{p}{q}$.</p> <p>Bi\u1ebft \u0111i\u1ec1u n\u00e0y, ch\u00fang ta c\u00f3 th\u1ec3 m\u00f4 ph\u1ecfng t\u00ecm ki\u1ebfm tr\u00ean c\u00e2y Stern-Brocot b\u1eb1ng c\u00e1ch duy tr\u00ec c\u00e1c ranh gi\u1edbi hi\u1ec7n t\u1ea1i $\\frac{p_{k-1}}{q_{k-1}}$ v\u00e0 $\\frac{p_k}{q_k}$, v\u00e0 t\u00ecm t\u1eebng $a_k$ th\u00f4ng qua t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n. Thu\u1eadt to\u00e1n sau \u0111\u00f3 k\u1ef9 thu\u1eadt h\u01a1n m\u1ed9t ch\u00fat v\u00e0 c\u00f3 kh\u1ea3 n\u0103ng c\u00f3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p $O(\\log^2(x+y))$, tr\u1eeb khi c\u00f4ng th\u1ee9c b\u00e0i to\u00e1n cho ph\u00e9p b\u1ea1n t\u00ecm $a_k$ nhanh h\u01a1n (v\u00ed d\u1ee5, s\u1eed d\u1ee5ng <code>floor</code> c\u1ee7a m\u1ed9t bi\u1ec3u th\u1ee9c \u0111\u00e3 bi\u1ebft).</p>","tags":["Translated"]},{"location":"others/stern_brocot_tree_farey_sequences.html#farey-sequence","title":"D\u00e3y Farey (Farey Sequence)","text":"<p>D\u00e3y Farey b\u1eadc $n$ l\u00e0 d\u00e3y c\u00e1c ph\u00e2n s\u1ed1 \u0111\u00e3 s\u1eafp x\u1ebfp n\u1eb1m gi\u1eefa $0$ v\u00e0 $1$ c\u00f3 m\u1eabu s\u1ed1 kh\u00f4ng v\u01b0\u1ee3t qu\u00e1 $n$.</p> <p>C\u00e1c chu\u1ed7i \u0111\u01b0\u1ee3c \u0111\u1eb7t theo t\u00ean c\u1ee7a nh\u00e0 \u0111\u1ecba ch\u1ea5t h\u1ecdc ng\u01b0\u1eddi Anh John Farey, ng\u01b0\u1eddi v\u00e0o n\u0103m 1816 \u0111\u00e3 ph\u1ecfng \u0111o\u00e1n r\u1eb1ng b\u1ea5t k\u1ef3 ph\u00e2n s\u1ed1 n\u00e0o trong chu\u1ed7i Farey \u0111\u1ec1u l\u00e0 trung gian c\u1ee7a c\u00e1c ph\u00e2n s\u1ed1 l\u00e2n c\u1eadn c\u1ee7a n\u00f3. \u0110i\u1ec1u n\u00e0y \u0111\u00e3 \u0111\u01b0\u1ee3c ch\u1ee9ng minh m\u1ed9t th\u1eddi gian sau \u0111\u00f3 b\u1edfi Cauchy, nh\u01b0ng \u0111\u1ed9c l\u1eadp v\u1edbi c\u1ea3 hai ng\u01b0\u1eddi h\u1ecd, nh\u00e0 to\u00e1n h\u1ecdc Haros \u0111\u00e3 \u0111i \u0111\u1ebfn k\u1ebft lu\u1eadn g\u1ea7n nh\u01b0 t\u01b0\u01a1ng t\u1ef1 v\u00e0o n\u0103m 1802.</p> <p>C\u00e1c chu\u1ed7i Farey c\u00f3 nhi\u1ec1u thu\u1ed9c t\u00ednh th\u00fa v\u1ecb c\u1ee7a ri\u00eang ch\u00fang, nh\u01b0ng m\u1ed1i li\u00ean h\u1ec7 v\u1edbi c\u00e2y Stern-Brocot l\u00e0 r\u00f5 r\u00e0ng nh\u1ea5t. Tr\u00ean th\u1ef1c t\u1ebf, c\u00e1c chu\u1ed7i Farey c\u00f3 th\u1ec3 thu \u0111\u01b0\u1ee3c b\u1eb1ng c\u00e1ch c\u1eaft t\u1ec9a c\u00e1c nh\u00e1nh kh\u1ecfi c\u00e2y.</p> <p>T\u1eeb thu\u1eadt to\u00e1n x\u00e2y d\u1ef1ng c\u00e2y Stern-Brocot, ch\u00fang ta c\u00f3 \u0111\u01b0\u1ee3c m\u1ed9t thu\u1eadt to\u00e1n cho c\u00e1c chu\u1ed7i Farey. B\u1eaft \u0111\u1ea7u v\u1edbi danh s\u00e1ch c\u00e1c ph\u00e2n s\u1ed1 $\\frac{0}{1}, \\frac{1}{0}$. \u1ede m\u1ed7i l\u1ea7n l\u1eb7p ti\u1ebfp theo, ch\u1ec9 ch\u00e8n trung gian n\u1ebfu m\u1eabu s\u1ed1 kh\u00f4ng v\u01b0\u1ee3t qu\u00e1 $n$. T\u1ea1i m\u1ed9t th\u1eddi \u0111i\u1ec3m n\u00e0o \u0111\u00f3, danh s\u00e1ch s\u1ebd ng\u1eebng thay \u0111\u1ed5i v\u00e0 chu\u1ed7i Farey mong mu\u1ed1n s\u1ebd \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y.</p>","tags":["Translated"]},{"location":"others/stern_brocot_tree_farey_sequences.html#length-of-a-farey-sequence","title":"\u0110\u1ed9 d\u00e0i c\u1ee7a d\u00e3y Farey (Length of a Farey Sequence)","text":"<p>M\u1ed9t d\u00e3y Farey b\u1eadc $n$ ch\u1ee9a t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed c\u1ee7a d\u00e3y Farey b\u1eadc $n-1$ c\u0169ng nh\u01b0 t\u1ea5t c\u1ea3 c\u00e1c ph\u00e2n s\u1ed1 t\u1ed1i gi\u1ea3n c\u00f3 m\u1eabu s\u1ed1 $n$, nh\u01b0ng v\u1ebf sau ch\u1ec9 l\u00e0 phi h\u00e0m Euler $\\varphi(n)$. V\u00ec v\u1eady, \u0111\u1ed9 d\u00e0i $L_n$ c\u1ee7a chu\u1ed7i Farey th\u1ee9 t\u1ef1 $n$ l\u00e0</p> $$     L_n = L_{n-1} + \\varphi(n) $$ <p>ho\u1eb7c t\u01b0\u01a1ng \u0111\u01b0\u01a1ng, b\u1eb1ng c\u00e1ch l\u00e0m s\u00e1ng t\u1ecf \u0111\u1ec7 quy ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c</p> $$     L_n = 1 + \\sum_{k=1}^n \\varphi(k). $$","tags":["Translated"]},{"location":"others/stern_brocot_tree_farey_sequences.html#checklist","title":"Checklist","text":"<ul> <li>[x] D\u1ecbch c\u00e1c kh\u00e1i ni\u1ec7m k\u1ef9 thu\u1eadt sang ti\u1ebfng Vi\u1ec7t ch\u00ednh x\u00e1c.</li> <li>[x] \u0110\u00e3 c\u1eadp nh\u1eadt c\u00e1c li\u00ean k\u1ebft n\u1ed9i b\u1ed9 (\u0111\u1ebfn 127.0.0.1:8000).</li> <li>[x] \u0110\u1ecbnh d\u1ea1ng l\u1ea1i c\u00e1c c\u00f4ng th\u1ee9c to\u00e1n h\u1ecdc v\u00e0 code block.</li> <li>[x] Ki\u1ec3m tra ch\u00ednh t\u1ea3 v\u00e0 ng\u1eef ph\u00e1p.</li> <li>[x] \u0110\u1ea3m b\u1ea3o t\u00ednh nh\u1ea5t qu\u00e1n v\u1edbi c\u00e1c thu\u1eadt ng\u1eef \u0111\u00e3 d\u1ecbch kh\u00e1c.</li> </ul>","tags":["Translated"]},{"location":"others/tortoise_and_hare.html","title":"Thu\u1eadt to\u00e1n t\u00ecm chu tr\u00ecnh trong danh s\u00e1ch li\u00ean k\u1ebft c\u1ee7a Floyd (Floyd's Linked List Cycle Finding Algorithm)","text":"<p>Cho m\u1ed9t danh s\u00e1ch li\u00ean k\u1ebft trong \u0111\u00f3 \u0111i\u1ec3m b\u1eaft \u0111\u1ea7u c\u1ee7a danh s\u00e1ch li\u00ean k\u1ebft \u0111\u00f3 \u0111\u01b0\u1ee3c k\u00fd hi\u1ec7u l\u00e0 head, v\u00e0 c\u00f3 th\u1ec3 c\u00f3 ho\u1eb7c kh\u00f4ng c\u00f3 chu tr\u00ecnh. V\u00ed d\u1ee5:</p> <p>\u1ede \u0111\u00e2y ch\u00fang ta c\u1ea7n t\u00ecm \u0111i\u1ec3m C, t\u1ee9c l\u00e0 \u0111i\u1ec3m b\u1eaft \u0111\u1ea7u c\u1ee7a chu tr\u00ecnh.</p>","tags":["Translated"]},{"location":"others/tortoise_and_hare.html#proposed-algorithm","title":"Thu\u1eadt to\u00e1n \u0111\u1ec1 xu\u1ea5t (Proposed algorithm)","text":"<p>Thu\u1eadt to\u00e1n n\u00e0y \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 Thu\u1eadt to\u00e1n chu tr\u00ecnh Floyd (Floyd\u2019s Cycle Algorithm) ho\u1eb7c Thu\u1eadt to\u00e1n R\u00f9a v\u00e0 Th\u1ecf (Tortoise And Hare algorithm). \u0110\u1ec3 t\u00ecm ra \u0111i\u1ec3m b\u1eaft \u0111\u1ea7u c\u1ee7a chu tr\u00ecnh, ch\u00fang ta c\u1ea7n t\u00ecm xem chu tr\u00ecnh c\u00f3 t\u1ed3n t\u1ea1i hay kh\u00f4ng. \u0110i\u1ec1u n\u00e0y bao g\u1ed3m hai b\u01b0\u1edbc: 1. T\u00ecm ra s\u1ef1 hi\u1ec7n di\u1ec7n c\u1ee7a chu tr\u00ecnh. 2. T\u00ecm ra \u0111i\u1ec3m b\u1eaft \u0111\u1ea7u c\u1ee7a chu tr\u00ecnh.</p>","tags":["Translated"]},{"location":"others/tortoise_and_hare.html#step-1-presence-of-the-cycle","title":"B\u01b0\u1edbc 1: S\u1ef1 hi\u1ec7n di\u1ec7n c\u1ee7a chu tr\u00ecnh (Step 1: Presence of the cycle)","text":"<ol> <li>L\u1ea5y hai con tr\u1ecf $slow$ (ch\u1eadm) v\u00e0 $fast$ (nhanh).</li> <li>Ban \u0111\u1ea7u c\u1ea3 hai s\u1ebd tr\u1ecf \u0111\u1ebfn head c\u1ee7a danh s\u00e1ch li\u00ean k\u1ebft.</li> <li>$slow$ s\u1ebd di chuy\u1ec3n t\u1eebng b\u01b0\u1edbc m\u1ed9t.</li> <li>$fast$ s\u1ebd di chuy\u1ec3n hai b\u01b0\u1edbc m\u1ed9t l\u00fac. (t\u1ed1c \u0111\u1ed9 g\u1ea5p \u0111\u00f4i con tr\u1ecf $slow$).</li> <li>Ki\u1ec3m tra xem li\u1ec7u t\u1ea1i b\u1ea5t k\u1ef3 th\u1eddi \u0111i\u1ec3m n\u00e0o ch\u00fang c\u00f3 tr\u1ecf \u0111\u1ebfn c\u00f9ng m\u1ed9t n\u00fat tr\u01b0\u1edbc khi b\u1ea5t k\u1ef3 ai (ho\u1eb7c c\u1ea3 hai) ch\u1ea1m t\u1edbi null hay kh\u00f4ng.</li> <li>N\u1ebfu ch\u00fang tr\u1ecf \u0111\u1ebfn c\u00f9ng m\u1ed9t n\u00fat t\u1ea1i b\u1ea5t k\u1ef3 \u0111i\u1ec3m n\u00e0o trong h\u00e0nh tr\u00ecnh c\u1ee7a ch\u00fang, \u0111i\u1ec1u \u0111\u00f3 cho th\u1ea5y r\u1eb1ng m\u1ed9t chu tr\u00ecnh th\u1ef1c s\u1ef1 t\u1ed3n t\u1ea1i trong danh s\u00e1ch li\u00ean k\u1ebft.</li> <li>N\u1ebfu ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c null, \u0111i\u1ec1u \u0111\u00f3 cho th\u1ea5y danh s\u00e1ch li\u00ean k\u1ebft kh\u00f4ng c\u00f3 chu tr\u00ecnh.</li> </ol> <p>B\u00e2y gi\u1edd ch\u00fang ta \u0111\u00e3 t\u00ecm ra n\u1ebfu c\u00f3 m\u1ed9t chu tr\u00ecnh hi\u1ec7n di\u1ec7n trong danh s\u00e1ch li\u00ean k\u1ebft, b\u01b0\u1edbc ti\u1ebfp theo ch\u00fang ta c\u1ea7n t\u00ecm ra \u0111i\u1ec3m b\u1eaft \u0111\u1ea7u c\u1ee7a chu tr\u00ecnh, t\u1ee9c l\u00e0 C.</p>","tags":["Translated"]},{"location":"others/tortoise_and_hare.html#step-2-starting-point-of-the-cycle","title":"B\u01b0\u1edbc 2: \u0110i\u1ec3m b\u1eaft \u0111\u1ea7u c\u1ee7a chu tr\u00ecnh (Step 2: Starting point of the cycle)","text":"<ol> <li>\u0110\u1eb7t l\u1ea1i con tr\u1ecf $slow$ v\u1ec1 head c\u1ee7a danh s\u00e1ch li\u00ean k\u1ebft.</li> <li>Di chuy\u1ec3n c\u1ea3 hai con tr\u1ecf t\u1eebng b\u01b0\u1edbc m\u1ed9t.</li> <li>\u0110i\u1ec3m m\u00e0 ch\u00fang g\u1eb7p nhau s\u1ebd l\u00e0 \u0111i\u1ec3m b\u1eaft \u0111\u1ea7u c\u1ee7a chu tr\u00ecnh.</li> </ol> <pre><code>// Presence of cycle\npublic boolean hasCycle(ListNode head) {\n    ListNode slow = head;\n    ListNode fast = head;\n\n    while(fast != null &amp;&amp; fast.next != null){\n        slow = slow.next;\n        fast = fast.next.next;\n        if(slow==fast){\n            return true;\n        }\n    }\n\n    return false;\n}\n</code></pre> <pre><code>// Assuming there is a cycle present and slow and fast are point to their meeting point\nslow = head;\nwhile(slow!=fast){\n    slow = slow.next;\n    fast = fast.next;\n}\n\nreturn slow; // the starting point of the cycle.\n</code></pre>","tags":["Translated"]},{"location":"others/tortoise_and_hare.html#why-does-it-work","title":"T\u1ea1i sao n\u00f3 ho\u1ea1t \u0111\u1ed9ng (Why does it work)","text":"","tags":["Translated"]},{"location":"others/tortoise_and_hare.html#step-1-presence-of-the-cycle_1","title":"B\u01b0\u1edbc 1: S\u1ef1 hi\u1ec7n di\u1ec7n c\u1ee7a chu tr\u00ecnh (Step 1: Presence of the cycle)","text":"<p>V\u00ec con tr\u1ecf $fast$ di chuy\u1ec3n v\u1edbi t\u1ed1c \u0111\u1ed9 g\u1ea5p \u0111\u00f4i $slow$, ch\u00fang ta c\u00f3 th\u1ec3 n\u00f3i r\u1eb1ng t\u1ea1i b\u1ea5t k\u1ef3 th\u1eddi \u0111i\u1ec3m n\u00e0o, $fast$ s\u1ebd \u0111i \u0111\u01b0\u1ee3c qu\u00e3ng \u0111\u01b0\u1eddng g\u1ea5p \u0111\u00f4i $slow$. Ch\u00fang ta c\u0169ng c\u00f3 th\u1ec3 suy ra r\u1eb1ng s\u1ef1 kh\u00e1c bi\u1ec7t gi\u1eefa kho\u1ea3ng c\u00e1ch \u0111i \u0111\u01b0\u1ee3c c\u1ee7a c\u1ea3 hai con tr\u1ecf n\u00e0y \u0111ang t\u0103ng l\u00ean $1$. <pre><code>slow: 0 --&gt; 1 --&gt; 2 --&gt; 3 --&gt; 4 (distance covered)\nfast: 0 --&gt; 2 --&gt; 4 --&gt; 6 --&gt; 8 (distance covered)\ndiff: 0 --&gt; 1 --&gt; 2 --&gt; 3 --&gt; 4 (difference between distance covered by both pointers)\n</code></pre> G\u1ecdi $L$ bi\u1ec3u th\u1ecb \u0111\u1ed9 d\u00e0i c\u1ee7a chu tr\u00ecnh v\u00e0 $a$ \u0111\u1ea1i di\u1ec7n cho s\u1ed1 b\u01b0\u1edbc c\u1ea7n thi\u1ebft \u0111\u1ec3 con tr\u1ecf ch\u1eadm \u0111\u1ebfn \u0111\u01b0\u1ee3c l\u1ed1i v\u00e0o c\u1ee7a chu tr\u00ecnh. T\u1ed3n t\u1ea1i m\u1ed9t s\u1ed1 nguy\u00ean d\u01b0\u01a1ng $k$ ($k &gt; 0$) sao cho $k \\cdot L \\geq a$. Khi con tr\u1ecf ch\u1eadm \u0111\u00e3 di chuy\u1ec3n $k \\cdot L$ b\u01b0\u1edbc, v\u00e0 con tr\u1ecf nhanh \u0111\u00e3 \u0111i \u0111\u01b0\u1ee3c $2 \\cdot k \\cdot L$ b\u01b0\u1edbc, c\u1ea3 hai con tr\u1ecf \u0111\u1ec1u th\u1ea5y m\u00ecnh n\u1eb1m trong chu tr\u00ecnh. T\u1ea1i th\u1eddi \u0111i\u1ec3m n\u00e0y, c\u00f3 s\u1ef1 ph\u00e2n t\u00e1ch $k \\cdot L$ gi\u1eefa ch\u00fang. Cho r\u1eb1ng \u0111\u1ed9 d\u00e0i c\u1ee7a chu tr\u00ecnh v\u1eabn l\u00e0 $L$, \u0111i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 ch\u00fang g\u1eb7p nhau t\u1ea1i c\u00f9ng m\u1ed9t \u0111i\u1ec3m trong chu tr\u00ecnh, d\u1eabn \u0111\u1ebfn cu\u1ed9c g\u1eb7p g\u1ee1 c\u1ee7a ch\u00fang.</p>","tags":["Translated"]},{"location":"others/tortoise_and_hare.html#step-2-starting-point-of-the-cycle_1","title":"B\u01b0\u1edbc 2: \u0110i\u1ec3m b\u1eaft \u0111\u1ea7u c\u1ee7a chu tr\u00ecnh (Step 2: Starting point of the cycle)","text":"<p>H\u00e3y th\u1eed t\u00ednh kho\u1ea3ng c\u00e1ch \u0111i \u0111\u01b0\u1ee3c c\u1ee7a c\u1ea3 hai con tr\u1ecf cho \u0111\u1ebfn khi ch\u00fang g\u1eb7p nhau trong chu tr\u00ecnh.</p> <p>$slowDist = a + xL + b$            , $x\\ge0$</p> <p>$fastDist = a + yL + b$            , $y\\ge0$</p> <ul> <li>$slowDist$ l\u00e0 t\u1ed5ng kho\u1ea3ng c\u00e1ch \u0111i \u0111\u01b0\u1ee3c b\u1edfi con tr\u1ecf ch\u1eadm.</li> <li>$fastDist$ l\u00e0 t\u1ed5ng kho\u1ea3ng c\u00e1ch \u0111i \u0111\u01b0\u1ee3c b\u1edfi con tr\u1ecf nhanh.</li> <li>$a$ l\u00e0 s\u1ed1 b\u01b0\u1edbc m\u00e0 c\u1ea3 hai con tr\u1ecf c\u1ea7n th\u1ef1c hi\u1ec7n \u0111\u1ec3 v\u00e0o chu tr\u00ecnh.</li> <li>$b$ l\u00e0 kho\u1ea3ng c\u00e1ch gi\u1eefa C v\u00e0 G, t\u1ee9c l\u00e0 kho\u1ea3ng c\u00e1ch gi\u1eefa \u0111i\u1ec3m b\u1eaft \u0111\u1ea7u c\u1ee7a chu tr\u00ecnh v\u00e0 \u0111i\u1ec3m g\u1eb7p nhau c\u1ee7a c\u1ea3 hai con tr\u1ecf.</li> <li>$x$ l\u00e0 s\u1ed1 l\u1ea7n con tr\u1ecf ch\u1eadm \u0111\u00e3 l\u1eb7p b\u00ean trong chu tr\u00ecnh, b\u1eaft \u0111\u1ea7u t\u1eeb v\u00e0 k\u1ebft th\u00fac t\u1ea1i C.</li> <li>$y$ l\u00e0 s\u1ed1 l\u1ea7n con tr\u1ecf nhanh \u0111\u00e3 l\u1eb7p b\u00ean trong chu tr\u00ecnh, b\u1eaft \u0111\u1ea7u t\u1eeb v\u00e0 k\u1ebft th\u00fac t\u1ea1i C.</li> </ul> <p>$fastDist = 2 \\cdot (slowDist)$</p> <p>$a + yL + b = 2(a + xL + b)$</p> <p>Gi\u1ea3i quy\u1ebft c\u00f4ng th\u1ee9c ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c:</p> <p>$a=(y-2x)L-b$</p> <p>trong \u0111\u00f3 $y-2x$ l\u00e0 m\u1ed9t s\u1ed1 nguy\u00ean</p> <p>V\u1ec1 c\u01a1 b\u1ea3n, \u0111i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 $a$ b\u01b0\u1edbc gi\u1ed1ng nh\u01b0 th\u1ef1c hi\u1ec7n m\u1ed9t s\u1ed1 v\u00f2ng l\u1eb7p \u0111\u1ea7y \u0111\u1ee7 trong chu tr\u00ecnh v\u00e0 \u0111i ng\u01b0\u1ee3c l\u1ea1i $b$ b\u01b0\u1edbc. V\u00ec con tr\u1ecf nhanh \u0111\u00e3 \u0111i tr\u01b0\u1edbc $b$ b\u01b0\u1edbc so v\u1edbi l\u1ed1i v\u00e0o c\u1ee7a chu tr\u00ecnh, n\u1ebfu con tr\u1ecf nhanh di chuy\u1ec3n th\u00eam $a$ b\u01b0\u1edbc n\u1eefa, n\u00f3 s\u1ebd k\u1ebft th\u00fac t\u1ea1i l\u1ed1i v\u00e0o c\u1ee7a chu tr\u00ecnh. V\u00e0 v\u00ec ch\u00fang ta \u0111\u1ec3 con tr\u1ecf ch\u1eadm b\u1eaft \u0111\u1ea7u t\u1eeb \u0111\u1ea7u danh s\u00e1ch li\u00ean k\u1ebft, sau $a$ b\u01b0\u1edbc, n\u00f3 c\u0169ng s\u1ebd k\u1ebft th\u00fac t\u1ea1i l\u1ed1i v\u00e0o chu tr\u00ecnh. V\u00ec v\u1eady, n\u1ebfu c\u1ea3 hai di chuy\u1ec3n $a$ b\u01b0\u1edbc, c\u1ea3 hai s\u1ebd g\u1eb7p l\u1ed1i v\u00e0o c\u1ee7a chu tr\u00ecnh.</p>","tags":["Translated"]},{"location":"others/tortoise_and_hare.html#problems","title":"B\u00e0i t\u1eadp (Problems)","text":"<ul> <li>Linked List Cycle (EASY)</li> <li>Happy Number (Easy)</li> <li>Find the Duplicate Number (Medium)</li> </ul>","tags":["Translated"]},{"location":"others/tortoise_and_hare.html#checklist","title":"Checklist","text":"<ul> <li>[x] D\u1ecbch c\u00e1c kh\u00e1i ni\u1ec7m k\u1ef9 thu\u1eadt sang ti\u1ebfng Vi\u1ec7t ch\u00ednh x\u00e1c.</li> <li>[x] \u0110\u00e3 c\u1eadp nh\u1eadt c\u00e1c li\u00ean k\u1ebft n\u1ed9i b\u1ed9 (\u0111\u1ebfn 127.0.0.1:8000).</li> <li>[x] \u0110\u1ecbnh d\u1ea1ng l\u1ea1i c\u00e1c c\u00f4ng th\u1ee9c to\u00e1n h\u1ecdc v\u00e0 code block.</li> <li>[x] Ki\u1ec3m tra ch\u00ednh t\u1ea3 v\u00e0 ng\u1eef ph\u00e1p.</li> <li>[x] \u0110\u1ea3m b\u1ea3o t\u00ednh nh\u1ea5t qu\u00e1n v\u1edbi c\u00e1c thu\u1eadt ng\u1eef \u0111\u00e3 d\u1ecbch kh\u00e1c.</li> </ul>","tags":["Translated"]},{"location":"schedules/schedule-with-completion-duration.html","title":"L\u1eadp l\u1ecbch c\u00f4ng vi\u1ec7c tr\u00ean m\u1ed9t m\u00e1y v\u1edbi th\u1eddi gian ho\u00e0n th\u00e0nh v\u00e0 th\u1eddi gian th\u1ef1c hi\u1ec7n kh\u00e1c nhau (Scheduling jobs on one machine with different completion times and execution times)","text":"<p>Ch\u00fang ta c\u00f3 $n$ c\u00f4ng vi\u1ec7c. M\u1ed7i c\u00f4ng vi\u1ec7c $i$ \u0111\u01b0\u1ee3c \u0111\u1eb7c tr\u01b0ng b\u1edfi th\u1eddi gian th\u1ef1c hi\u1ec7n $t_i$ v\u00e0 th\u1eddi gian ho\u00e0n th\u00e0nh $l_i$. Ch\u00fang ta c\u00f3 m\u1ed9t m\u00e1y \u0111\u1ec3 x\u1eed l\u00fd c\u00e1c c\u00f4ng vi\u1ec7c n\u00e0y v\u00e0 m\u00e1y n\u00e0y ch\u1ec9 c\u00f3 th\u1ec3 x\u1eed l\u00fd m\u1ed9t c\u00f4ng vi\u1ec7c t\u1ea1i m\u1ed9t th\u1eddi \u0111i\u1ec3m (k\u1ebft th\u00fac c\u00f4ng vi\u1ec7c n\u00e0y r\u1ed3i m\u1edbi b\u1eaft \u0111\u1ea7u c\u00f4ng vi\u1ec7c kh\u00e1c). Vi\u1ec7c th\u1ef1c hi\u1ec7n c\u00f4ng vi\u1ec7c $j$ bao g\u1ed3m hai ph\u1ea7n: \u0111\u1ea7u ti\u00ean m\u00e1y x\u1eed l\u00fd n\u00f3 trong th\u1eddi gian $t_j$, sau \u0111\u00f3, ngay sau khi x\u1eed l\u00fd xong, c\u00f4ng vi\u1ec7c $j$ ti\u1ebfp t\u1ee5c \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong $l_j$ th\u1eddi gian \"m\u1ed9t c\u00e1ch \u0111\u1ed9c l\u1eadp\" (kh\u00f4ng c\u1ea7n m\u00e1y). (V\u00ed d\u1ee5: ch\u00fang ta c\u00f3 m\u1ed9t s\u1ed1 b\u1ed9 ph\u1eadn b\u1eb1ng kim lo\u1ea1i \u0111\u01b0\u1ee3c \u0111\u00fac tr\u00ean m\u00e1y, v\u00e0 sau khi \u0111\u00fac, ch\u00fang c\u1ea7n \u0111\u01b0\u1ee3c l\u00e0m ngu\u1ed9i).</p> <p>Ch\u00fang ta mu\u1ed1n t\u00ecm m\u1ed9t l\u1ecbch tr\u00ecnh th\u1ef1c hi\u1ec7n c\u00e1c c\u00f4ng vi\u1ec7c tr\u00ean m\u00e1y sao cho th\u1eddi gian tr\u00f4i qua \u0111\u1ec3 t\u1ea5t c\u1ea3 c\u00e1c c\u00f4ng vi\u1ec7c \u0111\u01b0\u1ee3c ho\u00e0n th\u00e0nh ho\u00e0n to\u00e0n (c\u1ea3 hai ph\u1ea7n c\u1ee7a m\u1ed7i c\u00f4ng vi\u1ec7c \u0111\u1ec1u xong) l\u00e0 t\u1ed1i thi\u1ec3u.</p>","tags":["Translated"]},{"location":"schedules/schedule-with-completion-duration.html#solution","title":"Gi\u1ea3i ph\u00e1p (Solution)","text":"<p>Th\u1eddi gian ho\u00e0n th\u00e0nh cho m\u1ed9t c\u00f4ng vi\u1ec7c th\u1ee9 $i$ \u0111\u01b0\u1ee3c t\u00ednh b\u1eb1ng t\u1ed5ng th\u1eddi gian th\u1ef1c hi\u1ec7n c\u1ee7a n\u00f3 v\u00e0 t\u1ea5t c\u1ea3 c\u00e1c c\u00f4ng vi\u1ec7c \u0111\u01b0\u1ee3c l\u00ean l\u1ecbch tr\u01b0\u1edbc n\u00f3, c\u1ed9ng v\u1edbi th\u1eddi gian ho\u00e0n th\u00e0nh c\u1ee7a n\u00f3 $l_i$. G\u1ecdi $p$ l\u00e0 m\u1ed9t ho\u00e1n v\u1ecb c\u1ee7a c\u00e1c ch\u1ec9 s\u1ed1 (indexes) m\u00f4 t\u1ea3 l\u1ecbch tr\u00ecnh d\u1ef1 ki\u1ebfn. Khi \u0111\u00f3 th\u1eddi gian \u0111\u1ec3 c\u00f4ng vi\u1ec7c $p_i$ \u0111\u01b0\u1ee3c ho\u00e0n th\u00e0nh l\u00e0:</p> $$ ans_i = \\left( \\sum_{j=1}^i t_{p_j} \\right) + l_{p_i} $$ <p>V\u00e0 ch\u00fang ta mu\u1ed1n gi\u1ea3m thi\u1ec3u gi\u00e1 tr\u1ecb t\u1ed1i \u0111a c\u1ee7a $ans_i$:</p> $$ \\min_p \\max_{i=1 \\dots n} ans_i $$ <p>D\u1ec5 th\u1ea5y r\u1eb1ng th\u1eddi gian ho\u00e0n th\u00e0nh $l_{p_i}$ \u0111\u00f3ng vai tr\u00f2 quan tr\u1ecdng trong bi\u1ec3u th\u1ee9c n\u00e0y: ph\u1ea7n t\u1ed5ng $\\sum t_{p_j}$ gi\u1ed1ng nhau cho t\u1ea5t c\u1ea3 c\u00e1c c\u00f4ng vi\u1ec7c t\u1ea1i v\u1ecb tr\u00ed $i$ v\u00e0 c\u00e1c v\u1ecb tr\u00ed sau \u0111\u00f3, nh\u01b0ng $l_{p_i}$ ch\u1ec9 \u1ea3nh h\u01b0\u1edfng \u0111\u1ebfn ch\u00ednh c\u00f4ng vi\u1ec7c $p_i$. \u0110\u01b0\u1eddng nh\u01b0 ch\u00fang ta n\u00ean \u0111\u1eb7t c\u00e1c c\u00f4ng vi\u1ec7c c\u00f3 $l_i$ l\u1edbn \u1edf \u0111\u1ea7u l\u1ecbch tr\u00ecnh, \u0111\u1ec3 ch\u00fang c\u00f3 th\u1ec3 ho\u00e0n th\u00e0nh ph\u1ea7n \u0111\u1ed9c l\u1eadp c\u1ee7a m\u00ecnh trong khi m\u00e1y \u0111ang b\u1eadn x\u1eed l\u00fd c\u00e1c c\u00f4ng vi\u1ec7c kh\u00e1c.</p> <p>Th\u1eadt v\u1eady, \u0111\u00e2y l\u00e0 chi\u1ebfn l\u01b0\u1ee3c t\u1ed1i \u01b0u: ch\u00fang ta n\u00ean s\u1eafp x\u1ebfp c\u00e1c c\u00f4ng vi\u1ec7c theo th\u1ee9 t\u1ef1 gi\u1ea3m d\u1ea7n c\u1ee7a $l_i$ v\u00e0 th\u1ef1c hi\u1ec7n ch\u00fang theo th\u1ee9 t\u1ef1 \u0111\u00f3.</p> <p>Ch\u00fang ta c\u00f3 th\u1ec3 ch\u1ee9ng minh t\u00ednh t\u1ed1i \u01b0u c\u1ee7a gi\u1ea3i ph\u00e1p n\u00e0y b\u1eb1ng ph\u01b0\u01a1ng ph\u00e1p ho\u00e1n \u0111\u1ed5i (exchange argument); h\u00e3y xem ph\u1ea7n ti\u1ebfp theo \u0111\u1ec3 bi\u1ebft ch\u1ee9ng minh chung cho c\u00e1c v\u1ea5n \u0111\u1ec1 l\u1eadp l\u1ecbch tr\u00ecnh thu\u1ed9c lo\u1ea1i n\u00e0y.</p>","tags":["Translated"]},{"location":"schedules/schedule-with-completion-duration.html#checklist","title":"Checklist","text":"<ul> <li>[x] D\u1ecbch c\u00e1c kh\u00e1i ni\u1ec7m k\u1ef9 thu\u1eadt sang ti\u1ebfng Vi\u1ec7t ch\u00ednh x\u00e1c.</li> <li>[x] \u0110\u00e3 c\u1eadp nh\u1eadt c\u00e1c li\u00ean k\u1ebft n\u1ed9i b\u1ed9 (\u0111\u1ebfn 127.0.0.1:8000).</li> <li>[x] \u0110\u1ecbnh d\u1ea1ng l\u1ea1i c\u00e1c c\u00f4ng th\u1ee9c to\u00e1n h\u1ecdc v\u00e0 code block.</li> <li>[x] Ki\u1ec3m tra ch\u00ednh t\u1ea3 v\u00e0 ng\u1eef ph\u00e1p.</li> <li>[x] \u0110\u1ea3m b\u1ea3o t\u00ednh nh\u1ea5t qu\u00e1n v\u1edbi c\u00e1c thu\u1eadt ng\u1eef \u0111\u00e3 d\u1ecbch kh\u00e1c.</li> </ul>","tags":["Translated"]},{"location":"schedules/schedule_one_machine.html","title":"L\u1eadp l\u1ecbch c\u00e1c c\u00f4ng vi\u1ec7c tr\u00ean m\u1ed9t m\u00e1y (Scheduling jobs on one machine)","text":"<p>Ch\u00fang ta c\u00f3 m\u1ed9t t\u1eadp h\u1ee3p c\u00e1c c\u00f4ng vi\u1ec7c v\u00e0 m\u1ed9t m\u00e1y c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n t\u1ea5t c\u1ea3 c\u00e1c c\u00f4ng vi\u1ec7c \u0111\u00f3. Ch\u00fang ta \u0111\u01b0\u1ee3c cho m\u1ed9t h\u00e0m m\u1ee5c ti\u00eau m\u00e0 ch\u00fang ta mu\u1ed1n t\u1ed1i thi\u1ec3u h\u00f3a. C\u00e1c ti\u00eau ch\u00ed ph\u1ed5 bi\u1ebfn nh\u1ea5t l\u00e0:</p> <ul> <li>T\u1ed1i thi\u1ec3u h\u00f3a t\u1ed5ng th\u1eddi gian ho\u00e0n th\u00e0nh $\\sum C_i$ trong \u0111\u00f3 $C_i$ l\u00e0 th\u1eddi gian ho\u00e0n th\u00e0nh c\u1ee7a c\u00f4ng vi\u1ec7c $i$.</li> <li>T\u1ed1i thi\u1ec3u h\u00f3a t\u1ed5ng th\u1eddi gian ho\u00e0n th\u00e0nh c\u00f3 tr\u1ecdng s\u1ed1 $\\sum w_i C_i$ trong \u0111\u00f3 $w_i$ l\u00e0 \u0111\u1ed9 \u01b0u ti\u00ean c\u1ee7a c\u00f4ng vi\u1ec7c $i$.</li> <li>T\u1ed1i thi\u1ec3u h\u00f3a th\u1eddi gian ho\u00e0n th\u00e0nh t\u1ed1i \u0111a $\\max C_i$ (makespan).</li> <li>T\u1ed1i thi\u1ec3u h\u00f3a \u0111\u1ed9 tr\u1ec5 t\u1ed1i \u0111a $L_{max} = \\max (C_i - d_i)$, trong \u0111\u00f3 $d_i$ l\u00e0 th\u1eddi h\u1ea1n (deadline) c\u1ee7a c\u00f4ng vi\u1ec7c $i$.</li> </ul> <p>\u1ede \u0111\u00e2y $C_i$ l\u00e0 th\u1eddi gian m\u00e0 t\u1ea1i \u0111\u00f3 vi\u1ec7c x\u1eed l\u00fd c\u00f4ng vi\u1ec7c $i$ \u0111\u00e3 k\u1ebft th\u00fac.</p>","tags":["Translated"]},{"location":"schedules/schedule_one_machine.html#total-completion-time","title":"T\u1ed5ng th\u1eddi gian ho\u00e0n th\u00e0nh (Total completion time)","text":"<p>Ch\u00fang ta c\u00f3 $n$ c\u00f4ng vi\u1ec7c v\u1edbi th\u1eddi gian x\u1eed l\u00fd $t_1, \\dots, t_n$. Ch\u00fang ta mu\u1ed1n t\u1ed1i thi\u1ec3u h\u00f3a $\\sum C_i$.</p> <p>\u0110\u1ec3 gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 n\u00e0y, h\u00e3y xem x\u00e9t tr\u01b0\u1eddng h\u1ee3p hai c\u00f4ng vi\u1ec7c. N\u1ebfu ch\u00fang ta th\u1ef1c hi\u1ec7n c\u00f4ng vi\u1ec7c \u0111\u1ea7u ti\u00ean tr\u01b0\u1edbc, th\u00ec $C_1 = t_1$ v\u00e0 $C_2 = t_1 + t_2$. T\u1ed5ng th\u1eddi gian ho\u00e0n th\u00e0nh l\u00e0 $2 t_1 + t_2$. N\u1ebfu ch\u00fang ta th\u1ef1c hi\u1ec7n c\u00f4ng vi\u1ec7c th\u1ee9 hai tr\u01b0\u1edbc, th\u00ec $C_2 = t_2$ v\u00e0 $C_1 = t_1 + t_2$. T\u1ed5ng th\u1eddi gian ho\u00e0n th\u00e0nh l\u00e0 $2 t_2 + t_1$.</p> <p>R\u00f5 r\u00e0ng l\u00e0 t\u1ed1t h\u01a1n n\u00ean ch\u1ecdn c\u00f4ng vi\u1ec7c c\u00f3 th\u1eddi gian x\u1eed l\u00fd nh\u1ecf h\u01a1n tr\u01b0\u1edbc. M\u1edf r\u1ed9ng cho $n$ c\u00f4ng vi\u1ec7c, ch\u00fang ta c\u00f3 th\u1ec3 th\u1ea5y r\u1eb1ng th\u1ee9 t\u1ef1 t\u1ed1i \u01b0u \u0111\u1ea1t \u0111\u01b0\u1ee3c b\u1eb1ng c\u00e1ch s\u1eafp x\u1ebfp c\u00e1c c\u00f4ng vi\u1ec7c theo $t_i$ kh\u00f4ng gi\u1ea3m.</p>","tags":["Translated"]},{"location":"schedules/schedule_one_machine.html#weighted-total-completion-time","title":"T\u1ed5ng th\u1eddi gian ho\u00e0n th\u00e0nh c\u00f3 tr\u1ecdng s\u1ed1 (Weighted total completion time)","text":"<p>Ch\u00fang ta c\u00f3 $n$ c\u00f4ng vi\u1ec7c v\u1edbi th\u1eddi gian x\u1eed l\u00fd $t_1, \\dots, t_n$ v\u00e0 tr\u1ecdng s\u1ed1 $w_1, \\dots, w_n$. Ch\u00fang ta mu\u1ed1n t\u1ed1i thi\u1ec3u h\u00f3a $\\sum w_i C_i$.</p> <p>H\u00e3y xem x\u00e9t l\u1ea1i tr\u01b0\u1eddng h\u1ee3p hai c\u00f4ng vi\u1ec7c. N\u1ebfu ch\u00fang ta th\u1ef1c hi\u1ec7n c\u00f4ng vi\u1ec7c \u0111\u1ea7u ti\u00ean tr\u01b0\u1edbc, th\u00ec chi ph\u00ed l\u00e0 $w_1 t_1 + w_2 (t_1 + t_2) = (w_1 + w_2) t_1 + w_2 t_2$. N\u1ebfu ch\u00fang ta th\u1ef1c hi\u1ec7n c\u00f4ng vi\u1ec7c th\u1ee9 hai tr\u01b0\u1edbc, th\u00ec chi ph\u00ed l\u00e0 $w_2 t_2 + w_1 (t_1 + t_2) = (w_1 + w_2) t_2 + w_1 t_1$.</p> <p>L\u1ecbch tr\u00ecnh \u0111\u1ea7u ti\u00ean t\u1ed1t h\u01a1n n\u1ebfu $$(w_1 + w_2) t_1 + w_2 t_2 &lt; (w_1 + w_2) t_2 + w_1 t_1$$ $$\\iff w_2 t_1 &lt; w_1 t_2$$ $$\\iff \\frac{t_1}{w_1} &lt; \\frac{t_2}{w_2}$$</p> <p>Do \u0111\u00f3, \u0111\u1ed1i v\u1edbi b\u1ea5t k\u1ef3 s\u1ed1 l\u01b0\u1ee3ng c\u00f4ng vi\u1ec7c n\u00e0o, th\u1ee9 t\u1ef1 t\u1ed1i \u01b0u \u0111\u1ea1t \u0111\u01b0\u1ee3c b\u1eb1ng c\u00e1ch s\u1eafp x\u1ebfp c\u00e1c c\u00f4ng vi\u1ec7c theo t\u1ef7 l\u1ec7 $\\frac{t_i}{w_i}$ kh\u00f4ng gi\u1ea3m.</p>","tags":["Translated"]},{"location":"schedules/schedule_one_machine.html#maximum-completion-time","title":"Th\u1eddi gian ho\u00e0n th\u00e0nh t\u1ed1i \u0111a (Maximum completion time)","text":"<p>B\u1ea5t k\u1ec3 th\u1ee9 t\u1ef1 th\u1ef1c hi\u1ec7n c\u00e1c c\u00f4ng vi\u1ec7c nh\u01b0 th\u1ebf n\u00e0o, th\u1eddi gian ho\u00e0n th\u00e0nh t\u1ed1i \u0111a s\u1ebd lu\u00f4n l\u00e0 $\\sum t_i$. Do \u0111\u00f3, b\u1ea5t k\u1ef3 th\u1ee9 t\u1ef1 n\u00e0o c\u0169ng l\u00e0 t\u1ed1i \u01b0u.</p>","tags":["Translated"]},{"location":"schedules/schedule_one_machine.html#maximum-lateness","title":"\u0110\u1ed9 tr\u1ec5 t\u1ed1i \u0111a (Maximum lateness)","text":"<p>Ch\u00fang ta c\u00f3 $n$ c\u00f4ng vi\u1ec7c v\u1edbi th\u1eddi gian x\u1eed l\u00fd $t_1, \\dots, t_n$ v\u00e0 th\u1eddi h\u1ea1n $d_1, \\dots, d_n$. Ch\u00fang ta mu\u1ed1n t\u1ed1i thi\u1ec3u h\u00f3a $L_{max} = \\max (C_i - d_i)$.</p> <p>\u0110\u1ed1i v\u1edbi b\u00e0i to\u00e1n n\u00e0y, th\u1ee9 t\u1ef1 t\u1ed1i \u01b0u \u0111\u1ea1t \u0111\u01b0\u1ee3c b\u1eb1ng c\u00e1ch s\u1eafp x\u1ebfp c\u00e1c c\u00f4ng vi\u1ec7c theo th\u1eddi h\u1ea1n $d_i$ kh\u00f4ng gi\u1ea3m. Thu\u1eadt to\u00e1n n\u00e0y \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 Quy t\u1eafc Earliest Due Date (EDD).</p> <p>H\u00e3y ch\u1ee9ng minh \u0111i\u1ec1u n\u00e0y b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng ph\u01b0\u01a1ng ph\u00e1p ho\u00e1n \u0111\u1ed5i (exchange argument) (\u0111\u00e2y l\u00e0 k\u1ef9 thu\u1eadt ch\u1ee9ng minh ti\u00eau chu\u1ea9n cho c\u00e1c thu\u1eadt to\u00e1n tham lam). Gi\u1ea3 s\u1eed ch\u00fang ta c\u00f3 m\u1ed9t l\u1ecbch tr\u00ecnh t\u1ed1i \u01b0u kh\u00f4ng tu\u00e2n theo quy t\u1eafc EDD. Khi \u0111\u00f3, ph\u1ea3i t\u1ed3n t\u1ea1i hai c\u00f4ng vi\u1ec7c li\u00ean ti\u1ebfp $i$ v\u00e0 $j$ sao cho $d_i &gt; d_j$, nh\u01b0ng c\u00f4ng vi\u1ec7c $i$ \u0111\u01b0\u1ee3c l\u00ean l\u1ecbch tr\u01b0\u1edbc c\u00f4ng vi\u1ec7c $j$. H\u00e3y ho\u00e1n \u0111\u1ed5i hai c\u00f4ng vi\u1ec7c n\u00e0y v\u00e0 xem \u0111i\u1ec1u g\u00ec s\u1ebd x\u1ea3y ra v\u1edbi \u0111\u1ed9 tr\u1ec5 t\u1ed1i \u0111a.</p> <p>G\u1ecdi $t$ l\u00e0 th\u1eddi \u0111i\u1ec3m b\u1eaft \u0111\u1ea7u x\u1eed l\u00fd c\u00f4ng vi\u1ec7c $i$ trong l\u1ecbch tr\u00ecnh ban \u0111\u1ea7u. Trong l\u1ecbch tr\u00ecnh ban \u0111\u1ea7u: $C_i = t + t_i$ $C_j = t + t_i + t_j$ $L_i = C_i - d_i$ $L_j = C_j - d_j$ \u0110\u1ed9 tr\u1ec5 t\u1ed1i \u0111a c\u1ee5c b\u1ed9 $L = \\max(L_i, L_j)$.</p> <p>Sau khi ho\u00e1n \u0111\u1ed5i: $C'_j = t + t_j$ $C'_i = t + t_j + t_i$ $L'_j = C'_j - d_j$ $L'_i = C'_i - d_i$ \u0110\u1ed9 tr\u1ec5 t\u1ed1i \u0111a c\u1ee5c b\u1ed9 $L' = \\max(L'_j, L'_i)$.</p> <p>B\u00e2y gi\u1edd ch\u00fang ta c\u1ea7n ch\u1ee9ng minh $L' \\le L$. R\u00f5 r\u00e0ng l\u00e0 $C'_j &lt; C_i &lt; C_j = C'_i$. T\u1eeb $C'_j &lt; C_j$ suy ra $L'_j &lt; L_j \\le L$. B\u00e2y gi\u1edd ch\u00fang ta c\u1ea7n so s\u00e1nh $L'_i$ v\u1edbi $L$. $L'_i = C'_i - d_i = C_j - d_i$. V\u00ec $d_i &gt; d_j$, ch\u00fang ta c\u00f3 $C_j - d_i &lt; C_j - d_j = L_j \\le L$. V\u00ec v\u1eady, c\u1ea3 $L'_j$ v\u00e0 $L'_i$ \u0111\u1ec1u nh\u1ecf h\u01a1n ho\u1eb7c b\u1eb1ng $L$, \u0111i\u1ec1u \u0111\u00f3 c\u00f3 ngh\u0129a l\u00e0 $L' \\le L$.</p> <p>\u0110i\u1ec1u n\u00e0y ng\u1ee5 \u00fd r\u1eb1ng vi\u1ec7c ho\u00e1n \u0111\u1ed5i kh\u00f4ng l\u00e0m t\u0103ng \u0111\u1ed9 tr\u1ec5 t\u1ed1i \u0111a. B\u1eb1ng c\u00e1ch l\u1eb7p l\u1ea1i th\u1ef1c hi\u1ec7n c\u00e1c ho\u00e1n \u0111\u1ed5i nh\u01b0 v\u1eady, ch\u00fang ta c\u00f3 th\u1ec3 chuy\u1ec3n b\u1ea5t k\u1ef3 l\u1ecbch tr\u00ecnh t\u1ed1i \u01b0u n\u00e0o th\u00e0nh l\u1ecbch tr\u00ecnh \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp theo EDD m\u00e0 kh\u00f4ng l\u00e0m gi\u1ea3m ch\u1ea5t l\u01b0\u1ee3ng gi\u1ea3i ph\u00e1p.</p>","tags":["Translated"]},{"location":"schedules/schedule_one_machine.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice problems)","text":"<ul> <li>CSES : Tasks and Deadlines</li> </ul>","tags":["Translated"]},{"location":"schedules/schedule_one_machine.html#checklist","title":"Checklist","text":"<ul> <li>[x] D\u1ecbch c\u00e1c kh\u00e1i ni\u1ec7m k\u1ef9 thu\u1eadt sang ti\u1ebfng Vi\u1ec7t ch\u00ednh x\u00e1c.</li> <li>[x] \u0110\u00e3 c\u1eadp nh\u1eadt c\u00e1c li\u00ean k\u1ebft n\u1ed9i b\u1ed9 (\u0111\u1ebfn 127.0.0.1:8000).</li> <li>[x] \u0110\u1ecbnh d\u1ea1ng l\u1ea1i c\u00e1c c\u00f4ng th\u1ee9c to\u00e1n h\u1ecdc v\u00e0 code block.</li> <li>[x] Ki\u1ec3m tra ch\u00ednh t\u1ea3 v\u00e0 ng\u1eef ph\u00e1p.</li> <li>[x] \u0110\u1ea3m b\u1ea3o t\u00ednh nh\u1ea5t qu\u00e1n v\u1edbi c\u00e1c thu\u1eadt ng\u1eef \u0111\u00e3 d\u1ecbch kh\u00e1c.</li> </ul>","tags":["Translated"]},{"location":"schedules/schedule_two_machines.html","title":"L\u1eadp l\u1ecbch c\u00e1c c\u00f4ng vi\u1ec7c tr\u00ean hai m\u00e1y (Johnson's Rule) (Scheduling jobs on two machines (Johnson's Rule))","text":"<p>Ch\u00fang ta c\u00f3 $n$ c\u00f4ng vi\u1ec7c. M\u1ed7i c\u00f4ng vi\u1ec7c g\u1ed3m hai ph\u1ea7n: ph\u1ea7n \u0111\u1ea7u ti\u00ean \u0111\u01b0\u1ee3c x\u1eed l\u00fd tr\u00ean m\u00e1y th\u1ee9 nh\u1ea5t v\u00e0 ph\u1ea7n th\u1ee9 hai \u0111\u01b0\u1ee3c x\u1eed l\u00fd tr\u00ean m\u00e1y th\u1ee9 hai. M\u1ed7i ph\u1ea7n ph\u1ea3i \u0111\u01b0\u1ee3c x\u1eed l\u00fd li\u00ean t\u1ee5c (kh\u00f4ng b\u1ecb gi\u00e1n \u0111o\u1ea1n). \u0110\u1ed1i v\u1edbi m\u1ed7i c\u00f4ng vi\u1ec7c $i$, ch\u00fang ta bi\u1ebft th\u1eddi gian x\u1eed l\u00fd tr\u00ean m\u00e1y th\u1ee9 nh\u1ea5t $a_i$ v\u00e0 tr\u00ean m\u00e1y th\u1ee9 hai $b_i$. M\u1ed9t m\u00e1y ch\u1ec9 c\u00f3 th\u1ec3 x\u1eed l\u00fd m\u1ed9t b\u1ed9 ph\u1eadn c\u00f4ng vi\u1ec7c t\u1ea1i m\u1ed9t th\u1eddi \u0111i\u1ec3m. Ngo\u00e0i ra, m\u00e1y th\u1ee9 hai kh\u00f4ng th\u1ec3 b\u1eaft \u0111\u1ea7u x\u1eed l\u00fd ph\u1ea7n th\u1ee9 hai c\u1ee7a c\u00f4ng vi\u1ec7c $i$ cho \u0111\u1ebfn khi m\u00e1y th\u1ee9 nh\u1ea5t ho\u00e0n th\u00e0nh ph\u1ea7n \u0111\u1ea7u ti\u00ean c\u1ee7a n\u00f3. Ch\u00fang ta mu\u1ed1n t\u00ecm m\u1ed9t l\u1ecbch tr\u00ecnh x\u1eed l\u00fd c\u00e1c c\u00f4ng vi\u1ec7c tr\u00ean hai m\u00e1y sao cho th\u1eddi gian ho\u00e0n th\u00e0nh t\u1ea5t c\u1ea3 c\u00e1c c\u00f4ng vi\u1ec7c (makespan) l\u00e0 t\u1ed1i thi\u1ec3u.</p>","tags":["Translated"]},{"location":"schedules/schedule_two_machines.html#algorithm","title":"Thu\u1eadt to\u00e1n (Algorithm)","text":"<p>Thu\u1eadt to\u00e1n c\u1ea5u t\u1ea1o n\u00e0y \u0111\u01b0\u1ee3c \u0111\u1ec1 xu\u1ea5t b\u1edfi S.M.Johnson v\u00e0o n\u0103m 1954.</p> <p>L\u01b0u \u00fd r\u1eb1ng ch\u00fang ta c\u00f3 th\u1ec3 gi\u1ea3 \u0111\u1ecbnh r\u1eb1ng th\u1ee9 t\u1ef1 c\u00e1c c\u00f4ng vi\u1ec7c tr\u00ean m\u00e1y th\u1ee9 nh\u1ea5t v\u00e0 m\u00e1y th\u1ee9 hai l\u00e0 gi\u1ed1ng nhau (vi\u1ec7c ch\u1ee9ng minh \u0111i\u1ec1u n\u00e0y kh\u00f4ng kh\u00f3, b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng ph\u01b0\u01a1ng ph\u00e1p ho\u00e1n \u0111\u1ed5i). Do \u0111\u00f3, ch\u00fang ta ch\u1ec9 c\u1ea7n t\u00ecm d\u00e3y c\u00f4ng vi\u1ec7c.</p> <p>Thu\u1eadt to\u00e1n Johnson nh\u01b0 sau:</p> <ol> <li>Chia c\u00e1c c\u00f4ng vi\u1ec7c th\u00e0nh hai nh\u00f3m. Nh\u00f3m 1 ch\u1ee9a t\u1ea5t c\u1ea3 c\u00e1c c\u00f4ng vi\u1ec7c sao cho $a_i \\le b_i$, v\u00e0 Nh\u00f3m 2 ch\u1ee9a t\u1ea5t c\u1ea3 c\u00e1c c\u00f4ng vi\u1ec7c c\u00f3 $a_i &gt; b_i$.</li> <li>S\u1eafp x\u1ebfp c\u00e1c c\u00f4ng vi\u1ec7c trong Nh\u00f3m 1 theo th\u1ee9 t\u1ef1 t\u0103ng d\u1ea7n c\u1ee7a $a_i$.</li> <li>S\u1eafp x\u1ebfp c\u00e1c c\u00f4ng vi\u1ec7c trong Nh\u00f3m 2 theo th\u1ee9 t\u1ef1 gi\u1ea3m d\u1ea7n c\u1ee7a $b_i$.</li> <li>L\u1ecbch tr\u00ecnh t\u1ed1i \u01b0u l\u00e0 s\u1ef1 k\u1ebft h\u1ee3p c\u1ee7a Nh\u00f3m 1 (\u0111\u00e3 s\u1eafp x\u1ebfp) theo sau l\u00e0 Nh\u00f3m 2 (\u0111\u00e3 s\u1eafp x\u1ebfp).</li> </ol>","tags":["Translated"]},{"location":"schedules/schedule_two_machines.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<pre><code>struct Job {\n    int a, b, id;\n\n    bool operator&lt;(const Job&amp; o) const {\n        return min(a, b) &lt; min(o.a, o.b);\n    }\n};\n\nvector&lt;Job&gt; johnson_rule(vector&lt;Job&gt; jobs) {\n    sort(jobs.begin(), jobs.end());\n    vector&lt;Job&gt; a, b;\n    for (Job j : jobs) {\n        if (j.a &lt; j.b)\n            a.push_back(j);\n        else\n            b.push_back(j);\n    }\n    a.insert(a.end(), b.rbegin(), b.rend());\n    return a;\n}\n</code></pre>","tags":["Translated"]},{"location":"schedules/schedule_two_machines.html#proof","title":"Ch\u1ee9ng minh (Proof)","text":"<p>Ch\u00fang ta s\u1ebd s\u1eed d\u1ee5ng ph\u01b0\u01a1ng ph\u00e1p ho\u00e1n \u0111\u1ed5i. G\u1ecdi $t_i$ v\u00e0 $t'_i$ l\u00e0 th\u1eddi \u0111i\u1ec3m b\u1eaft \u0111\u1ea7u x\u1eed l\u00fd c\u00f4ng vi\u1ec7c th\u1ee9 $i$ trong l\u1ecbch tr\u00ecnh tr\u00ean m\u00e1y 1 v\u00e0 m\u00e1y 2. Khi \u0111\u00f3 th\u1eddi gian ho\u00e0n th\u00e0nh c\u00f4ng vi\u1ec7c th\u1ee9 $i$ tr\u00ean m\u00e1y 2 l\u00e0 $C_i = t'_i + b_i$. T\u1ed5ng th\u1eddi gian ho\u00e0n th\u00e0nh (makespan) l\u00e0 $C_n$.</p> <p>Ch\u00fang ta c\u00f3 c\u00e1c m\u1ed1i quan h\u1ec7: $t_1 = 0$ $t_{i+1} = t_i + a_i$ $t'_1 = a_1$ $t'_{i+1} = \\max(t_{i+1} + a_{i+1}, t'_i + b_i) = \\max(t_i + a_i + a_{i+1}, t'_i + b_i)$</p> <p>H\u00e3y xem x\u00e9t hai c\u00f4ng vi\u1ec7c li\u1ec1n k\u1ec1 $i$ v\u00e0 $j$ trong l\u1ecbch tr\u00ecnh hi\u1ec7n t\u1ea1i. \u0110\u1ec3 s\u1ef1 ho\u00e1n \u0111\u1ed5i n\u00e0y c\u00f3 l\u1ee3i, ch\u00fang ta c\u1ea7n so s\u00e1nh th\u1eddi \u0111i\u1ec3m ho\u00e0n th\u00e0nh c\u1ee7a c\u00f4ng vi\u1ec7c th\u1ee9 hai sau hai c\u00f4ng vi\u1ec7c n\u00e0y. Trong th\u1ee9 t\u1ef1 $(i, j)$: $C_{ij} = \\max(t + a_i + a_j + b_j, t + a_i + b_i + b_j, T + b_i + b_j)$ trong \u0111\u00f3 $t$ l\u00e0 th\u1eddi \u0111i\u1ec3m b\u1eaft \u0111\u1ea7u tr\u00ean m\u00e1y 1 tr\u01b0\u1edbc khi x\u1eed l\u00fd $i$, v\u00e0 $T$ l\u00e0 th\u1eddi \u0111i\u1ec3m c\u00f4ng vi\u1ec7c tr\u01b0\u1edbc \u0111\u00f3 ho\u00e0n th\u00e0nh tr\u00ean m\u00e1y 2. S\u1ed1 h\u1ea1ng $t + a_i + a_j + b_j$ \u0111\u1ea1i di\u1ec7n cho vi\u1ec7c ch\u1edd m\u00e1y 1. S\u1ed1 h\u1ea1ng $t + a_i + b_i + b_j$ v\u00e0 $T + b_i + b_j$ \u0111\u1ea1i di\u1ec7n cho s\u1ef1 ch\u1eadm tr\u1ec5 t\u00edch l\u0169y tr\u00ean m\u00e1y 2.</p> <p>Th\u1ef1c ra, ch\u00fang ta c\u00f3 th\u1ec3 \u0111\u01a1n gi\u1ea3n h\u00f3a \u0111i\u1ec1u ki\u1ec7n. Johnson \u0111\u00e3 ch\u1ee9ng minh r\u1eb1ng \u0111i\u1ec1u ki\u1ec7n t\u1ed1i \u01b0u \u0111\u1ec3 x\u1ebfp $i$ tr\u01b0\u1edbc $j$ l\u00e0: $$\\min(a_i, b_j) \\le \\min(a_j, b_i)$$</p> <p>D\u1ef1a tr\u00ean b\u1ea5t \u0111\u1eb3ng th\u1ee9c n\u00e0y: - N\u1ebfu $a_i \\le b_i$ (Nh\u00f3m 1) v\u00e0 $a_j \\le b_j$ (Nh\u00f3m 1), th\u00ec $a_i \\le a_j$. (S\u1eafp x\u1ebfp t\u0103ng d\u1ea7n theo $a$) - N\u1ebfu $a_i &gt; b_i$ (Nh\u00f3m 2) v\u00e0 $a_j &gt; b_j$ (Nh\u00f3m 2), th\u00ec $b_j \\le b_i \\Rightarrow b_i \\ge b_j$. (S\u1eafp x\u1ebfp gi\u1ea3m d\u1ea7n theo $b$) - N\u1ebfu $i \\in$ Nh\u00f3m 1 v\u00e0 $j \\in$ Nh\u00f3m 2, th\u00ec $a_i \\le b_i$ v\u00e0 $a_j &gt; b_j$. B\u1ea5t \u0111\u1eb3ng th\u1ee9c tr\u1edf th\u00e0nh $\\min(a_i, b_j) \\le \\min(a_j, b_i)$. \u0110i\u1ec1u n\u00e0y lu\u00f4n \u0111\u00fang v\u00ec $\\min$ b\u00ean tr\u00e1i $\\le a_i$ v\u00e0 $\\min$ b\u00ean ph\u1ea3i c\u00f3 th\u1ec3 l\u00e0 $b_i$ (l\u1edbn h\u01a1n $a_i$) ho\u1eb7c $a_j$ (th\u01b0\u1eddng l\u00e0 l\u1edbn). Ch\u00ednh x\u00e1c h\u01a1n, quy t\u1eafc c\u1ee7a Johnson t\u1ef1 \u0111\u1ed9ng th\u1ecfa m\u00e3n \u0111i\u1ec1u ki\u1ec7n n\u00e0y.</p>","tags":["Translated"]},{"location":"schedules/schedule_two_machines.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice problems)","text":"<ul> <li>Codeforces - 3T (M\u1ed9t bi\u1ebfn th\u1ec3 kh\u00f3 h\u01a1n m\u1ed9t ch\u00fat)</li> <li>SPOJ - BOOKGFT</li> <li>UVA 11829 - Morning Manager</li> </ul>","tags":["Translated"]},{"location":"schedules/schedule_two_machines.html#checklist","title":"Checklist","text":"<ul> <li>[x] D\u1ecbch c\u00e1c kh\u00e1i ni\u1ec7m k\u1ef9 thu\u1eadt sang ti\u1ebfng Vi\u1ec7t ch\u00ednh x\u00e1c.</li> <li>[x] \u0110\u00e3 c\u1eadp nh\u1eadt c\u00e1c li\u00ean k\u1ebft n\u1ed9i b\u1ed9 (\u0111\u1ebfn 127.0.0.1:8000).</li> <li>[x] \u0110\u1ecbnh d\u1ea1ng l\u1ea1i c\u00e1c c\u00f4ng th\u1ee9c to\u00e1n h\u1ecdc v\u00e0 code block.</li> <li>[x] Ki\u1ec3m tra ch\u00ednh t\u1ea3 v\u00e0 ng\u1eef ph\u00e1p.</li> <li>[x] \u0110\u1ea3m b\u1ea3o t\u00ednh nh\u1ea5t qu\u00e1n v\u1edbi c\u00e1c thu\u1eadt ng\u1eef \u0111\u00e3 d\u1ecbch kh\u00e1c.</li> </ul>","tags":["Translated"]},{"location":"sequences/k-th.html","title":"Th\u1ed1ng k\u00ea th\u1ee9 t\u1ef1 th\u1ee9 $K$ trong $O(N)$ ($K$th order statistic in $O(N)$)","text":"<p>Cho m\u1ed9t m\u1ea3ng $A$ c\u00f3 k\u00edch th\u01b0\u1edbc $N$ v\u00e0 m\u1ed9t s\u1ed1 $K$. B\u00e0i to\u00e1n l\u00e0 t\u00ecm s\u1ed1 l\u1edbn th\u1ee9 $K$ trong m\u1ea3ng, t\u1ee9c l\u00e0 th\u1ed1ng k\u00ea th\u1ee9 t\u1ef1 th\u1ee9 $K$.</p> <p>\u00dd t\u01b0\u1edfng c\u01a1 b\u1ea3n - s\u1eed d\u1ee5ng \u00fd t\u01b0\u1edfng c\u1ee7a thu\u1eadt to\u00e1n s\u1eafp x\u1ebfp nhanh (quick sort). Tr\u00ean th\u1ef1c t\u1ebf, thu\u1eadt to\u00e1n r\u1ea5t \u0111\u01a1n gi\u1ea3n, nh\u01b0ng kh\u00f3 ch\u1ee9ng minh h\u01a1n l\u00e0 n\u00f3 ch\u1ea1y trung b\u00ecnh trong $O(N)$, tr\u00e1i ng\u01b0\u1ee3c v\u1edbi s\u1eafp x\u1ebfp nhanh.</p>","tags":["Translated"]},{"location":"sequences/k-th.html#implementation-not-recursive","title":"C\u00e0i \u0111\u1eb7t (kh\u00f4ng \u0111\u1ec7 quy) (Implementation (not recursive))","text":"<pre><code>template &lt;class T&gt;\nT order_statistics (std::vector&lt;T&gt; a, unsigned n, unsigned k)\n{\n    using std::swap;\n    for (unsigned l=1, r=n; ; )\n    {\n        if (r &lt;= l+1)\n        {\n            // k\u00edch th\u01b0\u1edbc ph\u1ea7n hi\u1ec7n t\u1ea1i l\u00e0 1 ho\u1eb7c 2, v\u00ec v\u1eady r\u1ea5t d\u1ec5 t\u00ecm th\u1ea5y c\u00e2u tr\u1ea3 l\u1eddi\n            if (r == l+1 &amp;&amp; a[r] &lt; a[l])\n                swap (a[l], a[r]);\n            return a[k];\n        }\n\n        // s\u1eafp x\u1ebfp a[l], a[l+1], a[r]\n        unsigned mid = (l + r) &gt;&gt; 1;\n        swap (a[mid], a[l+1]);\n        if (a[l] &gt; a[r])\n            swap (a[l], a[r]);\n        if (a[l+1] &gt; a[r])\n            swap (a[l+1], a[r]);\n        if (a[l] &gt; a[l+1])\n            swap (a[l], a[l+1]);\n\n        // th\u1ef1c hi\u1ec7n ph\u00e2n chia\n        // r\u00e0o c\u1ea3n l\u00e0 a[l + 1], t\u1ee9c l\u00e0 trung v\u1ecb gi\u1eefa a[l], a[l + 1], a[r]\n        unsigned\n            i = l+1,\n            j = r;\n        const T\n            cur = a[l+1];\n        for (;;)\n        {\n            while (a[++i] &lt; cur) ;\n            while (a[--j] &gt; cur) ;\n            if (i &gt; j)\n                break;\n            swap (a[i], a[j]);\n        }\n\n        // ch\u00e8n r\u00e0o c\u1ea3n\n        a[l+1] = a[j];\n        a[j] = cur;\n\n        // ch\u00fang ta ti\u1ebfp t\u1ee5c l\u00e0m vi\u1ec7c trong ph\u1ea7n \u0111\u00f3, ph\u1ea7n ph\u1ea3i ch\u1ee9a ph\u1ea7n t\u1eed c\u1ea7n thi\u1ebft\n        if (j &gt;= k)\n            r = j-1;\n        if (j &lt;= k)\n            l = i;\n    }\n}\n</code></pre>","tags":["Translated"]},{"location":"sequences/k-th.html#notes","title":"Ghi ch\u00fa (Notes)","text":"<ul> <li>Thu\u1eadt to\u00e1n ng\u1eabu nhi\u00ean \u1edf tr\u00ean c\u00f3 t\u00ean l\u00e0 quickselect. B\u1ea1n n\u00ean x\u00e1o tr\u1ed9n ng\u1eabu nhi\u00ean $A$ tr\u01b0\u1edbc khi g\u1ecdi n\u00f3 ho\u1eb7c s\u1eed d\u1ee5ng m\u1ed9t ph\u1ea7n t\u1eed ng\u1eabu nhi\u00ean l\u00e0m r\u00e0o c\u1ea3n \u0111\u1ec3 n\u00f3 ch\u1ea1y \u0111\u00fang c\u00e1ch. C\u0169ng c\u00f3 nh\u1eefng thu\u1eadt to\u00e1n x\u00e1c \u0111\u1ecbnh gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 \u0111\u00e3 ch\u1ec9 \u0111\u1ecbnh trong th\u1eddi gian tuy\u1ebfn t\u00ednh, ch\u1eb3ng h\u1ea1n nh\u01b0 median of medians.</li> <li>std::nth_element gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 n\u00e0y trong C++ nh\u01b0ng tri\u1ec3n khai c\u1ee7a gcc ch\u1ea1y trong tr\u01b0\u1eddng h\u1ee3p x\u1ea5u nh\u1ea5t $O(n \\log n )$.</li> <li>Vi\u1ec7c t\u00ecm $K$ ph\u1ea7n t\u1eed nh\u1ecf nh\u1ea5t c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3m xu\u1ed1ng th\u00e0nh vi\u1ec7c t\u00ecm ph\u1ea7n t\u1eed th\u1ee9 $K$ v\u1edbi chi ph\u00ed chung tuy\u1ebfn t\u00ednh, v\u00ec ch\u00fang ch\u00ednh x\u00e1c l\u00e0 c\u00e1c ph\u1ea7n t\u1eed nh\u1ecf h\u01a1n ph\u1ea7n t\u1eed th\u1ee9 $K$.</li> </ul>","tags":["Translated"]},{"location":"sequences/k-th.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>Leetcode: Kth Largest Element in an Array</li> <li>CODECHEF: Median</li> </ul>","tags":["Translated"]},{"location":"sequences/k-th.html#checklist","title":"Checklist","text":"<ul> <li>[x] D\u1ecbch c\u00e1c kh\u00e1i ni\u1ec7m k\u1ef9 thu\u1eadt sang ti\u1ebfng Vi\u1ec7t ch\u00ednh x\u00e1c.</li> <li>[x] \u0110\u00e3 c\u1eadp nh\u1eadt c\u00e1c li\u00ean k\u1ebft n\u1ed9i b\u1ed9 (\u0111\u1ebfn 127.0.0.1:8000).</li> <li>[x] \u0110\u1ecbnh d\u1ea1ng l\u1ea1i c\u00e1c c\u00f4ng th\u1ee9c to\u00e1n h\u1ecdc v\u00e0 code block.</li> <li>[x] Ki\u1ec3m tra ch\u00ednh t\u1ea3 v\u00e0 ng\u1eef ph\u00e1p.</li> <li>[x] \u0110\u1ea3m b\u1ea3o t\u00ednh nh\u1ea5t qu\u00e1n v\u1edbi c\u00e1c thu\u1eadt ng\u1eef \u0111\u00e3 d\u1ecbch kh\u00e1c.</li> </ul>","tags":["Translated"]},{"location":"sequences/longest_increasing_subsequence.html","title":"Longest increasing subsequence","text":""},{"location":"sequences/longest_increasing_subsequence.html#day-con-tang-dai-nhat-longest-increasing-subsequence","title":"D\u00e3y con t\u0103ng d\u00e0i nh\u1ea5t (Longest increasing subsequence)","text":"<p>B\u00e0i vi\u1ebft n\u00e0y \u0111\u00e3 \u0111\u01b0\u1ee3c chuy\u1ec3n \u0111\u1ebfn D\u00e3y con t\u0103ng d\u00e0i nh\u1ea5t.</p>"},{"location":"sequences/mex.html","title":"MEX (gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t kh\u00f4ng xu\u1ea5t hi\u1ec7n) c\u1ee7a m\u1ed9t d\u00e3y (MEX (minimal excluded) of a sequence)","text":"<p>Cho m\u1ed9t m\u1ea3ng $A$ c\u00f3 k\u00edch th\u01b0\u1edbc $N$. B\u1ea1n ph\u1ea3i t\u00ecm ph\u1ea7n t\u1eed kh\u00f4ng \u00e2m nh\u1ecf nh\u1ea5t kh\u00f4ng c\u00f3 trong m\u1ea3ng. S\u1ed1 \u0111\u00f3 th\u01b0\u1eddng \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 MEX (minimal excluded).</p> $$ \\begin{align} \\text{mex}(\\{0, 1, 2, 4, 5\\}) &amp;= 3 \\\\ \\text{mex}(\\{0, 1, 2, 3, 4\\}) &amp;= 5 \\\\ \\text{mex}(\\{1, 2, 3, 4, 5\\}) &amp;= 0 \\\\ \\end{align} $$ <p>L\u01b0u \u00fd r\u1eb1ng MEX c\u1ee7a m\u1ed9t m\u1ea3ng c\u00f3 k\u00edch th\u01b0\u1edbc $N$ kh\u00f4ng bao gi\u1edd c\u00f3 th\u1ec3 l\u1edbn h\u01a1n ch\u00ednh $N$.</p> <p>C\u00e1ch ti\u1ebfp c\u1eadn d\u1ec5 nh\u1ea5t l\u00e0 t\u1ea1o m\u1ed9t t\u1eadp h\u1ee3p (set) c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed trong m\u1ea3ng $A$, \u0111\u1ec3 ch\u00fang ta c\u00f3 th\u1ec3 nhanh ch\u00f3ng ki\u1ec3m tra xem m\u1ed9t s\u1ed1 c\u00f3 ph\u1ea3i l\u00e0 m\u1ed9t ph\u1ea7n c\u1ee7a m\u1ea3ng hay kh\u00f4ng. Sau \u0111\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 ki\u1ec3m tra t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 t\u1eeb $0$ \u0111\u1ebfn $N$, n\u1ebfu s\u1ed1 hi\u1ec7n t\u1ea1i kh\u00f4ng c\u00f3 trong t\u1eadp h\u1ee3p, h\u00e3y tr\u1ea3 v\u1ec1 n\u00f3.</p>","tags":["Translated"]},{"location":"sequences/mex.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>Thu\u1eadt to\u00e1n sau ch\u1ea1y trong th\u1eddi gian $O(N \\log N)$.</p> <pre><code>int mex(vector&lt;int&gt; const&amp; A) {\n    set&lt;int&gt; b(A.begin(), A.end());\n\n    int result = 0;\n    while (b.count(result))\n        ++result;\n    return result;\n}\n</code></pre> <p>N\u1ebfu m\u1ed9t thu\u1eadt to\u00e1n y\u00eau c\u1ea7u t\u00ednh to\u00e1n MEX trong $O(N)$, c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n \u0111\u01b0\u1ee3c b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng m\u1ed9t vect\u01a1 boolean thay v\u00ec m\u1ed9t t\u1eadp h\u1ee3p. L\u01b0u \u00fd r\u1eb1ng m\u1ea3ng c\u1ea7n ph\u1ea3i l\u1edbn b\u1eb1ng k\u00edch th\u01b0\u1edbc m\u1ea3ng l\u1edbn nh\u1ea5t c\u00f3 th\u1ec3.</p> <pre><code>int mex(vector&lt;int&gt; const&amp; A) {\n    static bool used[MAX_N+1] = { 0 };\n\n    // \u0111\u00e1nh d\u1ea5u c\u00e1c s\u1ed1 \u0111\u00e3 cho\n    for (int x : A) {\n        if (x &lt;= MAX_N)\n            used[x] = true;\n    }\n\n    // t\u00ecm mex\n    int result = 0;\n    while (used[result])\n        ++result;\n\n    // x\u00f3a m\u1ea3ng m\u1ed9t l\u1ea7n n\u1eefa\n    for (int x : A) {\n        if (x &lt;= MAX_N)\n            used[x] = false;\n    }\n\n    return result;\n}\n</code></pre> <p>C\u00e1ch ti\u1ebfp c\u1eadn n\u00e0y nhanh, nh\u01b0ng ch\u1ec9 ho\u1ea1t \u0111\u1ed9ng t\u1ed1t n\u1ebfu b\u1ea1n ph\u1ea3i t\u00ednh to\u00e1n MEX m\u1ed9t l\u1ea7n. N\u1ebfu b\u1ea1n c\u1ea7n t\u00ednh to\u00e1n MEX l\u1eb7p \u0111i l\u1eb7p l\u1ea1i, v\u00ed d\u1ee5: v\u00ec m\u1ea3ng c\u1ee7a b\u1ea1n li\u00ean t\u1ee5c thay \u0111\u1ed5i, th\u00ec n\u00f3 kh\u00f4ng hi\u1ec7u qu\u1ea3. \u0110\u1ed1i v\u1edbi \u0111i\u1ec1u \u0111\u00f3, ch\u00fang ta c\u1ea7n m\u1ed9t c\u00e1i g\u00ec \u0111\u00f3 t\u1ed1t h\u01a1n.</p>","tags":["Translated"]},{"location":"sequences/mex.html#mex-with-array-updates","title":"MEX v\u1edbi c\u1eadp nh\u1eadt m\u1ea3ng (MEX with array updates)","text":"<p>Trong b\u00e0i to\u00e1n, b\u1ea1n c\u1ea7n thay \u0111\u1ed5i t\u1eebng s\u1ed1 trong m\u1ea3ng v\u00e0 t\u00ednh to\u00e1n MEX m\u1edbi c\u1ee7a m\u1ea3ng sau m\u1ed7i l\u1ea7n c\u1eadp nh\u1eadt nh\u01b0 v\u1eady.</p> <p>C\u1ea7n c\u00f3 m\u1ed9t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u t\u1ed1t h\u01a1n \u0111\u1ec3 x\u1eed l\u00fd c\u00e1c truy v\u1ea5n nh\u01b0 v\u1eady m\u1ed9t c\u00e1ch hi\u1ec7u qu\u1ea3.</p> <p>M\u1ed9t c\u00e1ch ti\u1ebfp c\u1eadn s\u1ebd l\u00e0 l\u1ea5y t\u1ea7n su\u1ea5t c\u1ee7a m\u1ed7i s\u1ed1 t\u1eeb $0$ \u0111\u1ebfn $N$, v\u00e0 x\u00e2y d\u1ef1ng m\u1ed9t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u gi\u1ed1ng nh\u01b0 c\u00e2y tr\u00ean \u0111\u00f3. V\u00ed d\u1ee5: c\u00e2y ph\u00e2n \u0111o\u1ea1n (segment tree) ho\u1eb7c treap. M\u1ed7i n\u00fat \u0111\u1ea1i di\u1ec7n cho m\u1ed9t ph\u1ea1m vi s\u1ed1, v\u00e0 c\u00f9ng v\u1edbi t\u1ed5ng t\u1ea7n su\u1ea5t trong ph\u1ea1m vi, b\u1ea1n l\u01b0u tr\u1eef th\u00eam l\u01b0\u1ee3ng s\u1ed1 ri\u00eang bi\u1ec7t trong ph\u1ea1m vi \u0111\u00f3. C\u00f3 th\u1ec3 c\u1eadp nh\u1eadt c\u1ea5u tr\u00fac d\u1eef li\u1ec7u n\u00e0y trong th\u1eddi gian $O(\\log N)$, v\u00e0 c\u0169ng t\u00ecm th\u1ea5y MEX trong th\u1eddi gian $O(\\log N)$, b\u1eb1ng c\u00e1ch th\u1ef1c hi\u1ec7n t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n cho MEX. N\u1ebfu n\u00fat \u0111\u1ea1i di\u1ec7n cho ph\u1ea1m vi $[0, \\lfloor N/2 \\rfloor)$ kh\u00f4ng ch\u1ee9a $\\lfloor N/2 \\rfloor$ nhi\u1ec1u s\u1ed1 ri\u00eang bi\u1ec7t, th\u00ec m\u1ed9t s\u1ed1 b\u1ecb thi\u1ebfu v\u00e0 MEX nh\u1ecf h\u01a1n $\\lfloor N/2 \\rfloor$, v\u00e0 b\u1ea1n c\u00f3 th\u1ec3 \u0111\u1ec7 quy trong nh\u00e1nh b\u00ean tr\u00e1i c\u1ee7a c\u00e2y. N\u1ebfu kh\u00f4ng, n\u00f3 \u00edt nh\u1ea5t l\u00e0 $\\lfloor N/2 \\rfloor$, v\u00e0 b\u1ea1n c\u00f3 th\u1ec3 \u0111\u1ec7 quy trong nh\u00e1nh b\u00ean ph\u1ea3i c\u1ee7a c\u00e2y.</p> <p>C\u0169ng c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng c\u00e1c c\u1ea5u tr\u00fac d\u1eef li\u1ec7u th\u01b0 vi\u1ec7n chu\u1ea9n <code>map</code> v\u00e0 <code>set</code> (d\u1ef1a tr\u00ean m\u1ed9t c\u00e1ch ti\u1ebfp c\u1eadn \u0111\u01b0\u1ee3c gi\u1ea3i th\u00edch t\u1ea1i \u0111\u00e2y). V\u1edbi <code>map</code>, ch\u00fang ta s\u1ebd nh\u1edb t\u1ea7n su\u1ea5t c\u1ee7a t\u1eebng s\u1ed1 v\u00e0 v\u1edbi <code>set</code>, ch\u00fang ta \u0111\u1ea1i di\u1ec7n cho c\u00e1c s\u1ed1 hi\u1ec7n \u0111ang thi\u1ebfu trong m\u1ea3ng. V\u00ec <code>set</code> \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp, <code>*set.begin()</code> s\u1ebd l\u00e0 MEX. T\u1ed5ng c\u1ed9ng ch\u00fang ta c\u1ea7n $O(N \\log N)$ t\u00ednh to\u00e1n tr\u01b0\u1edbc v\u00e0 sau \u0111\u00f3 c\u00f3 th\u1ec3 t\u00ednh to\u00e1n MEX trong $O(1)$ v\u00e0 c\u1eadp nh\u1eadt c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong $O(\\log N)$.</p> <pre><code>class Mex {\nprivate:\n    map&lt;int, int&gt; frequency;\n    set&lt;int&gt; missing_numbers;\n    vector&lt;int&gt; A;\n\npublic:\n    Mex(vector&lt;int&gt; const&amp; A) : A(A) {\n        for (int i = 0; i &lt;= A.size(); i++)\n            missing_numbers.insert(i);\n\n        for (int x : A) {\n            ++frequency[x];\n            missing_numbers.erase(x);\n        }\n    }\n\n    int mex() {\n        return *missing_numbers.begin();\n    }\n\n    void update(int idx, int new_value) {\n        if (--frequency[A[idx]] == 0)\n            missing_numbers.insert(A[idx]);\n        A[idx] = new_value;\n        ++frequency[new_value];\n        missing_numbers.erase(new_value);\n    }\n};\n</code></pre>","tags":["Translated"]},{"location":"sequences/mex.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>AtCoder: Neq Min</li> <li>Codeforces: Informatics in MAC</li> <li>Codeforces: Replace by MEX</li> <li>Codeforces: Vitya and Strange Lesson</li> <li>Codeforces: MEX Queries</li> </ul>","tags":["Translated"]},{"location":"sequences/mex.html#checklist","title":"Checklist","text":"<ul> <li>[x] D\u1ecbch c\u00e1c kh\u00e1i ni\u1ec7m k\u1ef9 thu\u1eadt sang ti\u1ebfng Vi\u1ec7t ch\u00ednh x\u00e1c.</li> <li>[x] \u0110\u00e3 c\u1eadp nh\u1eadt c\u00e1c li\u00ean k\u1ebft n\u1ed9i b\u1ed9 (\u0111\u1ebfn 127.0.0.1:8000).</li> <li>[x] \u0110\u1ecbnh d\u1ea1ng l\u1ea1i c\u00e1c c\u00f4ng th\u1ee9c to\u00e1n h\u1ecdc v\u00e0 code block.</li> <li>[x] Ki\u1ec3m tra ch\u00ednh t\u1ea3 v\u00e0 ng\u1eef ph\u00e1p.</li> <li>[x] \u0110\u1ea3m b\u1ea3o t\u00ednh nh\u1ea5t qu\u00e1n v\u1edbi c\u00e1c thu\u1eadt ng\u1eef \u0111\u00e3 d\u1ecbch kh\u00e1c.</li> </ul>","tags":["Translated"]},{"location":"sequences/rmq.html","title":"Truy v\u1ea5n gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t trong \u0111o\u1ea1n (Range Minimum Query)","text":"<p>B\u1ea1n \u0111\u01b0\u1ee3c cho m\u1ed9t m\u1ea3ng $A[1..N]$. B\u1ea1n ph\u1ea3i tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n \u0111\u1ebfn c\u00f3 d\u1ea1ng $(L, R)$, y\u00eau c\u1ea7u t\u00ecm ph\u1ea7n t\u1eed nh\u1ecf nh\u1ea5t trong m\u1ea3ng $A$ gi\u1eefa c\u00e1c v\u1ecb tr\u00ed $L$ v\u00e0 $R$.</p> <p>RMQ c\u00f3 th\u1ec3 xu\u1ea5t hi\u1ec7n tr\u1ef1c ti\u1ebfp trong c\u00e1c b\u00e0i to\u00e1n ho\u1eb7c c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c \u00e1p d\u1ee5ng trong m\u1ed9t s\u1ed1 nhi\u1ec7m v\u1ee5 kh\u00e1c, v\u00ed d\u1ee5: b\u00e0i to\u00e1n T\u1ed5 ti\u00ean chung th\u1ea5p nh\u1ea5t (Lowest Common Ancestor).</p>","tags":["Translated"]},{"location":"sequences/rmq.html#solution","title":"Gi\u1ea3i ph\u00e1p (Solution)","text":"<p>C\u00f3 r\u1ea5t nhi\u1ec1u c\u00e1ch ti\u1ebfp c\u1eadn v\u00e0 c\u1ea5u tr\u00fac d\u1eef li\u1ec7u c\u00f3 th\u1ec3 m\u00e0 b\u1ea1n c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng \u0111\u1ec3 gi\u1ea3i quy\u1ebft t\u00e1c v\u1ee5 RMQ.</p> <p>Nh\u1eefng c\u00e1i \u0111\u01b0\u1ee3c gi\u1ea3i th\u00edch tr\u00ean trang web n\u00e0y \u0111\u01b0\u1ee3c li\u1ec7t k\u00ea d\u01b0\u1edbi \u0111\u00e2y.</p> <p>\u0110\u1ea7u ti\u00ean l\u00e0 c\u00e1c c\u00e1ch ti\u1ebfp c\u1eadn cho ph\u00e9p s\u1eeda \u0111\u1ed5i m\u1ea3ng gi\u1eefa c\u00e1c l\u1ea7n tr\u1ea3 l\u1eddi truy v\u1ea5n.</p> <ul> <li>Sqrt-decomposition - tr\u1ea3 l\u1eddi m\u1ed7i truy v\u1ea5n trong $O(\\sqrt{N})$, ti\u1ec1n x\u1eed l\u00fd \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong $O(N)$.   \u01afu \u0111i\u1ec3m: m\u1ed9t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u r\u1ea5t \u0111\u01a1n gi\u1ea3n. Nh\u01b0\u1ee3c \u0111i\u1ec3m: \u0111\u1ed9 ph\u1ee9c t\u1ea1p t\u1ed3i t\u1ec7 h\u01a1n.</li> <li>Segment tree - tr\u1ea3 l\u1eddi m\u1ed7i truy v\u1ea5n trong $O(\\log N)$, ti\u1ec1n x\u1eed l\u00fd \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong $O(N)$.   \u01afu \u0111i\u1ec3m: \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian t\u1ed1t. Nh\u01b0\u1ee3c \u0111i\u1ec3m: l\u01b0\u1ee3ng m\u00e3 l\u1edbn h\u01a1n so v\u1edbi c\u00e1c c\u1ea5u tr\u00fac d\u1eef li\u1ec7u kh\u00e1c.</li> <li>Fenwick tree - tr\u1ea3 l\u1eddi m\u1ed7i truy v\u1ea5n trong $O(\\log N)$, ti\u1ec1n x\u1eed l\u00fd \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong $O(N \\log N)$.   \u01afu \u0111i\u1ec3m: m\u00e3 ng\u1eafn nh\u1ea5t, \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian t\u1ed1t. Nh\u01b0\u1ee3c \u0111i\u1ec3m: C\u00e2y Fenwick ch\u1ec9 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng cho c\u00e1c truy v\u1ea5n c\u00f3 $L = 1$, v\u00ec v\u1eady n\u00f3 kh\u00f4ng \u00e1p d\u1ee5ng cho nhi\u1ec1u b\u00e0i to\u00e1n.</li> </ul> <p>V\u00e0 \u0111\u00e2y l\u00e0 nh\u1eefng c\u00e1ch ti\u1ebfp c\u1eadn ch\u1ec9 ho\u1ea1t \u0111\u1ed9ng tr\u00ean c\u00e1c m\u1ea3ng t\u0129nh, t\u1ee9c l\u00e0 kh\u00f4ng th\u1ec3 thay \u0111\u1ed5i gi\u00e1 tr\u1ecb trong m\u1ea3ng m\u00e0 kh\u00f4ng t\u00ednh to\u00e1n l\u1ea1i c\u1ea5u tr\u00fac d\u1eef li\u1ec7u ho\u00e0n ch\u1ec9nh.</p> <ul> <li>Sparse Table - tr\u1ea3 l\u1eddi m\u1ed7i truy v\u1ea5n trong $O(1)$, ti\u1ec1n x\u1eed l\u00fd \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong $O(N \\log N)$.   \u01afu \u0111i\u1ec3m: c\u1ea5u tr\u00fac d\u1eef li\u1ec7u \u0111\u01a1n gi\u1ea3n, \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian tuy\u1ec7t v\u1eddi.</li> <li>Sqrt Tree - tr\u1ea3 l\u1eddi truy v\u1ea5n trong $O(1)$, ti\u1ec1n x\u1eed l\u00fd \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong $O(N \\log \\log N)$. \u01afu \u0111i\u1ec3m: nhanh. Nh\u01b0\u1ee3c \u0111i\u1ec3m: Ph\u1ee9c t\u1ea1p \u0111\u1ec3 c\u00e0i \u0111\u1eb7t.</li> <li>Disjoint Set Union / Arpa's Trick - tr\u1ea3 l\u1eddi truy v\u1ea5n trong $O(1)$, ti\u1ec1n x\u1eed l\u00fd trong $O(n)$. \u01afu \u0111i\u1ec3m: ng\u1eafn, nhanh. Nh\u01b0\u1ee3c \u0111i\u1ec3m: ch\u1ec9 ho\u1ea1t \u0111\u1ed9ng n\u1ebfu t\u1ea5t c\u1ea3 c\u00e1c truy v\u1ea5n \u0111\u01b0\u1ee3c bi\u1ebft tr\u01b0\u1edbc, t\u1ee9c l\u00e0 ch\u1ec9 h\u1ed7 tr\u1ee3 x\u1eed l\u00fd off-line c\u00e1c truy v\u1ea5n.</li> <li>Cartesian Tree v\u00e0 Thu\u1eadt to\u00e1n Farach-Colton v\u00e0 Bender - tr\u1ea3 l\u1eddi truy v\u1ea5n trong $O(1)$, ti\u1ec1n x\u1eed l\u00fd trong $O(n)$. \u01afu \u0111i\u1ec3m: \u0111\u1ed9 ph\u1ee9c t\u1ea1p t\u1ed1i \u01b0u. Nh\u01b0\u1ee3c \u0111i\u1ec3m: l\u01b0\u1ee3ng m\u00e3 l\u1edbn.</li> </ul> <p>L\u01b0u \u00fd: Ti\u1ec1n x\u1eed l\u00fd l\u00e0 qu\u00e1 tr\u00ecnh x\u1eed l\u00fd s\u01a1 b\u1ed9 m\u1ea3ng \u0111\u00e3 cho b\u1eb1ng c\u00e1ch x\u00e2y d\u1ef1ng c\u1ea5u tr\u00fac d\u1eef li\u1ec7u t\u01b0\u01a1ng \u1ee9ng cho n\u00f3.</p>","tags":["Translated"]},{"location":"sequences/rmq.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>SPOJ: Range Minimum Query</li> <li>CODECHEF: Chef And Array</li> <li>Codeforces:  Array Partition</li> </ul>","tags":["Translated"]},{"location":"sequences/rmq.html#checklist","title":"Checklist","text":"<ul> <li>[x] D\u1ecbch c\u00e1c kh\u00e1i ni\u1ec7m k\u1ef9 thu\u1eadt sang ti\u1ebfng Vi\u1ec7t ch\u00ednh x\u00e1c.</li> <li>[x] \u0110\u00e3 c\u1eadp nh\u1eadt c\u00e1c li\u00ean k\u1ebft n\u1ed9i b\u1ed9 (\u0111\u1ebfn 127.0.0.1:8000).</li> <li>[x] \u0110\u1ecbnh d\u1ea1ng l\u1ea1i c\u00e1c c\u00f4ng th\u1ee9c to\u00e1n h\u1ecdc v\u00e0 code block.</li> <li>[x] Ki\u1ec3m tra ch\u00ednh t\u1ea3 v\u00e0 ng\u1eef ph\u00e1p.</li> <li>[x] \u0110\u1ea3m b\u1ea3o t\u00ednh nh\u1ea5t qu\u00e1n v\u1edbi c\u00e1c thu\u1eadt ng\u1eef \u0111\u00e3 d\u1ecbch kh\u00e1c.</li> </ul>","tags":["Translated"]},{"location":"string/aho_corasick.html","title":"Thu\u1eadt to\u00e1n Aho-Corasick (Aho-Corasick algorithm)","text":"<p>Thu\u1eadt to\u00e1n Aho-Corasick cho ph\u00e9p ch\u00fang ta nhanh ch\u00f3ng t\u00ecm ki\u1ebfm nhi\u1ec1u m\u1eabu trong m\u1ed9t v\u0103n b\u1ea3n. T\u1eadp h\u1ee3p c\u00e1c chu\u1ed7i m\u1eabu c\u00f2n \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 t\u1eeb \u0111i\u1ec3n (dictionary). Ch\u00fang ta s\u1ebd k\u00fd hi\u1ec7u t\u1ed5ng \u0111\u1ed9 d\u00e0i c\u1ee7a c\u00e1c chu\u1ed7i c\u1ea5u th\u00e0nh n\u00f3 l\u00e0 $m$ v\u00e0 k\u00edch th\u01b0\u1edbc c\u1ee7a b\u1ea3ng ch\u1eef c\u00e1i l\u00e0 $k$. Thu\u1eadt to\u00e1n x\u00e2y d\u1ef1ng m\u1ed9t automaton tr\u1ea1ng th\u00e1i h\u1eefu h\u1ea1n (finite state automaton) d\u1ef1a tr\u00ean m\u1ed9t trie trong th\u1eddi gian $O(m k)$ v\u00e0 sau \u0111\u00f3 s\u1eed d\u1ee5ng n\u00f3 \u0111\u1ec3 x\u1eed l\u00fd v\u0103n b\u1ea3n.</p> <p>Thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c \u0111\u1ec1 xu\u1ea5t b\u1edfi Alfred Aho v\u00e0 Margaret Corasick v\u00e0o n\u0103m 1975.</p>","tags":["Translated"]},{"location":"string/aho_corasick.html#construction-of-the-trie","title":"X\u00e2y d\u1ef1ng trie (Construction of the trie)","text":"M\u1ed9t trie d\u1ef1a tr\u00ean c\u00e1c t\u1eeb \"Java\", \"Rad\", \"Rand\", \"Rau\", \"Raum\" v\u00e0 \"Rose\". H\u00ecnh \u1ea3nh b\u1edfi [nd](https://de.wikipedia.org/wiki/Benutzer:Nd) \u0111\u01b0\u1ee3c ph\u00e2n ph\u1ed1i theo gi\u1ea5y ph\u00e9p CC BY-SA 3.0. <p>V\u1ec1 m\u1eb7t h\u00ecnh th\u1ee9c, trie l\u00e0 m\u1ed9t c\u00e2y c\u00f3 g\u1ed1c, trong \u0111\u00f3 m\u1ed7i c\u1ea1nh c\u1ee7a c\u00e2y \u0111\u01b0\u1ee3c g\u1eafn nh\u00e3n v\u1edbi m\u1ed9t ch\u1eef c\u00e1i n\u00e0o \u0111\u00f3 v\u00e0 c\u00e1c c\u1ea1nh \u0111i ra t\u1eeb m\u1ed9t \u0111\u1ec9nh c\u00f3 c\u00e1c nh\u00e3n kh\u00e1c nhau.</p> <p>Ch\u00fang ta s\u1ebd x\u00e1c \u0111\u1ecbnh m\u1ed7i \u0111\u1ec9nh trong trie v\u1edbi chu\u1ed7i \u0111\u01b0\u1ee3c t\u1ea1o b\u1edfi c\u00e1c nh\u00e3n tr\u00ean \u0111\u01b0\u1eddng d\u1eabn t\u1eeb g\u1ed1c \u0111\u1ebfn \u0111\u1ec9nh \u0111\u00f3.</p> <p>M\u1ed7i \u0111\u1ec9nh c\u0169ng s\u1ebd c\u00f3 m\u1ed9t c\u1edd $\\text{output}$ s\u1ebd \u0111\u01b0\u1ee3c \u0111\u1eb7t n\u1ebfu \u0111\u1ec9nh t\u01b0\u01a1ng \u1ee9ng v\u1edbi m\u1ed9t m\u1eabu trong t\u1eeb \u0111i\u1ec3n.</p> <p>Theo \u0111\u00f3, m\u1ed9t trie cho m\u1ed9t t\u1eadp h\u1ee3p c\u00e1c chu\u1ed7i l\u00e0 m\u1ed9t trie sao cho m\u1ed7i \u0111\u1ec9nh $\\text{output}$ t\u01b0\u01a1ng \u1ee9ng v\u1edbi m\u1ed9t chu\u1ed7i t\u1eeb t\u1eadp h\u1ee3p, v\u00e0 ng\u01b0\u1ee3c l\u1ea1i, m\u1ed7i chu\u1ed7i c\u1ee7a t\u1eadp h\u1ee3p t\u01b0\u01a1ng \u1ee9ng v\u1edbi m\u1ed9t \u0111\u1ec9nh $\\text{output}$.</p> <p>B\u00e2y gi\u1edd ch\u00fang t\u00f4i m\u00f4 t\u1ea3 c\u00e1ch x\u00e2y d\u1ef1ng m\u1ed9t trie cho m\u1ed9t t\u1eadp h\u1ee3p c\u00e1c chu\u1ed7i nh\u1ea5t \u0111\u1ecbnh trong th\u1eddi gian tuy\u1ebfn t\u00ednh \u0111\u1ed1i v\u1edbi t\u1ed5ng \u0111\u1ed9 d\u00e0i c\u1ee7a ch\u00fang.</p> <p>Ch\u00fang t\u00f4i gi\u1edbi thi\u1ec7u m\u1ed9t c\u1ea5u tr\u00fac cho c\u00e1c \u0111\u1ec9nh c\u1ee7a c\u00e2y: <pre><code>const int K = 26;\n\nstruct Vertex {\n    int next[K];\n    bool output = false;\n\n    Vertex() {\n        fill(begin(next), end(next), -1);\n    }\n};\n\nvector&lt;Vertex&gt; trie(1);\n</code></pre></p> <p>\u1ede \u0111\u00e2y, ch\u00fang t\u00f4i l\u01b0u tr\u1eef trie d\u01b0\u1edbi d\u1ea1ng m\u1ed9t m\u1ea3ng c\u00e1c $\\text{Vertex}$. M\u1ed7i $\\text{Vertex}$ ch\u1ee9a c\u1edd $\\text{output}$ v\u00e0 c\u00e1c c\u1ea1nh d\u01b0\u1edbi d\u1ea1ng m\u1ed9t m\u1ea3ng $\\text{next}[]$, trong \u0111\u00f3 $\\text{next}[i]$ l\u00e0 ch\u1ec9 s\u1ed1 c\u1ee7a \u0111\u1ec9nh m\u00e0 ch\u00fang ta \u0111\u1ea1t \u0111\u01b0\u1ee3c b\u1eb1ng c\u00e1ch theo k\u00fd t\u1ef1 $i$, ho\u1eb7c $-1$ n\u1ebfu kh\u00f4ng c\u00f3 c\u1ea1nh nh\u01b0 v\u1eady. Ban \u0111\u1ea7u, trie ch\u1ec9 bao g\u1ed3m m\u1ed9t \u0111\u1ec9nh - g\u1ed1c - v\u1edbi ch\u1ec9 s\u1ed1 $0$.</p> <p>B\u00e2y gi\u1edd ch\u00fang ta th\u1ef1c hi\u1ec7n m\u1ed9t h\u00e0m s\u1ebd th\u00eam m\u1ed9t chu\u1ed7i $s$ v\u00e0o trie. Vi\u1ec7c th\u1ef1c hi\u1ec7n r\u1ea5t \u0111\u01a1n gi\u1ea3n: ch\u00fang ta b\u1eaft \u0111\u1ea7u t\u1ea1i n\u00fat g\u1ed1c, v\u00e0 mi\u1ec5n l\u00e0 c\u00f3 c\u00e1c c\u1ea1nh t\u01b0\u01a1ng \u1ee9ng v\u1edbi c\u00e1c k\u00fd t\u1ef1 c\u1ee7a $s$, ch\u00fang ta \u0111i theo ch\u00fang. N\u1ebfu kh\u00f4ng c\u00f3 c\u1ea1nh cho m\u1ed9t k\u00fd t\u1ef1, ch\u00fang ta t\u1ea1o m\u1ed9t \u0111\u1ec9nh m\u1edbi v\u00e0 k\u1ebft n\u1ed1i n\u00f3 v\u1edbi m\u1ed9t c\u1ea1nh. V\u00e0o cu\u1ed1i qu\u00e1 tr\u00ecnh, ch\u00fang ta \u0111\u00e1nh d\u1ea5u \u0111\u1ec9nh cu\u1ed1i c\u00f9ng b\u1eb1ng c\u1edd $\\text{output}$.</p> <pre><code>void add_string(string const&amp; s) {\n    int v = 0;\n    for (char ch : s) {\n        int c = ch - 'a';\n        if (trie[v].next[c] == -1) {\n            trie[v].next[c] = trie.size();\n            trie.emplace_back();\n        }\n        v = trie[v].next[c];\n    }\n    trie[v].output = true;\n}\n</code></pre> <p>Vi\u1ec7c c\u00e0i \u0111\u1eb7t n\u00e0y r\u00f5 r\u00e0ng ch\u1ea1y trong th\u1eddi gian tuy\u1ebfn t\u00ednh, v\u00e0 v\u00ec m\u1ed7i \u0111\u1ec9nh l\u01b0u tr\u1eef $k$ li\u00ean k\u1ebft, n\u00f3 s\u1ebd s\u1eed d\u1ee5ng b\u1ed9 nh\u1edb $O(m k)$.</p> <p>C\u00f3 th\u1ec3 gi\u1ea3m m\u1ee9c ti\u00eau th\u1ee5 b\u1ed9 nh\u1edb xu\u1ed1ng $O(m)$ b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng map thay v\u00ec m\u1ea3ng trong m\u1ed7i \u0111\u1ec9nh. Tuy nhi\u00ean, \u0111i\u1ec1u n\u00e0y s\u1ebd l\u00e0m t\u0103ng \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian l\u00ean $O(m \\log k)$.</p>","tags":["Translated"]},{"location":"string/aho_corasick.html#construction-of-an-automaton","title":"X\u00e2y d\u1ef1ng m\u1ed9t automaton (Construction of an automaton)","text":"<p>Gi\u1ea3 s\u1eed ch\u00fang ta \u0111\u00e3 x\u00e2y d\u1ef1ng m\u1ed9t trie cho t\u1eadp h\u1ee3p c\u00e1c chu\u1ed7i \u0111\u00e3 cho. B\u00e2y gi\u1edd h\u00e3y nh\u00ecn n\u00f3 t\u1eeb m\u1ed9t ph\u00eda kh\u00e1c. N\u1ebfu ch\u00fang ta nh\u00ecn v\u00e0o b\u1ea5t k\u1ef3 \u0111\u1ec9nh n\u00e0o, chu\u1ed7i t\u01b0\u01a1ng \u1ee9ng v\u1edbi n\u00f3 l\u00e0 ti\u1ec1n t\u1ed1 c\u1ee7a m\u1ed9t ho\u1eb7c nhi\u1ec1u chu\u1ed7i trong t\u1eadp h\u1ee3p, do \u0111\u00f3 m\u1ed7i \u0111\u1ec9nh c\u1ee7a trie c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c hi\u1ec3u l\u00e0 m\u1ed9t v\u1ecb tr\u00ed trong m\u1ed9t ho\u1eb7c nhi\u1ec1u chu\u1ed7i t\u1eeb t\u1eadp h\u1ee3p.</p> <p>Trong th\u1ef1c t\u1ebf, c\u00e1c \u0111\u1ec9nh trie c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c hi\u1ec3u l\u00e0 c\u00e1c tr\u1ea1ng th\u00e1i trong m\u1ed9t automaton \u0111\u01a1n \u0111\u1ecbnh h\u1eefu h\u1ea1n (finite deterministic automaton). T\u1eeb b\u1ea5t k\u1ef3 tr\u1ea1ng th\u00e1i n\u00e0o, ch\u00fang ta c\u00f3 th\u1ec3 chuy\u1ec3n \u0111\u1ed5i - s\u1eed d\u1ee5ng m\u1ed9t s\u1ed1 ch\u1eef c\u00e1i \u0111\u1ea7u v\u00e0o - sang c\u00e1c tr\u1ea1ng th\u00e1i kh\u00e1c, t\u1ee9c l\u00e0 sang m\u1ed9t v\u1ecb tr\u00ed kh\u00e1c trong t\u1eadp h\u1ee3p c\u00e1c chu\u1ed7i. V\u00ed d\u1ee5: n\u1ebfu ch\u1ec9 c\u00f3 m\u1ed9t chu\u1ed7i $abc$ trong t\u1eeb \u0111i\u1ec3n, v\u00e0 ch\u00fang ta \u0111ang \u0111\u1ee9ng \u1edf \u0111\u1ec9nh $ab$, th\u00ec s\u1eed d\u1ee5ng ch\u1eef c\u00e1i $c$ ch\u00fang ta c\u00f3 th\u1ec3 \u0111i \u0111\u1ebfn \u0111\u1ec9nh $abc$.</p> <p>Do \u0111\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 hi\u1ec3u c\u00e1c c\u1ea1nh c\u1ee7a trie l\u00e0 c\u00e1c chuy\u1ec3n \u0111\u1ed5i trong m\u1ed9t automaton theo ch\u1eef c\u00e1i t\u01b0\u01a1ng \u1ee9ng. Tuy nhi\u00ean, trong m\u1ed9t automaton, ch\u00fang ta c\u1ea7n c\u00f3 c\u00e1c danh s\u00e1ch chuy\u1ec3n \u0111\u1ed5i cho m\u1ed7i s\u1ef1 k\u1ebft h\u1ee3p c\u1ee7a m\u1ed9t tr\u1ea1ng th\u00e1i v\u00e0 m\u1ed9t ch\u1eef c\u00e1i. N\u1ebfu ch\u00fang ta c\u1ed1 g\u1eafng th\u1ef1c hi\u1ec7n m\u1ed9t chuy\u1ec3n \u0111\u1ed5i b\u1eb1ng m\u1ed9t ch\u1eef c\u00e1i, v\u00e0 kh\u00f4ng c\u00f3 c\u1ea1nh t\u01b0\u01a1ng \u1ee9ng trong trie, th\u00ec ch\u00fang ta v\u1eabn ph\u1ea3i \u0111i v\u00e0o m\u1ed9t tr\u1ea1ng th\u00e1i n\u00e0o \u0111\u00f3.</p> <p>Ch\u00ednh x\u00e1c h\u01a1n, gi\u1ea3 s\u1eed ch\u00fang ta \u0111ang \u1edf tr\u1ea1ng th\u00e1i t\u01b0\u01a1ng \u1ee9ng v\u1edbi chu\u1ed7i $t$, v\u00e0 ch\u00fang ta mu\u1ed1n chuy\u1ec3n sang m\u1ed9t tr\u1ea1ng th\u00e1i kh\u00e1c b\u1eb1ng k\u00fd t\u1ef1 $c$. N\u1ebfu c\u00f3 m\u1ed9t c\u1ea1nh \u0111\u01b0\u1ee3c g\u1eafn nh\u00e3n b\u1eb1ng ch\u1eef c\u00e1i $c$ n\u00e0y, th\u00ec ch\u00fang ta c\u00f3 th\u1ec3 ch\u1ec9 c\u1ea7n \u0111i qua c\u1ea1nh n\u00e0y v\u00e0 l\u1ea5y \u0111\u1ec9nh t\u01b0\u01a1ng \u1ee9ng v\u1edbi $t + c$. N\u1ebfu kh\u00f4ng c\u00f3 c\u1ea1nh nh\u01b0 v\u1eady, v\u00ec ch\u00fang ta mu\u1ed1n duy tr\u00ec b\u1ea5t bi\u1ebfn (invariant) r\u1eb1ng tr\u1ea1ng th\u00e1i hi\u1ec7n t\u1ea1i l\u00e0 ph\u1ea7n kh\u1edbp m\u1ed9t ph\u1ea7n d\u00e0i nh\u1ea5t trong chu\u1ed7i \u0111\u01b0\u1ee3c x\u1eed l\u00fd, ch\u00fang ta ph\u1ea3i t\u00ecm chu\u1ed7i d\u00e0i nh\u1ea5t trong trie l\u00e0 h\u1eadu t\u1ed1 th\u1ef1c s\u1ef1 c\u1ee7a chu\u1ed7i $t$ v\u00e0 c\u1ed1 g\u1eafng th\u1ef1c hi\u1ec7n chuy\u1ec3n \u0111\u1ed5i t\u1eeb \u0111\u00f3.</p> <p>V\u00ed d\u1ee5: h\u00e3y \u0111\u1ec3 trie \u0111\u01b0\u1ee3c x\u00e2y d\u1ef1ng b\u1edfi c\u00e1c chu\u1ed7i $ab$ v\u00e0 $bc$, v\u00e0 ch\u00fang ta hi\u1ec7n \u0111ang \u1edf \u0111\u1ec9nh t\u01b0\u01a1ng \u1ee9ng v\u1edbi $ab$, \u0111\u00e2y c\u0169ng l\u00e0 m\u1ed9t \u0111\u1ec9nh $\\text{output}$. \u0110\u1ec3 chuy\u1ec3n \u0111\u1ed5i v\u1edbi ch\u1eef c\u00e1i $c$, ch\u00fang ta bu\u1ed9c ph\u1ea3i \u0111i \u0111\u1ebfn tr\u1ea1ng th\u00e1i t\u01b0\u01a1ng \u1ee9ng v\u1edbi chu\u1ed7i $b$, v\u00e0 t\u1eeb \u0111\u00f3 \u0111i theo c\u1ea1nh v\u1edbi ch\u1eef c\u00e1i $c$.</p> M\u1ed9t automaton Aho-Corasick d\u1ef1a tr\u00ean c\u00e1c t\u1eeb \"a\", \"ab\", \"bc\", \"bca\", \"c\" v\u00e0 \"caa\". M\u0169i t\u00ean m\u00e0u xanh l\u00e0 li\u00ean k\u1ebft h\u1eadu t\u1ed1 (suffix match), m\u0169i t\u00ean m\u00e0u xanh l\u00e1 c\u00e2y l\u00e0 li\u00ean k\u1ebft k\u1ebft th\u00fac (terminal link). <p>M\u1ed9t li\u00ean k\u1ebft h\u1eadu t\u1ed1 (suffix link) cho m\u1ed9t \u0111\u1ec9nh $p$ l\u00e0 m\u1ed9t c\u1ea1nh tr\u1ecf \u0111\u1ebfn h\u1eadu t\u1ed1 th\u1ef1c s\u1ef1 d\u00e0i nh\u1ea5t c\u1ee7a chu\u1ed7i t\u01b0\u01a1ng \u1ee9ng v\u1edbi \u0111\u1ec9nh $p$. Tr\u01b0\u1eddng h\u1ee3p \u0111\u1eb7c bi\u1ec7t duy nh\u1ea5t l\u00e0 g\u1ed1c c\u1ee7a trie, c\u00f3 li\u00ean k\u1ebft h\u1eadu t\u1ed1 s\u1ebd tr\u1ecf \u0111\u1ebfn ch\u00ednh n\u00f3. B\u00e2y gi\u1edd ch\u00fang ta c\u00f3 th\u1ec3 c\u1ea3i t\u1ed5 l\u1ea1i tuy\u00ean b\u1ed1 v\u1ec1 c\u00e1c chuy\u1ec3n \u0111\u1ed5i trong automaton nh\u01b0 th\u1ebf n\u00e0y: trong khi kh\u00f4ng c\u00f3 chuy\u1ec3n \u0111\u1ed5i t\u1eeb \u0111\u1ec9nh hi\u1ec7n t\u1ea1i c\u1ee7a trie s\u1eed d\u1ee5ng ch\u1eef c\u00e1i hi\u1ec7n t\u1ea1i (ho\u1eb7c cho \u0111\u1ebfn khi ch\u00fang ta \u0111\u1ebfn g\u1ed1c), ch\u00fang ta \u0111i theo li\u00ean k\u1ebft h\u1eadu t\u1ed1.</p> <p>Do \u0111\u00f3, ch\u00fang ta \u0111\u00e3 gi\u1ea3m v\u1ea5n \u0111\u1ec1 x\u00e2y d\u1ef1ng automaton th\u00e0nh v\u1ea5n \u0111\u1ec1 t\u00ecm li\u00ean k\u1ebft h\u1eadu t\u1ed1 cho t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh c\u1ee7a trie. Tuy nhi\u00ean, ch\u00fang ta s\u1ebd x\u00e2y d\u1ef1ng c\u00e1c li\u00ean k\u1ebft h\u1eadu t\u1ed1 n\u00e0y, th\u1eadt k\u1ef3 l\u1ea1, b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng c\u00e1c chuy\u1ec3n \u0111\u1ed5i \u0111\u01b0\u1ee3c x\u00e2y d\u1ef1ng trong automaton.</p> <p>C\u00e1c li\u00ean k\u1ebft h\u1eadu t\u1ed1 c\u1ee7a \u0111\u1ec9nh g\u1ed1c v\u00e0 t\u1ea5t c\u1ea3 c\u00e1c con tr\u1ef1c ti\u1ebfp c\u1ee7a n\u00f3 tr\u1ecf \u0111\u1ebfn \u0111\u1ec9nh g\u1ed1c. \u0110\u1ed1i v\u1edbi b\u1ea5t k\u1ef3 \u0111\u1ec9nh $v$ n\u00e0o s\u00e2u h\u01a1n trong c\u00e2y, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh to\u00e1n li\u00ean k\u1ebft h\u1eadu t\u1ed1 nh\u01b0 sau: n\u1ebfu $p$ l\u00e0 t\u1ed5 ti\u00ean c\u1ee7a $v$ v\u1edbi $c$ l\u00e0 ch\u1eef c\u00e1i g\u1eafn nh\u00e3n c\u1ea1nh t\u1eeb $p$ \u0111\u1ebfn $v$, \u0111i \u0111\u1ebfn $p$, sau \u0111\u00f3 \u0111i theo li\u00ean k\u1ebft h\u1eadu t\u1ed1 c\u1ee7a n\u00f3, v\u00e0 th\u1ef1c hi\u1ec7n chuy\u1ec3n \u0111\u1ed5i v\u1edbi ch\u1eef c\u00e1i $c$ t\u1eeb \u0111\u00f3.</p> <p>Do \u0111\u00f3, v\u1ea5n \u0111\u1ec1 t\u00ecm c\u00e1c chuy\u1ec3n \u0111\u1ed5i \u0111\u00e3 \u0111\u01b0\u1ee3c gi\u1ea3m th\u00e0nh v\u1ea5n \u0111\u1ec1 t\u00ecm c\u00e1c li\u00ean k\u1ebft h\u1eadu t\u1ed1, v\u00e0 v\u1ea5n \u0111\u1ec1 t\u00ecm c\u00e1c li\u00ean k\u1ebft h\u1eadu t\u1ed1 \u0111\u00e3 \u0111\u01b0\u1ee3c gi\u1ea3m th\u00e0nh v\u1ea5n \u0111\u1ec1 t\u00ecm m\u1ed9t li\u00ean k\u1ebft h\u1eadu t\u1ed1 v\u00e0 m\u1ed9t chuy\u1ec3n \u0111\u1ed5i, ngo\u1ea1i tr\u1eeb c\u00e1c \u0111\u1ec9nh g\u1ea7n g\u1ed1c h\u01a1n. V\u00ec v\u1eady, ch\u00fang ta c\u00f3 m\u1ed9t s\u1ef1 ph\u1ee5 thu\u1ed9c \u0111\u1ec7 quy m\u00e0 ch\u00fang ta c\u00f3 th\u1ec3 gi\u1ea3i quy\u1ebft trong th\u1eddi gian tuy\u1ebfn t\u00ednh.</p> <p>H\u00e3y chuy\u1ec3n sang ph\u1ea7n c\u00e0i \u0111\u1eb7t. L\u01b0u \u00fd r\u1eb1ng b\u00e2y gi\u1edd ch\u00fang ta s\u1ebd l\u01b0u tr\u1eef t\u1ed5 ti\u00ean $p$ v\u00e0 k\u00fd t\u1ef1 $pch$ c\u1ee7a c\u1ea1nh t\u1eeb $p$ \u0111\u1ebfn $v$ cho m\u1ed7i \u0111\u1ec9nh $v$. Ngo\u00e0i ra, t\u1ea1i m\u1ed7i \u0111\u1ec9nh, ch\u00fang ta s\u1ebd l\u01b0u tr\u1eef li\u00ean k\u1ebft h\u1eadu t\u1ed1 $\\text{link}$ (ho\u1eb7c $-1$ n\u1ebfu n\u00f3 ch\u01b0a \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n), v\u00e0 trong m\u1ea3ng $\\text{go}[k]$ l\u01b0u tr\u1eef c\u00e1c chuy\u1ec3n \u0111\u1ed5i trong m\u00e1y cho m\u1ed7i k\u00fd hi\u1ec7u (m\u1ed9t l\u1ea7n n\u1eefa l\u00e0 $-1$ n\u1ebfu n\u00f3 ch\u01b0a \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n).</p> <pre><code>const int K = 26;\n\nstruct Vertex {\n    int next[K];\n    bool output = false;\n    int p = -1;\n    char pch;\n    int link = -1;\n    int go[K];\n\n    Vertex(int p=-1, char ch='$') : p(p), pch(ch) {\n        fill(begin(next), end(next), -1);\n        fill(begin(go), end(go), -1);\n    }\n};\n\nvector&lt;Vertex&gt; t(1);\n\nvoid add_string(string const&amp; s) {\n    int v = 0;\n    for (char ch : s) {\n        int c = ch - 'a';\n        if (t[v].next[c] == -1) {\n            t[v].next[c] = t.size();\n            t.emplace_back(v, ch);\n        }\n        v = t[v].next[c];\n    }\n    t[v].output = true;\n}\n\nint go(int v, char ch);\n\nint get_link(int v) {\n    if (t[v].link == -1) {\n        if (v == 0 || t[v].p == 0)\n            t[v].link = 0;\n        else\n            t[v].link = go(get_link(t[v].p), t[v].pch);\n    }\n    return t[v].link;\n}\n\nint go(int v, char ch) {\n    int c = ch - 'a';\n    if (t[v].go[c] == -1) {\n        if (t[v].next[c] != -1)\n            t[v].go[c] = t[v].next[c];\n        else\n            t[v].go[c] = v == 0 ? 0 : go(get_link(v), ch);\n    }\n    return t[v].go[c];\n} \n</code></pre> <p>D\u1ec5 th\u1ea5y r\u1eb1ng nh\u1edd vi\u1ec7c ghi nh\u1edb (memoization) c\u00e1c li\u00ean k\u1ebft h\u1eadu t\u1ed1 v\u00e0 chuy\u1ec3n \u0111\u1ed5i, t\u1ed5ng th\u1eddi gian \u0111\u1ec3 t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c li\u00ean k\u1ebft h\u1eadu t\u1ed1 v\u00e0 chuy\u1ec3n \u0111\u1ed5i s\u1ebd l\u00e0 tuy\u1ebfn t\u00ednh.</p> <p>\u0110\u1ec3 minh h\u1ecda cho kh\u00e1i ni\u1ec7m n\u00e0y, h\u00e3y tham kh\u1ea3o slide s\u1ed1 103 c\u1ee7a Stanford slides.</p>","tags":["Translated"]},{"location":"string/aho_corasick.html#bfs-based-construction","title":"X\u00e2y d\u1ef1ng d\u1ef1a tr\u00ean BFS (BFS-based construction)","text":"<p>Thay v\u00ec t\u00ednh to\u00e1n c\u00e1c chuy\u1ec3n \u0111\u1ed5i v\u00e0 li\u00ean k\u1ebft h\u1eadu t\u1ed1 b\u1eb1ng c\u00e1c l\u1ec7nh g\u1ecdi \u0111\u1ec7 quy \u0111\u1ebfn <code>go</code> v\u00e0 <code>get_link</code>, c\u00f3 th\u1ec3 t\u00ednh to\u00e1n ch\u00fang t\u1eeb d\u01b0\u1edbi l\u00ean b\u1eaft \u0111\u1ea7u t\u1eeb g\u1ed1c. (Trong th\u1ef1c t\u1ebf, khi t\u1eeb \u0111i\u1ec3n ch\u1ec9 bao g\u1ed3m m\u1ed9t chu\u1ed7i, ch\u00fang ta thu \u0111\u01b0\u1ee3c thu\u1eadt to\u00e1n Knuth-Morris-Pratt quen thu\u1ed9c.)</p> <p>C\u00e1ch ti\u1ebfp c\u1eadn n\u00e0y s\u1ebd c\u00f3 m\u1ed9t s\u1ed1 l\u1ee3i th\u1ebf so v\u1edbi c\u00e1ch \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 \u1edf tr\u00ean v\u00ec, thay v\u00ec t\u1ed5ng \u0111\u1ed9 d\u00e0i $m$, th\u1eddi gian ch\u1ea1y c\u1ee7a n\u00f3 ch\u1ec9 ph\u1ee5 thu\u1ed9c v\u00e0o s\u1ed1 l\u01b0\u1ee3ng \u0111\u1ec9nh $n$ trong trie. H\u01a1n n\u1eefa, c\u00f3 th\u1ec3 \u0111i\u1ec1u ch\u1ec9nh n\u00f3 cho c\u00e1c b\u1ea3ng ch\u1eef c\u00e1i l\u1edbn b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng c\u1ea5u tr\u00fac d\u1eef li\u1ec7u m\u1ea3ng b\u1ec1n v\u1eefng (persistent array data structure), do \u0111\u00f3 l\u00e0m cho th\u1eddi gian x\u00e2y d\u1ef1ng $O(n \\log k)$ thay v\u00ec $O(mk)$, \u0111\u00e2y l\u00e0 m\u1ed9t c\u1ea3i ti\u1ebfn \u0111\u00e1ng k\u1ec3 v\u1edbi \u0111i\u1ec1u ki\u1ec7n $m$ c\u00f3 th\u1ec3 l\u00ean t\u1edbi $n^2$.</p> <p>Ch\u00fang ta c\u00f3 th\u1ec3 suy lu\u1eadn theo quy n\u1ea1p b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng th\u1ef1c t\u1ebf l\u00e0 BFS t\u1eeb g\u1ed1c \u0111i qua c\u00e1c \u0111\u1ec9nh theo th\u1ee9 t\u1ef1 \u0111\u1ed9 d\u00e0i t\u0103ng d\u1ea7n. Ch\u00fang ta c\u00f3 th\u1ec3 gi\u1ea3 \u0111\u1ecbnh r\u1eb1ng khi ch\u00fang ta \u1edf m\u1ed9t \u0111\u1ec9nh $v$, li\u00ean k\u1ebft h\u1eadu t\u1ed1 c\u1ee7a n\u00f3 $u = link[v]$ \u0111\u00e3 \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n th\u00e0nh c\u00f4ng v\u00e0 \u0111\u1ed1i v\u1edbi t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh c\u00f3 \u0111\u1ed9 d\u00e0i ng\u1eafn h\u01a1n, c\u00e1c chuy\u1ec3n \u0111\u1ed5i t\u1eeb ch\u00fang c\u0169ng \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n \u0111\u1ea7y \u0111\u1ee7.</p> <p>Gi\u1ea3 s\u1eed r\u1eb1ng t\u1ea1i th\u1eddi \u0111i\u1ec3m n\u00e0y ch\u00fang ta \u0111ang \u0111\u1ee9ng \u1edf m\u1ed9t \u0111\u1ec9nh $v$ v\u00e0 xem x\u00e9t m\u1ed9t k\u00fd t\u1ef1 $c$. V\u1ec1 c\u01a1 b\u1ea3n ch\u00fang ta c\u00f3 hai tr\u01b0\u1eddng h\u1ee3p:</p> <ol> <li>$go[v][c] = -1$. Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, ch\u00fang ta c\u00f3 th\u1ec3 g\u00e1n $go[v][c] = go[u][c]$, \u0111i\u1ec1u n\u00e0y \u0111\u00e3 \u0111\u01b0\u1ee3c bi\u1ebft \u0111\u1ebfn theo gi\u1ea3 thuy\u1ebft quy n\u1ea1p;</li> <li>$go[v][c] = w \\neq -1$. Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, ch\u00fang ta c\u00f3 th\u1ec3 g\u00e1n $link[w] = go[u][c]$.</li> </ol> <p>Theo c\u00e1ch n\u00e0y, ch\u00fang ta d\u00e0nh th\u1eddi gian $O(1)$ cho m\u1ed7i c\u1eb7p \u0111\u1ec9nh v\u00e0 k\u00fd t\u1ef1, l\u00e0m cho th\u1eddi gian ch\u1ea1y l\u00e0 $O(nk)$. Chi ph\u00ed ch\u00ednh \u1edf \u0111\u00e2y l\u00e0 ch\u00fang ta sao ch\u00e9p r\u1ea5t nhi\u1ec1u chuy\u1ec3n \u0111\u1ed5i t\u1eeb $u$ trong tr\u01b0\u1eddng h\u1ee3p \u0111\u1ea7u ti\u00ean, trong khi c\u00e1c chuy\u1ec3n \u0111\u1ed5i c\u1ee7a tr\u01b0\u1eddng h\u1ee3p th\u1ee9 hai t\u1ea1o th\u00e0nh trie v\u00e0 t\u1ed5ng c\u1ed9ng l\u00ean t\u1edbi $n$ tr\u00ean t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh. \u0110\u1ec3 tr\u00e1nh sao ch\u00e9p $go[u][c]$, ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng c\u1ea5u tr\u00fac d\u1eef li\u1ec7u m\u1ea3ng b\u1ec1n v\u1eefng, s\u1eed d\u1ee5ng n\u00f3 ban \u0111\u1ea7u ch\u00fang ta sao ch\u00e9p $go[u]$ v\u00e0o $go[v]$ v\u00e0 sau \u0111\u00f3 ch\u1ec9 c\u1eadp nh\u1eadt c\u00e1c gi\u00e1 tr\u1ecb cho c\u00e1c k\u00fd t\u1ef1 trong \u0111\u00f3 qu\u00e1 tr\u00ecnh chuy\u1ec3n \u0111\u1ed5i s\u1ebd kh\u00e1c nhau. \u0110i\u1ec1u n\u00e0y d\u1eabn \u0111\u1ebfn thu\u1eadt to\u00e1n $O(n \\log k)$.</p>","tags":["Translated"]},{"location":"string/aho_corasick.html#applications","title":"\u1ee8ng d\u1ee5ng (Applications)","text":"","tags":["Translated"]},{"location":"string/aho_corasick.html#find-all-strings-from-a-given-set-in-a-text","title":"T\u00ecm t\u1ea5t c\u1ea3 c\u00e1c chu\u1ed7i t\u1eeb m\u1ed9t t\u1eadp h\u1ee3p nh\u1ea5t \u0111\u1ecbnh trong m\u1ed9t v\u0103n b\u1ea3n (Find all strings from a given set in a text)","text":"<p>Ch\u00fang ta \u0111\u01b0\u1ee3c cho m\u1ed9t t\u1eadp h\u1ee3p c\u00e1c chu\u1ed7i v\u00e0 m\u1ed9t v\u0103n b\u1ea3n. Ch\u00fang ta ph\u1ea3i in t\u1ea5t c\u1ea3 c\u00e1c l\u1ea7n xu\u1ea5t hi\u1ec7n c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c chu\u1ed7i t\u1eeb t\u1eadp h\u1ee3p trong v\u0103n b\u1ea3n \u0111\u00e3 cho trong $O(\\text{len} + \\text{ans})$, trong \u0111\u00f3 $\\text{len}$ l\u00e0 \u0111\u1ed9 d\u00e0i c\u1ee7a v\u0103n b\u1ea3n v\u00e0 $\\text{ans}$ l\u00e0 k\u00edch th\u01b0\u1edbc c\u1ee7a c\u00e2u tr\u1ea3 l\u1eddi.</p> <p>Ch\u00fang ta x\u00e2y d\u1ef1ng m\u1ed9t automaton cho t\u1eadp h\u1ee3p c\u00e1c chu\u1ed7i n\u00e0y. B\u00e2y gi\u1edd ch\u00fang ta s\u1ebd x\u1eed l\u00fd v\u0103n b\u1ea3n t\u1eebng ch\u1eef c\u00e1i m\u1ed9t b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng automaton, b\u1eaft \u0111\u1ea7u t\u1eeb g\u1ed1c c\u1ee7a trie. N\u1ebfu ch\u00fang ta \u1edf b\u1ea5t k\u1ef3 l\u00fac n\u00e0o t\u1ea1i tr\u1ea1ng th\u00e1i $v$, v\u00e0 k\u00fd t\u1ef1 ti\u1ebfp theo l\u00e0 $c$, th\u00ec ch\u00fang ta chuy\u1ec3n sang tr\u1ea1ng th\u00e1i ti\u1ebfp theo v\u1edbi $\\text{go}(v, c)$, do \u0111\u00f3 ho\u1eb7c t\u0103ng \u0111\u1ed9 d\u00e0i c\u1ee7a chu\u1ed7i con kh\u1edbp hi\u1ec7n t\u1ea1i th\u00eam $1$, ho\u1eb7c gi\u1ea3m n\u00f3 b\u1eb1ng c\u00e1ch \u0111i theo m\u1ed9t li\u00ean k\u1ebft h\u1eadu t\u1ed1.</p> <p>L\u00e0m th\u1ebf n\u00e0o ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm ra cho m\u1ed9t tr\u1ea1ng th\u00e1i $v$, n\u1ebfu c\u00f3 b\u1ea5t k\u1ef3 k\u1ebft qu\u1ea3 kh\u1edbp n\u00e0o v\u1edbi c\u00e1c chu\u1ed7i cho t\u1eadp h\u1ee3p? \u0110\u1ea7u ti\u00ean, r\u00f5 r\u00e0ng l\u00e0 n\u1ebfu ch\u00fang ta \u0111\u1ee9ng tr\u00ean m\u1ed9t \u0111\u1ec9nh $\\text{output}$, th\u00ec chu\u1ed7i t\u01b0\u01a1ng \u1ee9ng v\u1edbi \u0111\u1ec9nh \u0111\u00f3 k\u1ebft th\u00fac t\u1ea1i v\u1ecb tr\u00ed n\u00e0y trong v\u0103n b\u1ea3n. Tuy nhi\u00ean, \u0111\u00e2y ho\u00e0n to\u00e0n kh\u00f4ng ph\u1ea3i l\u00e0 tr\u01b0\u1eddng h\u1ee3p duy nh\u1ea5t c\u00f3 th\u1ec3 \u0111\u1ea1t \u0111\u01b0\u1ee3c m\u1ed9t k\u1ebft qu\u1ea3 kh\u1edbp: n\u1ebfu ch\u00fang ta c\u00f3 th\u1ec3 \u0111\u1ea1t \u0111\u01b0\u1ee3c m\u1ed9t ho\u1eb7c nhi\u1ec1u \u0111\u1ec9nh $\\text{output}$ b\u1eb1ng c\u00e1ch di chuy\u1ec3n d\u1ecdc theo c\u00e1c li\u00ean k\u1ebft h\u1eadu t\u1ed1, th\u00ec c\u0169ng s\u1ebd c\u00f3 m\u1ed9t k\u1ebft qu\u1ea3 kh\u1edbp t\u01b0\u01a1ng \u1ee9ng v\u1edbi m\u1ed7i \u0111\u1ec9nh $\\text{output}$ \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y. M\u1ed9t v\u00ed d\u1ee5 \u0111\u01a1n gi\u1ea3n ch\u1ee9ng minh t\u00ecnh hu\u1ed1ng n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u1ea1o b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng t\u1eadp h\u1ee3p c\u00e1c chu\u1ed7i $\\{dabce, abc, bc\\}$ v\u00e0 v\u0103n b\u1ea3n $dabc$.</p> <p>Do \u0111\u00f3, n\u1ebfu ch\u00fang ta l\u01b0u tr\u1eef trong m\u1ed7i \u0111\u1ec9nh $\\text{output}$ ch\u1ec9 s\u1ed1 c\u1ee7a chu\u1ed7i t\u01b0\u01a1ng \u1ee9ng v\u1edbi n\u00f3 (ho\u1eb7c danh s\u00e1ch c\u00e1c ch\u1ec9 s\u1ed1 n\u1ebfu c\u00e1c chu\u1ed7i tr\u00f9ng l\u1eb7p xu\u1ea5t hi\u1ec7n trong t\u1eadp h\u1ee3p), th\u00ec ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm th\u1ea5y trong th\u1eddi gian $O(n)$ c\u00e1c ch\u1ec9 s\u1ed1 c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c chu\u1ed7i kh\u1edbp v\u1edbi tr\u1ea1ng th\u00e1i hi\u1ec7n t\u1ea1i, b\u1eb1ng c\u00e1ch \u0111\u01a1n gi\u1ea3n l\u00e0 \u0111i theo c\u00e1c li\u00ean k\u1ebft h\u1eadu t\u1ed1 t\u1eeb \u0111\u1ec9nh hi\u1ec7n t\u1ea1i \u0111\u1ebfn g\u1ed1c. \u0110\u00e2y kh\u00f4ng ph\u1ea3i l\u00e0 gi\u1ea3i ph\u00e1p hi\u1ec7u qu\u1ea3 nh\u1ea5t, v\u00ec \u0111i\u1ec1u n\u00e0y d\u1eabn \u0111\u1ebfn \u0111\u1ed9 ph\u1ee9c t\u1ea1p t\u1ed5ng th\u1ec3 l\u00e0 $O(n ~ \\text{len})$. Tuy nhi\u00ean, \u0111i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u1ed1i \u01b0u h\u00f3a b\u1eb1ng c\u00e1ch t\u00ednh to\u00e1n v\u00e0 l\u01b0u tr\u1eef \u0111\u1ec9nh $\\text{output}$ g\u1ea7n nh\u1ea5t c\u00f3 th\u1ec3 truy c\u1eadp \u0111\u01b0\u1ee3c b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng c\u00e1c li\u00ean k\u1ebft h\u1eadu t\u1ed1 (\u0111\u00f4i khi \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 li\u00ean k\u1ebft tho\u00e1t (exit link)). Gi\u00e1 tr\u1ecb n\u00e0y ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh to\u00e1n m\u1ed9t c\u00e1ch l\u01b0\u1eddi bi\u1ebfng trong th\u1eddi gian tuy\u1ebfn t\u00ednh. Do \u0111\u00f3, \u0111\u1ed1i v\u1edbi m\u1ed7i \u0111\u1ec9nh, ch\u00fang ta c\u00f3 th\u1ec3 ti\u1ebfn trong th\u1eddi gian $O(1)$ \u0111\u1ebfn \u0111\u1ec9nh \u0111\u01b0\u1ee3c \u0111\u00e1nh d\u1ea5u ti\u1ebfp theo trong \u0111\u01b0\u1eddng d\u1eabn li\u00ean k\u1ebft h\u1eadu t\u1ed1, t\u1ee9c l\u00e0 \u0111\u1ebfn k\u1ebft qu\u1ea3 kh\u1edbp ti\u1ebfp theo. Do \u0111\u00f3, \u0111\u1ed1i v\u1edbi m\u1ed7i tr\u1eadn \u0111\u1ea5u, ch\u00fang t\u00f4i d\u00e0nh th\u1eddi gian $O(1)$, v\u00e0 do \u0111\u00f3 ch\u00fang t\u00f4i \u0111\u1ea1t \u0111\u1ebfn \u0111\u1ed9 ph\u1ee9c t\u1ea1p $O(\\text{len} + \\text{ans})$.</p> <p>N\u1ebfu b\u1ea1n ch\u1ec9 mu\u1ed1n \u0111\u1ebfm s\u1ed1 l\u1ea7n xu\u1ea5t hi\u1ec7n v\u00e0 kh\u00f4ng t\u00ecm th\u1ea5y ch\u00ednh c\u00e1c ch\u1ec9 s\u1ed1, b\u1ea1n c\u00f3 th\u1ec3 t\u00ednh to\u00e1n s\u1ed1 l\u01b0\u1ee3ng c\u00e1c \u0111\u1ec9nh \u0111\u01b0\u1ee3c \u0111\u00e1nh d\u1ea5u trong \u0111\u01b0\u1eddng d\u1eabn li\u00ean k\u1ebft h\u1eadu t\u1ed1 cho m\u1ed7i \u0111\u1ec9nh $v$. \u0110i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n trong t\u1ed5ng th\u1eddi gian $O(n)$. Do \u0111\u00f3 ch\u00fang ta c\u00f3 th\u1ec3 t\u1ed5ng h\u1ee3p t\u1ea5t c\u1ea3 c\u00e1c k\u1ebft qu\u1ea3 kh\u1edbp trong $O(\\text{len})$.</p>","tags":["Translated"]},{"location":"string/aho_corasick.html#finding-the-lexicographically-smallest-string-of-a-given-length-that-doesnt-match-any-given-strings","title":"T\u00ecm chu\u1ed7i nh\u1ecf nh\u1ea5t theo t\u1eeb \u0111i\u1ec3n c\u00f3 \u0111\u1ed9 d\u00e0i nh\u1ea5t \u0111\u1ecbnh kh\u00f4ng kh\u1edbp v\u1edbi b\u1ea5t k\u1ef3 chu\u1ed7i n\u00e0o \u0111\u00e3 cho (Finding the lexicographically smallest string of a given length that doesn't match any given strings)","text":"<p>M\u1ed9t t\u1eadp h\u1ee3p c\u00e1c chu\u1ed7i v\u00e0 m\u1ed9t \u0111\u1ed9 d\u00e0i $L$ \u0111\u01b0\u1ee3c \u0111\u01b0a ra. Ch\u00fang ta ph\u1ea3i t\u00ecm m\u1ed9t chu\u1ed7i c\u00f3 \u0111\u1ed9 d\u00e0i $L$, kh\u00f4ng ch\u1ee9a b\u1ea5t k\u1ef3 chu\u1ed7i n\u00e0o, v\u00e0 l\u1ea5y chu\u1ed7i nh\u1ecf nh\u1ea5t theo t\u1eeb \u0111i\u1ec3n trong s\u1ed1 c\u00e1c chu\u1ed7i \u0111\u00f3.</p> <p>Ch\u00fang ta c\u00f3 th\u1ec3 x\u00e2y d\u1ef1ng automaton cho t\u1eadp h\u1ee3p c\u00e1c chu\u1ed7i. Nh\u1edb l\u1ea1i r\u1eb1ng c\u00e1c \u0111\u1ec9nh $\\text{output}$ l\u00e0 c\u00e1c tr\u1ea1ng th\u00e1i m\u00e0 ch\u00fang ta c\u00f3 m\u1ed9t k\u1ebft qu\u1ea3 kh\u1edbp v\u1edbi m\u1ed9t chu\u1ed7i t\u1eeb t\u1eadp h\u1ee3p. V\u00ec trong nhi\u1ec7m v\u1ee5 n\u00e0y ch\u00fang ta ph\u1ea3i tr\u00e1nh c\u00e1c k\u1ebft qu\u1ea3 kh\u1edbp, ch\u00fang ta kh\u00f4ng \u0111\u01b0\u1ee3c ph\u00e9p v\u00e0o c\u00e1c tr\u1ea1ng th\u00e1i nh\u01b0 v\u1eady. M\u1eb7t kh\u00e1c, ch\u00fang ta c\u00f3 th\u1ec3 nh\u1eadp t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh kh\u00e1c. Do \u0111\u00f3, ch\u00fang ta x\u00f3a t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh \"x\u1ea5u\" kh\u1ecfi m\u00e1y, v\u00e0 trong bi\u1ec3u \u0111\u1ed3 c\u00f2n l\u1ea1i c\u1ee7a automaton, ch\u00fang ta t\u00ecm \u0111\u01b0\u1eddng d\u1eabn nh\u1ecf nh\u1ea5t theo t\u1eeb \u0111i\u1ec3n c\u00f3 \u0111\u1ed9 d\u00e0i $L$. Nhi\u1ec7m v\u1ee5 n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i quy\u1ebft trong $O(L)$ v\u00ed d\u1ee5 b\u1eb1ng c\u00e1ch t\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u.</p>","tags":["Translated"]},{"location":"string/aho_corasick.html#finding-the-shortest-string-containing-all-given-strings","title":"T\u00ecm chu\u1ed7i ng\u1eafn nh\u1ea5t ch\u1ee9a t\u1ea5t c\u1ea3 c\u00e1c chu\u1ed7i \u0111\u00e3 cho (Finding the shortest string containing all given strings)","text":"<p>\u1ede \u0111\u00e2y ch\u00fang ta s\u1eed d\u1ee5ng nh\u1eefng \u00fd t\u01b0\u1edfng t\u01b0\u01a1ng t\u1ef1. \u0110\u1ed1i v\u1edbi m\u1ed7i \u0111\u1ec9nh, ch\u00fang ta l\u01b0u tr\u1eef m\u1ed9t m\u1eb7t n\u1ea1 (mask) bi\u1ec3u th\u1ecb c\u00e1c chu\u1ed7i kh\u1edbp \u1edf tr\u1ea1ng th\u00e1i n\u00e0y. Sau \u0111\u00f3, b\u00e0i to\u00e1n c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c c\u1ea3i t\u1ed5 l\u1ea1i nh\u01b0 sau: ban \u0111\u1ea7u \u1edf tr\u1ea1ng th\u00e1i $(v = \\text{root},~ \\text{mask} = 0)$, ch\u00fang ta mu\u1ed1n \u0111\u1ea1t \u0111\u1ebfn tr\u1ea1ng th\u00e1i $(v,~ \\text{mask} = 2^n - 1)$, trong \u0111\u00f3 $n$ l\u00e0 s\u1ed1 l\u01b0\u1ee3ng chu\u1ed7i trong t\u1eadp h\u1ee3p. Khi ch\u00fang ta chuy\u1ec3n t\u1eeb tr\u1ea1ng th\u00e1i n\u00e0y sang tr\u1ea1ng th\u00e1i kh\u00e1c b\u1eb1ng m\u1ed9t ch\u1eef c\u00e1i, ch\u00fang ta c\u1eadp nh\u1eadt m\u1eb7t n\u1ea1 cho ph\u00f9 h\u1ee3p. B\u1eb1ng c\u00e1ch ch\u1ea1y m\u1ed9t t\u00ecm ki\u1ebfm theo chi\u1ec1u r\u1ed9ng, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm th\u1ea5y m\u1ed9t \u0111\u01b0\u1eddng d\u1eabn \u0111\u1ebfn tr\u1ea1ng th\u00e1i $(v,~ \\text{mask} = 2^n - 1)$ v\u1edbi \u0111\u1ed9 d\u00e0i nh\u1ecf nh\u1ea5t.</p>","tags":["Translated"]},{"location":"string/aho_corasick.html#finding-the-lexicographically-smallest-string-of-length-l-containing-k-strings","title":"T\u00ecm chu\u1ed7i nh\u1ecf nh\u1ea5t theo t\u1eeb \u0111i\u1ec3n c\u00f3 \u0111\u1ed9 d\u00e0i $L$ ch\u1ee9a $k$ chu\u1ed7i (Finding the lexicographically smallest string of length $L$ containing $k$ strings)","text":"<p>Nh\u01b0 trong b\u00e0i to\u00e1n tr\u01b0\u1edbc, ch\u00fang ta t\u00ednh to\u00e1n cho m\u1ed7i \u0111\u1ec9nh s\u1ed1 l\u01b0\u1ee3ng k\u1ebft qu\u1ea3 kh\u1edbp t\u01b0\u01a1ng \u1ee9ng v\u1edbi n\u00f3 (\u0111\u00f3 l\u00e0 s\u1ed1 l\u01b0\u1ee3ng c\u00e1c \u0111\u1ec9nh \u0111\u01b0\u1ee3c \u0111\u00e1nh d\u1ea5u c\u00f3 th\u1ec3 truy c\u1eadp b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng c\u00e1c li\u00ean k\u1ebft h\u1eadu t\u1ed1). Ch\u00fang ta c\u1ea3i t\u1ed5 b\u00e0i to\u00e1n: tr\u1ea1ng th\u00e1i hi\u1ec7n t\u1ea1i \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh b\u1edfi m\u1ed9t b\u1ed9 ba s\u1ed1 $(v,~ \\text{len},~ \\text{cnt})$, v\u00e0 ch\u00fang ta mu\u1ed1n \u0111\u1ea1t \u0111\u01b0\u1ee3c t\u1eeb tr\u1ea1ng th\u00e1i $(\\text{root},~ 0,~ 0)$ \u0111\u1ebfn tr\u1ea1ng th\u00e1i $(v,~ L,~ k)$, trong \u0111\u00f3 $v$ c\u00f3 th\u1ec3 l\u00e0 b\u1ea5t k\u1ef3 \u0111\u1ec9nh n\u00e0o. Do \u0111\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm th\u1ea5y m\u1ed9t \u0111\u01b0\u1eddng d\u1eabn nh\u01b0 v\u1eady b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng t\u00ecm ki\u1ebfm theo chi\u1ec1u s\u00e2u (v\u00e0 n\u1ebfu t\u00ecm ki\u1ebfm nh\u00ecn v\u00e0o c\u00e1c c\u1ea1nh theo th\u1ee9 t\u1ef1 t\u1ef1 nhi\u00ean c\u1ee7a ch\u00fang, th\u00ec \u0111\u01b0\u1eddng d\u1eabn \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y s\u1ebd t\u1ef1 \u0111\u1ed9ng l\u00e0 nh\u1ecf nh\u1ea5t theo t\u1eeb \u0111i\u1ec3n).</p>","tags":["Translated"]},{"location":"string/aho_corasick.html#problems","title":"B\u00e0i t\u1eadp (Problems)","text":"<ul> <li>UVA #11590 - Prefix Lookup</li> <li>UVA #11171 - SMS</li> <li>UVA #10679 - I Love Strings!!</li> <li>Codeforces - x-prime Substrings</li> <li>Codeforces - Frequency of String</li> <li>CodeChef - TWOSTRS</li> </ul>","tags":["Translated"]},{"location":"string/aho_corasick.html#references","title":"T\u00e0i li\u1ec7u tham kh\u1ea3o (References)","text":"<ul> <li>Stanford's CS166 - Aho-Corasick Automata (Condensed)</li> </ul>","tags":["Translated"]},{"location":"string/expression_parsing.html","title":"Ph\u00e2n t\u00edch bi\u1ec3u th\u1ee9c (Expression parsing)","text":"<p>M\u1ed9t chu\u1ed7i ch\u1ee9a bi\u1ec3u th\u1ee9c to\u00e1n h\u1ecdc bao g\u1ed3m c\u00e1c s\u1ed1 v\u00e0 c\u00e1c to\u00e1n t\u1eed kh\u00e1c nhau \u0111\u01b0\u1ee3c \u0111\u01b0a ra. Ch\u00fang ta ph\u1ea3i t\u00ednh gi\u00e1 tr\u1ecb c\u1ee7a n\u00f3 trong $O(n)$, trong \u0111\u00f3 $n$ l\u00e0 \u0111\u1ed9 d\u00e0i c\u1ee7a chu\u1ed7i.</p> <p>Thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c th\u1ea3o lu\u1eadn \u1edf \u0111\u00e2y chuy\u1ec3n m\u1ed9t bi\u1ec3u th\u1ee9c sang c\u00e1i g\u1ecdi l\u00e0 k\u00fd ph\u00e1p Ba Lan ng\u01b0\u1ee3c (reverse Polish notation) (m\u1ed9t c\u00e1ch t\u01b0\u1eddng minh ho\u1eb7c ng\u1ea7m \u0111\u1ecbnh), v\u00e0 t\u00ednh to\u00e1n gi\u00e1 tr\u1ecb bi\u1ec3u th\u1ee9c n\u00e0y.</p>","tags":["Translated"]},{"location":"string/expression_parsing.html#reverse-polish-notation","title":"K\u00fd ph\u00e1p Ba Lan ng\u01b0\u1ee3c (Reverse Polish notation)","text":"<p>K\u00fd ph\u00e1p Ba Lan ng\u01b0\u1ee3c l\u00e0 m\u1ed9t d\u1ea1ng vi\u1ebft c\u00e1c bi\u1ec3u th\u1ee9c to\u00e1n h\u1ecdc, trong \u0111\u00f3 c\u00e1c to\u00e1n t\u1eed n\u1eb1m sau c\u00e1c to\u00e1n h\u1ea1ng c\u1ee7a ch\u00fang. V\u00ed d\u1ee5 bi\u1ec3u th\u1ee9c sau</p> $$a + b * c * d + (e - f) * (g * h + i)$$ <p>c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c vi\u1ebft b\u1eb1ng k\u00fd ph\u00e1p Ba Lan ng\u01b0\u1ee3c theo c\u00e1ch sau:</p> $$a b c * d * + e f - g h * i + * +$$ <p>K\u00fd ph\u00e1p Ba Lan ng\u01b0\u1ee3c \u0111\u01b0\u1ee3c ph\u00e1t tri\u1ec3n b\u1edfi nh\u00e0 tri\u1ebft h\u1ecdc v\u00e0 chuy\u00ean gia khoa h\u1ecdc m\u00e1y t\u00ednh ng\u01b0\u1eddi \u00dac Charles Hamblin v\u00e0o gi\u1eefa nh\u1eefng n\u0103m 1950 tr\u00ean c\u01a1 s\u1edf k\u00fd ph\u00e1p Ba Lan, \u0111\u01b0\u1ee3c \u0111\u1ec1 xu\u1ea5t v\u00e0o n\u0103m 1920 b\u1edfi nh\u00e0 to\u00e1n h\u1ecdc ng\u01b0\u1eddi Ba Lan Jan \u0141ukasiewicz.</p> <p>S\u1ef1 ti\u1ec7n l\u1ee3i c\u1ee7a k\u00fd ph\u00e1p Ba Lan ng\u01b0\u1ee3c l\u00e0 c\u00e1c bi\u1ec3u th\u1ee9c \u1edf d\u1ea1ng n\u00e0y r\u1ea5t d\u1ec5 t\u00ednh to\u00e1n trong th\u1eddi gian tuy\u1ebfn t\u00ednh. Ch\u00fang ta s\u1eed d\u1ee5ng m\u1ed9t ng\u0103n x\u1ebfp, ban \u0111\u1ea7u r\u1ed7ng. Ch\u00fang ta s\u1ebd duy\u1ec7t qua c\u00e1c to\u00e1n h\u1ea1ng v\u00e0 to\u00e1n t\u1eed c\u1ee7a bi\u1ec3u th\u1ee9c trong k\u00fd ph\u00e1p Ba Lan ng\u01b0\u1ee3c. N\u1ebfu ph\u1ea7n t\u1eed hi\u1ec7n t\u1ea1i l\u00e0 m\u1ed9t s\u1ed1, th\u00ec ch\u00fang ta \u0111\u1eb7t gi\u00e1 tr\u1ecb l\u00ean \u0111\u1ec9nh ng\u0103n x\u1ebfp, n\u1ebfu ph\u1ea7n t\u1eed hi\u1ec7n t\u1ea1i l\u00e0 m\u1ed9t to\u00e1n t\u1eed, th\u00ec ch\u00fang ta l\u1ea5y hai ph\u1ea7n t\u1eed tr\u00ean c\u00f9ng t\u1eeb ng\u0103n x\u1ebfp, th\u1ef1c hi\u1ec7n ph\u00e9p to\u00e1n v\u00e0 \u0111\u1eb7t k\u1ebft qu\u1ea3 tr\u1edf l\u1ea1i \u0111\u1ec9nh ng\u0103n x\u1ebfp. Cu\u1ed1i c\u00f9ng s\u1ebd c\u00f3 ch\u00ednh x\u00e1c m\u1ed9t ph\u1ea7n t\u1eed c\u00f2n l\u1ea1i trong ng\u0103n x\u1ebfp, \u0111\u00f3 s\u1ebd l\u00e0 gi\u00e1 tr\u1ecb c\u1ee7a bi\u1ec3u th\u1ee9c.</p> <p>R\u00f5 r\u00e0ng vi\u1ec7c t\u00ednh to\u00e1n \u0111\u01a1n gi\u1ea3n n\u00e0y ch\u1ea1y trong th\u1eddi gian $O(n)$.</p>","tags":["Translated"]},{"location":"string/expression_parsing.html#parsing-of-simple-expressions","title":"Ph\u00e2n t\u00edch c\u00e1c bi\u1ec3u th\u1ee9c \u0111\u01a1n gi\u1ea3n (Parsing of simple expressions)","text":"<p>Hi\u1ec7n t\u1ea1i ch\u00fang t\u00f4i ch\u1ec9 xem x\u00e9t m\u1ed9t v\u1ea5n \u0111\u1ec1 \u0111\u01a1n gi\u1ea3n h\u00f3a: ch\u00fang t\u00f4i gi\u1ea3 \u0111\u1ecbnh r\u1eb1ng t\u1ea5t c\u1ea3 c\u00e1c to\u00e1n t\u1eed l\u00e0 hai ng\u00f4i (binary) (t\u1ee9c l\u00e0 ch\u00fang l\u1ea5y hai \u0111\u1ed1i s\u1ed1), v\u00e0 t\u1ea5t c\u1ea3 \u0111\u1ec1u k\u1ebft h\u1ee3p tr\u00e1i (left-associative) (n\u1ebfu \u0111\u1ed9 \u01b0u ti\u00ean b\u1eb1ng nhau, ch\u00fang \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n t\u1eeb tr\u00e1i sang ph\u1ea3i). D\u1ea5u ngo\u1eb7c \u0111\u01a1n \u0111\u01b0\u1ee3c cho ph\u00e9p.</p> <p>Ch\u00fang ta s\u1ebd thi\u1ebft l\u1eadp hai ng\u0103n x\u1ebfp: m\u1ed9t cho s\u1ed1, v\u00e0 m\u1ed9t cho to\u00e1n t\u1eed v\u00e0 d\u1ea5u ngo\u1eb7c \u0111\u01a1n. Ban \u0111\u1ea7u c\u1ea3 hai ng\u0103n x\u1ebfp \u0111\u1ec1u r\u1ed7ng. \u0110\u1ed1i v\u1edbi ng\u0103n x\u1ebfp th\u1ee9 hai, ch\u00fang t\u00f4i s\u1ebd duy tr\u00ec \u0111i\u1ec1u ki\u1ec7n l\u00e0 t\u1ea5t c\u1ea3 c\u00e1c ho\u1ea1t \u0111\u1ed9ng \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp theo th\u1ee9 t\u1ef1 \u01b0u ti\u00ean gi\u1ea3m d\u1ea7n nghi\u00eam ng\u1eb7t. N\u1ebfu c\u00f3 d\u1ea5u ngo\u1eb7c \u0111\u01a1n tr\u00ean ng\u0103n x\u1ebfp, th\u00ec m\u1ed7i kh\u1ed1i to\u00e1n t\u1eed (t\u01b0\u01a1ng \u1ee9ng v\u1edbi m\u1ed9t c\u1eb7p d\u1ea5u ngo\u1eb7c \u0111\u01a1n) \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp, v\u00e0 to\u00e0n b\u1ed9 ng\u0103n x\u1ebfp kh\u00f4ng nh\u1ea5t thi\u1ebft ph\u1ea3i \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp.</p> <p>Ch\u00fang ta s\u1ebd duy\u1ec7t qua c\u00e1c k\u00fd t\u1ef1 c\u1ee7a bi\u1ec3u th\u1ee9c t\u1eeb tr\u00e1i sang ph\u1ea3i. N\u1ebfu k\u00fd t\u1ef1 hi\u1ec7n t\u1ea1i l\u00e0 m\u1ed9t ch\u1eef s\u1ed1, th\u00ec ch\u00fang ta \u0111\u1eb7t gi\u00e1 tr\u1ecb c\u1ee7a s\u1ed1 n\u00e0y l\u00ean ng\u0103n x\u1ebfp. N\u1ebfu k\u00fd t\u1ef1 hi\u1ec7n t\u1ea1i l\u00e0 d\u1ea5u ngo\u1eb7c \u0111\u01a1n m\u1edf, th\u00ec ch\u00fang ta \u0111\u1eb7t n\u00f3 l\u00ean ng\u0103n x\u1ebfp. N\u1ebfu k\u00fd t\u1ef1 hi\u1ec7n t\u1ea1i l\u00e0 d\u1ea5u ngo\u1eb7c \u0111\u01a1n \u0111\u00f3ng, ch\u00fang ta th\u1ef1c hi\u1ec7n t\u1ea5t c\u1ea3 c\u00e1c to\u00e1n t\u1eed tr\u00ean ng\u0103n x\u1ebfp cho \u0111\u1ebfn khi ch\u00fang ta \u0111\u1ebfn d\u1ea5u ngo\u1eb7c m\u1edf (n\u00f3i c\u00e1ch kh\u00e1c l\u00e0 ch\u00fang ta th\u1ef1c hi\u1ec7n t\u1ea5t c\u1ea3 c\u00e1c ph\u00e9p to\u00e1n b\u00ean trong d\u1ea5u ngo\u1eb7c \u0111\u01a1n). Cu\u1ed1i c\u00f9ng, n\u1ebfu k\u00fd t\u1ef1 hi\u1ec7n t\u1ea1i l\u00e0 m\u1ed9t to\u00e1n t\u1eed, th\u00ec trong khi \u0111\u1ec9nh ng\u0103n x\u1ebfp c\u00f3 m\u1ed9t to\u00e1n t\u1eed c\u00f3 \u0111\u1ed9 \u01b0u ti\u00ean t\u01b0\u01a1ng \u0111\u01b0\u01a1ng ho\u1eb7c cao h\u01a1n, ch\u00fang ta s\u1ebd th\u1ef1c hi\u1ec7n ph\u00e9p to\u00e1n n\u00e0y v\u00e0 \u0111\u1eb7t ph\u00e9p to\u00e1n m\u1edbi l\u00ean ng\u0103n x\u1ebfp.</p> <p>Sau khi ch\u00fang ta x\u1eed l\u00fd to\u00e0n b\u1ed9 chu\u1ed7i, m\u1ed9t s\u1ed1 to\u00e1n t\u1eed v\u1eabn c\u00f3 th\u1ec3 n\u1eb1m trong ng\u0103n x\u1ebfp, v\u00ec v\u1eady ch\u00fang ta th\u1ef1c hi\u1ec7n ch\u00fang.</p> <p>\u0110\u00e2y l\u00e0 vi\u1ec7c tri\u1ec3n khai ph\u01b0\u01a1ng ph\u00e1p n\u00e0y cho b\u1ed1n to\u00e1n t\u1eed $+$ $-$ $*$ $/$:</p> <pre><code>bool delim(char c) {\n    return c == ' ';\n}\n\nbool is_op(char c) {\n    return c == '+' || c == '-' || c == '*' || c == '/';\n}\n\nint priority (char op) {\n    if (op == '+' || op == '-')\n        return 1;\n    if (op == '*' || op == '/')\n        return 2;\n    return -1;\n}\n\nvoid process_op(stack&lt;int&gt;&amp; st, char op) {\n    int r = st.top(); st.pop();\n    int l = st.top(); st.pop();\n    switch (op) {\n        case '+': st.push(l + r); break;\n        case '-': st.push(l - r); break;\n        case '*': st.push(l * r); break;\n        case '/': st.push(l / r); break;\n    }\n}\n\nint evaluate(string&amp; s) {\n    stack&lt;int&gt; st;\n    stack&lt;char&gt; op;\n    for (int i = 0; i &lt; (int)s.size(); i++) {\n        if (delim(s[i]))\n            continue;\n\n        if (s[i] == '(') {\n            op.push('(');\n        } else if (s[i] == ')') {\n            while (op.top() != '(') {\n                process_op(st, op.top());\n                op.pop();\n            }\n            op.pop();\n        } else if (is_op(s[i])) {\n            char cur_op = s[i];\n            while (!op.empty() &amp;&amp; priority(op.top()) &gt;= priority(cur_op)) {\n                process_op(st, op.top());\n                op.pop();\n            }\n            op.push(cur_op);\n        } else {\n            int number = 0;\n            while (i &lt; (int)s.size() &amp;&amp; isalnum(s[i]))\n                number = number * 10 + s[i++] - '0';\n            --i;\n            st.push(number);\n        }\n    }\n\n    while (!op.empty()) {\n        process_op(st, op.top());\n        op.pop();\n    }\n    return st.top();\n}\n</code></pre> <p>Nh\u01b0 v\u1eady ch\u00fang ta \u0111\u00e3 h\u1ecdc c\u00e1ch t\u00ednh gi\u00e1 tr\u1ecb c\u1ee7a m\u1ed9t bi\u1ec3u th\u1ee9c trong $O(n)$, \u0111\u1ed3ng th\u1eddi ch\u00fang ta \u0111\u00e3 s\u1eed d\u1ee5ng ng\u1ea7m \u0111\u1ecbnh k\u00fd ph\u00e1p Ba Lan ng\u01b0\u1ee3c. B\u1eb1ng c\u00e1ch s\u1eeda \u0111\u1ed5i m\u1ed9t ch\u00fat c\u00e1ch th\u1ef1c hi\u1ec7n \u1edf tr\u00ean, c\u0169ng c\u00f3 th\u1ec3 thu \u0111\u01b0\u1ee3c bi\u1ec3u th\u1ee9c trong k\u00fd ph\u00e1p Ba Lan ng\u01b0\u1ee3c \u1edf d\u1ea1ng t\u01b0\u1eddng minh.</p>","tags":["Translated"]},{"location":"string/expression_parsing.html#unary-operators","title":"To\u00e1n t\u1eed m\u1ed9t ng\u00f4i (Unary operators)","text":"<p>B\u00e2y gi\u1edd gi\u1ea3 s\u1eed r\u1eb1ng bi\u1ec3u th\u1ee9c c\u0169ng ch\u1ee9a c\u00e1c to\u00e1n t\u1eed m\u1ed9t ng\u00f4i (unary) (c\u00e1c to\u00e1n t\u1eed l\u1ea5y m\u1ed9t \u0111\u1ed1i s\u1ed1). C\u1ed9ng m\u1ed9t ng\u00f4i v\u00e0 tr\u1eeb m\u1ed9t ng\u00f4i l\u00e0 nh\u1eefng v\u00ed d\u1ee5 ph\u1ed5 bi\u1ebfn v\u1ec1 c\u00e1c to\u00e1n t\u1eed nh\u01b0 v\u1eady.</p> <p>M\u1ed9t trong nh\u1eefng kh\u00e1c bi\u1ec7t trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, l\u00e0 ch\u00fang ta c\u1ea7n x\u00e1c \u0111\u1ecbnh xem to\u00e1n t\u1eed hi\u1ec7n t\u1ea1i l\u00e0 m\u1ed9t ng\u00f4i hay hai ng\u00f4i.</p> <p>B\u1ea1n c\u00f3 th\u1ec3 nh\u1eadn th\u1ea5y r\u1eb1ng tr\u01b0\u1edbc m\u1ed9t to\u00e1n t\u1eed m\u1ed9t ng\u00f4i, lu\u00f4n c\u00f3 m\u1ed9t to\u00e1n t\u1eed kh\u00e1c ho\u1eb7c d\u1ea5u ngo\u1eb7c \u0111\u01a1n m\u1edf, ho\u1eb7c kh\u00f4ng c\u00f3 g\u00ec c\u1ea3 (n\u1ebfu n\u00f3 n\u1eb1m \u1edf ngay \u0111\u1ea7u bi\u1ec3u th\u1ee9c). Ng\u01b0\u1ee3c l\u1ea1i, tr\u01b0\u1edbc m\u1ed9t to\u00e1n t\u1eed hai ng\u00f4i s\u1ebd lu\u00f4n c\u00f3 m\u1ed9t to\u00e1n h\u1ea1ng (s\u1ed1) ho\u1eb7c d\u1ea5u ngo\u1eb7c \u0111\u01a1n \u0111\u00f3ng. Do \u0111\u00f3, th\u1eadt d\u1ec5 d\u00e0ng \u0111\u1ec3 g\u1eafn c\u1edd xem to\u00e1n t\u1eed ti\u1ebfp theo c\u00f3 th\u1ec3 l\u00e0 m\u1ed9t ng\u00f4i hay kh\u00f4ng.</p> <p>Ngo\u00e0i ra ch\u00fang ta c\u1ea7n th\u1ef1c hi\u1ec7n m\u1ed9t to\u00e1n t\u1eed m\u1ed9t ng\u00f4i v\u00e0 m\u1ed9t to\u00e1n t\u1eed hai ng\u00f4i kh\u00e1c nhau. V\u00e0 ch\u00fang ta c\u1ea7n ch\u1ecdn \u0111\u1ed9 \u01b0u ti\u00ean c\u1ee7a to\u00e1n t\u1eed m\u1ed9t ng\u00f4i cao h\u01a1n t\u1ea5t c\u1ea3 c\u00e1c to\u00e1n t\u1eed hai ng\u00f4i.</p> <p>Ngo\u00e0i ra c\u1ea7n l\u01b0u \u00fd r\u1eb1ng, m\u1ed9t s\u1ed1 to\u00e1n t\u1eed m\u1ed9t ng\u00f4i (v\u00ed d\u1ee5: c\u1ed9ng m\u1ed9t ng\u00f4i v\u00e0 tr\u1eeb m\u1ed9t ng\u00f4i) th\u1ef1c s\u1ef1 l\u00e0 k\u1ebft h\u1ee3p ph\u1ea3i (right-associative).</p>","tags":["Translated"]},{"location":"string/expression_parsing.html#right-associativity","title":"K\u1ebft h\u1ee3p ph\u1ea3i (Right-associativity)","text":"<p>K\u1ebft h\u1ee3p ph\u1ea3i c\u00f3 ngh\u0129a l\u00e0, b\u1ea5t c\u1ee9 khi n\u00e0o c\u00e1c \u0111\u1ed9 \u01b0u ti\u00ean b\u1eb1ng nhau, c\u00e1c to\u00e1n t\u1eed ph\u1ea3i \u0111\u01b0\u1ee3c \u0111\u00e1nh gi\u00e1 t\u1eeb ph\u1ea3i sang tr\u00e1i.</p> <p>Nh\u01b0 \u0111\u00e3 l\u01b0u \u00fd \u1edf tr\u00ean, c\u00e1c to\u00e1n t\u1eed m\u1ed9t ng\u00f4i th\u01b0\u1eddng k\u1ebft h\u1ee3p ph\u1ea3i. M\u1ed9t v\u00ed d\u1ee5 kh\u00e1c cho to\u00e1n t\u1eed k\u1ebft h\u1ee3p ph\u1ea3i l\u00e0 to\u00e1n t\u1eed l\u0169y th\u1eeba ($a \\wedge b \\wedge c$ th\u01b0\u1eddng \u0111\u01b0\u1ee3c hi\u1ec3u l\u00e0 $a^{b^c}$ v\u00e0 kh\u00f4ng ph\u1ea3i l\u00e0 $(a^b)^c$).</p> <p>Ch\u00fang ta c\u1ea7n t\u1ea1o ra s\u1ef1 kh\u00e1c bi\u1ec7t n\u00e0o \u0111\u1ec3 x\u1eed l\u00fd ch\u00ednh x\u00e1c c\u00e1c to\u00e1n t\u1eed k\u1ebft h\u1ee3p ph\u1ea3i? H\u00f3a ra nh\u1eefng thay \u0111\u1ed5i l\u00e0 r\u1ea5t nh\u1ecf. S\u1ef1 kh\u00e1c bi\u1ec7t duy nh\u1ea5t s\u1ebd l\u00e0, n\u1ebfu c\u00e1c \u0111\u1ed9 \u01b0u ti\u00ean b\u1eb1ng nhau, ch\u00fang ta s\u1ebd ho\u00e3n vi\u1ec7c th\u1ef1c hi\u1ec7n ph\u00e9p to\u00e1n k\u1ebft h\u1ee3p ph\u1ea3i.</p> <p>D\u00f2ng duy nh\u1ea5t c\u1ea7n \u0111\u01b0\u1ee3c thay th\u1ebf l\u00e0 <pre><code>while (!op.empty() &amp;&amp; priority(op.top()) &gt;= priority(cur_op))\n</code></pre> b\u1eb1ng <pre><code>while (!op.empty() &amp;&amp; (\n        (left_assoc(cur_op) &amp;&amp; priority(op.top()) &gt;= priority(cur_op)) ||\n        (!left_assoc(cur_op) &amp;&amp; priority(op.top()) &gt; priority(cur_op))\n    ))\n</code></pre> trong \u0111\u00f3 <code>left_assoc</code> l\u00e0 m\u1ed9t h\u00e0m quy\u1ebft \u0111\u1ecbnh xem m\u1ed9t to\u00e1n t\u1eed c\u00f3 ph\u1ea3i l\u00e0 k\u1ebft h\u1ee3p tr\u00e1i hay kh\u00f4ng.</p> <p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u1ed9t tri\u1ec3n khai cho c\u00e1c to\u00e1n t\u1eed hai ng\u00f4i $+$ $-$ $*$ $/$ v\u00e0 c\u00e1c to\u00e1n t\u1eed m\u1ed9t ng\u00f4i $+$ v\u00e0 $-$.</p> <pre><code>bool delim(char c) {\n    return c == ' ';\n}\n\nbool is_op(char c) {\n    return c == '+' || c == '-' || c == '*' || c == '/';\n}\n\nbool is_unary(char c) {\n    return c == '+' || c=='-';\n}\n\nint priority (char op) {\n    if (op &lt; 0) // unary operator\n        return 3;\n    if (op == '+' || op == '-')\n        return 1;\n    if (op == '*' || op == '/')\n        return 2;\n    return -1;\n}\n\nvoid process_op(stack&lt;int&gt;&amp; st, char op) {\n    if (op &lt; 0) {\n        int l = st.top(); st.pop();\n        switch (-op) {\n            case '+': st.push(l); break;\n            case '-': st.push(-l); break;\n        }\n    } else {\n        int r = st.top(); st.pop();\n        int l = st.top(); st.pop();\n        switch (op) {\n            case '+': st.push(l + r); break;\n            case '-': st.push(l - r); break;\n            case '*': st.push(l * r); break;\n            case '/': st.push(l / r); break;\n        }\n    }\n}\n\nint evaluate(string&amp; s) {\n    stack&lt;int&gt; st;\n    stack&lt;char&gt; op;\n    bool may_be_unary = true;\n    for (int i = 0; i &lt; (int)s.size(); i++) {\n        if (delim(s[i]))\n            continue;\n\n        if (s[i] == '(') {\n            op.push('(');\n            may_be_unary = true;\n        } else if (s[i] == ')') {\n            while (op.top() != '(') {\n                process_op(st, op.top());\n                op.pop();\n            }\n            op.pop();\n            may_be_unary = false;\n        } else if (is_op(s[i])) {\n            char cur_op = s[i];\n            if (may_be_unary &amp;&amp; is_unary(cur_op))\n                cur_op = -cur_op;\n            while (!op.empty() &amp;&amp; (\n                    (cur_op &gt;= 0 &amp;&amp; priority(op.top()) &gt;= priority(cur_op)) ||\n                    (cur_op &lt; 0 &amp;&amp; priority(op.top()) &gt; priority(cur_op))\n                )) {\n                process_op(st, op.top());\n                op.pop();\n            }\n            op.push(cur_op);\n            may_be_unary = true;\n        } else {\n            int number = 0;\n            while (i &lt; (int)s.size() &amp;&amp; isalnum(s[i]))\n                number = number * 10 + s[i++] - '0';\n            --i;\n            st.push(number);\n            may_be_unary = false;\n        }\n    }\n\n    while (!op.empty()) {\n        process_op(st, op.top());\n        op.pop();\n    }\n    return st.top();\n}\n</code></pre>","tags":["Translated"]},{"location":"string/lyndon_factorization.html","title":"Ph\u00e2n r\u00e3 Lyndon (Lyndon factorization)","text":"","tags":["Translated"]},{"location":"string/lyndon_factorization.html#lyndon-factorization-1","title":"Ph\u00e2n r\u00e3 Lyndon (Lyndon factorization)","text":"<p>Tr\u01b0\u1edbc ti\u00ean h\u00e3y \u0111\u1ecbnh ngh\u0129a kh\u00e1i ni\u1ec7m v\u1ec1 ph\u00e2n r\u00e3 Lyndon.</p> <p>M\u1ed9t chu\u1ed7i \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 \u0111\u01a1n (simple) (ho\u1eb7c m\u1ed9t t\u1eeb Lyndon), n\u1ebfu n\u00f3 th\u1ef1c s\u1ef1 nh\u1ecf h\u01a1n b\u1ea5t k\u1ef3 h\u1eadu t\u1ed1 kh\u00f4ng t\u1ea7m th\u01b0\u1eddng n\u00e0o c\u1ee7a ch\u00ednh n\u00f3 theo th\u1ee9 t\u1ef1 t\u1eeb \u0111i\u1ec3n. V\u00ed d\u1ee5 v\u1ec1 c\u00e1c chu\u1ed7i \u0111\u01a1n l\u00e0: $a$, $b$, $ab$, $aab$, $abb$, $ababb$, $abcd$. C\u00f3 th\u1ec3 ch\u1ec9 ra r\u1eb1ng m\u1ed9t chu\u1ed7i l\u00e0 \u0111\u01a1n, khi v\u00e0 ch\u1ec9 khi n\u00f3 th\u1ef1c s\u1ef1 nh\u1ecf h\u01a1n t\u1ea5t c\u1ea3 c\u00e1c d\u1ecbch chuy\u1ec3n v\u00f2ng kh\u00f4ng t\u1ea7m th\u01b0\u1eddng c\u1ee7a n\u00f3.</p> <p>Ti\u1ebfp theo, gi\u1ea3 s\u1eed c\u00f3 m\u1ed9t chu\u1ed7i $s$ nh\u1ea5t \u0111\u1ecbnh. Ph\u00e2n r\u00e3 Lyndon c\u1ee7a chu\u1ed7i $s$ l\u00e0 m\u1ed9t ph\u00e2n r\u00e3 $s = w_1 w_2 \\dots w_k$, trong \u0111\u00f3 t\u1ea5t c\u1ea3 c\u00e1c chu\u1ed7i $w_i$ l\u00e0 chu\u1ed7i \u0111\u01a1n, v\u00e0 ch\u00fang theo th\u1ee9 t\u1ef1 kh\u00f4ng t\u0103ng v\u1ec1 m\u1eb7t t\u1eeb \u0111i\u1ec3n $w_1 \\ge w_2 \\ge \\dots \\ge w_k$.</p> <p>Ng\u01b0\u1eddi ta c\u00f3 th\u1ec3 ch\u1ee9ng minh r\u1eb1ng v\u1edbi b\u1ea5t k\u1ef3 chu\u1ed7i n\u00e0o, m\u1ed9t ph\u00e2n r\u00e3 nh\u01b0 v\u1eady lu\u00f4n t\u1ed3n t\u1ea1i v\u00e0 l\u00e0 duy nh\u1ea5t.</p>","tags":["Translated"]},{"location":"string/lyndon_factorization.html#duval-algorithm","title":"Thu\u1eadt to\u00e1n Duval (Duval algorithm)","text":"<p>Thu\u1eadt to\u00e1n Duval x\u00e2y d\u1ef1ng ph\u00e2n r\u00e3 Lyndon trong th\u1eddi gian $O(n)$ s\u1eed d\u1ee5ng b\u1ed9 nh\u1edb b\u1ed5 sung $O(1)$.</p> <p>Tr\u01b0\u1edbc ti\u00ean h\u00e3y gi\u1edbi thi\u1ec7u m\u1ed9t kh\u00e1i ni\u1ec7m kh\u00e1c: m\u1ed9t chu\u1ed7i $t$ \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 ti\u1ec1n \u0111\u01a1n (pre-simple), n\u1ebfu n\u00f3 c\u00f3 d\u1ea1ng $t = w w \\dots w \\overline{w}$, trong \u0111\u00f3 $w$ l\u00e0 m\u1ed9t chu\u1ed7i \u0111\u01a1n v\u00e0 $\\overline{w}$ l\u00e0 m\u1ed9t ti\u1ec1n t\u1ed1 c\u1ee7a $w$ (c\u00f3 th\u1ec3 r\u1ed7ng). M\u1ed9t chu\u1ed7i \u0111\u01a1n c\u0169ng l\u00e0 ti\u1ec1n \u0111\u01a1n.</p> <p>Thu\u1eadt to\u00e1n Duval l\u00e0 thu\u1eadt to\u00e1n tham lam. T\u1ea1i b\u1ea5t k\u1ef3 th\u1eddi \u0111i\u1ec3m n\u00e0o trong qu\u00e1 tr\u00ecnh th\u1ef1c thi, chu\u1ed7i $s$ th\u1ef1c s\u1ef1 s\u1ebd \u0111\u01b0\u1ee3c chia th\u00e0nh ba chu\u1ed7i $s = s_1 s_2 s_3$, trong \u0111\u00f3 ph\u00e2n r\u00e3 Lyndon cho $s_1$ \u0111\u00e3 \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y v\u00e0 ho\u00e0n thi\u1ec7n, chu\u1ed7i $s_2$ l\u00e0 ti\u1ec1n \u0111\u01a1n (v\u00e0 ch\u00fang ta bi\u1ebft \u0111\u1ed9 d\u00e0i c\u1ee7a chu\u1ed7i \u0111\u01a1n trong \u0111\u00f3), v\u00e0 $s_3$ ho\u00e0n to\u00e0n ch\u01b0a \u0111\u01b0\u1ee3c ch\u1ea1m t\u1edbi. Trong m\u1ed7i l\u1ea7n l\u1eb7p, thu\u1eadt to\u00e1n Duval l\u1ea5y k\u00fd t\u1ef1 \u0111\u1ea7u ti\u00ean c\u1ee7a chu\u1ed7i $s_3$ v\u00e0 c\u1ed1 g\u1eafng th\u00eam n\u00f3 v\u00e0o chu\u1ed7i $s_2$. N\u1ebfu $s_2$ kh\u00f4ng c\u00f2n l\u00e0 ti\u1ec1n \u0111\u01a1n n\u1eefa, th\u00ec ph\u00e2n r\u00e3 Lyndon cho m\u1ed9t ph\u1ea7n n\u00e0o \u0111\u00f3 c\u1ee7a $s_2$ \u0111\u01b0\u1ee3c bi\u1ebft \u0111\u1ebfn, v\u00e0 ph\u1ea7n n\u00e0y \u0111i v\u00e0o $s_1$.</p> <p>H\u00e3y m\u00f4 t\u1ea3 thu\u1eadt to\u00e1n chi ti\u1ebft h\u01a1n. Con tr\u1ecf $i$ s\u1ebd lu\u00f4n tr\u1ecf \u0111\u1ebfn \u0111\u1ea7u chu\u1ed7i $s_2$. V\u00f2ng l\u1eb7p b\u00ean ngo\u00e0i s\u1ebd \u0111\u01b0\u1ee3c th\u1ef1c thi mi\u1ec5n l\u00e0 $i &lt; n$. B\u00ean trong v\u00f2ng l\u1eb7p, ch\u00fang ta s\u1eed d\u1ee5ng th\u00eam hai con tr\u1ecf, $j$ tr\u1ecf \u0111\u1ebfn \u0111\u1ea7u c\u1ee7a $s_3$, v\u00e0 $k$ tr\u1ecf \u0111\u1ebfn k\u00fd t\u1ef1 hi\u1ec7n t\u1ea1i m\u00e0 ch\u00fang ta \u0111ang so s\u00e1nh. Ch\u00fang ta mu\u1ed1n th\u00eam k\u00fd t\u1ef1 $s[j]$ v\u00e0o chu\u1ed7i $s_2$, \u0111i\u1ec1u n\u00e0y \u0111\u00f2i h\u1ecfi ph\u1ea3i so s\u00e1nh v\u1edbi k\u00fd t\u1ef1 $s[k]$. C\u00f3 th\u1ec3 c\u00f3 ba tr\u01b0\u1eddng h\u1ee3p kh\u00e1c nhau:</p> <ul> <li>$s[j] = s[k]$: n\u1ebfu tr\u01b0\u1eddng h\u1ee3p n\u00e0y x\u1ea3y ra, th\u00ec vi\u1ec7c th\u00eam k\u00fd hi\u1ec7u $s[j]$ v\u00e0o $s_2$ kh\u00f4ng vi ph\u1ea1m t\u00ednh ti\u1ec1n \u0111\u01a1n c\u1ee7a n\u00f3.   V\u00ec v\u1eady, ch\u00fang ta ch\u1ec9 c\u1ea7n t\u0103ng c\u00e1c con tr\u1ecf $j$ v\u00e0 $k$.</li> <li>$s[j] &gt; s[k]$: \u1edf \u0111\u00e2y, chu\u1ed7i $s_2 + s[j]$ tr\u1edf th\u00e0nh \u0111\u01a1n.   Ch\u00fang ta c\u00f3 th\u1ec3 t\u0103ng $j$ v\u00e0 \u0111\u1eb7t l\u1ea1i $k$ v\u1ec1 \u0111\u1ea7u c\u1ee7a $s_2$, \u0111\u1ec3 k\u00fd t\u1ef1 ti\u1ebfp theo c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c so s\u00e1nh v\u1edbi \u0111\u1ea7u c\u1ee7a t\u1eeb \u0111\u01a1n.</li> <li>$s[j] &lt; s[k]$: chu\u1ed7i $s_2 + s[j]$ kh\u00f4ng c\u00f2n l\u00e0 ti\u1ec1n \u0111\u01a1n n\u1eefa.   Do \u0111\u00f3, ch\u00fang ta s\u1ebd chia chu\u1ed7i ti\u1ec1n \u0111\u01a1n $s_2$ th\u00e0nh c\u00e1c chu\u1ed7i \u0111\u01a1n c\u1ee7a n\u00f3 v\u00e0 ph\u1ea7n c\u00f2n l\u1ea1i, c\u00f3 th\u1ec3 r\u1ed7ng.   Chu\u1ed7i \u0111\u01a1n s\u1ebd c\u00f3 \u0111\u1ed9 d\u00e0i $j - k$.   Trong l\u1ea7n l\u1eb7p ti\u1ebfp theo, ch\u00fang ta b\u1eaft \u0111\u1ea7u l\u1ea1i v\u1edbi ph\u1ea7n c\u00f2n l\u1ea1i $s_2$.</li> </ul>","tags":["Translated"]},{"location":"string/lyndon_factorization.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>D\u01b0\u1edbi \u0111\u00e2y ch\u00fang t\u00f4i tr\u00ecnh b\u00e0y vi\u1ec7c c\u00e0i \u0111\u1eb7t thu\u1eadt to\u00e1n Duval, thu\u1eadt to\u00e1n n\u00e0y s\u1ebd tr\u1ea3 v\u1ec1 ph\u00e2n r\u00e3 Lyndon mong mu\u1ed1n c\u1ee7a m\u1ed9t chu\u1ed7i $s$ nh\u1ea5t \u0111\u1ecbnh.</p> <pre><code>vector&lt;string&gt; duval(string const&amp; s) {\n    int n = s.size();\n    int i = 0;\n    vector&lt;string&gt; factorization;\n    while (i &lt; n) {\n        int j = i + 1, k = i;\n        while (j &lt; n &amp;&amp; s[k] &lt;= s[j]) {\n            if (s[k] &lt; s[j])\n                k = i;\n            else\n                k++;\n            j++;\n        }\n        while (i &lt;= k) {\n            factorization.push_back(s.substr(i, j - k));\n            i += j - k;\n        }\n    }\n    return factorization;\n}\n</code></pre>","tags":["Translated"]},{"location":"string/lyndon_factorization.html#complexity","title":"\u0110\u1ed9 ph\u1ee9c t\u1ea1p (Complexity)","text":"<p>H\u00e3y \u01b0\u1edbc t\u00ednh th\u1eddi gian ch\u1ea1y c\u1ee7a thu\u1eadt to\u00e1n n\u00e0y.</p> <p>V\u00f2ng l\u1eb7p while b\u00ean ngo\u00e0i kh\u00f4ng v\u01b0\u1ee3t qu\u00e1 $n$ l\u1ea7n l\u1eb7p, v\u00ec \u1edf cu\u1ed1i m\u1ed7i l\u1ea7n l\u1eb7p $i$ \u0111\u1ec1u t\u0103ng. V\u00f2ng l\u1eb7p while b\u00ean trong th\u1ee9 hai c\u0169ng ch\u1ea1y trong $O(n)$, v\u00ec ch\u1ec9 xu\u1ea5t ra k\u1ebft qu\u1ea3 ph\u00e2n r\u00e3 cu\u1ed1i c\u00f9ng.</p> <p>V\u00ec v\u1eady, ch\u00fang ta ch\u1ec9 quan t\u00e2m \u0111\u1ebfn v\u00f2ng l\u1eb7p while b\u00ean trong th\u1ee9 nh\u1ea5t. N\u00f3 th\u1ef1c hi\u1ec7n bao nhi\u00eau l\u1ea7n l\u1eb7p trong tr\u01b0\u1eddng h\u1ee3p x\u1ea5u nh\u1ea5t? D\u1ec5 th\u1ea5y r\u1eb1ng c\u00e1c t\u1eeb \u0111\u01a1n m\u00e0 ch\u00fang ta x\u00e1c \u0111\u1ecbnh trong m\u1ed7i l\u1ea7n l\u1eb7p c\u1ee7a v\u00f2ng l\u1eb7p b\u00ean ngo\u00e0i d\u00e0i h\u01a1n ph\u1ea7n c\u00f2n l\u1ea1i m\u00e0 ch\u00fang ta \u0111\u00e3 so s\u00e1nh th\u00eam. Do \u0111\u00f3, t\u1ed5ng c\u1ee7a c\u00e1c ph\u1ea7n c\u00f2n l\u1ea1i c\u0169ng s\u1ebd nh\u1ecf h\u01a1n $n$, c\u00f3 ngh\u0129a l\u00e0 ch\u00fang ta ch\u1ec9 th\u1ef1c hi\u1ec7n t\u1ed1i \u0111a $O(n)$ l\u1ea7n l\u1eb7p c\u1ee7a v\u00f2ng l\u1eb7p while b\u00ean trong th\u1ee9 nh\u1ea5t. Tr\u00ean th\u1ef1c t\u1ebf, t\u1ed5ng s\u1ed1 ph\u00e9p so s\u00e1nh k\u00fd t\u1ef1 s\u1ebd kh\u00f4ng v\u01b0\u1ee3t qu\u00e1 $4n - 3$.</p>","tags":["Translated"]},{"location":"string/lyndon_factorization.html#finding-the-smallest-cyclic-shift","title":"T\u00ecm d\u1ecbch chuy\u1ec3n v\u00f2ng nh\u1ecf nh\u1ea5t (Finding the smallest cyclic shift)","text":"<p>Gi\u1ea3 s\u1eed c\u00f3 m\u1ed9t chu\u1ed7i $s$. Ch\u00fang ta x\u00e2y d\u1ef1ng ph\u00e2n r\u00e3 Lyndon cho chu\u1ed7i $s + s$ (trong th\u1eddi gian $O(n)$). Ch\u00fang ta s\u1ebd t\u00ecm ki\u1ebfm m\u1ed9t chu\u1ed7i \u0111\u01a1n trong ph\u00e2n r\u00e3, b\u1eaft \u0111\u1ea7u t\u1ea1i v\u1ecb tr\u00ed nh\u1ecf h\u01a1n $n$ (t\u1ee9c l\u00e0 n\u00f3 b\u1eaft \u0111\u1ea7u trong b\u1ea3n sao \u0111\u1ea7u ti\u00ean c\u1ee7a $s$), v\u00e0 k\u1ebft th\u00fac \u1edf v\u1ecb tr\u00ed l\u1edbn h\u01a1n ho\u1eb7c b\u1eb1ng $n$ (t\u1ee9c l\u00e0 trong b\u1ea3n sao th\u1ee9 hai c\u1ee7a $s$). Ng\u01b0\u1eddi ta n\u00f3i r\u1eb1ng, v\u1ecb tr\u00ed b\u1eaft \u0111\u1ea7u c\u1ee7a chu\u1ed7i \u0111\u01a1n n\u00e0y s\u1ebd l\u00e0 \u0111\u1ea7u c\u1ee7a d\u1ecbch chuy\u1ec3n v\u00f2ng nh\u1ecf nh\u1ea5t mong mu\u1ed1n. \u0110i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c ki\u1ec3m ch\u1ee9ng d\u1ec5 d\u00e0ng b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng \u0111\u1ecbnh ngh\u0129a c\u1ee7a ph\u00e2n r\u00e3 Lyndon.</p> <p>\u0110\u1ea7u c\u1ee7a kh\u1ed1i \u0111\u01a1n c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y d\u1ec5 d\u00e0ng - ch\u1ec9 c\u1ea7n nh\u1edb con tr\u1ecf $i$ \u1edf \u0111\u1ea7u m\u1ed7i l\u1ea7n l\u1eb7p c\u1ee7a v\u00f2ng l\u1eb7p b\u00ean ngo\u00e0i, con tr\u1ecf n\u00e0y ch\u1ec9 ra \u0111\u1ea7u c\u1ee7a chu\u1ed7i ti\u1ec1n \u0111\u01a1n hi\u1ec7n t\u1ea1i.</p> <p>V\u00ec v\u1eady, ch\u00fang ta c\u00f3 c\u00e1ch c\u00e0i \u0111\u1eb7t sau:</p> <pre><code>string min_cyclic_string(string s) {\n    s += s;\n    int n = s.size();\n    int i = 0, ans = 0;\n    while (i &lt; n / 2) {\n        ans = i;\n        int j = i + 1, k = i;\n        while (j &lt; n &amp;&amp; s[k] &lt;= s[j]) {\n            if (s[k] &lt; s[j])\n                k = i;\n            else\n                k++;\n            j++;\n        }\n        while (i &lt;= k)\n            i += j - k;\n    }\n    return s.substr(ans, n / 2);\n}\n</code></pre>","tags":["Translated"]},{"location":"string/lyndon_factorization.html#problems","title":"B\u00e0i t\u1eadp (Problems)","text":"<ul> <li>UVA #719 - Glass Beads</li> </ul>","tags":["Translated"]},{"location":"string/main_lorentz.html","title":"T\u00ecm ki\u1ebfm l\u1eb7p l\u1ea1i (Finding repetitions)","text":"<p>Cho m\u1ed9t chu\u1ed7i $s$ c\u00f3 \u0111\u1ed9 d\u00e0i $n$.</p> <p>M\u1ed9t s\u1ef1 l\u1eb7p l\u1ea1i (repetition) l\u00e0 hai l\u1ea7n xu\u1ea5t hi\u1ec7n c\u1ee7a m\u1ed9t chu\u1ed7i li\u00ean ti\u1ebfp nhau. N\u00f3i c\u00e1ch kh\u00e1c, m\u1ed9t s\u1ef1 l\u1eb7p l\u1ea1i c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 b\u1edfi m\u1ed9t c\u1eb7p ch\u1ec9 s\u1ed1 $i &lt; j$ sao cho chu\u1ed7i con $s[i \\dots j]$ bao g\u1ed3m hai chu\u1ed7i gi\u1ed1ng h\u1ec7t nhau \u0111\u01b0\u1ee3c vi\u1ebft sau nhau.</p> <p>Th\u00e1ch th\u1ee9c l\u00e0 t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c l\u1ea7n l\u1eb7p l\u1ea1i trong m\u1ed9t chu\u1ed7i $s$ nh\u1ea5t \u0111\u1ecbnh. Ho\u1eb7c m\u1ed9t nhi\u1ec7m v\u1ee5 \u0111\u01a1n gi\u1ea3n h\u00f3a: t\u00ecm b\u1ea5t k\u1ef3 s\u1ef1 l\u1eb7p l\u1ea1i n\u00e0o ho\u1eb7c t\u00ecm s\u1ef1 l\u1eb7p l\u1ea1i d\u00e0i nh\u1ea5t.</p> <p>Thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 \u1edf \u0111\u00e2y \u0111\u01b0\u1ee3c c\u00f4ng b\u1ed1 v\u00e0o n\u0103m 1982 b\u1edfi Main v\u00e0 Lorentz.</p>","tags":["Translated"]},{"location":"string/main_lorentz.html#example","title":"V\u00ed d\u1ee5 (Example)","text":"<p>H\u00e3y xem x\u00e9t c\u00e1c s\u1ef1 l\u1eb7p l\u1ea1i trong chu\u1ed7i v\u00ed d\u1ee5 sau:</p> $$acababaee$$ <p>Chu\u1ed7i ch\u1ee9a ba l\u1ea7n l\u1eb7p l\u1ea1i sau:</p> <ul> <li>$s[2 \\dots 5] = abab$</li> <li>$s[3 \\dots 6] = baba$</li> <li>$s[7 \\dots 8] = ee$</li> </ul> <p>M\u1ed9t v\u00ed d\u1ee5 kh\u00e1c:</p> $$abaaba$$ <p>\u1ede \u0111\u00e2y ch\u1ec9 c\u00f3 hai l\u1ea7n l\u1eb7p l\u1ea1i:</p> <ul> <li>$s[0 \\dots 5] = abaaba$</li> <li>$s[2 \\dots 3] = aa$</li> </ul>","tags":["Translated"]},{"location":"string/main_lorentz.html#number-of-repetitions","title":"S\u1ed1 l\u01b0\u1ee3ng l\u1eb7p l\u1ea1i (Number of repetitions)","text":"<p>N\u00f3i chung, c\u00f3 th\u1ec3 c\u00f3 t\u1edbi $O(n^2)$ l\u1ea7n l\u1eb7p l\u1ea1i trong m\u1ed9t chu\u1ed7i c\u00f3 \u0111\u1ed9 d\u00e0i $n$. M\u1ed9t v\u00ed d\u1ee5 r\u00f5 r\u00e0ng l\u00e0 m\u1ed9t chu\u1ed7i bao g\u1ed3m $n$ l\u1ea7n c\u00f9ng m\u1ed9t ch\u1eef c\u00e1i, trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, b\u1ea5t k\u1ef3 chu\u1ed7i con n\u00e0o c\u00f3 \u0111\u1ed9 d\u00e0i ch\u1eb5n \u0111\u1ec1u l\u00e0 m\u1ed9t s\u1ef1 l\u1eb7p l\u1ea1i. N\u00f3i chung, b\u1ea5t k\u1ef3 chu\u1ed7i tu\u1ea7n ho\u00e0n n\u00e0o c\u00f3 chu k\u1ef3 ng\u1eafn s\u1ebd ch\u1ee9a r\u1ea5t nhi\u1ec1u s\u1ef1 l\u1eb7p l\u1ea1i.</p> <p>M\u1eb7t kh\u00e1c, th\u1ef1c t\u1ebf n\u00e0y kh\u00f4ng ng\u0103n c\u1ea3n vi\u1ec7c t\u00ednh to\u00e1n s\u1ed1 l\u1ea7n l\u1eb7p l\u1ea1i trong th\u1eddi gian $O(n \\log n)$, b\u1edfi v\u00ec thu\u1eadt to\u00e1n c\u00f3 th\u1ec3 \u0111\u01b0a ra c\u00e1c l\u1ea7n l\u1eb7p l\u1ea1i \u1edf d\u1ea1ng n\u00e9n, theo nh\u00f3m c\u1ee7a nhi\u1ec1u m\u1ea3nh c\u00f9ng m\u1ed9t l\u00fac.</p> <p>Th\u1eadm ch\u00ed c\u00f2n c\u00f3 kh\u00e1i ni\u1ec7m m\u00f4 t\u1ea3 c\u00e1c nh\u00f3m chu\u1ed7i con tu\u1ea7n ho\u00e0n v\u1edbi c\u00e1c b\u1ed9 b\u1ed1n k\u00edch th\u01b0\u1edbc. Ng\u01b0\u1eddi ta \u0111\u00e3 ch\u1ee9ng minh r\u1eb1ng s\u1ed1 l\u01b0\u1ee3ng c\u00e1c nh\u00f3m nh\u01b0 v\u1eady t\u1ed1i \u0111a l\u00e0 tuy\u1ebfn t\u00ednh \u0111\u1ed1i v\u1edbi \u0111\u1ed9 d\u00e0i chu\u1ed7i.</p> <p>Ngo\u00e0i ra, \u0111\u00e2y l\u00e0 m\u1ed9t s\u1ed1 k\u1ebft qu\u1ea3 th\u00fa v\u1ecb h\u01a1n li\u00ean quan \u0111\u1ebfn s\u1ed1 l\u1ea7n l\u1eb7p l\u1ea1i:</p> <ul> <li>S\u1ed1 l\u01b0\u1ee3ng l\u1eb7p l\u1ea1i nguy\u00ean th\u1ee7y (nh\u1eefng l\u1ea7n l\u1eb7p l\u1ea1i c\u00f3 n\u1eeda kh\u00f4ng ph\u1ea3i l\u00e0 l\u1eb7p l\u1ea1i) t\u1ed1i \u0111a l\u00e0 $O(n \\log n)$.</li> <li>N\u1ebfu ch\u00fang ta m\u00e3 h\u00f3a c\u00e1c l\u1ea7n l\u1eb7p l\u1ea1i b\u1eb1ng c\u00e1c b\u1ed9 s\u1ed1 (\u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 b\u1ed9 ba Crochemore) $(i,~ p,~ r)$ (trong \u0111\u00f3 $i$ l\u00e0 v\u1ecb tr\u00ed b\u1eaft \u0111\u1ea7u, $p$ \u0111\u1ed9 d\u00e0i c\u1ee7a chu\u1ed7i con l\u1eb7p l\u1ea1i v\u00e0 $r$ s\u1ed1 l\u1ea7n l\u1eb7p l\u1ea1i), th\u00ec t\u1ea5t c\u1ea3 c\u00e1c l\u1ea7n l\u1eb7p l\u1ea1i c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 b\u1eb1ng $O(n \\log n)$ b\u1ed9 ba nh\u01b0 v\u1eady.</li> <li> <p>Chu\u1ed7i Fibonacci, \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a l\u00e0</p> $$\\begin{align} t_0 &amp;= a, \\\\\\\\ t_1 &amp;= b, \\\\\\\\ t_i &amp;= t_{i-1} + t_{i-2}, \\end{align}$$ <p>l\u00e0 tu\u1ea7n ho\u00e0n \"m\u1ea1nh\". S\u1ed1 l\u01b0\u1ee3ng l\u1eb7p l\u1ea1i trong chu\u1ed7i Fibonacci $f_i$, ngay c\u1ea3 khi \u0111\u01b0\u1ee3c n\u00e9n b\u1eb1ng b\u1ed9 ba Crochemore, l\u00e0 $O(f_n \\log f_n)$. S\u1ed1 l\u01b0\u1ee3ng l\u1eb7p l\u1ea1i nguy\u00ean th\u1ee7y c\u0169ng l\u00e0 $O(f_n \\log f_n)$.</p> </li> </ul>","tags":["Translated"]},{"location":"string/main_lorentz.html#main-lorentz-algorithm","title":"Thu\u1eadt to\u00e1n Main-Lorentz (Main-Lorentz algorithm)","text":"<p>\u00dd t\u01b0\u1edfng \u0111\u1eb1ng sau thu\u1eadt to\u00e1n Main-Lorentz l\u00e0 chia \u0111\u1ec3 tr\u1ecb (divide-and-conquer).</p> <p>N\u00f3 chia chu\u1ed7i ban \u0111\u1ea7u th\u00e0nh m\u1ed9t n\u1eeda v\u00e0 t\u00ednh to\u00e1n s\u1ed1 l\u1ea7n l\u1eb7p l\u1ea1i n\u1eb1m ho\u00e0n to\u00e0n trong m\u1ed7i n\u1eeda b\u1eb1ng hai l\u1ec7nh g\u1ecdi \u0111\u1ec7 quy. Sau \u0111\u00f3 \u0111\u1ebfn ph\u1ea7n kh\u00f3 kh\u0103n. Thu\u1eadt to\u00e1n t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c l\u1ea7n l\u1eb7p l\u1ea1i b\u1eaft \u0111\u1ea7u \u1edf n\u1eeda \u0111\u1ea7u v\u00e0 k\u1ebft th\u00fac \u1edf n\u1eeda sau (ch\u00fang t\u00f4i s\u1ebd g\u1ecdi l\u00e0 l\u1eb7p l\u1ea1i ch\u00e9o - crossing repetitions). \u0110\u00e2y l\u00e0 ph\u1ea7n thi\u1ebft y\u1ebfu c\u1ee7a thu\u1eadt to\u00e1n Main-Lorentz v\u00e0 ch\u00fang ta s\u1ebd th\u1ea3o lu\u1eadn chi ti\u1ebft v\u1ec1 n\u00f3 \u1edf \u0111\u00e2y.</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a c\u00e1c thu\u1eadt to\u00e1n chia \u0111\u1ec3 tr\u1ecb \u0111\u01b0\u1ee3c nghi\u00ean c\u1ee9u k\u1ef9 l\u01b0\u1ee1ng. \u0110\u1ecbnh l\u00fd Master n\u00f3i r\u1eb1ng, ch\u00fang ta s\u1ebd k\u1ebft th\u00fac v\u1edbi thu\u1eadt to\u00e1n $O(n \\log n)$, n\u1ebfu ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh to\u00e1n c\u00e1c l\u1ea7n l\u1eb7p l\u1ea1i ch\u00e9o trong th\u1eddi gian $O(n)$.</p>","tags":["Translated"]},{"location":"string/main_lorentz.html#search-for-crossing-repetitions","title":"T\u00ecm ki\u1ebfm c\u00e1c l\u1eb7p l\u1ea1i ch\u00e9o (Search for crossing repetitions)","text":"<p>V\u00ec v\u1eady, ch\u00fang ta mu\u1ed1n t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c l\u1ea7n l\u1eb7p l\u1ea1i nh\u01b0 v\u1eady b\u1eaft \u0111\u1ea7u \u1edf n\u1eeda \u0111\u1ea7u c\u1ee7a chu\u1ed7i, h\u00e3y g\u1ecdi n\u00f3 l\u00e0 $u$, v\u00e0 k\u1ebft th\u00fac \u1edf n\u1eeda sau, h\u00e3y g\u1ecdi n\u00f3 l\u00e0 $v$:</p> $$s = u + v$$ <p>\u0110\u1ed9 d\u00e0i c\u1ee7a ch\u00fang x\u1ea5p x\u1ec9 b\u1eb1ng \u0111\u1ed9 d\u00e0i c\u1ee7a $s$ chia cho hai.</p> <p>Xem x\u00e9t m\u1ed9t l\u1ea7n l\u1eb7p l\u1ea1i t\u00f9y \u00fd v\u00e0 nh\u00ecn v\u00e0o k\u00fd t\u1ef1 \u1edf gi\u1eefa (ch\u00ednh x\u00e1c h\u01a1n l\u00e0 k\u00fd t\u1ef1 \u0111\u1ea7u ti\u00ean c\u1ee7a n\u1eeda sau c\u1ee7a l\u1ea7n l\u1eb7p l\u1ea1i). T\u1ee9c l\u00e0 n\u1ebfu s\u1ef1 l\u1eb7p l\u1ea1i l\u00e0 m\u1ed9t chu\u1ed7i con $s[i \\dots j]$, th\u00ec k\u00fd t\u1ef1 \u1edf gi\u1eefa l\u00e0 $(i + j + 1) / 2$.</p> <p>Ch\u00fang t\u00f4i g\u1ecdi m\u1ed9t s\u1ef1 l\u1eb7p l\u1ea1i l\u00e0 tr\u00e1i (left) ho\u1eb7c ph\u1ea3i (right) t\u00f9y thu\u1ed9c v\u00e0o chu\u1ed7i n\u00e0o k\u00fd t\u1ef1 n\u00e0y n\u1eb1m \u1edf - trong chu\u1ed7i $u$ hay trong chu\u1ed7i $v$. N\u00f3i c\u00e1ch kh\u00e1c, m\u1ed9t chu\u1ed7i \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 tr\u00e1i, n\u1ebfu ph\u1ea7n l\u1edbn c\u1ee7a n\u00f3 n\u1eb1m trong $u$, n\u1ebfu kh\u00f4ng ch\u00fang t\u00f4i g\u1ecdi n\u00f3 l\u00e0 ph\u1ea3i.</p> <p>B\u00e2y gi\u1edd ch\u00fang ta s\u1ebd th\u1ea3o lu\u1eadn v\u1ec1 c\u00e1ch t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c l\u1eb7p l\u1ea1i tr\u00e1i. Vi\u1ec7c t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c l\u1eb7p l\u1ea1i ph\u1ea3i c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n theo c\u00f9ng m\u1ed9t c\u00e1ch.</p> <p>Ch\u00fang ta h\u00e3y bi\u1ec3u th\u1ecb \u0111\u1ed9 d\u00e0i c\u1ee7a l\u1ea7n l\u1eb7p l\u1ea1i b\u00ean tr\u00e1i b\u1eb1ng $2l$ (t\u1ee9c l\u00e0 m\u1ed7i n\u1eeda c\u1ee7a l\u1ea7n l\u1eb7p l\u1ea1i c\u00f3 \u0111\u1ed9 d\u00e0i $l$). Xem x\u00e9t k\u00fd t\u1ef1 \u0111\u1ea7u ti\u00ean c\u1ee7a l\u1ea7n l\u1eb7p l\u1ea1i r\u01a1i v\u00e0o chu\u1ed7i $v$ (n\u00f3 \u1edf v\u1ecb tr\u00ed $|u|$ trong chu\u1ed7i $s$). N\u00f3 tr\u00f9ng v\u1edbi k\u00fd t\u1ef1 $l$ v\u1ecb tr\u00ed tr\u01b0\u1edbc n\u00f3, h\u00e3y bi\u1ec3u th\u1ecb v\u1ecb tr\u00ed n\u00e0y l\u00e0 $cntr$.</p> <p>Ch\u00fang t\u00f4i s\u1ebd c\u1ed1 \u0111\u1ecbnh v\u1ecb tr\u00ed n\u00e0y $cntr$, v\u00e0 t\u00ecm ki\u1ebfm t\u1ea5t c\u1ea3 c\u00e1c l\u1ea7n l\u1eb7p l\u1ea1i t\u1ea1i v\u1ecb tr\u00ed n\u00e0y $cntr$.</p> <p>V\u00ed d\u1ee5:</p> $$c ~ \\underset{cntr}{a} ~ c ~ | ~ a ~ d ~ a$$ <p>C\u00e1c \u0111\u01b0\u1eddng th\u1eb3ng \u0111\u1ee9ng chia hai n\u1eeda. \u1ede \u0111\u00e2y ch\u00fang ta c\u1ed1 \u0111\u1ecbnh v\u1ecb tr\u00ed $cntr = 1$, v\u00e0 t\u1ea1i v\u1ecb tr\u00ed n\u00e0y ch\u00fang ta t\u00ecm th\u1ea5y s\u1ef1 l\u1eb7p l\u1ea1i $caca$.</p> <p>R\u00f5 r\u00e0ng l\u00e0, n\u1ebfu ch\u00fang ta c\u1ed1 \u0111\u1ecbnh v\u1ecb tr\u00ed $cntr$, ch\u00fang ta \u0111\u1ed3ng th\u1eddi c\u1ed1 \u0111\u1ecbnh \u0111\u1ed9 d\u00e0i c\u1ee7a c\u00e1c l\u1ea7n l\u1eb7p l\u1ea1i c\u00f3 th\u1ec3: $l = |u| - cntr$. Khi ch\u00fang ta bi\u1ebft c\u00e1ch t\u00ecm c\u00e1c l\u1ea7n l\u1eb7p l\u1ea1i n\u00e0y, ch\u00fang ta s\u1ebd l\u1eb7p l\u1ea1i tr\u00ean t\u1ea5t c\u1ea3 c\u00e1c gi\u00e1 tr\u1ecb c\u00f3 th\u1ec3 c\u00f3 cho $cntr$ t\u1eeb $0$ \u0111\u1ebfn $|u|-1$, v\u00e0 t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c l\u1ea7n l\u1eb7p l\u1ea1i ch\u00e9o tr\u00e1i c\u00f3 \u0111\u1ed9 d\u00e0i $l = |u|,~ |u|-1,~ \\dots, 1$.</p>","tags":["Translated"]},{"location":"string/main_lorentz.html#criterion-for-left-crossing-repetitions","title":"Ti\u00eau ch\u00ed cho c\u00e1c l\u1eb7p l\u1ea1i ch\u00e9o tr\u00e1i (Criterion for left crossing repetitions)","text":"<p>B\u00e2y gi\u1edd, l\u00e0m th\u1ebf n\u00e0o ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm th\u1ea5y t\u1ea5t c\u1ea3 c\u00e1c l\u1ea7n l\u1eb7p l\u1ea1i nh\u01b0 v\u1eady cho m\u1ed9t $cntr$ c\u1ed1 \u0111\u1ecbnh? H\u00e3y nh\u1edb r\u1eb1ng v\u1eabn c\u00f3 th\u1ec3 c\u00f3 nhi\u1ec1u l\u1ea7n l\u1eb7p l\u1ea1i nh\u01b0 v\u1eady.</p> <p>H\u00e3y nh\u00ecn l\u1ea1i m\u1ed9t h\u00ecnh dung, l\u1ea7n n\u00e0y cho s\u1ef1 l\u1eb7p l\u1ea1i $abcabc$:</p> $$\\overbrace{a}^{l_1} ~ \\overbrace{\\underset{cntr}{b} ~ c}^{l_2} ~ \\overbrace{a}^{l_1} ~ | ~ \\overbrace{b ~ c}^{l_2}$$ <p>\u1ede \u0111\u00e2y ch\u00fang t\u00f4i bi\u1ec3u th\u1ecb \u0111\u1ed9 d\u00e0i c\u1ee7a hai ph\u1ea7n c\u1ee7a s\u1ef1 l\u1eb7p l\u1ea1i b\u1eb1ng $l_1$ v\u00e0 $l_2$: $l_1$ l\u00e0 \u0111\u1ed9 d\u00e0i c\u1ee7a l\u1ea7n l\u1eb7p l\u1ea1i \u0111\u1ebfn v\u1ecb tr\u00ed $cntr-1$, v\u00e0 $l_2$ l\u00e0 \u0111\u1ed9 d\u00e0i c\u1ee7a l\u1ea7n l\u1eb7p l\u1ea1i t\u1eeb $cntr$ \u0111\u1ebfn h\u1ebft n\u1eeda c\u1ee7a l\u1ea7n l\u1eb7p l\u1ea1i. Ch\u00fang ta c\u00f3 $2l = l_1 + l_2 + l_1 + l_2$ l\u00e0 t\u1ed5ng \u0111\u1ed9 d\u00e0i c\u1ee7a s\u1ef1 l\u1eb7p l\u1ea1i.</p> <p>Ch\u00fang ta h\u00e3y t\u1ea1o c\u00e1c \u0111i\u1ec1u ki\u1ec7n c\u1ea7n v\u00e0 \u0111\u1ee7 cho m\u1ed9t s\u1ef1 l\u1eb7p l\u1ea1i nh\u01b0 v\u1eady t\u1ea1i v\u1ecb tr\u00ed $cntr$ c\u00f3 \u0111\u1ed9 d\u00e0i $2l = 2(l_1 + l_2) = 2(|u| - cntr)$:</p> <ul> <li>G\u1ecdi $k_1$ l\u00e0 s\u1ed1 l\u1edbn nh\u1ea5t sao cho $k_1$ k\u00fd t\u1ef1 \u0111\u1ea7u ti\u00ean tr\u01b0\u1edbc v\u1ecb tr\u00ed $cntr$ tr\u00f9ng v\u1edbi $k_1$ k\u00fd t\u1ef1 cu\u1ed1i c\u00f9ng trong chu\u1ed7i $u$:</li> </ul> $$ u[cntr - k_1 \\dots cntr - 1] = u[|u| - k_1 \\dots |u| - 1] $$ <ul> <li>G\u1ecdi $k_2$ l\u00e0 s\u1ed1 l\u1edbn nh\u1ea5t sao cho $k_2$ k\u00fd t\u1ef1 b\u1eaft \u0111\u1ea7u t\u1ea1i v\u1ecb tr\u00ed $cntr$ tr\u00f9ng v\u1edbi $k_2$ k\u00fd t\u1ef1 \u0111\u1ea7u ti\u00ean trong chu\u1ed7i $v$:</li> </ul> $$     u[cntr \\dots cntr + k_2 - 1] = v[0 \\dots k_2 - 1] $$ <ul> <li>Sau \u0111\u00f3, ch\u00fang ta c\u00f3 m\u1ed9t s\u1ef1 l\u1eb7p l\u1ea1i ch\u00ednh x\u00e1c cho b\u1ea5t k\u1ef3 c\u1eb7p $(l_1,~ l_2)$ n\u00e0o v\u1edbi</li> </ul> $$   \\begin{align}   l_1 &amp;\\le k_1, \\\\\\\\   l_2 &amp;\\le k_2. \\\\\\\\   \\end{align} $$ <p>T\u00f3m l\u1ea1i:</p> <ul> <li>Ch\u00fang t\u00f4i c\u1ed1 \u0111\u1ecbnh m\u1ed9t v\u1ecb tr\u00ed c\u1ee5 th\u1ec3 $cntr$.</li> <li>T\u1ea5t c\u1ea3 c\u00e1c l\u1ea7n l\u1eb7p l\u1ea1i m\u00e0 ch\u00fang t\u00f4i s\u1ebd t\u00ecm th\u1ea5y b\u00e2y gi\u1edd c\u00f3 \u0111\u1ed9 d\u00e0i $2l = 2(|u| - cntr)$.   C\u00f3 th\u1ec3 c\u00f3 nhi\u1ec1u l\u1ea7n l\u1eb7p l\u1ea1i nh\u01b0 v\u1eady, ch\u00fang ph\u1ee5 thu\u1ed9c v\u00e0o \u0111\u1ed9 d\u00e0i $l_1$ v\u00e0 $l_2 = l - l_1$.</li> <li>Ch\u00fang ta t\u00ecm th\u1ea5y $k_1$ v\u00e0 $k_2$ nh\u01b0 m\u00f4 t\u1ea3 \u1edf tr\u00ean.</li> <li>Khi \u0111\u00f3 t\u1ea5t c\u1ea3 c\u00e1c l\u1ea7n l\u1eb7p l\u1ea1i ph\u00f9 h\u1ee3p l\u00e0 nh\u1eefng l\u1ea7n m\u00e0 \u0111\u1ed9 d\u00e0i c\u1ee7a c\u00e1c m\u1ea3nh $l_1$ v\u00e0 $l_2$ th\u1ecfa m\u00e3n c\u00e1c \u0111i\u1ec1u ki\u1ec7n:</li> </ul> $$   \\begin{align}   l_1 + l_2 &amp;= l = |u| - cntr \\\\\\\\   l_1 &amp;\\le k_1, \\\\\\\\   l_2 &amp;\\le k_2. \\\\\\\\   \\end{align} $$ <p>Do \u0111\u00f3, ph\u1ea7n c\u00f2n l\u1ea1i duy nh\u1ea5t l\u00e0 c\u00e1ch ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh to\u00e1n c\u00e1c gi\u00e1 tr\u1ecb $k_1$ v\u00e0 $k_2$ m\u1ed9t c\u00e1ch nhanh ch\u00f3ng cho m\u1ecdi v\u1ecb tr\u00ed $cntr$. May m\u1eafn thay, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh to\u00e1n ch\u00fang trong $O(1)$ b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng H\u00e0m Z (Z-function):</p> <ul> <li>\u0110\u1ec3 c\u00f3 th\u1ec3 t\u00ecm gi\u00e1 tr\u1ecb $k_1$ cho m\u1ed7i v\u1ecb tr\u00ed b\u1eb1ng c\u00e1ch t\u00ednh to\u00e1n h\u00e0m Z cho chu\u1ed7i $\\overline{u}$ (t\u1ee9c l\u00e0 chu\u1ed7i \u0111\u1ea3o ng\u01b0\u1ee3c $u$).   Sau \u0111\u00f3, gi\u00e1 tr\u1ecb $k_1$ cho m\u1ed9t $cntr$ c\u1ee5 th\u1ec3 s\u1ebd b\u1eb1ng v\u1edbi gi\u00e1 tr\u1ecb t\u01b0\u01a1ng \u1ee9ng c\u1ee7a m\u1ea3ng h\u00e0m Z.</li> <li>\u0110\u1ec3 t\u00ednh to\u00e1n tr\u01b0\u1edbc t\u1ea5t c\u1ea3 c\u00e1c gi\u00e1 tr\u1ecb $k_2$, ch\u00fang ta t\u00ednh to\u00e1n h\u00e0m Z cho chu\u1ed7i $v + \\# + u$ (t\u1ee9c l\u00e0 chu\u1ed7i $u$ \u0111\u01b0\u1ee3c n\u1ed1i v\u1edbi k\u00fd t\u1ef1 ph\u00e2n t\u00e1ch $\\#$ v\u00e0 chu\u1ed7i $v$).   M\u1ed9t l\u1ea7n n\u1eefa ch\u00fang ta ch\u1ec9 c\u1ea7n tra c\u1ee9u gi\u00e1 tr\u1ecb t\u01b0\u01a1ng \u1ee9ng trong h\u00e0m Z \u0111\u1ec3 c\u00f3 \u0111\u01b0\u1ee3c gi\u00e1 tr\u1ecb $k_2$.</li> </ul> <p>V\u00ec v\u1eady, \u0111i\u1ec1u n\u00e0y l\u00e0 \u0111\u1ee7 \u0111\u1ec3 t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c l\u1ea7n l\u1eb7p l\u1ea1i ch\u00e9o tr\u00e1i.</p>","tags":["Translated"]},{"location":"string/main_lorentz.html#right-crossing-repetitions","title":"L\u1eb7p l\u1ea1i ch\u00e9o ph\u1ea3i (Right crossing repetitions)","text":"<p>\u0110\u1ec3 t\u00ednh to\u00e1n c\u00e1c l\u1ea7n l\u1eb7p l\u1ea1i ch\u00e9o ph\u1ea3i, ch\u00fang ta h\u00e0nh \u0111\u1ed9ng t\u01b0\u01a1ng t\u1ef1: ch\u00fang ta x\u00e1c \u0111\u1ecbnh t\u00e2m $cntr$ l\u00e0 k\u00fd t\u1ef1 t\u01b0\u01a1ng \u1ee9ng v\u1edbi k\u00fd t\u1ef1 cu\u1ed1i c\u00f9ng trong chu\u1ed7i $u$.</p> <p>Sau \u0111\u00f3, \u0111\u1ed9 d\u00e0i $k_1$ s\u1ebd \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh l\u00e0 s\u1ed1 l\u01b0\u1ee3ng l\u1edbn nh\u1ea5t c\u00e1c k\u00fd t\u1ef1 tr\u01b0\u1edbc v\u1ecb tr\u00ed $cntr$ (bao g\u1ed3m c\u1ea3 n\u00f3) tr\u00f9ng v\u1edbi c\u00e1c k\u00fd t\u1ef1 cu\u1ed1i c\u00f9ng c\u1ee7a chu\u1ed7i $u$. V\u00e0 \u0111\u1ed9 d\u00e0i $k_2$ s\u1ebd \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh l\u00e0 s\u1ed1 l\u01b0\u1ee3ng l\u1edbn nh\u1ea5t c\u00e1c k\u00fd t\u1ef1 b\u1eaft \u0111\u1ea7u t\u1ea1i $cntr + 1$ tr\u00f9ng v\u1edbi c\u00e1c k\u00fd t\u1ef1 c\u1ee7a chu\u1ed7i $v$.</p> <p>Do \u0111\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm th\u1ea5y c\u00e1c gi\u00e1 tr\u1ecb $k_1$ v\u00e0 $k_2$ b\u1eb1ng c\u00e1ch t\u00ednh to\u00e1n h\u00e0m Z cho c\u00e1c chu\u1ed7i $\\overline{u} + \\# + \\overline{v}$ v\u00e0 $v$.</p> <p>Sau \u0111\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm th\u1ea5y c\u00e1c l\u1ea7n l\u1eb7p l\u1ea1i b\u1eb1ng c\u00e1ch xem x\u00e9t t\u1ea5t c\u1ea3 c\u00e1c v\u1ecb tr\u00ed $cntr$ v\u00e0 s\u1eed d\u1ee5ng ti\u00eau ch\u00ed t\u01b0\u01a1ng t\u1ef1 nh\u01b0 ch\u00fang ta \u0111\u00e3 c\u00f3 cho c\u00e1c l\u1ea7n l\u1eb7p l\u1ea1i ch\u00e9o tr\u00e1i.</p>","tags":["Translated"]},{"location":"string/main_lorentz.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>Vi\u1ec7c c\u00e0i \u0111\u1eb7t thu\u1eadt to\u00e1n Main-Lorentz t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c l\u1ea7n l\u1eb7p l\u1ea1i d\u01b0\u1edbi d\u1ea1ng c\u00e1c b\u1ed9 b\u1ed1n \u0111\u1eb7c bi\u1ec7t: $(cntr,~ l,~ k_1,~ k_2)$ trong th\u1eddi gian $O(n \\log n)$. N\u1ebfu b\u1ea1n ch\u1ec9 mu\u1ed1n t\u00ecm s\u1ed1 l\u1ea7n l\u1eb7p l\u1ea1i trong m\u1ed9t chu\u1ed7i ho\u1eb7c ch\u1ec9 mu\u1ed1n t\u00ecm l\u1ea7n l\u1eb7p l\u1ea1i d\u00e0i nh\u1ea5t trong m\u1ed9t chu\u1ed7i, th\u00f4ng tin n\u00e0y l\u00e0 \u0111\u1ee7 v\u00e0 th\u1eddi gian ch\u1ea1y v\u1eabn s\u1ebd l\u00e0 $O(n \\log n)$.</p> <p>L\u01b0u \u00fd r\u1eb1ng n\u1ebfu b\u1ea1n mu\u1ed1n m\u1edf r\u1ed9ng c\u00e1c b\u1ed9 n\u00e0y \u0111\u1ec3 c\u00f3 v\u1ecb tr\u00ed b\u1eaft \u0111\u1ea7u v\u00e0 k\u1ebft th\u00fac c\u1ee7a m\u1ed7i l\u1ea7n l\u1eb7p l\u1ea1i, th\u00ec th\u1eddi gian ch\u1ea1y s\u1ebd l\u00e0 $O(n^2)$ (h\u00e3y nh\u1edb r\u1eb1ng c\u00f3 th\u1ec3 c\u00f3 $O(n^2)$ l\u1ea7n l\u1eb7p l\u1ea1i). Trong qu\u00e1 tr\u00ecnh tri\u1ec3n khai n\u00e0y, ch\u00fang t\u00f4i s\u1ebd l\u00e0m nh\u01b0 v\u1eady v\u00e0 l\u01b0u tr\u1eef t\u1ea5t c\u1ea3 c\u00e1c l\u1ea7n l\u1eb7p l\u1ea1i \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y trong m\u1ed9t vector g\u1ed3m c\u00e1c c\u1eb7p ch\u1ec9 s\u1ed1 b\u1eaft \u0111\u1ea7u v\u00e0 k\u1ebft th\u00fac.</p> <pre><code>vector&lt;int&gt; z_function(string const&amp; s) {\n    int n = s.size();\n    vector&lt;int&gt; z(n);\n    for (int i = 1, l = 0, r = 0; i &lt; n; i++) {\n        if (i &lt;= r)\n            z[i] = min(r-i+1, z[i-l]);\n        while (i + z[i] &lt; n &amp;&amp; s[z[i]] == s[i+z[i]])\n            z[i]++;\n        if (i + z[i] - 1 &gt; r) {\n            l = i;\n            r = i + z[i] - 1;\n        }\n    }\n    return z;\n}\n\nint get_z(vector&lt;int&gt; const&amp; z, int i) {\n    if (0 &lt;= i &amp;&amp; i &lt; (int)z.size())\n        return z[i];\n    else\n        return 0;\n}\n\nvector&lt;pair&lt;int, int&gt;&gt; repetitions;\n\nvoid convert_to_repetitions(int shift, bool left, int cntr, int l, int k1, int k2) {\n    for (int l1 = max(1, l - k2); l1 &lt;= min(l, k1); l1++) {\n        if (left &amp;&amp; l1 == l) break;\n        int l2 = l - l1;\n        int pos = shift + (left ? cntr - l1 : cntr - l - l1 + 1);\n        repetitions.emplace_back(pos, pos + 2*l - 1);\n    }\n}\n\nvoid find_repetitions(string s, int shift = 0) {\n    int n = s.size();\n    if (n == 1)\n        return;\n\n    int nu = n / 2;\n    int nv = n - nu;\n    string u = s.substr(0, nu);\n    string v = s.substr(nu);\n    string ru(u.rbegin(), u.rend());\n    string rv(v.rbegin(), v.rend());\n\n    find_repetitions(u, shift);\n    find_repetitions(v, shift + nu);\n\n    vector&lt;int&gt; z1 = z_function(ru);\n    vector&lt;int&gt; z2 = z_function(v + '#' + u);\n    vector&lt;int&gt; z3 = z_function(ru + '#' + rv);\n    vector&lt;int&gt; z4 = z_function(v);\n\n    for (int cntr = 0; cntr &lt; n; cntr++) {\n        int l, k1, k2;\n        if (cntr &lt; nu) {\n            l = nu - cntr;\n            k1 = get_z(z1, nu - cntr);\n            k2 = get_z(z2, nv + 1 + cntr);\n        } else {\n            l = cntr - nu + 1;\n            k1 = get_z(z3, nu + 1 + nv - 1 - (cntr - nu));\n            k2 = get_z(z4, (cntr - nu) + 1);\n        }\n        if (k1 + k2 &gt;= l)\n            convert_to_repetitions(shift, cntr &lt; nu, cntr, l, k1, k2);\n    }\n}\n</code></pre>","tags":["Translated"]},{"location":"string/manacher.html","title":"Thu\u1eadt to\u00e1n Manacher - T\u00ecm t\u1ea5t c\u1ea3 c\u00e1c chu\u1ed7i con \u0111\u1ed1i x\u1ee9ng trong $O(N)$ (Manacher's Algorithm - Finding all sub-palindromes in $O(N)$)","text":"","tags":["Translated"]},{"location":"string/manacher.html#statement","title":"Ph\u00e1t bi\u1ec3u (Statement)","text":"<p>Cho chu\u1ed7i $s$ v\u1edbi \u0111\u1ed9 d\u00e0i $n$. T\u00ecm t\u1ea5t c\u1ea3 c\u00e1c c\u1eb7p $(i, j)$ sao cho chu\u1ed7i con $s[i\\dots j]$ l\u00e0 m\u1ed9t palindrome (chu\u1ed7i \u0111\u1ed1i x\u1ee9ng). Chu\u1ed7i $t$ l\u00e0 m\u1ed9t palindrome khi $t = t_{rev}$ ($t_{rev}$ l\u00e0 chu\u1ed7i \u0111\u1ea3o ng\u01b0\u1ee3c c\u1ee7a $t$).</p>","tags":["Translated"]},{"location":"string/manacher.html#more-precise-statement","title":"Ph\u00e1t bi\u1ec3u ch\u00ednh x\u00e1c h\u01a1n (More precise statement)","text":"<p>Trong tr\u01b0\u1eddng h\u1ee3p x\u1ea5u nh\u1ea5t, chu\u1ed7i c\u00f3 th\u1ec3 c\u00f3 t\u1edbi $O(n^2)$ chu\u1ed7i con \u0111\u1ed1i x\u1ee9ng, v\u00e0 tho\u1ea1t nh\u00ecn c\u00f3 v\u1ebb nh\u01b0 kh\u00f4ng c\u00f3 thu\u1eadt to\u00e1n tuy\u1ebfn t\u00ednh n\u00e0o cho v\u1ea5n \u0111\u1ec1 n\u00e0y.</p> <p>Nh\u01b0ng th\u00f4ng tin v\u1ec1 c\u00e1c palindrome c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c l\u01b0u gi\u1eef m\u1ed9t c\u00e1ch nh\u1ecf g\u1ecdn: \u0111\u1ed1i v\u1edbi m\u1ed7i v\u1ecb tr\u00ed $i$, ch\u00fang ta s\u1ebd t\u00ecm s\u1ed1 l\u01b0\u1ee3ng c\u00e1c palindrome kh\u00f4ng r\u1ed7ng c\u00f3 t\u00e2m t\u1ea1i v\u1ecb tr\u00ed n\u00e0y.</p> <p>C\u00e1c palindrome c\u00f3 chung t\u00e2m t\u1ea1o th\u00e0nh m\u1ed9t chu\u1ed7i li\u00ean ti\u1ebfp, ngh\u0129a l\u00e0 n\u1ebfu ch\u00fang ta c\u00f3 m\u1ed9t palindrome c\u00f3 \u0111\u1ed9 d\u00e0i $l$ \u1edf t\u00e2m $i$, ch\u00fang ta c\u0169ng c\u00f3 c\u00e1c palindrome c\u00f3 \u0111\u1ed9 d\u00e0i $l-2$, $l-4$ v\u00e0 c\u1ee9 th\u1ebf ti\u1ebfp t\u1ee5c c\u0169ng \u1edf t\u00e2m $i$. Do \u0111\u00f3, ch\u00fang ta s\u1ebd thu th\u1eadp th\u00f4ng tin v\u1ec1 t\u1ea5t c\u1ea3 c\u00e1c chu\u1ed7i con \u0111\u1ed1i x\u1ee9ng theo c\u00e1ch n\u00e0y.</p> <p>C\u00e1c palindrome c\u00f3 \u0111\u1ed9 d\u00e0i l\u1ebb v\u00e0 ch\u1eb5n \u0111\u01b0\u1ee3c t\u00ednh ri\u00eang bi\u1ec7t l\u00e0 $d_{odd}[i]$ v\u00e0 $d_{even}[i]$. \u0110\u1ed1i v\u1edbi c\u00e1c palindrome c\u00f3 \u0111\u1ed9 d\u00e0i ch\u1eb5n, ch\u00fang t\u00f4i gi\u1ea3 s\u1eed r\u1eb1ng ch\u00fang c\u00f3 t\u00e2m \u1edf v\u1ecb tr\u00ed $i$ n\u1ebfu hai k\u00fd t\u1ef1 trung t\u00e2m c\u1ee7a ch\u00fang l\u00e0 $s[i]$ v\u00e0 $s[i-1]$.</p> <p>V\u00ed d\u1ee5, chu\u1ed7i $s = abababc$ c\u00f3 ba palindrome c\u00f3 \u0111\u1ed9 d\u00e0i l\u1ebb v\u1edbi t\u00e2m \u1edf v\u1ecb tr\u00ed $s[3] = b$, t\u1ee9c l\u00e0 $d_{odd}[3] = 3$:</p> $$a\\ \\overbrace{b\\ a\\ \\underbrace{b}_{s_3}\\ a\\ b}^{d_{odd}[3]=3} c$$ <p>V\u00e0 chu\u1ed7i $s = cbaabd$ c\u00f3 hai palindrome c\u00f3 \u0111\u1ed9 d\u00e0i ch\u1eb5n v\u1edbi t\u00e2m \u1edf v\u1ecb tr\u00ed $s[3] = a$, t\u1ee9c l\u00e0 $d_{even}[3] = 2$:</p> $$c\\ \\overbrace{b\\ a\\ \\underbrace{a}_{s_3}\\ b}^{d_{even}[3]=2} d$$ <p>Th\u1eadt \u0111\u00e1ng ng\u1ea1c nhi\u00ean l\u00e0 c\u00f3 m\u1ed9t thu\u1eadt to\u00e1n, \u0111\u1ee7 \u0111\u01a1n gi\u1ea3n, t\u00ednh to\u00e1n c\u00e1c \"m\u1ea3ng palindrome\" n\u00e0y $d_{odd}[]$ v\u00e0 $d_{even}[]$ trong th\u1eddi gian tuy\u1ebfn t\u00ednh. Thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 trong b\u00e0i vi\u1ebft n\u00e0y.</p>","tags":["Translated"]},{"location":"string/manacher.html#solution","title":"Gi\u1ea3i ph\u00e1p (Solution)","text":"<p>N\u00f3i chung, v\u1ea5n \u0111\u1ec1 n\u00e0y c\u00f3 nhi\u1ec1u gi\u1ea3i ph\u00e1p: v\u1edbi B\u0103m chu\u1ed7i n\u00f3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i quy\u1ebft trong $O(n\\cdot \\log n)$, v\u00e0 v\u1edbi C\u00e2y h\u1eadu t\u1ed1 v\u00e0 LCA nhanh v\u1ea5n \u0111\u1ec1 n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i quy\u1ebft trong $O(n)$.</p> <p>Nh\u01b0ng ph\u01b0\u01a1ng ph\u00e1p \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 \u1edf \u0111\u00e2y \u0111\u1ee7 \u0111\u01a1n gi\u1ea3n h\u01a1n v\u00e0 c\u00f3 h\u1eb1ng s\u1ed1 \u1ea9n \u00edt h\u01a1n trong \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian v\u00e0 b\u1ed9 nh\u1edb. Thu\u1eadt to\u00e1n n\u00e0y \u0111\u01b0\u1ee3c ph\u00e1t hi\u1ec7n b\u1edfi Glenn K. Manacher v\u00e0o n\u0103m 1975.</p> <p>M\u1ed9t c\u00e1ch hi\u1ec7n \u0111\u1ea1i kh\u00e1c \u0111\u1ec3 gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 n\u00e0y v\u00e0 \u0111\u1ed1i ph\u00f3 v\u1edbi c\u00e1c palindrome n\u00f3i chung l\u00e0 th\u00f4ng qua c\u00e1i g\u1ecdi l\u00e0 c\u00e2y palindrome, ho\u1eb7c eertree.</p>","tags":["Translated"]},{"location":"string/manacher.html#trivial-algorithm","title":"Thu\u1eadt to\u00e1n t\u1ea7m th\u01b0\u1eddng (Trivial algorithm)","text":"<p>\u0110\u1ec3 tr\u00e1nh s\u1ef1 m\u01a1 h\u1ed3 trong m\u00f4 t\u1ea3 th\u00eam, ch\u00fang t\u00f4i bi\u1ec3u th\u1ecb \"thu\u1eadt to\u00e1n t\u1ea7m th\u01b0\u1eddng\" l\u00e0 g\u00ec.</p> <p>\u0110\u00f3 l\u00e0 thu\u1eadt to\u00e1n th\u1ef1c hi\u1ec7n nh\u1eefng \u0111i\u1ec1u sau \u0111\u00e2y. \u0110\u1ed1i v\u1edbi m\u1ed7i v\u1ecb tr\u00ed t\u00e2m $i$, n\u00f3 c\u1ed1 g\u1eafng t\u0103ng c\u00e2u tr\u1ea3 l\u1eddi l\u00ean m\u1ed9t mi\u1ec5n l\u00e0 c\u00f3 th\u1ec3, so s\u00e1nh m\u1ed9t c\u1eb7p k\u00fd t\u1ef1 t\u01b0\u01a1ng \u1ee9ng m\u1ed7i l\u1ea7n.</p> <p>M\u1ed9t thu\u1eadt to\u00e1n nh\u01b0 v\u1eady l\u00e0 ch\u1eadm, n\u00f3 ch\u1ec9 c\u00f3 th\u1ec3 t\u00ednh to\u00e1n c\u00e2u tr\u1ea3 l\u1eddi trong $O(n^2)$.</p> <p>Vi\u1ec7c c\u00e0i \u0111\u1eb7t thu\u1eadt to\u00e1n t\u1ea7m th\u01b0\u1eddng l\u00e0:</p> <pre><code>vector&lt;int&gt; manacher_odd_trivial(string s) {\n    int n = s.size();\n    s = \"$\" + s + \"^\";\n    vector&lt;int&gt; p(n + 2);\n    for(int i = 1; i &lt;= n; i++) {\n        while(s[i - p[i]] == s[i + p[i]]) {\n            p[i]++;\n        }\n    }\n    return vector&lt;int&gt;(begin(p) + 1, end(p) - 1);\n}\n</code></pre> <p>C\u00e1c k\u00fd t\u1ef1 k\u1ebft th\u00fac <code>$</code> v\u00e0 <code>^</code> \u0111\u00e3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 tr\u00e1nh x\u1eed l\u00fd c\u00e1c \u0111\u1ea7u c\u1ee7a chu\u1ed7i m\u1ed9t c\u00e1ch ri\u00eang bi\u1ec7t.</p>","tags":["Translated"]},{"location":"string/manacher.html#manachers-algorithm","title":"Thu\u1eadt to\u00e1n Manacher (Manacher's algorithm)","text":"<p>Ch\u00fang t\u00f4i m\u00f4 t\u1ea3 thu\u1eadt to\u00e1n \u0111\u1ec3 t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c chu\u1ed7i con \u0111\u1ed1i x\u1ee9ng c\u00f3 \u0111\u1ed9 d\u00e0i l\u1ebb, t\u1ee9c l\u00e0 \u0111\u1ec3 t\u00ednh $d_{odd}[]$.</p> <p>\u0110\u1ec3 t\u00ednh to\u00e1n nhanh, ch\u00fang t\u00f4i s\u1ebd duy tr\u00ec c\u00e1c bi\u00ean gi\u1edbi \u0111\u1ed9c quy\u1ec1n $(l, r)$ c\u1ee7a (chu\u1ed7i con) palindrome (con) ngo\u00e0i c\u00f9ng b\u00ean ph\u1ea3i \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y (t\u1ee9c l\u00e0 (chu\u1ed7i con) palindrome ngo\u00e0i c\u00f9ng b\u00ean ph\u1ea3i hi\u1ec7n t\u1ea1i l\u00e0 $s[l+1] s[l+2] \\dots s[r-1]$). Ban \u0111\u1ea7u ch\u00fang t\u00f4i \u0111\u1eb7t $l = 0, r = 1$, t\u01b0\u01a1ng \u1ee9ng v\u1edbi chu\u1ed7i r\u1ed7ng.</p> <p>V\u00ec v\u1eady, ch\u00fang t\u00f4i mu\u1ed1n t\u00ednh $d_{odd}[i]$ cho $i$ ti\u1ebfp theo, v\u00e0 t\u1ea5t c\u1ea3 c\u00e1c gi\u00e1 tr\u1ecb tr\u01b0\u1edbc \u0111\u00f3 trong $d_{odd}[]$ \u0111\u00e3 \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n. Ch\u00fang t\u00f4i th\u1ef1c hi\u1ec7n nh\u01b0 sau:</p> <ul> <li> <p>N\u1ebfu $i$ n\u1eb1m ngo\u00e0i chu\u1ed7i con \u0111\u1ed1i x\u1ee9ng hi\u1ec7n t\u1ea1i, t\u1ee9c l\u00e0 $i \\geq r$, ch\u00fang t\u00f4i s\u1ebd ch\u1ec9 kh\u1edfi ch\u1ea1y thu\u1eadt to\u00e1n t\u1ea7m th\u01b0\u1eddng.</p> <p>V\u00ec v\u1eady, ch\u00fang t\u00f4i s\u1ebd t\u0103ng $d_{odd}[i]$ li\u00ean ti\u1ebfp v\u00e0 ki\u1ec3m tra m\u1ed7i l\u1ea7n xem chu\u1ed7i con ngo\u00e0i c\u00f9ng b\u00ean ph\u1ea3i hi\u1ec7n t\u1ea1i $[i - d_{odd}[i]\\dots i + d_{odd}[i]]$ c\u00f3 ph\u1ea3i l\u00e0 palindrome hay kh\u00f4ng. Khi ch\u00fang t\u00f4i t\u00ecm th\u1ea5y s\u1ef1 kh\u00f4ng kh\u1edbp \u0111\u1ea7u ti\u00ean ho\u1eb7c g\u1eb7p ranh gi\u1edbi c\u1ee7a $s$, ch\u00fang t\u00f4i s\u1ebd d\u1eebng l\u1ea1i. Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, cu\u1ed1i c\u00f9ng ch\u00fang t\u00f4i \u0111\u00e3 t\u00ednh to\u00e1n $d_{odd}[i]$. Sau \u0111\u00f3, ch\u00fang ta kh\u00f4ng \u0111\u01b0\u1ee3c qu\u00ean c\u1eadp nh\u1eadt $(l, r)$. $r$ n\u00ean \u0111\u01b0\u1ee3c c\u1eadp nh\u1eadt theo c\u00e1ch m\u00e0 n\u00f3 \u0111\u1ea1i di\u1ec7n cho ch\u1ec9 s\u1ed1 cu\u1ed1i c\u00f9ng c\u1ee7a chu\u1ed7i con \u0111\u1ed1i x\u1ee9ng ngo\u00e0i c\u00f9ng b\u00ean ph\u1ea3i hi\u1ec7n t\u1ea1i.</p> </li> <li> <p>B\u00e2y gi\u1edd h\u00e3y xem x\u00e9t tr\u01b0\u1eddng h\u1ee3p khi $i \\le r$. Ch\u00fang t\u00f4i s\u1ebd c\u1ed1 g\u1eafng tr\u00edch xu\u1ea5t m\u1ed9t s\u1ed1 th\u00f4ng tin t\u1eeb c\u00e1c gi\u00e1 tr\u1ecb \u0111\u00e3 \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n trong $d_{odd}[]$. V\u00ec v\u1eady, h\u00e3y t\u00ecm v\u1ecb tr\u00ed \"g\u01b0\u01a1ng\" c\u1ee7a $i$ trong chu\u1ed7i con \u0111\u1ed1i x\u1ee9ng $(l, r)$, t\u1ee9c l\u00e0 ch\u00fang t\u00f4i s\u1ebd nh\u1eadn \u0111\u01b0\u1ee3c v\u1ecb tr\u00ed $j = l + (r - i)$, v\u00e0 ch\u00fang t\u00f4i ki\u1ec3m tra gi\u00e1 tr\u1ecb c\u1ee7a $d_{odd}[j]$. B\u1edfi v\u00ec $j$ l\u00e0 v\u1ecb tr\u00ed \u0111\u1ed1i x\u1ee9ng v\u1edbi $i$ so v\u1edbi $(l+r)/2$, ch\u00fang t\u00f4i h\u1ea7u nh\u01b0 lu\u00f4n lu\u00f4n c\u00f3 th\u1ec3 g\u00e1n $d_{odd}[i] = d_{odd}[j]$. Minh h\u1ecda v\u1ec1 \u0111i\u1ec1u n\u00e0y (palindrome xung quanh $j$ th\u1ef1c s\u1ef1 \u0111\u01b0\u1ee3c \"sao ch\u00e9p\" v\u00e0o palindrome xung quanh $i$):</p> $$ \\ldots\\  \\overbrace{     s_{l+1}\\ \\ldots\\      \\underbrace{         s_{j-d_{odd}[j]+1}\\ \\ldots\\ s_j\\ \\ldots\\ s_{j+d_{odd}[j]-1}\\      }_\\text{palindrome}\\      \\ldots\\      \\underbrace{         s_{i-d_{odd}[j]+1}\\ \\ldots\\ s_i\\ \\ldots\\ s_{i+d_{odd}[j]-1}\\      }_\\text{palindrome}\\      \\ldots\\ s_{r-1}\\  }^\\text{palindrome}\\  \\ldots $$ <p>Nh\u01b0ng c\u00f3 m\u1ed9t tr\u01b0\u1eddng h\u1ee3p kh\u00f3 kh\u0103n c\u1ea7n \u0111\u01b0\u1ee3c x\u1eed l\u00fd ch\u00ednh x\u00e1c: khi palindrome \"b\u00ean trong\" ch\u1ea1m \u0111\u1ebfn bi\u00ean gi\u1edbi c\u1ee7a c\u00e1i \"b\u00ean ngo\u00e0i\", t\u1ee9c l\u00e0 $j - d_{odd}[j] \\le l$ (ho\u1eb7c, gi\u1ed1ng nhau l\u00e0 $i + d_{odd}[j] \\ge r$). B\u1edfi v\u00ec t\u00ednh \u0111\u1ed1i x\u1ee9ng b\u00ean ngo\u00e0i palindrome \"b\u00ean ngo\u00e0i\" kh\u00f4ng \u0111\u01b0\u1ee3c \u0111\u1ea3m b\u1ea3o, ch\u1ec9 c\u1ea7n g\u00e1n $d_{odd}[i] = d_{odd}[j]$ s\u1ebd kh\u00f4ng ch\u00ednh x\u00e1c: ch\u00fang t\u00f4i kh\u00f4ng c\u00f3 \u0111\u1ee7 d\u1eef li\u1ec7u \u0111\u1ec3 n\u00f3i r\u1eb1ng palindrome \u1edf v\u1ecb tr\u00ed $i$ c\u00f3 c\u00f9ng \u0111\u1ed9 d\u00e0i.</p> <p>Th\u1ef1c ra, ch\u00fang ta n\u00ean h\u1ea1n ch\u1ebf \u0111\u1ed9 d\u00e0i c\u1ee7a palindrome c\u1ee7a m\u00ecnh ngay b\u00e2y gi\u1edd, t\u1ee9c l\u00e0 g\u00e1n $d_{odd}[i] = r - i$, \u0111\u1ec3 x\u1eed l\u00fd c\u00e1c t\u00ecnh hu\u1ed1ng nh\u01b0 v\u1eady m\u1ed9t c\u00e1ch ch\u00ednh x\u00e1c. Sau \u0111\u00f3, ch\u00fang t\u00f4i s\u1ebd ch\u1ea1y thu\u1eadt to\u00e1n t\u1ea7m th\u01b0\u1eddng s\u1ebd c\u1ed1 g\u1eafng t\u0103ng $d_{odd}[i]$ trong khi c\u00f3 th\u1ec3.</p> <p>Minh h\u1ecda tr\u01b0\u1eddng h\u1ee3p n\u00e0y (palindrome v\u1edbi t\u00e2m $j$ b\u1ecb h\u1ea1n ch\u1ebf \u0111\u1ec3 ph\u00f9 h\u1ee3p v\u1edbi palindrome \"b\u00ean ngo\u00e0i\"):</p> $$ \\ldots\\  \\overbrace{     \\underbrace{         s_{l+1}\\ \\ldots\\ s_j\\ \\ldots\\ s_{j+(j-l)-1}\\      }_\\text{palindrome}\\      \\ldots\\      \\underbrace{         s_{i-(r-i)+1}\\ \\ldots\\ s_i\\ \\ldots\\ s_{r-1}     }_\\text{palindrome}\\  }^\\text{palindrome}\\  \\underbrace{     \\ldots \\ldots \\ldots \\ldots \\ldots }_\\text{th\u1eed di chuy\u1ec3n \u0111\u1ebfn \u0111\u00e2y} $$ <p>Trong h\u00ecnh minh h\u1ecda cho th\u1ea5y m\u1eb7c d\u00f9 palindrome c\u00f3 t\u00e2m $j$ c\u00f3 th\u1ec3 l\u1edbn h\u01a1n v\u00e0 \u0111i ra ngo\u00e0i palindrome \"b\u00ean ngo\u00e0i\", nh\u01b0ng v\u1edbi $i$ l\u00e0 trung t\u00e2m, ch\u00fang t\u00f4i ch\u1ec9 c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng ph\u1ea7n ho\u00e0n to\u00e0n ph\u00f9 h\u1ee3p v\u1edbi palindrome \"b\u00ean ngo\u00e0i\". Nh\u01b0ng c\u00e2u tr\u1ea3 l\u1eddi cho v\u1ecb tr\u00ed $i$ ($d_{odd}[i]$) c\u00f3 th\u1ec3 l\u1edbn h\u01a1n nhi\u1ec1u so v\u1edbi ph\u1ea7n n\u00e0y, v\u00ec v\u1eady ti\u1ebfp theo ch\u00fang t\u00f4i s\u1ebd ch\u1ea1y thu\u1eadt to\u00e1n t\u1ea7m th\u01b0\u1eddng c\u1ee7a m\u00ecnh s\u1ebd c\u1ed1 g\u1eafng ph\u00e1t tri\u1ec3n n\u00f3 ra ngo\u00e0i palindrome \"b\u00ean ngo\u00e0i\" c\u1ee7a ch\u00fang t\u00f4i, t\u1ee9c l\u00e0 \u0111\u1ebfn v\u00f9ng \"th\u1eed di chuy\u1ec3n \u0111\u1ebfn \u0111\u00e2y\".</p> </li> </ul> <p>M\u1ed9t l\u1ea7n n\u1eefa, ch\u00fang ta kh\u00f4ng \u0111\u01b0\u1ee3c qu\u00ean c\u1eadp nh\u1eadt c\u00e1c gi\u00e1 tr\u1ecb $(l, r)$ sau khi t\u00ednh m\u1ed7i $d_{odd}[i]$.</p>","tags":["Translated"]},{"location":"string/manacher.html#complexity-of-manachers-algorithm","title":"\u0110\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a thu\u1eadt to\u00e1n Manacher (Complexity of Manacher's algorithm)","text":"<p>Tho\u1ea1t nh\u00ecn, kh\u00f4ng r\u00f5 r\u00e0ng r\u1eb1ng thu\u1eadt to\u00e1n n\u00e0y c\u00f3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian tuy\u1ebfn t\u00ednh, b\u1edfi v\u00ec ch\u00fang ta th\u01b0\u1eddng ch\u1ea1y thu\u1eadt to\u00e1n ng\u00e2y th\u01a1 trong khi t\u00ecm ki\u1ebfm c\u00e2u tr\u1ea3 l\u1eddi cho m\u1ed9t v\u1ecb tr\u00ed c\u1ee5 th\u1ec3.</p> <p>Tuy nhi\u00ean, m\u1ed9t ph\u00e2n t\u00edch c\u1ea9n th\u1eadn h\u01a1n cho th\u1ea5y thu\u1eadt to\u00e1n l\u00e0 tuy\u1ebfn t\u00ednh. Trong th\u1ef1c t\u1ebf, thu\u1eadt to\u00e1n x\u00e2y d\u1ef1ng h\u00e0m Z, tr\u00f4ng t\u01b0\u01a1ng t\u1ef1 nh\u01b0 thu\u1eadt to\u00e1n n\u00e0y, c\u0169ng ho\u1ea1t \u0111\u1ed9ng trong th\u1eddi gian tuy\u1ebfn t\u00ednh.</p> <p>Ch\u00fang ta c\u00f3 th\u1ec3 nh\u1eadn th\u1ea5y r\u1eb1ng m\u1ecdi l\u1ea7n l\u1eb7p c\u1ee7a thu\u1eadt to\u00e1n t\u1ea7m th\u01b0\u1eddng \u0111\u1ec1u t\u0103ng $r$ th\u00eam m\u1ed9t. Ngo\u00e0i ra $r$ kh\u00f4ng th\u1ec3 gi\u1ea3m trong thu\u1eadt to\u00e1n. V\u00ec v\u1eady, thu\u1eadt to\u00e1n t\u1ea7m th\u01b0\u1eddng s\u1ebd th\u1ef1c hi\u1ec7n t\u1ed5ng c\u1ed9ng $O(n)$ l\u1ea7n l\u1eb7p.</p> <p>C\u00e1c ph\u1ea7n kh\u00e1c c\u1ee7a thu\u1eadt to\u00e1n Manacher ho\u1ea1t \u0111\u1ed9ng r\u00f5 r\u00e0ng trong th\u1eddi gian tuy\u1ebfn t\u00ednh. Do \u0111\u00f3, ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian $O(n)$.</p>","tags":["Translated"]},{"location":"string/manacher.html#implementation-of-manachers-algorithm","title":"C\u00e0i \u0111\u1eb7t thu\u1eadt to\u00e1n Manacher (Implementation of Manacher's algorithm)","text":"<p>\u0110\u1ec3 t\u00ednh $d_{odd}[]$, ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c m\u00e3 sau. Nh\u1eefng \u0111i\u1ec1u c\u1ea7n l\u01b0u \u00fd:</p> <ul> <li>$i$ l\u00e0 ch\u1ec9 s\u1ed1 c\u1ee7a ch\u1eef c\u00e1i t\u00e2m c\u1ee7a palindrome hi\u1ec7n t\u1ea1i.</li> <li>N\u1ebfu $i$ v\u01b0\u1ee3t qu\u00e1 $r$, $d_{odd}[i]$ \u0111\u01b0\u1ee3c kh\u1edfi t\u1ea1o th\u00e0nh 0.</li> <li>N\u1ebfu $i$ kh\u00f4ng v\u01b0\u1ee3t qu\u00e1 $r$, $d_{odd}[i]$ \u0111\u01b0\u1ee3c kh\u1edfi t\u1ea1o th\u00e0nh $d_{odd}[j]$, trong \u0111\u00f3 $j$ l\u00e0 v\u1ecb tr\u00ed g\u01b0\u01a1ng c\u1ee7a $i$ trong $(l,r)$, ho\u1eb7c $d_{odd}[i]$ b\u1ecb gi\u1edbi h\u1ea1n \u1edf k\u00edch th\u01b0\u1edbc c\u1ee7a palindrome \"b\u00ean ngo\u00e0i\".</li> <li>V\u00f2ng l\u1eb7p while bi\u1ec3u th\u1ecb thu\u1eadt to\u00e1n t\u1ea7m th\u01b0\u1eddng. Ch\u00fang t\u00f4i kh\u1edfi ch\u1ea1y n\u00f3 b\u1ea5t k\u1ec3 gi\u00e1 tr\u1ecb c\u1ee7a $k$.</li> <li>N\u1ebfu k\u00edch th\u01b0\u1edbc c\u1ee7a palindrome c\u00f3 t\u00e2m t\u1ea1i $i$ l\u00e0 $x$, th\u00ec $d_{odd}[i]$ l\u01b0u tr\u1eef $\\frac{x+1}{2}$.</li> </ul> <pre><code>vector&lt;int&gt; manacher_odd(string s) {\n    int n = s.size();\n    s = \"$\" + s + \"^\";\n    vector&lt;int&gt; p(n + 2);\n    int l = 0, r = 1;\n    for(int i = 1; i &lt;= n; i++) {\n        p[i] = min(r - i, p[l + (r - i)]);\n        while(s[i - p[i]] == s[i + p[i]]) {\n            p[i]++;\n        }\n        if(i + p[i] &gt; r) {\n            l = i - p[i], r = i + p[i];\n        }\n    }\n    return vector&lt;int&gt;(begin(p) + 1, end(p) - 1);\n}\n</code></pre>","tags":["Translated"]},{"location":"string/manacher.html#working-with-parities","title":"L\u00e0m vi\u1ec7c v\u1edbi t\u00ednh ch\u1eb5n l\u1ebb (Working with parities)","text":"<p>M\u1eb7c d\u00f9 c\u00f3 th\u1ec3 tri\u1ec3n khai thu\u1eadt to\u00e1n Manacher cho \u0111\u1ed9 d\u00e0i l\u1ebb v\u00e0 ch\u1eb5n m\u1ed9t c\u00e1ch ri\u00eang bi\u1ec7t, nh\u01b0ng vi\u1ec7c tri\u1ec3n khai phi\u00ean b\u1ea3n cho \u0111\u1ed9 d\u00e0i ch\u1eb5n th\u01b0\u1eddng \u0111\u01b0\u1ee3c coi l\u00e0 kh\u00f3 kh\u0103n h\u01a1n, v\u00ec n\u00f3 k\u00e9m t\u1ef1 nhi\u00ean h\u01a1n v\u00e0 d\u1ec5 d\u1eabn \u0111\u1ebfn l\u1ed7i l\u1ec7ch m\u1ed9t \u0111\u01a1n v\u1ecb (off-by-one errors).</p> <p>\u0110\u1ec3 gi\u1ea3m thi\u1ec3u \u0111i\u1ec1u n\u00e0y, c\u00f3 th\u1ec3 gi\u1ea3m to\u00e0n b\u1ed9 v\u1ea5n \u0111\u1ec1 xu\u1ed1ng tr\u01b0\u1eddng h\u1ee3p khi ch\u00fang ta ch\u1ec9 x\u1eed l\u00fd c\u00e1c palindrome c\u00f3 \u0111\u1ed9 d\u00e0i l\u1ebb. \u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y, ch\u00fang ta c\u00f3 th\u1ec3 \u0111\u1eb7t th\u00eam k\u00fd t\u1ef1 <code>#</code> gi\u1eefa m\u1ed7i ch\u1eef c\u00e1i trong chu\u1ed7i v\u00e0 c\u1ea3 \u1edf \u0111\u1ea7u v\u00e0 cu\u1ed1i chu\u1ed7i:</p> $$abcbcba \\to \\#a\\#b\\#c\\#b\\#c\\#b\\#a\\#,$$ $$d = [1,2,1,2,1,4,1,8,1,4,1,2,1,2,1].$$ <p>Nh\u01b0 b\u1ea1n c\u00f3 th\u1ec3 th\u1ea5y, $d[2i]=2 d_{even}[i]+1$ v\u00e0 $d[2i+1]=2 d_{odd}[i]$ trong \u0111\u00f3 $d$ bi\u1ec3u th\u1ecb m\u1ea3ng Manacher cho c\u00e1c palindrome c\u00f3 \u0111\u1ed9 d\u00e0i l\u1ebb trong chu\u1ed7i \u0111\u01b0\u1ee3c n\u1ed1i <code>#</code>, trong khi $d_{odd}$ v\u00e0 $d_{even}$ t\u01b0\u01a1ng \u1ee9ng v\u1edbi c\u00e1c m\u1ea3ng \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh \u1edf tr\u00ean trong chu\u1ed7i ban \u0111\u1ea7u.</p> <p>Th\u1eadt v\u1eady, c\u00e1c k\u00fd t\u1ef1 <code>#</code> kh\u00f4ng \u1ea3nh h\u01b0\u1edfng \u0111\u1ebfn c\u00e1c palindrome c\u00f3 \u0111\u1ed9 d\u00e0i l\u1ebb, v\u1eabn t\u1eadp trung v\u00e0o c\u00e1c k\u00fd t\u1ef1 c\u1ee7a chu\u1ed7i ban \u0111\u1ea7u, nh\u01b0ng b\u00e2y gi\u1edd c\u00e1c palindrome c\u00f3 \u0111\u1ed9 d\u00e0i ch\u1eb5n c\u1ee7a chu\u1ed7i ban \u0111\u1ea7u l\u00e0 c\u00e1c palindrome c\u00f3 \u0111\u1ed9 d\u00e0i l\u1ebb c\u1ee7a chu\u1ed7i m\u1edbi t\u1eadp trung v\u00e0o c\u00e1c k\u00fd t\u1ef1 <code>#</code>.</p> <p>L\u01b0u \u00fd r\u1eb1ng $d[2i]$ v\u00e0 $d[2i+1]$ v\u1ec1 c\u01a1 b\u1ea3n l\u00e0 \u0111\u1ed9 d\u00e0i t\u0103ng th\u00eam $1$ c\u1ee7a c\u00e1c palindrome c\u00f3 \u0111\u1ed9 d\u00e0i l\u1ebb v\u00e0 ch\u1eb5n l\u1edbn nh\u1ea5t c\u00f3 t\u00e2m t\u1ea1i $i$ t\u01b0\u01a1ng \u1ee9ng.</p> <p>Vi\u1ec7c gi\u1ea3m \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n theo c\u00e1ch sau:</p> <pre><code>vector&lt;int&gt; manacher(string s) {\n    string t;\n    for(auto c: s) {\n        t += string(\"#\") + c;\n    }\n    auto res = manacher_odd(t + \"#\");\n    return vector&lt;int&gt;(begin(res) + 1, end(res) - 1);\n}\n</code></pre> <p>\u0110\u1ec3 \u0111\u01a1n gi\u1ea3n, vi\u1ec7c chia m\u1ea3ng th\u00e0nh $d_{odd}$ v\u00e0 $d_{even}$ c\u0169ng nh\u01b0 t\u00ednh to\u00e1n r\u00f5 r\u00e0ng c\u1ee7a ch\u00fang b\u1ecb b\u1ecf qua.</p>","tags":["Translated"]},{"location":"string/manacher.html#problems","title":"B\u00e0i t\u1eadp (Problems)","text":"<ul> <li>Library Checker - Enumerate Palindromes</li> <li>Longest Palindrome</li> <li>UVA 11475 - Extend to Palindrome</li> <li>GYM - (Q) QueryreuQ</li> <li>CF - Prefix-Suffix Palindrome</li> <li>SPOJ - Number of Palindromes</li> <li>Kattis - Palindromes</li> </ul>","tags":["Translated"]},{"location":"string/prefix-function.html","title":"H\u00e0m ti\u1ec1n t\u1ed1. Thu\u1eadt to\u00e1n Knuth\u2013Morris\u2013Pratt (Prefix function. Knuth\u2013Morris\u2013Pratt algorithm)","text":"","tags":["Translated"]},{"location":"string/prefix-function.html#prefix-function-definition","title":"\u0110\u1ecbnh ngh\u0129a h\u00e0m ti\u1ec1n t\u1ed1 (Prefix function definition)","text":"<p>B\u1ea1n \u0111\u01b0\u1ee3c cho m\u1ed9t chu\u1ed7i $s$ c\u00f3 \u0111\u1ed9 d\u00e0i $n$. H\u00e0m ti\u1ec1n t\u1ed1 cho chu\u1ed7i n\u00e0y \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a l\u00e0 m\u1ed9t m\u1ea3ng $\\pi$ c\u00f3 \u0111\u1ed9 d\u00e0i $n$, trong \u0111\u00f3 $\\pi[i]$ l\u00e0 \u0111\u1ed9 d\u00e0i c\u1ee7a ti\u1ec1n t\u1ed1 th\u1ef1c s\u1ef1 d\u00e0i nh\u1ea5t c\u1ee7a chu\u1ed7i con $s[0 \\dots i]$ m\u00e0 c\u0169ng l\u00e0 m\u1ed9t h\u1eadu t\u1ed1 c\u1ee7a chu\u1ed7i con n\u00e0y. Ti\u1ec1n t\u1ed1 th\u1ef1c s\u1ef1 c\u1ee7a m\u1ed9t chu\u1ed7i l\u00e0 ti\u1ec1n t\u1ed1 kh\u00f4ng b\u1eb1ng ch\u00ednh chu\u1ed7i \u0111\u00f3. Theo \u0111\u1ecbnh ngh\u0129a, $\\pi[0] = 0$.</p> <p>V\u1ec1 m\u1eb7t to\u00e1n h\u1ecdc, \u0111\u1ecbnh ngh\u0129a c\u1ee7a h\u00e0m ti\u1ec1n t\u1ed1 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c vi\u1ebft nh\u01b0 sau:</p> $$\\pi[i] = \\max_ {k = 0 \\dots i} \\{k : s[0 \\dots k-1] = s[i-(k-1) \\dots i] \\}$$ <p>V\u00ed d\u1ee5: h\u00e0m ti\u1ec1n t\u1ed1 c\u1ee7a chu\u1ed7i \"abcabcd\" l\u00e0 $[0, 0, 0, 1, 2, 3, 0]$, v\u00e0 h\u00e0m ti\u1ec1n t\u1ed1 c\u1ee7a chu\u1ed7i \"aabaaab\" l\u00e0 $[0, 1, 0, 1, 2, 2, 3]$.</p>","tags":["Translated"]},{"location":"string/prefix-function.html#trivial-algorithm","title":"Thu\u1eadt to\u00e1n T\u1ea7m th\u01b0\u1eddng (Trivial Algorithm)","text":"<p>M\u1ed9t thu\u1eadt to\u00e1n tu\u00e2n theo \u0111\u1ecbnh ngh\u0129a c\u1ee7a h\u00e0m ti\u1ec1n t\u1ed1 m\u1ed9t c\u00e1ch ch\u00ednh x\u00e1c l\u00e0 nh\u01b0 sau:</p> <pre><code>vector&lt;int&gt; prefix_function(string s) {\n    int n = (int)s.length();\n    vector&lt;int&gt; pi(n);\n    for (int i = 0; i &lt; n; i++)\n        for (int k = 0; k &lt;= i; k++)\n            if (s.substr(0, k) == s.substr(i-k+1, k))\n                pi[i] = k;\n    return pi;\n}\n</code></pre> <p>D\u1ec5 th\u1ea5y r\u1eb1ng \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a n\u00f3 l\u00e0 $O(n^3)$, \u0111i\u1ec1u n\u00e0y c\u00f3 ch\u1ed7 \u0111\u1ec3 c\u1ea3i thi\u1ec7n.</p>","tags":["Translated"]},{"location":"string/prefix-function.html#efficient-algorithm","title":"Thu\u1eadt to\u00e1n Hi\u1ec7u qu\u1ea3 (Efficient Algorithm)","text":"<p>Thu\u1eadt to\u00e1n n\u00e0y \u0111\u01b0\u1ee3c \u0111\u1ec1 xu\u1ea5t b\u1edfi Knuth v\u00e0 Pratt v\u00e0 \u0111\u1ed9c l\u1eadp v\u1edbi h\u1ecd b\u1edfi Morris v\u00e0o n\u0103m 1977. N\u00f3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng l\u00e0m h\u00e0m ch\u00ednh c\u1ee7a m\u1ed9t thu\u1eadt to\u00e1n t\u00ecm ki\u1ebfm chu\u1ed7i con.</p>","tags":["Translated"]},{"location":"string/prefix-function.html#first-optimization","title":"T\u1ed1i \u01b0u h\u00f3a \u0111\u1ea7u ti\u00ean (First optimization)","text":"<p>Quan s\u00e1t quan tr\u1ecdng \u0111\u1ea7u ti\u00ean l\u00e0, c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a h\u00e0m ti\u1ec1n t\u1ed1 ch\u1ec9 c\u00f3 th\u1ec3 t\u0103ng t\u1ed1i \u0111a m\u1ed9t.</p> <p>Th\u1eadt v\u1eady, n\u1ebfu kh\u00f4ng, n\u1ebfu $\\pi[i + 1] \\gt \\pi[i] + 1$, th\u00ec ch\u00fang ta c\u00f3 th\u1ec3 l\u1ea5y h\u1eadu t\u1ed1 n\u00e0y k\u1ebft th\u00fac \u1edf v\u1ecb tr\u00ed $i + 1$ v\u1edbi \u0111\u1ed9 d\u00e0i $\\pi[i + 1]$ v\u00e0 lo\u1ea1i b\u1ecf k\u00fd t\u1ef1 cu\u1ed1i c\u00f9ng kh\u1ecfi n\u00f3. Ch\u00fang ta k\u1ebft th\u00fac v\u1edbi m\u1ed9t h\u1eadu t\u1ed1 k\u1ebft th\u00fac \u1edf v\u1ecb tr\u00ed $i$ v\u1edbi \u0111\u1ed9 d\u00e0i $\\pi[i + 1] - 1$, t\u1ed1t h\u01a1n $\\pi[i]$, t\u1ee9c l\u00e0 ch\u00fang ta g\u1eb7p m\u00e2u thu\u1eabn.</p> <p>H\u00ecnh minh h\u1ecda sau \u0111\u00e2y cho th\u1ea5y m\u00e2u thu\u1eabn n\u00e0y. H\u1eadu t\u1ed1 th\u1ef1c s\u1ef1 d\u00e0i nh\u1ea5t t\u1ea1i v\u1ecb tr\u00ed $i$ c\u0169ng l\u00e0 m\u1ed9t ti\u1ec1n t\u1ed1 c\u00f3 \u0111\u1ed9 d\u00e0i $2$, v\u00e0 t\u1ea1i v\u1ecb tr\u00ed $i+1$ n\u00f3 c\u00f3 \u0111\u1ed9 d\u00e0i $4$. Do \u0111\u00f3 chu\u1ed7i $s_0 ~ s_1 ~ s_2 ~ s_3$ b\u1eb1ng v\u1edbi chu\u1ed7i $s_{i-2} ~ s_{i-1} ~ s_i ~ s_{i+1}$, \u0111i\u1ec1u \u0111\u00f3 c\u00f3 ngh\u0129a l\u00e0 c\u00e1c chu\u1ed7i $s_0 ~ s_1 ~ s_2$ v\u00e0 $s_{i-2} ~ s_{i-1} ~ s_i$ c\u0169ng b\u1eb1ng nhau, do \u0111\u00f3 $\\pi[i]$ ph\u1ea3i l\u00e0 $3$.</p> $$\\underbrace{\\overbrace{s_0 ~ s_1}^{\\pi[i] = 2} ~ s_2 ~ s_3}_{\\pi[i+1] = 4} ~ \\dots ~ \\underbrace{s_{i-2} ~ \\overbrace{s_{i-1} ~ s_{i}}^{\\pi[i] = 2} ~ s_{i+1}}_{\\pi[i+1] = 4}$$ <p>Do \u0111\u00f3 khi di chuy\u1ec3n \u0111\u1ebfn v\u1ecb tr\u00ed ti\u1ebfp theo, gi\u00e1 tr\u1ecb c\u1ee7a h\u00e0m ti\u1ec1n t\u1ed1 c\u00f3 th\u1ec3 t\u0103ng th\u00eam m\u1ed9t, gi\u1eef nguy\u00ean ho\u1eb7c gi\u1ea3m \u0111i m\u1ed9t l\u01b0\u1ee3ng n\u00e0o \u0111\u00f3. Th\u1ef1c t\u1ebf n\u00e0y \u0111\u00e3 cho ph\u00e9p ch\u00fang ta gi\u1ea3m \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a thu\u1eadt to\u00e1n xu\u1ed1ng $O(n^2)$, b\u1edfi v\u00ec trong m\u1ed9t b\u01b0\u1edbc, h\u00e0m ti\u1ec1n t\u1ed1 c\u00f3 th\u1ec3 t\u0103ng t\u1ed1i \u0111a m\u1ed9t. T\u1ed5ng c\u1ed9ng h\u00e0m c\u00f3 th\u1ec3 t\u0103ng t\u1ed1i \u0111a $n$ b\u01b0\u1edbc, v\u00e0 do \u0111\u00f3 c\u0169ng ch\u1ec9 c\u00f3 th\u1ec3 gi\u1ea3m t\u1ed5ng c\u1ed9ng $n$ b\u01b0\u1edbc. \u0110i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 ch\u00fang ta ch\u1ec9 ph\u1ea3i th\u1ef1c hi\u1ec7n $O(n)$ ph\u00e9p so s\u00e1nh chu\u1ed7i, v\u00e0 \u0111\u1ea1t \u0111\u01b0\u1ee3c \u0111\u1ed9 ph\u1ee9c t\u1ea1p $O(n^2)$.</p>","tags":["Translated"]},{"location":"string/prefix-function.html#second-optimization","title":"T\u1ed1i \u01b0u h\u00f3a th\u1ee9 hai (Second optimization)","text":"<p>H\u00e3y \u0111i xa h\u01a1n, ch\u00fang ta mu\u1ed1n lo\u1ea1i b\u1ecf c\u00e1c so s\u00e1nh chu\u1ed7i. \u0110\u1ec3 th\u1ef1c hi\u1ec7n \u0111i\u1ec1u n\u00e0y, ch\u00fang ta ph\u1ea3i s\u1eed d\u1ee5ng t\u1ea5t c\u1ea3 th\u00f4ng tin \u0111\u00e3 \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n trong c\u00e1c b\u01b0\u1edbc tr\u01b0\u1edbc \u0111\u00f3.</p> <p>V\u00ec v\u1eady, h\u00e3y t\u00ednh gi\u00e1 tr\u1ecb c\u1ee7a h\u00e0m ti\u1ec1n t\u1ed1 $\\pi$ cho $i + 1$. N\u1ebfu $s[i+1] = s[\\pi[i]]$, th\u00ec ch\u00fang ta c\u00f3 th\u1ec3 n\u00f3i ch\u1eafc ch\u1eafn r\u1eb1ng $\\pi[i+1] = \\pi[i] + 1$, v\u00ec ch\u00fang ta \u0111\u00e3 bi\u1ebft r\u1eb1ng h\u1eadu t\u1ed1 \u1edf v\u1ecb tr\u00ed $i$ c\u00f3 \u0111\u1ed9 d\u00e0i $\\pi[i]$ b\u1eb1ng v\u1edbi ti\u1ec1n t\u1ed1 c\u00f3 \u0111\u1ed9 d\u00e0i $\\pi[i]$. \u0110i\u1ec1u n\u00e0y \u0111\u01b0\u1ee3c minh h\u1ecda l\u1ea1i b\u1eb1ng m\u1ed9t v\u00ed d\u1ee5.</p> $$\\underbrace{\\overbrace{s_0 ~ s_1 ~ s_2}^{\\pi[i]} ~ \\overbrace{s_3}^{s_3 = s_{i+1}}}_{\\pi[i+1] = \\pi[i] + 1} ~ \\dots ~ \\underbrace{\\overbrace{s_{i-2} ~ s_{i-1} ~ s_{i}}^{\\pi[i]} ~ \\overbrace{s_{i+1}}^{s_3 = s_{i + 1}}}_{\\pi[i+1] = \\pi[i] + 1}$$ <p>N\u1ebfu kh\u00f4ng ph\u1ea3i tr\u01b0\u1eddng h\u1ee3p n\u00e0y, $s[i+1] \\neq s[\\pi[i]]$, th\u00ec ch\u00fang ta c\u1ea7n th\u1eed m\u1ed9t chu\u1ed7i ng\u1eafn h\u01a1n. \u0110\u1ec3 t\u0103ng t\u1ed1c m\u1ecdi th\u1ee9, ch\u00fang ta mu\u1ed1n di chuy\u1ec3n ngay l\u1eadp t\u1ee9c \u0111\u1ebfn \u0111\u1ed9 d\u00e0i d\u00e0i nh\u1ea5t $j \\lt \\pi[i]$, sao cho t\u00ednh ch\u1ea5t ti\u1ec1n t\u1ed1 \u1edf v\u1ecb tr\u00ed $i$ \u0111\u01b0\u1ee3c gi\u1eef, t\u1ee9c l\u00e0 $s[0 \\dots j-1] = s[i-j+1 \\dots i]$:</p> $$\\overbrace{\\underbrace{s_0 ~ s_1}_j ~ s_2 ~ s_3}^{\\pi[i]} ~ \\dots ~ \\overbrace{s_{i-3} ~ s_{i-2} ~ \\underbrace{s_{i-1} ~ s_{i}}_j}^{\\pi[i]} ~ s_{i+1}$$ <p>Th\u1eadt v\u1eady, n\u1ebfu ch\u00fang ta t\u00ecm th\u1ea5y m\u1ed9t \u0111\u1ed9 d\u00e0i $j$ nh\u01b0 v\u1eady, th\u00ec ch\u00fang ta l\u1ea1i ch\u1ec9 c\u1ea7n so s\u00e1nh c\u00e1c k\u00fd t\u1ef1 $s[i+1]$ v\u00e0 $s[j]$. N\u1ebfu ch\u00fang b\u1eb1ng nhau, th\u00ec ch\u00fang ta c\u00f3 th\u1ec3 g\u00e1n $\\pi[i+1] = j + 1$. Ng\u01b0\u1ee3c l\u1ea1i, ch\u00fang ta s\u1ebd c\u1ea7n t\u00ecm gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t nh\u1ecf h\u01a1n $j$, m\u00e0 t\u00ednh ch\u1ea5t ti\u1ec1n t\u1ed1 \u0111\u01b0\u1ee3c gi\u1eef, v\u00e0 c\u1ee9 th\u1ebf ti\u1ebfp t\u1ee5c. \u0110i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 x\u1ea3y ra cho \u0111\u1ebfn khi $j = 0$. N\u1ebfu sau \u0111\u00f3 $s[i+1] = s[0]$, ch\u00fang ta g\u00e1n $\\pi[i+1] = 1$, v\u00e0 ng\u01b0\u1ee3c l\u1ea1i $\\pi[i+1] = 0$.</p> <p>V\u00ec v\u1eady, ch\u00fang ta \u0111\u00e3 c\u00f3 m\u1ed9t s\u01a1 \u0111\u1ed3 chung c\u1ee7a thu\u1eadt to\u00e1n. C\u00e2u h\u1ecfi duy nh\u1ea5t c\u00f2n l\u1ea1i l\u00e0 l\u00e0m th\u1ebf n\u00e0o \u0111\u1ec3 t\u00ecm hi\u1ec7u qu\u1ea3 c\u00e1c \u0111\u1ed9 d\u00e0i cho $j$. H\u00e3y t\u00f3m t\u1eaft l\u1ea1i: \u0111\u1ed1i v\u1edbi \u0111\u1ed9 d\u00e0i hi\u1ec7n t\u1ea1i $j$ t\u1ea1i v\u1ecb tr\u00ed $i$ m\u00e0 t\u00ednh ch\u1ea5t ti\u1ec1n t\u1ed1 \u0111\u01b0\u1ee3c gi\u1eef, t\u1ee9c l\u00e0 $s[0 \\dots j-1] = s[i-j+1 \\dots i]$, ch\u00fang ta mu\u1ed1n t\u00ecm $k \\lt j$ l\u1edbn nh\u1ea5t, m\u00e0 t\u00ednh ch\u1ea5t ti\u1ec1n t\u1ed1 \u0111\u01b0\u1ee3c gi\u1eef.</p> $$\\overbrace{\\underbrace{s_0 ~ s_1}_k ~ s_2 ~ s_3}^j ~ \\dots ~ \\overbrace{s_{i-3} ~ s_{i-2} ~ \\underbrace{s_{i-1} ~ s_{i}}_k}^j ~s_{i+1}$$ <p>H\u00ecnh minh h\u1ecda cho th\u1ea5y, \u0111\u00e2y ph\u1ea3i l\u00e0 gi\u00e1 tr\u1ecb c\u1ee7a $\\pi[j-1]$, m\u00e0 ch\u00fang ta \u0111\u00e3 t\u00ednh to\u00e1n tr\u01b0\u1edbc \u0111\u00f3.</p>","tags":["Translated"]},{"location":"string/prefix-function.html#final-algorithm","title":"Thu\u1eadt to\u00e1n cu\u1ed1i c\u00f9ng (Final algorithm)","text":"<p>V\u00ec v\u1eady, cu\u1ed1i c\u00f9ng ch\u00fang ta c\u00f3 th\u1ec3 x\u00e2y d\u1ef1ng m\u1ed9t thu\u1eadt to\u00e1n kh\u00f4ng th\u1ef1c hi\u1ec7n b\u1ea5t k\u1ef3 so s\u00e1nh chu\u1ed7i n\u00e0o v\u00e0 ch\u1ec9 th\u1ef1c hi\u1ec7n $O(n)$ h\u00e0nh \u0111\u1ed9ng.</p> <p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 th\u1ee7 t\u1ee5c cu\u1ed1i c\u00f9ng:</p> <ul> <li>Ch\u00fang ta t\u00ednh to\u00e1n c\u00e1c gi\u00e1 tr\u1ecb ti\u1ec1n t\u1ed1 $\\pi[i]$ trong m\u1ed9t v\u00f2ng l\u1eb7p b\u1eb1ng c\u00e1ch l\u1eb7p t\u1eeb $i = 1$ \u0111\u1ebfn $i = n-1$ ($\\pi[0]$ ch\u1ec9 \u0111\u01b0\u1ee3c g\u00e1n b\u1eb1ng $0$).</li> <li>\u0110\u1ec3 t\u00ednh to\u00e1n gi\u00e1 tr\u1ecb hi\u1ec7n t\u1ea1i $\\pi[i]$, ch\u00fang ta \u0111\u1eb7t bi\u1ebfn $j$ bi\u1ec3u th\u1ecb \u0111\u1ed9 d\u00e0i c\u1ee7a h\u1eadu t\u1ed1 t\u1ed1t nh\u1ea5t cho $i-1$. Ban \u0111\u1ea7u $j = \\pi[i-1]$.</li> <li>Ki\u1ec3m tra xem h\u1eadu t\u1ed1 c\u00f3 \u0111\u1ed9 d\u00e0i $j+1$ c\u00f3 ph\u1ea3i c\u0169ng l\u00e0 ti\u1ec1n t\u1ed1 hay kh\u00f4ng b\u1eb1ng c\u00e1ch so s\u00e1nh $s[j]$ v\u00e0 $s[i]$. N\u1ebfu ch\u00fang b\u1eb1ng nhau th\u00ec ch\u00fang ta g\u00e1n $\\pi[i] = j + 1$, ng\u01b0\u1ee3c l\u1ea1i ch\u00fang ta gi\u1ea3m $j$ xu\u1ed1ng $\\pi[j-1]$ v\u00e0 l\u1eb7p l\u1ea1i b\u01b0\u1edbc n\u00e0y.</li> <li>N\u1ebfu ch\u00fang ta \u0111\u00e3 \u0111\u1ea1t \u0111\u1ebfn \u0111\u1ed9 d\u00e0i $j = 0$ v\u00e0 v\u1eabn kh\u00f4ng c\u00f3 kh\u1edbp, th\u00ec ch\u00fang ta g\u00e1n $\\pi[i] = 0$ v\u00e0 \u0111i \u0111\u1ebfn ch\u1ec9 s\u1ed1 ti\u1ebfp theo $i + 1$.</li> </ul>","tags":["Translated"]},{"location":"string/prefix-function.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>Vi\u1ec7c c\u00e0i \u0111\u1eb7t k\u1ebft th\u00fac ng\u1eafn g\u1ecdn v\u00e0 bi\u1ec3u c\u1ea3m m\u1ed9t c\u00e1ch \u0111\u00e1ng ng\u1ea1c nhi\u00ean.</p> <pre><code>vector&lt;int&gt; prefix_function(string s) {\n    int n = (int)s.length();\n    vector&lt;int&gt; pi(n);\n    for (int i = 1; i &lt; n; i++) {\n        int j = pi[i-1];\n        while (j &gt; 0 &amp;&amp; s[i] != s[j])\n            j = pi[j-1];\n        if (s[i] == s[j])\n            j++;\n        pi[i] = j;\n    }\n    return pi;\n}\n</code></pre> <p>\u0110\u00e2y l\u00e0 m\u1ed9t thu\u1eadt to\u00e1n tr\u1ef1c tuy\u1ebfn (online), t\u1ee9c l\u00e0 n\u00f3 x\u1eed l\u00fd d\u1eef li\u1ec7u khi n\u00f3 \u0111\u1ebfn - v\u00ed d\u1ee5, b\u1ea1n c\u00f3 th\u1ec3 \u0111\u1ecdc c\u00e1c k\u00fd t\u1ef1 chu\u1ed7i t\u1eebng c\u00e1i m\u1ed9t v\u00e0 x\u1eed l\u00fd ch\u00fang ngay l\u1eadp t\u1ee9c, t\u00ecm gi\u00e1 tr\u1ecb c\u1ee7a h\u00e0m ti\u1ec1n t\u1ed1 cho m\u1ed7i k\u00fd t\u1ef1 ti\u1ebfp theo. Thu\u1eadt to\u00e1n v\u1eabn y\u00eau c\u1ea7u l\u01b0u tr\u1eef ch\u00ednh chu\u1ed7i v\u00e0 c\u00e1c gi\u00e1 tr\u1ecb \u0111\u00e3 t\u00ednh to\u00e1n tr\u01b0\u1edbc \u0111\u00f3 c\u1ee7a h\u00e0m ti\u1ec1n t\u1ed1, nh\u01b0ng n\u1ebfu ch\u00fang ta bi\u1ebft tr\u01b0\u1edbc gi\u00e1 tr\u1ecb t\u1ed1i \u0111a $M$ m\u00e0 h\u00e0m ti\u1ec1n t\u1ed1 c\u00f3 th\u1ec3 nh\u1eadn tr\u00ean chu\u1ed7i, ch\u00fang ta ch\u1ec9 c\u00f3 th\u1ec3 l\u01b0u tr\u1eef $M+1$ k\u00fd t\u1ef1 \u0111\u1ea7u ti\u00ean c\u1ee7a chu\u1ed7i v\u00e0 c\u00f9ng m\u1ed9t s\u1ed1 l\u01b0\u1ee3ng gi\u00e1 tr\u1ecb c\u1ee7a h\u00e0m ti\u1ec1n t\u1ed1.</p>","tags":["Translated"]},{"location":"string/prefix-function.html#applications","title":"\u1ee8ng d\u1ee5ng (Applications)","text":"","tags":["Translated"]},{"location":"string/prefix-function.html#search-for-a-substring-in-a-string-the-knuth-morris-pratt-algorithm","title":"T\u00ecm ki\u1ebfm m\u1ed9t chu\u1ed7i con trong m\u1ed9t chu\u1ed7i. Thu\u1eadt to\u00e1n Knuth-Morris-Pratt (Search for a substring in a string. The Knuth-Morris-Pratt algorithm)","text":"<p>Nhi\u1ec7m v\u1ee5 l\u00e0 \u1ee9ng d\u1ee5ng c\u1ed5 \u0111i\u1ec3n c\u1ee7a h\u00e0m ti\u1ec1n t\u1ed1.</p> <p>Cho m\u1ed9t v\u0103n b\u1ea3n $t$ v\u00e0 m\u1ed9t chu\u1ed7i $s$, ch\u00fang ta mu\u1ed1n t\u00ecm v\u00e0 hi\u1ec3n th\u1ecb c\u00e1c v\u1ecb tr\u00ed c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c l\u1ea7n xu\u1ea5t hi\u1ec7n c\u1ee7a chu\u1ed7i $s$ trong v\u0103n b\u1ea3n $t$.</p> <p>\u0110\u1ec3 thu\u1eadn ti\u1ec7n, ch\u00fang ta k\u00fd hi\u1ec7u $n$ l\u00e0 \u0111\u1ed9 d\u00e0i c\u1ee7a chu\u1ed7i s v\u00e0 $m$ l\u00e0 \u0111\u1ed9 d\u00e0i c\u1ee7a v\u0103n b\u1ea3n $t$.</p> <p>Ch\u00fang ta t\u1ea1o chu\u1ed7i $s + \\# + t$, trong \u0111\u00f3 $\\#$ l\u00e0 d\u1ea5u ph\u00e2n c\u00e1ch kh\u00f4ng xu\u1ea5t hi\u1ec7n trong $s$ c\u0169ng nh\u01b0 trong $t$. H\u00e3y t\u00ednh h\u00e0m ti\u1ec1n t\u1ed1 cho chu\u1ed7i n\u00e0y. B\u00e2y gi\u1edd h\u00e3y ngh\u0129 v\u1ec1 \u00fd ngh\u0129a c\u1ee7a c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a h\u00e0m ti\u1ec1n t\u1ed1, ngo\u1ea1i tr\u1eeb $n + 1$ m\u1ee5c \u0111\u1ea7u ti\u00ean (thu\u1ed9c v\u1ec1 chu\u1ed7i $s$ v\u00e0 d\u1ea5u ph\u00e2n c\u00e1ch). Theo \u0111\u1ecbnh ngh\u0129a, gi\u00e1 tr\u1ecb $\\pi[i]$ hi\u1ec3n th\u1ecb \u0111\u1ed9 d\u00e0i d\u00e0i nh\u1ea5t c\u1ee7a m\u1ed9t chu\u1ed7i con k\u1ebft th\u00fac \u1edf v\u1ecb tr\u00ed $i$ tr\u00f9ng kh\u1edbp v\u1edbi ti\u1ec1n t\u1ed1. Nh\u01b0ng trong tr\u01b0\u1eddng h\u1ee3p c\u1ee7a ch\u00fang ta, \u0111i\u1ec1u n\u00e0y kh\u00f4ng h\u01a1n g\u00ec kh\u1ed1i l\u1edbn nh\u1ea5t tr\u00f9ng kh\u1edbp v\u1edbi $s$ v\u00e0 k\u1ebft th\u00fac t\u1ea1i v\u1ecb tr\u00ed $i$. \u0110\u1ed9 d\u00e0i n\u00e0y kh\u00f4ng th\u1ec3 l\u1edbn h\u01a1n $n$ do d\u1ea5u ph\u00e2n c\u00e1ch. Nh\u01b0ng n\u1ebfu \u0111\u1eb3ng th\u1ee9c $\\pi[i] = n$ \u0111\u1ea1t \u0111\u01b0\u1ee3c, th\u00ec \u0111i\u1ec1u \u0111\u00f3 c\u00f3 ngh\u0129a l\u00e0 chu\u1ed7i $s$ xu\u1ea5t hi\u1ec7n ho\u00e0n to\u00e0n t\u1ea1i v\u1ecb tr\u00ed n\u00e0y, t\u1ee9c l\u00e0 n\u00f3 k\u1ebft th\u00fac t\u1ea1i v\u1ecb tr\u00ed $i$. Ch\u1ec9 c\u1ea7n \u0111\u1eebng qu\u00ean r\u1eb1ng c\u00e1c v\u1ecb tr\u00ed \u0111\u01b0\u1ee3c l\u1eadp ch\u1ec9 m\u1ee5c trong chu\u1ed7i $s + \\# + t$.</p> <p>Do \u0111\u00f3, n\u1ebfu t\u1ea1i m\u1ed9t v\u1ecb tr\u00ed $i$ n\u00e0o \u0111\u00f3 ch\u00fang ta c\u00f3 $\\pi[i] = n$, th\u00ec t\u1ea1i v\u1ecb tr\u00ed $i - (n + 1) - n + 1 = i - 2n$ trong chu\u1ed7i $t$, chu\u1ed7i $s$ xu\u1ea5t hi\u1ec7n.</p> <p>Nh\u01b0 \u0111\u00e3 \u0111\u1ec1 c\u1eadp trong m\u00f4 t\u1ea3 t\u00ednh to\u00e1n h\u00e0m ti\u1ec1n t\u1ed1, n\u1ebfu ch\u00fang ta bi\u1ebft r\u1eb1ng c\u00e1c gi\u00e1 tr\u1ecb ti\u1ec1n t\u1ed1 kh\u00f4ng bao gi\u1edd v\u01b0\u1ee3t qu\u00e1 m\u1ed9t gi\u00e1 tr\u1ecb nh\u1ea5t \u0111\u1ecbnh, th\u00ec ch\u00fang ta kh\u00f4ng c\u1ea7n l\u01b0u tr\u1eef to\u00e0n b\u1ed9 chu\u1ed7i v\u00e0 to\u00e0n b\u1ed9 h\u00e0m, m\u00e0 ch\u1ec9 c\u1ea7n ph\u1ea7n \u0111\u1ea7u c\u1ee7a n\u00f3. Trong tr\u01b0\u1eddng h\u1ee3p c\u1ee7a ch\u00fang ta, \u0111i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 ch\u00fang ta ch\u1ec9 c\u1ea7n l\u01b0u tr\u1eef chu\u1ed7i $s + \\#$ v\u00e0 c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a h\u00e0m ti\u1ec1n t\u1ed1 cho n\u00f3. Ch\u00fang ta c\u00f3 th\u1ec3 \u0111\u1ecdc t\u1eebng k\u00fd t\u1ef1 m\u1ed9t c\u1ee7a chu\u1ed7i $t$ v\u00e0 t\u00ednh to\u00e1n gi\u00e1 tr\u1ecb hi\u1ec7n t\u1ea1i c\u1ee7a h\u00e0m ti\u1ec1n t\u1ed1.</p> <p>Do \u0111\u00f3, thu\u1eadt to\u00e1n Knuth-Morris-Pratt gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 trong th\u1eddi gian $O(n + m)$ v\u00e0 b\u1ed9 nh\u1edb $O(n)$.</p>","tags":["Translated"]},{"location":"string/prefix-function.html#counting-the-number-of-occurrences-of-each-prefix","title":"\u0110\u1ebfm s\u1ed1 l\u1ea7n xu\u1ea5t hi\u1ec7n c\u1ee7a m\u1ed7i ti\u1ec1n t\u1ed1 (Counting the number of occurrences of each prefix)","text":"<p>\u1ede \u0111\u00e2y ch\u00fang ta th\u1ea3o lu\u1eadn v\u1ec1 hai v\u1ea5n \u0111\u1ec1 c\u00f9ng m\u1ed9t l\u00fac. Cho m\u1ed9t chu\u1ed7i $s$ c\u00f3 \u0111\u1ed9 d\u00e0i $n$. Trong bi\u1ebfn th\u1ec3 \u0111\u1ea7u ti\u00ean c\u1ee7a b\u00e0i to\u00e1n, ch\u00fang ta mu\u1ed1n \u0111\u1ebfm s\u1ed1 l\u1ea7n xu\u1ea5t hi\u1ec7n c\u1ee7a m\u1ed7i ti\u1ec1n t\u1ed1 $s[0 \\dots i]$ trong c\u00f9ng m\u1ed9t chu\u1ed7i. Trong bi\u1ebfn th\u1ec3 th\u1ee9 hai c\u1ee7a b\u00e0i to\u00e1n, m\u1ed9t chu\u1ed7i $t$ kh\u00e1c \u0111\u01b0\u1ee3c \u0111\u01b0a ra v\u00e0 ch\u00fang ta mu\u1ed1n \u0111\u1ebfm s\u1ed1 l\u1ea7n xu\u1ea5t hi\u1ec7n c\u1ee7a m\u1ed7i ti\u1ec1n t\u1ed1 $s[0 \\dots i]$ trong $t$.</p> <p>\u0110\u1ea7u ti\u00ean ch\u00fang ta gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 \u0111\u1ea7u ti\u00ean. Xem x\u00e9t gi\u00e1 tr\u1ecb c\u1ee7a h\u00e0m ti\u1ec1n t\u1ed1 $\\pi[i]$ t\u1ea1i m\u1ed9t v\u1ecb tr\u00ed $i$. Theo \u0111\u1ecbnh ngh\u0129a, \u0111i\u1ec1u \u0111\u00f3 c\u00f3 ngh\u0129a l\u00e0 ti\u1ec1n t\u1ed1 c\u00f3 \u0111\u1ed9 d\u00e0i $\\pi[i]$ c\u1ee7a chu\u1ed7i $s$ xu\u1ea5t hi\u1ec7n v\u00e0 k\u1ebft th\u00fac t\u1ea1i v\u1ecb tr\u00ed $i$, v\u00e0 kh\u00f4ng c\u00f3 ti\u1ec1n t\u1ed1 d\u00e0i h\u01a1n n\u00e0o tu\u00e2n theo \u0111\u1ecbnh ngh\u0129a n\u00e0y. \u0110\u1ed3ng th\u1eddi c\u00e1c ti\u1ec1n t\u1ed1 ng\u1eafn h\u01a1n c\u00f3 th\u1ec3 k\u1ebft th\u00fac t\u1ea1i v\u1ecb tr\u00ed n\u00e0y. Kh\u00f4ng kh\u00f3 \u0111\u1ec3 th\u1ea5y r\u1eb1ng, ch\u00fang ta c\u00f3 c\u00f9ng m\u1ed9t c\u00e2u h\u1ecfi m\u00e0 ch\u00fang ta \u0111\u00e3 tr\u1ea3 l\u1eddi khi ch\u00fang ta t\u00ednh to\u00e1n ch\u00ednh h\u00e0m ti\u1ec1n t\u1ed1: Cho m\u1ed9t ti\u1ec1n t\u1ed1 c\u00f3 \u0111\u1ed9 d\u00e0i $j$ l\u00e0 m\u1ed9t h\u1eadu t\u1ed1 k\u1ebft th\u00fac t\u1ea1i v\u1ecb tr\u00ed $i$, ti\u1ec1n t\u1ed1 nh\u1ecf h\u01a1n ti\u1ebfp theo $\\lt j$ c\u0169ng l\u00e0 m\u1ed9t h\u1eadu t\u1ed1 k\u1ebft th\u00fac t\u1ea1i v\u1ecb tr\u00ed $i$ l\u00e0 g\u00ec. Do \u0111\u00f3 t\u1ea1i v\u1ecb tr\u00ed $i$ k\u1ebft th\u00fac ti\u1ec1n t\u1ed1 c\u00f3 \u0111\u1ed9 d\u00e0i $\\pi[i]$, ti\u1ec1n t\u1ed1 c\u00f3 \u0111\u1ed9 d\u00e0i $\\pi[\\pi[i] - 1]$, ti\u1ec1n t\u1ed1 $\\pi[\\pi[\\pi[i] - 1] - 1]$, v\u00e0 c\u1ee9 th\u1ebf ti\u1ebfp t\u1ee5c, cho \u0111\u1ebfn khi ch\u1ec9 s\u1ed1 tr\u1edf th\u00e0nh kh\u00f4ng. Do \u0111\u00f3 ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh to\u00e1n c\u00e2u tr\u1ea3 l\u1eddi theo c\u00e1ch sau.</p> <pre><code>vector&lt;int&gt; ans(n + 1);\nfor (int i = 0; i &lt; n; i++)\n    ans[pi[i]]++;\nfor (int i = n-1; i &gt; 0; i--)\n    ans[pi[i-1]] += ans[i];\nfor (int i = 0; i &lt;= n; i++)\n    ans[i]++;\n</code></pre> <p>\u1ede \u0111\u00e2y \u0111\u1ed1i v\u1edbi m\u1ed7i gi\u00e1 tr\u1ecb c\u1ee7a h\u00e0m ti\u1ec1n t\u1ed1, tr\u01b0\u1edbc ti\u00ean ch\u00fang ta \u0111\u1ebfm xem n\u00f3 xu\u1ea5t hi\u1ec7n bao nhi\u00eau l\u1ea7n trong m\u1ea3ng $\\pi$, v\u00e0 sau \u0111\u00f3 t\u00ednh to\u00e1n c\u00e1c c\u00e2u tr\u1ea3 l\u1eddi cu\u1ed1i c\u00f9ng: n\u1ebfu ch\u00fang ta bi\u1ebft r\u1eb1ng ti\u1ec1n t\u1ed1 \u0111\u1ed9 d\u00e0i $i$ xu\u1ea5t hi\u1ec7n ch\u00ednh x\u00e1c $\\text{ans}[i]$ l\u1ea7n, th\u00ec s\u1ed1 n\u00e0y ph\u1ea3i \u0111\u01b0\u1ee3c c\u1ed9ng v\u00e0o s\u1ed1 l\u1ea7n xu\u1ea5t hi\u1ec7n c\u1ee7a h\u1eadu t\u1ed1 d\u00e0i nh\u1ea5t c\u1ee7a n\u00f3 c\u0169ng l\u00e0 m\u1ed9t ti\u1ec1n t\u1ed1. Cu\u1ed1i c\u00f9ng ch\u00fang ta c\u1ea7n c\u1ed9ng $1$ v\u00e0o m\u1ed7i k\u1ebft qu\u1ea3, v\u00ec ch\u00fang ta c\u0169ng c\u1ea7n \u0111\u1ebfm c\u00e1c ti\u1ec1n t\u1ed1 ban \u0111\u1ea7u.</p> <p>B\u00e2y gi\u1edd h\u00e3y xem x\u00e9t v\u1ea5n \u0111\u1ec1 th\u1ee9 hai. Ch\u00fang ta \u00e1p d\u1ee5ng th\u1ee7 thu\u1eadt t\u1eeb Knuth-Morris-Pratt: ch\u00fang ta t\u1ea1o chu\u1ed7i $s + \\# + t$ v\u00e0 t\u00ednh to\u00e1n h\u00e0m ti\u1ec1n t\u1ed1 c\u1ee7a n\u00f3. S\u1ef1 kh\u00e1c bi\u1ec7t duy nh\u1ea5t so v\u1edbi nhi\u1ec7m v\u1ee5 \u0111\u1ea7u ti\u00ean l\u00e0, ch\u00fang ta ch\u1ec9 quan t\u00e2m \u0111\u1ebfn c\u00e1c gi\u00e1 tr\u1ecb ti\u1ec1n t\u1ed1 li\u00ean quan \u0111\u1ebfn chu\u1ed7i $t$, t\u1ee9c l\u00e0 $\\pi[i]$ cho $i \\ge n + 1$. V\u1edbi c\u00e1c gi\u00e1 tr\u1ecb \u0111\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n c\u00e1c t\u00ednh to\u00e1n ch\u00ednh x\u00e1c nh\u01b0 trong nhi\u1ec7m v\u1ee5 \u0111\u1ea7u ti\u00ean.</p>","tags":["Translated"]},{"location":"string/prefix-function.html#the-number-of-different-substring-in-a-string","title":"S\u1ed1 l\u01b0\u1ee3ng chu\u1ed7i con kh\u00e1c nhau trong m\u1ed9t chu\u1ed7i (The number of different substring in a string)","text":"<p>Cho m\u1ed9t chu\u1ed7i $s$ c\u00f3 \u0111\u1ed9 d\u00e0i $n$. Ch\u00fang ta mu\u1ed1n t\u00ednh to\u00e1n s\u1ed1 l\u01b0\u1ee3ng chu\u1ed7i con kh\u00e1c nhau xu\u1ea5t hi\u1ec7n trong n\u00f3.</p> <p>Ch\u00fang ta s\u1ebd gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 n\u00e0y m\u1ed9t c\u00e1ch l\u1eb7p \u0111i l\u1eb7p l\u1ea1i. C\u1ee5 th\u1ec3 l\u00e0 ch\u00fang ta s\u1ebd t\u00ecm hi\u1ec3u, khi bi\u1ebft s\u1ed1 l\u01b0\u1ee3ng chu\u1ed7i con kh\u00e1c nhau hi\u1ec7n t\u1ea1i, l\u00e0m th\u1ebf n\u00e0o \u0111\u1ec3 t\u00ednh to\u00e1n l\u1ea1i s\u1ed1 l\u01b0\u1ee3ng n\u00e0y b\u1eb1ng c\u00e1ch th\u00eam m\u1ed9t k\u00fd t\u1ef1 v\u00e0o cu\u1ed1i.</p> <p>V\u00ec v\u1eady, h\u00e3y \u0111\u1ec3 $k$ l\u00e0 s\u1ed1 l\u01b0\u1ee3ng chu\u1ed7i con kh\u00e1c nhau hi\u1ec7n t\u1ea1i trong $s$, v\u00e0 ch\u00fang ta th\u00eam k\u00fd t\u1ef1 $c$ v\u00e0o cu\u1ed1i $s$. R\u00f5 r\u00e0ng m\u1ed9t s\u1ed1 chu\u1ed7i con m\u1edbi k\u1ebft th\u00fac b\u1eb1ng $c$ s\u1ebd xu\u1ea5t hi\u1ec7n. Ch\u00fang ta mu\u1ed1n \u0111\u1ebfm c\u00e1c chu\u1ed7i con m\u1edbi n\u00e0y ch\u01b0a xu\u1ea5t hi\u1ec7n tr\u01b0\u1edbc \u0111\u00f3.</p> <p>Ch\u00fang ta l\u1ea5y chu\u1ed7i $t = s + c$ v\u00e0 \u0111\u1ea3o ng\u01b0\u1ee3c n\u00f3. B\u00e2y gi\u1edd nhi\u1ec7m v\u1ee5 \u0111\u01b0\u1ee3c chuy\u1ec3n \u0111\u1ed5i th\u00e0nh vi\u1ec7c t\u00ednh to\u00e1n c\u00f3 bao nhi\u00eau ti\u1ec1n t\u1ed1 kh\u00f4ng xu\u1ea5t hi\u1ec7n \u1edf b\u1ea5t k\u1ef3 n\u01a1i n\u00e0o kh\u00e1c. N\u1ebfu ch\u00fang ta t\u00ednh to\u00e1n gi\u00e1 tr\u1ecb c\u1ef1c \u0111\u1ea1i c\u1ee7a h\u00e0m ti\u1ec1n t\u1ed1 $\\pi_{\\text{max}}$ c\u1ee7a chu\u1ed7i \u0111\u1ea3o ng\u01b0\u1ee3c $t$, th\u00ec ti\u1ec1n t\u1ed1 d\u00e0i nh\u1ea5t xu\u1ea5t hi\u1ec7n trong $s$ d\u00e0i $\\pi_{\\text{max}}$. R\u00f5 r\u00e0ng t\u1ea5t c\u1ea3 c\u00e1c ti\u1ec1n t\u1ed1 c\u00f3 \u0111\u1ed9 d\u00e0i nh\u1ecf h\u01a1n c\u0169ng xu\u1ea5t hi\u1ec7n trong \u0111\u00f3.</p> <p>Do \u0111\u00f3 s\u1ed1 l\u01b0\u1ee3ng chu\u1ed7i con m\u1edbi xu\u1ea5t hi\u1ec7n khi ch\u00fang ta th\u00eam m\u1ed9t k\u00fd t\u1ef1 m\u1edbi $c$ l\u00e0 $|s| + 1 - \\pi_{\\text{max}}$.</p> <p>V\u00ec v\u1eady, \u0111\u1ed1i v\u1edbi m\u1ed7i k\u00fd t\u1ef1 \u0111\u01b0\u1ee3c th\u00eam v\u00e0o, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh to\u00e1n s\u1ed1 l\u01b0\u1ee3ng chu\u1ed7i con m\u1edbi trong th\u1eddi gian $O(n)$, \u0111i\u1ec1u n\u00e0y cho \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian t\u1ed5ng c\u1ed9ng l\u00e0 $O(n^2)$.</p> <p>\u0110i\u1ec1u \u0111\u00e1ng ch\u00fa \u00fd l\u00e0, ch\u00fang ta c\u0169ng c\u00f3 th\u1ec3 t\u00ednh to\u00e1n s\u1ed1 l\u01b0\u1ee3ng chu\u1ed7i con kh\u00e1c nhau b\u1eb1ng c\u00e1ch th\u00eam c\u00e1c k\u00fd t\u1ef1 v\u00e0o \u0111\u1ea7u, ho\u1eb7c b\u1eb1ng c\u00e1ch x\u00f3a c\u00e1c k\u00fd t\u1ef1 t\u1eeb \u0111\u1ea7u ho\u1eb7c cu\u1ed1i.</p>","tags":["Translated"]},{"location":"string/prefix-function.html#compressing-a-string","title":"N\u00e9n m\u1ed9t chu\u1ed7i (Compressing a string)","text":"<p>Cho m\u1ed9t chu\u1ed7i $s$ c\u00f3 \u0111\u1ed9 d\u00e0i $n$. Ch\u00fang ta mu\u1ed1n t\u00ecm bi\u1ec3u di\u1ec5n \"n\u00e9n\" ng\u1eafn nh\u1ea5t c\u1ee7a chu\u1ed7i, t\u1ee9c l\u00e0 ch\u00fang ta mu\u1ed1n t\u00ecm m\u1ed9t chu\u1ed7i $t$ c\u00f3 \u0111\u1ed9 d\u00e0i nh\u1ecf nh\u1ea5t sao cho $s$ c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n d\u01b0\u1edbi d\u1ea1ng n\u1ed1i c\u1ee7a m\u1ed9t ho\u1eb7c nhi\u1ec1u b\u1ea3n sao c\u1ee7a $t$.</p> <p>R\u00f5 r\u00e0ng l\u00e0 ch\u00fang ta ch\u1ec9 c\u1ea7n t\u00ecm \u0111\u1ed9 d\u00e0i c\u1ee7a $t$. Bi\u1ebft \u0111\u1ed9 d\u00e0i, c\u00e2u tr\u1ea3 l\u1eddi cho v\u1ea5n \u0111\u1ec1 s\u1ebd l\u00e0 ti\u1ec1n t\u1ed1 c\u1ee7a $s$ v\u1edbi \u0111\u1ed9 d\u00e0i n\u00e0y.</p> <p>H\u00e3y t\u00ednh to\u00e1n h\u00e0m ti\u1ec1n t\u1ed1 cho $s$. S\u1eed d\u1ee5ng gi\u00e1 tr\u1ecb cu\u1ed1i c\u00f9ng c\u1ee7a n\u00f3, ch\u00fang ta x\u00e1c \u0111\u1ecbnh gi\u00e1 tr\u1ecb $k = n - \\pi[n - 1]$. Ch\u00fang ta s\u1ebd ch\u1ec9 ra r\u1eb1ng, n\u1ebfu $k$ chia h\u1ebft cho $n$, th\u00ec $k$ s\u1ebd l\u00e0 c\u00e2u tr\u1ea3 l\u1eddi, ng\u01b0\u1ee3c l\u1ea1i kh\u00f4ng c\u00f3 n\u00e9n hi\u1ec7u qu\u1ea3 n\u00e0o v\u00e0 c\u00e2u tr\u1ea3 l\u1eddi l\u00e0 $n$.</p> <p>Gi\u1ea3 s\u1eed $n$ chia h\u1ebft cho $k$. Khi \u0111\u00f3 chu\u1ed7i c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c ph\u00e2n chia th\u00e0nh c\u00e1c kh\u1ed1i c\u00f3 \u0111\u1ed9 d\u00e0i $k$. Theo \u0111\u1ecbnh ngh\u0129a c\u1ee7a h\u00e0m ti\u1ec1n t\u1ed1, ti\u1ec1n t\u1ed1 c\u00f3 \u0111\u1ed9 d\u00e0i $n - k$ s\u1ebd b\u1eb1ng v\u1edbi h\u1eadu t\u1ed1 c\u1ee7a n\u00f3. Nh\u01b0ng \u0111i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 kh\u1ed1i cu\u1ed1i c\u00f9ng b\u1eb1ng v\u1edbi kh\u1ed1i tr\u01b0\u1edbc \u0111\u00f3. V\u00e0 kh\u1ed1i tr\u01b0\u1edbc \u0111\u00f3 ph\u1ea3i b\u1eb1ng kh\u1ed1i tr\u01b0\u1edbc n\u00f3. V\u00e0 c\u1ee9 th\u1ebf ti\u1ebfp t\u1ee5c. K\u1ebft qu\u1ea3 l\u00e0, h\u00f3a ra t\u1ea5t c\u1ea3 c\u00e1c kh\u1ed1i \u0111\u1ec1u b\u1eb1ng nhau, do \u0111\u00f3 ch\u00fang ta c\u00f3 th\u1ec3 n\u00e9n chu\u1ed7i $s$ th\u00e0nh \u0111\u1ed9 d\u00e0i $k$.</p> <p>T\u1ea5t nhi\u00ean ch\u00fang ta v\u1eabn c\u1ea7n ch\u1ec9 ra r\u1eb1ng \u0111\u00e2y th\u1ef1c s\u1ef1 l\u00e0 m\u1ee9c t\u1ed1i \u01b0u. Th\u1eadt v\u1eady, n\u1ebfu c\u00f3 m\u1ed9t n\u00e9n nh\u1ecf h\u01a1n $k$, th\u00ec h\u00e0m ti\u1ec1n t\u1ed1 \u1edf cu\u1ed1i s\u1ebd l\u1edbn h\u01a1n $n - k$. Do \u0111\u00f3 $k$ th\u1ef1c s\u1ef1 l\u00e0 c\u00e2u tr\u1ea3 l\u1eddi.</p> <p>B\u00e2y gi\u1edd ch\u00fang ta h\u00e3y gi\u1ea3 s\u1eed r\u1eb1ng $n$ kh\u00f4ng chia h\u1ebft cho $k$. Ch\u00fang ta ch\u1ec9 ra r\u1eb1ng \u0111i\u1ec1u n\u00e0y ng\u1ee5 \u00fd r\u1eb1ng \u0111\u1ed9 d\u00e0i c\u1ee7a c\u00e2u tr\u1ea3 l\u1eddi l\u00e0 $n$. Ch\u00fang ta ch\u1ee9ng minh n\u00f3 b\u1eb1ng m\u00e2u thu\u1eabn. Gi\u1ea3 s\u1eed t\u1ed3n t\u1ea1i m\u1ed9t c\u00e2u tr\u1ea3 l\u1eddi, v\u00e0 n\u00e9n c\u00f3 \u0111\u1ed9 d\u00e0i $p$ ($p$ chia h\u1ebft cho $n$). Th\u00ec gi\u00e1 tr\u1ecb cu\u1ed1i c\u00f9ng c\u1ee7a h\u00e0m ti\u1ec1n t\u1ed1 ph\u1ea3i l\u1edbn h\u01a1n $n - p$, t\u1ee9c l\u00e0 h\u1eadu t\u1ed1 s\u1ebd bao ph\u1ee7 m\u1ed9t ph\u1ea7n kh\u1ed1i \u0111\u1ea7u ti\u00ean. B\u00e2y gi\u1edd h\u00e3y xem x\u00e9t kh\u1ed1i th\u1ee9 hai c\u1ee7a chu\u1ed7i. V\u00ec ti\u1ec1n t\u1ed1 b\u1eb1ng v\u1edbi h\u1eadu t\u1ed1, v\u00e0 c\u1ea3 ti\u1ec1n t\u1ed1 v\u00e0 h\u1eadu t\u1ed1 \u0111\u1ec1u bao ph\u1ee7 kh\u1ed1i n\u00e0y v\u00e0 s\u1ef1 d\u1ecbch chuy\u1ec3n c\u1ee7a ch\u00fang so v\u1edbi nhau $k$ kh\u00f4ng chia h\u1ebft cho \u0111\u1ed9 d\u00e0i kh\u1ed1i $p$ (ng\u01b0\u1ee3c l\u1ea1i $k$ chia h\u1ebft cho $n$), n\u00ean t\u1ea5t c\u1ea3 c\u00e1c k\u00fd t\u1ef1 c\u1ee7a kh\u1ed1i ph\u1ea3i gi\u1ed1ng h\u1ec7t nhau. Nh\u01b0ng sau \u0111\u00f3 chu\u1ed7i ch\u1ec9 bao g\u1ed3m m\u1ed9t k\u00fd t\u1ef1 l\u1eb7p \u0111i l\u1eb7p l\u1ea1i, do \u0111\u00f3 ch\u00fang ta c\u00f3 th\u1ec3 n\u00e9n n\u00f3 th\u00e0nh m\u1ed9t chu\u1ed7i c\u00f3 k\u00edch th\u01b0\u1edbc $1$, \u0111i\u1ec1u n\u00e0y cho $k = 1$, v\u00e0 $k$ chia h\u1ebft cho $n$. M\u00e2u thu\u1eabn.</p> $$\\overbrace{s_0 ~ s_1 ~ s_2 ~ s_3}^p ~ \\overbrace{s_4 ~ s_5 ~ s_6 ~ s_7}^p$$ $$s_0 ~ s_1 ~ s_2 ~ \\underbrace{\\overbrace{s_3 ~ s_4 ~ s_5 ~ s_6}^p ~ s_7}_{\\pi[7] = 5}$$ $$s_4 = s_3, ~ s_5 = s_4, ~ s_6 = s_5, ~ s_7 = s_6 ~ \\Rightarrow ~ s_0 = s_1 = s_2 = s_3$$","tags":["Translated"]},{"location":"string/prefix-function.html#building-an-automaton-according-to-the-prefix-function","title":"X\u00e2y d\u1ef1ng m\u1ed9t automaton theo h\u00e0m ti\u1ec1n t\u1ed1 (Building an automaton according to the prefix function)","text":"<p>H\u00e3y quay l\u1ea1i vi\u1ec7c n\u1ed1i hai chu\u1ed7i th\u00f4ng qua m\u1ed9t d\u1ea5u ph\u00e2n c\u00e1ch, t\u1ee9c l\u00e0 \u0111\u1ed1i v\u1edbi c\u00e1c chu\u1ed7i $s$ v\u00e0 $t$, ch\u00fang ta t\u00ednh to\u00e1n h\u00e0m ti\u1ec1n t\u1ed1 cho chu\u1ed7i $s + \\# + t$. R\u00f5 r\u00e0ng, v\u00ec $\\#$ l\u00e0 d\u1ea5u ph\u00e2n c\u00e1ch, gi\u00e1 tr\u1ecb c\u1ee7a h\u00e0m ti\u1ec1n t\u1ed1 s\u1ebd kh\u00f4ng bao gi\u1edd v\u01b0\u1ee3t qu\u00e1 $|s|$. Suy ra r\u1eb1ng, ch\u1ec9 c\u1ea7n l\u01b0u tr\u1eef chu\u1ed7i $s + \\#$ v\u00e0 c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a h\u00e0m ti\u1ec1n t\u1ed1 cho n\u00f3 l\u00e0 \u0111\u1ee7, v\u00e0 ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh to\u00e1n h\u00e0m ti\u1ec1n t\u1ed1 cho t\u1ea5t c\u1ea3 c\u00e1c k\u00fd t\u1ef1 ti\u1ebfp theo m\u1ed9t c\u00e1ch nhanh ch\u00f3ng:</p> $$\\underbrace{s_0 ~ s_1 ~ \\dots ~ s_{n-1} ~ \\#}_{\\text{c\u1ea7n l\u01b0u tr\u1eef}} ~ \\underbrace{t_0 ~ t_1 ~ \\dots ~ t_{m-1}}_{\\text{kh\u00f4ng c\u1ea7n l\u01b0u tr\u1eef}}$$ <p>Th\u1eadt v\u1eady, trong t\u00ecnh hu\u1ed1ng nh\u01b0 v\u1eady, bi\u1ebft k\u00fd t\u1ef1 ti\u1ebfp theo $c \\in t$ v\u00e0 gi\u00e1 tr\u1ecb c\u1ee7a h\u00e0m ti\u1ec1n t\u1ed1 \u1edf v\u1ecb tr\u00ed tr\u01b0\u1edbc \u0111\u00f3 l\u00e0 \u0111\u1ee7 th\u00f4ng tin \u0111\u1ec3 t\u00ednh to\u00e1n gi\u00e1 tr\u1ecb ti\u1ebfp theo c\u1ee7a h\u00e0m ti\u1ec1n t\u1ed1, m\u00e0 kh\u00f4ng c\u1ea7n s\u1eed d\u1ee5ng b\u1ea5t k\u1ef3 k\u00fd t\u1ef1 n\u00e0o tr\u01b0\u1edbc \u0111\u00f3 c\u1ee7a chu\u1ed7i $t$ v\u00e0 gi\u00e1 tr\u1ecb c\u1ee7a h\u00e0m ti\u1ec1n t\u1ed1 trong ch\u00fang.</p> <p>N\u00f3i c\u00e1ch kh\u00e1c, ch\u00fang ta c\u00f3 th\u1ec3 x\u00e2y d\u1ef1ng m\u1ed9t automaton (m\u1ed9t m\u00e1y tr\u1ea1ng th\u00e1i h\u1eefu h\u1ea1n): tr\u1ea1ng th\u00e1i trong \u0111\u00f3 l\u00e0 gi\u00e1 tr\u1ecb hi\u1ec7n t\u1ea1i c\u1ee7a h\u00e0m ti\u1ec1n t\u1ed1, v\u00e0 qu\u00e1 tr\u00ecnh chuy\u1ec3n \u0111\u1ed5i t\u1eeb tr\u1ea1ng th\u00e1i n\u00e0y sang tr\u1ea1ng th\u00e1i kh\u00e1c s\u1ebd \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n th\u00f4ng qua k\u00fd t\u1ef1 ti\u1ebfp theo.</p> <p>Do \u0111\u00f3, ngay c\u1ea3 khi kh\u00f4ng c\u00f3 chu\u1ed7i $t$, ch\u00fang ta c\u00f3 th\u1ec3 x\u00e2y d\u1ef1ng m\u1ed9t b\u1ea3ng chuy\u1ec3n \u0111\u1ed5i nh\u01b0 v\u1eady $(\\text{old}_\\pi, c) \\rightarrow \\text{new}_\\pi$ b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng c\u00f9ng thu\u1eadt to\u00e1n nh\u01b0 \u0111\u1ec3 t\u00ednh to\u00e1n b\u1ea3ng chuy\u1ec3n \u0111\u1ed5i:</p> <pre><code>void compute_automaton(string s, vector&lt;vector&lt;int&gt;&gt;&amp; aut) {\n    s += '#';\n    int n = s.size();\n    vector&lt;int&gt; pi = prefix_function(s);\n    aut.assign(n, vector&lt;int&gt;(26));\n    for (int i = 0; i &lt; n; i++) {\n        for (int c = 0; c &lt; 26; c++) {\n            int j = i;\n            while (j &gt; 0 &amp;&amp; 'a' + c != s[j])\n                j = pi[j-1];\n            if ('a' + c == s[j])\n                j++;\n            aut[i][c] = j;\n        }\n    }\n}\n</code></pre> <p>Tuy nhi\u00ean, \u1edf d\u1ea1ng n\u00e0y, thu\u1eadt to\u00e1n ch\u1ea1y trong th\u1eddi gian $O(n^2 26)$ cho c\u00e1c ch\u1eef c\u00e1i vi\u1ebft th\u01b0\u1eddng c\u1ee7a b\u1ea3ng ch\u1eef c\u00e1i. L\u01b0u \u00fd r\u1eb1ng ch\u00fang ta c\u00f3 th\u1ec3 \u00e1p d\u1ee5ng quy ho\u1ea1ch \u0111\u1ed9ng v\u00e0 s\u1eed d\u1ee5ng c\u00e1c ph\u1ea7n \u0111\u00e3 \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n c\u1ee7a b\u1ea3ng. B\u1ea5t c\u1ee9 khi n\u00e0o ch\u00fang ta \u0111i t\u1eeb gi\u00e1 tr\u1ecb $j$ \u0111\u1ebfn gi\u00e1 tr\u1ecb $\\pi[j-1]$, ch\u00fang ta th\u1ef1c s\u1ef1 c\u00f3 ngh\u0129a l\u00e0 qu\u00e1 tr\u00ecnh chuy\u1ec3n \u0111\u1ed5i $(j, c)$ d\u1eabn \u0111\u1ebfn c\u00f9ng m\u1ed9t tr\u1ea1ng th\u00e1i v\u1edbi qu\u00e1 tr\u00ecnh chuy\u1ec3n \u0111\u1ed5i nh\u01b0 $(\\pi[j-1], c)$, v\u00e0 c\u00e2u tr\u1ea3 l\u1eddi n\u00e0y \u0111\u00e3 \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n ch\u00ednh x\u00e1c.</p> <pre><code>void compute_automaton(string s, vector&lt;vector&lt;int&gt;&gt;&amp; aut) {\n    s += '#';\n    int n = s.size();\n    vector&lt;int&gt; pi = prefix_function(s);\n    aut.assign(n, vector&lt;int&gt;(26));\n    for (int i = 0; i &lt; n; i++) {\n        for (int c = 0; c &lt; 26; c++) {\n            if (i &gt; 0 &amp;&amp; 'a' + c != s[i])\n                aut[i][c] = aut[pi[i-1]][c];\n            else\n                aut[i][c] = i + ('a' + c == s[i]);\n        }\n    }\n}\n</code></pre> <p>K\u1ebft qu\u1ea3 l\u00e0 ch\u00fang ta x\u00e2y d\u1ef1ng automaton trong th\u1eddi gian $O(26 n)$.</p> <p>Khi n\u00e0o th\u00ec m\u1ed9t automaton nh\u01b0 v\u1eady h\u1eefu \u00edch? \u0110\u1ec3 b\u1eaft \u0111\u1ea7u, h\u00e3y nh\u1edb r\u1eb1ng ch\u00fang ta s\u1eed d\u1ee5ng h\u00e0m ti\u1ec1n t\u1ed1 cho chu\u1ed7i $s + \\# + t$ v\u00e0 c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a n\u00f3 ch\u1ee7 y\u1ebfu cho m\u1ed9t m\u1ee5c \u0111\u00edch duy nh\u1ea5t: t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c l\u1ea7n xu\u1ea5t hi\u1ec7n c\u1ee7a chu\u1ed7i $s$ trong chu\u1ed7i $t$.</p> <p>Do \u0111\u00f3 l\u1ee3i \u00edch r\u00f5 r\u00e0ng nh\u1ea5t c\u1ee7a automaton n\u00e0y l\u00e0 t\u0103ng t\u1ed1c t\u00ednh to\u00e1n h\u00e0m ti\u1ec1n t\u1ed1 cho chu\u1ed7i $s + \\# + t$. B\u1eb1ng c\u00e1ch x\u00e2y d\u1ef1ng automaton cho $s + \\#$, ch\u00fang ta kh\u00f4ng c\u00f2n c\u1ea7n l\u01b0u tr\u1eef chu\u1ed7i $s$ ho\u1eb7c c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a h\u00e0m ti\u1ec1n t\u1ed1 trong \u0111\u00f3. T\u1ea5t c\u1ea3 c\u00e1c chuy\u1ec3n \u0111\u1ed5i \u0111\u00e3 \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n trong b\u1ea3ng.</p> <p>Nh\u01b0ng c\u00f3 m\u1ed9t \u1ee9ng d\u1ee5ng th\u1ee9 hai, \u00edt r\u00f5 r\u00e0ng h\u01a1n. Ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng automaton khi chu\u1ed7i $t$ l\u00e0 m\u1ed9t chu\u1ed7i kh\u1ed5ng l\u1ed3 \u0111\u01b0\u1ee3c x\u00e2y d\u1ef1ng b\u1eb1ng m\u1ed9t s\u1ed1 quy t\u1eafc. V\u00ed d\u1ee5, \u0111\u00e2y c\u00f3 th\u1ec3 l\u00e0 c\u00e1c chu\u1ed7i Gray, ho\u1eb7c m\u1ed9t chu\u1ed7i \u0111\u01b0\u1ee3c h\u00ecnh th\u00e0nh b\u1edfi s\u1ef1 k\u1ebft h\u1ee3p \u0111\u1ec7 quy c\u1ee7a m\u1ed9t s\u1ed1 chu\u1ed7i ng\u1eafn t\u1eeb \u0111\u1ea7u v\u00e0o.</p> <p>\u0110\u1ec3 ho\u00e0n thi\u1ec7n, ch\u00fang ta s\u1ebd gi\u1ea3i quy\u1ebft m\u1ed9t v\u1ea5n \u0111\u1ec1 nh\u01b0 v\u1eady: cho m\u1ed9t s\u1ed1 $k \\le 10^5$ v\u00e0 m\u1ed9t chu\u1ed7i $s$ c\u00f3 \u0111\u1ed9 d\u00e0i $\\le 10^5$. Ch\u00fang ta ph\u1ea3i t\u00ednh to\u00e1n s\u1ed1 l\u1ea7n xu\u1ea5t hi\u1ec7n c\u1ee7a $s$ trong chu\u1ed7i Gray th\u1ee9 $k$. Nh\u1edb l\u1ea1i r\u1eb1ng c\u00e1c chu\u1ed7i Gray \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a theo c\u00e1ch sau:</p> $$\\begin{align} g_1 &amp;= \\text{\"a\"}\\\\ g_2 &amp;= \\text{\"aba\"}\\\\ g_3 &amp;= \\text{\"abacaba\"}\\\\ g_4 &amp;= \\text{\"abacabadabacaba\"} \\end{align}$$ <p>Trong nh\u1eefng tr\u01b0\u1eddng h\u1ee3p nh\u01b0 v\u1eady, ngay c\u1ea3 vi\u1ec7c x\u00e2y d\u1ef1ng chu\u1ed7i $t$ c\u0169ng s\u1ebd l\u00e0 kh\u00f4ng th\u1ec3, v\u00ec \u0111\u1ed9 d\u00e0i thi\u00ean v\u0103n c\u1ee7a n\u00f3. Chu\u1ed7i Gray th\u1ee9 $k$ d\u00e0i $2^k-1$ k\u00fd t\u1ef1. Tuy nhi\u00ean, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh to\u00e1n gi\u00e1 tr\u1ecb c\u1ee7a h\u00e0m ti\u1ec1n t\u1ed1 \u1edf cu\u1ed1i chu\u1ed7i m\u1ed9t c\u00e1ch hi\u1ec7u qu\u1ea3, b\u1eb1ng c\u00e1ch ch\u1ec9 bi\u1ebft gi\u00e1 tr\u1ecb c\u1ee7a h\u00e0m ti\u1ec1n t\u1ed1 \u1edf \u0111\u1ea7u.</p> <p>Ngo\u00e0i b\u1ea3n th\u00e2n automaton, ch\u00fang ta c\u0169ng t\u00ednh to\u00e1n c\u00e1c gi\u00e1 tr\u1ecb $G[i][j]$ - gi\u00e1 tr\u1ecb c\u1ee7a automaton sau khi x\u1eed l\u00fd chu\u1ed7i $g_i$ b\u1eaft \u0111\u1ea7u v\u1edbi tr\u1ea1ng th\u00e1i $j$. V\u00e0 th\u00eam v\u00e0o \u0111\u00f3 ch\u00fang ta t\u00ednh to\u00e1n c\u00e1c gi\u00e1 tr\u1ecb $K[i][j]$ - s\u1ed1 l\u1ea7n xu\u1ea5t hi\u1ec7n c\u1ee7a $s$ trong $g_i$, tr\u01b0\u1edbc khi trong qu\u00e1 tr\u00ecnh x\u1eed l\u00fd $g_i$ b\u1eaft \u0111\u1ea7u v\u1edbi tr\u1ea1ng th\u00e1i $j$. Th\u1ef1c ra $K[i][j]$ l\u00e0 s\u1ed1 l\u1ea7n h\u00e0m ti\u1ec1n t\u1ed1 nh\u1eadn gi\u00e1 tr\u1ecb $|s|$ trong khi th\u1ef1c hi\u1ec7n c\u00e1c thao t\u00e1c. C\u00e2u tr\u1ea3 l\u1eddi cho v\u1ea5n \u0111\u1ec1 sau \u0111\u00f3 s\u1ebd l\u00e0 $K[k][0]$.</p> <p>L\u00e0m th\u1ebf n\u00e0o ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh to\u00e1n c\u00e1c gi\u00e1 tr\u1ecb n\u00e0y? \u0110\u1ea7u ti\u00ean c\u00e1c gi\u00e1 tr\u1ecb c\u01a1 b\u1ea3n l\u00e0 $G[0][j] = j$ v\u00e0 $K[0][j] = 0$. V\u00e0 t\u1ea5t c\u1ea3 c\u00e1c gi\u00e1 tr\u1ecb ti\u1ebfp theo c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n t\u1eeb c\u00e1c gi\u00e1 tr\u1ecb tr\u01b0\u1edbc \u0111\u00f3 v\u00e0 s\u1eed d\u1ee5ng automaton. \u0110\u1ec3 t\u00ednh to\u00e1n gi\u00e1 tr\u1ecb cho m\u1ed9t s\u1ed1 $i$, ch\u00fang ta nh\u1edb r\u1eb1ng chu\u1ed7i $g_i$ bao g\u1ed3m $g_{i-1}$, k\u00fd t\u1ef1 th\u1ee9 $i$ c\u1ee7a b\u1ea3ng ch\u1eef c\u00e1i, v\u00e0 $g_{i-1}$. Do \u0111\u00f3 automaton s\u1ebd \u0111i v\u00e0o tr\u1ea1ng th\u00e1i:</p> $$\\text{mid} = \\text{aut}[G[i-1][j]][i]$$ $$G[i][j] = G[i-1][\\text{mid}]$$ <p>C\u00e1c gi\u00e1 tr\u1ecb cho $K[i][j]$ c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c \u0111\u1ebfm m\u1ed9t c\u00e1ch d\u1ec5 d\u00e0ng.</p> $$K[i][j] = K[i-1][j] + (\\text{mid} == |s|) + K[i-1][\\text{mid}]$$ <p>V\u00ec v\u1eady, ch\u00fang ta c\u00f3 th\u1ec3 gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 cho c\u00e1c chu\u1ed7i Gray, v\u00e0 t\u01b0\u01a1ng t\u1ef1 nh\u01b0 v\u1eady c\u0169ng c\u00f3 m\u1ed9t s\u1ed1 l\u01b0\u1ee3ng l\u1edbn c\u00e1c v\u1ea5n \u0111\u1ec1 t\u01b0\u01a1ng t\u1ef1 kh\u00e1c. V\u00ed d\u1ee5, c\u00f9ng m\u1ed9t ph\u01b0\u01a1ng ph\u00e1p ch\u00ednh x\u00e1c c\u0169ng gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 sau: ch\u00fang ta \u0111\u01b0\u1ee3c cho m\u1ed9t chu\u1ed7i $s$ v\u00e0 m\u1ed9t s\u1ed1 m\u1eabu $t_i$, m\u1ed7i m\u1eabu \u0111\u01b0\u1ee3c ch\u1ec9 \u0111\u1ecbnh nh\u01b0 sau: n\u00f3 l\u00e0 m\u1ed9t chu\u1ed7i c\u00e1c k\u00fd t\u1ef1 th\u00f4ng th\u01b0\u1eddng, v\u00e0 c\u00f3 th\u1ec3 c\u00f3 m\u1ed9t s\u1ed1 l\u1ea7n ch\u00e8n \u0111\u1ec7 quy c\u1ee7a c\u00e1c chu\u1ed7i tr\u01b0\u1edbc \u0111\u00f3 c\u00f3 d\u1ea1ng $t_k^{\\text{cnt}}$, \u0111i\u1ec1u \u0111\u00f3 c\u00f3 ngh\u0129a l\u00e0 t\u1ea1i n\u01a1i n\u00e0y ch\u00fang ta ph\u1ea3i ch\u00e8n chu\u1ed7i $t_k$ $\\text{cnt}$ l\u1ea7n. M\u1ed9t v\u00ed d\u1ee5 v\u1ec1 c\u00e1c m\u1eabu nh\u01b0 v\u1eady:</p> $$\\begin{align} t_1 &amp;= \\text{\"abdeca\"}\\\\ t_2 &amp;= \\text{\"abc\"} + t_1^{30} + \\text{\"abd\"}\\\\ t_3 &amp;= t_2^{50} + t_1^{100}\\\\ t_4 &amp;= t_2^{10} + t_3^{100} \\end{align}$$ <p>C\u00e1c ph\u00e9p thay th\u1ebf \u0111\u1ec7 quy th\u1ed5i ph\u1ed3ng chu\u1ed7i l\u00ean, sao cho \u0111\u1ed9 d\u00e0i c\u1ee7a ch\u00fang c\u00f3 th\u1ec3 \u0111\u1ea1t t\u1edbi b\u1eadc $100^{100}$.</p> <p>Ch\u00fang ta ph\u1ea3i t\u00ecm s\u1ed1 l\u1ea7n chu\u1ed7i $s$ xu\u1ea5t hi\u1ec7n trong m\u1ed7i chu\u1ed7i.</p> <p>V\u1ea5n \u0111\u1ec1 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i quy\u1ebft theo c\u00f9ng m\u1ed9t c\u00e1ch b\u1eb1ng c\u00e1ch x\u00e2y d\u1ef1ng automaton c\u1ee7a h\u00e0m ti\u1ec1n t\u1ed1, v\u00e0 sau \u0111\u00f3 ch\u00fang ta t\u00ednh to\u00e1n c\u00e1c chuy\u1ec3n \u0111\u1ed5i trong cho m\u1ed7i m\u1eabu b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng c\u00e1c k\u1ebft qu\u1ea3 tr\u01b0\u1edbc \u0111\u00f3.</p>","tags":["Translated"]},{"location":"string/prefix-function.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>UVA # 455 \"Periodic Strings\"</li> <li>UVA # 11022 \"String Factoring\"</li> <li>UVA # 11452 \"Dancing the Cheeky-Cheeky\"</li> <li>UVA 12604 - Caesar Cipher</li> <li>UVA 12467 - Secret Word</li> <li>UVA 11019 - Matrix Matcher</li> <li>SPOJ - Pattern Find</li> <li>SPOJ - A Needle in the Haystack</li> <li>Codeforces - Anthem of Berland</li> <li>Codeforces - MUH and Cube Walls</li> <li>Codeforces - Prefixes and Suffixes</li> </ul>","tags":["Translated"]},{"location":"string/rabin-karp.html","title":"Thu\u1eadt to\u00e1n Rabin-Karp cho vi\u1ec7c so kh\u1edbp chu\u1ed7i (Rabin-Karp Algorithm for string matching)","text":"<p>Thu\u1eadt to\u00e1n n\u00e0y d\u1ef1a tr\u00ean kh\u00e1i ni\u1ec7m b\u0103m, v\u00ec v\u1eady n\u1ebfu b\u1ea1n kh\u00f4ng quen thu\u1ed9c v\u1edbi b\u0103m chu\u1ed7i, h\u00e3y tham kh\u1ea3o b\u00e0i vi\u1ebft b\u0103m chu\u1ed7i.</p> <p>Thu\u1eadt to\u00e1n n\u00e0y \u0111\u01b0\u1ee3c t\u00e1c gi\u1ea3 b\u1edfi Rabin v\u00e0 Karp v\u00e0o n\u0103m 1987.</p> <p>B\u00e0i to\u00e1n: Cho hai chu\u1ed7i - m\u1ed9t m\u1eabu $s$ v\u00e0 m\u1ed9t v\u0103n b\u1ea3n $t$, x\u00e1c \u0111\u1ecbnh xem m\u1eabu c\u00f3 xu\u1ea5t hi\u1ec7n trong v\u0103n b\u1ea3n hay kh\u00f4ng v\u00e0 n\u1ebfu c\u00f3, li\u1ec7t k\u00ea t\u1ea5t c\u1ea3 c\u00e1c l\u1ea7n xu\u1ea5t hi\u1ec7n c\u1ee7a n\u00f3 trong th\u1eddi gian $O(|s| + |t|)$.</p> <p>Thu\u1eadt to\u00e1n: T\u00ednh to\u00e1n b\u0103m cho m\u1eabu $s$. T\u00ednh to\u00e1n c\u00e1c gi\u00e1 tr\u1ecb b\u0103m cho t\u1ea5t c\u1ea3 c\u00e1c ti\u1ec1n t\u1ed1 c\u1ee7a v\u0103n b\u1ea3n $t$. B\u00e2y gi\u1edd, ch\u00fang ta c\u00f3 th\u1ec3 so s\u00e1nh m\u1ed9t chu\u1ed7i con c\u00f3 \u0111\u1ed9 d\u00e0i $|s|$ v\u1edbi $s$ trong th\u1eddi gian h\u1eb1ng s\u1ed1 b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng c\u00e1c gi\u00e1 tr\u1ecb b\u0103m \u0111\u00e3 t\u00ednh to\u00e1n. V\u00ec v\u1eady, h\u00e3y so s\u00e1nh t\u1eebng chu\u1ed7i con c\u00f3 \u0111\u1ed9 d\u00e0i $|s|$ v\u1edbi m\u1eabu. \u0110i\u1ec1u n\u00e0y s\u1ebd m\u1ea5t t\u1ed5ng th\u1eddi gian l\u00e0 $O(|t|)$. Do \u0111\u00f3, \u0111\u1ed9 ph\u1ee9c t\u1ea1p cu\u1ed1i c\u00f9ng c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 $O(|t| + |s|)$: $O(|s|)$ \u0111\u01b0\u1ee3c y\u00eau c\u1ea7u \u0111\u1ec3 t\u00ednh to\u00e1n b\u0103m c\u1ee7a m\u1eabu v\u00e0 $O(|t|)$ \u0111\u1ec3 so s\u00e1nh m\u1ed7i chu\u1ed7i con c\u00f3 \u0111\u1ed9 d\u00e0i $|s|$ v\u1edbi m\u1eabu.</p>","tags":["Translated"]},{"location":"string/rabin-karp.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<pre><code>vector&lt;int&gt; rabin_karp(string const&amp; s, string const&amp; t) {\n    const int p = 31; \n    const int m = 1e9 + 9;\n    int S = s.size(), T = t.size();\n\n    vector&lt;long long&gt; p_pow(max(S, T)); \n    p_pow[0] = 1; \n    for (int i = 1; i &lt; (int)p_pow.size(); i++) \n        p_pow[i] = (p_pow[i-1] * p) % m;\n\n    vector&lt;long long&gt; h(T + 1, 0); \n    for (int i = 0; i &lt; T; i++)\n        h[i+1] = (h[i] + (t[i] - 'a' + 1) * p_pow[i]) % m; \n    long long h_s = 0; \n    for (int i = 0; i &lt; S; i++) \n        h_s = (h_s + (s[i] - 'a' + 1) * p_pow[i]) % m; \n\n    vector&lt;int&gt; occurrences;\n    for (int i = 0; i + S - 1 &lt; T; i++) {\n        long long cur_h = (h[i+S] + m - h[i]) % m;\n        if (cur_h == h_s * p_pow[i] % m)\n            occurrences.push_back(i);\n    }\n    return occurrences;\n}\n</code></pre>","tags":["Translated"]},{"location":"string/rabin-karp.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>SPOJ - Pattern Find</li> <li>Codeforces - Good Substrings</li> <li>Codeforces - Palindromic characteristics</li> <li>Leetcode - Longest Duplicate Substring</li> </ul>","tags":["Translated"]},{"location":"string/string-hashing.html","title":"B\u0103m chu\u1ed7i (String Hashing)","text":"<p>C\u00e1c thu\u1eadt to\u00e1n b\u0103m r\u1ea5t h\u1eefu \u00edch trong vi\u1ec7c gi\u1ea3i quy\u1ebft nhi\u1ec1u b\u00e0i to\u00e1n.</p> <p>Ch\u00fang ta mu\u1ed1n gi\u1ea3i quy\u1ebft b\u00e0i to\u00e1n so s\u00e1nh c\u00e1c chu\u1ed7i m\u1ed9t c\u00e1ch hi\u1ec7u qu\u1ea3. C\u00e1ch v\u00e9t c\u1ea1n (brute force) \u0111\u1ec3 l\u00e0m nh\u01b0 v\u1eady ch\u1ec9 l\u00e0 so s\u00e1nh c\u00e1c ch\u1eef c\u00e1i c\u1ee7a c\u1ea3 hai chu\u1ed7i, c\u00f3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian l\u00e0 $O(\\min(n_1, n_2))$ n\u1ebfu $n_1$ v\u00e0 $n_2$ l\u00e0 k\u00edch th\u01b0\u1edbc c\u1ee7a hai chu\u1ed7i. Ch\u00fang ta mu\u1ed1n l\u00e0m t\u1ed1t h\u01a1n. \u00dd t\u01b0\u1edfng \u0111\u1eb1ng sau vi\u1ec7c b\u0103m chu\u1ed7i l\u00e0 nh\u01b0 sau: ch\u00fang ta \u00e1nh x\u1ea1 m\u1ed7i chu\u1ed7i th\u00e0nh m\u1ed9t s\u1ed1 nguy\u00ean v\u00e0 so s\u00e1nh c\u00e1c s\u1ed1 \u0111\u00f3 thay v\u00ec so s\u00e1nh c\u00e1c chu\u1ed7i. L\u00e0m \u0111i\u1ec1u n\u00e0y cho ph\u00e9p ch\u00fang ta gi\u1ea3m th\u1eddi gian th\u1ef1c hi\u1ec7n so s\u00e1nh chu\u1ed7i xu\u1ed1ng c\u00f2n $O(1)$.</p> <p>\u0110\u1ec3 chuy\u1ec3n \u0111\u1ed5i, ch\u00fang ta c\u1ea7n m\u1ed9t h\u00e0m b\u0103m (hash function) \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 nh\u01b0 v\u1eady. M\u1ee5c ti\u00eau c\u1ee7a n\u00f3 l\u00e0 chuy\u1ec3n \u0111\u1ed5i m\u1ed9t chu\u1ed7i th\u00e0nh m\u1ed9t s\u1ed1 nguy\u00ean, \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 gi\u00e1 tr\u1ecb b\u0103m (hash) c\u1ee7a chu\u1ed7i. \u0110i\u1ec1u ki\u1ec7n sau ph\u1ea3i \u0111\u01b0\u1ee3c th\u1ecfa m\u00e3n: n\u1ebfu hai chu\u1ed7i $s$ v\u00e0 $t$ b\u1eb1ng nhau ($s = t$), th\u00ec c\u00e1c gi\u00e1 tr\u1ecb b\u0103m c\u1ee7a ch\u00fang c\u0169ng ph\u1ea3i b\u1eb1ng nhau ($\\text{hash}(s) = \\text{hash}(t)$). N\u1ebfu kh\u00f4ng, ch\u00fang ta s\u1ebd kh\u00f4ng th\u1ec3 so s\u00e1nh c\u00e1c chu\u1ed7i.</p> <p>L\u01b0u \u00fd, chi\u1ec1u ng\u01b0\u1ee3c l\u1ea1i kh\u00f4ng nh\u1ea5t thi\u1ebft ph\u1ea3i \u0111\u00fang. N\u1ebfu c\u00e1c gi\u00e1 tr\u1ecb b\u0103m b\u1eb1ng nhau ($\\text{hash}(s) = \\text{hash}(t)$), th\u00ec c\u00e1c chu\u1ed7i kh\u00f4ng nh\u1ea5t thi\u1ebft ph\u1ea3i b\u1eb1ng nhau. V\u00ed d\u1ee5: m\u1ed9t h\u00e0m b\u0103m h\u1ee3p l\u1ec7 \u0111\u01a1n gi\u1ea3n l\u00e0 $\\text{hash}(s) = 0$ cho m\u1ed7i $s$. B\u00e2y gi\u1edd, \u0111\u00e2y ch\u1ec9 l\u00e0 m\u1ed9t v\u00ed d\u1ee5 ngu ng\u1ed1c, b\u1edfi v\u00ec h\u00e0m n\u00e0y s\u1ebd ho\u00e0n to\u00e0n v\u00f4 d\u1ee5ng, nh\u01b0ng n\u00f3 l\u00e0 m\u1ed9t h\u00e0m b\u0103m h\u1ee3p l\u1ec7. L\u00fd do t\u1ea1i sao chi\u1ec1u ng\u01b0\u1ee3c l\u1ea1i kh\u00f4ng nh\u1ea5t thi\u1ebft ph\u1ea3i gi\u1eef, l\u00e0 v\u00ec c\u00f3 r\u1ea5t nhi\u1ec1u chu\u1ed7i theo c\u1ea5p s\u1ed1 nh\u00e2n. N\u1ebfu ch\u00fang ta ch\u1ec9 mu\u1ed1n h\u00e0m b\u0103m n\u00e0y ph\u00e2n bi\u1ec7t gi\u1eefa t\u1ea5t c\u1ea3 c\u00e1c chu\u1ed7i bao g\u1ed3m c\u00e1c k\u00fd t\u1ef1 ch\u1eef th\u01b0\u1eddng c\u00f3 \u0111\u1ed9 d\u00e0i nh\u1ecf h\u01a1n 15, th\u00ec gi\u00e1 tr\u1ecb b\u0103m \u0111\u00e3 kh\u00f4ng c\u00f2n v\u1eeba v\u1edbi m\u1ed9t s\u1ed1 nguy\u00ean 64-bit (v\u00ed d\u1ee5: unsigned long long) n\u1eefa, v\u00ec c\u00f3 qu\u00e1 nhi\u1ec1u chu\u1ed7i nh\u01b0 v\u1eady. V\u00e0 t\u1ea5t nhi\u00ean, ch\u00fang ta kh\u00f4ng mu\u1ed1n so s\u00e1nh c\u00e1c s\u1ed1 nguy\u00ean d\u00e0i t\u00f9y \u00fd, v\u00ec \u0111i\u1ec1u n\u00e0y c\u0169ng s\u1ebd c\u00f3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p $O(n)$.</p> <p>V\u00ec v\u1eady, th\u00f4ng th\u01b0\u1eddng ch\u00fang ta mu\u1ed1n h\u00e0m b\u0103m \u00e1nh x\u1ea1 c\u00e1c chu\u1ed7i v\u00e0o c\u00e1c s\u1ed1 trong m\u1ed9t ph\u1ea1m vi c\u1ed1 \u0111\u1ecbnh $[0, m)$, sau \u0111\u00f3 so s\u00e1nh c\u00e1c chu\u1ed7i ch\u1ec9 l\u00e0 so s\u00e1nh hai s\u1ed1 nguy\u00ean c\u00f3 \u0111\u1ed9 d\u00e0i c\u1ed1 \u0111\u1ecbnh. V\u00e0 t\u1ea5t nhi\u00ean, ch\u00fang ta mu\u1ed1n $\\text{hash}(s) \\neq \\text{hash}(t)$ r\u1ea5t c\u00f3 kh\u1ea3 n\u0103ng x\u1ea3y ra n\u1ebfu $s \\neq t$.</p> <p>\u0110\u00f3 l\u00e0 ph\u1ea7n quan tr\u1ecdng m\u00e0 b\u1ea1n ph\u1ea3i ghi nh\u1edb. S\u1eed d\u1ee5ng b\u0103m s\u1ebd kh\u00f4ng ch\u00ednh x\u00e1c 100% m\u1ed9t c\u00e1ch t\u1ea5t \u0111\u1ecbnh, b\u1edfi v\u00ec hai chu\u1ed7i ho\u00e0n to\u00e0n kh\u00e1c nhau c\u00f3 th\u1ec3 c\u00f3 c\u00f9ng m\u1ed9t gi\u00e1 tr\u1ecb b\u0103m (c\u00e1c gi\u00e1 tr\u1ecb b\u0103m b\u1ecb va ch\u1ea1m). Tuy nhi\u00ean, trong \u0111a s\u1ed1 c\u00e1c t\u00e1c v\u1ee5, \u0111i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c b\u1ecf qua m\u1ed9t c\u00e1ch an to\u00e0n v\u00ec x\u00e1c su\u1ea5t c\u00e1c gi\u00e1 tr\u1ecb b\u0103m c\u1ee7a hai chu\u1ed7i kh\u00e1c nhau va ch\u1ea1m v\u1eabn c\u00f2n r\u1ea5t nh\u1ecf. V\u00e0 ch\u00fang ta s\u1ebd th\u1ea3o lu\u1eadn v\u1ec1 m\u1ed9t s\u1ed1 k\u1ef9 thu\u1eadt trong b\u00e0i vi\u1ebft n\u00e0y v\u1ec1 c\u00e1ch gi\u1eef cho x\u00e1c su\u1ea5t va ch\u1ea1m r\u1ea5t th\u1ea5p.</p>","tags":["Translated"]},{"location":"string/string-hashing.html#calculation-of-the-hash-of-a-string","title":"T\u00ednh to\u00e1n gi\u00e1 tr\u1ecb b\u0103m c\u1ee7a m\u1ed9t chu\u1ed7i (Calculation of the hash of a string)","text":"<p>C\u00e1ch t\u1ed1t v\u00e0 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng r\u1ed9ng r\u00e3i \u0111\u1ec3 x\u00e1c \u0111\u1ecbnh gi\u00e1 tr\u1ecb b\u0103m c\u1ee7a chu\u1ed7i $s$ c\u00f3 \u0111\u1ed9 d\u00e0i $n$ l\u00e0</p> $$\\begin{align} \\text{hash}(s) &amp;= s[0] + s[1] \\cdot p + s[2] \\cdot p^2 + ... + s[n-1] \\cdot p^{n-1} \\mod m \\\\ &amp;= \\sum_{i=0}^{n-1} s[i] \\cdot p^i \\mod m, \\end{align}$$ <p>trong \u0111\u00f3 $p$ v\u00e0 $m$ l\u00e0 m\u1ed9t s\u1ed1 s\u1ed1 d\u01b0\u01a1ng \u0111\u01b0\u1ee3c ch\u1ecdn. N\u00f3 \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 h\u00e0m b\u0103m \u0111a th\u1ee9c l\u0103n (polynomial rolling hash function).</p> <p>Th\u1eadt h\u1ee3p l\u00fd khi \u0111\u1eb7t $p$ l\u00e0 m\u1ed9t s\u1ed1 nguy\u00ean t\u1ed1 g\u1ea7n b\u1eb1ng s\u1ed1 l\u01b0\u1ee3ng k\u00fd t\u1ef1 trong b\u1ea3ng ch\u1eef c\u00e1i \u0111\u1ea7u v\u00e0o. V\u00ed d\u1ee5: n\u1ebfu \u0111\u1ea7u v\u00e0o ch\u1ec9 bao g\u1ed3m c\u00e1c ch\u1eef c\u00e1i vi\u1ebft th\u01b0\u1eddng c\u1ee7a b\u1ea3ng ch\u1eef c\u00e1i ti\u1ebfng Anh, $p = 31$ l\u00e0 m\u1ed9t l\u1ef1a ch\u1ecdn t\u1ed1t. N\u1ebfu \u0111\u1ea7u v\u00e0o c\u00f3 th\u1ec3 ch\u1ee9a c\u1ea3 ch\u1eef c\u00e1i vi\u1ebft hoa v\u00e0 vi\u1ebft th\u01b0\u1eddng, th\u00ec $p = 53$ l\u00e0 m\u1ed9t l\u1ef1a ch\u1ecdn kh\u1ea3 thi. M\u00e3 trong b\u00e0i vi\u1ebft n\u00e0y s\u1ebd s\u1eed d\u1ee5ng $p = 31$.</p> <p>R\u00f5 r\u00e0ng $m$ ph\u1ea3i l\u00e0 m\u1ed9t s\u1ed1 l\u1edbn v\u00ec x\u00e1c su\u1ea5t hai chu\u1ed7i ng\u1eabu nhi\u00ean va ch\u1ea1m l\u00e0 kho\u1ea3ng $\\approx \\frac{1}{m}$. \u0110\u00f4i khi $m = 2^{64}$ \u0111\u01b0\u1ee3c ch\u1ecdn, v\u00ec khi \u0111\u00f3 tr\u00e0n s\u1ed1 nguy\u00ean c\u1ee7a c\u00e1c s\u1ed1 nguy\u00ean 64-bit ho\u1ea1t \u0111\u1ed9ng gi\u1ed1ng h\u1ec7t nh\u01b0 ph\u00e9p to\u00e1n modulo. Tuy nhi\u00ean, t\u1ed3n t\u1ea1i m\u1ed9t ph\u01b0\u01a1ng ph\u00e1p t\u1ea1o ra c\u00e1c chu\u1ed7i va ch\u1ea1m (ho\u1ea1t \u0111\u1ed9ng \u0111\u1ed9c l\u1eadp v\u1edbi vi\u1ec7c ch\u1ecdn $p$). V\u00ec v\u1eady, trong th\u1ef1c t\u1ebf, $m = 2^{64}$ kh\u00f4ng \u0111\u01b0\u1ee3c khuy\u1ebfn kh\u00edch. M\u1ed9t l\u1ef1a ch\u1ecdn t\u1ed1t cho $m$ l\u00e0 m\u1ed9t s\u1ed1 nguy\u00ean t\u1ed1 l\u1edbn n\u00e0o \u0111\u00f3. M\u00e3 trong b\u00e0i vi\u1ebft n\u00e0y s\u1ebd ch\u1ec9 s\u1eed d\u1ee5ng $m = 10^9+9$. \u0110\u00e2y l\u00e0 m\u1ed9t s\u1ed1 l\u1edbn, nh\u01b0ng v\u1eabn \u0111\u1ee7 nh\u1ecf \u0111\u1ec3 ch\u00fang ta c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n ph\u00e9p nh\u00e2n hai gi\u00e1 tr\u1ecb b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng c\u00e1c s\u1ed1 nguy\u00ean 64-bit.</p> <p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u1ed9t v\u00ed d\u1ee5 v\u1ec1 vi\u1ec7c t\u00ednh to\u00e1n gi\u00e1 tr\u1ecb b\u0103m c\u1ee7a chu\u1ed7i $s$, ch\u1ec9 ch\u1ee9a c\u00e1c ch\u1eef c\u00e1i vi\u1ebft th\u01b0\u1eddng. Ch\u00fang ta chuy\u1ec3n \u0111\u1ed5i m\u1ed7i k\u00fd t\u1ef1 c\u1ee7a $s$ th\u00e0nh m\u1ed9t s\u1ed1 nguy\u00ean. \u1ede \u0111\u00e2y ch\u00fang ta s\u1eed d\u1ee5ng chuy\u1ec3n \u0111\u1ed5i $a \\rightarrow 1$, $b \\rightarrow 2$, $\\dots$, $z \\rightarrow 26$. Chuy\u1ec3n \u0111\u1ed5i $a \\rightarrow 0$ kh\u00f4ng ph\u1ea3i l\u00e0 m\u1ed9t \u00fd t\u01b0\u1edfng hay, b\u1edfi v\u00ec khi \u0111\u00f3 c\u00e1c gi\u00e1 tr\u1ecb b\u0103m c\u1ee7a c\u00e1c chu\u1ed7i $a$, $aa$, $aaa$, $\\dots$ \u0111\u1ec1u \u0111\u00e1nh gi\u00e1 th\u00e0nh $0$.</p> <pre><code>long long compute_hash(string const&amp; s) {\n    const int p = 31;\n    const int m = 1e9 + 9;\n    long long hash_value = 0;\n    long long p_pow = 1;\n    for (char c : s) {\n        hash_value = (hash_value + (c - 'a' + 1) * p_pow) % m;\n        p_pow = (p_pow * p) % m;\n    }\n    return hash_value;\n}\n</code></pre> <p>T\u00ednh to\u00e1n tr\u01b0\u1edbc c\u00e1c l\u0169y th\u1eeba c\u1ee7a $p$ c\u00f3 th\u1ec3 gi\u00fap t\u0103ng hi\u1ec7u su\u1ea5t.</p>","tags":["Translated"]},{"location":"string/string-hashing.html#example-tasks","title":"C\u00e1c b\u00e0i to\u00e1n v\u00ed d\u1ee5 (Example tasks)","text":"","tags":["Translated"]},{"location":"string/string-hashing.html#search-for-duplicate-strings-in-an-array-of-strings","title":"T\u00ecm ki\u1ebfm c\u00e1c chu\u1ed7i tr\u00f9ng l\u1eb7p trong m\u1ed9t m\u1ea3ng chu\u1ed7i (Search for duplicate strings in an array of strings)","text":"<p>B\u00e0i to\u00e1n: Cho m\u1ed9t danh s\u00e1ch g\u1ed3m $n$ chu\u1ed7i $s_i$, m\u1ed7i chu\u1ed7i kh\u00f4ng d\u00e0i qu\u00e1 $m$ k\u00fd t\u1ef1, h\u00e3y t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c chu\u1ed7i tr\u00f9ng l\u1eb7p v\u00e0 chia ch\u00fang th\u00e0nh c\u00e1c nh\u00f3m.</p> <p>T\u1eeb thu\u1eadt to\u00e1n hi\u1ec3n nhi\u00ean li\u00ean quan \u0111\u1ebfn vi\u1ec7c s\u1eafp x\u1ebfp c\u00e1c chu\u1ed7i, ch\u00fang ta s\u1ebd nh\u1eadn \u0111\u01b0\u1ee3c \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian l\u00e0 $O(n m \\log n)$ trong \u0111\u00f3 vi\u1ec7c s\u1eafp x\u1ebfp y\u00eau c\u1ea7u $O(n \\log n)$ ph\u00e9p so s\u00e1nh v\u00e0 m\u1ed7i ph\u00e9p so s\u00e1nh m\u1ea5t th\u1eddi gian $O(m)$. Tuy nhi\u00ean, b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng b\u0103m, ch\u00fang ta gi\u1ea3m th\u1eddi gian so s\u00e1nh xu\u1ed1ng $O(1)$, cho ch\u00fang ta m\u1ed9t thu\u1eadt to\u00e1n ch\u1ea1y trong th\u1eddi gian $O(n m + n \\log n)$.</p> <p>Ch\u00fang ta t\u00ednh to\u00e1n b\u0103m cho m\u1ed7i chu\u1ed7i, s\u1eafp x\u1ebfp c\u00e1c gi\u00e1 tr\u1ecb b\u0103m c\u00f9ng v\u1edbi c\u00e1c ch\u1ec9 s\u1ed1, v\u00e0 sau \u0111\u00f3 nh\u00f3m c\u00e1c ch\u1ec9 s\u1ed1 theo c\u00e1c gi\u00e1 tr\u1ecb b\u0103m gi\u1ed1ng h\u1ec7t nhau.</p> <pre><code>vector&lt;vector&lt;int&gt;&gt; group_identical_strings(vector&lt;string&gt; const&amp; s) {\n    int n = s.size();\n    vector&lt;pair&lt;long long, int&gt;&gt; hashes(n);\n    for (int i = 0; i &lt; n; i++)\n        hashes[i] = {compute_hash(s[i]), i};\n\n    sort(hashes.begin(), hashes.end());\n\n    vector&lt;vector&lt;int&gt;&gt; groups;\n    for (int i = 0; i &lt; n; i++) {\n        if (i == 0 || hashes[i].first != hashes[i-1].first)\n            groups.emplace_back();\n        groups.back().push_back(hashes[i].second);\n    }\n    return groups;\n}\n</code></pre>","tags":["Translated"]},{"location":"string/string-hashing.html#fast-hash-calculation-of-substrings-of-given-string","title":"T\u00ednh to\u00e1n b\u0103m nhanh c\u00e1c chu\u1ed7i con c\u1ee7a chu\u1ed7i \u0111\u00e3 cho (Fast hash calculation of substrings of given string)","text":"<p>B\u00e0i to\u00e1n: Cho m\u1ed9t chu\u1ed7i $s$ v\u00e0 c\u00e1c ch\u1ec9 s\u1ed1 $i$ v\u00e0 $j$, t\u00ecm gi\u00e1 tr\u1ecb b\u0103m c\u1ee7a chu\u1ed7i con $s [i \\dots j]$.</p> <p>Theo \u0111\u1ecbnh ngh\u0129a, ch\u00fang ta c\u00f3:</p> $$\\text{hash}(s[i \\dots j]) = \\sum_{k = i}^j s[k] \\cdot p^{k-i} \\mod m$$ <p>Nh\u00e2n v\u1edbi $p^i$ cho:</p> $$\\begin{align} \\text{hash}(s[i \\dots j]) \\cdot p^i &amp;= \\sum_{k = i}^j s[k] \\cdot p^k \\mod m \\\\ &amp;= \\text{hash}(s[0 \\dots j]) - \\text{hash}(s[0 \\dots i-1]) \\mod m \\end{align}$$ <p>V\u00ec v\u1eady, b\u1eb1ng c\u00e1ch bi\u1ebft gi\u00e1 tr\u1ecb b\u0103m c\u1ee7a m\u1ed7i ti\u1ec1n t\u1ed1 c\u1ee7a chu\u1ed7i $s$, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh to\u00e1n b\u0103m c\u1ee7a b\u1ea5t k\u1ef3 chu\u1ed7i con n\u00e0o tr\u1ef1c ti\u1ebfp b\u1eb1ng c\u00f4ng th\u1ee9c n\u00e0y. V\u1ea5n \u0111\u1ec1 duy nh\u1ea5t m\u00e0 ch\u00fang ta g\u1eb7p ph\u1ea3i khi t\u00ednh to\u00e1n n\u00f3 l\u00e0 ch\u00fang ta ph\u1ea3i c\u00f3 th\u1ec3 chia $\\text{hash}(s[0 \\dots j]) - \\text{hash}(s[0 \\dots i-1])$ cho $p^i$. Do \u0111\u00f3, ch\u00fang ta c\u1ea7n t\u00ecm ngh\u1ecbch \u0111\u1ea3o modulo c\u1ee7a $p^i$ v\u00e0 sau \u0111\u00f3 th\u1ef1c hi\u1ec7n ph\u00e9p nh\u00e2n v\u1edbi ngh\u1ecbch \u0111\u1ea3o n\u00e0y. Ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh to\u00e1n tr\u01b0\u1edbc ngh\u1ecbch \u0111\u1ea3o c\u1ee7a m\u1ecdi $p^i$, cho ph\u00e9p t\u00ednh to\u00e1n b\u0103m c\u1ee7a b\u1ea5t k\u1ef3 chu\u1ed7i con n\u00e0o c\u1ee7a $s$ trong th\u1eddi gian $O(1)$.</p> <p>Tuy nhi\u00ean, t\u1ed3n t\u1ea1i m\u1ed9t c\u00e1ch d\u1ec5 d\u00e0ng h\u01a1n. Trong h\u1ea7u h\u1ebft c\u00e1c tr\u01b0\u1eddng h\u1ee3p, thay v\u00ec t\u00ednh to\u00e1n ch\u00ednh x\u00e1c c\u00e1c gi\u00e1 tr\u1ecb b\u0103m c\u1ee7a chu\u1ed7i con, ch\u1ec9 c\u1ea7n t\u00ednh to\u00e1n b\u0103m nh\u00e2n v\u1edbi m\u1ed9t l\u0169y th\u1eeba n\u00e0o \u0111\u00f3 c\u1ee7a $p$ l\u00e0 \u0111\u1ee7. Gi\u1ea3 s\u1eed ch\u00fang ta c\u00f3 hai gi\u00e1 tr\u1ecb b\u0103m c\u1ee7a hai chu\u1ed7i con, m\u1ed9t nh\u00e2n v\u1edbi $p^i$ v\u00e0 c\u00e1i kia nh\u00e2n v\u1edbi $p^j$. N\u1ebfu $i &lt; j$ th\u00ec ch\u00fang ta nh\u00e2n b\u0103m \u0111\u1ea7u ti\u00ean v\u1edbi $p^{j-i}$, ng\u01b0\u1ee3c l\u1ea1i, ch\u00fang ta nh\u00e2n b\u0103m th\u1ee9 hai v\u1edbi $p^{i-j}$. B\u1eb1ng c\u00e1ch l\u00e0m \u0111i\u1ec1u n\u00e0y, ch\u00fang ta nh\u1eadn \u0111\u01b0\u1ee3c c\u1ea3 hai gi\u00e1 tr\u1ecb b\u0103m nh\u00e2n v\u1edbi c\u00f9ng m\u1ed9t l\u0169y th\u1eeba c\u1ee7a $p$ (l\u00e0 l\u0169y th\u1eeba c\u1ef1c \u0111\u1ea1i c\u1ee7a $i$ v\u00e0 $j$) v\u00e0 b\u00e2y gi\u1edd c\u00e1c gi\u00e1 tr\u1ecb b\u0103m n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c so s\u00e1nh d\u1ec5 d\u00e0ng m\u00e0 kh\u00f4ng c\u1ea7n b\u1ea5t k\u1ef3 ph\u00e9p chia n\u00e0o.</p>","tags":["Translated"]},{"location":"string/string-hashing.html#applications-of-hashing","title":"\u1ee8ng d\u1ee5ng c\u1ee7a B\u0103m (Applications of Hashing)","text":"<p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u1ed9t s\u1ed1 \u1ee9ng d\u1ee5ng \u0111i\u1ec3n h\u00ecnh c\u1ee7a B\u0103m:</p> <ul> <li>Thu\u1eadt to\u00e1n Rabin-Karp \u0111\u1ec3 so kh\u1edbp m\u1eabu trong chu\u1ed7i trong th\u1eddi gian $O(n)$</li> <li>T\u00ednh s\u1ed1 l\u01b0\u1ee3ng c\u00e1c chu\u1ed7i con kh\u00e1c nhau c\u1ee7a m\u1ed9t chu\u1ed7i trong $O(n^2)$ (xem b\u00ean d\u01b0\u1edbi)</li> <li>T\u00ednh s\u1ed1 l\u01b0\u1ee3ng c\u00e1c chu\u1ed7i con \u0111\u1ed1i x\u1ee9ng (palindrome) trong m\u1ed9t chu\u1ed7i.</li> </ul>","tags":["Translated"]},{"location":"string/string-hashing.html#determine-the-number-of-different-substrings-in-a-string","title":"X\u00e1c \u0111\u1ecbnh s\u1ed1 l\u01b0\u1ee3ng chu\u1ed7i con kh\u00e1c nhau trong m\u1ed9t chu\u1ed7i (Determine the number of different substrings in a string)","text":"<p>B\u00e0i to\u00e1n: Cho m\u1ed9t chu\u1ed7i $s$ c\u00f3 \u0111\u1ed9 d\u00e0i $n$, ch\u1ec9 g\u1ed3m c\u00e1c ch\u1eef c\u00e1i ti\u1ebfng Anh th\u01b0\u1eddng, h\u00e3y t\u00ecm s\u1ed1 l\u01b0\u1ee3ng chu\u1ed7i con kh\u00e1c nhau trong chu\u1ed7i n\u00e0y.</p> <p>\u0110\u1ec3 gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 n\u00e0y, ch\u00fang ta l\u1eb7p qua t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ed9 d\u00e0i chu\u1ed7i con $l = 1 \\dots n$. \u0110\u1ed1i v\u1edbi m\u1ed7i \u0111\u1ed9 d\u00e0i chu\u1ed7i con $l$, ch\u00fang ta x\u00e2y d\u1ef1ng m\u1ed9t m\u1ea3ng c\u00e1c gi\u00e1 tr\u1ecb b\u0103m c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c chu\u1ed7i con c\u00f3 \u0111\u1ed9 d\u00e0i $l$ nh\u00e2n v\u1edbi c\u00f9ng m\u1ed9t l\u0169y th\u1eeba c\u1ee7a $p$. S\u1ed1 l\u01b0\u1ee3ng c\u00e1c ph\u1ea7n t\u1eed kh\u00e1c nhau trong m\u1ea3ng b\u1eb1ng s\u1ed1 l\u01b0\u1ee3ng c\u00e1c chu\u1ed7i con ri\u00eang bi\u1ec7t c\u00f3 \u0111\u1ed9 d\u00e0i $l$ trong chu\u1ed7i. S\u1ed1 n\u00e0y \u0111\u01b0\u1ee3c c\u1ed9ng v\u00e0o c\u00e2u tr\u1ea3 l\u1eddi cu\u1ed1i c\u00f9ng.</p> <p>\u0110\u1ec3 thu\u1eadn ti\u1ec7n, ch\u00fang ta s\u1ebd s\u1eed d\u1ee5ng $h[i]$ l\u00e0m gi\u00e1 tr\u1ecb b\u0103m c\u1ee7a ti\u1ec1n t\u1ed1 v\u1edbi $i$ k\u00fd t\u1ef1, v\u00e0 x\u00e1c \u0111\u1ecbnh $h[0] = 0$.</p> <pre><code>int count_unique_substrings(string const&amp; s) {\n    int n = s.size();\n\n    const int p = 31;\n    const int m = 1e9 + 9;\n    vector&lt;long long&gt; p_pow(n);\n    p_pow[0] = 1;\n    for (int i = 1; i &lt; n; i++)\n        p_pow[i] = (p_pow[i-1] * p) % m;\n\n    vector&lt;long long&gt; h(n + 1, 0);\n    for (int i = 0; i &lt; n; i++)\n        h[i+1] = (h[i] + (s[i] - 'a' + 1) * p_pow[i]) % m;\n\n    int cnt = 0;\n    for (int l = 1; l &lt;= n; l++) {\n        unordered_set&lt;long long&gt; hs;\n        for (int i = 0; i &lt;= n - l; i++) {\n            long long cur_h = (h[i + l] + m - h[i]) % m;\n            cur_h = (cur_h * p_pow[n-i-1]) % m;\n            hs.insert(cur_h);\n        }\n        cnt += hs.size();\n    }\n    return cnt;\n}\n</code></pre> <p>L\u01b0u \u00fd r\u1eb1ng $O(n^2)$ kh\u00f4ng ph\u1ea3i l\u00e0 \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian t\u1ed1t nh\u1ea5t c\u00f3 th\u1ec3 cho b\u00e0i to\u00e1n n\u00e0y. M\u1ed9t gi\u1ea3i ph\u00e1p v\u1edbi $O(n \\log n)$ \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 trong b\u00e0i vi\u1ebft v\u1ec1 M\u1ea3ng H\u1eadu t\u1ed1 (Suffix Arrays), v\u00e0 th\u1eadm ch\u00ed c\u00f3 th\u1ec3 t\u00ednh to\u00e1n n\u00f3 trong $O(n)$ b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng C\u00e2y H\u1eadu t\u1ed1 (Suffix Tree) ho\u1eb7c M\u00e1y t\u1ef1 \u0111\u1ed9ng H\u1eadu t\u1ed1 (Suffix Automaton).</p>","tags":["Translated"]},{"location":"string/string-hashing.html#improve-no-collision-probability","title":"C\u1ea3i thi\u1ec7n x\u00e1c su\u1ea5t kh\u00f4ng va ch\u1ea1m (Improve no-collision probability)","text":"<p>Kh\u00e1 th\u01b0\u1eddng xuy\u00ean, b\u0103m \u0111a th\u1ee9c \u0111\u01b0\u1ee3c \u0111\u1ec1 c\u1eadp \u1edf tr\u00ean \u0111\u1ee7 t\u1ed1t v\u00e0 s\u1ebd kh\u00f4ng c\u00f3 va ch\u1ea1m n\u00e0o x\u1ea3y ra trong qu\u00e1 tr\u00ecnh ki\u1ec3m tra. H\u00e3y nh\u1edb r\u1eb1ng, x\u00e1c su\u1ea5t x\u1ea3y ra va ch\u1ea1m ch\u1ec9 l\u00e0 $\\approx \\frac{1}{m}$. \u0110\u1ed1i v\u1edbi $m = 10^9 + 9$, x\u00e1c su\u1ea5t l\u00e0 $\\approx 10^{-9}$ kh\u00e1 th\u1ea5p. Nh\u01b0ng h\u00e3y l\u01b0u \u00fd r\u1eb1ng ch\u00fang ta ch\u1ec9 th\u1ef1c hi\u1ec7n m\u1ed9t so s\u00e1nh. \u0110i\u1ec1u g\u00ec s\u1ebd x\u1ea3y ra n\u1ebfu ch\u00fang ta so s\u00e1nh m\u1ed9t chu\u1ed7i $s$ v\u1edbi $10^6$ chu\u1ed7i kh\u00e1c nhau. X\u00e1c su\u1ea5t \u0111\u1ec3 \u00edt nh\u1ea5t m\u1ed9t va ch\u1ea1m x\u1ea3y ra b\u00e2y gi\u1edd l\u00e0 $\\approx 10^{-3}$. V\u00e0 n\u1ebfu ch\u00fang ta mu\u1ed1n so s\u00e1nh $10^6$ chu\u1ed7i kh\u00e1c nhau v\u1edbi nhau (v\u00ed d\u1ee5: b\u1eb1ng c\u00e1ch \u0111\u1ebfm s\u1ed1 l\u01b0\u1ee3ng chu\u1ed7i duy nh\u1ea5t t\u1ed3n t\u1ea1i), th\u00ec x\u00e1c su\u1ea5t x\u1ea3y ra \u00edt nh\u1ea5t m\u1ed9t va ch\u1ea1m \u0111\u00e3 l\u00e0 $\\approx 1$. Kh\u00e1 ch\u1eafc ch\u1eafn r\u1eb1ng t\u00e1c v\u1ee5 n\u00e0y s\u1ebd k\u1ebft th\u00fac v\u1edbi m\u1ed9t va ch\u1ea1m v\u00e0 tr\u1ea3 v\u1ec1 k\u1ebft qu\u1ea3 sai.</p> <p>C\u00f3 m\u1ed9t th\u1ee7 thu\u1eadt th\u1ef1c s\u1ef1 d\u1ec5 d\u00e0ng \u0111\u1ec3 c\u00f3 \u0111\u01b0\u1ee3c x\u00e1c su\u1ea5t t\u1ed1t h\u01a1n. Ch\u00fang ta ch\u1ec9 c\u1ea7n t\u00ednh to\u00e1n hai gi\u00e1 tr\u1ecb b\u0103m kh\u00e1c nhau cho m\u1ed7i chu\u1ed7i (b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng hai $p$ kh\u00e1c nhau, v\u00e0/ho\u1eb7c $m$ kh\u00e1c nhau, v\u00e0 so s\u00e1nh c\u00e1c c\u1eb7p n\u00e0y thay th\u1ebf. N\u1ebfu $m$ kho\u1ea3ng $10^9$ cho m\u1ed7i h\u00e0m b\u0103m trong hai h\u00e0m b\u0103m th\u00ec \u0111i\u1ec1u n\u00e0y \u00edt nhi\u1ec1u t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi vi\u1ec7c c\u00f3 m\u1ed9t h\u00e0m b\u0103m v\u1edbi $m \\approx 10^{18}$. Khi so s\u00e1nh $10^6$ chu\u1ed7i v\u1edbi nhau, x\u00e1c su\u1ea5t x\u1ea3y ra \u00edt nh\u1ea5t m\u1ed9t va ch\u1ea1m hi\u1ec7n gi\u1ea3m xu\u1ed1ng c\u00f2n $\\approx 10^{-6}$.</p>","tags":["Translated"]},{"location":"string/string-hashing.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>Good Substrings - Codeforces</li> <li>A Needle in the Haystack - SPOJ</li> <li>String Hashing - Kattis</li> <li>Double Profiles - Codeforces</li> <li>Password - Codeforces</li> <li>SUB_PROB - SPOJ</li> <li>INSQ15_A</li> <li>SPOJ - Ada and Spring Cleaning</li> <li>GYM - Text Editor</li> <li>12012 - Detection of Extraterrestrial</li> <li>Codeforces - Games on a CD</li> <li>UVA 11855 - Buzzwords</li> <li>Codeforces - Santa Claus and a Palindrome</li> <li>Codeforces - String Compression</li> <li>Codeforces - Palindromic Characteristics</li> <li>SPOJ - Test</li> <li>Codeforces - Palindrome Degree</li> <li>Codeforces - Deletion of Repeats</li> <li>HackerRank - Gift Boxes</li> </ul>","tags":["Translated"]},{"location":"string/suffix-array.html","title":"M\u1ea3ng H\u1eadu t\u1ed1 (Suffix Array)","text":"","tags":["Translated"]},{"location":"string/suffix-array.html#definition","title":"\u0110\u1ecbnh ngh\u0129a (Definition)","text":"<p>G\u1ecdi $s$ l\u00e0 chu\u1ed7i c\u00f3 \u0111\u1ed9 d\u00e0i $n$. H\u1eadu t\u1ed1 th\u1ee9 $i$ c\u1ee7a $s$ l\u00e0 chu\u1ed7i con $s[i \\ldots n - 1]$.</p> <p>M\u1ea3ng h\u1eadu t\u1ed1 s\u1ebd ch\u1ee9a c\u00e1c s\u1ed1 nguy\u00ean \u0111\u1ea1i di\u1ec7n cho ch\u1ec9 s\u1ed1 b\u1eaft \u0111\u1ea7u c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c h\u1eadu t\u1ed1 c\u1ee7a m\u1ed9t chu\u1ed7i nh\u1ea5t \u0111\u1ecbnh, sau khi c\u00e1c h\u1eadu t\u1ed1 n\u00f3i tr\u00ean \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp.</p> <p>V\u00ed d\u1ee5 h\u00e3y xem chu\u1ed7i $s = abaab$. T\u1ea5t c\u1ea3 c\u00e1c h\u1eadu t\u1ed1 nh\u01b0 sau</p> $$\\begin{array}{ll} 0. &amp; abaab \\\\ 1. &amp; baab \\\\ 2. &amp; aab \\\\ 3. &amp; ab \\\\ 4. &amp; b \\end{array}$$ <p>Sau khi s\u1eafp x\u1ebfp c\u00e1c chu\u1ed7i n\u00e0y:</p> $$\\begin{array}{ll} 2. &amp; aab \\\\ 3. &amp; ab \\\\ 0. &amp; abaab \\\\ 4. &amp; b \\\\ 1. &amp; baab \\end{array}$$ <p>Do \u0111\u00f3 m\u1ea3ng h\u1eadu t\u1ed1 cho $s$ s\u1ebd l\u00e0 $(2,~ 3,~ 0,~ 4,~ 1)$.</p> <p>L\u00e0 m\u1ed9t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u, n\u00f3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng r\u1ed9ng r\u00e3i trong c\u00e1c l\u0129nh v\u1ef1c nh\u01b0 n\u00e9n d\u1eef li\u1ec7u, tin sinh h\u1ecdc v\u00e0 n\u00f3i chung, trong b\u1ea5t k\u1ef3 l\u0129nh v\u1ef1c n\u00e0o li\u00ean quan \u0111\u1ebfn chu\u1ed7i v\u00e0 c\u00e1c v\u1ea5n \u0111\u1ec1 so kh\u1edbp chu\u1ed7i.</p>","tags":["Translated"]},{"location":"string/suffix-array.html#construction","title":"X\u00e2y d\u1ef1ng (Construction)","text":"","tags":["Translated"]},{"location":"string/suffix-array.html#on2-log-n-approach","title":"Ti\u1ebfp c\u1eadn $O(n^2 \\log n)$ ($O(n^2 \\log n)$ approach)","text":"<p>\u0110\u00e2y l\u00e0 c\u00e1ch ti\u1ebfp c\u1eadn ng\u00e2y th\u01a1 nh\u1ea5t. L\u1ea5y t\u1ea5t c\u1ea3 c\u00e1c h\u1eadu t\u1ed1 v\u00e0 s\u1eafp x\u1ebfp ch\u00fang b\u1eb1ng quicksort ho\u1eb7c mergesort \u0111\u1ed3ng th\u1eddi gi\u1eef l\u1ea1i c\u00e1c ch\u1ec9 s\u1ed1 ban \u0111\u1ea7u c\u1ee7a ch\u00fang. Vi\u1ec7c s\u1eafp x\u1ebfp s\u1eed d\u1ee5ng $O(n \\log n)$ so s\u00e1nh, v\u00e0 v\u00ec so s\u00e1nh hai chu\u1ed7i s\u1ebd m\u1ea5t th\u00eam th\u1eddi gian $O(n)$, ch\u00fang ta \u0111\u1ea1t \u0111\u01b0\u1ee3c \u0111\u1ed9 ph\u1ee9c t\u1ea1p cu\u1ed1i c\u00f9ng l\u00e0 $O(n^2 \\log n)$.</p>","tags":["Translated"]},{"location":"string/suffix-array.html#on-log-n-approach","title":"Ti\u1ebfp c\u1eadn $O(n \\log n)$ ($O(n \\log n)$ approach)","text":"<p>N\u00f3i m\u1ed9t c\u00e1ch ch\u00ednh x\u00e1c, thu\u1eadt to\u00e1n sau \u0111\u00e2y s\u1ebd kh\u00f4ng s\u1eafp x\u1ebfp c\u00e1c h\u1eadu t\u1ed1, m\u00e0 l\u00e0 c\u00e1c d\u1ecbch chuy\u1ec3n v\u00f2ng (cyclic shifts) c\u1ee7a m\u1ed9t chu\u1ed7i. Tuy nhi\u00ean, ch\u00fang ta c\u00f3 th\u1ec3 r\u1ea5t d\u1ec5 d\u00e0ng suy ra m\u1ed9t thu\u1eadt to\u00e1n \u0111\u1ec3 s\u1eafp x\u1ebfp c\u00e1c h\u1eadu t\u1ed1 t\u1eeb n\u00f3: ch\u1ec9 c\u1ea7n th\u00eam m\u1ed9t k\u00fd t\u1ef1 t\u00f9y \u00fd v\u00e0o cu\u1ed1i chu\u1ed7i nh\u1ecf h\u01a1n b\u1ea5t k\u1ef3 k\u00fd t\u1ef1 n\u00e0o trong chu\u1ed7i l\u00e0 \u0111\u1ee7. S\u1eed d\u1ee5ng bi\u1ec3u t\u01b0\u1ee3ng $ l\u00e0 ph\u1ed5 bi\u1ebfn. Khi \u0111\u00f3 th\u1ee9 t\u1ef1 c\u1ee7a c\u00e1c d\u1ecbch chuy\u1ec3n v\u00f2ng \u0111\u00e3 s\u1eafp x\u1ebfp t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi th\u1ee9 t\u1ef1 c\u1ee7a c\u00e1c h\u1eadu t\u1ed1 \u0111\u00e3 s\u1eafp x\u1ebfp, nh\u01b0 \u0111\u01b0\u1ee3c minh h\u1ecda \u1edf \u0111\u00e2y v\u1edbi chu\u1ed7i $dabbb$.</p> $$\\begin{array}{lll} 1. &amp; abbb\\$d &amp; abbb \\\\ 4. &amp; b\\$dabb &amp; b \\\\ 3. &amp; bb\\$dab &amp; bb \\\\ 6. &amp; bbb\\$da &amp; bbb \\\\ 0. &amp; dabbb\\$ &amp; dabbb \\end{array}$$ <p>V\u00ec ch\u00fang ta s\u1ebd s\u1eafp x\u1ebfp c\u00e1c d\u1ecbch chuy\u1ec3n v\u00f2ng, ch\u00fang ta s\u1ebd xem x\u00e9t chu\u1ed7i con v\u00f2ng (cyclic substrings). Ch\u00fang ta s\u1ebd s\u1eed d\u1ee5ng k\u00fd hi\u1ec7u $s[i \\dots j]$ cho chu\u1ed7i con c\u1ee7a $s$ ngay c\u1ea3 khi $i &gt; j$. Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, ch\u00fang t\u00f4i th\u1ef1c s\u1ef1 c\u00f3 ngh\u0129a l\u00e0 chu\u1ed7i $s[i \\dots n-1] + s[0 \\dots j]$. Ngo\u00e0i ra, ch\u00fang t\u00f4i s\u1ebd l\u1ea5y t\u1ea5t c\u1ea3 c\u00e1c ch\u1ec9 s\u1ed1 modulo theo \u0111\u1ed9 d\u00e0i c\u1ee7a $s$, v\u00e0 s\u1ebd b\u1ecf qua ph\u00e9p to\u00e1n modulo cho \u0111\u01a1n gi\u1ea3n.</p> <p>Thu\u1eadt to\u00e1n ch\u00fang t\u00f4i th\u1ea3o lu\u1eadn s\u1ebd th\u1ef1c hi\u1ec7n $\\lceil \\log n \\rceil + 1$ l\u1ea7n l\u1eb7p. Trong l\u1ea7n l\u1eb7p th\u1ee9 $k$ ($k = 0 \\dots \\lceil \\log n \\rceil$), ch\u00fang ta s\u1eafp x\u1ebfp $n$ chu\u1ed7i con v\u00f2ng c\u1ee7a $s$ c\u00f3 \u0111\u1ed9 d\u00e0i $2^k$. Sau l\u1ea7n l\u1eb7p th\u1ee9 $\\lceil \\log n \\rceil$, c\u00e1c chu\u1ed7i con c\u00f3 \u0111\u1ed9 d\u00e0i $2^{\\lceil \\log n \\rceil} \\ge n$ s\u1ebd \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp, v\u00ec v\u1eady \u0111i\u1ec1u n\u00e0y t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi vi\u1ec7c s\u1eafp x\u1ebfp ho\u00e0n to\u00e0n c\u00e1c d\u1ecbch chuy\u1ec3n v\u00f2ng.</p> <p>Trong m\u1ed7i l\u1ea7n l\u1eb7p c\u1ee7a thu\u1eadt to\u00e1n, ngo\u00e0i ho\u00e1n v\u1ecb $p[0 \\dots n-1]$, trong \u0111\u00f3 $p[i]$ l\u00e0 ch\u1ec9 s\u1ed1 c\u1ee7a chu\u1ed7i con th\u1ee9 $i$ (b\u1eaft \u0111\u1ea7u t\u1ea1i $i$ v\u00e0 v\u1edbi \u0111\u1ed9 d\u00e0i $2^k$) theo th\u1ee9 t\u1ef1 \u0111\u00e3 s\u1eafp x\u1ebfp, ch\u00fang ta c\u0169ng s\u1ebd duy tr\u00ec m\u1ed9t m\u1ea3ng $c[0 \\dots n-1]$, trong \u0111\u00f3 $c[i]$ t\u01b0\u01a1ng \u1ee9ng v\u1edbi l\u1edbp t\u01b0\u01a1ng \u0111\u01b0\u01a1ng (equivalence class) m\u00e0 chu\u1ed7i con thu\u1ed9c v\u1ec1. B\u1edfi v\u00ec m\u1ed9t s\u1ed1 chu\u1ed7i con s\u1ebd gi\u1ed1ng h\u1ec7t nhau v\u00e0 thu\u1eadt to\u00e1n c\u1ea7n x\u1eed l\u00fd ch\u00fang nh\u01b0 nhau. \u0110\u1ec3 thu\u1eadn ti\u1ec7n, c\u00e1c l\u1edbp s\u1ebd \u0111\u01b0\u1ee3c d\u00e1n nh\u00e3n b\u1eb1ng c\u00e1c s\u1ed1 b\u1eaft \u0111\u1ea7u t\u1eeb kh\u00f4ng. Ngo\u00e0i ra, c\u00e1c s\u1ed1 $c[i]$ s\u1ebd \u0111\u01b0\u1ee3c g\u00e1n theo c\u00e1ch sao cho ch\u00fang b\u1ea3o to\u00e0n th\u00f4ng tin v\u1ec1 th\u1ee9 t\u1ef1: n\u1ebfu m\u1ed9t chu\u1ed7i con nh\u1ecf h\u01a1n chu\u1ed7i con kia, th\u00ec n\u00f3 c\u0169ng ph\u1ea3i c\u00f3 nh\u00e3n l\u1edbp nh\u1ecf h\u01a1n. S\u1ed1 l\u01b0\u1ee3ng l\u1edbp t\u01b0\u01a1ng \u0111\u01b0\u01a1ng s\u1ebd \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef trong bi\u1ebfn $\\text{classes}$.</p> <p>H\u00e3y xem m\u1ed9t v\u00ed d\u1ee5. X\u00e9t chu\u1ed7i $s = aaba$. C\u00e1c chu\u1ed7i con v\u00f2ng v\u00e0 c\u00e1c m\u1ea3ng t\u01b0\u01a1ng \u1ee9ng $p[]$ v\u00e0 $c[]$ \u0111\u01b0\u1ee3c \u0111\u01b0a ra cho m\u1ed7i l\u1ea7n l\u1eb7p:</p> $$\\begin{array}{cccc} 0: &amp; (a,~ a,~ b,~ a) &amp; p = (0,~ 1,~ 3,~ 2) &amp; c = (0,~ 0,~ 1,~ 0)\\\\ 1: &amp; (aa,~ ab,~ ba,~ aa) &amp; p = (0,~ 3,~ 1,~ 2) &amp; c = (0,~ 1,~ 2,~ 0)\\\\ 2: &amp; (aaba,~ abaa,~ baaa,~ aaab) &amp; p = (3,~ 0,~ 1,~ 2) &amp; c = (1,~ 2,~ 3,~ 0)\\\\ \\end{array}$$ <p>\u0110i\u1ec1u \u0111\u00e1ng ch\u00fa \u00fd l\u00e0 c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a $p[]$ c\u00f3 th\u1ec3 kh\u00e1c nhau. V\u00ed d\u1ee5 trong l\u1ea7n l\u1eb7p th\u1ee9 $0$, m\u1ea3ng c\u0169ng c\u00f3 th\u1ec3 l\u00e0 $p = (3,~ 1,~ 0,~ 2)$ ho\u1eb7c $p = (3,~ 0,~ 1,~ 2)$. T\u1ea5t c\u1ea3 c\u00e1c t\u00f9y ch\u1ecdn n\u00e0y ho\u00e1n v\u1ecb c\u00e1c chu\u1ed7i con th\u00e0nh m\u1ed9t th\u1ee9 t\u1ef1 \u0111\u00e3 s\u1eafp x\u1ebfp. V\u00ec v\u1eady, t\u1ea5t c\u1ea3 ch\u00fang \u0111\u1ec1u h\u1ee3p l\u1ec7. \u0110\u1ed3ng th\u1eddi m\u1ea3ng $c[]$ l\u00e0 c\u1ed1 \u0111\u1ecbnh, kh\u00f4ng th\u1ec3 c\u00f3 s\u1ef1 m\u01a1 h\u1ed3.</p> <p>B\u00e2y gi\u1edd ch\u00fang ta h\u00e3y t\u1eadp trung v\u00e0o vi\u1ec7c th\u1ef1c hi\u1ec7n thu\u1eadt to\u00e1n. Ch\u00fang ta s\u1ebd vi\u1ebft m\u1ed9t h\u00e0m nh\u1eadn chu\u1ed7i $s$ v\u00e0 tr\u1ea3 v\u1ec1 c\u00e1c ho\u00e1n v\u1ecb c\u1ee7a c\u00e1c d\u1ecbch chuy\u1ec3n v\u00f2ng \u0111\u00e3 s\u1eafp x\u1ebfp.</p> <pre><code>vector&lt;int&gt; sort_cyclic_shifts(string const&amp; s) {\n    int n = s.size();\n    const int alphabet = 256;\n</code></pre> <p>Khi b\u1eaft \u0111\u1ea7u (trong l\u1ea7n l\u1eb7p th\u1ee9 $0$), ch\u00fang ta ph\u1ea3i s\u1eafp x\u1ebfp c\u00e1c chu\u1ed7i con v\u00f2ng c\u00f3 \u0111\u1ed9 d\u00e0i $1$, ngh\u0129a l\u00e0 ch\u00fang ta ph\u1ea3i s\u1eafp x\u1ebfp t\u1ea5t c\u1ea3 c\u00e1c k\u00fd t\u1ef1 c\u1ee7a chu\u1ed7i v\u00e0 chia ch\u00fang th\u00e0nh c\u00e1c l\u1edbp t\u01b0\u01a1ng \u0111\u01b0\u01a1ng (c\u00f9ng m\u1ed9t k\u00fd hi\u1ec7u \u0111\u01b0\u1ee3c g\u00e1n cho c\u00f9ng m\u1ed9t l\u1edbp). \u0110i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n m\u1ed9t c\u00e1ch t\u1ea7m th\u01b0\u1eddng, v\u00ed d\u1ee5, b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng s\u1eafp x\u1ebfp \u0111\u1ebfm (counting sort). \u0110\u1ed1i v\u1edbi m\u1ed7i k\u00fd t\u1ef1, ch\u00fang ta \u0111\u1ebfm s\u1ed1 l\u1ea7n n\u00f3 xu\u1ea5t hi\u1ec7n trong chu\u1ed7i, v\u00e0 sau \u0111\u00f3 s\u1eed d\u1ee5ng th\u00f4ng tin n\u00e0y \u0111\u1ec3 t\u1ea1o m\u1ea3ng $p[]$. Sau \u0111\u00f3, ch\u00fang ta \u0111i qua m\u1ea3ng $p[]$ v\u00e0 x\u00e2y d\u1ef1ng $c[]$ b\u1eb1ng c\u00e1ch so s\u00e1nh c\u00e1c k\u00fd t\u1ef1 li\u1ec1n k\u1ec1.</p> <pre><code>    vector&lt;int&gt; p(n), c(n), cnt(max(alphabet, n), 0);\n    for (int i = 0; i &lt; n; i++)\n        cnt[s[i]]++;\n    for (int i = 1; i &lt; alphabet; i++)\n        cnt[i] += cnt[i-1];\n    for (int i = 0; i &lt; n; i++)\n        p[--cnt[s[i]]] = i;\n    c[p[0]] = 0;\n    int classes = 1;\n    for (int i = 1; i &lt; n; i++) {\n        if (s[p[i]] != s[p[i-1]])\n            classes++;\n        c[p[i]] = classes - 1;\n    }\n</code></pre> <p>B\u00e2y gi\u1edd ch\u00fang ta ph\u1ea3i n\u00f3i v\u1ec1 b\u01b0\u1edbc l\u1eb7p. Gi\u1ea3 s\u1eed ch\u00fang ta \u0111\u00e3 th\u1ef1c hi\u1ec7n b\u01b0\u1edbc $k-1$ v\u00e0 t\u00ednh to\u00e1n c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a c\u00e1c m\u1ea3ng $p[]$ v\u00e0 $c[]$ cho n\u00f3. Ch\u00fang ta mu\u1ed1n t\u00ednh to\u00e1n c\u00e1c gi\u00e1 tr\u1ecb cho b\u01b0\u1edbc $k$ trong th\u1eddi gian $O(n)$. V\u00ec ch\u00fang ta th\u1ef1c hi\u1ec7n b\u01b0\u1edbc n\u00e0y $O(\\log n)$ l\u1ea7n, n\u00ean thu\u1eadt to\u00e1n ho\u00e0n ch\u1ec9nh s\u1ebd c\u00f3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian l\u00e0 $O(n \\log n)$.</p> <p>\u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y, l\u01b0u \u00fd r\u1eb1ng c\u00e1c chu\u1ed7i con v\u00f2ng c\u00f3 \u0111\u1ed9 d\u00e0i $2^k$ bao g\u1ed3m hai chu\u1ed7i con c\u00f3 \u0111\u1ed9 d\u00e0i $2^{k-1}$ m\u00e0 ch\u00fang ta c\u00f3 th\u1ec3 so s\u00e1nh v\u1edbi nhau trong $O(1)$ b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng th\u00f4ng tin t\u1eeb giai \u0111o\u1ea1n tr\u01b0\u1edbc - gi\u00e1 tr\u1ecb c\u1ee7a c\u00e1c l\u1edbp t\u01b0\u01a1ng \u0111\u01b0\u01a1ng $c[]$. Do \u0111\u00f3, \u0111\u1ed1i v\u1edbi hai chu\u1ed7i con c\u00f3 \u0111\u1ed9 d\u00e0i $2^k$ b\u1eaft \u0111\u1ea7u t\u1ea1i v\u1ecb tr\u00ed $i$ v\u00e0 $j$, t\u1ea5t c\u1ea3 th\u00f4ng tin c\u1ea7n thi\u1ebft \u0111\u1ec3 so s\u00e1nh ch\u00fang \u0111\u01b0\u1ee3c ch\u1ee9a trong c\u00e1c c\u1eb7p $(c[i],~ c[i + 2^{k-1}])$ v\u00e0 $(c[j],~ c[j + 2^{k-1}])$.</p> $$\\dots \\overbrace{ \\underbrace{s_i \\dots s_{i+2^{k-1}-1}}_{\\text{length} = 2^{k-1},~ \\text{class} = c[i]} \\quad \\underbrace{s_{i+2^{k-1}} \\dots s_{i+2^k-1}}_{\\text{length} = 2^{k-1},~ \\text{class} = c[i + 2^{k-1}]} }^{\\text{length} = 2^k} \\dots \\overbrace{ \\underbrace{s_j \\dots s_{j+2^{k-1}-1}}_{\\text{length} = 2^{k-1},~ \\text{class} = c[j]} \\quad \\underbrace{s_{j+2^{k-1}} \\dots s_{j+2^k-1}}_{\\text{length} = 2^{k-1},~ \\text{class} = c[j + 2^{k-1}]} }^{\\text{length} = 2^k} \\dots $$ <p>\u0110i\u1ec1u n\u00e0y cho ch\u00fang ta m\u1ed9t gi\u1ea3i ph\u00e1p r\u1ea5t \u0111\u01a1n gi\u1ea3n: s\u1eafp x\u1ebfp c\u00e1c chu\u1ed7i con c\u00f3 \u0111\u1ed9 d\u00e0i $2^k$ theo c\u00e1c c\u1eb7p s\u1ed1 n\u00e0y. \u0110i\u1ec1u n\u00e0y s\u1ebd cho ch\u00fang ta th\u1ee9 t\u1ef1 $p[]$ c\u1ea7n thi\u1ebft. Tuy nhi\u00ean, m\u1ed9t s\u1eafp x\u1ebfp th\u00f4ng th\u01b0\u1eddng ch\u1ea1y trong th\u1eddi gian $O(n \\log n)$, m\u00e0 ch\u00fang ta kh\u00f4ng h\u00e0i l\u00f2ng. \u0110i\u1ec1u n\u00e0y s\u1ebd ch\u1ec9 cho ch\u00fang ta m\u1ed9t thu\u1eadt to\u00e1n \u0111\u1ec3 x\u00e2y d\u1ef1ng m\u1ed9t m\u1ea3ng h\u1eadu t\u1ed1 trong th\u1eddi gian $O(n \\log^2 n)$.</p> <p>L\u00e0m th\u1ebf n\u00e0o \u0111\u1ec3 ch\u00fang ta th\u1ef1c hi\u1ec7n nhanh vi\u1ec7c s\u1eafp x\u1ebfp c\u00e1c c\u1eb7p nh\u01b0 v\u1eady? V\u00ec c\u00e1c ph\u1ea7n t\u1eed c\u1ee7a c\u00e1c c\u1eb7p kh\u00f4ng v\u01b0\u1ee3t qu\u00e1 $n$, ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng s\u1eafp x\u1ebfp \u0111\u1ebfm m\u1ed9t l\u1ea7n n\u1eefa. Tuy nhi\u00ean, s\u1eafp x\u1ebfp c\u00e1c c\u1eb7p b\u1eb1ng s\u1eafp x\u1ebfp \u0111\u1ebfm kh\u00f4ng ph\u1ea3i l\u00e0 hi\u1ec7u qu\u1ea3 nh\u1ea5t. \u0110\u1ec3 \u0111\u1ea1t \u0111\u01b0\u1ee3c h\u1eb1ng s\u1ed1 \u1ea9n t\u1ed1t h\u01a1n trong \u0111\u1ed9 ph\u1ee9c t\u1ea1p, ch\u00fang ta s\u1ebd s\u1eed d\u1ee5ng m\u1ed9t th\u1ee7 thu\u1eadt kh\u00e1c.</p> <p>Ch\u00fang ta s\u1eed d\u1ee5ng \u1edf \u0111\u00e2y k\u1ef9 thu\u1eadt m\u00e0 s\u1eafp x\u1ebfp c\u01a1 s\u1ed1 (radix sort) d\u1ef1a tr\u00ean: \u0111\u1ec3 s\u1eafp x\u1ebfp c\u00e1c c\u1eb7p, tr\u01b0\u1edbc ti\u00ean ch\u00fang ta s\u1eafp x\u1ebfp ch\u00fang theo ph\u1ea7n t\u1eed th\u1ee9 hai, v\u00e0 sau \u0111\u00f3 theo ph\u1ea7n t\u1eed th\u1ee9 nh\u1ea5t (v\u1edbi s\u1eafp x\u1ebfp \u1ed5n \u0111\u1ecbnh, t\u1ee9c l\u00e0 s\u1eafp x\u1ebfp kh\u00f4ng ph\u00e1 v\u1ee1 th\u1ee9 t\u1ef1 t\u01b0\u01a1ng \u0111\u1ed1i c\u1ee7a c\u00e1c ph\u1ea7n t\u1eed b\u1eb1ng nhau). Tuy nhi\u00ean, c\u00e1c ph\u1ea7n t\u1eed th\u1ee9 hai \u0111\u00e3 \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp trong l\u1ea7n l\u1eb7p tr\u01b0\u1edbc \u0111\u00f3. Do \u0111\u00f3, \u0111\u1ec3 s\u1eafp x\u1ebfp c\u00e1c c\u1eb7p theo c\u00e1c ph\u1ea7n t\u1eed th\u1ee9 hai, ch\u00fang ta ch\u1ec9 c\u1ea7n tr\u1eeb $2^{k-1}$ t\u1eeb c\u00e1c ch\u1ec9 s\u1ed1 trong $p[]$ (v\u00ed d\u1ee5: n\u1ebfu chu\u1ed7i con nh\u1ecf nh\u1ea5t c\u00f3 \u0111\u1ed9 d\u00e0i $2^{k-1}$ b\u1eaft \u0111\u1ea7u t\u1ea1i v\u1ecb tr\u00ed $i$, th\u00ec chu\u1ed7i con c\u00f3 \u0111\u1ed9 d\u00e0i $2^k$ v\u1edbi n\u1eeda sau nh\u1ecf nh\u1ea5t b\u1eaft \u0111\u1ea7u t\u1ea1i $i - 2^{k-1}$).</p> <p>V\u00ec v\u1eady, ch\u1ec9 b\u1eb1ng c\u00e1c ph\u00e9p tr\u1eeb \u0111\u01a1n gi\u1ea3n, ch\u00fang ta c\u00f3 th\u1ec3 s\u1eafp x\u1ebfp c\u00e1c ph\u1ea7n t\u1eed th\u1ee9 hai c\u1ee7a c\u00e1c c\u1eb7p trong $p[]$. B\u00e2y gi\u1edd ch\u00fang ta c\u1ea7n th\u1ef1c hi\u1ec7n s\u1eafp x\u1ebfp \u1ed5n \u0111\u1ecbnh theo c\u00e1c ph\u1ea7n t\u1eed \u0111\u1ea7u ti\u00ean. Nh\u01b0 \u0111\u00e3 \u0111\u1ec1 c\u1eadp, \u0111i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n b\u1eb1ng s\u1eafp x\u1ebfp \u0111\u1ebfm.</p> <p>\u0110i\u1ec1u duy nh\u1ea5t c\u00f2n l\u1ea1i l\u00e0 t\u00ednh to\u00e1n c\u00e1c l\u1edbp t\u01b0\u01a1ng \u0111\u01b0\u01a1ng $c[]$, nh\u01b0ng nh\u01b0 tr\u01b0\u1edbc \u0111\u00e2y, \u0111i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n b\u1eb1ng c\u00e1ch l\u1eb7p qua ho\u00e1n v\u1ecb \u0111\u00e3 s\u1eafp x\u1ebfp $p[]$ v\u00e0 so s\u00e1nh c\u00e1c c\u1eb7p l\u00e2n c\u1eadn.</p> <p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 ph\u1ea7n c\u00e0i \u0111\u1eb7t c\u00f2n l\u1ea1i. Ch\u00fang t\u00f4i s\u1eed d\u1ee5ng c\u00e1c m\u1ea3ng t\u1ea1m th\u1eddi $pn[]$ v\u00e0 $cn[]$ \u0111\u1ec3 l\u01b0u tr\u1eef ho\u00e1n v\u1ecb theo c\u00e1c ph\u1ea7n t\u1eed th\u1ee9 hai v\u00e0 c\u00e1c ch\u1ec9 s\u1ed1 l\u1edbp t\u01b0\u01a1ng \u0111\u01b0\u01a1ng m\u1edbi.</p> <p><pre><code>    vector&lt;int&gt; pn(n), cn(n);\n    for (int h = 0; (1 &lt;&lt; h) &lt; n; ++h) {\n        for (int i = 0; i &lt; n; i++) {\n            pn[i] = p[i] - (1 &lt;&lt; h);\n            if (pn[i] &lt; 0)\n                pn[i] += n;\n        }\n        fill(cnt.begin(), cnt.begin() + classes, 0);\n        for (int i = 0; i &lt; n; i++)\n            cnt[c[pn[i]]]++;\n        for (int i = 1; i &lt; classes; i++)\n            cnt[i] += cnt[i-1];\n        for (int i = n-1; i &gt;= 0; i--)\n            p[--cnt[c[pn[i]]]] = pn[i];\n        cn[p[0]] = 0;\n        classes = 1;\n        for (int i = 1; i &lt; n; i++) {\n            pair&lt;int, int&gt; cur = {c[p[i]], c[(p[i] + (1 &lt;&lt; h)) % n]};\n            pair&lt;int, int&gt; prev = {c[p[i-1]], c[(p[i-1] + (1 &lt;&lt; h)) % n]};\n            if (cur != prev)\n                ++classes;\n            cn[p[i]] = classes - 1;\n        }\n        c.swap(cn);\n    }\n    return p;\n}\n</code></pre> Thu\u1eadt to\u00e1n y\u00eau c\u1ea7u th\u1eddi gian $O(n \\log n)$ v\u00e0 b\u1ed9 nh\u1edb $O(n)$. \u0110\u1ec3 \u0111\u01a1n gi\u1ea3n, ch\u00fang t\u00f4i \u0111\u00e3 s\u1eed d\u1ee5ng ph\u1ea1m vi ASCII ho\u00e0n ch\u1ec9nh l\u00e0m b\u1ea3ng ch\u1eef c\u00e1i.</p> <p>N\u1ebfu bi\u1ebft r\u1eb1ng chu\u1ed7i ch\u1ec9 ch\u1ee9a m\u1ed9t t\u1eadp h\u1ee3p con c\u00e1c k\u00fd t\u1ef1, v\u00ed d\u1ee5 nh\u01b0 ch\u1ec9 c\u00e1c ch\u1eef c\u00e1i vi\u1ebft th\u01b0\u1eddng, th\u00ec vi\u1ec7c tri\u1ec3n khai c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u1ed1i \u01b0u h\u00f3a, nh\u01b0ng y\u1ebfu t\u1ed1 t\u1ed1i \u01b0u h\u00f3a c\u00f3 th\u1ec3 s\u1ebd kh\u00f4ng \u0111\u00e1ng k\u1ec3, v\u00ec k\u00edch th\u01b0\u1edbc c\u1ee7a b\u1ea3ng ch\u1eef c\u00e1i ch\u1ec9 quan tr\u1ecdng trong l\u1ea7n l\u1eb7p \u0111\u1ea7u ti\u00ean. M\u1ecdi l\u1ea7n l\u1eb7p kh\u00e1c ph\u1ee5 thu\u1ed9c v\u00e0o s\u1ed1 l\u01b0\u1ee3ng c\u00e1c l\u1edbp t\u01b0\u01a1ng \u0111\u01b0\u01a1ng, c\u00f3 th\u1ec3 nhanh ch\u00f3ng \u0111\u1ea1t t\u1edbi $O(n)$ ngay c\u1ea3 khi ban \u0111\u1ea7u n\u00f3 l\u00e0 m\u1ed9t chu\u1ed7i tr\u00ean b\u1ea3ng ch\u1eef c\u00e1i c\u00f3 k\u00edch th\u01b0\u1edbc $2$.</p> <p>C\u0169ng l\u01b0u \u00fd r\u1eb1ng, thu\u1eadt to\u00e1n n\u00e0y ch\u1ec9 s\u1eafp x\u1ebfp c\u00e1c d\u1ecbch chuy\u1ec3n v\u00f2ng. Nh\u01b0 \u0111\u00e3 \u0111\u1ec1 c\u1eadp \u1edf \u0111\u1ea7u ph\u1ea7n n\u00e0y, ch\u00fang ta c\u00f3 th\u1ec3 t\u1ea1o th\u1ee9 t\u1ef1 s\u1eafp x\u1ebfp c\u1ee7a c\u00e1c h\u1eadu t\u1ed1 b\u1eb1ng c\u00e1ch th\u00eam m\u1ed9t k\u00fd t\u1ef1 nh\u1ecf h\u01a1n t\u1ea5t c\u1ea3 c\u00e1c k\u00fd t\u1ef1 kh\u00e1c c\u1ee7a chu\u1ed7i v\u00e0 s\u1eafp x\u1ebfp chu\u1ed7i k\u1ebft qu\u1ea3 n\u00e0y theo c\u00e1c d\u1ecbch chuy\u1ec3n v\u00f2ng, v\u00ed d\u1ee5: b\u1eb1ng c\u00e1ch s\u1eafp x\u1ebfp c\u00e1c d\u1ecbch chuy\u1ec3n v\u00f2ng c\u1ee7a $s + \\$$. \u0110i\u1ec1u n\u00e0y r\u00f5 r\u00e0ng s\u1ebd cung c\u1ea5p m\u1ea3ng h\u1eadu t\u1ed1 c\u1ee7a $s$, tuy nhi\u00ean \u0111\u01b0\u1ee3c th\u00eam v\u00e0o tr\u01b0\u1edbc v\u1edbi $|s|$.</p> <pre><code>vector&lt;int&gt; suffix_array_construction(string s) {\n    s += \"$\";\n    vector&lt;int&gt; sorted_shifts = sort_cyclic_shifts(s);\n    sorted_shifts.erase(sorted_shifts.begin());\n    return sorted_shifts;\n}\n</code></pre>","tags":["Translated"]},{"location":"string/suffix-array.html#applications","title":"\u1ee8ng d\u1ee5ng (Applications)","text":"","tags":["Translated"]},{"location":"string/suffix-array.html#finding-the-smallest-cyclic-shift","title":"T\u00ecm d\u1ecbch chuy\u1ec3n v\u00f2ng nh\u1ecf nh\u1ea5t (Finding the smallest cyclic shift)","text":"<p>Thu\u1eadt to\u00e1n tr\u00ean s\u1eafp x\u1ebfp t\u1ea5t c\u1ea3 c\u00e1c d\u1ecbch chuy\u1ec3n v\u00f2ng (kh\u00f4ng th\u00eam k\u00fd t\u1ef1 v\u00e0o chu\u1ed7i), v\u00e0 do \u0111\u00f3 $p[0]$ cho v\u1ecb tr\u00ed c\u1ee7a d\u1ecbch chuy\u1ec3n v\u00f2ng nh\u1ecf nh\u1ea5t.</p>","tags":["Translated"]},{"location":"string/suffix-array.html#finding-a-substring-in-a-string","title":"T\u00ecm chu\u1ed7i con trong chu\u1ed7i (Finding a substring in a string)","text":"<p>Nhi\u1ec7m v\u1ee5 l\u00e0 t\u00ecm m\u1ed9t chu\u1ed7i $s$ b\u00ean trong m\u1ed9t v\u0103n b\u1ea3n $t$ tr\u1ef1c tuy\u1ebfn - ch\u00fang ta bi\u1ebft tr\u01b0\u1edbc v\u0103n b\u1ea3n $t$, nh\u01b0ng kh\u00f4ng ph\u1ea3i chu\u1ed7i $s$. Ch\u00fang ta c\u00f3 th\u1ec3 t\u1ea1o m\u1ea3ng h\u1eadu t\u1ed1 cho v\u0103n b\u1ea3n $t$ trong th\u1eddi gian $O(|t| \\log |t|)$. B\u00e2y gi\u1edd ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm ki\u1ebfm chu\u1ed7i con $s$ theo c\u00e1ch sau. S\u1ef1 xu\u1ea5t hi\u1ec7n c\u1ee7a $s$ ph\u1ea3i l\u00e0 ti\u1ec1n t\u1ed1 c\u1ee7a m\u1ed9t s\u1ed1 h\u1eadu t\u1ed1 t\u1eeb $t$. V\u00ec ch\u00fang ta \u0111\u00e3 s\u1eafp x\u1ebfp t\u1ea5t c\u1ea3 c\u00e1c h\u1eadu t\u1ed1, ch\u00fang ta c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n cho $s$ trong $p$. So s\u00e1nh h\u1eadu t\u1ed1 hi\u1ec7n t\u1ea1i v\u00e0 chu\u1ed7i con $s$ trong t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong th\u1eddi gian $O(|s|)$, do \u0111\u00f3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p \u0111\u1ec3 t\u00ecm chu\u1ed7i con l\u00e0 $O(|s| \\log |t|)$. C\u0169ng l\u01b0u \u00fd r\u1eb1ng n\u1ebfu chu\u1ed7i con xu\u1ea5t hi\u1ec7n nhi\u1ec1u l\u1ea7n trong $t$, th\u00ec t\u1ea5t c\u1ea3 c\u00e1c l\u1ea7n xu\u1ea5t hi\u1ec7n s\u1ebd n\u1eb1m c\u1ea1nh nhau trong $p$. Do \u0111\u00f3 s\u1ed1 l\u1ea7n xu\u1ea5t hi\u1ec7n c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y b\u1eb1ng t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n th\u1ee9 hai, v\u00e0 t\u1ea5t c\u1ea3 c\u00e1c l\u1ea7n xu\u1ea5t hi\u1ec7n c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c in d\u1ec5 d\u00e0ng.</p>","tags":["Translated"]},{"location":"string/suffix-array.html#comparing-two-substrings-of-a-string","title":"So s\u00e1nh hai chu\u1ed7i con c\u1ee7a m\u1ed9t chu\u1ed7i (Comparing two substrings of a string)","text":"<p>Ch\u00fang ta mu\u1ed1n c\u00f3 th\u1ec3 so s\u00e1nh hai chu\u1ed7i con c\u00f3 c\u00f9ng \u0111\u1ed9 d\u00e0i c\u1ee7a m\u1ed9t chu\u1ed7i $s$ \u0111\u00e3 cho trong th\u1eddi gian $O(1)$, ngh\u0129a l\u00e0 ki\u1ec3m tra xem chu\u1ed7i con \u0111\u1ea7u ti\u00ean c\u00f3 nh\u1ecf h\u01a1n chu\u1ed7i con th\u1ee9 hai kh\u00f4ng.</p> <p>\u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y, ch\u00fang ta x\u00e2y d\u1ef1ng m\u1ea3ng h\u1eadu t\u1ed1 trong th\u1eddi gian $O(|s| \\log |s|)$ v\u00e0 l\u01b0u tr\u1eef t\u1ea5t c\u1ea3 c\u00e1c k\u1ebft qu\u1ea3 trung gian c\u1ee7a c\u00e1c l\u1edbp t\u01b0\u01a1ng \u0111\u01b0\u01a1ng $c[]$.</p> <p>S\u1eed d\u1ee5ng th\u00f4ng tin n\u00e0y, ch\u00fang ta c\u00f3 th\u1ec3 so s\u00e1nh b\u1ea5t k\u1ef3 hai chu\u1ed7i con n\u00e0o c\u00f3 \u0111\u1ed9 d\u00e0i b\u1eb1ng l\u0169y th\u1eeba c\u1ee7a hai trong O(1): \u0111\u1ed1i v\u1edbi \u0111i\u1ec1u n\u00e0y, ch\u1ec9 c\u1ea7n so s\u00e1nh c\u00e1c l\u1edbp t\u01b0\u01a1ng \u0111\u01b0\u01a1ng c\u1ee7a c\u1ea3 hai chu\u1ed7i con l\u00e0 \u0111\u1ee7. B\u00e2y gi\u1edd ch\u00fang ta mu\u1ed1n kh\u00e1i qu\u00e1t h\u00f3a ph\u01b0\u01a1ng ph\u00e1p n\u00e0y cho c\u00e1c chu\u1ed7i con c\u00f3 \u0111\u1ed9 d\u00e0i t\u00f9y \u00fd.</p> <p>H\u00e3y so s\u00e1nh hai chu\u1ed7i con c\u00f3 \u0111\u1ed9 d\u00e0i $l$ v\u1edbi c\u00e1c ch\u1ec9 s\u1ed1 b\u1eaft \u0111\u1ea7u $i$ v\u00e0 $j$. Ch\u00fang ta t\u00ecm \u0111\u1ed9 d\u00e0i l\u1edbn nh\u1ea5t c\u1ee7a m\u1ed9t kh\u1ed1i \u0111\u01b0\u1ee3c \u0111\u1eb7t b\u00ean trong m\u1ed9t chu\u1ed7i con c\u00f3 \u0111\u1ed9 d\u00e0i n\u00e0y: $k$ l\u1edbn nh\u1ea5t sao cho $2^k \\le l$. Sau \u0111\u00f3, so s\u00e1nh hai chu\u1ed7i con c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c thay th\u1ebf b\u1eb1ng c\u00e1ch so s\u00e1nh hai kh\u1ed1i ch\u1ed3ng ch\u00e9o c\u00f3 \u0111\u1ed9 d\u00e0i $2^k$: tr\u01b0\u1edbc ti\u00ean b\u1ea1n c\u1ea7n so s\u00e1nh hai kh\u1ed1i b\u1eaft \u0111\u1ea7u b\u1eb1ng $i$ v\u00e0 $j$, v\u00e0 n\u1ebfu ch\u00fang b\u1eb1ng nhau th\u00ec h\u00e3y so s\u00e1nh hai kh\u1ed1i k\u1ebft th\u00fac \u1edf v\u1ecb tr\u00ed $i + l - 1$ v\u00e0 $j + l - 1$:</p> $$\\dots \\overbrace{\\underbrace{s_i \\dots s_{i+l-2^k} \\dots s_{i+2^k-1}}_{2^k} \\dots s_{i+l-1}}^{\\text{\u0111\u1ea7u ti\u00ean}} \\dots \\overbrace{\\underbrace{s_j \\dots s_{j+l-2^k} \\dots s_{j+2^k-1}}_{2^k} \\dots s_{j+l-1}}^{\\text{th\u1ee9 hai}} \\dots$$ $$\\dots \\overbrace{s_i \\dots \\underbrace{s_{i+l-2^k} \\dots s_{i+2^k-1} \\dots s_{i+l-1}}_{2^k}}^{\\text{\u0111\u1ea7u ti\u00ean}} \\dots \\overbrace{s_j \\dots \\underbrace{s_{j+l-2^k} \\dots s_{j+2^k-1} \\dots s_{j+l-1}}_{2^k}}^{\\text{th\u1ee9 hai}} \\dots$$ <p>\u0110\u00e2y l\u00e0 vi\u1ec7c th\u1ef1c hi\u1ec7n so s\u00e1nh. L\u01b0u \u00fd r\u1eb1ng ng\u01b0\u1eddi ta cho r\u1eb1ng h\u00e0m \u0111\u01b0\u1ee3c g\u1ecdi v\u1edbi $k$ \u0111\u00e3 \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n. $k$ c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ednh b\u1eb1ng $\\lfloor \\log l \\rfloor$, nh\u01b0ng hi\u1ec7u qu\u1ea3 h\u01a1n l\u00e0 t\u00ednh to\u00e1n tr\u01b0\u1edbc t\u1ea5t c\u1ea3 c\u00e1c gi\u00e1 tr\u1ecb $k$ cho m\u1ecdi $l$. Xem v\u00ed d\u1ee5 b\u00e0i vi\u1ebft v\u1ec1 B\u1ea3ng th\u01b0a (Sparse Table), s\u1eed d\u1ee5ng m\u1ed9t \u00fd t\u01b0\u1edfng t\u01b0\u01a1ng t\u1ef1 v\u00e0 t\u00ednh to\u00e1n t\u1ea5t c\u1ea3 c\u00e1c gi\u00e1 tr\u1ecb $\\log$.</p> <pre><code>int compare(int i, int j, int l, int k) {\n    pair&lt;int, int&gt; a = {c[k][i], c[k][(i+l-(1 &lt;&lt; k))%n]};\n    pair&lt;int, int&gt; b = {c[k][j], c[k][(j+l-(1 &lt;&lt; k))%n]};\n    return a == b ? 0 : a &lt; b ? -1 : 1;\n}\n</code></pre>","tags":["Translated"]},{"location":"string/suffix-array.html#longest-common-prefix-of-two-substrings-with-additional-memory","title":"Ti\u1ec1n t\u1ed1 chung d\u00e0i nh\u1ea5t c\u1ee7a hai chu\u1ed7i con v\u1edbi b\u1ed9 nh\u1edb b\u1ed5 sung (Longest common prefix of two substrings with additional memory)","text":"<p>\u0110\u1ed1i v\u1edbi m\u1ed9t chu\u1ed7i $s$ \u0111\u00e3 cho, ch\u00fang ta mu\u1ed1n t\u00ednh to\u00e1n ti\u1ec1n t\u1ed1 chung d\u00e0i nh\u1ea5t (LCP) c\u1ee7a hai h\u1eadu t\u1ed1 t\u00f9y \u00fd v\u1edbi v\u1ecb tr\u00ed $i$ v\u00e0 $j$.</p> <p>Ph\u01b0\u01a1ng ph\u00e1p \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 \u1edf \u0111\u00e2y s\u1eed d\u1ee5ng b\u1ed9 nh\u1edb b\u1ed5 sung $O(|s| \\log |s|)$. M\u1ed9t c\u00e1ch ti\u1ebfp c\u1eadn ho\u00e0n to\u00e0n kh\u00e1c s\u1ebd ch\u1ec9 s\u1eed d\u1ee5ng m\u1ed9t l\u01b0\u1ee3ng b\u1ed9 nh\u1edb tuy\u1ebfn t\u00ednh \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 trong ph\u1ea7n ti\u1ebfp theo.</p> <p>Ch\u00fang ta x\u00e2y d\u1ef1ng m\u1ea3ng h\u1eadu t\u1ed1 trong th\u1eddi gian $O(|s| \\log |s|)$, v\u00e0 ghi nh\u1edb c\u00e1c k\u1ebft qu\u1ea3 trung gian c\u1ee7a c\u00e1c m\u1ea3ng $c[]$ t\u1eeb m\u1ed7i l\u1ea7n l\u1eb7p.</p> <p>H\u00e3y t\u00ednh LCP cho hai h\u1eadu t\u1ed1 b\u1eaft \u0111\u1ea7u b\u1eb1ng $i$ v\u00e0 $j$. Ch\u00fang ta c\u00f3 th\u1ec3 so s\u00e1nh b\u1ea5t k\u1ef3 hai chu\u1ed7i con n\u00e0o c\u00f3 \u0111\u1ed9 d\u00e0i b\u1eb1ng l\u0169y th\u1eeba c\u1ee7a hai trong $O(1)$. \u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y, ch\u00fang ta so s\u00e1nh c\u00e1c chu\u1ed7i theo l\u0169y th\u1eeba c\u1ee7a hai (t\u1eeb l\u0169y th\u1eeba cao nh\u1ea5t \u0111\u1ebfn th\u1ea5p nh\u1ea5t) v\u00e0 n\u1ebfu c\u00e1c chu\u1ed7i con c\u00f3 \u0111\u1ed9 d\u00e0i n\u00e0y gi\u1ed1ng nhau, th\u00ec ch\u00fang ta th\u00eam \u0111\u1ed9 d\u00e0i b\u1eb1ng nhau v\u00e0o c\u00e2u tr\u1ea3 l\u1eddi v\u00e0 ti\u1ebfp t\u1ee5c ki\u1ec3m tra LCP \u1edf b\u00ean ph\u1ea3i c\u1ee7a ph\u1ea7n b\u1eb1ng nhau, t\u1ee9c l\u00e0 $i$ v\u00e0 $j$ \u0111\u01b0\u1ee3c th\u00eam b\u1edfi l\u0169y th\u1eeba hi\u1ec7n t\u1ea1i c\u1ee7a hai.</p> <pre><code>int lcp(int i, int j) {\n    int ans = 0;\n    for (int k = log_n; k &gt;= 0; k--) {\n        if (c[k][i % n] == c[k][j % n]) {\n            ans += 1 &lt;&lt; k;\n            i += 1 &lt;&lt; k;\n            j += 1 &lt;&lt; k;\n        }\n    }\n    return ans;\n}\n</code></pre> <p>\u1ede \u0111\u00e2y <code>log_n</code> bi\u1ec3u th\u1ecb m\u1ed9t h\u1eb1ng s\u1ed1 b\u1eb1ng logarit c\u1ee7a $n$ trong c\u01a1 s\u1ed1 $2$ l\u00e0m tr\u00f2n xu\u1ed1ng.</p>","tags":["Translated"]},{"location":"string/suffix-array.html#longest-common-prefix-of-two-substrings-without-additional-memory","title":"Ti\u1ec1n t\u1ed1 chung d\u00e0i nh\u1ea5t c\u1ee7a hai chu\u1ed7i con kh\u00f4ng c\u00f3 b\u1ed9 nh\u1edb b\u1ed5 sung (Longest common prefix of two substrings without additional memory)","text":"<p>Ch\u00fang ta c\u00f3 c\u00f9ng nhi\u1ec7m v\u1ee5 nh\u01b0 trong ph\u1ea7n tr\u01b0\u1edbc. Ch\u00fang ta ph\u1ea3i t\u00ednh to\u00e1n ti\u1ec1n t\u1ed1 chung d\u00e0i nh\u1ea5t (LCP) cho hai h\u1eadu t\u1ed1 c\u1ee7a m\u1ed9t chu\u1ed7i $s$.</p> <p>Kh\u00f4ng gi\u1ed1ng nh\u01b0 ph\u01b0\u01a1ng ph\u00e1p tr\u01b0\u1edbc, ph\u01b0\u01a1ng ph\u00e1p n\u00e0y s\u1ebd ch\u1ec9 s\u1eed d\u1ee5ng b\u1ed9 nh\u1edb $O(|s|)$. K\u1ebft qu\u1ea3 c\u1ee7a qu\u00e1 tr\u00ecnh ti\u1ec1n x\u1eed l\u00fd s\u1ebd l\u00e0 m\u1ed9t m\u1ea3ng (b\u1ea3n th\u00e2n n\u00f3 l\u00e0 m\u1ed9t ngu\u1ed3n th\u00f4ng tin quan tr\u1ecdng v\u1ec1 chu\u1ed7i, v\u00e0 do \u0111\u00f3 c\u0169ng \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 gi\u1ea3i quy\u1ebft c\u00e1c t\u00e1c v\u1ee5 kh\u00e1c). C\u00e1c truy v\u1ea5n LCP c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c tr\u1ea3 l\u1eddi b\u1eb1ng c\u00e1ch th\u1ef1c hi\u1ec7n c\u00e1c truy v\u1ea5n RMQ (truy v\u1ea5n ph\u1ea1m vi t\u1ed1i thi\u1ec3u) trong m\u1ea3ng n\u00e0y, v\u00ec v\u1eady \u0111\u1ed1i v\u1edbi c\u00e1c tri\u1ec3n khai kh\u00e1c nhau, c\u00f3 th\u1ec3 \u0111\u1ea1t \u0111\u01b0\u1ee3c th\u1eddi gian truy v\u1ea5n logarit v\u00e0 th\u1eadm ch\u00ed h\u1eb1ng s\u1ed1.</p> <p>C\u01a1 s\u1edf cho thu\u1eadt to\u00e1n n\u00e0y l\u00e0 \u00fd t\u01b0\u1edfng sau: ch\u00fang ta s\u1ebd t\u00ednh to\u00e1n ti\u1ec1n t\u1ed1 chung d\u00e0i nh\u1ea5t cho m\u1ed7i c\u1eb7p h\u1eadu t\u1ed1 li\u1ec1n k\u1ec1 trong th\u1ee9 t\u1ef1 \u0111\u00e3 s\u1eafp x\u1ebfp. N\u00f3i c\u00e1ch kh\u00e1c, ch\u00fang ta x\u00e2y d\u1ef1ng m\u1ed9t m\u1ea3ng $\\text{lcp}[0 \\dots n-2]$, trong \u0111\u00f3 $\\text{lcp}[i]$ b\u1eb1ng \u0111\u1ed9 d\u00e0i c\u1ee7a ti\u1ec1n t\u1ed1 chung d\u00e0i nh\u1ea5t c\u1ee7a c\u00e1c h\u1eadu t\u1ed1 b\u1eaft \u0111\u1ea7u t\u1ea1i $p[i]$ v\u00e0 $p[i+1]$. M\u1ea3ng n\u00e0y s\u1ebd cho ch\u00fang ta c\u00e2u tr\u1ea3 l\u1eddi cho b\u1ea5t k\u1ef3 hai h\u1eadu t\u1ed1 li\u1ec1n k\u1ec1 n\u00e0o c\u1ee7a chu\u1ed7i. Sau \u0111\u00f3, c\u00e2u tr\u1ea3 l\u1eddi cho hai h\u1eadu t\u1ed1 t\u00f9y \u00fd, kh\u00f4ng nh\u1ea5t thi\u1ebft l\u00e0 l\u00e1ng gi\u1ec1ng, c\u00f3 th\u1ec3 thu \u0111\u01b0\u1ee3c t\u1eeb m\u1ea3ng n\u00e0y. Trong th\u1ef1c t\u1ebf, h\u00e3y \u0111\u1ec3 y\u00eau c\u1ea7u t\u00ednh to\u00e1n LCP c\u1ee7a c\u00e1c h\u1eadu t\u1ed1 $p[i]$ v\u00e0 $p[j]$. Sau \u0111\u00f3 c\u00e2u tr\u1ea3 l\u1eddi cho truy v\u1ea5n n\u00e0y s\u1ebd l\u00e0 $\\min(lcp[i],~ lcp[i+1],~ \\dots,~ lcp[j-1])$.</p> <p>Do \u0111\u00f3, n\u1ebfu ch\u00fang ta c\u00f3 m\u1ed9t m\u1ea3ng $\\text{lcp}$ nh\u01b0 v\u1eady, th\u00ec v\u1ea5n \u0111\u1ec1 \u0111\u01b0\u1ee3c gi\u1ea3m xu\u1ed1ng RMQ, c\u00f3 r\u1ea5t nhi\u1ec1u gi\u1ea3i ph\u00e1p kh\u00e1c nhau v\u1edbi \u0111\u1ed9 ph\u1ee9c t\u1ea1p kh\u00e1c nhau.</p> <p>V\u00ec v\u1eady, nhi\u1ec7m v\u1ee5 ch\u00ednh l\u00e0 x\u00e2y d\u1ef1ng m\u1ea3ng $\\text{lcp}$ n\u00e0y. Ch\u00fang ta s\u1ebd s\u1eed d\u1ee5ng thu\u1eadt to\u00e1n Kasai, c\u00f3 th\u1ec3 t\u00ednh to\u00e1n m\u1ea3ng n\u00e0y trong th\u1eddi gian $O(n)$.</p> <p>H\u00e3y nh\u00ecn v\u00e0o hai h\u1eadu t\u1ed1 li\u1ec1n k\u1ec1 trong th\u1ee9 t\u1ef1 \u0111\u00e3 s\u1eafp x\u1ebfp (th\u1ee9 t\u1ef1 c\u1ee7a m\u1ea3ng h\u1eadu t\u1ed1). H\u00e3y \u0111\u1ec3 v\u1ecb tr\u00ed b\u1eaft \u0111\u1ea7u c\u1ee7a ch\u00fang l\u00e0 $i$ v\u00e0 $j$ v\u00e0 $\\text{lcp}$ c\u1ee7a ch\u00fang b\u1eb1ng $k &gt; 0$. N\u1ebfu ch\u00fang ta lo\u1ea1i b\u1ecf ch\u1eef c\u00e1i \u0111\u1ea7u ti\u00ean c\u1ee7a c\u1ea3 hai h\u1eadu t\u1ed1 - t\u1ee9c l\u00e0 ch\u00fang ta l\u1ea5y c\u00e1c h\u1eadu t\u1ed1 $i+1$ v\u00e0 $j+1$ - th\u00ec r\u00f5 r\u00e0ng l\u00e0 $\\text{lcp}$ c\u1ee7a hai h\u1eadu t\u1ed1 n\u00e0y l\u00e0 $k - 1$. Tuy nhi\u00ean, ch\u00fang ta kh\u00f4ng th\u1ec3 s\u1eed d\u1ee5ng gi\u00e1 tr\u1ecb n\u00e0y v\u00e0 ghi n\u00f3 v\u00e0o m\u1ea3ng $\\text{lcp}$, b\u1edfi v\u00ec hai h\u1eadu t\u1ed1 n\u00e0y c\u00f3 th\u1ec3 kh\u00f4ng n\u1eb1m c\u1ea1nh nhau trong th\u1ee9 t\u1ef1 \u0111\u00e3 s\u1eafp x\u1ebfp. H\u1eadu t\u1ed1 $i+1$ t\u1ea5t nhi\u00ean s\u1ebd nh\u1ecf h\u01a1n h\u1eadu t\u1ed1 $j+1$, nh\u01b0ng c\u00f3 th\u1ec3 c\u00f3 m\u1ed9t s\u1ed1 h\u1eadu t\u1ed1 \u1edf gi\u1eefa ch\u00fang. Tuy nhi\u00ean, v\u00ec ch\u00fang ta bi\u1ebft r\u1eb1ng LCP gi\u1eefa hai h\u1eadu t\u1ed1 l\u00e0 gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c chuy\u1ec3n \u0111\u1ed5i, ch\u00fang ta c\u0169ng bi\u1ebft r\u1eb1ng LCP gi\u1eefa b\u1ea5t k\u1ef3 hai c\u1eb7p n\u00e0o trong kho\u1ea3ng \u0111\u00f3 \u00edt nh\u1ea5t ph\u1ea3i l\u00e0 $k-1$, \u0111\u1eb7c bi\u1ec7t l\u00e0 gi\u1eefa $i+1$ v\u00e0 h\u1eadu t\u1ed1 ti\u1ebfp theo. V\u00e0 c\u00f3 th\u1ec3 n\u00f3 c\u00f3 th\u1ec3 l\u1edbn h\u01a1n.</p> <p>B\u00e2y gi\u1edd ch\u00fang ta \u0111\u00e3 c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n thu\u1eadt to\u00e1n. Ch\u00fang ta s\u1ebd l\u1eb7p qua c\u00e1c h\u1eadu t\u1ed1 theo th\u1ee9 t\u1ef1 \u0111\u1ed9 d\u00e0i c\u1ee7a ch\u00fang. B\u1eb1ng c\u00e1ch n\u00e0y, ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng l\u1ea1i gi\u00e1 tr\u1ecb cu\u1ed1i c\u00f9ng $k$, v\u00ec \u0111i t\u1eeb h\u1eadu t\u1ed1 $i$ \u0111\u1ebfn h\u1eadu t\u1ed1 $i+1$ ho\u00e0n to\u00e0n gi\u1ed1ng nh\u01b0 lo\u1ea1i b\u1ecf ch\u1eef c\u00e1i \u0111\u1ea7u ti\u00ean. Ch\u00fang ta s\u1ebd c\u1ea7n m\u1ed9t m\u1ea3ng b\u1ed5 sung $\\text{rank}$, s\u1ebd cung c\u1ea5p cho ch\u00fang ta v\u1ecb tr\u00ed c\u1ee7a m\u1ed9t h\u1eadu t\u1ed1 trong danh s\u00e1ch c\u00e1c h\u1eadu t\u1ed1 \u0111\u00e3 s\u1eafp x\u1ebfp.</p> <pre><code>vector&lt;int&gt; lcp_construction(string const&amp; s, vector&lt;int&gt; const&amp; p) {\n    int n = s.size();\n    vector&lt;int&gt; rank(n, 0);\n    for (int i = 0; i &lt; n; i++)\n        rank[p[i]] = i;\n\n    int k = 0;\n    vector&lt;int&gt; lcp(n-1, 0);\n    for (int i = 0; i &lt; n; i++) {\n        if (rank[i] == n - 1) {\n            k = 0;\n            continue;\n        }\n        int j = p[rank[i] + 1];\n        while (i + k &lt; n &amp;&amp; j + k &lt; n &amp;&amp; s[i+k] == s[j+k])\n            k++;\n        lcp[rank[i]] = k;\n        if (k)\n            k--;\n    }\n    return lcp;\n}\n</code></pre> <p>R\u1ea5t d\u1ec5 th\u1ea5y r\u1eb1ng ch\u00fang ta gi\u1ea3m $k$ t\u1ed1i \u0111a $O(n)$ l\u1ea7n (m\u1ed7i l\u1ea7n l\u1eb7p t\u1ed1i \u0111a m\u1ed9t l\u1ea7n, ngo\u1ea1i tr\u1eeb $\\text{rank}[i] == n-1$, n\u01a1i ch\u00fang ta tr\u1ef1c ti\u1ebfp \u0111\u1eb7t l\u1ea1i n\u00f3 th\u00e0nh $0$), v\u00e0 LCP gi\u1eefa hai chu\u1ed7i t\u1ed1i \u0111a l\u00e0 $n-1$, ch\u00fang ta c\u0169ng s\u1ebd t\u0103ng $k$ ch\u1ec9 $O(n)$ l\u1ea7n. Do \u0111\u00f3 thu\u1eadt to\u00e1n ch\u1ea1y trong th\u1eddi gian $O(n)$.</p>","tags":["Translated"]},{"location":"string/suffix-array.html#number-of-different-substrings","title":"S\u1ed1 l\u01b0\u1ee3ng chu\u1ed7i con kh\u00e1c nhau (Number of different substrings)","text":"<p>Ch\u00fang ta ti\u1ec1n x\u1eed l\u00fd chu\u1ed7i $s$ b\u1eb1ng c\u00e1ch t\u00ednh to\u00e1n m\u1ea3ng h\u1eadu t\u1ed1 v\u00e0 m\u1ea3ng LCP. S\u1eed d\u1ee5ng th\u00f4ng tin n\u00e0y, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh to\u00e1n s\u1ed1 l\u01b0\u1ee3ng chu\u1ed7i con kh\u00e1c nhau trong chu\u1ed7i.</p> <p>\u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y, ch\u00fang ta s\u1ebd suy ngh\u0129 v\u1ec1 nh\u1eefng chu\u1ed7i con m\u1edbi n\u00e0o b\u1eaft \u0111\u1ea7u t\u1ea1i v\u1ecb tr\u00ed $p[0]$, sau \u0111\u00f3 t\u1ea1i $p[1]$, v.v. Trong th\u1ef1c t\u1ebf, ch\u00fang ta l\u1ea5y c\u00e1c h\u1eadu t\u1ed1 theo th\u1ee9 t\u1ef1 \u0111\u00e3 s\u1eafp x\u1ebfp v\u00e0 xem ti\u1ec1n t\u1ed1 n\u00e0o cung c\u1ea5p chu\u1ed7i con m\u1edbi. Do \u0111\u00f3, ch\u00fang ta s\u1ebd kh\u00f4ng v\u00f4 t\u00ecnh b\u1ecf qua b\u1ea5t k\u1ef3 c\u00e1i n\u00e0o.</p> <p>V\u00ec c\u00e1c h\u1eadu t\u1ed1 \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp, n\u00ean r\u00f5 r\u00e0ng l\u00e0 h\u1eadu t\u1ed1 hi\u1ec7n t\u1ea1i $p[i]$ s\u1ebd cung c\u1ea5p c\u00e1c chu\u1ed7i con m\u1edbi cho t\u1ea5t c\u1ea3 c\u00e1c ti\u1ec1n t\u1ed1 c\u1ee7a n\u00f3, ngo\u1ea1i tr\u1eeb c\u00e1c ti\u1ec1n t\u1ed1 tr\u00f9ng v\u1edbi h\u1eadu t\u1ed1 $p[i-1]$. Do \u0111\u00f3, t\u1ea5t c\u1ea3 c\u00e1c ti\u1ec1n t\u1ed1 c\u1ee7a n\u00f3 ngo\u1ea1i tr\u1eeb ti\u1ec1n t\u1ed1 $\\text{lcp}[i-1]$ \u0111\u1ea7u ti\u00ean. V\u00ec \u0111\u1ed9 d\u00e0i c\u1ee7a h\u1eadu t\u1ed1 hi\u1ec7n t\u1ea1i l\u00e0 $n - p[i]$, $n - p[i] - \\text{lcp}[i-1]$ ti\u1ec1n t\u1ed1 m\u1edbi b\u1eaft \u0111\u1ea7u t\u1ea1i $p[i]$. T\u1ed5ng k\u1ebft tr\u00ean t\u1ea5t c\u1ea3 c\u00e1c h\u1eadu t\u1ed1, ch\u00fang ta c\u00f3 c\u00e2u tr\u1ea3 l\u1eddi cu\u1ed1i c\u00f9ng:</p> $$\\sum_{i=0}^{n-1} (n - p[i]) - \\sum_{i=0}^{n-2} \\text{lcp}[i] = \\frac{n^2 + n}{2} - \\sum_{i=0}^{n-2} \\text{lcp}[i]$$","tags":["Translated"]},{"location":"string/suffix-array.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>Uva 760 - DNA Sequencing</li> <li>Uva 1223 - Editor</li> <li>Codechef - Tandem</li> <li>Codechef - Substrings and Repetitions</li> <li>Codechef - Entangled Strings</li> <li>Codeforces - Martian Strings</li> <li>Codeforces - Little Elephant and Strings</li> <li>SPOJ - Ada and Terramorphing</li> <li>SPOJ - Ada and Substring</li> <li>UVA - 1227 - The longest constant gene</li> <li>SPOJ - Longest Common Substring</li> <li>UVA 11512 - GATTACA</li> <li>LA 7502 - Suffixes and Palindromes</li> <li>GYM - Por Costel and the Censorship Committee</li> <li>UVA 1254 - Top 10</li> <li>UVA 12191 - File Recover</li> <li>UVA 12206 - Stammering Aliens</li> <li>Codechef - Jarvis and LCP</li> <li>LA 3943 - Liking's Letter</li> <li>UVA 11107 - Life Forms</li> <li>UVA 12974 - Exquisite Strings</li> <li>UVA 10526 - Intellectual Property</li> <li>UVA 12338 - Anti-Rhyme Pairs</li> <li>UVA 12191 - File Recover</li> <li>SPOJ - Suffix Array</li> <li>LA 4513 - Stammering Aliens</li> <li>SPOJ - LCS2</li> <li>Codeforces - Fake News (hard)</li> <li>SPOJ - Longest Commong Substring</li> <li>SPOJ - Lexicographical Substring Search</li> <li>Codeforces - Forbidden Indices</li> <li>Codeforces - Tricky and Clever Password</li> <li>LA 6856 - Circle of digits</li> </ul>","tags":["Translated"]},{"location":"string/suffix-automaton.html","title":"Suffix Automaton (Suffix Automaton)","text":"<p>Suffix automaton l\u00e0 m\u1ed9t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u m\u1ea1nh m\u1ebd cho ph\u00e9p gi\u1ea3i quy\u1ebft nhi\u1ec1u v\u1ea5n \u0111\u1ec1 li\u00ean quan \u0111\u1ebfn chu\u1ed7i.</p> <p>V\u00ed d\u1ee5: b\u1ea1n c\u00f3 th\u1ec3 t\u00ecm ki\u1ebfm t\u1ea5t c\u1ea3 c\u00e1c l\u1ea7n xu\u1ea5t hi\u1ec7n c\u1ee7a m\u1ed9t chu\u1ed7i trong chu\u1ed7i kh\u00e1c ho\u1eb7c \u0111\u1ebfm s\u1ed1 l\u01b0\u1ee3ng c\u00e1c chu\u1ed7i con kh\u00e1c nhau c\u1ee7a m\u1ed9t chu\u1ed7i \u0111\u00e3 cho. C\u1ea3 hai nhi\u1ec7m v\u1ee5 \u0111\u1ec1u c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i quy\u1ebft trong th\u1eddi gian tuy\u1ebfn t\u00ednh v\u1edbi s\u1ef1 tr\u1ee3 gi\u00fap c\u1ee7a suffix automaton.</p> <p>V\u1ec1 m\u1eb7t tr\u1ef1c quan, suffix automaton c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c hi\u1ec3u l\u00e0 m\u1ed9t d\u1ea1ng n\u00e9n c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c chu\u1ed7i con c\u1ee7a m\u1ed9t chu\u1ed7i nh\u1ea5t \u0111\u1ecbnh. M\u1ed9t th\u1ef1c t\u1ebf \u1ea5n t\u01b0\u1ee3ng l\u00e0 suffix automaton ch\u1ee9a t\u1ea5t c\u1ea3 th\u00f4ng tin n\u00e0y \u1edf d\u1ea1ng n\u00e9n cao. \u0110\u1ed1i v\u1edbi chu\u1ed7i c\u00f3 \u0111\u1ed9 d\u00e0i $n$, n\u00f3 ch\u1ec9 y\u00eau c\u1ea7u b\u1ed9 nh\u1edb $O(n)$. H\u01a1n n\u1eefa, n\u00f3 c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c x\u00e2y d\u1ef1ng trong th\u1eddi gian $O(n)$ (n\u1ebfu ch\u00fang ta coi k\u00edch th\u01b0\u1edbc $k$ c\u1ee7a b\u1ea3ng ch\u1eef c\u00e1i l\u00e0 h\u1eb1ng s\u1ed1), n\u1ebfu kh\u00f4ng th\u00ec c\u1ea3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian v\u00e0 b\u1ed9 nh\u1edb s\u1ebd l\u00e0 $O(n \\log k)$.</p> <p>T\u00ednh tuy\u1ebfn t\u00ednh c\u1ee7a k\u00edch th\u01b0\u1edbc suffix automaton \u0111\u01b0\u1ee3c ph\u00e1t hi\u1ec7n l\u1ea7n \u0111\u1ea7u ti\u00ean v\u00e0o n\u0103m 1983 b\u1edfi Blumer v\u00e0 c\u1ed9ng s\u1ef1, v\u00e0 v\u00e0o n\u0103m 1985, c\u00e1c thu\u1eadt to\u00e1n tuy\u1ebfn t\u00ednh \u0111\u1ea7u ti\u00ean \u0111\u1ec3 x\u00e2y d\u1ef1ng \u0111\u00e3 \u0111\u01b0\u1ee3c tr\u00ecnh b\u00e0y b\u1edfi Crochemore v\u00e0 Blumer.</p>","tags":["Translated"]},{"location":"string/suffix-automaton.html#definition-of-a-suffix-automaton","title":"\u0110\u1ecbnh ngh\u0129a suffix automaton (Definition of a suffix automaton)","text":"<p>Suffix automaton cho m\u1ed9t chu\u1ed7i $s$ nh\u1ea5t \u0111\u1ecbnh l\u00e0 m\u1ed9t DFA (deterministic finite automaton - automaton \u0111\u01a1n \u0111\u1ecbnh h\u1eefu h\u1ea1n) t\u1ed1i thi\u1ec3u ch\u1ea5p nh\u1eadn t\u1ea5t c\u1ea3 c\u00e1c h\u1eadu t\u1ed1 c\u1ee7a chu\u1ed7i $s$.</p> <p>N\u00f3i c\u00e1ch kh\u00e1c:</p> <ul> <li>Suffix automaton l\u00e0 m\u1ed9t \u0111\u1ed3 th\u1ecb c\u00f3 h\u01b0\u1edbng kh\u00f4ng c\u00f3 chu tr\u00ecnh.     C\u00e1c \u0111\u1ec9nh \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 tr\u1ea1ng th\u00e1i (states) v\u00e0 c\u00e1c c\u1ea1nh \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 chuy\u1ec3n \u0111\u1ed5i (transitions) gi\u1eefa c\u00e1c tr\u1ea1ng th\u00e1i.</li> <li>M\u1ed9t trong nh\u1eefng tr\u1ea1ng th\u00e1i $t_0$ l\u00e0 tr\u1ea1ng th\u00e1i ban \u0111\u1ea7u, v\u00e0 n\u00f3 ph\u1ea3i l\u00e0 ngu\u1ed3n c\u1ee7a \u0111\u1ed3 th\u1ecb (t\u1ea5t c\u1ea3 c\u00e1c tr\u1ea1ng th\u00e1i kh\u00e1c \u0111\u1ec1u c\u00f3 th\u1ec3 truy c\u1eadp \u0111\u01b0\u1ee3c t\u1eeb $t_0$).</li> <li>M\u1ed7i chuy\u1ec3n \u0111\u1ed5i \u0111\u01b0\u1ee3c g\u1eafn nh\u00e3n v\u1edbi m\u1ed9t s\u1ed1 k\u00fd t\u1ef1.     T\u1ea5t c\u1ea3 c\u00e1c chuy\u1ec3n \u0111\u1ed5i b\u1eaft ngu\u1ed3n t\u1eeb m\u1ed9t tr\u1ea1ng th\u00e1i ph\u1ea3i c\u00f3 nh\u00e3n kh\u00e1c nhau.</li> <li>M\u1ed9t ho\u1eb7c nhi\u1ec1u tr\u1ea1ng th\u00e1i \u0111\u01b0\u1ee3c \u0111\u00e1nh d\u1ea5u l\u00e0 tr\u1ea1ng th\u00e1i k\u1ebft th\u00fac (terminal states).     N\u1ebfu ch\u00fang ta b\u1eaft \u0111\u1ea7u t\u1eeb tr\u1ea1ng th\u00e1i ban \u0111\u1ea7u $t_0$ v\u00e0 di chuy\u1ec3n d\u1ecdc theo c\u00e1c chuy\u1ec3n \u0111\u1ed5i \u0111\u1ebfn tr\u1ea1ng th\u00e1i k\u1ebft th\u00fac, th\u00ec c\u00e1c nh\u00e3n c\u1ee7a c\u00e1c chuy\u1ec3n \u0111\u1ed5i \u0111\u00e3 qua ph\u1ea3i \u0111\u00e1nh v\u1ea7n m\u1ed9t trong c\u00e1c h\u1eadu t\u1ed1 c\u1ee7a chu\u1ed7i $s$.     M\u1ed7i h\u1eadu t\u1ed1 c\u1ee7a $s$ ph\u1ea3i c\u00f3 th\u1ec3 \u0111\u00e1nh v\u1ea7n \u0111\u01b0\u1ee3c b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng m\u1ed9t \u0111\u01b0\u1eddng d\u1eabn t\u1eeb $t_0$ \u0111\u1ebfn m\u1ed9t tr\u1ea1ng th\u00e1i k\u1ebft th\u00fac.</li> <li>Suffix automaton ch\u1ee9a s\u1ed1 l\u01b0\u1ee3ng \u0111\u1ec9nh t\u1ed1i thi\u1ec3u trong s\u1ed1 t\u1ea5t c\u1ea3 c\u00e1c automaton th\u1ecfa m\u00e3n c\u00e1c \u0111i\u1ec1u ki\u1ec7n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 \u1edf tr\u00ean.</li> </ul>","tags":["Translated"]},{"location":"string/suffix-automaton.html#substring-property","title":"Thu\u1ed9c t\u00ednh chu\u1ed7i con (Substring property)","text":"<p>Thu\u1ed9c t\u00ednh \u0111\u01a1n gi\u1ea3n v\u00e0 quan tr\u1ecdng nh\u1ea5t c\u1ee7a suffix automaton l\u00e0 n\u00f3 ch\u1ee9a th\u00f4ng tin v\u1ec1 t\u1ea5t c\u1ea3 c\u00e1c chu\u1ed7i con c\u1ee7a chu\u1ed7i $s$. B\u1ea5t k\u1ef3 \u0111\u01b0\u1eddng d\u1eabn n\u00e0o b\u1eaft \u0111\u1ea7u \u1edf tr\u1ea1ng th\u00e1i ban \u0111\u1ea7u $t_0$, n\u1ebfu ch\u00fang ta vi\u1ebft ra c\u00e1c nh\u00e3n c\u1ee7a c\u00e1c chuy\u1ec3n \u0111\u1ed5i, s\u1ebd t\u1ea1o th\u00e0nh m\u1ed9t chu\u1ed7i con c\u1ee7a $s$. V\u00e0 ng\u01b0\u1ee3c l\u1ea1i, m\u1ecdi chu\u1ed7i con c\u1ee7a $s$ t\u01b0\u01a1ng \u1ee9ng v\u1edbi m\u1ed9t \u0111\u01b0\u1eddng d\u1eabn nh\u1ea5t \u0111\u1ecbnh b\u1eaft \u0111\u1ea7u t\u1ea1i $t_0$.</p> <p>\u0110\u1ec3 \u0111\u01a1n gi\u1ea3n h\u00f3a c\u00e1c gi\u1ea3i th\u00edch, ch\u00fang t\u00f4i s\u1ebd n\u00f3i r\u1eb1ng chu\u1ed7i con t\u01b0\u01a1ng \u1ee9ng v\u1edbi \u0111\u01b0\u1eddng d\u1eabn \u0111\u00f3 (b\u1eaft \u0111\u1ea7u t\u1ea1i $t_0$ v\u00e0 c\u00e1c nh\u00e3n \u0111\u00e1nh v\u1ea7n chu\u1ed7i con). V\u00e0 ng\u01b0\u1ee3c l\u1ea1i, ch\u00fang t\u00f4i n\u00f3i r\u1eb1ng b\u1ea5t k\u1ef3 \u0111\u01b0\u1eddng d\u1eabn n\u00e0o c\u0169ng t\u01b0\u01a1ng \u1ee9ng v\u1edbi chu\u1ed7i \u0111\u01b0\u1ee3c \u0111\u00e1nh v\u1ea7n b\u1edfi c\u00e1c nh\u00e3n c\u1ee7a n\u00f3.</p> <p>M\u1ed9t ho\u1eb7c nhi\u1ec1u \u0111\u01b0\u1eddng d\u1eabn c\u00f3 th\u1ec3 d\u1eabn \u0111\u1ebfn m\u1ed9t tr\u1ea1ng th\u00e1i. Do \u0111\u00f3, ch\u00fang t\u00f4i s\u1ebd n\u00f3i r\u1eb1ng m\u1ed9t tr\u1ea1ng th\u00e1i t\u01b0\u01a1ng \u1ee9ng v\u1edbi t\u1eadp h\u1ee3p c\u00e1c chu\u1ed7i, t\u01b0\u01a1ng \u1ee9ng v\u1edbi c\u00e1c \u0111\u01b0\u1eddng d\u1eabn n\u00e0y.</p>","tags":["Translated"]},{"location":"string/suffix-automaton.html#examples-of-constructed-suffix-automata","title":"V\u00ed d\u1ee5 v\u1ec1 suffix automata \u0111\u00e3 x\u00e2y d\u1ef1ng (Examples of constructed suffix automata)","text":"<p>\u1ede \u0111\u00e2y ch\u00fang t\u00f4i s\u1ebd hi\u1ec3n th\u1ecb m\u1ed9t s\u1ed1 v\u00ed d\u1ee5 v\u1ec1 suffix automata cho m\u1ed9t s\u1ed1 chu\u1ed7i \u0111\u01a1n gi\u1ea3n.</p> <p>Ch\u00fang t\u00f4i s\u1ebd bi\u1ec3u th\u1ecb tr\u1ea1ng th\u00e1i ban \u0111\u1ea7u b\u1eb1ng m\u00e0u xanh lam v\u00e0 c\u00e1c tr\u1ea1ng th\u00e1i k\u1ebft th\u00fac b\u1eb1ng m\u00e0u xanh l\u1ee5c.</p> <p>\u0110\u1ed1i v\u1edbi chu\u1ed7i $s =~ \\text{\"\"}$:</p> <p></p> <p>\u0110\u1ed1i v\u1edbi chu\u1ed7i $s =~ \\text{\"a\"}$:</p> <p></p> <p>\u0110\u1ed1i v\u1edbi chu\u1ed7i $s =~ \\text{\"aa\"}$:</p> <p></p> <p>\u0110\u1ed1i v\u1edbi chu\u1ed7i $s =~ \\text{\"ab\"}$:</p> <p></p> <p>\u0110\u1ed1i v\u1edbi chu\u1ed7i $s =~ \\text{\"aba\"}$:</p> <p></p> <p>\u0110\u1ed1i v\u1edbi chu\u1ed7i $s =~ \\text{\"abb\"}$:</p> <p></p> <p>\u0110\u1ed1i v\u1edbi chu\u1ed7i $s =~ \\text{\"abbb\"}$:</p> <p></p>","tags":["Translated"]},{"location":"string/suffix-automaton.html#construction-in-linear-time","title":"X\u00e2y d\u1ef1ng trong th\u1eddi gian tuy\u1ebfn t\u00ednh (Construction in linear time)","text":"<p>Tr\u01b0\u1edbc khi m\u00f4 t\u1ea3 thu\u1eadt to\u00e1n \u0111\u1ec3 x\u00e2y d\u1ef1ng m\u1ed9t suffix automaton trong th\u1eddi gian tuy\u1ebfn t\u00ednh, ch\u00fang ta c\u1ea7n gi\u1edbi thi\u1ec7u m\u1ed9t v\u00e0i kh\u00e1i ni\u1ec7m m\u1edbi v\u00e0 c\u00e1c b\u1eb1ng ch\u1ee9ng \u0111\u01a1n gi\u1ea3n, s\u1ebd r\u1ea5t quan tr\u1ecdng trong vi\u1ec7c t\u00ecm hi\u1ec3u vi\u1ec7c x\u00e2y d\u1ef1ng.</p>","tags":["Translated"]},{"location":"string/suffix-automaton.html#end-positions-endpos","title":"V\u1ecb tr\u00ed k\u1ebft th\u00fac $endpos$ (End positions $endpos$)","text":"<p>X\u00e9t b\u1ea5t k\u1ef3 chu\u1ed7i con kh\u00f4ng r\u1ed7ng $t$ n\u00e0o c\u1ee7a chu\u1ed7i $s$. Ch\u00fang t\u00f4i s\u1ebd k\u00fd hi\u1ec7u v\u1edbi $endpos(t)$ t\u1eadp h\u1ee3p t\u1ea5t c\u1ea3 c\u00e1c v\u1ecb tr\u00ed trong chu\u1ed7i $s$, trong \u0111\u00f3 c\u00e1c l\u1ea7n xu\u1ea5t hi\u1ec7n c\u1ee7a $t$ k\u1ebft th\u00fac. V\u00ed d\u1ee5: ch\u00fang ta c\u00f3 $endpos(\\text{\"bc\"}) = \\{2, 4\\}$ cho chu\u1ed7i $\\text{\"abcbc\"}$.</p> <p>Ch\u00fang t\u00f4i s\u1ebd g\u1ecdi hai chu\u1ed7i con $t_1$ v\u00e0 $t_2$ l\u00e0 $endpos$-t\u01b0\u01a1ng \u0111\u01b0\u01a1ng, n\u1ebfu t\u1eadp h\u1ee3p k\u1ebft th\u00fac c\u1ee7a ch\u00fang tr\u00f9ng nhau: $endpos(t_1) = endpos(t_2)$. Do \u0111\u00f3, t\u1ea5t c\u1ea3 c\u00e1c chu\u1ed7i con kh\u00f4ng r\u1ed7ng c\u1ee7a chu\u1ed7i $s$ c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c ph\u00e2n t\u00e1ch th\u00e0nh m\u1ed9t s\u1ed1 l\u1edbp t\u01b0\u01a1ng \u0111\u01b0\u01a1ng theo t\u1eadp h\u1ee3p $endpos$ c\u1ee7a ch\u00fang.</p> <p>H\u00f3a ra, trong m\u1ed9t m\u00e1y h\u1eadu t\u1ed1, c\u00e1c chu\u1ed7i con $endpos$-t\u01b0\u01a1ng \u0111\u01b0\u01a1ng t\u01b0\u01a1ng \u1ee9ng v\u1edbi c\u00f9ng m\u1ed9t tr\u1ea1ng th\u00e1i. N\u00f3i c\u00e1ch kh\u00e1c, s\u1ed1 l\u01b0\u1ee3ng tr\u1ea1ng th\u00e1i trong suffix automaton b\u1eb1ng s\u1ed1 l\u01b0\u1ee3ng c\u00e1c l\u1edbp t\u01b0\u01a1ng \u0111\u01b0\u01a1ng trong t\u1ea5t c\u1ea3 c\u00e1c chu\u1ed7i con, c\u1ed9ng v\u1edbi tr\u1ea1ng th\u00e1i ban \u0111\u1ea7u. M\u1ed7i tr\u1ea1ng th\u00e1i c\u1ee7a m\u1ed9t suffix automaton t\u01b0\u01a1ng \u1ee9ng v\u1edbi m\u1ed9t ho\u1eb7c nhi\u1ec1u chu\u1ed7i con c\u00f3 c\u00f9ng gi\u00e1 tr\u1ecb $endpos$.</p> <p>Sau n\u00e0y ch\u00fang t\u00f4i s\u1ebd m\u00f4 t\u1ea3 thu\u1eadt to\u00e1n x\u00e2y d\u1ef1ng s\u1eed d\u1ee5ng gi\u1ea3 \u0111\u1ecbnh n\u00e0y. Sau \u0111\u00f3 ch\u00fang ta s\u1ebd th\u1ea5y, t\u1ea5t c\u1ea3 c\u00e1c thu\u1ed9c t\u00ednh c\u1ea7n thi\u1ebft c\u1ee7a m\u1ed9t suffix automaton, ngo\u1ea1i tr\u1eeb t\u00ednh t\u1ed1i thi\u1ec3u, \u0111\u1ec1u \u0111\u01b0\u1ee3c \u0111\u00e1p \u1ee9ng. V\u00e0 t\u00ednh t\u1ed1i thi\u1ec3u tu\u00e2n theo \u0111\u1ecbnh l\u00fd Nerode (s\u1ebd kh\u00f4ng \u0111\u01b0\u1ee3c ch\u1ee9ng minh trong b\u00e0i vi\u1ebft n\u00e0y).</p> <p>Ch\u00fang ta c\u00f3 th\u1ec3 \u0111\u01b0a ra m\u1ed9t s\u1ed1 quan s\u00e1t quan tr\u1ecdng li\u00ean quan \u0111\u1ebfn c\u00e1c gi\u00e1 tr\u1ecb $endpos$:</p> <p>B\u1ed5 \u0111\u1ec1 1: Hai chu\u1ed7i con kh\u00f4ng r\u1ed7ng $u$ v\u00e0 $w$ (v\u1edbi $length(u) \\le length(w)$) l\u00e0 $endpos$-t\u01b0\u01a1ng \u0111\u01b0\u01a1ng, khi v\u00e0 ch\u1ec9 khi chu\u1ed7i $u$ xu\u1ea5t hi\u1ec7n trong $s$ ch\u1ec9 d\u01b0\u1edbi d\u1ea1ng h\u1eadu t\u1ed1 c\u1ee7a $w$.</p> <p>B\u1eb1ng ch\u1ee9ng l\u00e0 hi\u1ec3n nhi\u00ean. N\u1ebfu $u$ v\u00e0 $w$ c\u00f3 c\u00f9ng gi\u00e1 tr\u1ecb $endpos$, th\u00ec $u$ l\u00e0 h\u1eadu t\u1ed1 c\u1ee7a $w$ v\u00e0 ch\u1ec9 xu\u1ea5t hi\u1ec7n d\u01b0\u1edbi d\u1ea1ng h\u1eadu t\u1ed1 c\u1ee7a $w$ trong $s$. V\u00e0 n\u1ebfu $u$ l\u00e0 h\u1eadu t\u1ed1 c\u1ee7a $w$ v\u00e0 ch\u1ec9 xu\u1ea5t hi\u1ec7n d\u01b0\u1edbi d\u1ea1ng h\u1eadu t\u1ed1 trong $s$, th\u00ec c\u00e1c gi\u00e1 tr\u1ecb $endpos$ b\u1eb1ng nhau theo \u0111\u1ecbnh ngh\u0129a.</p> <p>B\u1ed5 \u0111\u1ec1 2: X\u00e9t hai chu\u1ed7i con kh\u00f4ng r\u1ed7ng $u$ v\u00e0 $w$ (v\u1edbi $length(u) \\le length(w)$). Khi \u0111\u00f3 t\u1eadp h\u1ee3p $endpos$ c\u1ee7a ch\u00fang ho\u1eb7c ho\u00e0n to\u00e0n kh\u00f4ng giao nhau, ho\u1eb7c $endpos(w)$ l\u00e0 m\u1ed9t t\u1eadp h\u1ee3p con c\u1ee7a $endpos(u)$. V\u00e0 n\u00f3 ph\u1ee5 thu\u1ed9c v\u00e0o vi\u1ec7c $u$ c\u00f3 ph\u1ea3i l\u00e0 h\u1eadu t\u1ed1 c\u1ee7a $w$ hay kh\u00f4ng.</p> $$\\begin{cases} endpos(w) \\subseteq endpos(u) &amp; \\text{n\u1ebfu } u \\text{ l\u00e0 h\u1eadu t\u1ed1 c\u1ee7a } w \\\\\\\\ endpos(w) \\cap endpos(u) = \\emptyset &amp; \\text{ng\u01b0\u1ee3c l\u1ea1i} \\end{cases}$$ <p>B\u1eb1ng ch\u1ee9ng: N\u1ebfu c\u00e1c t\u1eadp h\u1ee3p $endpos(u)$ v\u00e0 $endpos(w)$ c\u00f3 \u00edt nh\u1ea5t m\u1ed9t ph\u1ea7n t\u1eed chung, th\u00ec c\u00e1c chu\u1ed7i $u$ v\u00e0 $w$ \u0111\u1ec1u k\u1ebft th\u00fac \u1edf v\u1ecb tr\u00ed \u0111\u00f3, t\u1ee9c l\u00e0 $u$ l\u00e0 m\u1ed9t h\u1eadu t\u1ed1 c\u1ee7a $w$. Nh\u01b0ng sau \u0111\u00f3 t\u1ea1i m\u1ed7i l\u1ea7n xu\u1ea5t hi\u1ec7n c\u1ee7a $w$ c\u0169ng xu\u1ea5t hi\u1ec7n chu\u1ed7i con $u$, c\u00f3 ngh\u0129a l\u00e0 $endpos(w)$ l\u00e0 m\u1ed9t t\u1eadp h\u1ee3p con c\u1ee7a $endpos(u)$.</p> <p>B\u1ed5 \u0111\u1ec1 3: X\u00e9t m\u1ed9t l\u1edbp t\u01b0\u01a1ng \u0111\u01b0\u01a1ng $endpos$. S\u1eafp x\u1ebfp t\u1ea5t c\u1ea3 c\u00e1c chu\u1ed7i con trong l\u1edbp n\u00e0y theo \u0111\u1ed9 d\u00e0i gi\u1ea3m d\u1ea7n. Khi \u0111\u00f3 trong chu\u1ed7i k\u1ebft qu\u1ea3, m\u1ed7i chu\u1ed7i con s\u1ebd ng\u1eafn h\u01a1n chu\u1ed7i tr\u01b0\u1edbc \u0111\u00f3 m\u1ed9t \u0111\u01a1n v\u1ecb, v\u00e0 \u0111\u1ed3ng th\u1eddi s\u1ebd l\u00e0 h\u1eadu t\u1ed1 c\u1ee7a chu\u1ed7i tr\u01b0\u1edbc \u0111\u00f3. N\u00f3i c\u00e1ch kh\u00e1c, trong c\u00f9ng m\u1ed9t l\u1edbp t\u01b0\u01a1ng \u0111\u01b0\u01a1ng, c\u00e1c chu\u1ed7i con ng\u1eafn h\u01a1n th\u1ef1c s\u1ef1 l\u00e0 c\u00e1c h\u1eadu t\u1ed1 c\u1ee7a c\u00e1c chu\u1ed7i con d\u00e0i h\u01a1n v\u00e0 ch\u00fang nh\u1eadn t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ed9 d\u00e0i c\u00f3 th\u1ec3 trong m\u1ed9t kho\u1ea3ng nh\u1ea5t \u0111\u1ecbnh $[x; y]$.</p> <p>B\u1eb1ng ch\u1ee9ng: C\u1ed1 \u0111\u1ecbnh m\u1ed9t s\u1ed1 l\u1edbp t\u01b0\u01a1ng \u0111\u01b0\u01a1ng $endpos$. N\u1ebfu n\u00f3 ch\u1ec9 ch\u1ee9a m\u1ed9t chu\u1ed7i, th\u00ec b\u1ed5 \u0111\u1ec1 r\u00f5 r\u00e0ng l\u00e0 \u0111\u00fang. B\u00e2y gi\u1edd gi\u1ea3 s\u1eed s\u1ed1 l\u01b0\u1ee3ng chu\u1ed7i trong l\u1edbp l\u1edbn h\u01a1n m\u1ed9t.</p> <p>Theo B\u1ed5 \u0111\u1ec1 1, hai chu\u1ed7i t\u01b0\u01a1ng \u0111\u01b0\u01a1ng $endpos$ kh\u00e1c nhau lu\u00f4n theo c\u00e1ch sao cho chu\u1ed7i ng\u1eafn h\u01a1n l\u00e0 h\u1eadu t\u1ed1 th\u1ef1c s\u1ef1 c\u1ee7a chu\u1ed7i d\u00e0i h\u01a1n. Do \u0111\u00f3, kh\u00f4ng th\u1ec3 c\u00f3 hai chu\u1ed7i c\u00f3 c\u00f9ng \u0111\u1ed9 d\u00e0i trong l\u1edbp t\u01b0\u01a1ng \u0111\u01b0\u01a1ng.</p> <p>H\u00e3y k\u00fd hi\u1ec7u $w$ l\u00e0 chu\u1ed7i d\u00e0i nh\u1ea5t v\u00e0 $u$ l\u00e0 chu\u1ed7i ng\u1eafn nh\u1ea5t trong l\u1edbp t\u01b0\u01a1ng \u0111\u01b0\u01a1ng. Theo B\u1ed5 \u0111\u1ec1 1, chu\u1ed7i $u$ l\u00e0 h\u1eadu t\u1ed1 th\u1ef1c s\u1ef1 c\u1ee7a chu\u1ed7i $w$. B\u00e2y gi\u1edd h\u00e3y xem x\u00e9t b\u1ea5t k\u1ef3 h\u1eadu t\u1ed1 n\u00e0o c\u1ee7a $w$ c\u00f3 \u0111\u1ed9 d\u00e0i trong kho\u1ea3ng $[length(u); length(w)]$. D\u1ec5 th\u1ea5y r\u1eb1ng h\u1eadu t\u1ed1 n\u00e0y c\u0169ng \u0111\u01b0\u1ee3c ch\u1ee9a trong c\u00f9ng m\u1ed9t l\u1edbp t\u01b0\u01a1ng \u0111\u01b0\u01a1ng. B\u1edfi v\u00ec h\u1eadu t\u1ed1 n\u00e0y ch\u1ec9 c\u00f3 th\u1ec3 xu\u1ea5t hi\u1ec7n d\u01b0\u1edbi d\u1ea1ng h\u1eadu t\u1ed1 c\u1ee7a $w$ trong chu\u1ed7i $s$ (v\u00ec h\u1eadu t\u1ed1 ng\u1eafn h\u01a1n $u$ c\u0169ng xu\u1ea5t hi\u1ec7n trong $s$ ch\u1ec9 d\u01b0\u1edbi d\u1ea1ng h\u1eadu t\u1ed1 c\u1ee7a $w$). Do \u0111\u00f3, theo B\u1ed5 \u0111\u1ec1 1, h\u1eadu t\u1ed1 n\u00e0y $endpos$-t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi chu\u1ed7i $w$.</p>","tags":["Translated"]},{"location":"string/suffix-automaton.html#suffix-links-link","title":"Li\u00ean k\u1ebft h\u1eadu t\u1ed1 $link$ (Suffix links $link$)","text":"<p>Xem x\u00e9t m\u1ed9t s\u1ed1 tr\u1ea1ng th\u00e1i $v \\ne t_0$ trong automaton. Nh\u01b0 ch\u00fang ta \u0111\u00e3 bi\u1ebft, tr\u1ea1ng th\u00e1i $v$ t\u01b0\u01a1ng \u1ee9ng v\u1edbi l\u1edbp chu\u1ed7i c\u00f3 c\u00f9ng gi\u00e1 tr\u1ecb $endpos$. V\u00e0 n\u1ebfu ch\u00fang ta k\u00fd hi\u1ec7u $w$ l\u00e0 chu\u1ed7i d\u00e0i nh\u1ea5t trong c\u00e1c chu\u1ed7i n\u00e0y, th\u00ec t\u1ea5t c\u1ea3 c\u00e1c chu\u1ed7i kh\u00e1c l\u00e0 h\u1eadu t\u1ed1 c\u1ee7a $w$.</p> <p>Ch\u00fang t\u00f4i c\u0169ng bi\u1ebft m\u1ed9t v\u00e0i h\u1eadu t\u1ed1 \u0111\u1ea7u ti\u00ean c\u1ee7a m\u1ed9t chu\u1ed7i $w$ (n\u1ebfu ch\u00fang ta xem x\u00e9t c\u00e1c h\u1eadu t\u1ed1 theo th\u1ee9 t\u1ef1 \u0111\u1ed9 d\u00e0i gi\u1ea3m d\u1ea7n) \u0111\u1ec1u \u0111\u01b0\u1ee3c ch\u1ee9a trong l\u1edbp t\u01b0\u01a1ng \u0111\u01b0\u01a1ng n\u00e0y, v\u00e0 t\u1ea5t c\u1ea3 c\u00e1c h\u1eadu t\u1ed1 kh\u00e1c (\u00edt nh\u1ea5t m\u1ed9t h\u1eadu t\u1ed1 kh\u00e1c - h\u1eadu t\u1ed1 r\u1ed7ng) n\u1eb1m trong m\u1ed9t s\u1ed1 l\u1edbp kh\u00e1c. Ch\u00fang t\u00f4i k\u00fd hi\u1ec7u $t$ l\u00e0 h\u1eadu t\u1ed1 l\u1edbn nh\u1ea5t nh\u01b0 v\u1eady v\u00e0 t\u1ea1o m\u1ed9t li\u00ean k\u1ebft h\u1eadu t\u1ed1 \u0111\u1ebfn n\u00f3.</p> <p>N\u00f3i c\u00e1ch kh\u00e1c, m\u1ed9t li\u00ean k\u1ebft h\u1eadu t\u1ed1 (suffix link) $link(v)$ d\u1eabn \u0111\u1ebfn tr\u1ea1ng th\u00e1i t\u01b0\u01a1ng \u1ee9ng v\u1edbi h\u1eadu t\u1ed1 d\u00e0i nh\u1ea5t c\u1ee7a $w$ n\u1eb1m trong m\u1ed9t l\u1edbp t\u01b0\u01a1ng \u0111\u01b0\u01a1ng $endpos$ kh\u00e1c.</p> <p>\u1ede \u0111\u00e2y ch\u00fang t\u00f4i gi\u1ea3 \u0111\u1ecbnh r\u1eb1ng tr\u1ea1ng th\u00e1i ban \u0111\u1ea7u $t_0$ t\u01b0\u01a1ng \u1ee9ng v\u1edbi l\u1edbp t\u01b0\u01a1ng \u0111\u01b0\u01a1ng c\u1ee7a ri\u00eang n\u00f3 (ch\u1ec9 ch\u1ee9a chu\u1ed7i r\u1ed7ng) v\u00e0 \u0111\u1ec3 thu\u1eadn ti\u1ec7n, ch\u00fang t\u00f4i \u0111\u1eb7t $endpos(t_0) = \\{-1, 0, \\dots, length(s)-1\\}$.</p> <p>B\u1ed5 \u0111\u1ec1 4: C\u00e1c li\u00ean k\u1ebft h\u1eadu t\u1ed1 t\u1ea1o th\u00e0nh m\u1ed9t c\u00e2y v\u1edbi g\u1ed1c $t_0$.</p> <p>B\u1eb1ng ch\u1ee9ng: X\u00e9t m\u1ed9t tr\u1ea1ng th\u00e1i $v \\ne t_0$ t\u00f9y \u00fd. M\u1ed9t li\u00ean k\u1ebft h\u1eadu t\u1ed1 $link(v)$ d\u1eabn \u0111\u1ebfn m\u1ed9t tr\u1ea1ng th\u00e1i t\u01b0\u01a1ng \u1ee9ng v\u1edbi c\u00e1c chu\u1ed7i c\u00f3 \u0111\u1ed9 d\u00e0i nh\u1ecf h\u01a1n nghi\u00eam ng\u1eb7t (\u0111i\u1ec1u n\u00e0y tu\u00e2n theo \u0111\u1ecbnh ngh\u0129a c\u1ee7a c\u00e1c li\u00ean k\u1ebft h\u1eadu t\u1ed1 v\u00e0 t\u1eeb B\u1ed5 \u0111\u1ec1 3). Do \u0111\u00f3, b\u1eb1ng c\u00e1ch di chuy\u1ec3n d\u1ecdc theo c\u00e1c li\u00ean k\u1ebft h\u1eadu t\u1ed1, s\u1edbm hay mu\u1ed9n ch\u00fang ta c\u0169ng s\u1ebd \u0111\u1ebfn tr\u1ea1ng th\u00e1i ban \u0111\u1ea7u $t_0$, t\u01b0\u01a1ng \u1ee9ng v\u1edbi chu\u1ed7i r\u1ed7ng.</p> <p>B\u1ed5 \u0111\u1ec1 5: N\u1ebfu ch\u00fang ta x\u00e2y d\u1ef1ng m\u1ed9t c\u00e2y s\u1eed d\u1ee5ng c\u00e1c t\u1eadp h\u1ee3p $endpos$ (theo quy t\u1eafc t\u1eadp h\u1ee3p c\u1ee7a n\u00fat cha ch\u1ee9a c\u00e1c t\u1eadp h\u1ee3p c\u1ee7a t\u1ea5t c\u1ea3 con c\u00e1i d\u01b0\u1edbi d\u1ea1ng t\u1eadp h\u1ee3p con), th\u00ec c\u1ea5u tr\u00fac s\u1ebd tr\u00f9ng v\u1edbi c\u00e2y c\u1ee7a c\u00e1c li\u00ean k\u1ebft h\u1eadu t\u1ed1.</p> <p>B\u1eb1ng ch\u1ee9ng: Vi\u1ec7c ch\u00fang ta c\u00f3 th\u1ec3 x\u00e2y d\u1ef1ng m\u1ed9t c\u00e2y b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng c\u00e1c t\u1eadp h\u1ee3p $endpos$ tu\u00e2n theo tr\u1ef1c ti\u1ebfp t\u1eeb B\u1ed5 \u0111\u1ec1 2 (r\u1eb1ng b\u1ea5t k\u1ef3 hai t\u1eadp h\u1ee3p n\u00e0o kh\u00f4ng giao nhau ho\u1eb7c m\u1ed9t t\u1eadp h\u1ee3p \u0111\u01b0\u1ee3c ch\u1ee9a trong t\u1eadp h\u1ee3p kia).</p> <p>B\u00e2y gi\u1edd ch\u00fang ta h\u00e3y xem x\u00e9t m\u1ed9t tr\u1ea1ng th\u00e1i $v \\ne t_0$ t\u00f9y \u00fd v\u00e0 li\u00ean k\u1ebft h\u1eadu t\u1ed1 c\u1ee7a n\u00f3 $link(v)$. T\u1eeb \u0111\u1ecbnh ngh\u0129a c\u1ee7a li\u00ean k\u1ebft h\u1eadu t\u1ed1 v\u00e0 t\u1eeb B\u1ed5 \u0111\u1ec1 2 suy ra r\u1eb1ng</p> $$endpos(v) \\subseteq endpos(link(v)),$$ <p>c\u00f9ng v\u1edbi b\u1ed5 \u0111\u1ec1 tr\u01b0\u1edbc ch\u1ee9ng minh kh\u1eb3ng \u0111\u1ecbnh: c\u00e2y li\u00ean k\u1ebft h\u1eadu t\u1ed1 v\u1ec1 c\u01a1 b\u1ea3n l\u00e0 m\u1ed9t c\u00e2y c\u1ee7a c\u00e1c t\u1eadp h\u1ee3p $endpos$.</p> <p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u1ed9t v\u00ed d\u1ee5 v\u1ec1 c\u00e2y li\u00ean k\u1ebft h\u1eadu t\u1ed1 trong suffix automaton \u0111\u01b0\u1ee3c x\u00e2y d\u1ef1ng cho chu\u1ed7i $\\text{\"abcbc\"}$. C\u00e1c n\u00fat \u0111\u01b0\u1ee3c g\u1eafn nh\u00e3n v\u1edbi chu\u1ed7i con d\u00e0i nh\u1ea5t t\u1eeb l\u1edbp t\u01b0\u01a1ng \u0111\u01b0\u01a1ng t\u01b0\u01a1ng \u1ee9ng.</p> <p></p>","tags":["Translated"]},{"location":"string/suffix-automaton.html#recap","title":"T\u00f3m t\u1eaft (Recap)","text":"<p>Tr\u01b0\u1edbc khi ti\u1ebfn h\u00e0nh thu\u1eadt to\u00e1n, ch\u00fang ta t\u00f3m t\u1eaft l\u1ea1i ki\u1ebfn th\u1ee9c \u0111\u00e3 t\u00edch l\u0169y v\u00e0 gi\u1edbi thi\u1ec7u m\u1ed9t v\u00e0i k\u00fd hi\u1ec7u ph\u1ee5 tr\u1ee3.</p> <ul> <li>C\u00e1c chu\u1ed7i con c\u1ee7a chu\u1ed7i $s$ c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c ph\u00e2n t\u00e1ch th\u00e0nh c\u00e1c l\u1edbp t\u01b0\u01a1ng \u0111\u01b0\u01a1ng theo v\u1ecb tr\u00ed k\u1ebft th\u00fac $endpos$ c\u1ee7a ch\u00fang.</li> <li>Suffix automaton bao g\u1ed3m tr\u1ea1ng th\u00e1i ban \u0111\u1ea7u $t_0$, c\u0169ng nh\u01b0 m\u1ed9t tr\u1ea1ng th\u00e1i cho m\u1ed7i l\u1edbp t\u01b0\u01a1ng \u0111\u01b0\u01a1ng $endpos$.</li> <li>\u0110\u1ed1i v\u1edbi m\u1ed7i tr\u1ea1ng th\u00e1i $v$, m\u1ed9t ho\u1eb7c nhi\u1ec1u chu\u1ed7i con kh\u1edbp v\u1edbi nhau.   Ch\u00fang t\u00f4i k\u00fd hi\u1ec7u $longest(v)$ l\u00e0 chu\u1ed7i d\u00e0i nh\u1ea5t nh\u01b0 v\u1eady v\u00e0 qua $len(v)$ l\u00e0 \u0111\u1ed9 d\u00e0i c\u1ee7a n\u00f3.   Ch\u00fang t\u00f4i k\u00fd hi\u1ec7u $shortest(v)$ l\u00e0 chu\u1ed7i con ng\u1eafn nh\u1ea5t nh\u01b0 v\u1eady v\u00e0 \u0111\u1ed9 d\u00e0i c\u1ee7a n\u00f3 v\u1edbi $minlen(v)$.   Sau \u0111\u00f3, t\u1ea5t c\u1ea3 c\u00e1c chu\u1ed7i t\u01b0\u01a1ng \u1ee9ng v\u1edbi tr\u1ea1ng th\u00e1i n\u00e0y l\u00e0 c\u00e1c h\u1eadu t\u1ed1 kh\u00e1c nhau c\u1ee7a chu\u1ed7i $longest(v)$ v\u00e0 c\u00f3 t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ed9 d\u00e0i c\u00f3 th\u1ec3 trong kho\u1ea3ng $[minlen(v); len(v)]$.</li> <li>\u0110\u1ed1i v\u1edbi m\u1ed7i tr\u1ea1ng th\u00e1i $v \\ne t_0$, m\u1ed9t li\u00ean k\u1ebft h\u1eadu t\u1ed1 \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a l\u00e0 m\u1ed9t li\u00ean k\u1ebft, d\u1eabn \u0111\u1ebfn m\u1ed9t tr\u1ea1ng th\u00e1i t\u01b0\u01a1ng \u1ee9ng v\u1edbi h\u1eadu t\u1ed1 c\u1ee7a chu\u1ed7i $longest(v)$ c\u00f3 \u0111\u1ed9 d\u00e0i $minlen(v) - 1$.   C\u00e1c li\u00ean k\u1ebft h\u1eadu t\u1ed1 t\u1ea1o th\u00e0nh m\u1ed9t c\u00e2y v\u1edbi g\u1ed1c \u1edf $t_0$, v\u00e0 \u0111\u1ed3ng th\u1eddi c\u00e2y n\u00e0y t\u1ea1o th\u00e0nh m\u1ed1i quan h\u1ec7 bao g\u1ed3m gi\u1eefa c\u00e1c t\u1eadp h\u1ee3p $endpos$.</li> <li>Ch\u00fang ta c\u00f3 th\u1ec3 bi\u1ec3u th\u1ecb $minlen(v)$ cho $v \\ne t_0$ b\u1eb1ng li\u00ean k\u1ebft h\u1eadu t\u1ed1 $link(v)$ nh\u01b0 sau:</li> </ul> $$minlen(v) = len(link(v)) + 1$$ <ul> <li>N\u1ebfu ch\u00fang ta b\u1eaft \u0111\u1ea7u t\u1eeb m\u1ed9t tr\u1ea1ng th\u00e1i $v_0$ t\u00f9y \u00fd v\u00e0 \u0111i theo c\u00e1c li\u00ean k\u1ebft h\u1eadu t\u1ed1, th\u00ec s\u1edbm hay mu\u1ed9n ch\u00fang ta c\u0169ng s\u1ebd \u0111\u1ea1t \u0111\u1ebfn tr\u1ea1ng th\u00e1i ban \u0111\u1ea7u $t_0$.   Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, ch\u00fang ta thu \u0111\u01b0\u1ee3c m\u1ed9t chu\u1ed7i c\u00e1c kho\u1ea3ng r\u1eddi r\u1ea1c $[minlen(v_i); len(v_i)]$, trong \u0111\u00f3 h\u1ee3p l\u1ea1i t\u1ea1o th\u00e0nh kho\u1ea3ng li\u00ean t\u1ee5c $[0; len(v_0)]$.</li> </ul>","tags":["Translated"]},{"location":"string/suffix-automaton.html#algorithm","title":"Thu\u1eadt to\u00e1n (Algorithm)","text":"<p>B\u00e2y gi\u1edd ch\u00fang ta c\u00f3 th\u1ec3 ti\u1ebfn h\u00e0nh thu\u1eadt to\u00e1n ch\u00ednh n\u00f3. Thu\u1eadt to\u00e1n s\u1ebd l\u00e0 tr\u1ef1c tuy\u1ebfn, t\u1ee9c l\u00e0 ch\u00fang ta s\u1ebd th\u00eam c\u00e1c k\u00fd t\u1ef1 c\u1ee7a chu\u1ed7i t\u1eebng c\u00e1i m\u1ed9t, v\u00e0 s\u1eeda \u0111\u1ed5i automaton cho ph\u00f9 h\u1ee3p trong t\u1eebng b\u01b0\u1edbc.</p> <p>\u0110\u1ec3 \u0111\u1ea1t \u0111\u01b0\u1ee3c m\u1ee9c ti\u00eau th\u1ee5 b\u1ed9 nh\u1edb tuy\u1ebfn t\u00ednh, ch\u00fang ta s\u1ebd ch\u1ec9 l\u01b0u tr\u1eef c\u00e1c gi\u00e1 tr\u1ecb $len$, $link$ v\u00e0 danh s\u00e1ch c\u00e1c chuy\u1ec3n \u0111\u1ed5i trong m\u1ed7i tr\u1ea1ng th\u00e1i. Ch\u00fang t\u00f4i s\u1ebd kh\u00f4ng g\u1eafn nh\u00e3n c\u00e1c tr\u1ea1ng th\u00e1i k\u1ebft th\u00fac (nh\u01b0ng sau n\u00e0y ch\u00fang t\u00f4i s\u1ebd ch\u1ec9 ra c\u00e1ch s\u1eafp x\u1ebfp c\u00e1c nh\u00e3n n\u00e0y sau khi x\u00e2y d\u1ef1ng suffix automaton).</p> <p>Ban \u0111\u1ea7u automaton bao g\u1ed3m m\u1ed9t tr\u1ea1ng th\u00e1i duy nh\u1ea5t $t_0$, s\u1ebd l\u00e0 ch\u1ec9 s\u1ed1 $0$ (c\u00e1c tr\u1ea1ng th\u00e1i c\u00f2n l\u1ea1i s\u1ebd nh\u1eadn \u0111\u01b0\u1ee3c c\u00e1c ch\u1ec9 s\u1ed1 $1, 2, \\dots$). Ch\u00fang t\u00f4i g\u00e1n cho n\u00f3 $len = 0$ v\u00e0 $link = -1$ \u0111\u1ec3 thu\u1eadn ti\u1ec7n ($-1$ s\u1ebd l\u00e0 m\u1ed9t tr\u1ea1ng th\u00e1i h\u01b0 c\u1ea5u, kh\u00f4ng t\u1ed3n t\u1ea1i).</p> <p>B\u00e2y gi\u1edd to\u00e0n b\u1ed9 nhi\u1ec7m v\u1ee5 r\u00fat g\u1ecdn l\u1ea1i th\u00e0nh vi\u1ec7c th\u1ef1c hi\u1ec7n qu\u00e1 tr\u00ecnh th\u00eam m\u1ed9t k\u00fd t\u1ef1 $c$ v\u00e0o cu\u1ed1i chu\u1ed7i hi\u1ec7n t\u1ea1i. H\u00e3y m\u00f4 t\u1ea3 qu\u00e1 tr\u00ecnh n\u00e0y:</p> <ul> <li>G\u1ecdi $last$ l\u00e0 tr\u1ea1ng th\u00e1i t\u01b0\u01a1ng \u1ee9ng v\u1edbi to\u00e0n b\u1ed9 chu\u1ed7i tr\u01b0\u1edbc khi th\u00eam k\u00fd t\u1ef1 $c$.     (Ban \u0111\u1ea7u ch\u00fang ta \u0111\u1eb7t $last = 0$, v\u00e0 ch\u00fang ta s\u1ebd thay \u0111\u1ed5i $last$ trong b\u01b0\u1edbc cu\u1ed1i c\u00f9ng c\u1ee7a thu\u1eadt to\u00e1n cho ph\u00f9 h\u1ee3p.)</li> <li>T\u1ea1o m\u1ed9t tr\u1ea1ng th\u00e1i m\u1edbi $cur$, v\u00e0 g\u00e1n cho n\u00f3 $len(cur) = len(last) + 1$.     Gi\u00e1 tr\u1ecb $link(cur)$ kh\u00f4ng \u0111\u01b0\u1ee3c bi\u1ebft v\u00e0o l\u00fac \u0111\u00f3.</li> <li>B\u00e2y gi\u1edd ch\u00fang ta th\u1ef1c hi\u1ec7n th\u1ee7 t\u1ee5c sau:     Ch\u00fang ta b\u1eaft \u0111\u1ea7u \u1edf tr\u1ea1ng th\u00e1i $last$.     Trong khi kh\u00f4ng c\u00f3 chuy\u1ec3n \u0111\u1ed5i qua ch\u1eef c\u00e1i $c$, ch\u00fang ta s\u1ebd th\u00eam m\u1ed9t chuy\u1ec3n \u0111\u1ed5i \u0111\u1ebfn tr\u1ea1ng th\u00e1i $cur$, v\u00e0 \u0111i theo li\u00ean k\u1ebft h\u1eadu t\u1ed1.     N\u1ebfu t\u1ea1i m\u1ed9t th\u1eddi \u0111i\u1ec3m n\u00e0o \u0111\u00f3 \u0111\u00e3 t\u1ed3n t\u1ea1i m\u1ed9t chuy\u1ec3n \u0111\u1ed5i qua ch\u1eef c\u00e1i $c$, th\u00ec ch\u00fang ta s\u1ebd d\u1eebng l\u1ea1i v\u00e0 bi\u1ec3u th\u1ecb tr\u1ea1ng th\u00e1i n\u00e0y b\u1eb1ng $p$.</li> <li>N\u1ebfu ch\u00fang ta ch\u01b0a t\u00ecm th\u1ea5y tr\u1ea1ng th\u00e1i $p$ nh\u01b0 v\u1eady, th\u00ec ch\u00fang ta \u0111\u00e3 \u0111\u1ea1t \u0111\u1ebfn tr\u1ea1ng th\u00e1i h\u01b0 c\u1ea5u $-1$, sau \u0111\u00f3 ch\u00fang ta ch\u1ec9 c\u1ea7n g\u00e1n $link(cur) = 0$ v\u00e0 r\u1eddi \u0111i.</li> <li>Gi\u1ea3 s\u1eed b\u00e2y gi\u1edd ch\u00fang ta \u0111\u00e3 t\u00ecm th\u1ea5y m\u1ed9t tr\u1ea1ng th\u00e1i $p$, t\u1eeb \u0111\u00f3 t\u1ed3n t\u1ea1i m\u1ed9t chuy\u1ec3n \u0111\u1ed5i qua ch\u1eef c\u00e1i $c$.     Ch\u00fang t\u00f4i s\u1ebd bi\u1ec3u th\u1ecb tr\u1ea1ng th\u00e1i m\u00e0 chuy\u1ec3n \u0111\u1ed5i d\u1eabn \u0111\u1ebfn l\u00e0 $q$.</li> <li>B\u00e2y gi\u1edd ch\u00fang ta c\u00f3 hai tr\u01b0\u1eddng h\u1ee3p. Ho\u1eb7c $len(p) + 1 = len(q)$, ho\u1eb7c kh\u00f4ng.</li> <li>N\u1ebfu $len(p) + 1 = len(q)$, th\u00ec ch\u00fang ta ch\u1ec9 c\u1ea7n g\u00e1n $link(cur) = q$ v\u00e0 r\u1eddi \u0111i.</li> <li> <p>N\u1ebfu kh\u00f4ng th\u00ec ph\u1ee9c t\u1ea1p h\u01a1n m\u1ed9t ch\u00fat.     C\u1ea7n ph\u1ea3i nh\u00e2n b\u1ea3n (clone) tr\u1ea1ng th\u00e1i $q$:     ch\u00fang ta t\u1ea1o m\u1ed9t tr\u1ea1ng th\u00e1i m\u1edbi $clone$, sao ch\u00e9p t\u1ea5t c\u1ea3 d\u1eef li\u1ec7u t\u1eeb $q$ (li\u00ean k\u1ebft h\u1eadu t\u1ed1 v\u00e0 chuy\u1ec3n \u0111\u1ed5i) ngo\u1ea1i tr\u1eeb gi\u00e1 tr\u1ecb $len$.     Ch\u00fang t\u00f4i s\u1ebd g\u00e1n $len(clone) = len(p) + 1$.</p> <p>Sau khi nh\u00e2n b\u1ea3n, ch\u00fang ta h\u01b0\u1edbng li\u00ean k\u1ebft h\u1eadu t\u1ed1 t\u1eeb $cur$ \u0111\u1ebfn $clone$, v\u00e0 c\u1ea3 t\u1eeb $q$ \u0111\u1ebfn $clone$.</p> <p>Cu\u1ed1i c\u00f9ng, ch\u00fang ta c\u1ea7n \u0111i b\u1ed9 t\u1eeb tr\u1ea1ng th\u00e1i $p$ tr\u1edf l\u1ea1i b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng c\u00e1c li\u00ean k\u1ebft h\u1eadu t\u1ed1 mi\u1ec5n l\u00e0 c\u00f3 chuy\u1ec3n \u0111\u1ed5i qua $c$ \u0111\u1ebfn tr\u1ea1ng th\u00e1i $q$, v\u00e0 chuy\u1ec3n h\u01b0\u1edbng t\u1ea5t c\u1ea3 nh\u1eefng chuy\u1ec3n \u0111\u1ed5i \u0111\u00f3 \u0111\u1ebfn tr\u1ea1ng th\u00e1i $clone$.</p> </li> <li> <p>Trong b\u1ea5t k\u1ef3 tr\u01b0\u1eddng h\u1ee3p n\u00e0o trong ba tr\u01b0\u1eddng h\u1ee3p, sau khi ho\u00e0n th\u00e0nh th\u1ee7 t\u1ee5c, ch\u00fang ta c\u1eadp nh\u1eadt gi\u00e1 tr\u1ecb $last$ v\u1edbi tr\u1ea1ng th\u00e1i $cur$.</p> </li> </ul> <p>N\u1ebfu ch\u00fang ta c\u0169ng mu\u1ed1n bi\u1ebft tr\u1ea1ng th\u00e1i n\u00e0o l\u00e0 k\u1ebft th\u00fac v\u00e0 tr\u1ea1ng th\u00e1i n\u00e0o kh\u00f4ng, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm th\u1ea5y t\u1ea5t c\u1ea3 c\u00e1c tr\u1ea1ng th\u00e1i k\u1ebft th\u00fac sau khi x\u00e2y d\u1ef1ng suffix automaton ho\u00e0n ch\u1ec9nh cho to\u00e0n b\u1ed9 chu\u1ed7i $s$. \u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y, ch\u00fang ta l\u1ea5y tr\u1ea1ng th\u00e1i t\u01b0\u01a1ng \u1ee9ng v\u1edbi to\u00e0n b\u1ed9 chu\u1ed7i (\u0111\u01b0\u1ee3c l\u01b0u tr\u1eef trong bi\u1ebfn $last$) v\u00e0 \u0111i theo c\u00e1c li\u00ean k\u1ebft h\u1eadu t\u1ed1 c\u1ee7a n\u00f3 cho \u0111\u1ebfn khi ch\u00fang ta \u0111\u1ebfn tr\u1ea1ng th\u00e1i ban \u0111\u1ea7u. Ch\u00fang t\u00f4i s\u1ebd \u0111\u00e1nh d\u1ea5u t\u1ea5t c\u1ea3 c\u00e1c tr\u1ea1ng th\u00e1i \u0111\u00e3 truy c\u1eadp l\u00e0 k\u1ebft th\u00fac. D\u1ec5 hi\u1ec3u r\u1eb1ng b\u1eb1ng c\u00e1ch l\u00e0m nh\u01b0 v\u1eady, ch\u00fang ta s\u1ebd \u0111\u00e1nh d\u1ea5u ch\u00ednh x\u00e1c c\u00e1c tr\u1ea1ng th\u00e1i t\u01b0\u01a1ng \u1ee9ng v\u1edbi t\u1ea5t c\u1ea3 c\u00e1c h\u1eadu t\u1ed1 c\u1ee7a chu\u1ed7i $s$, \u0111\u00f3 ch\u00ednh x\u00e1c l\u00e0 c\u00e1c tr\u1ea1ng th\u00e1i k\u1ebft th\u00fac.</p> <p>Trong ph\u1ea7n ti\u1ebfp theo, ch\u00fang ta s\u1ebd xem x\u00e9t chi ti\u1ebft t\u1eebng b\u01b0\u1edbc v\u00e0 cho th\u1ea5y t\u00ednh ch\u00ednh x\u00e1c c\u1ee7a n\u00f3.</p> <p>\u1ede \u0111\u00e2y ch\u00fang t\u00f4i ch\u1ec9 l\u01b0u \u00fd r\u1eb1ng, v\u00ec ch\u00fang t\u00f4i ch\u1ec9 t\u1ea1o m\u1ed9t ho\u1eb7c hai tr\u1ea1ng th\u00e1i m\u1edbi cho m\u1ed7i k\u00fd t\u1ef1 c\u1ee7a $s$, suffix automaton ch\u1ee9a m\u1ed9t s\u1ed1 l\u01b0\u1ee3ng tr\u1ea1ng th\u00e1i tuy\u1ebfn t\u00ednh.</p> <p>T\u00ednh tuy\u1ebfn t\u00ednh c\u1ee7a s\u1ed1 l\u01b0\u1ee3ng chuy\u1ec3n \u0111\u1ed5i, v\u00e0 n\u00f3i chung l\u00e0 t\u00ednh tuy\u1ebfn t\u00ednh c\u1ee7a th\u1eddi gian ch\u1ea1y c\u1ee7a thu\u1eadt to\u00e1n \u00edt r\u00f5 r\u00e0ng h\u01a1n, v\u00e0 ch\u00fang s\u1ebd \u0111\u01b0\u1ee3c ch\u1ee9ng minh sau khi ch\u00fang t\u00f4i ch\u1ee9ng minh t\u00ednh ch\u00ednh x\u00e1c.</p>","tags":["Translated"]},{"location":"string/suffix-automaton.html#correctness","title":"T\u00ednh ch\u00ednh x\u00e1c (Correctness)","text":"<ul> <li> <p>Ch\u00fang t\u00f4i s\u1ebd g\u1ecdi m\u1ed9t chuy\u1ec3n \u0111\u1ed5i $(p, q)$ l\u00e0 li\u00ean t\u1ee5c (continuous) n\u1ebfu $len(p) + 1 = len(q)$.     Vi\u1ec7c kh\u00e1c, t\u1ee9c l\u00e0 khi $len(p) + 1 &lt; len(q)$, chuy\u1ec3n \u0111\u1ed5i s\u1ebd \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 kh\u00f4ng li\u00ean t\u1ee5c (non-continuous).</p> <p>Nh\u01b0 ch\u00fang ta c\u00f3 th\u1ec3 th\u1ea5y t\u1eeb m\u00f4 t\u1ea3 c\u1ee7a thu\u1eadt to\u00e1n, c\u00e1c chuy\u1ec3n \u0111\u1ed5i li\u00ean t\u1ee5c v\u00e0 kh\u00f4ng li\u00ean t\u1ee5c s\u1ebd d\u1eabn \u0111\u1ebfn c\u00e1c tr\u01b0\u1eddng h\u1ee3p kh\u00e1c nhau c\u1ee7a thu\u1eadt to\u00e1n. C\u00e1c chuy\u1ec3n \u0111\u1ed5i li\u00ean t\u1ee5c l\u00e0 c\u1ed1 \u0111\u1ecbnh v\u00e0 s\u1ebd kh\u00f4ng bao gi\u1edd thay \u0111\u1ed5i n\u1eefa. Ng\u01b0\u1ee3c l\u1ea1i, chuy\u1ec3n \u0111\u1ed5i kh\u00f4ng li\u00ean t\u1ee5c c\u00f3 th\u1ec3 thay \u0111\u1ed5i khi c\u00e1c ch\u1eef c\u00e1i m\u1edbi \u0111\u01b0\u1ee3c th\u00eam v\u00e0o chu\u1ed7i (k\u1ebft th\u00fac c\u1ee7a c\u1ea1nh chuy\u1ec3n \u0111\u1ed5i c\u00f3 th\u1ec3 thay \u0111\u1ed5i).</p> </li> <li> <p>\u0110\u1ec3 tr\u00e1nh s\u1ef1 m\u01a1 h\u1ed3, ch\u00fang t\u00f4i s\u1ebd bi\u1ec3u th\u1ecb chu\u1ed7i, m\u00e0 suffix automaton \u0111\u01b0\u1ee3c x\u00e2y d\u1ef1ng tr\u01b0\u1edbc khi th\u00eam k\u00fd t\u1ef1 hi\u1ec7n t\u1ea1i $c$, b\u1eb1ng $s$.</p> </li> <li> <p>Thu\u1eadt to\u00e1n b\u1eaft \u0111\u1ea7u b\u1eb1ng c\u00e1ch t\u1ea1o m\u1ed9t tr\u1ea1ng th\u00e1i m\u1edbi $cur$, s\u1ebd t\u01b0\u01a1ng \u1ee9ng v\u1edbi to\u00e0n b\u1ed9 chu\u1ed7i $s + c$.     R\u00f5 r\u00e0ng l\u00e0 t\u1ea1i sao ch\u00fang ta ph\u1ea3i t\u1ea1o ra m\u1ed9t tr\u1ea1ng th\u00e1i m\u1edbi.     C\u00f9ng v\u1edbi k\u00fd t\u1ef1 m\u1edbi, m\u1ed9t l\u1edbp t\u01b0\u01a1ng \u0111\u01b0\u01a1ng m\u1edbi \u0111\u01b0\u1ee3c t\u1ea1o ra.</p> </li> <li> <p>Sau khi t\u1ea1o tr\u1ea1ng th\u00e1i m\u1edbi, ch\u00fang ta duy\u1ec7t qua c\u00e1c li\u00ean k\u1ebft h\u1eadu t\u1ed1 b\u1eaft \u0111\u1ea7u t\u1eeb tr\u1ea1ng th\u00e1i t\u01b0\u01a1ng \u1ee9ng v\u1edbi to\u00e0n b\u1ed9 chu\u1ed7i $s$.     \u0110\u1ed1i v\u1edbi m\u1ed7i tr\u1ea1ng th\u00e1i, ch\u00fang t\u00f4i c\u1ed1 g\u1eafng th\u00eam m\u1ed9t chuy\u1ec3n \u0111\u1ed5i v\u1edbi k\u00fd t\u1ef1 $c$ v\u00e0o tr\u1ea1ng th\u00e1i m\u1edbi $cur$.     Do \u0111\u00f3, ch\u00fang ta th\u00eam k\u00fd t\u1ef1 $c$ v\u00e0o m\u1ed7i h\u1eadu t\u1ed1 c\u1ee7a $s$.     Tuy nhi\u00ean, ch\u00fang ta ch\u1ec9 c\u00f3 th\u1ec3 th\u00eam c\u00e1c chuy\u1ec3n \u0111\u1ed5i m\u1edbi n\u00e0y n\u1ebfu ch\u00fang kh\u00f4ng xung \u0111\u1ed9t v\u1edbi m\u1ed9t chuy\u1ec3n \u0111\u1ed5i \u0111\u00e3 t\u1ed3n t\u1ea1i.     Do \u0111\u00f3, ngay khi ch\u00fang ta t\u00ecm th\u1ea5y m\u1ed9t chuy\u1ec3n \u0111\u1ed5i \u0111\u00e3 t\u1ed3n t\u1ea1i v\u1edbi $c$, ch\u00fang ta ph\u1ea3i d\u1eebng l\u1ea1i.</p> </li> <li> <p>Trong tr\u01b0\u1eddng h\u1ee3p \u0111\u01a1n gi\u1ea3n nh\u1ea5t, ch\u00fang t\u00f4i \u0111\u00e3 \u0111\u1ea1t \u0111\u1ebfn tr\u1ea1ng th\u00e1i h\u01b0 c\u1ea5u $-1$.     \u0110i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 ch\u00fang ta \u0111\u00e3 th\u00eam chuy\u1ec3n \u0111\u1ed5i v\u1edbi $c$ cho t\u1ea5t c\u1ea3 c\u00e1c h\u1eadu t\u1ed1 c\u1ee7a $s$.     \u0110i\u1ec1u n\u00e0y c\u0169ng c\u00f3 ngh\u0129a l\u00e0, k\u00fd t\u1ef1 $c$ ch\u01b0a t\u1eebng l\u00e0 m\u1ed9t ph\u1ea7n c\u1ee7a chu\u1ed7i $s$ tr\u01b0\u1edbc \u0111\u00e2y.     Do \u0111\u00f3, li\u00ean k\u1ebft h\u1eadu t\u1ed1 c\u1ee7a $cur$ ph\u1ea3i d\u1eabn \u0111\u1ebfn tr\u1ea1ng th\u00e1i $0$.</p> </li> <li> <p>Trong tr\u01b0\u1eddng h\u1ee3p th\u1ee9 hai, ch\u00fang ta b\u1eaft g\u1eb7p m\u1ed9t chuy\u1ec3n \u0111\u1ed5i hi\u1ec7n c\u00f3 $(p, q)$.     \u0110i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 ch\u00fang ta \u0111\u00e3 c\u1ed1 g\u1eafng th\u00eam m\u1ed9t chu\u1ed7i $x + c$ (trong \u0111\u00f3 $x$ l\u00e0 h\u1eadu t\u1ed1 c\u1ee7a $s$) v\u00e0o m\u00e1y \u0111\u00e3 t\u1ed3n t\u1ea1i trong m\u00e1y (chu\u1ed7i $x + c$ \u0111\u00e3 xu\u1ea5t hi\u1ec7n d\u01b0\u1edbi d\u1ea1ng chu\u1ed7i con c\u1ee7a $s$).     V\u00ec ch\u00fang t\u00f4i gi\u1ea3 \u0111\u1ecbnh r\u1eb1ng automaton cho chu\u1ed7i $s$ \u0111\u01b0\u1ee3c x\u00e2y d\u1ef1ng ch\u00ednh x\u00e1c, ch\u00fang t\u00f4i kh\u00f4ng n\u00ean th\u00eam m\u1ed9t chuy\u1ec3n \u0111\u1ed5i m\u1edbi \u1edf \u0111\u00e2y.</p> <p>Tuy nhi\u00ean c\u00f3 m\u1ed9t kh\u00f3 kh\u0103n. Li\u00ean k\u1ebft h\u1eadu t\u1ed1 t\u1eeb tr\u1ea1ng th\u00e1i $cur$ n\u00ean d\u1eabn \u0111\u1ebfn tr\u1ea1ng th\u00e1i n\u00e0o? Ch\u00fang ta ph\u1ea3i t\u1ea1o m\u1ed9t li\u00ean k\u1ebft h\u1eadu t\u1ed1 \u0111\u1ebfn m\u1ed9t tr\u1ea1ng th\u00e1i, trong \u0111\u00f3 chu\u1ed7i d\u00e0i nh\u1ea5t ch\u00ednh x\u00e1c l\u00e0 $x + c$, t\u1ee9c l\u00e0 $len$ c\u1ee7a tr\u1ea1ng th\u00e1i n\u00e0y ph\u1ea3i l\u00e0 $len(p) + 1$. Tuy nhi\u00ean, c\u00f3 th\u1ec3 tr\u1ea1ng th\u00e1i nh\u01b0 v\u1eady ch\u01b0a t\u1ed3n t\u1ea1i, t\u1ee9c l\u00e0 $len(q) &gt; len(p) + 1$. Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, ch\u00fang ta ph\u1ea3i t\u1ea1o ra m\u1ed9t tr\u1ea1ng th\u00e1i nh\u01b0 v\u1eady b\u1eb1ng c\u00e1ch t\u00e1ch tr\u1ea1ng th\u00e1i $q$.</p> </li> <li> <p>N\u1ebfu chuy\u1ec3n \u0111\u1ed5i $(p, q)$ h\u00f3a ra l\u00e0 li\u00ean t\u1ee5c, th\u00ec $len(q) = len(p) + 1$.     Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y m\u1ecdi th\u1ee9 \u0111\u1ec1u \u0111\u01a1n gi\u1ea3n.     Ch\u00fang t\u00f4i h\u01b0\u1edbng li\u00ean k\u1ebft h\u1eadu t\u1ed1 t\u1eeb $cur$ \u0111\u1ebfn tr\u1ea1ng th\u00e1i $q$.</p> </li> <li> <p>N\u1ebfu kh\u00f4ng, qu\u00e1 tr\u00ecnh chuy\u1ec3n \u0111\u1ed5i l\u00e0 kh\u00f4ng li\u00ean t\u1ee5c, t\u1ee9c l\u00e0 $len(q) &gt; len(p) + 1$.     \u0110i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 tr\u1ea1ng th\u00e1i $q$ t\u01b0\u01a1ng \u1ee9ng kh\u00f4ng ch\u1ec9 v\u1edbi h\u1eadu t\u1ed1 c\u1ee7a $s + c$ v\u1edbi \u0111\u1ed9 d\u00e0i $len(p) + 1$, m\u00e0 c\u00f2n v\u1edbi c\u00e1c chu\u1ed7i con d\u00e0i h\u01a1n c\u1ee7a $s$.     Ch\u00fang ta kh\u00f4ng th\u1ec3 l\u00e0m g\u00ec kh\u00e1c ngo\u00e0i t\u00e1ch tr\u1ea1ng th\u00e1i $q$ th\u00e0nh hai tr\u1ea1ng th\u00e1i con, \u0111\u1ec3 tr\u1ea1ng th\u00e1i \u0111\u1ea7u ti\u00ean c\u00f3 \u0111\u1ed9 d\u00e0i $len(p) + 1$.</p> <p>L\u00e0m th\u1ebf n\u00e0o ch\u00fang ta c\u00f3 th\u1ec3 t\u00e1ch m\u1ed9t tr\u1ea1ng th\u00e1i? Ch\u00fang ta nh\u00e2n b\u1ea3n tr\u1ea1ng th\u00e1i $q$, cung c\u1ea5p cho ch\u00fang ta tr\u1ea1ng th\u00e1i $clone$, v\u00e0 ch\u00fang ta \u0111\u1eb7t $len(clone) = len(p) + 1$. Ch\u00fang t\u00f4i sao ch\u00e9p t\u1ea5t c\u1ea3 c\u00e1c chuy\u1ec3n \u0111\u1ed5i t\u1eeb $q$ sang $clone$, v\u00ec ch\u00fang t\u00f4i kh\u00f4ng mu\u1ed1n thay \u0111\u1ed5i c\u00e1c \u0111\u01b0\u1eddng d\u1eabn \u0111i qua $q$. Ngo\u00e0i ra, ch\u00fang t\u00f4i \u0111\u1eb7t li\u00ean k\u1ebft h\u1eadu t\u1ed1 t\u1eeb $clone$ th\u00e0nh \u0111\u00edch c\u1ee7a li\u00ean k\u1ebft h\u1eadu t\u1ed1 c\u1ee7a $q$, v\u00e0 \u0111\u1eb7t li\u00ean k\u1ebft h\u1eadu t\u1ed1 c\u1ee7a $q$ th\u00e0nh $clone$.</p> <p>V\u00e0 sau khi t\u00e1ch tr\u1ea1ng th\u00e1i, ch\u00fang ta \u0111\u1eb7t li\u00ean k\u1ebft h\u1eadu t\u1ed1 t\u1eeb $cur$ \u0111\u1ebfn $clone$.</p> <p>Trong b\u01b0\u1edbc cu\u1ed1i c\u00f9ng, ch\u00fang t\u00f4i thay \u0111\u1ed5i m\u1ed9t s\u1ed1 chuy\u1ec3n \u0111\u1ed5i th\u00e0nh $q$, ch\u00fang t\u00f4i chuy\u1ec3n h\u01b0\u1edbng ch\u00fang sang $clone$. Ch\u00fang ta ph\u1ea3i thay \u0111\u1ed5i nh\u1eefng chuy\u1ec3n \u0111\u1ed5i n\u00e0o? Ch\u1ec9 c\u1ea7n chuy\u1ec3n h\u01b0\u1edbng c\u00e1c chuy\u1ec3n \u0111\u1ed5i t\u01b0\u01a1ng \u1ee9ng v\u1edbi t\u1ea5t c\u1ea3 c\u00e1c h\u1eadu t\u1ed1 c\u1ee7a chu\u1ed7i $w + c$ (trong \u0111\u00f3 $w$ l\u00e0 chu\u1ed7i d\u00e0i nh\u1ea5t c\u1ee7a $p$) l\u00e0 \u0111\u1ee7, t\u1ee9c l\u00e0 ch\u00fang ta c\u1ea7n ti\u1ebfp t\u1ee5c di chuy\u1ec3n d\u1ecdc theo c\u00e1c li\u00ean k\u1ebft h\u1eadu t\u1ed1, b\u1eaft \u0111\u1ea7u t\u1eeb \u0111\u1ec9nh $p$ cho \u0111\u1ebfn khi ch\u00fang ta \u0111\u1ebfn tr\u1ea1ng th\u00e1i h\u01b0 c\u1ea5u $-1$ ho\u1eb7c m\u1ed9t chuy\u1ec3n \u0111\u1ed5i d\u1eabn \u0111\u1ebfn tr\u1ea1ng th\u00e1i kh\u00e1c v\u1edbi $q$.</p> </li> </ul>","tags":["Translated"]},{"location":"string/suffix-automaton.html#linear-number-of-operations","title":"S\u1ed1 l\u01b0\u1ee3ng ho\u1ea1t \u0111\u1ed9ng tuy\u1ebfn t\u00ednh (Linear number of operations)","text":"<p>\u0110\u1ea7u ti\u00ean, ch\u00fang ta ngay l\u1eadp t\u1ee9c \u0111\u01b0a ra gi\u1ea3 \u0111\u1ecbnh r\u1eb1ng k\u00edch th\u01b0\u1edbc c\u1ee7a b\u1ea3ng ch\u1eef c\u00e1i l\u00e0 h\u1eb1ng s\u1ed1. N\u1ebfu kh\u00f4ng ph\u1ea3i nh\u01b0 v\u1eady, th\u00ec s\u1ebd kh\u00f4ng th\u1ec3 n\u00f3i v\u1ec1 \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian tuy\u1ebfn t\u00ednh. Danh s\u00e1ch c\u00e1c chuy\u1ec3n \u0111\u1ed5i t\u1eeb m\u1ed9t \u0111\u1ec9nh s\u1ebd \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef trong m\u1ed9t c\u00e2y c\u00e2n b\u1eb1ng, cho ph\u00e9p b\u1ea1n nhanh ch\u00f3ng th\u1ef1c hi\u1ec7n c\u00e1c thao t\u00e1c t\u00ecm ki\u1ebfm kh\u00f3a v\u00e0 th\u00eam kh\u00f3a. Do \u0111\u00f3, n\u1ebfu ch\u00fang ta bi\u1ec3u th\u1ecb k\u00edch th\u01b0\u1edbc c\u1ee7a b\u1ea3ng ch\u1eef c\u00e1i b\u1eb1ng $k$, th\u00ec h\u00e0nh vi ti\u1ec7m c\u1eadn c\u1ee7a thu\u1eadt to\u00e1n s\u1ebd l\u00e0 $O(n \\log k)$ v\u1edbi b\u1ed9 nh\u1edb $O(n)$. Tuy nhi\u00ean, n\u1ebfu b\u1ea3ng ch\u1eef c\u00e1i \u0111\u1ee7 nh\u1ecf, th\u00ec b\u1ea1n c\u00f3 th\u1ec3 hy sinh b\u1ed9 nh\u1edb b\u1eb1ng c\u00e1ch tr\u00e1nh c\u00e1c c\u00e2y c\u00e2n b\u1eb1ng v\u00e0 l\u01b0u tr\u1eef c\u00e1c chuy\u1ec3n \u0111\u1ed5i t\u1ea1i m\u1ed7i \u0111\u1ec9nh d\u01b0\u1edbi d\u1ea1ng m\u1ed9t m\u1ea3ng c\u00f3 \u0111\u1ed9 d\u00e0i $k$ (\u0111\u1ec3 t\u00ecm ki\u1ebfm nhanh b\u1eb1ng kh\u00f3a) v\u00e0 danh s\u00e1ch \u0111\u1ed9ng (\u0111\u1ec3 nhanh ch\u00f3ng duy\u1ec7t qua t\u1ea5t c\u1ea3 c\u00e1c kh\u00f3a c\u00f3 s\u1eb5n). Do \u0111\u00f3, ch\u00fang ta \u0111\u1ea1t \u0111\u01b0\u1ee3c \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian $O(n)$ cho thu\u1eadt to\u00e1n, nh\u01b0ng v\u1edbi chi ph\u00ed l\u00e0 \u0111\u1ed9 ph\u1ee9c t\u1ea1p b\u1ed9 nh\u1edb $O(n k)$.</p> <p>V\u00ec v\u1eady, ch\u00fang t\u00f4i s\u1ebd coi k\u00edch th\u01b0\u1edbc c\u1ee7a b\u1ea3ng ch\u1eef c\u00e1i l\u00e0 h\u1eb1ng s\u1ed1, t\u1ee9c l\u00e0 m\u1ed7i thao t\u00e1c t\u00ecm ki\u1ebfm chuy\u1ec3n \u0111\u1ed5i tr\u00ean m\u1ed9t k\u00fd t\u1ef1, th\u00eam chuy\u1ec3n \u0111\u1ed5i, t\u00ecm ki\u1ebfm chuy\u1ec3n \u0111\u1ed5i ti\u1ebfp theo - t\u1ea5t c\u1ea3 c\u00e1c thao t\u00e1c n\u00e0y \u0111\u1ec1u c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong $O(1)$.</p> <p>N\u1ebfu ch\u00fang ta xem x\u00e9t t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n c\u1ee7a thu\u1eadt to\u00e1n, th\u00ec n\u00f3 ch\u1ee9a ba v\u1ecb tr\u00ed trong thu\u1eadt to\u00e1n m\u00e0 \u0111\u1ed9 ph\u1ee9c t\u1ea1p tuy\u1ebfn t\u00ednh kh\u00f4ng r\u00f5 r\u00e0ng:</p> <ul> <li>V\u1ecb tr\u00ed \u0111\u1ea7u ti\u00ean l\u00e0 truy\u1ec1n qua c\u00e1c li\u00ean k\u1ebft h\u1eadu t\u1ed1 t\u1eeb tr\u1ea1ng th\u00e1i $last$, th\u00eam c\u00e1c chuy\u1ec3n \u0111\u1ed5i v\u1edbi k\u00fd t\u1ef1 $c$.</li> <li>V\u1ecb tr\u00ed th\u1ee9 hai l\u00e0 sao ch\u00e9p c\u00e1c chuy\u1ec3n \u0111\u1ed5i khi tr\u1ea1ng th\u00e1i $q$ \u0111\u01b0\u1ee3c nh\u00e2n b\u1ea3n th\u00e0nh m\u1ed9t tr\u1ea1ng th\u00e1i m\u1edbi $clone$.</li> <li>V\u1ecb tr\u00ed th\u1ee9 ba l\u00e0 thay \u0111\u1ed5i qu\u00e1 tr\u00ecnh chuy\u1ec3n \u0111\u1ed5i d\u1eabn \u0111\u1ebfn $q$, chuy\u1ec3n h\u01b0\u1edbng ch\u00fang \u0111\u1ebfn $clone$.</li> </ul> <p>Ch\u00fang t\u00f4i s\u1eed d\u1ee5ng th\u1ef1c t\u1ebf l\u00e0 k\u00edch th\u01b0\u1edbc c\u1ee7a suffix automaton (c\u1ea3 v\u1ec1 s\u1ed1 l\u01b0\u1ee3ng tr\u1ea1ng th\u00e1i v\u00e0 s\u1ed1 l\u01b0\u1ee3ng chuy\u1ec3n \u0111\u1ed5i) l\u00e0 tuy\u1ebfn t\u00ednh. (B\u1eb1ng ch\u1ee9ng v\u1ec1 t\u00ednh tuy\u1ebfn t\u00ednh c\u1ee7a s\u1ed1 l\u01b0\u1ee3ng tr\u1ea1ng th\u00e1i l\u00e0 ch\u00ednh thu\u1eadt to\u00e1n, v\u00e0 b\u1eb1ng ch\u1ee9ng v\u1ec1 t\u00ednh tuy\u1ebfn t\u00ednh c\u1ee7a s\u1ed1 l\u01b0\u1ee3ng tr\u1ea1ng th\u00e1i \u0111\u01b0\u1ee3c \u0111\u01b0a ra b\u00ean d\u01b0\u1edbi, sau khi th\u1ef1c hi\u1ec7n thu\u1eadt to\u00e1n).</p> <p>Do \u0111\u00f3, t\u1ed5ng \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a v\u1ecb tr\u00ed th\u1ee9 nh\u1ea5t v\u00e0 th\u1ee9 hai l\u00e0 hi\u1ec3n nhi\u00ean, sau c\u00f9ng th\u00ec m\u1ed7i thao t\u00e1c ch\u1ec9 th\u00eam m\u1ed9t chuy\u1ec3n \u0111\u1ed5i m\u1edbi \u0111\u01b0\u1ee3c kh\u1ea5u hao v\u00e0o automaton.</p> <p>V\u1eabn c\u00f2n ph\u1ea3i \u01b0\u1edbc t\u00ednh t\u1ed5ng \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a v\u1ecb tr\u00ed th\u1ee9 ba, trong \u0111\u00f3 ch\u00fang ta chuy\u1ec3n h\u01b0\u1edbng c\u00e1c chuy\u1ec3n \u0111\u1ed5i, ban \u0111\u1ea7u tr\u1ecf \u0111\u1ebfn $q$, sang $clone$. Ch\u00fang t\u00f4i k\u00fd hi\u1ec7u $v = longest(p)$. \u0110\u00e2y l\u00e0 h\u1eadu t\u1ed1 c\u1ee7a chu\u1ed7i $s$, v\u00e0 v\u1edbi m\u1ed7i l\u1ea7n l\u1eb7p, \u0111\u1ed9 d\u00e0i c\u1ee7a n\u00f3 gi\u1ea3m d\u1ea7n - v\u00e0 do \u0111\u00f3 v\u1ecb tr\u00ed $v$ l\u00e0 h\u1eadu t\u1ed1 c\u1ee7a chu\u1ed7i $s$ t\u0103ng \u0111\u01a1n \u0111i\u1ec7u v\u1edbi m\u1ed7i l\u1ea7n l\u1eb7p. Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, n\u1ebfu tr\u01b0\u1edbc l\u1ea7n l\u1eb7p \u0111\u1ea7u ti\u00ean c\u1ee7a v\u00f2ng l\u1eb7p, chu\u1ed7i t\u01b0\u01a1ng \u1ee9ng $v$ \u1edf \u0111\u1ed9 s\u00e2u $k$ ($k \\ge 2$) t\u1eeb $last$ (b\u1eb1ng c\u00e1ch \u0111\u1ebfm \u0111\u1ed9 s\u00e2u l\u00e0 s\u1ed1 l\u01b0\u1ee3ng li\u00ean k\u1ebft h\u1eadu t\u1ed1), th\u00ec sau l\u1ea7n l\u1eb7p cu\u1ed1i c\u00f9ng chu\u1ed7i $v + c$ s\u1ebd l\u00e0 li\u00ean k\u1ebft h\u1eadu t\u1ed1 th\u1ee9 $2$ tr\u00ean \u0111\u01b0\u1eddng d\u1eabn t\u1eeb $cur$ (s\u1ebd tr\u1edf th\u00e0nh gi\u00e1 tr\u1ecb $last$ m\u1edbi).</p> <p>Do \u0111\u00f3, m\u1ed7i l\u1ea7n l\u1eb7p c\u1ee7a v\u00f2ng l\u1eb7p n\u00e0y d\u1eabn \u0111\u1ebfn th\u1ef1c t\u1ebf l\u00e0 v\u1ecb tr\u00ed c\u1ee7a chu\u1ed7i $longest(link(link(last))$ l\u00e0 h\u1eadu t\u1ed1 c\u1ee7a chu\u1ed7i hi\u1ec7n t\u1ea1i s\u1ebd t\u0103ng \u0111\u01a1n \u0111i\u1ec7u. Do \u0111\u00f3, chu tr\u00ecnh n\u00e0y kh\u00f4ng th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n qu\u00e1 $n$ l\u1ea7n l\u1eb7p, \u0111\u00f3 l\u00e0 \u0111i\u1ec1u c\u1ea7n thi\u1ebft \u0111\u1ec3 ch\u1ee9ng minh.</p>","tags":["Translated"]},{"location":"string/suffix-automaton.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>\u0110\u1ea7u ti\u00ean, ch\u00fang t\u00f4i m\u00f4 t\u1ea3 m\u1ed9t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u s\u1ebd l\u01b0u tr\u1eef t\u1ea5t c\u1ea3 th\u00f4ng tin v\u1ec1 m\u1ed9t chuy\u1ec3n \u0111\u1ed5i c\u1ee5 th\u1ec3 ($len$, $link$ v\u00e0 danh s\u00e1ch chuy\u1ec3n \u0111\u1ed5i). N\u1ebfu c\u1ea7n, b\u1ea1n c\u00f3 th\u1ec3 th\u00eam c\u1edd \u0111\u1ea7u cu\u1ed1i t\u1ea1i \u0111\u00e2y, c\u0169ng nh\u01b0 th\u00f4ng tin kh\u00e1c. Ch\u00fang t\u00f4i s\u1ebd l\u01b0u tr\u1eef danh s\u00e1ch c\u00e1c chuy\u1ec3n \u0111\u1ed5i d\u01b0\u1edbi d\u1ea1ng $map$, cho ph\u00e9p ch\u00fang t\u00f4i \u0111\u1ea1t \u0111\u01b0\u1ee3c t\u1ed5ng b\u1ed9 nh\u1edb $O(n)$ v\u00e0 $O(n \\log k)$ th\u1eddi gian \u0111\u1ec3 x\u1eed l\u00fd to\u00e0n b\u1ed9 chu\u1ed7i.</p> <pre><code>struct state {\n    int len, link;\n    map&lt;char, int&gt; next;\n};\n</code></pre> <p>B\u1ea3n th\u00e2n suffix automaton s\u1ebd \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef trong m\u1ed9t m\u1ea3ng c\u00e1c c\u1ea5u tr\u00fac n\u00e0y $state$. Ch\u00fang t\u00f4i l\u01b0u tr\u1eef k\u00edch th\u01b0\u1edbc hi\u1ec7n t\u1ea1i $sz$ v\u00e0 bi\u1ebfn $last$, tr\u1ea1ng th\u00e1i t\u01b0\u01a1ng \u1ee9ng v\u1edbi to\u00e0n b\u1ed9 chu\u1ed7i t\u1ea1i th\u1eddi \u0111i\u1ec3m n\u00e0y.</p> <pre><code>const int MAXLEN = 100000;\nstate st[MAXLEN * 2];\nint sz, last;\n</code></pre> <p>Ch\u00fang t\u00f4i \u0111\u01b0a ra m\u1ed9t ch\u1ee9c n\u0103ng kh\u1edfi t\u1ea1o suffix automaton (t\u1ea1o suffix automaton v\u1edbi m\u1ed9t tr\u1ea1ng th\u00e1i duy nh\u1ea5t).</p> <pre><code>void sa_init() {\n    st[0].len = 0;\n    st[0].link = -1;\n    sz++;\n    last = 0;\n}\n</code></pre> <p>V\u00e0 cu\u1ed1i c\u00f9ng ch\u00fang t\u00f4i \u0111\u01b0a ra vi\u1ec7c th\u1ef1c hi\u1ec7n ch\u1ee9c n\u0103ng ch\u00ednh - th\u00eam k\u00fd t\u1ef1 ti\u1ebfp theo v\u00e0o cu\u1ed1i d\u00f2ng hi\u1ec7n t\u1ea1i, x\u00e2y d\u1ef1ng l\u1ea1i m\u00e1y cho ph\u00f9 h\u1ee3p.</p> <pre><code>void sa_extend(char c) {\n    int cur = sz++;\n    st[cur].len = st[last].len + 1;\n    int p = last;\n    while (p != -1 &amp;&amp; !st[p].next.count(c)) {\n        st[p].next[c] = cur;\n        p = st[p].link;\n    }\n    if (p == -1) {\n        st[cur].link = 0;\n    } else {\n        int q = st[p].next[c];\n        if (st[p].len + 1 == st[q].len) {\n            st[cur].link = q;\n        } else {\n            int clone = sz++;\n            st[clone].len = st[p].len + 1;\n            st[clone].next = st[q].next;\n            st[clone].link = st[q].link;\n            while (p != -1 &amp;&amp; st[p].next[c] == q) {\n                st[p].next[c] = clone;\n                p = st[p].link;\n            }\n            st[q].link = st[cur].link = clone;\n        }\n    }\n    last = cur;\n}\n</code></pre> <p>Nh\u01b0 \u0111\u00e3 \u0111\u1ec1 c\u1eadp \u1edf tr\u00ean, n\u1ebfu b\u1ea1n hy sinh b\u1ed9 nh\u1edb ($O(n k)$, trong \u0111\u00f3 $k$ l\u00e0 k\u00edch th\u01b0\u1edbc b\u1ea3ng ch\u1eef c\u00e1i), th\u00ec b\u1ea1n c\u00f3 th\u1ec3 \u0111\u1ea1t \u0111\u01b0\u1ee3c th\u1eddi gian x\u00e2y d\u1ef1ng m\u00e1y trong $O(n)$, ngay c\u1ea3 \u0111\u1ed1i v\u1edbi b\u1ea5t k\u1ef3 k\u00edch th\u01b0\u1edbc b\u1ea3ng ch\u1eef c\u00e1i n\u00e0o $k$. Nh\u01b0ng \u0111\u1ed1i v\u1edbi \u0111i\u1ec1u n\u00e0y, b\u1ea1n s\u1ebd ph\u1ea3i l\u01b0u tr\u1eef m\u1ed9t m\u1ea3ng c\u00f3 k\u00edch th\u01b0\u1edbc $k$ trong m\u1ed7i tr\u1ea1ng th\u00e1i (\u0111\u1ec3 nhanh ch\u00f3ng chuy\u1ec3n sang qu\u00e1 tr\u00ecnh chuy\u1ec3n \u0111\u1ed5i c\u1ee7a ch\u1eef c\u00e1i), v\u00e0 th\u00eam danh s\u00e1ch t\u1ea5t c\u1ea3 c\u00e1c chuy\u1ec3n \u0111\u1ed5i (\u0111\u1ec3 nhanh ch\u00f3ng l\u1eb7p l\u1ea1i c\u00e1c chuy\u1ec3n \u0111\u1ed5i \u0111\u00f3).</p>","tags":["Translated"]},{"location":"string/suffix-automaton.html#additional-properties","title":"Thu\u1ed9c t\u00ednh b\u1ed5 sung (Additional properties)","text":"","tags":["Translated"]},{"location":"string/suffix-automaton.html#number-of-states","title":"S\u1ed1 l\u01b0\u1ee3ng tr\u1ea1ng th\u00e1i (Number of states)","text":"<p>S\u1ed1 l\u01b0\u1ee3ng tr\u1ea1ng th\u00e1i trong suffix automaton c\u1ee7a chu\u1ed7i $s$ c\u00f3 \u0111\u1ed9 d\u00e0i $n$ kh\u00f4ng v\u01b0\u1ee3t qu\u00e1 $2n - 1$ (v\u1edbi $n \\ge 2$).</p> <p>B\u1eb1ng ch\u1ee9ng l\u00e0 ch\u00ednh thu\u1eadt to\u00e1n x\u00e2y d\u1ef1ng, v\u00ec ban \u0111\u1ea7u automaton bao g\u1ed3m m\u1ed9t tr\u1ea1ng th\u00e1i, v\u00e0 trong l\u1ea7n l\u1eb7p \u0111\u1ea7u ti\u00ean v\u00e0 th\u1ee9 hai, ch\u1ec9 c\u00f3 m\u1ed9t tr\u1ea1ng th\u00e1i duy nh\u1ea5t s\u1ebd \u0111\u01b0\u1ee3c t\u1ea1o ra, v\u00e0 trong $n-2$ b\u01b0\u1edbc c\u00f2n l\u1ea1i, t\u1ed1i \u0111a $2$ tr\u1ea1ng th\u00e1i s\u1ebd \u0111\u01b0\u1ee3c t\u1ea1o ra m\u1ed7i b\u01b0\u1edbc.</p> <p>Tuy nhi\u00ean, ch\u00fang t\u00f4i c\u0169ng c\u00f3 th\u1ec3 hi\u1ec3n th\u1ecb \u01b0\u1edbc t\u00ednh n\u00e0y m\u00e0 kh\u00f4ng c\u1ea7n bi\u1ebft thu\u1eadt to\u00e1n. Ch\u00fang ta h\u00e3y nh\u1edb l\u1ea1i r\u1eb1ng s\u1ed1 l\u01b0\u1ee3ng tr\u1ea1ng th\u00e1i b\u1eb1ng s\u1ed1 l\u01b0\u1ee3ng c\u00e1c t\u1eadp h\u1ee3p kh\u00e1c nhau $endpos$. Ngo\u00e0i ra, c\u00e1c t\u1eadp h\u1ee3p $endpos$ n\u00e0y t\u1ea1o th\u00e0nh m\u1ed9t c\u00e2y (\u0111\u1ec9nh cha ch\u1ee9a t\u1ea5t c\u1ea3 c\u00e1c t\u1eadp h\u1ee3p con trong t\u1eadp h\u1ee3p c\u1ee7a m\u00ecnh). Xem x\u00e9t c\u00e2y n\u00e0y v\u00e0 bi\u1ebfn \u0111\u1ed5i n\u00f3 m\u1ed9t ch\u00fat: mi\u1ec5n l\u00e0 n\u00f3 c\u00f3 m\u1ed9t \u0111\u1ec9nh b\u00ean trong ch\u1ec9 c\u00f3 m\u1ed9t con (c\u00f3 ngh\u0129a l\u00e0 t\u1eadp h\u1ee3p c\u1ee7a con b\u1ecf l\u1ee1 \u00edt nh\u1ea5t m\u1ed9t v\u1ecb tr\u00ed t\u1eeb t\u1eadp h\u1ee3p cha), ch\u00fang t\u00f4i t\u1ea1o m\u1ed9t con m\u1edbi v\u1edbi t\u1eadp h\u1ee3p c\u00e1c v\u1ecb tr\u00ed b\u1ecb thi\u1ebfu. Cu\u1ed1i c\u00f9ng, ch\u00fang ta c\u00f3 m\u1ed9t c\u00e1i c\u00e2y trong \u0111\u00f3 m\u1ed7i \u0111\u1ec9nh b\u00ean trong c\u00f3 b\u1eadc l\u1edbn h\u01a1n m\u1ed9t, v\u00e0 s\u1ed1 l\u01b0\u1ee3ng l\u00e1 kh\u00f4ng v\u01b0\u1ee3t qu\u00e1 $n$. Do \u0111\u00f3, kh\u00f4ng c\u00f3 qu\u00e1 $2n - 1$ \u0111\u1ec9nh trong m\u1ed9t c\u00e2y nh\u01b0 v\u1eady.</p> <p>Gi\u1edbi h\u1ea1n v\u1ec1 s\u1ed1 l\u01b0\u1ee3ng tr\u1ea1ng th\u00e1i n\u00e0y th\u1ef1c s\u1ef1 c\u00f3 th\u1ec3 \u0111\u1ea1t \u0111\u01b0\u1ee3c cho m\u1ed7i $n$. M\u1ed9t chu\u1ed7i c\u00f3 th\u1ec3 l\u00e0:</p> $$\\text{\"abbb}\\dots \\text{bbb\"}$$ <p>Trong m\u1ed7i l\u1ea7n l\u1eb7p, b\u1eaft \u0111\u1ea7u t\u1eeb l\u1ea7n th\u1ee9 ba, thu\u1eadt to\u00e1n s\u1ebd t\u00e1ch m\u1ed9t tr\u1ea1ng th\u00e1i, d\u1eabn \u0111\u1ebfn ch\u00ednh x\u00e1c $2n - 1$ tr\u1ea1ng th\u00e1i.</p>","tags":["Translated"]},{"location":"string/suffix-automaton.html#number-of-transitions","title":"S\u1ed1 l\u01b0\u1ee3t chuy\u1ec3n \u0111\u1ed5i (Number of transitions)","text":"<p>S\u1ed1 l\u1ea7n chuy\u1ec3n \u0111\u1ed5i trong m\u1ed9t suffix automaton c\u1ee7a m\u1ed9t chu\u1ed7i $s$ c\u00f3 \u0111\u1ed9 d\u00e0i $n$ kh\u00f4ng v\u01b0\u1ee3t qu\u00e1 $3n - 4$ (v\u1edbi $n \\ge 3$).</p> <p>H\u00e3y ch\u1ee9ng minh \u0111i\u1ec1u n\u00e0y:</p> <p>Tr\u01b0\u1edbc ti\u00ean ch\u00fang ta h\u00e3y \u01b0\u1edbc t\u00ednh s\u1ed1 l\u01b0\u1ee3ng chuy\u1ec3n \u0111\u1ed5i li\u00ean t\u1ee5c. Xem x\u00e9t m\u1ed9t c\u00e2y bao tr\u00f9m c\u00e1c \u0111\u01b0\u1eddng d\u1eabn d\u00e0i nh\u1ea5t trong automaton b\u1eaft \u0111\u1ea7u \u1edf tr\u1ea1ng th\u00e1i $t_0$. B\u1ed9 x\u01b0\u01a1ng n\u00e0y s\u1ebd ch\u1ec9 bao g\u1ed3m c\u00e1c c\u1ea1nh li\u00ean t\u1ee5c, v\u00e0 do \u0111\u00f3 s\u1ed1 l\u01b0\u1ee3ng c\u1ee7a ch\u00fang nh\u1ecf h\u01a1n s\u1ed1 l\u01b0\u1ee3ng tr\u1ea1ng th\u00e1i, t\u1ee9c l\u00e0 n\u00f3 kh\u00f4ng v\u01b0\u1ee3t qu\u00e1 $2n - 2$.</p> <p>B\u00e2y gi\u1edd ch\u00fang ta h\u00e3y \u01b0\u1edbc t\u00ednh s\u1ed1 l\u01b0\u1ee3ng chuy\u1ec3n \u0111\u1ed5i kh\u00f4ng li\u00ean t\u1ee5c. G\u1ecdi chuy\u1ec3n \u0111\u1ed5i kh\u00f4ng li\u00ean t\u1ee5c hi\u1ec7n t\u1ea1i l\u00e0 $(p, q)$ v\u1edbi k\u00fd t\u1ef1 $c$. Ch\u00fang t\u00f4i l\u1ea5y chu\u1ed7i t\u01b0\u01a1ng \u1ee9ng $u + c + w$, trong \u0111\u00f3 chu\u1ed7i $u$ t\u01b0\u01a1ng \u1ee9ng v\u1edbi \u0111\u01b0\u1eddng d\u1eabn d\u00e0i nh\u1ea5t t\u1eeb tr\u1ea1ng th\u00e1i ban \u0111\u1ea7u \u0111\u1ebfn $p$, v\u00e0 $w$ \u0111\u1ebfn \u0111\u01b0\u1eddng d\u1eabn d\u00e0i nh\u1ea5t t\u1eeb $q$ \u0111\u1ebfn b\u1ea5t k\u1ef3 tr\u1ea1ng th\u00e1i k\u1ebft th\u00fac n\u00e0o. M\u1ed9t m\u1eb7t, m\u1ed7i chu\u1ed7i nh\u01b0 v\u1eady $u + c + w$ cho m\u1ed7i chu\u1ed7i kh\u00f4ng ho\u00e0n ch\u1ec9nh s\u1ebd kh\u00e1c nhau (v\u00ec c\u00e1c chu\u1ed7i $u$ v\u00e0 $w$ ch\u1ec9 \u0111\u01b0\u1ee3c h\u00ecnh th\u00e0nh b\u1edfi c\u00e1c chuy\u1ec3n \u0111\u1ed5i ho\u00e0n ch\u1ec9nh). M\u1eb7t kh\u00e1c, m\u1ed7i chu\u1ed7i nh\u01b0 v\u1eady $u + c + w$, theo \u0111\u1ecbnh ngh\u0129a c\u1ee7a c\u00e1c tr\u1ea1ng th\u00e1i k\u1ebft th\u00fac, s\u1ebd l\u00e0 h\u1eadu t\u1ed1 c\u1ee7a to\u00e0n b\u1ed9 chu\u1ed7i $s$. V\u00ec ch\u1ec9 c\u00f3 $n$ h\u1eadu t\u1ed1 kh\u00f4ng r\u1ed7ng c\u1ee7a $s$, v\u00e0 kh\u00f4ng c\u00f3 chu\u1ed7i n\u00e0o trong s\u1ed1 $u + c + w$ c\u00f3 th\u1ec3 ch\u1ee9a $s$ (b\u1edfi v\u00ec to\u00e0n b\u1ed9 chu\u1ed7i ch\u1ec9 ch\u1ee9a c\u00e1c chuy\u1ec3n \u0111\u1ed5i ho\u00e0n ch\u1ec9nh), t\u1ed5ng s\u1ed1 chuy\u1ec3n \u0111\u1ed5i kh\u00f4ng ho\u00e0n ch\u1ec9nh kh\u00f4ng v\u01b0\u1ee3t qu\u00e1 $n - 1$.</p> <p>K\u1ebft h\u1ee3p hai \u01b0\u1edbc t\u00ednh n\u00e0y cho ch\u00fang ta gi\u1edbi h\u1ea1n $3n - 3$. Tuy nhi\u00ean, v\u00ec s\u1ed1 l\u01b0\u1ee3ng tr\u1ea1ng th\u00e1i t\u1ed1i \u0111a ch\u1ec9 c\u00f3 th\u1ec3 \u0111\u1ea1t \u0111\u01b0\u1ee3c v\u1edbi tr\u01b0\u1eddng h\u1ee3p th\u1eed nghi\u1ec7m $\\text{\"abbb\\dots bbb\"}$ v\u00e0 tr\u01b0\u1eddng h\u1ee3p n\u00e0y r\u00f5 r\u00e0ng c\u00f3 \u00edt h\u01a1n $3n - 3$ chuy\u1ec3n \u0111\u1ed5i, ch\u00fang t\u00f4i nh\u1eadn \u0111\u01b0\u1ee3c gi\u1edbi h\u1ea1n ch\u1eb7t ch\u1ebd h\u01a1n $3n - 4$ cho s\u1ed1 l\u1ea7n chuy\u1ec3n \u0111\u1ed5i trong m\u1ed9t suffix automaton.</p> <p>Gi\u1edbi h\u1ea1n n\u00e0y c\u0169ng c\u00f3 th\u1ec3 \u0111\u1ea1t \u0111\u01b0\u1ee3c v\u1edbi chu\u1ed7i:</p> $$\\text{\"abbb}\\dots \\text{bbbc\"}$$","tags":["Translated"]},{"location":"string/suffix-automaton.html#applications","title":"\u1ee8ng d\u1ee5ng (Applications)","text":"<p>\u1ede \u0111\u00e2y ch\u00fang ta xem x\u00e9t m\u1ed9t s\u1ed1 nhi\u1ec7m v\u1ee5 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i quy\u1ebft b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng suffix automaton. \u0110\u1ec3 \u0111\u01a1n gi\u1ea3n, ch\u00fang t\u00f4i gi\u1ea3 \u0111\u1ecbnh r\u1eb1ng k\u00edch th\u01b0\u1edbc b\u1ea3ng ch\u1eef c\u00e1i $k$ l\u00e0 kh\u00f4ng \u0111\u1ed5i, \u0111i\u1ec1u n\u00e0y cho ph\u00e9p ch\u00fang t\u00f4i xem x\u00e9t \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a vi\u1ec7c g\u1eafn th\u00eam m\u1ed9t k\u00fd t\u1ef1 v\u00e0 truy\u1ec1n t\u1ea3i l\u00e0 h\u1eb1ng s\u1ed1.</p>","tags":["Translated"]},{"location":"string/suffix-automaton.html#check-for-occurrence","title":"Ki\u1ec3m tra s\u1ef1 xu\u1ea5t hi\u1ec7n (Check for occurrence)","text":"<p>Cho m\u1ed9t v\u0103n b\u1ea3n $T$, v\u00e0 nhi\u1ec1u m\u1eabu $P$. Ch\u00fang ta ph\u1ea3i ki\u1ec3m tra xem c\u00e1c chu\u1ed7i $P$ c\u00f3 xu\u1ea5t hi\u1ec7n d\u01b0\u1edbi d\u1ea1ng chu\u1ed7i con c\u1ee7a $T$ hay kh\u00f4ng.</p> <p>Ch\u00fang t\u00f4i x\u00e2y d\u1ef1ng m\u1ed9t suffix automaton c\u1ee7a v\u0103n b\u1ea3n $T$ trong th\u1eddi gian $O(length(T))$. \u0110\u1ec3 ki\u1ec3m tra xem m\u1eabu $P$ c\u00f3 xu\u1ea5t hi\u1ec7n trong $T$ hay kh\u00f4ng, ch\u00fang t\u00f4i l\u00e0m theo c\u00e1c chuy\u1ec3n \u0111\u1ed5i, b\u1eaft \u0111\u1ea7u t\u1eeb $t_0$, theo c\u00e1c k\u00fd t\u1ef1 c\u1ee7a $P$. N\u1ebfu t\u1ea1i m\u1ed9t th\u1eddi \u0111i\u1ec3m n\u00e0o \u0111\u00f3 kh\u00f4ng t\u1ed3n t\u1ea1i m\u1ed9t chuy\u1ec3n \u0111\u1ed5i, th\u00ec m\u1eabu $P$ kh\u00f4ng xu\u1ea5t hi\u1ec7n d\u01b0\u1edbi d\u1ea1ng chu\u1ed7i con c\u1ee7a $T$. N\u1ebfu ch\u00fang ta c\u00f3 th\u1ec3 x\u1eed l\u00fd to\u00e0n b\u1ed9 chu\u1ed7i $P$ theo c\u00e1ch n\u00e0y, th\u00ec chu\u1ed7i xu\u1ea5t hi\u1ec7n trong $T$.</p> <p>R\u00f5 r\u00e0ng l\u00e0 \u0111i\u1ec1u n\u00e0y s\u1ebd m\u1ea5t th\u1eddi gian $O(length(P))$ cho m\u1ed7i chu\u1ed7i $P$. H\u01a1n n\u1eefa, thu\u1eadt to\u00e1n th\u1ef1c s\u1ef1 t\u00ecm th\u1ea5y \u0111\u1ed9 d\u00e0i c\u1ee7a ti\u1ec1n t\u1ed1 d\u00e0i nh\u1ea5t c\u1ee7a $P$ xu\u1ea5t hi\u1ec7n trong v\u0103n b\u1ea3n.</p>","tags":["Translated"]},{"location":"string/suffix-automaton.html#number-of-different-substrings","title":"S\u1ed1 l\u01b0\u1ee3ng chu\u1ed7i con kh\u00e1c nhau (Number of different substrings)","text":"<p>Cho m\u1ed9t chu\u1ed7i $S$. B\u1ea1n mu\u1ed1n t\u00ednh to\u00e1n s\u1ed1 l\u01b0\u1ee3ng chu\u1ed7i con kh\u00e1c nhau.</p> <p>Ch\u00fang ta h\u00e3y x\u00e2y d\u1ef1ng m\u1ed9t suffix automaton cho chu\u1ed7i $S$.</p> <p>M\u1ed7i chu\u1ed7i con c\u1ee7a $S$ t\u01b0\u01a1ng \u1ee9ng v\u1edbi m\u1ed9t s\u1ed1 \u0111\u01b0\u1eddng d\u1eabn trong automaton. Do \u0111\u00f3 s\u1ed1 chu\u1ed7i con kh\u00e1c nhau b\u1eb1ng s\u1ed1 \u0111\u01b0\u1eddng d\u1eabn kh\u00e1c nhau trong automaton b\u1eaft \u0111\u1ea7u t\u1eeb $t_0$.</p> <p>Cho r\u1eb1ng suffix automaton l\u00e0 m\u1ed9t \u0111\u1ed3 th\u1ecb c\u00f3 h\u01b0\u1edbng kh\u00f4ng c\u00f3 chu tr\u00ecnh, s\u1ed1 l\u01b0\u1ee3ng c\u00e1c c\u00e1ch kh\u00e1c nhau c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ednh b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng quy ho\u1ea1ch \u0111\u1ed9ng.</p> <p>C\u1ee5 th\u1ec3, \u0111\u1eb7t $d[v]$ l\u00e0 s\u1ed1 c\u00e1ch, b\u1eaft \u0111\u1ea7u \u1edf tr\u1ea1ng th\u00e1i $v$ (bao g\u1ed3m c\u1ea3 \u0111\u01b0\u1eddng d\u1eabn c\u00f3 \u0111\u1ed9 d\u00e0i b\u1eb1ng 0). Sau \u0111\u00f3 ch\u00fang ta c\u00f3 \u0111\u1ec7 quy:</p> $$d[v] = 1 + \\sum_{w : (v, w, c) \\in DAWG} d[w]$$ <p>T\u1ee9c l\u00e0 $d[v]$ c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bi\u1ec3u th\u1ecb b\u1eb1ng t\u1ed5ng c\u00e1c c\u00e2u tr\u1ea3 l\u1eddi cho t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ea7u c\u1ee7a qu\u00e1 tr\u00ecnh chuy\u1ec3n \u0111\u1ed5i c\u1ee7a $v$.</p> <p>S\u1ed1 l\u01b0\u1ee3ng chu\u1ed7i con kh\u00e1c nhau l\u00e0 gi\u00e1 tr\u1ecb $d[t_0] - 1$ (v\u00ec ch\u00fang ta kh\u00f4ng t\u00ednh chu\u1ed7i con r\u1ed7ng).</p> <p>T\u1ed5ng \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian: $O(length(S))$</p> <p>Ngo\u00e0i ra, ch\u00fang ta c\u00f3 th\u1ec3 t\u1eadn d\u1ee5ng l\u1ee3i th\u1ebf c\u1ee7a th\u1ef1c t\u1ebf l\u00e0 m\u1ed7i tr\u1ea1ng th\u00e1i $v$ kh\u1edbp v\u1edbi c\u00e1c chu\u1ed7i con c\u00f3 \u0111\u1ed9 d\u00e0i $[minlen(v),len(v)]$. Do \u0111\u00f3, v\u1edbi $minlen(v) = 1 + len(link(v))$, ch\u00fang ta c\u00f3 t\u1ed5ng s\u1ed1 chu\u1ed7i con ri\u00eang bi\u1ec7t \u1edf tr\u1ea1ng th\u00e1i $v$ l\u00e0 $len(v) - minlen(v) + 1 = len(v) - (1 + len(link(v))) + 1 = len(v) - len(link(v))$.</p> <p>\u0110i\u1ec1u n\u00e0y \u0111\u01b0\u1ee3c ch\u1ee9ng minh ng\u1eafn g\u1ecdn d\u01b0\u1edbi \u0111\u00e2y:</p> <pre><code>long long get_diff_strings(){\n    long long tot = 0;\n    for(int i = 1; i &lt; sz; i++) {\n        tot += st[i].len - st[st[i].link].len;\n    }\n    return tot;\n}\n</code></pre> <p>M\u1eb7c d\u00f9 \u0111\u00e2y c\u0169ng l\u00e0 $O(length(S))$, nh\u01b0ng n\u00f3 kh\u00f4ng y\u00eau c\u1ea7u th\u00eam kh\u00f4ng gian v\u00e0 kh\u00f4ng c\u00f3 l\u1ec7nh g\u1ecdi \u0111\u1ec7 quy, do \u0111\u00f3 ch\u1ea1y nhanh h\u01a1n trong th\u1ef1c t\u1ebf.</p>","tags":["Translated"]},{"location":"string/suffix-automaton.html#total-length-of-all-different-substrings","title":"T\u1ed5ng \u0111\u1ed9 d\u00e0i c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c chu\u1ed7i con kh\u00e1c nhau (Total length of all different substrings)","text":"<p>Cho m\u1ed9t chu\u1ed7i $S$. Ch\u00fang t\u00f4i mu\u1ed1n t\u00ednh to\u00e1n t\u1ed5ng \u0111\u1ed9 d\u00e0i c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c chu\u1ed7i con kh\u00e1c nhau c\u1ee7a n\u00f3.</p> <p>Gi\u1ea3i ph\u00e1p t\u01b0\u01a1ng t\u1ef1 nh\u01b0 gi\u1ea3i ph\u00e1p tr\u01b0\u1edbc, ch\u1ec9 b\u00e2y gi\u1edd c\u1ea7n ph\u1ea3i xem x\u00e9t hai \u0111\u1ea1i l\u01b0\u1ee3ng cho ph\u1ea7n quy ho\u1ea1ch \u0111\u1ed9ng: s\u1ed1 l\u01b0\u1ee3ng chu\u1ed7i con kh\u00e1c nhau $d[v]$ v\u00e0 t\u1ed5ng \u0111\u1ed9 d\u00e0i c\u1ee7a ch\u00fang $ans[v]$.</p> <p>Ch\u00fang t\u00f4i \u0111\u00e3 m\u00f4 t\u1ea3 c\u00e1ch t\u00ednh $d[v]$ trong t\u00e1c v\u1ee5 tr\u01b0\u1edbc. Gi\u00e1 tr\u1ecb $ans[v]$ c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ednh b\u1eb1ng \u0111\u1ec7 quy:</p> $$ans[v] = \\sum_{w : (v, w, c) \\in DAWG} d[w] + ans[w]$$ <p>Ch\u00fang ta l\u1ea5y c\u00e2u tr\u1ea3 l\u1eddi c\u1ee7a m\u1ed7i \u0111\u1ec9nh li\u1ec1n k\u1ec1 $w$, v\u00e0 th\u00eam v\u00e0o \u0111\u00f3 $d[w]$ (v\u00ec m\u1ed7i chu\u1ed7i con d\u00e0i h\u01a1n m\u1ed9t k\u00fd t\u1ef1 khi b\u1eaft \u0111\u1ea7u t\u1eeb tr\u1ea1ng th\u00e1i $v$).</p> <p>M\u1ed9t l\u1ea7n n\u1eefa nhi\u1ec7m v\u1ee5 n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n trong th\u1eddi gian $O(length(S))$.</p> <p>Ngo\u00e0i ra, m\u1ed9t l\u1ea7n n\u1eefa, ch\u00fang ta c\u00f3 th\u1ec3 t\u1eadn d\u1ee5ng l\u1ee3i th\u1ebf c\u1ee7a th\u1ef1c t\u1ebf l\u00e0 m\u1ed7i tr\u1ea1ng th\u00e1i $v$ kh\u1edbp v\u1edbi c\u00e1c chu\u1ed7i con c\u00f3 \u0111\u1ed9 d\u00e0i $[minlen(v),len(v)]$. V\u00ec $minlen(v) = 1 + len(link(v))$ v\u00e0 c\u00f4ng th\u1ee9c chu\u1ed7i s\u1ed1 h\u1ecdc $S_n = n \\cdot \\frac{a_1+a_n}{2}$ (trong \u0111\u00f3 $S_n$ bi\u1ec3u th\u1ecb t\u1ed5ng c\u1ee7a $n$ s\u1ed1 h\u1ea1ng, $a_1$ \u0111\u1ea1i di\u1ec7n cho s\u1ed1 h\u1ea1ng \u0111\u1ea7u ti\u00ean v\u00e0 $a_n$ \u0111\u1ea1i di\u1ec7n cho s\u1ed1 h\u1ea1ng cu\u1ed1i c\u00f9ng), ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh \u0111\u1ed9 d\u00e0i c\u1ee7a chu\u1ed7i con \u1edf tr\u1ea1ng th\u00e1i trong th\u1eddi gian kh\u00f4ng \u0111\u1ed5i. Sau \u0111\u00f3, ch\u00fang t\u00f4i t\u1ed5ng h\u1ee3p c\u00e1c t\u1ed5ng n\u00e0y cho t\u1eebng tr\u1ea1ng th\u00e1i $v \\neq t_0$ trong automaton. \u0110i\u1ec1u n\u00e0y \u0111\u01b0\u1ee3c hi\u1ec3n th\u1ecb b\u1eb1ng m\u00e3 d\u01b0\u1edbi \u0111\u00e2y:</p> <pre><code>long long get_tot_len_diff_substings() {\n    long long tot = 0;\n    for(int i = 1; i &lt; sz; i++) {\n        long long shortest = st[st[i].link].len + 1;\n        long long longest = st[i].len;\n\n        long long num_strings = longest - shortest + 1;\n        long long cur = num_strings * (longest + shortest) / 2;\n        tot += cur;\n    }\n    return tot;\n}\n</code></pre> <p>C\u00e1ch ti\u1ebfp c\u1eadn n\u00e0y ch\u1ea1y trong th\u1eddi gian $O(length(S))$, nh\u01b0ng th\u1ef1c nghi\u1ec7m ch\u1ea1y nhanh h\u01a1n 20 l\u1ea7n so v\u1edbi phi\u00ean b\u1ea3n quy ho\u1ea1ch \u0111\u1ed9ng \u0111\u00e3 ghi nh\u1edb tr\u00ean c\u00e1c chu\u1ed7i ng\u1eabu nhi\u00ean. N\u00f3 kh\u00f4ng \u0111\u00f2i h\u1ecfi th\u00eam kh\u00f4ng gian v\u00e0 kh\u00f4ng c\u1ea7n \u0111\u1ec7 quy.</p>","tags":["Translated"]},{"location":"string/suffix-automaton.html#lexicographically-k-th-substring","title":"Chu\u1ed7i con th\u1ee9 $k$ theo th\u1ee9 t\u1ef1 t\u1eeb \u0111i\u1ec3n (Lexicographically $k$-th substring)","text":"<p>Cho m\u1ed9t chu\u1ed7i $S$. Ch\u00fang t\u00f4i ph\u1ea3i tr\u1ea3 l\u1eddi nhi\u1ec1u c\u00e2u h\u1ecfi. \u0110\u1ed1i v\u1edbi m\u1ed7i s\u1ed1 \u0111\u00e3 cho $K_i$ ch\u00fang ta ph\u1ea3i t\u00ecm chu\u1ed7i th\u1ee9 $K_i$ trong danh s\u00e1ch s\u1eafp x\u1ebfp theo th\u1ee9 t\u1ef1 t\u1eeb \u0111i\u1ec3n c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c chu\u1ed7i con.</p> <p>Gi\u1ea3i ph\u00e1p cho v\u1ea5n \u0111\u1ec1 n\u00e0y d\u1ef1a tr\u00ean \u00fd t\u01b0\u1edfng c\u1ee7a hai v\u1ea5n \u0111\u1ec1 tr\u01b0\u1edbc \u0111\u00f3. Chu\u1ed7i con th\u1ee9 $k$ theo t\u1eeb \u0111i\u1ec3n t\u01b0\u01a1ng \u1ee9ng v\u1edbi \u0111\u01b0\u1eddng d\u1eabn th\u1ee9 $k$ theo t\u1eeb \u0111i\u1ec3n trong suffix automaton. Do \u0111\u00f3, sau khi \u0111\u1ebfm s\u1ed1 l\u01b0\u1ee3ng \u0111\u01b0\u1eddng d\u1eabn t\u1eeb m\u1ed7i tr\u1ea1ng th\u00e1i, ch\u00fang ta c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng t\u00ecm ki\u1ebfm \u0111\u01b0\u1eddng d\u1eabn th\u1ee9 $k$ b\u1eaft \u0111\u1ea7u t\u1eeb g\u1ed1c c\u1ee7a automaton.</p> <p>Vi\u1ec7c n\u00e0y m\u1ea5t th\u1eddi gian $O(length(S))$ \u0111\u1ec3 ti\u1ec1n x\u1eed l\u00fd v\u00e0 sau \u0111\u00f3 $O(length(ans) \\cdot k)$ cho m\u1ed7i truy v\u1ea5n (trong \u0111\u00f3 $ans$ l\u00e0 c\u00e2u tr\u1ea3 l\u1eddi cho truy v\u1ea5n v\u00e0 $k$ l\u00e0 k\u00edch th\u01b0\u1edbc c\u1ee7a b\u1ea3ng ch\u1eef c\u00e1i).</p>","tags":["Translated"]},{"location":"string/suffix-automaton.html#smallest-cyclic-shift","title":"D\u1ecbch chuy\u1ec3n v\u00f2ng nh\u1ecf nh\u1ea5t (Smallest cyclic shift)","text":"<p>Cho m\u1ed9t chu\u1ed7i $S$. Ch\u00fang t\u00f4i mu\u1ed1n t\u00ecm s\u1ef1 thay \u0111\u1ed5i theo chu k\u1ef3 nh\u1ecf nh\u1ea5t theo t\u1eeb \u0111i\u1ec3n.</p> <p>Ch\u00fang t\u00f4i x\u00e2y d\u1ef1ng m\u1ed9t suffix automaton cho chu\u1ed7i $S + S$. Sau \u0111\u00f3, automaton s\u1ebd ch\u1ee9a trong ch\u00ednh n\u00f3 d\u01b0\u1edbi d\u1ea1ng \u0111\u01b0\u1eddng d\u1eabn t\u1ea5t c\u1ea3 c\u00e1c d\u1ecbch chuy\u1ec3n v\u00f2ng c\u1ee7a chu\u1ed7i $S$.</p> <p>Do \u0111\u00f3, v\u1ea5n \u0111\u1ec1 gi\u1ea3m xu\u1ed1ng th\u00e0nh vi\u1ec7c t\u00ecm \u0111\u01b0\u1eddng d\u1eabn nh\u1ecf nh\u1ea5t theo t\u1eeb \u0111i\u1ec3n c\u00f3 \u0111\u1ed9 d\u00e0i $length(S)$, c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n theo c\u00e1ch t\u1ea7m th\u01b0\u1eddng: ch\u00fang ta b\u1eaft \u0111\u1ea7u \u1edf tr\u1ea1ng th\u00e1i ban \u0111\u1ea7u v\u00e0 tham lam \u0111i qua c\u00e1c chuy\u1ec3n \u0111\u1ed5i v\u1edbi k\u00fd t\u1ef1 t\u1ed1i thi\u1ec3u.</p> <p>T\u1ed5ng \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian l\u00e0 $O(length(S))$.</p>","tags":["Translated"]},{"location":"string/suffix-automaton.html#number-of-occurrences","title":"S\u1ed1 l\u1ea7n xu\u1ea5t hi\u1ec7n (Number of occurrences)","text":"<p>Cho m\u1ed9t v\u0103n b\u1ea3n $T$. Ch\u00fang t\u00f4i ph\u1ea3i tr\u1ea3 l\u1eddi nhi\u1ec1u c\u00e2u h\u1ecfi. \u0110\u1ed1i v\u1edbi m\u1ed7i m\u1eabu \u0111\u00e3 cho $P$ ch\u00fang ta ph\u1ea3i t\u00ecm hi\u1ec3u xem chu\u1ed7i $P$ xu\u1ea5t hi\u1ec7n bao nhi\u00eau l\u1ea7n trong chu\u1ed7i $T$ d\u01b0\u1edbi d\u1ea1ng m\u1ed9t chu\u1ed7i con.</p> <p>Ch\u00fang t\u00f4i x\u00e2y d\u1ef1ng suffix automaton cho v\u0103n b\u1ea3n $T$.</p> <p>Ti\u1ebfp theo ch\u00fang t\u00f4i th\u1ef1c hi\u1ec7n ti\u1ec1n x\u1eed l\u00fd sau: \u0111\u1ed1i v\u1edbi m\u1ed7i tr\u1ea1ng th\u00e1i $v$ trong automaton, ch\u00fang ta t\u00ednh s\u1ed1 $cnt[v]$ b\u1eb1ng v\u1edbi k\u00edch th\u01b0\u1edbc c\u1ee7a t\u1eadp h\u1ee3p $endpos(v)$. Trong th\u1ef1c t\u1ebf, t\u1ea5t c\u1ea3 c\u00e1c chu\u1ed7i t\u01b0\u01a1ng \u1ee9ng v\u1edbi c\u00f9ng m\u1ed9t tr\u1ea1ng th\u00e1i $v$ \u0111\u1ec1u xu\u1ea5t hi\u1ec7n trong v\u0103n b\u1ea3n $T$ m\u1ed9t l\u01b0\u1ee3ng l\u1ea7n b\u1eb1ng nhau, b\u1eb1ng v\u1edbi s\u1ed1 l\u01b0\u1ee3ng v\u1ecb tr\u00ed trong t\u1eadp h\u1ee3p $endpos$.</p> <p>Tuy nhi\u00ean, ch\u00fang ta kh\u00f4ng th\u1ec3 x\u00e2y d\u1ef1ng c\u00e1c t\u1eadp h\u1ee3p $endpos$ m\u1ed9t c\u00e1ch r\u00f5 r\u00e0ng, v\u00ec v\u1eady ch\u00fang ta ch\u1ec9 xem x\u00e9t k\u00edch th\u01b0\u1edbc c\u1ee7a ch\u00fang $cnt$.</p> <p>\u0110\u1ec3 t\u00ednh to\u00e1n ch\u00fang, ch\u00fang ta ti\u1ebfn h\u00e0nh nh\u01b0 sau. \u0110\u1ed1i v\u1edbi m\u1ed7i tr\u1ea1ng th\u00e1i, n\u1ebfu n\u00f3 kh\u00f4ng \u0111\u01b0\u1ee3c t\u1ea1o b\u1eb1ng c\u00e1ch nh\u00e2n b\u1ea3n (v\u00e0 n\u1ebfu n\u00f3 kh\u00f4ng ph\u1ea3i l\u00e0 tr\u1ea1ng th\u00e1i ban \u0111\u1ea7u $t_0$), ch\u00fang t\u00f4i kh\u1edfi t\u1ea1o n\u00f3 v\u1edbi $cnt = 1$. Sau \u0111\u00f3, ch\u00fang t\u00f4i s\u1ebd \u0111i qua t\u1ea5t c\u1ea3 c\u00e1c tr\u1ea1ng th\u00e1i theo th\u1ee9 t\u1ef1 \u0111\u1ed9 d\u00e0i $len$ gi\u1ea3m d\u1ea7n v\u00e0 th\u00eam gi\u00e1 tr\u1ecb hi\u1ec7n t\u1ea1i $cnt[v]$ v\u00e0o c\u00e1c li\u00ean k\u1ebft h\u1eadu t\u1ed1:</p> $$cnt[link(v)] \\text{ += } cnt[v]$$ <p>\u0110i\u1ec1u n\u00e0y cung c\u1ea5p gi\u00e1 tr\u1ecb ch\u00ednh x\u00e1c cho t\u1eebng tr\u1ea1ng th\u00e1i.</p> <p>T\u1ea1i sao \u0111i\u1ec1u n\u00e0y \u0111\u00fang? T\u1ed5ng s\u1ed1 tr\u1ea1ng th\u00e1i thu \u0111\u01b0\u1ee3c kh\u00f4ng qua nh\u00e2n b\u1ea3n ch\u00ednh x\u00e1c l\u00e0 $length(T)$, v\u00e0 $i$ tr\u1ea1ng th\u00e1i \u0111\u1ea7u ti\u00ean trong s\u1ed1 \u0111\u00f3 xu\u1ea5t hi\u1ec7n khi ch\u00fang ta th\u00eam $i$ k\u00fd t\u1ef1 \u0111\u1ea7u ti\u00ean. Do \u0111\u00f3, \u0111\u1ed1i v\u1edbi m\u1ed7i tr\u1ea1ng th\u00e1i n\u00e0y, ch\u00fang t\u00f4i \u0111\u1ebfm v\u1ecb tr\u00ed t\u01b0\u01a1ng \u1ee9ng m\u00e0 n\u00f3 \u0111\u01b0\u1ee3c x\u1eed l\u00fd. Do \u0111\u00f3, ban \u0111\u1ea7u ch\u00fang ta c\u00f3 $cnt = 1$ cho m\u1ed7i tr\u1ea1ng th\u00e1i nh\u01b0 v\u1eady v\u00e0 $cnt = 0$ cho t\u1ea5t c\u1ea3 c\u00e1c tr\u1ea1ng th\u00e1i kh\u00e1c.</p> <p>Sau \u0111\u00f3, ch\u00fang t\u00f4i \u00e1p d\u1ee5ng thao t\u00e1c sau cho m\u1ed7i $v$: $cnt[link(v)] \\text{ += } cnt[v]$. \u00dd ngh\u0129a \u0111\u1eb1ng sau \u0111i\u1ec1u n\u00e0y l\u00e0, n\u1ebfu m\u1ed9t chu\u1ed7i $v$ xu\u1ea5t hi\u1ec7n $cnt[v]$ l\u1ea7n, th\u00ec t\u1ea5t c\u1ea3 c\u00e1c h\u1eadu t\u1ed1 c\u1ee7a n\u00f3 c\u0169ng xu\u1ea5t hi\u1ec7n t\u1ea1i c\u00e1c v\u1ecb tr\u00ed k\u1ebft th\u00fac ch\u00ednh x\u00e1c gi\u1ed1ng nhau, do \u0111\u00f3 c\u0169ng $cnt[v]$ l\u1ea7n.</p> <p>T\u1ea1i sao ch\u00fang ta kh\u00f4ng \u0111\u1ebfm qu\u00e1 nhi\u1ec1u trong th\u1ee7 t\u1ee5c n\u00e0y (t\u1ee9c l\u00e0 kh\u00f4ng \u0111\u1ebfm m\u1ed9t s\u1ed1 v\u1ecb tr\u00ed hai l\u1ea7n)? B\u1edfi v\u00ec ch\u00fang ta ch\u1ec9 th\u00eam c\u00e1c v\u1ecb tr\u00ed c\u1ee7a m\u1ed9t tr\u1ea1ng th\u00e1i v\u00e0o m\u1ed9t tr\u1ea1ng th\u00e1i kh\u00e1c, v\u00ec v\u1eady kh\u00f4ng th\u1ec3 x\u1ea3y ra tr\u01b0\u1eddng h\u1ee3p m\u1ed9t tr\u1ea1ng th\u00e1i h\u01b0\u1edbng c\u00e1c v\u1ecb tr\u00ed c\u1ee7a n\u00f3 sang tr\u1ea1ng th\u00e1i kh\u00e1c hai l\u1ea7n theo hai c\u00e1ch kh\u00e1c nhau.</p> <p>Do \u0111\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh to\u00e1n s\u1ed1 l\u01b0\u1ee3ng $cnt$ cho t\u1ea5t c\u1ea3 c\u00e1c tr\u1ea1ng th\u00e1i trong automaton trong th\u1eddi gian $O(length(T))$.</p> <p>Sau \u0111\u00f3 tr\u1ea3 l\u1eddi m\u1ed9t truy v\u1ea5n b\u1eb1ng c\u00e1ch ch\u1ec9 t\u00ecm ki\u1ebfm gi\u00e1 tr\u1ecb $cnt[t]$, trong \u0111\u00f3 $t$ l\u00e0 tr\u1ea1ng th\u00e1i t\u01b0\u01a1ng \u1ee9ng v\u1edbi m\u1eabu, n\u1ebfu tr\u1ea1ng th\u00e1i \u0111\u00f3 t\u1ed3n t\u1ea1i. N\u1ebfu kh\u00f4ng th\u00ec tr\u1ea3 l\u1eddi b\u1eb1ng $0$. Tr\u1ea3 l\u1eddi m\u1ed9t truy v\u1ea5n m\u1ea5t th\u1eddi gian $O(length(P))$.</p>","tags":["Translated"]},{"location":"string/suffix-automaton.html#first-occurrence-position","title":"V\u1ecb tr\u00ed xu\u1ea5t hi\u1ec7n \u0111\u1ea7u ti\u00ean (First occurrence position)","text":"<p>Cho m\u1ed9t v\u0103n b\u1ea3n $T$ v\u00e0 nhi\u1ec1u truy v\u1ea5n. \u0110\u1ed1i v\u1edbi m\u1ed7i chu\u1ed7i truy v\u1ea5n $P$, ch\u00fang t\u00f4i mu\u1ed1n t\u00ecm v\u1ecb tr\u00ed xu\u1ea5t hi\u1ec7n \u0111\u1ea7u ti\u00ean c\u1ee7a $P$ trong chu\u1ed7i $T$ (v\u1ecb tr\u00ed b\u1eaft \u0111\u1ea7u c\u1ee7a $P$).</p> <p>Ch\u00fang ta l\u1ea1i x\u00e2y d\u1ef1ng m\u1ed9t suffix automaton. Ngo\u00e0i ra, ch\u00fang t\u00f4i t\u00ednh to\u00e1n tr\u01b0\u1edbc v\u1ecb tr\u00ed $firstpos$ cho t\u1ea5t c\u1ea3 c\u00e1c tr\u1ea1ng th\u00e1i trong automaton, t\u1ee9c l\u00e0 \u0111\u1ed1i v\u1edbi m\u1ed7i tr\u1ea1ng th\u00e1i $v$, ch\u00fang ta mu\u1ed1n t\u00ecm v\u1ecb tr\u00ed $firstpos[v]$ c\u1ee7a ph\u1ea7n cu\u1ed1i c\u1ee7a l\u1ea7n xu\u1ea5t hi\u1ec7n \u0111\u1ea7u ti\u00ean. N\u00f3i c\u00e1ch kh\u00e1c, ch\u00fang ta mu\u1ed1n t\u00ecm tr\u01b0\u1edbc ph\u1ea7n t\u1eed t\u1ed1i thi\u1ec3u c\u1ee7a m\u1ed7i t\u1eadp h\u1ee3p $endpos$ (v\u00ec r\u00f5 r\u00e0ng kh\u00f4ng th\u1ec3 duy tr\u00ec t\u1ea5t c\u1ea3 c\u00e1c t\u1eadp h\u1ee3p $endpos$ m\u1ed9t c\u00e1ch r\u00f5 r\u00e0ng).</p> <p>\u0110\u1ec3 duy tr\u00ec c\u00e1c v\u1ecb tr\u00ed n\u00e0y $firstpos$, ch\u00fang t\u00f4i m\u1edf r\u1ed9ng ch\u1ee9c n\u0103ng <code>sa_extend()</code>. Khi ch\u00fang ta t\u1ea1o m\u1ed9t tr\u1ea1ng th\u00e1i m\u1edbi $cur$, ch\u00fang ta \u0111\u1eb7t:</p> $$firstpos(cur) = len(cur) - 1$$ <p>V\u00e0 khi ch\u00fang ta sao ch\u00e9p m\u1ed9t \u0111\u1ec9nh $q$ d\u01b0\u1edbi d\u1ea1ng $clone$, ch\u00fang ta \u0111\u1eb7t:</p> $$firstpos(clone) = firstpos(q)$$ <p>(v\u00ec t\u00f9y ch\u1ecdn duy nh\u1ea5t kh\u00e1c cho m\u1ed9t gi\u00e1 tr\u1ecb s\u1ebd l\u00e0 $firstpos(cur)$ ch\u1eafc ch\u1eafn qu\u00e1 l\u1edbn)</p> <p>Do \u0111\u00f3 c\u00e2u tr\u1ea3 l\u1eddi cho truy v\u1ea5n ch\u1ec9 \u0111\u01a1n gi\u1ea3n l\u00e0 $firstpos(t) - length(P) + 1$, trong \u0111\u00f3 $t$ l\u00e0 tr\u1ea1ng th\u00e1i t\u01b0\u01a1ng \u1ee9ng v\u1edbi chu\u1ed7i $P$. Tr\u1ea3 l\u1eddi m\u1ed9t truy v\u1ea5n m\u1ed9t l\u1ea7n n\u1eefa ch\u1ec9 m\u1ea5t th\u1eddi gian $O(length(P))$.</p>","tags":["Translated"]},{"location":"string/suffix-automaton.html#all-occurrence-positions","title":"T\u1ea5t c\u1ea3 v\u1ecb tr\u00ed xu\u1ea5t hi\u1ec7n (All occurrence positions)","text":"<p>L\u1ea7n n\u00e0y ch\u00fang ta ph\u1ea3i hi\u1ec3n th\u1ecb t\u1ea5t c\u1ea3 c\u00e1c v\u1ecb tr\u00ed xu\u1ea5t hi\u1ec7n trong chu\u1ed7i $T$.</p> <p>M\u1ed9t l\u1ea7n n\u1eefa ch\u00fang t\u00f4i x\u00e2y d\u1ef1ng m\u1ed9t suffix automaton cho v\u0103n b\u1ea3n $T$. T\u01b0\u01a1ng t\u1ef1 nh\u01b0 trong nhi\u1ec7m v\u1ee5 tr\u01b0\u1edbc, ch\u00fang ta t\u00ednh to\u00e1n v\u1ecb tr\u00ed $firstpos$ cho t\u1ea5t c\u1ea3 c\u00e1c tr\u1ea1ng th\u00e1i.</p> <p>R\u00f5 r\u00e0ng $firstpos(t)$ l\u00e0 m\u1ed9t ph\u1ea7n c\u1ee7a c\u00e2u tr\u1ea3 l\u1eddi, n\u1ebfu $t$ l\u00e0 tr\u1ea1ng th\u00e1i t\u01b0\u01a1ng \u1ee9ng v\u1edbi m\u1ed9t chu\u1ed7i truy v\u1ea5n $P$. V\u00ec v\u1eady, ch\u00fang t\u00f4i \u0111\u00e3 t\u00ednh \u0111\u1ebfn tr\u1ea1ng th\u00e1i c\u1ee7a automaton ch\u1ee9a $P$. Ch\u00fang ta c\u1ea7n t\u00ednh \u0111\u1ebfn nh\u1eefng tr\u1ea1ng th\u00e1i n\u00e0o kh\u00e1c? T\u1ea5t c\u1ea3 c\u00e1c tr\u1ea1ng th\u00e1i t\u01b0\u01a1ng \u1ee9ng v\u1edbi c\u00e1c chu\u1ed7i m\u00e0 $P$ l\u00e0 h\u1eadu t\u1ed1. N\u00f3i c\u00e1ch kh\u00e1c, ch\u00fang ta c\u1ea7n t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c tr\u1ea1ng th\u00e1i c\u00f3 th\u1ec3 \u0111\u1ebfn tr\u1ea1ng th\u00e1i $t$ th\u00f4ng qua c\u00e1c li\u00ean k\u1ebft h\u1eadu t\u1ed1.</p> <p>Do \u0111\u00f3 \u0111\u1ec3 gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1, ch\u00fang ta c\u1ea7n l\u01b0u danh s\u00e1ch c\u00e1c tham chi\u1ebfu h\u1eadu t\u1ed1 d\u1eabn \u0111\u1ebfn t\u1eebng tr\u1ea1ng th\u00e1i. C\u00e2u tr\u1ea3 l\u1eddi cho truy v\u1ea5n sau \u0111\u00f3 s\u1ebd ch\u1ee9a t\u1ea5t c\u1ea3 $firstpos$ cho m\u1ed7i tr\u1ea1ng th\u00e1i m\u00e0 ch\u00fang ta c\u00f3 th\u1ec3 t\u00ecm th\u1ea5y tr\u00ean DFS / BFS b\u1eaft \u0111\u1ea7u t\u1eeb tr\u1ea1ng th\u00e1i $t$ ch\u1ec9 s\u1eed d\u1ee5ng c\u00e1c tham chi\u1ebfu h\u1eadu t\u1ed1.</p> <p>Nh\u00ecn chung, \u0111i\u1ec1u n\u00e0y \u0111\u00f2i h\u1ecfi $O(length (T))$ \u0111\u1ec3 ti\u1ec1n x\u1eed l\u00fd v\u00e0 $O(length(P) + answer(P))$ cho m\u1ed7i y\u00eau c\u1ea7u, \u1edf \u0111\u00e2u $answer(P)$ \u2014 \u0111\u00e2y l\u00e0 k\u00edch th\u01b0\u1edbc c\u1ee7a c\u00e2u tr\u1ea3 l\u1eddi.</p> <p>\u0110\u1ea7u ti\u00ean, ch\u00fang ta \u0111i xu\u1ed1ng automaton cho t\u1eebng k\u00fd t\u1ef1 trong m\u1eabu \u0111\u1ec3 t\u00ecm n\u00fat b\u1eaft \u0111\u1ea7u c\u1ee7a ch\u00fang ta y\u00eau c\u1ea7u $O(length(P))$.  Sau \u0111\u00f3, ch\u00fang t\u00f4i s\u1eed d\u1ee5ng gi\u1ea3i ph\u00e1p thay th\u1ebf c\u1ee7a m\u00ecnh s\u1ebd ho\u1ea1t \u0111\u1ed9ng k\u1ecbp th\u1eddi $O(answer(P))$, b\u1edfi v\u00ec ch\u00fang ta s\u1ebd kh\u00f4ng gh\u00e9 th\u0103m m\u1ed9t tr\u1ea1ng th\u00e1i hai l\u1ea7n (b\u1edfi v\u00ec ch\u1ec9 c\u00f3 m\u1ed9t li\u00ean k\u1ebft h\u1eadu t\u1ed1 r\u1eddi kh\u1ecfi m\u1ed7i tr\u1ea1ng th\u00e1i, v\u00ec v\u1eady kh\u00f4ng th\u1ec3 c\u00f3 hai con \u0111\u01b0\u1eddng kh\u00e1c nhau d\u1eabn \u0111\u1ebfn c\u00f9ng m\u1ed9t tr\u1ea1ng th\u00e1i).</p> <p>Ch\u00fang ta ch\u1ec9 ph\u1ea3i t\u00ednh \u0111\u1ebfn vi\u1ec7c hai tr\u1ea1ng th\u00e1i kh\u00e1c nhau c\u00f3 th\u1ec3 c\u00f3 c\u00f9ng gi\u00e1 tr\u1ecb $firstpos$. \u0110i\u1ec1u n\u00e0y x\u1ea3y ra n\u1ebfu m\u1ed9t tr\u1ea1ng th\u00e1i thu \u0111\u01b0\u1ee3c b\u1eb1ng c\u00e1ch nh\u00e2n b\u1ea3n tr\u1ea1ng th\u00e1i kh\u00e1c. Tuy nhi\u00ean, \u0111i\u1ec1u n\u00e0y kh\u00f4ng ph\u00e1 h\u1ecfng s\u1ef1 ph\u1ee9c t\u1ea1p, v\u00ec m\u1ed7i tr\u1ea1ng th\u00e1i ch\u1ec9 c\u00f3 th\u1ec3 c\u00f3 t\u1ed1i \u0111a m\u1ed9t b\u1ea3n sao.</p> <p>H\u01a1n n\u1eefa, ch\u00fang ta c\u0169ng c\u00f3 th\u1ec3 lo\u1ea1i b\u1ecf c\u00e1c v\u1ecb tr\u00ed tr\u00f9ng l\u1eb7p, n\u1ebfu ch\u00fang ta kh\u00f4ng xu\u1ea5t c\u00e1c v\u1ecb tr\u00ed t\u1eeb c\u00e1c tr\u1ea1ng th\u00e1i \u0111\u01b0\u1ee3c sao ch\u00e9p. Trong th\u1ef1c t\u1ebf, m\u1ed9t tr\u1ea1ng th\u00e1i m\u00e0 m\u1ed9t tr\u1ea1ng th\u00e1i nh\u00e2n b\u1ea3n c\u00f3 th\u1ec3 \u0111\u1ea1t \u0111\u01b0\u1ee3c, c\u0169ng c\u00f3 th\u1ec3 truy c\u1eadp \u0111\u01b0\u1ee3c t\u1eeb tr\u1ea1ng th\u00e1i ban \u0111\u1ea7u. Do \u0111\u00f3, n\u1ebfu ch\u00fang ta nh\u1edb c\u1edd <code>is_cloned</code> cho m\u1ed7i tr\u1ea1ng th\u00e1i, ch\u00fang ta ch\u1ec9 c\u1ea7n b\u1ecf qua c\u00e1c tr\u1ea1ng th\u00e1i \u0111\u01b0\u1ee3c nh\u00e2n b\u1ea3n v\u00e0 ch\u1ec9 xu\u1ea5t $firstpos$ cho t\u1ea5t c\u1ea3 c\u00e1c tr\u1ea1ng th\u00e1i kh\u00e1c.</p> <p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u1ed9t s\u1ed1 b\u1ea3n ph\u00e1c th\u1ea3o th\u1ef1c hi\u1ec7n:</p> <pre><code>struct state {\n    ...\n    bool is_clone;\n    int first_pos;\n    vector&lt;int&gt; inv_link;\n};\n\n// after constructing the automaton\nfor (int v = 1; v &lt; sz; v++) {\n    st[st[v].link].inv_link.push_back(v);\n}\n\n// output all positions of occurrences\nvoid output_all_occurrences(int v, int P_length) {\n    if (!st[v].is_clone)\n        cout &lt;&lt; st[v].first_pos - P_length + 1 &lt;&lt; endl;\n    for (int u : st[v].inv_link)\n        output_all_occurrences(u, P_length);\n}\n</code></pre>","tags":["Translated"]},{"location":"string/suffix-automaton.html#shortest-non-appearing-string","title":"Chu\u1ed7i kh\u00f4ng xu\u1ea5t hi\u1ec7n ng\u1eafn nh\u1ea5t (Shortest non-appearing string)","text":"<p>Cho m\u1ed9t chu\u1ed7i $S$ v\u00e0 m\u1ed9t b\u1ea3ng ch\u1eef c\u00e1i nh\u1ea5t \u0111\u1ecbnh. Ch\u00fang ta ph\u1ea3i t\u00ecm m\u1ed9t chu\u1ed7i c\u00f3 \u0111\u1ed9 d\u00e0i nh\u1ecf nh\u1ea5t, kh\u00f4ng xu\u1ea5t hi\u1ec7n trong $S$.</p> <p>Ch\u00fang t\u00f4i s\u1ebd \u00e1p d\u1ee5ng quy ho\u1ea1ch \u0111\u1ed9ng tr\u00ean suffix automaton \u0111\u01b0\u1ee3c x\u00e2y d\u1ef1ng cho chu\u1ed7i $S$.</p> <p>G\u1ecdi $d[v]$ l\u00e0 c\u00e2u tr\u1ea3 l\u1eddi cho n\u00fat $v$, t\u1ee9c l\u00e0 ch\u00fang ta \u0111\u00e3 x\u1eed l\u00fd m\u1ed9t ph\u1ea7n c\u1ee7a chu\u1ed7i con, hi\u1ec7n \u0111ang \u1edf tr\u1ea1ng th\u00e1i $v$, v\u00e0 mu\u1ed1n t\u00ecm s\u1ed1 l\u01b0\u1ee3ng k\u00fd t\u1ef1 nh\u1ecf nh\u1ea5t ph\u1ea3i th\u00eam v\u00e0o \u0111\u1ec3 t\u00ecm m\u1ed9t chuy\u1ec3n \u0111\u1ed5i kh\u00f4ng t\u1ed3n t\u1ea1i. T\u00ednh to\u00e1n $d[v]$ r\u1ea5t \u0111\u01a1n gi\u1ea3n. N\u1ebfu kh\u00f4ng c\u00f3 s\u1ef1 chuy\u1ec3n ti\u1ebfp b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng \u00edt nh\u1ea5t m\u1ed9t k\u00fd t\u1ef1 c\u1ee7a b\u1ea3ng ch\u1eef c\u00e1i, th\u00ec $d[v] = 1$. N\u1ebfu kh\u00f4ng, m\u1ed9t k\u00fd t\u1ef1 l\u00e0 kh\u00f4ng \u0111\u1ee7, v\u00e0 v\u00ec v\u1eady ch\u00fang ta c\u1ea7n l\u1ea5y t\u1ed1i thi\u1ec3u t\u1ea5t c\u1ea3 c\u00e1c c\u00e2u tr\u1ea3 l\u1eddi c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c chuy\u1ec3n \u0111\u1ed5i:</p> $$d[v] = 1 + \\min_{w:(v,w,c) \\in SA} d[w].$$ <p>C\u00e2u tr\u1ea3 l\u1eddi cho v\u1ea5n \u0111\u1ec1 s\u1ebd l\u00e0 $d[t_0]$, v\u00e0 chu\u1ed7i th\u1ef1c t\u1ebf c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c kh\u00f4i ph\u1ee5c b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng m\u1ea3ng \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n $d[]$.</p>","tags":["Translated"]},{"location":"string/suffix-automaton.html#longest-common-substring-of-two-strings","title":"Chu\u1ed7i con chung d\u00e0i nh\u1ea5t c\u1ee7a hai chu\u1ed7i (Longest common substring of two strings)","text":"<p>Cho hai chu\u1ed7i $S$ v\u00e0 $T$. Ch\u00fang ta ph\u1ea3i t\u00ecm chu\u1ed7i con chung d\u00e0i nh\u1ea5t, t\u1ee9c l\u00e0 m\u1ed9t chu\u1ed7i $X$ xu\u1ea5t hi\u1ec7n d\u01b0\u1edbi d\u1ea1ng chu\u1ed7i con trong $S$ v\u00e0 c\u1ea3 trong $T$.</p> <p>Ch\u00fang t\u00f4i x\u00e2y d\u1ef1ng m\u1ed9t suffix automaton cho chu\u1ed7i $S$.</p> <p>B\u00e2y gi\u1edd ch\u00fang ta s\u1ebd l\u1ea5y chu\u1ed7i $T$, v\u00e0 \u0111\u1ed1i v\u1edbi m\u1ed7i ti\u1ec1n t\u1ed1, h\u00e3y t\u00ecm h\u1eadu t\u1ed1 d\u00e0i nh\u1ea5t c\u1ee7a ti\u1ec1n t\u1ed1 n\u00e0y trong $S$. N\u00f3i c\u00e1ch kh\u00e1c, \u0111\u1ed1i v\u1edbi m\u1ed7i v\u1ecb tr\u00ed trong chu\u1ed7i $T$, ch\u00fang t\u00f4i mu\u1ed1n t\u00ecm chu\u1ed7i con chung d\u00e0i nh\u1ea5t c\u1ee7a $S$ v\u00e0 $T$ k\u1ebft th\u00fac \u1edf v\u1ecb tr\u00ed \u0111\u00f3.</p> <p>\u0110\u1ed1i v\u1edbi \u0111i\u1ec1u n\u00e0y, ch\u00fang t\u00f4i s\u1ebd s\u1eed d\u1ee5ng hai bi\u1ebfn, tr\u1ea1ng th\u00e1i hi\u1ec7n t\u1ea1i $v$, v\u00e0 \u0111\u1ed9 d\u00e0i hi\u1ec7n t\u1ea1i $l$. Hai bi\u1ebfn n\u00e0y s\u1ebd m\u00f4 t\u1ea3 ph\u1ea7n kh\u1edbp hi\u1ec7n t\u1ea1i: \u0111\u1ed9 d\u00e0i c\u1ee7a n\u00f3 v\u00e0 tr\u1ea1ng th\u00e1i t\u01b0\u01a1ng \u1ee9ng v\u1edbi n\u00f3.</p> <p>Ban \u0111\u1ea7u $v = t_0$ v\u00e0 $l = 0$, t\u1ee9c l\u00e0 tr\u1eadn \u0111\u1ea5u tr\u1ed1ng r\u1ed7ng.</p> <p>B\u00e2y gi\u1edd ch\u00fang ta h\u00e3y m\u00f4 t\u1ea3 c\u00e1ch ch\u00fang ta c\u00f3 th\u1ec3 th\u00eam m\u1ed9t k\u00fd t\u1ef1 $T[i]$ v\u00e0 t\u00ednh to\u00e1n l\u1ea1i c\u00e2u tr\u1ea3 l\u1eddi cho n\u00f3.</p> <ul> <li>N\u1ebfu c\u00f3 chuy\u1ec3n \u0111\u1ed5i t\u1eeb $v$ v\u1edbi k\u00fd t\u1ef1 $T[i]$, th\u00ec ch\u00fang ta ch\u1ec9 c\u1ea7n l\u00e0m theo chuy\u1ec3n \u0111\u1ed5i v\u00e0 t\u0103ng $l$ th\u00eam m\u1ed9t.</li> <li>N\u1ebfu kh\u00f4ng c\u00f3 chuy\u1ec3n \u0111\u1ed5i nh\u01b0 v\u1eady, ch\u00fang ta ph\u1ea3i r\u00fat ng\u1eafn ph\u1ea7n kh\u1edbp hi\u1ec7n t\u1ea1i, \u0111i\u1ec1u \u0111\u00f3 c\u00f3 ngh\u0129a l\u00e0 ch\u00fang ta c\u1ea7n tu\u00e2n theo li\u00ean k\u1ebft h\u1eadu t\u1ed1: $v = link(v)$.     \u0110\u1ed3ng th\u1eddi, \u0111\u1ed9 d\u00e0i hi\u1ec7n t\u1ea1i ph\u1ea3i \u0111\u01b0\u1ee3c r\u00fat ng\u1eafn.     R\u00f5 r\u00e0ng ch\u00fang ta c\u1ea7n g\u00e1n $l = len(v)$, v\u00ec sau khi \u0111i qua li\u00ean k\u1ebft h\u1eadu t\u1ed1, ch\u00fang ta s\u1ebd \u1edf tr\u1ea1ng th\u00e1i c\u00f3 chu\u1ed7i d\u00e0i nh\u1ea5t t\u01b0\u01a1ng \u1ee9ng l\u00e0 m\u1ed9t chu\u1ed7i con.</li> <li>N\u1ebfu v\u1eabn kh\u00f4ng c\u00f3 chuy\u1ec3n \u0111\u1ed5i b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng k\u00fd t\u1ef1 b\u1eaft bu\u1ed9c, ch\u00fang t\u00f4i l\u1eb7p l\u1ea1i v\u00e0 \u0111i qua li\u00ean k\u1ebft h\u1eadu t\u1ed1 v\u00e0 gi\u1ea3m $l$, cho \u0111\u1ebfn khi ch\u00fang t\u00f4i t\u00ecm th\u1ea5y m\u1ed9t chuy\u1ec3n \u0111\u1ed5i ho\u1eb7c ch\u00fang t\u00f4i \u0111\u1ea1t \u0111\u1ebfn tr\u1ea1ng th\u00e1i h\u01b0 c\u1ea5u $-1$ (c\u00f3 ngh\u0129a l\u00e0 bi\u1ec3u t\u01b0\u1ee3ng $T[i]$ ho\u00e0n to\u00e0n kh\u00f4ng xu\u1ea5t hi\u1ec7n trong $S$, v\u00ec v\u1eady ch\u00fang ta g\u00e1n $v = l = 0$).</li> </ul> <p>C\u00e2u tr\u1ea3 l\u1eddi cho nhi\u1ec7m v\u1ee5 s\u1ebd l\u00e0 t\u1ed1i \u0111a c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c gi\u00e1 tr\u1ecb $l$.</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a ph\u1ea7n n\u00e0y l\u00e0 $O(length(T))$,  v\u00ec trong m\u1ed9t l\u1ea7n di chuy\u1ec3n, ch\u00fang ta c\u00f3 th\u1ec3 t\u0103ng $l$ l\u00ean m\u1ed9t ho\u1eb7c th\u1ef1c hi\u1ec7n m\u1ed9t v\u00e0i l\u1ea7n \u0111i qua c\u00e1c li\u00ean k\u1ebft h\u1eadu t\u1ed1, m\u1ed7i l\u1ea7n \u0111i qua s\u1ebd gi\u1ea3m gi\u00e1 tr\u1ecb $l$.</p> <p>C\u00e0i \u0111\u1eb7t:</p> <pre><code>string lcs (string S, string T) {\n    sa_init();\n    for (int i = 0; i &lt; S.size(); i++)\n        sa_extend(S[i]);\n\n    int v = 0, l = 0, best = 0, bestpos = 0;\n    for (int i = 0; i &lt; T.size(); i++) {\n        while (v &amp;&amp; !st[v].next.count(T[i])) {\n            v = st[v].link ;\n            l = st[v].len;\n        }\n        if (st[v].next.count(T[i])) {\n            v = st [v].next[T[i]];\n            l++;\n        }\n        if (l &gt; best) {\n            best = l;\n            bestpos = i;\n        }\n    }\n    return T.substr(bestpos - best + 1, best);\n} \n</code></pre>","tags":["Translated"]},{"location":"string/suffix-automaton.html#largest-common-substring-of-multiple-strings","title":"Chu\u1ed7i con chung l\u1edbn nh\u1ea5t c\u1ee7a nhi\u1ec1u chu\u1ed7i (Largest common substring of multiple strings)","text":"<p>C\u00f3 $k$ chu\u1ed7i $S_i$ \u0111\u01b0\u1ee3c \u0111\u01b0a ra. Ch\u00fang ta ph\u1ea3i t\u00ecm chu\u1ed7i con chung d\u00e0i nh\u1ea5t, t\u1ee9c l\u00e0 m\u1ed9t chu\u1ed7i $X$ xu\u1ea5t hi\u1ec7n d\u01b0\u1edbi d\u1ea1ng chu\u1ed7i con trong m\u1ed7i chu\u1ed7i $S_i$.</p> <p>Ch\u00fang t\u00f4i n\u1ed1i t\u1ea5t c\u1ea3 c\u00e1c chu\u1ed7i th\u00e0nh m\u1ed9t chu\u1ed7i l\u1edbn $T$, t\u00e1ch c\u00e1c chu\u1ed7i b\u1eb1ng m\u1ed9t k\u00fd t\u1ef1 \u0111\u1eb7c bi\u1ec7t $D_i$ (m\u1ed7i chu\u1ed7i m\u1ed9t k\u00fd t\u1ef1):</p> $$T = S_1 + D_1 + S_2 + D_2 + \\dots + S_k + D_k.$$ <p>Sau \u0111\u00f3, ch\u00fang t\u00f4i x\u00e2y d\u1ef1ng suffix automaton cho chu\u1ed7i $T$.</p> <p>B\u00e2y gi\u1edd ch\u00fang ta c\u1ea7n t\u00ecm m\u1ed9t chu\u1ed7i trong m\u00e1y, \u0111\u01b0\u1ee3c ch\u1ee9a trong t\u1ea5t c\u1ea3 c\u00e1c chu\u1ed7i $S_i$, v\u00e0 \u0111i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng c\u00e1c k\u00fd t\u1ef1 \u0111\u01b0\u1ee3c th\u00eam \u0111\u1eb7c bi\u1ec7t. L\u01b0u \u00fd r\u1eb1ng n\u1ebfu m\u1ed9t chu\u1ed7i con \u0111\u01b0\u1ee3c bao g\u1ed3m trong m\u1ed9t s\u1ed1 chu\u1ed7i $S_j$, th\u00ec trong suffix automaton t\u1ed3n t\u1ea1i m\u1ed9t \u0111\u01b0\u1eddng d\u1eabn b\u1eaft \u0111\u1ea7u t\u1eeb chu\u1ed7i con n\u00e0y ch\u1ee9a k\u00fd t\u1ef1 $D_j$ v\u00e0 kh\u00f4ng ch\u1ee9a c\u00e1c k\u00fd t\u1ef1 kh\u00e1c $D_1, \\dots, D_{j-1}, D_{j+1}, \\dots, D_k$.</p> <p>Do \u0111\u00f3, ch\u00fang ta c\u1ea7n t\u00ednh to\u00e1n kh\u1ea3 n\u0103ng \u0111\u1ea1t \u0111\u01b0\u1ee3c, cho ch\u00fang ta bi\u1ebft \u0111\u1ed1i v\u1edbi t\u1eebng tr\u1ea1ng th\u00e1i c\u1ee7a m\u00e1y v\u00e0 t\u1eebng k\u00fd hi\u1ec7u $D_i$ n\u1ebfu t\u1ed3n t\u1ea1i m\u1ed9t \u0111\u01b0\u1eddng d\u1eabn nh\u01b0 v\u1eady. \u0110i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n b\u1edfi DFS ho\u1eb7c BFS v\u00e0 quy ho\u1ea1ch \u0111\u1ed9ng. Sau \u0111\u00f3, c\u00e2u tr\u1ea3 l\u1eddi cho b\u00e0i to\u00e1n s\u1ebd l\u00e0 chu\u1ed7i $longest(v)$ cho tr\u1ea1ng th\u00e1i $v$, t\u1eeb \u0111\u00f3 c\u00e1c \u0111\u01b0\u1eddng d\u1eabn t\u1ed3n t\u1ea1i cho t\u1ea5t c\u1ea3 c\u00e1c k\u00fd t\u1ef1 \u0111\u1eb7c bi\u1ec7t.</p>","tags":["Translated"]},{"location":"string/suffix-automaton.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>CSES - Finding Patterns</li> <li>CSES - Counting Patterns</li> <li>CSES - String Matching</li> <li>CSES - Patterns Positions</li> <li>CSES - Distinct Substrings</li> <li>CSES - Word Combinations</li> <li>CSES - String Distribution</li> <li>AtCoder - K-th Substring</li> <li>SPOJ - SUBLEX</li> <li>Codeforces - Cyclical Quest</li> <li>Codeforces - String</li> </ul>","tags":["Translated"]},{"location":"string/suffix-tree-ukkonen.html","title":"C\u00e2y h\u1eadu t\u1ed1. Thu\u1eadt to\u00e1n Ukkonen (Suffix Tree. Ukkonen's Algorithm)","text":"<p>B\u00e0i vi\u1ebft n\u00e0y l\u00e0 m\u1ed9t b\u00e0i s\u01a1 khai v\u00e0 kh\u00f4ng ch\u1ee9a b\u1ea5t k\u1ef3 m\u00f4 t\u1ea3 n\u00e0o. \u0110\u1ec3 bi\u1ebft m\u00f4 t\u1ea3 v\u1ec1 thu\u1eadt to\u00e1n, h\u00e3y tham kh\u1ea3o c\u00e1c ngu\u1ed3n kh\u00e1c, ch\u1eb3ng h\u1ea1n nh\u01b0 Algorithms on Strings, Trees, and Sequences c\u1ee7a Dan Gusfield.</p> <p>Thu\u1eadt to\u00e1n n\u00e0y x\u00e2y d\u1ef1ng m\u1ed9t c\u00e2y h\u1eadu t\u1ed1 cho m\u1ed9t chu\u1ed7i $s$ c\u00f3 \u0111\u1ed9 d\u00e0i $n$ trong th\u1eddi gian $O(n\\log(k))$), trong \u0111\u00f3 $k$ l\u00e0 k\u00edch th\u01b0\u1edbc c\u1ee7a b\u1ea3ng ch\u1eef c\u00e1i (n\u1ebfu $k$ \u0111\u01b0\u1ee3c coi l\u00e0 h\u1eb1ng s\u1ed1, h\u00e0nh vi ti\u1ec7m c\u1eadn l\u00e0 tuy\u1ebfn t\u00ednh).</p> <p>\u0110\u1ea7u v\u00e0o cho thu\u1eadt to\u00e1n l\u00e0 chu\u1ed7i $s$ v\u00e0 \u0111\u1ed9 d\u00e0i $n$ c\u1ee7a n\u00f3, \u0111\u01b0\u1ee3c chuy\u1ec3n qua d\u01b0\u1edbi d\u1ea1ng c\u00e1c bi\u1ebfn to\u00e0n c\u1ee5c.</p> <p>H\u00e0m ch\u00ednh <code>build_tree</code> x\u00e2y d\u1ef1ng m\u1ed9t c\u00e2y h\u1eadu t\u1ed1. N\u00f3 \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef d\u01b0\u1edbi d\u1ea1ng m\u1ed9t m\u1ea3ng c\u00e1c c\u1ea5u tr\u00fac <code>node</code>, trong \u0111\u00f3 <code>node[0]</code> l\u00e0 g\u1ed1c c\u1ee7a c\u00e2y.</p> <p>\u0110\u1ec3 \u0111\u01a1n gi\u1ea3n h\u00f3a m\u00e3, c\u00e1c c\u1ea1nh \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef trong c\u00f9ng m\u1ed9t c\u1ea5u tr\u00fac: \u0111\u1ed1i v\u1edbi m\u1ed7i \u0111\u1ec9nh, c\u1ea5u tr\u00fac <code>node</code> l\u01b0u tr\u1eef th\u00f4ng tin v\u1ec1 c\u1ea1nh gi\u1eefa n\u00f3 v\u00e0 cha c\u1ee7a n\u00f3. Nh\u00ecn chung m\u1ed7i <code>node</code> l\u01b0u tr\u1eef c\u00e1c th\u00f4ng tin sau:</p> <ul> <li><code>(l, r)</code> - ranh gi\u1edbi b\u00ean tr\u00e1i v\u00e0 b\u00ean ph\u1ea3i c\u1ee7a chu\u1ed7i con <code>s[l..r-1]</code> t\u01b0\u01a1ng \u1ee9ng v\u1edbi c\u1ea1nh \u0111\u1ebfn n\u00fat n\u00e0y,</li> <li><code>par</code> - n\u00fat cha,</li> <li><code>link</code> - li\u00ean k\u1ebft h\u1eadu t\u1ed1,</li> <li><code>next</code> - danh s\u00e1ch c\u00e1c c\u1ea1nh \u0111i ra t\u1eeb n\u00fat n\u00e0y.</li> </ul> <pre><code>string s;\nint n;\n\nstruct node {\n    int l, r, par, link;\n    map&lt;char,int&gt; next;\n\n    node (int l=0, int r=0, int par=-1)\n        : l(l), r(r), par(par), link(-1) {}\n    int len()  {  return r - l;  }\n    int &amp;get (char c) {\n        if (!next.count(c))  next[c] = -1;\n        return next[c];\n    }\n};\nnode t[MAXN];\nint sz;\n\nstruct state {\n    int v, pos;\n    state (int v, int pos) : v(v), pos(pos)  {}\n};\nstate ptr (0, 0);\n\nstate go (state st, int l, int r) {\n    while (l &lt; r)\n        if (st.pos == t[st.v].len()) {\n            st = state (t[st.v].get( s[l] ), 0);\n            if (st.v == -1)  return st;\n        }\n        else {\n            if (s[ t[st.v].l + st.pos ] != s[l])\n                return state (-1, -1);\n            if (r-l &lt; t[st.v].len() - st.pos)\n                return state (st.v, st.pos + r-l);\n            l += t[st.v].len() - st.pos;\n            st.pos = t[st.v].len();\n        }\n    return st;\n}\n\nint split (state st) {\n    if (st.pos == t[st.v].len())\n        return st.v;\n    if (st.pos == 0)\n        return t[st.v].par;\n    node v = t[st.v];\n    int id = sz++;\n    t[id] = node (v.l, v.l+st.pos, v.par);\n    t[v.par].get( s[v.l] ) = id;\n    t[id].get( s[v.l+st.pos] ) = st.v;\n    t[st.v].par = id;\n    t[st.v].l += st.pos;\n    return id;\n}\n\nint get_link (int v) {\n    if (t[v].link != -1)  return t[v].link;\n    if (t[v].par == -1)  return 0;\n    int to = get_link (t[v].par);\n    return t[v].link = split (go (state(to,t[to].len()), t[v].l + (t[v].par==0), t[v].r));\n}\n\nvoid tree_extend (int pos) {\n    for(;;) {\n        state nptr = go (ptr, pos, pos+1);\n        if (nptr.v != -1) {\n            ptr = nptr;\n            return;\n        }\n\n        int mid = split (ptr);\n        int leaf = sz++;\n        t[leaf] = node (pos, n, mid);\n        t[mid].get( s[pos] ) = leaf;\n\n        ptr.v = get_link (mid);\n        ptr.pos = t[ptr.v].len();\n        if (!mid)  break;\n    }\n}\n\nvoid build_tree() {\n    sz = 1;\n    for (int i=0; i&lt;n; ++i)\n        tree_extend (i);\n}\n</code></pre>","tags":["Translated"]},{"location":"string/suffix-tree-ukkonen.html#compressed-implementation","title":"C\u00e0i \u0111\u1eb7t n\u00e9n (Compressed Implementation)","text":"<p>Vi\u1ec7c c\u00e0i \u0111\u1eb7t n\u00e9n n\u00e0y \u0111\u01b0\u1ee3c \u0111\u1ec1 xu\u1ea5t b\u1edfi freopen.</p> <pre><code>const int N=1000000,INF=1000000000;\nstring a;\nint t[N][26],l[N],r[N],p[N],s[N],tv,tp,ts,la;\n\nvoid ukkadd (int c) {\n    suff:;\n    if (r[tv]&lt;tp) {\n        if (t[tv][c]==-1) { t[tv][c]=ts;  l[ts]=la;\n            p[ts++]=tv;  tv=s[tv];  tp=r[tv]+1;  goto suff; }\n        tv=t[tv][c]; tp=l[tv];\n    }\n    if (tp==-1 || c==a[tp]-'a') tp++; else {\n        l[ts+1]=la;  p[ts+1]=ts;\n        l[ts]=l[tv];  r[ts]=tp-1;  p[ts]=p[tv];  t[ts][c]=ts+1;  t[ts][a[tp]-'a']=tv;\n        l[tv]=tp;  p[tv]=ts;  t[p[ts]][a[l[ts]]-'a']=ts;  ts+=2;\n        tv=s[p[ts-2]];  tp=l[ts-2];\n        while (tp&lt;=r[ts-2]) {  tv=t[tv][a[tp]-'a'];  tp+=r[tv]-l[tv]+1;}\n        if (tp==r[ts-2]+1)  s[ts-2]=tv;  else s[ts-2]=ts; \n        tp=r[tv]-(tp-r[ts-2])+2;  goto suff;\n    }\n}\n\nvoid build() {\n    ts=2;\n    tv=0;\n    tp=0;\n    fill(r,r+N,(int)a.size()-1);\n    s[0]=1;\n    l[0]=-1;\n    r[0]=-1;\n    l[1]=-1;\n    r[1]=-1;\n    memset (t, -1, sizeof t);\n    fill(t[1],t[1]+26,0);\n    for (la=0; la&lt;(int)a.size(); ++la)\n        ukkadd (a[la]-'a');\n}\n</code></pre> <p>M\u00e3 t\u01b0\u01a1ng t\u1ef1 v\u1edbi c\u00e1c b\u00ecnh lu\u1eadn:</p> <pre><code>const int N=1000000,    // maximum possible number of nodes in suffix tree\n    INF=1000000000; // infinity constant\nstring a;       // input string for which the suffix tree is being built\nint t[N][26],   // array of transitions (state, letter)\n    l[N],   // left...\n    r[N],   // ...and right boundaries of the substring of a which correspond to incoming edge\n    p[N],   // parent of the node\n    s[N],   // suffix link\n    tv,     // the node of the current suffix (if we're mid-edge, the lower node of the edge)\n    tp,     // position in the string which corresponds to the position on the edge (between l[tv] and r[tv], inclusive)\n    ts,     // the number of nodes\n    la;     // the current character in the string\n\nvoid ukkadd(int c) { // add character s to the tree\n    suff:;      // we'll return here after each transition to the suffix (and will add character again)\n    if (r[tv]&lt;tp) { // check whether we're still within the boundaries of the current edge\n        // if we're not, find the next edge. If it doesn't exist, create a leaf and add it to the tree\n        if (t[tv][c]==-1) {t[tv][c]=ts;l[ts]=la;p[ts++]=tv;tv=s[tv];tp=r[tv]+1;goto suff;}\n        tv=t[tv][c];tp=l[tv];\n    } // otherwise just proceed to the next edge\n    if (tp==-1 || c==a[tp]-'a')\n        tp++; // if the letter on the edge equal c, go down that edge\n    else { \n        // otherwise split the edge in two with middle in node ts\n        l[ts]=l[tv];r[ts]=tp-1;p[ts]=p[tv];t[ts][a[tp]-'a']=tv;\n        // add leaf ts+1. It corresponds to transition through c.\n        t[ts][c]=ts+1;l[ts+1]=la;p[ts+1]=ts;\n        // update info for the current node - remember to mark ts as parent of tv\n        l[tv]=tp;p[tv]=ts;t[p[ts]][a[l[ts]]-'a']=ts;ts+=2;\n        // prepare for descent\n        // tp will mark where are we in the current suffix\n        tv=s[p[ts-2]];tp=l[ts-2];\n        // while the current suffix is not over, descend\n        while (tp&lt;=r[ts-2]) {tv=t[tv][a[tp]-'a'];tp+=r[tv]-l[tv]+1;}\n        // if we're in a node, add a suffix link to it, otherwise add the link to ts\n        // (we'll create ts on next iteration).\n        if (tp==r[ts-2]+1) s[ts-2]=tv; else s[ts-2]=ts; \n        // add tp to the new edge and return to add letter to suffix\n        tp=r[tv]-(tp-r[ts-2])+2;goto suff;\n    }\n}\n\nvoid build() {\n    ts=2;\n    tv=0;\n    tp=0;\n    fill(r,r+N,(int)a.size()-1);\n    // initialize data for the root of the tree\n    s[0]=1;\n    l[0]=-1;\n    r[0]=-1;\n    l[1]=-1;\n    r[1]=-1;\n    memset (t, -1, sizeof t);\n    fill(t[1],t[1]+26,0);\n    // add the text to the tree, letter by letter\n    for (la=0; la&lt;(int)a.size(); ++la)\n        ukkadd (a[la]-'a');\n}\n</code></pre>","tags":["Translated"]},{"location":"string/suffix-tree-ukkonen.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>UVA 10679 - I Love Strings!!!</li> </ul>","tags":["Translated"]},{"location":"string/z-function.html","title":"H\u00e0m Z v\u00e0 c\u00e1ch t\u00ednh to\u00e1n (Z-function and its calculation)","text":"<p>Gi\u1ea3 s\u1eed ch\u00fang ta \u0111\u01b0\u1ee3c cho m\u1ed9t chu\u1ed7i $s$ c\u00f3 \u0111\u1ed9 d\u00e0i $n$. H\u00e0m Z (Z-function) cho chu\u1ed7i n\u00e0y l\u00e0 m\u1ed9t m\u1ea3ng c\u00f3 \u0111\u1ed9 d\u00e0i $n$ trong \u0111\u00f3 ph\u1ea7n t\u1eed th\u1ee9 $i$ b\u1eb1ng s\u1ed1 l\u01b0\u1ee3ng k\u00fd t\u1ef1 l\u1edbn nh\u1ea5t b\u1eaft \u0111\u1ea7u t\u1eeb v\u1ecb tr\u00ed $i$ tr\u00f9ng kh\u1edbp v\u1edbi c\u00e1c k\u00fd t\u1ef1 \u0111\u1ea7u ti\u00ean c\u1ee7a $s$.</p> <p>N\u00f3i c\u00e1ch kh\u00e1c, $z[i]$ l\u00e0 \u0111\u1ed9 d\u00e0i c\u1ee7a chu\u1ed7i d\u00e0i nh\u1ea5t \u0111\u1ed3ng th\u1eddi l\u00e0 ti\u1ec1n t\u1ed1 c\u1ee7a $s$ v\u00e0 l\u00e0 ti\u1ec1n t\u1ed1 c\u1ee7a h\u1eadu t\u1ed1 c\u1ee7a $s$ b\u1eaft \u0111\u1ea7u t\u1ea1i $i$.</p> <p>L\u01b0u \u00fd. Trong b\u00e0i vi\u1ebft n\u00e0y, \u0111\u1ec3 tr\u00e1nh m\u01a1 h\u1ed3, ch\u00fang t\u00f4i gi\u1ea3 s\u1eed ch\u1ec9 s\u1ed1 b\u1eaft \u0111\u1ea7u t\u1eeb $0$; t\u1ee9c l\u00e0: k\u00fd t\u1ef1 \u0111\u1ea7u ti\u00ean c\u1ee7a $s$ c\u00f3 ch\u1ec9 s\u1ed1 $0$ v\u00e0 k\u00fd t\u1ef1 cu\u1ed1i c\u00f9ng c\u00f3 ch\u1ec9 s\u1ed1 $n-1$.</p> <p>Ph\u1ea7n t\u1eed \u0111\u1ea7u ti\u00ean c\u1ee7a h\u00e0m Z, $z[0]$, th\u01b0\u1eddng kh\u00f4ng \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a r\u00f5 r\u00e0ng. Trong b\u00e0i vi\u1ebft n\u00e0y, ch\u00fang t\u00f4i s\u1ebd gi\u1ea3 s\u1eed n\u00f3 b\u1eb1ng kh\u00f4ng (m\u1eb7c d\u00f9 n\u00f3 kh\u00f4ng thay \u0111\u1ed5i b\u1ea5t c\u1ee9 \u0111i\u1ec1u g\u00ec trong vi\u1ec7c c\u00e0i \u0111\u1eb7t thu\u1eadt to\u00e1n).</p> <p>B\u00e0i vi\u1ebft n\u00e0y tr\u00ecnh b\u00e0y m\u1ed9t thu\u1eadt to\u00e1n \u0111\u1ec3 t\u00ednh to\u00e1n h\u00e0m Z trong th\u1eddi gian $O(n)$, c\u0169ng nh\u01b0 c\u00e1c \u1ee9ng d\u1ee5ng kh\u00e1c nhau c\u1ee7a n\u00f3.</p>","tags":["Translated"]},{"location":"string/z-function.html#examples","title":"V\u00ed d\u1ee5 (Examples)","text":"<p>V\u00ed d\u1ee5, \u0111\u00e2y l\u00e0 c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a h\u00e0m Z \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n cho c\u00e1c chu\u1ed7i kh\u00e1c nhau:</p> <ul> <li>\"aaaaa\" - $[0, 4, 3, 2, 1]$</li> <li>\"aaabaab\" - $[0, 2, 1, 0, 2, 1, 0]$</li> <li>\"abacaba\" - $[0, 0, 1, 0, 3, 0, 1]$</li> </ul>","tags":["Translated"]},{"location":"string/z-function.html#trivial-algorithm","title":"Thu\u1eadt to\u00e1n t\u1ea7m th\u01b0\u1eddng (Trivial algorithm)","text":"<p>\u0110\u1ecbnh ngh\u0129a ch\u00ednh th\u1ee9c c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n trong c\u00e0i \u0111\u1eb7t s\u01a1 c\u1ea5p $O(n^2)$ sau \u0111\u00e2y.</p> <pre><code>vector&lt;int&gt; z_function_trivial(string s) {\n    int n = s.size();\n    vector&lt;int&gt; z(n);\n    for (int i = 1; i &lt; n; i++) {\n        while (i + z[i] &lt; n &amp;&amp; s[z[i]] == s[i + z[i]]) {\n            z[i]++;\n        }\n    }\n    return z;\n}\n</code></pre> <p>Ch\u00fang ta ch\u1ec9 c\u1ea7n l\u1eb7p qua m\u1ecdi v\u1ecb tr\u00ed $i$ v\u00e0 c\u1eadp nh\u1eadt $z[i]$ cho m\u1ed7i v\u1ecb tr\u00ed \u0111\u00f3, b\u1eaft \u0111\u1ea7u t\u1eeb $z[i] = 0$ v\u00e0 t\u0103ng d\u1ea7n mi\u1ec5n l\u00e0 ch\u00fang ta kh\u00f4ng t\u00ecm th\u1ea5y s\u1ef1 kh\u00f4ng kh\u1edbp (v\u00e0 mi\u1ec5n l\u00e0 ch\u00fang ta kh\u00f4ng \u0111\u1ebfn cu\u1ed1i d\u00f2ng).</p> <p>T\u1ea5t nhi\u00ean, \u0111\u00e2y kh\u00f4ng ph\u1ea3i l\u00e0 m\u1ed9t c\u00e0i \u0111\u1eb7t hi\u1ec7u qu\u1ea3. B\u00e2y gi\u1edd ch\u00fang t\u00f4i s\u1ebd hi\u1ec3n th\u1ecb vi\u1ec7c x\u00e2y d\u1ef1ng m\u1ed9t c\u00e0i \u0111\u1eb7t hi\u1ec7u qu\u1ea3.</p>","tags":["Translated"]},{"location":"string/z-function.html#efficient-algorithm-to-compute-the-z-function","title":"Thu\u1eadt to\u00e1n hi\u1ec7u qu\u1ea3 \u0111\u1ec3 t\u00ednh h\u00e0m Z (Efficient algorithm to compute the Z-function)","text":"<p>\u0110\u1ec3 c\u00f3 \u0111\u01b0\u1ee3c m\u1ed9t thu\u1eadt to\u00e1n hi\u1ec7u qu\u1ea3, ch\u00fang ta s\u1ebd t\u00ednh to\u00e1n c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a $z[i]$ l\u1ea7n l\u01b0\u1ee3t t\u1eeb $i = 1$ \u0111\u1ebfn $n - 1$ nh\u01b0ng \u0111\u1ed3ng th\u1eddi, khi t\u00ednh to\u00e1n m\u1ed9t gi\u00e1 tr\u1ecb m\u1edbi, ch\u00fang ta s\u1ebd c\u1ed1 g\u1eafng t\u1eadn d\u1ee5ng t\u1ed1t nh\u1ea5t c\u00f3 th\u1ec3 c\u00e1c gi\u00e1 tr\u1ecb \u0111\u00e3 \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n tr\u01b0\u1edbc \u0111\u00f3.</p> <p>\u0110\u1ec3 ng\u1eafn g\u1ecdn, h\u00e3y g\u1ecdi \u0111o\u1ea1n kh\u1edbp (segment matches) l\u00e0 nh\u1eefng chu\u1ed7i con tr\u00f9ng kh\u1edbp v\u1edbi ti\u1ec1n t\u1ed1 c\u1ee7a $s$. V\u00ed d\u1ee5: gi\u00e1 tr\u1ecb c\u1ee7a h\u00e0m Z mong mu\u1ed1n $z[i]$ l\u00e0 \u0111\u1ed9 d\u00e0i c\u1ee7a \u0111o\u1ea1n kh\u1edbp b\u1eaft \u0111\u1ea7u t\u1ea1i v\u1ecb tr\u00ed $i$ (v\u00e0 k\u1ebft th\u00fac t\u1ea1i v\u1ecb tr\u00ed $i + z[i] - 1$).</p> <p>\u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y, ch\u00fang ta s\u1ebd gi\u1eef c\u00e1c ch\u1ec9 s\u1ed1 $[l, r)$ c\u1ee7a \u0111o\u1ea1n kh\u1edbp ngo\u00e0i c\u00f9ng b\u00ean ph\u1ea3i. T\u1ee9c l\u00e0, trong s\u1ed1 t\u1ea5t c\u1ea3 c\u00e1c \u0111o\u1ea1n \u0111\u01b0\u1ee3c ph\u00e1t hi\u1ec7n, ch\u00fang ta s\u1ebd gi\u1eef \u0111o\u1ea1n k\u1ebft th\u00fac xa nh\u1ea5t v\u1ec1 b\u00ean ph\u1ea3i. Theo m\u1ed9t c\u00e1ch n\u00e0o \u0111\u00f3, ch\u1ec9 s\u1ed1 $r$ c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c coi l\u00e0 \"bi\u00ean gi\u1edbi\" m\u00e0 chu\u1ed7i $s$ c\u1ee7a ch\u00fang ta \u0111\u00e3 \u0111\u01b0\u1ee3c qu\u00e9t b\u1edfi thu\u1eadt to\u00e1n; m\u1ecdi th\u1ee9 n\u1eb1m ngo\u00e0i \u0111i\u1ec3m \u0111\u00f3 v\u1eabn ch\u01b0a \u0111\u01b0\u1ee3c bi\u1ebft.</p> <p>Sau \u0111\u00f3, n\u1ebfu ch\u1ec9 s\u1ed1 hi\u1ec7n t\u1ea1i (m\u00e0 ch\u00fang ta ph\u1ea3i t\u00ednh to\u00e1n gi\u00e1 tr\u1ecb ti\u1ebfp theo c\u1ee7a h\u00e0m Z) l\u00e0 $i$, ch\u00fang ta c\u00f3 m\u1ed9t trong hai t\u00f9y ch\u1ecdn:</p> <ul> <li> <p>$i \\geq r$ -- v\u1ecb tr\u00ed hi\u1ec7n t\u1ea1i n\u1eb1m b\u00ean ngo\u00e0i nh\u1eefng g\u00ec ch\u00fang ta \u0111\u00e3 x\u1eed l\u00fd.</p> <p>Sau \u0111\u00f3, ch\u00fang ta s\u1ebd t\u00ednh to\u00e1n $z[i]$ v\u1edbi thu\u1eadt to\u00e1n t\u1ea7m th\u01b0\u1eddng (t\u1ee9c l\u00e0 ch\u1ec9 so s\u00e1nh t\u1eebng gi\u00e1 tr\u1ecb m\u1ed9t). L\u01b0u \u00fd r\u1eb1ng cu\u1ed1i c\u00f9ng, n\u1ebfu $z[i] &gt; 0$, ch\u00fang ta s\u1ebd ph\u1ea3i c\u1eadp nh\u1eadt c\u00e1c ch\u1ec9 s\u1ed1 c\u1ee7a \u0111o\u1ea1n ngo\u00e0i c\u00f9ng b\u00ean ph\u1ea3i, b\u1edfi v\u00ec \u0111\u1ea3m b\u1ea3o r\u1eb1ng $r = i + z[i]$ m\u1edbi t\u1ed1t h\u01a1n $r$ tr\u01b0\u1edbc \u0111\u00f3.</p> </li> <li> <p>$i &lt; r$ -- v\u1ecb tr\u00ed hi\u1ec7n t\u1ea1i n\u1eb1m b\u00ean trong \u0111o\u1ea1n kh\u1edbp hi\u1ec7n t\u1ea1i $[l, r)$.</p> <p>Sau \u0111\u00f3, ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng c\u00e1c gi\u00e1 tr\u1ecb Z \u0111\u00e3 t\u00ednh to\u00e1n \u0111\u1ec3 \"kh\u1edfi t\u1ea1o\" gi\u00e1 tr\u1ecb c\u1ee7a $z[i]$ th\u00e0nh m\u1ed9t c\u00e1i g\u00ec \u0111\u00f3 (ch\u1eafc ch\u1eafn t\u1ed1t h\u01a1n l\u00e0 \"b\u1eaft \u0111\u1ea7u t\u1eeb kh\u00f4ng\"), th\u1eadm ch\u00ed c\u00f3 th\u1ec3 l\u00e0 m\u1ed9t s\u1ed1 l\u1edbn.</p> <p>\u0110\u1ec3 l\u00e0m \u0111i\u1ec1u n\u00e0y, ch\u00fang ta quan s\u00e1t th\u1ea5y r\u1eb1ng c\u00e1c chu\u1ed7i con $s[l \\dots r)$ v\u00e0 $s[0 \\dots r-l)$ kh\u1edbp nhau. \u0110i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 nh\u01b0 m\u1ed9t x\u1ea5p x\u1ec9 ban \u0111\u1ea7u cho $z[i]$, ch\u00fang ta c\u00f3 th\u1ec3 l\u1ea5y gi\u00e1 tr\u1ecb \u0111\u00e3 \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n cho \u0111o\u1ea1n t\u01b0\u01a1ng \u1ee9ng $s[0 \\dots r-l)$, v\u00e0 \u0111\u00f3 l\u00e0 $z[i-l]$.</p> <p>Tuy nhi\u00ean, gi\u00e1 tr\u1ecb $z[i-l]$ c\u00f3 th\u1ec3 qu\u00e1 l\u1edbn: khi \u00e1p d\u1ee5ng cho v\u1ecb tr\u00ed $i$ n\u00f3 c\u00f3 th\u1ec3 v\u01b0\u1ee3t qu\u00e1 ch\u1ec9 s\u1ed1 $r$. \u0110i\u1ec1u n\u00e0y kh\u00f4ng \u0111\u01b0\u1ee3c ph\u00e9p v\u00ec ch\u00fang ta kh\u00f4ng bi\u1ebft g\u00ec v\u1ec1 c\u00e1c k\u00fd t\u1ef1 b\u00ean ph\u1ea3i c\u1ee7a $r$: ch\u00fang c\u00f3 th\u1ec3 kh\u00e1c v\u1edbi nh\u1eefng k\u00fd t\u1ef1 \u0111\u01b0\u1ee3c y\u00eau c\u1ea7u.</p> <p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 m\u1ed9t v\u00ed d\u1ee5 v\u1ec1 m\u1ed9t k\u1ecbch b\u1ea3n t\u01b0\u01a1ng t\u1ef1:</p> $$ s = \"aaaabaa\" $$ <p>Khi ch\u00fang ta \u0111\u1ebfn v\u1ecb tr\u00ed cu\u1ed1i c\u00f9ng ($i = 6$), \u0111o\u1ea1n kh\u1edbp hi\u1ec7n t\u1ea1i s\u1ebd l\u00e0 $[5, 7)$. V\u1ecb tr\u00ed $6$ sau \u0111\u00f3 s\u1ebd kh\u1edbp v\u1edbi v\u1ecb tr\u00ed $6 - 5 = 1$, m\u00e0 gi\u00e1 tr\u1ecb c\u1ee7a h\u00e0m Z l\u00e0 $z[1] = 3$. R\u00f5 r\u00e0ng, ch\u00fang ta kh\u00f4ng th\u1ec3 kh\u1edfi t\u1ea1o $z[6]$ th\u00e0nh $3$, n\u00f3 s\u1ebd ho\u00e0n to\u00e0n kh\u00f4ng ch\u00ednh x\u00e1c. Gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t m\u00e0 ch\u00fang ta c\u00f3 th\u1ec3 kh\u1edfi t\u1ea1o n\u00f3 l\u00e0 $1$ -- b\u1edfi v\u00ec \u0111\u00f3 l\u00e0 gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t kh\u00f4ng \u0111\u01b0a ch\u00fang ta v\u01b0\u1ee3t qu\u00e1 ch\u1ec9 s\u1ed1 $r$ c\u1ee7a \u0111o\u1ea1n kh\u1edbp $[l, r)$.</p> <p>Do \u0111\u00f3, nh\u01b0 m\u1ed9t x\u1ea5p x\u1ec9 ban \u0111\u1ea7u cho $z[i]$, ch\u00fang ta c\u00f3 th\u1ec3 l\u1ea5y m\u1ed9t c\u00e1ch an to\u00e0n:</p> $$ z_0[i] = \\min(r - i,\\; z[i-l]) $$ <p>Sau khi c\u00f3 $z[i]$ \u0111\u01b0\u1ee3c kh\u1edfi t\u1ea1o th\u00e0nh $z_0[i]$, ch\u00fang ta c\u1ed1 g\u1eafng t\u0103ng $z[i]$ b\u1eb1ng c\u00e1ch ch\u1ea1y thu\u1eadt to\u00e1n t\u1ea7m th\u01b0\u1eddng -- b\u1edfi v\u00ec n\u00f3i chung, sau bi\u00ean gi\u1edbi $r$, ch\u00fang ta kh\u00f4ng th\u1ec3 bi\u1ebft li\u1ec7u \u0111o\u1ea1n \u0111\u00f3 c\u00f3 ti\u1ebfp t\u1ee5c kh\u1edbp hay kh\u00f4ng.</p> </li> </ul> <p>Do \u0111\u00f3, to\u00e0n b\u1ed9 thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c chia th\u00e0nh hai tr\u01b0\u1eddng h\u1ee3p, ch\u1ec9 kh\u00e1c nhau \u1edf gi\u00e1 tr\u1ecb ban \u0111\u1ea7u c\u1ee7a $z[i]$: trong tr\u01b0\u1eddng h\u1ee3p \u0111\u1ea7u ti\u00ean n\u00f3 \u0111\u01b0\u1ee3c gi\u1ea3 \u0111\u1ecbnh l\u00e0 kh\u00f4ng, trong tr\u01b0\u1eddng h\u1ee3p th\u1ee9 hai n\u00f3 \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh b\u1edfi c\u00e1c gi\u00e1 tr\u1ecb \u0111\u00e3 \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n tr\u01b0\u1edbc \u0111\u00f3 (s\u1eed d\u1ee5ng c\u00f4ng th\u1ee9c tr\u00ean). Sau \u0111\u00f3, c\u1ea3 hai nh\u00e1nh c\u1ee7a thu\u1eadt to\u00e1n n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c r\u00fat g\u1ecdn th\u00e0nh vi\u1ec7c th\u1ef1c hi\u1ec7n thu\u1eadt to\u00e1n t\u1ea7m th\u01b0\u1eddng, b\u1eaft \u0111\u1ea7u ngay sau khi ch\u00fang ta ch\u1ec9 \u0111\u1ecbnh gi\u00e1 tr\u1ecb ban \u0111\u1ea7u.</p> <p>Thu\u1eadt to\u00e1n h\u00f3a ra r\u1ea5t \u0111\u01a1n gi\u1ea3n. M\u1eb7c d\u00f9 th\u1ef1c t\u1ebf l\u00e0 tr\u00ean m\u1ed7i l\u1ea7n l\u1eb7p, thu\u1eadt to\u00e1n t\u1ea7m th\u01b0\u1eddng \u0111\u01b0\u1ee3c ch\u1ea1y, ch\u00fang ta \u0111\u00e3 \u0111\u1ea1t \u0111\u01b0\u1ee3c ti\u1ebfn b\u1ed9 \u0111\u00e1ng k\u1ec3, c\u00f3 m\u1ed9t thu\u1eadt to\u00e1n ch\u1ea1y trong th\u1eddi gian tuy\u1ebfn t\u00ednh. Sau n\u00e0y ch\u00fang ta s\u1ebd ch\u1ee9ng minh r\u1eb1ng th\u1eddi gian ch\u1ea1y l\u00e0 tuy\u1ebfn t\u00ednh.</p>","tags":["Translated"]},{"location":"string/z-function.html#implementation","title":"C\u00e0i \u0111\u1eb7t (Implementation)","text":"<p>Vi\u1ec7c c\u00e0i \u0111\u1eb7t h\u00f3a ra kh\u00e1 ng\u1eafn g\u1ecdn:</p> <pre><code>vector&lt;int&gt; z_function(string s) {\n    int n = s.size();\n    vector&lt;int&gt; z(n);\n    int l = 0, r = 0;\n    for(int i = 1; i &lt; n; i++) {\n        if(i &lt; r) {\n            z[i] = min(r - i, z[i - l]);\n        }\n        while(i + z[i] &lt; n &amp;&amp; s[z[i]] == s[i + z[i]]) {\n            z[i]++;\n        }\n        if(i + z[i] &gt; r) {\n            l = i;\n            r = i + z[i];\n        }\n    }\n    return z;\n}\n</code></pre>","tags":["Translated"]},{"location":"string/z-function.html#comments-on-this-implementation","title":"Nh\u1eadn x\u00e9t v\u1ec1 vi\u1ec7c c\u00e0i \u0111\u1eb7t (Comments on this implementation)","text":"<p>To\u00e0n b\u1ed9 gi\u1ea3i ph\u00e1p \u0111\u01b0\u1ee3c \u0111\u01b0a ra d\u01b0\u1edbi d\u1ea1ng m\u1ed9t h\u00e0m tr\u1ea3 v\u1ec1 m\u1ed9t m\u1ea3ng c\u00f3 \u0111\u1ed9 d\u00e0i $n$ -- h\u00e0m Z c\u1ee7a $s$.</p> <p>M\u1ea3ng $z$ ban \u0111\u1ea7u \u0111\u01b0\u1ee3c \u0111i\u1ec1n b\u1eb1ng c\u00e1c s\u1ed1 kh\u00f4ng. \u0110o\u1ea1n kh\u1edbp ngo\u00e0i c\u00f9ng b\u00ean ph\u1ea3i hi\u1ec7n t\u1ea1i \u0111\u01b0\u1ee3c gi\u1ea3 \u0111\u1ecbnh l\u00e0 $[0; 0)$ (t\u1ee9c l\u00e0 m\u1ed9t \u0111o\u1ea1n nh\u1ecf m\u1ed9t c\u00e1ch c\u1ed1 \u00fd kh\u00f4ng ch\u1ee9a b\u1ea5t k\u1ef3 $i$ n\u00e0o).</p> <p>B\u00ean trong v\u00f2ng l\u1eb7p cho $i = 1 \\dots n - 1$, tr\u01b0\u1edbc ti\u00ean ch\u00fang ta x\u00e1c \u0111\u1ecbnh gi\u00e1 tr\u1ecb ban \u0111\u1ea7u $z[i]$ -- n\u00f3 s\u1ebd v\u1eabn b\u1eb1ng kh\u00f4ng ho\u1eb7c \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n b\u1eb1ng c\u00f4ng th\u1ee9c tr\u00ean.</p> <p>Sau \u0111\u00f3, thu\u1eadt to\u00e1n t\u1ea7m th\u01b0\u1eddng c\u1ed1 g\u1eafng t\u0103ng gi\u00e1 tr\u1ecb c\u1ee7a $z[i]$ c\u00e0ng nhi\u1ec1u c\u00e0ng t\u1ed1t.</p> <p>Cu\u1ed1i c\u00f9ng, n\u1ebfu \u0111\u01b0\u1ee3c y\u00eau c\u1ea7u (t\u1ee9c l\u00e0 n\u1ebfu $i + z[i] &gt; r$), ch\u00fang ta c\u1eadp nh\u1eadt \u0111o\u1ea1n kh\u1edbp ngo\u00e0i c\u00f9ng b\u00ean ph\u1ea3i $[l, r)$.</p>","tags":["Translated"]},{"location":"string/z-function.html#asymptotic-behavior-of-the-algorithm","title":"H\u00e0nh vi ti\u1ec7m c\u1eadn c\u1ee7a thu\u1eadt to\u00e1n (Asymptotic behavior of the algorithm)","text":"<p>Ch\u00fang ta s\u1ebd ch\u1ee9ng minh r\u1eb1ng thu\u1eadt to\u00e1n tr\u00ean c\u00f3 th\u1eddi gian ch\u1ea1y tuy\u1ebfn t\u00ednh theo \u0111\u1ed9 d\u00e0i c\u1ee7a chu\u1ed7i -- do \u0111\u00f3, n\u00f3 l\u00e0 $O(n)$.</p> <p>B\u1eb1ng ch\u1ee9ng r\u1ea5t \u0111\u01a1n gi\u1ea3n.</p> <p>Ch\u00fang ta quan t\u00e2m \u0111\u1ebfn v\u00f2ng l\u1eb7p <code>while</code> l\u1ed3ng nhau, v\u00ec m\u1ecdi th\u1ee9 kh\u00e1c ch\u1ec9 l\u00e0 m\u1ed9t lo\u1ea1t c\u00e1c ho\u1ea1t \u0111\u1ed9ng h\u1eb1ng s\u1ed1 c\u1ed9ng l\u1ea1i th\u00e0nh $O(n)$.</p> <p>Ch\u00fang tase\u1ebd ch\u1ec9 ra r\u1eb1ng m\u1ed7i l\u1ea7n l\u1eb7p c\u1ee7a v\u00f2ng l\u1eb7p <code>while</code> s\u1ebd t\u0103ng bi\u00ean gi\u1edbi b\u00ean ph\u1ea3i $r$ c\u1ee7a \u0111o\u1ea1n kh\u1edbp.</p> <p>\u0110\u1ec3 l\u00e0m \u0111i\u1ec1u \u0111\u00f3, ch\u00fang ta s\u1ebd xem x\u00e9t c\u1ea3 hai nh\u00e1nh c\u1ee7a thu\u1eadt to\u00e1n:</p> <ul> <li> <p>$i \\geq r$</p> <p>Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, v\u00f2ng l\u1eb7p <code>while</code> s\u1ebd kh\u00f4ng th\u1ef1c hi\u1ec7n b\u1ea5t k\u1ef3 l\u1ea7n l\u1eb7p n\u00e0o (n\u1ebfu $s[0] \\ne s[i]$), ho\u1eb7c n\u00f3 s\u1ebd m\u1ea5t m\u1ed9t v\u00e0i l\u1ea7n l\u1eb7p, b\u1eaft \u0111\u1ea7u t\u1ea1i v\u1ecb tr\u00ed $i$, m\u1ed7i l\u1ea7n di chuy\u1ec3n m\u1ed9t k\u00fd t\u1ef1 sang ph\u1ea3i. Sau \u0111\u00f3, bi\u00ean gi\u1edbi b\u00ean ph\u1ea3i $r$ nh\u1ea5t thi\u1ebft s\u1ebd \u0111\u01b0\u1ee3c c\u1eadp nh\u1eadt.</p> <p>V\u00ec v\u1eady, ch\u00fang ta \u0111\u00e3 th\u1ea5y r\u1eb1ng, khi $i \\geq r$, m\u1ed7i l\u1ea7n l\u1eb7p c\u1ee7a v\u00f2ng l\u1eb7p <code>while</code> l\u00e0m t\u0103ng gi\u00e1 tr\u1ecb c\u1ee7a ch\u1ec9 s\u1ed1 $r$ m\u1edbi.</p> </li> <li> <p>$i &lt; r$</p> <p>Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, ch\u00fang ta kh\u1edfi t\u1ea1o $z[i]$ th\u00e0nh m\u1ed9t gi\u00e1 tr\u1ecb nh\u1ea5t \u0111\u1ecbnh $z_0$ \u0111\u01b0\u1ee3c \u0111\u01b0a ra b\u1edfi c\u00f4ng th\u1ee9c tr\u00ean. H\u00e3y so s\u00e1nh gi\u00e1 tr\u1ecb ban \u0111\u1ea7u $z_0$ n\u00e0y v\u1edbi gi\u00e1 tr\u1ecb $r - i$. Ch\u00fang ta s\u1ebd c\u00f3 ba tr\u01b0\u1eddng h\u1ee3p:</p> <ul> <li> <p>$z_0 &lt; r - i$</p> <p>Ch\u00fang ta ch\u1ee9ng minh r\u1eb1ng trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y kh\u00f4ng c\u00f3 l\u1ea7n l\u1eb7p n\u00e0o c\u1ee7a v\u00f2ng l\u1eb7p <code>while</code> s\u1ebd di\u1ec5n ra.</p> <p>R\u1ea5t d\u1ec5 \u0111\u1ec3 ch\u1ee9ng minh, v\u00ed d\u1ee5, b\u1eb1ng m\u00e2u thu\u1eabn: n\u1ebfu v\u00f2ng l\u1eb7p <code>while</code> th\u1ef1c hi\u1ec7n \u00edt nh\u1ea5t m\u1ed9t l\u1ea7n l\u1eb7p, \u0111i\u1ec1u \u0111\u00f3 c\u00f3 ngh\u0129a l\u00e0 x\u1ea5p x\u1ec9 ban \u0111\u1ea7u $z[i] = z_0$ l\u00e0 kh\u00f4ng ch\u00ednh x\u00e1c (nh\u1ecf h\u01a1n \u0111\u1ed9 d\u00e0i th\u1ef1c t\u1ebf c\u1ee7a kh\u1edbp). Nh\u01b0ng v\u00ec $s[l \\dots r)$ v\u00e0 $s[0 \\dots r-l)$ gi\u1ed1ng nhau, \u0111i\u1ec1u n\u00e0y ng\u1ee5 \u00fd r\u1eb1ng $z[i-l]$ gi\u1eef gi\u00e1 tr\u1ecb sai (nh\u1ecf h\u01a1n m\u1ee9c c\u1ea7n thi\u1ebft).</p> <p>Do \u0111\u00f3, v\u00ec $z[i-l]$ l\u00e0 ch\u00ednh x\u00e1c v\u00e0 n\u00f3 nh\u1ecf h\u01a1n $r - i$, suy ra gi\u00e1 tr\u1ecb n\u00e0y tr\u00f9ng v\u1edbi gi\u00e1 tr\u1ecb b\u1eaft bu\u1ed9c $z[i]$.</p> </li> <li> <p>$z_0 = r - i$</p> <p>Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, v\u00f2ng l\u1eb7p <code>while</code> c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n m\u1ed9t v\u00e0i l\u1ea7n l\u1eb7p, nh\u01b0ng m\u1ed7i l\u1ea7n trong s\u1ed1 \u0111\u00f3 s\u1ebd d\u1eabn \u0111\u1ebfn s\u1ef1 gia t\u0103ng gi\u00e1 tr\u1ecb c\u1ee7a ch\u1ec9 s\u1ed1 $r$ b\u1edfi v\u00ec ch\u00fang ta s\u1ebd b\u1eaft \u0111\u1ea7u so s\u00e1nh t\u1eeb $s[r]$, s\u1ebd leo ra ngo\u00e0i kho\u1ea3ng $[l, r)$.</p> </li> <li> <p>$z_0 &gt; r - i$</p> <p>T\u00f9y ch\u1ecdn n\u00e0y l\u00e0 kh\u00f4ng th\u1ec3, theo \u0111\u1ecbnh ngh\u0129a c\u1ee7a $z_0$.</p> </li> </ul> </li> </ul> <p>V\u00ec v\u1eady, ch\u00fang ta \u0111\u00e3 ch\u1ee9ng minh r\u1eb1ng m\u1ed7i l\u1ea7n l\u1eb7p c\u1ee7a v\u00f2ng l\u1eb7p b\u00ean trong l\u00e0m cho con tr\u1ecf $r$ ti\u1ebfn sang ph\u1ea3i. V\u00ec $r$ kh\u00f4ng th\u1ec3 l\u1edbn h\u01a1n $n-1$, \u0111i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 v\u00f2ng l\u1eb7p b\u00ean trong s\u1ebd kh\u00f4ng th\u1ef1c hi\u1ec7n qu\u00e1 $n-1$ l\u1ea7n l\u1eb7p.</p> <p>V\u00ec ph\u1ea7n c\u00f2n l\u1ea1i c\u1ee7a thu\u1eadt to\u00e1n ho\u1ea1t \u0111\u1ed9ng r\u00f5 r\u00e0ng trong $O(n)$, ch\u00fang ta \u0111\u00e3 ch\u1ee9ng minh r\u1eb1ng to\u00e0n b\u1ed9 thu\u1eadt to\u00e1n \u0111\u1ec3 t\u00ednh to\u00e1n h\u00e0m Z ch\u1ea1y trong th\u1eddi gian tuy\u1ebfn t\u00ednh.</p>","tags":["Translated"]},{"location":"string/z-function.html#applications","title":"\u1ee8ng d\u1ee5ng (Applications)","text":"<p>B\u00e2y gi\u1edd ch\u00fang ta s\u1ebd xem x\u00e9t m\u1ed9t s\u1ed1 c\u00e1ch s\u1eed d\u1ee5ng h\u00e0m Z cho c\u00e1c nhi\u1ec7m v\u1ee5 c\u1ee5 th\u1ec3.</p> <p>C\u00e1c \u1ee9ng d\u1ee5ng n\u00e0y s\u1ebd ph\u1ea7n l\u1edbn t\u01b0\u01a1ng t\u1ef1 nh\u01b0 c\u00e1c \u1ee9ng d\u1ee5ng c\u1ee7a h\u00e0m ti\u1ec1n t\u1ed1.</p>","tags":["Translated"]},{"location":"string/z-function.html#search-the-substring","title":"T\u00ecm ki\u1ebfm chu\u1ed7i con (Search the substring)","text":"<p>\u0110\u1ec3 tr\u00e1nh nh\u1ea7m l\u1eabn, ch\u00fang ta g\u1ecdi $t$ l\u00e0 chu\u1ed7i v\u0103n b\u1ea3n, v\u00e0 $p$ l\u00e0 m\u1eabu. B\u00e0i to\u00e1n l\u00e0: t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c l\u1ea7n xu\u1ea5t hi\u1ec7n c\u1ee7a m\u1eabu $p$ b\u00ean trong v\u0103n b\u1ea3n $t$.</p> <p>\u0110\u1ec3 gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 n\u00e0y, ch\u00fang ta t\u1ea1o ra m\u1ed9t chu\u1ed7i m\u1edbi $s = p + \\diamond + t$, t\u1ee9c l\u00e0, ch\u00fang ta \u00e1p d\u1ee5ng n\u1ed1i chu\u1ed7i cho $p$ v\u00e0 $t$ nh\u01b0ng ch\u00fang ta c\u0169ng \u0111\u1eb7t m\u1ed9t k\u00fd t\u1ef1 ph\u00e2n c\u00e1ch $\\diamond$ \u1edf gi\u1eefa (ch\u00fang ta s\u1ebd ch\u1ecdn $\\diamond$ \u0111\u1ec3 n\u00f3 ch\u1eafc ch\u1eafn s\u1ebd kh\u00f4ng hi\u1ec7n di\u1ec7n \u1edf b\u1ea5t c\u1ee9 \u0111\u00e2u trong c\u00e1c chu\u1ed7i $p$ ho\u1eb7c $t$).</p> <p>T\u00ednh h\u00e0m Z cho $s$. Sau \u0111\u00f3, \u0111\u1ed1i v\u1edbi b\u1ea5t k\u1ef3 $i$ n\u00e0o trong kho\u1ea3ng $[0; \\; \\operatorname{length}(t) - 1]$, ch\u00fang ta s\u1ebd xem x\u00e9t gi\u00e1 tr\u1ecb t\u01b0\u01a1ng \u1ee9ng $k = z[i + \\operatorname{length}(p) + 1]$. N\u1ebfu $k$ b\u1eb1ng $\\operatorname{length}(p)$ th\u00ec ch\u00fang ta bi\u1ebft c\u00f3 m\u1ed9t l\u1ea7n xu\u1ea5t hi\u1ec7n c\u1ee7a $p$ \u1edf v\u1ecb tr\u00ed th\u1ee9 $i$ c\u1ee7a $t$, ng\u01b0\u1ee3c l\u1ea1i kh\u00f4ng c\u00f3 s\u1ef1 xu\u1ea5t hi\u1ec7n n\u00e0o c\u1ee7a $p$ \u1edf v\u1ecb tr\u00ed th\u1ee9 $i$ c\u1ee7a $t$.</p> <p>Th\u1eddi gian ch\u1ea1y (v\u00e0 m\u1ee9c ti\u00eau th\u1ee5 b\u1ed9 nh\u1edb) l\u00e0 $O(\\operatorname{length}(t) + \\operatorname{length}(p))$.</p>","tags":["Translated"]},{"location":"string/z-function.html#number-of-distinct-substrings-in-a-string","title":"S\u1ed1 l\u01b0\u1ee3ng chu\u1ed7i con ri\u00eang bi\u1ec7t trong m\u1ed9t chu\u1ed7i (Number of distinct substrings in a string)","text":"<p>Cho m\u1ed9t chu\u1ed7i $s$ c\u00f3 \u0111\u1ed9 d\u00e0i $n$, h\u00e3y \u0111\u1ebfm s\u1ed1 l\u01b0\u1ee3ng chu\u1ed7i con ri\u00eang bi\u1ec7t c\u1ee7a $s$.</p> <p>Ch\u00fang ta s\u1ebd gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 n\u00e0y m\u1ed9t c\u00e1ch l\u1eb7p \u0111i l\u1eb7p l\u1ea1i. T\u1ee9c l\u00e0: bi\u1ebft s\u1ed1 l\u01b0\u1ee3ng chu\u1ed7i con kh\u00e1c nhau hi\u1ec7n t\u1ea1i, t\u00ednh to\u00e1n l\u1ea1i l\u01b0\u1ee3ng n\u00e0y sau khi th\u00eam v\u00e0o cu\u1ed1i $s$ m\u1ed9t k\u00fd t\u1ef1.</p> <p>V\u00ec v\u1eady, h\u00e3y \u0111\u1ec3 $k$ l\u00e0 s\u1ed1 l\u01b0\u1ee3ng chu\u1ed7i con ri\u00eang bi\u1ec7t hi\u1ec7n t\u1ea1i c\u1ee7a $s$. Ch\u00fang ta th\u00eam m\u1ed9t k\u00fd t\u1ef1 m\u1edbi $c$ v\u00e0o $s$. R\u00f5 r\u00e0ng, c\u00f3 th\u1ec3 c\u00f3 m\u1ed9t s\u1ed1 chu\u1ed7i con m\u1edbi k\u1ebft th\u00fac b\u1eb1ng k\u00fd t\u1ef1 m\u1edbi $c$ n\u00e0y (c\u1ee5 th\u1ec3 l\u00e0 t\u1ea5t c\u1ea3 c\u00e1c chu\u1ed7i k\u1ebft th\u00fac b\u1eb1ng k\u00fd hi\u1ec7u n\u00e0y v\u00e0 ch\u00fang ta ch\u01b0a g\u1eb7p).</p> <p>L\u1ea5y m\u1ed9t chu\u1ed7i $t = s + c$ v\u00e0 \u0111\u1ea3o ng\u01b0\u1ee3c n\u00f3 (vi\u1ebft c\u00e1c k\u00fd t\u1ef1 c\u1ee7a n\u00f3 theo th\u1ee9 t\u1ef1 ng\u01b0\u1ee3c l\u1ea1i). Nhi\u1ec7m v\u1ee5 c\u1ee7a ch\u00fang ta b\u00e2y gi\u1edd l\u00e0 \u0111\u1ebfm c\u00f3 bao nhi\u00eau ti\u1ec1n t\u1ed1 c\u1ee7a $t$ kh\u00f4ng \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y \u1edf b\u1ea5t k\u1ef3 n\u01a1i n\u00e0o kh\u00e1c trong $t$. H\u00e3y t\u00ednh h\u00e0m Z c\u1ee7a $t$ v\u00e0 t\u00ecm gi\u00e1 tr\u1ecb t\u1ed1i \u0111a $z_{max}$ c\u1ee7a n\u00f3. R\u00f5 r\u00e0ng, ti\u1ec1n t\u1ed1 c\u1ee7a $t$ c\u00f3 \u0111\u1ed9 d\u00e0i $z_{max}$ c\u0169ng xu\u1ea5t hi\u1ec7n \u1edf \u0111\u00e2u \u0111\u00f3 \u1edf gi\u1eefa $t$. R\u00f5 r\u00e0ng, c\u00e1c ti\u1ec1n t\u1ed1 ng\u1eafn h\u01a1n c\u0169ng xu\u1ea5t hi\u1ec7n.</p> <p>V\u00ec v\u1eady, ch\u00fang ta \u0111\u00e3 th\u1ea5y r\u1eb1ng s\u1ed1 l\u01b0\u1ee3ng chu\u1ed7i con m\u1edbi xu\u1ea5t hi\u1ec7n khi k\u00fd hi\u1ec7u $c$ \u0111\u01b0\u1ee3c th\u00eam v\u00e0o $s$ b\u1eb1ng $\\operatorname{length}(t) - z_{max}$.</p> <p>Do \u0111\u00f3, th\u1eddi gian ch\u1ea1y c\u1ee7a gi\u1ea3i ph\u00e1p n\u00e0y l\u00e0 $O(n^2)$ cho m\u1ed9t chu\u1ed7i c\u00f3 \u0111\u1ed9 d\u00e0i $n$.</p> <p>\u0110i\u1ec1u \u0111\u00e1ng ch\u00fa \u00fd l\u00e0 theo c\u00e1ch gi\u1ed1ng h\u1ec7t nhau, ch\u00fang ta c\u00f3 th\u1ec3 t\u00ednh to\u00e1n l\u1ea1i, v\u1eabn trong th\u1eddi gian $O(n)$, s\u1ed1 l\u01b0\u1ee3ng chu\u1ed7i con ri\u00eang bi\u1ec7t khi th\u00eam m\u1ed9t k\u00fd t\u1ef1 v\u00e0o \u0111\u1ea7u chu\u1ed7i, c\u0169ng nh\u01b0 khi x\u00f3a n\u00f3 (t\u1eeb cu\u1ed1i ho\u1eb7c \u0111\u1ea7u).</p>","tags":["Translated"]},{"location":"string/z-function.html#string-compression","title":"N\u00e9n chu\u1ed7i (String compression)","text":"<p>Cho m\u1ed9t chu\u1ed7i $s$ c\u00f3 \u0111\u1ed9 d\u00e0i $n$. T\u00ecm bi\u1ec3u di\u1ec5n \"n\u00e9n\" ng\u1eafn nh\u1ea5t c\u1ee7a n\u00f3, t\u1ee9c l\u00e0: t\u00ecm m\u1ed9t chu\u1ed7i $t$ c\u00f3 \u0111\u1ed9 d\u00e0i ng\u1eafn nh\u1ea5t sao cho $s$ c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n d\u01b0\u1edbi d\u1ea1ng n\u1ed1i c\u1ee7a m\u1ed9t ho\u1eb7c nhi\u1ec1u b\u1ea3n sao c\u1ee7a $t$.</p> <p>M\u1ed9t gi\u1ea3i ph\u00e1p l\u00e0: t\u00ednh h\u00e0m Z c\u1ee7a $s$, l\u1eb7p qua t\u1ea5t c\u1ea3 $i$ sao cho $i$ chia h\u1ebft cho $n$. D\u1eebng l\u1ea1i \u1edf $i$ \u0111\u1ea7u ti\u00ean sao cho $i + z[i] = n$. Sau \u0111\u00f3, chu\u1ed7i $s$ c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c n\u00e9n th\u00e0nh \u0111\u1ed9 d\u00e0i $i$.</p> <p>B\u1eb1ng ch\u1ee9ng cho th\u1ef1c t\u1ebf n\u00e0y gi\u1ed1ng nh\u01b0 gi\u1ea3i ph\u00e1p s\u1eed d\u1ee5ng h\u00e0m ti\u1ec1n t\u1ed1.</p>","tags":["Translated"]},{"location":"string/z-function.html#practice-problems","title":"B\u00e0i t\u1eadp (Practice Problems)","text":"<ul> <li>CSES - Finding Borders</li> <li>eolymp - Blocks of string</li> <li>Codeforces - Password [Difficulty: Easy]</li> <li>UVA # 455 \"Periodic Strings\" [Difficulty: Medium]</li> <li>UVA # 11022 \"String Factoring\" [Difficulty: Medium]</li> <li>UVa 11475 - Extend to Palindrome</li> <li>LA 6439 - Pasti Pas!</li> <li>Codechef - Chef and Strings</li> <li>Codeforces - Prefixes and Suffixes</li> </ul>","tags":["Translated"]}]}