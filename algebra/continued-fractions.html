
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Bản dịch tiếng Việt của dự án cp-algorithms">
      
      
      
        <link rel="canonical" href="https://deanqkhanhcoder.github.io/cp-algorithms-vi/algebra/continued-fractions.html">
      
      
        <link rel="prev" href="polynomial.html">
      
      
        <link rel="next" href="factoring-exp.html">
      
      
        
      
      
      <link rel="icon" href="../favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Liên phân số - Algorithms for Competitive Programming</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"JetBrains Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  <script src="../assets/javascripts/toggle-sidebar.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="cyan">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#continued-fractions" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <script>
    function scrollToTop() {
      document.body.scrollTop = 0;
      document.documentElement.scrollTop = 0;
    }
  </script>
  <nav class="md-header__inner md-grid" aria-label="header.title">
    <a href=".." title="Algorithms for Competitive Programming"
      class="md-header__button md-logo" aria-label="Algorithms for Competitive Programming" data-md-component="logo">
      
  <img src="../favicon.ico" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            <a href=".." title="Algorithms for Competitive Programming"
              aria-label="Algorithms for Competitive Programming" data-md-component="logo">
              Algorithms for Competitive Programming
            </a>
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            <a href="#" onclick="scrollToTop()">
              
              Liên phân số
              
            </a>
          </span>
        </div>
      </div>
    </div>

    
    <label class="md-header__button md-icon" for="__search">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
    </label>
    <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    

    <div class="md-header__option">
      <a href="https://www.instagram.com/deanqkhanh" title="Instagram" class="md-header__button md-icon"
        aria-label="Instagram">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M224.3 141a115 115 0 1 0-.6 230 115 115 0 1 0 .6-230m-.6 40.4a74.6 74.6 0 1 1 .6 149.2 74.6 74.6 0 1 1-.6-149.2m93.4-45.1a26.8 26.8 0 1 1 53.6 0 26.8 26.8 0 1 1-53.6 0m129.7 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8M399 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1"/></svg>
      </a>
    </div>

    <div class="md-header__option">
      <a href="https://github.com/deanqkhanhcoder/donate" title="GitHub Sponsors" class="md-header__button md-icon"
        aria-label="GitHub Sponsors">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M96 224a192 192 0 1 1 384 0 192 192 0 1 1-384 0m176-92v4c-28.8.3-52 23.7-52 52.5 0 25.7 18.5 47.6 43.9 51.8l41.7 7c6 1 10.4 6.2 10.4 12.3 0 6.9-5.6 12.5-12.5 12.5L248 272c-11 0-20 9-20 20s9 20 20 20h24v4c0 11 9 20 20 20s20-9 20-20v-4.7c25-4.1 44-25.7 44-51.8 0-25.7-18.5-47.6-43.9-51.8l-41.7-7c-6-1-10.4-6.2-10.4-12.3 0-6.9 5.6-12.5 12.5-12.5H320c11 0 20-9 20-20s-9-20-20-20h-8v-4c0-11-9-20-20-20s-20 9-20 20zM48 344v104c0 8.8 7.2 16 16 16h448c8.8 0 16-7.2 16-16V344c0-13.3 10.7-24 24-24s24 10.7 24 24v104c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V344c0-13.3 10.7-24 24-24s24 10.7 24 24"/></svg>
      </a>
    </div>

    
    <form class="md-header__option" data-md-component="palette">
      
      
      
      <input class="md-option" data-md-color-media="" data-md-color-scheme="slate"
        data-md-color-primary="teal" data-md-color-accent="cyan" 
        aria-label="Switch to light mode"  type="radio" name="__palette"
        id="__palette_1">
      
      <label class="md-header__button md-icon" title="Switch to light mode"
        for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
      
      
      
      
      <input class="md-option" data-md-color-media="" data-md-color-scheme="default"
        data-md-color-primary="indigo" data-md-color-accent="indigo" 
        aria-label="Switch to dark mode"  type="radio" name="__palette"
        id="__palette_2">
      
      <label class="md-header__button md-icon" title="Switch to dark mode"
        for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
      
      
    </form>
    

    
    <div class="md-header__source">
      <a href="https://github.com/deanqkhanhcoder/cp-algorithms-vi" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    deanqkhanhcoder/cp-algorithms-vi
  </div>
</a>
    </div>
    

  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Algorithms for Competitive Programming" class="md-nav__button md-logo" aria-label="Algorithms for Competitive Programming" data-md-component="logo">
      
  <img src="../favicon.ico" alt="logo">

    </a>
    Algorithms for Competitive Programming
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/deanqkhanhcoder/cp-algorithms-vi" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    deanqkhanhcoder/cp-algorithms-vi
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Trang chủ
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Trang chủ
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Trang chủ
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../navigation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Điều hướng
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tags.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Danh mục thẻ
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../contrib.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cách đóng góp
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../code_of_conduct.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quy tắc ứng xử
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../preview.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Xem trước
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Đại số
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Đại số
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Cơ bản
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Cơ bản
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="binary-exp.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lũy thừa nhị phân
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="euclid-algorithm.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Thuật toán Euclid tìm ước chung lớn nhất
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="extended-euclid-algorithm.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Thuật toán Euclid mở rộng
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="linear-diophantine-equation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Phương trình Diophantine tuyến tính
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="fibonacci-numbers.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Số Fibonacci
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Số nguyên tố
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Số nguyên tố
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="sieve-of-eratosthenes.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sàng Eratosthenes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="prime-sieve-linear.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sàng tuyến tính
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="primality_tests.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kiểm tra số nguyên tố
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="factorization.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Phân tích thừa số nguyên tố
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Hàm lý thuyết số
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Hàm lý thuyết số
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="phi-function.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hàm phi Euler
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="divisors.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Số lượng ước / Tổng các ước
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Số học module
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Số học module
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="module-inverse.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Nghịch đảo module
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="linear_congruence_equation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Phương trình đồng dư tuyến tính
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="chinese-remainder-theorem.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Định lý thặng dư Trung Hoa
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="garners-algorithm.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Thuật toán Garner
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="factorial-modulo.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Giai thừa modulo p
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="discrete-log.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Logarit rời rạc
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="primitive-root.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Căn nguyên thủy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="discrete-root.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Căn rời rạc
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="montgomery_multiplication.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Nhân Montgomery
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Hệ đếm
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Hệ đếm
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="balanced-ternary.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hệ tam phân cân bằng
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="gray-code.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Mã Gray
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" checked>
        
          
          <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Khác
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Khác
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="bit-manipulation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Thao tác bit
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="all-submasks.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Liệt kê submask của một bitmask
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="big-integer.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Số học độ chính xác tùy ý
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="fft.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Biến đổi Fourier nhanh (FFT)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="polynomial.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Các phép toán trên đa thức và chuỗi
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Liên phân số
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="continued-fractions.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Liên phân số
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#continued-fraction-representation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Biểu diễn liên phân số (Continued fraction representation)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Biểu diễn liên phân số (Continued fraction representation)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#implementation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Cài đặt
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-results" class="md-nav__link">
    <span class="md-ellipsis">
      
        Các kết quả chính
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#convergents" class="md-nav__link">
    <span class="md-ellipsis">
      
        Giản phân (Convergents)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Giản phân (Convergents)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#implementation-1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Cài đặt
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trees-of-continued-fractions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Cây liên phân số (Trees of continued fractions)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cây liên phân số (Trees of continued fractions)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stern-brocot-tree" class="md-nav__link">
    <span class="md-ellipsis">
      
        Cây Stern-Brocot (Stern-Brocot tree)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calkin-wilf-tree" class="md-nav__link">
    <span class="md-ellipsis">
      
        Cây Calkin-Wilf (Calkin-Wilf tree)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#convergence" class="md-nav__link">
    <span class="md-ellipsis">
      
        Sự hội tụ (Convergence)
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#linear-fractional-transformations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Biến đổi phân tuyến tính (Linear fractional transformations)
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geometric-interpretation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Ý nghĩa hình học (Geometric interpretation)
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="factoring-exp.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Phân tích lũy thừa (Factoring Exponentiation)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Cấu trúc dữ liệu
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Cấu trúc dữ liệu
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Cơ bản
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Cơ bản
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/stack_queue_modification.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Minimum Stack / Minimum Queue
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/sparse-table.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sparse Table
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Cây
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Cây
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/disjoint_set_union.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Disjoint Set Union (DSU)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/fenwick.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Fenwick Tree
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/sqrt_decomposition.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sqrt Decomposition
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/segment_tree.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Segment Tree
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/treap.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Treap
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/sqrt-tree.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sqrt Tree
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/randomized_heap.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Randomized Heap
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Nâng cao
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Nâng cao
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/deleting_in_log_n.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Xóa khỏi cấu trúc dữ liệu trong O(T(n) log n)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Quy hoạch động
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Quy hoạch động
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dynamic_programming/intro-to-dp.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Giới thiệu về Quy hoạch động
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dynamic_programming/knapsack.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Bài toán cái túi
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dynamic_programming/longest_increasing_subsequence.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Dãy con tăng dài nhất
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Tối ưu hóa DP
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Tối ưu hóa DP
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dynamic_programming/divide-and-conquer-dp.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quy hoạch động chia để trị
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dynamic_programming/knuth-optimization.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tối ưu hóa Knuth
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Bài tập
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Bài tập
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dynamic_programming/profile-dynamics.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quy hoạch động trên profile gãy. Bài toán "Parquet"
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dynamic_programming/zero_matrix.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tìm ma trận con toàn số 0 lớn nhất
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Xử lý chuỗi
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Xử lý chuỗi
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Cơ bản
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Cơ bản
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../string/string-hashing.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Băm chuỗi (String Hashing)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../string/rabin-karp.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Thuật toán Rabin-Karp cho so khớp chuỗi
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../string/prefix-function.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hàm tiền tố - Knuth-Morris-Pratt
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../string/z-function.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hàm Z (Z-function)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../string/suffix-array.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Suffix Array
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../string/aho_corasick.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Thuật toán Aho-Corasick
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Nâng cao
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Nâng cao
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../string/suffix-tree-ukkonen.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Suffix Tree
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../string/suffix-automaton.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Suffix Automaton
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../string/lyndon_factorization.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Phân rã Lyndon
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Bài tập
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Bài tập
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../string/expression_parsing.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Phân tích biểu thức
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../string/manacher.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Thuật toán Manacher - Tìm tất cả các palindrome con trong O(N)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../string/main_lorentz.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tìm lặp lại
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Đại số tuyến tính
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Đại số tuyến tính
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1" >
        
          
          <label class="md-nav__link" for="__nav_6_1" id="__nav_6_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Ma trận
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Ma trận
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../linear_algebra/linear-system-gauss.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Gauss & Hệ phương trình tuyến tính
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../linear_algebra/determinant-gauss.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Gauss & Định thức
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../linear_algebra/determinant-kraut.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kraut & Định thức
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../linear_algebra/rank-matrix.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hạng của ma trận
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Tổ hợp
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Tổ hợp
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_1" >
        
          
          <label class="md-nav__link" for="__nav_7_1" id="__nav_7_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Cơ bản
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Cơ bản
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="factorial-divisors.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tìm số mũ của ước giai thừa
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combinatorics/binomial-coefficients.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hệ số nhị thức
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combinatorics/catalan-numbers.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Số Catalan
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2" >
        
          
          <label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Kỹ thuật
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Kỹ thuật
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combinatorics/inclusion-exclusion.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Nguyên lý bao hàm - loại trừ
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combinatorics/burnside.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Bổ đề Burnside / Định lý liệt kê Pólya
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combinatorics/stars_and_bars.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Bài toán chia kẹo (Stars and bars)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combinatorics/generating_combinations.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sinh tất cả tổ hợp chập K
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_3" >
        
          
          <label class="md-nav__link" for="__nav_7_3" id="__nav_7_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Bài tập
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Bài tập
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combinatorics/bishops-on-chessboard.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Xếp quân Tượng trên bàn cờ
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combinatorics/bracket_sequences.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Dãy ngoặc đúng
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combinatorics/counting_labeled_graphs.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Đếm đồ thị có nhãn
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Phương pháp số
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Phương pháp số
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_1" >
        
          
          <label class="md-nav__link" for="__nav_8_1" id="__nav_8_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Tìm kiếm
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Tìm kiếm
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../num_methods/binary_search.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tìm kiếm nhị phân
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../num_methods/ternary_search.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tìm kiếm tam phân
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../num_methods/roots_newton.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Phương pháp Newton tìm nghiệm
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../num_methods/simulated_annealing.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Mô phỏng luyện kim (Simulated Annealing)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2" >
        
          
          <label class="md-nav__link" for="__nav_8_2" id="__nav_8_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Tích phân
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Tích phân
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../num_methods/simpson-integration.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tích phân theo công thức Simpson
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Hình học
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    Hình học
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_1" >
        
          
          <label class="md-nav__link" for="__nav_9_1" id="__nav_9_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Phép toán cơ bản
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Phép toán cơ bản
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/basic-geometry.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hình học cơ bản
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/segment-to-line.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tìm phương trình đường thẳng đi qua đoạn thẳng
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/lines-intersection.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Giao điểm của đường thẳng
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/check-segments-intersection.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kiểm tra hai đoạn thẳng cắt nhau
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/segments-intersection.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Giao của các đoạn thẳng
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/circle-line-intersection.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Giao của đường tròn và đường thẳng
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/circle-circle-intersection.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Giao của hai đường tròn
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/tangents-to-two-circles.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tiếp tuyến chung của hai đường tròn
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/length-of-segments-union.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Độ dài hợp của các đoạn thẳng
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_2" >
        
          
          <label class="md-nav__link" for="__nav_9_2" id="__nav_9_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Đa giác
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Đa giác
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/oriented-triangle-area.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Diện tích có hướng của tam giác
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/area-of-simple-polygon.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Diện tích đa giác đơn
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/point-in-convex-polygon.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kiểm tra điểm thuộc đa giác lồi trong O(log N)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/minkowski.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tổng Minkowski của các đa giác lồi
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/picks-theorem.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Định lý Pick - diện tích đa giác nguyên
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/lattice-points.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Điểm nguyên của đa giác không nguyên
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_3" >
        
          
          <label class="md-nav__link" for="__nav_9_3" id="__nav_9_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Bao lồi
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Bao lồi
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/convex-hull.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Xây dựng bao lồi
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/convex_hull_trick.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Convex hull trick và Li Chao tree
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_4" >
        
          
          <label class="md-nav__link" for="__nav_9_4" id="__nav_9_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Sweep-line
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Sweep-line
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/intersecting_segments.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tìm cặp đoạn thẳng cắt nhau
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_5" >
        
          
          <label class="md-nav__link" for="__nav_9_5" id="__nav_9_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Đồ thị phẳng
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Đồ thị phẳng
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/planar.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tìm các mặt của đồ thị phẳng
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/point-location.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Xác định vị trí điểm trong O(log N)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_6" >
        
          
          <label class="md-nav__link" for="__nav_9_6" id="__nav_9_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Khác
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Khác
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/nearest_points.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tìm cặp điểm gần nhất
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/delaunay.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tam giác hóa Delaunay và biểu đồ Voronoi
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/vertical_decomposition.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Phân rã dọc (Vertical decomposition)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/halfplane-intersection.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Giao nửa mặt phẳng - Thuật toán S&I trong O(N log N)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/manhattan-distance.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Khoảng cách Manhattan
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/enclosing-circle.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Đường tròn bao nhỏ nhất
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Đồ thị
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    Đồ thị
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_1" >
        
          
          <label class="md-nav__link" for="__nav_10_1" id="__nav_10_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Duyệt đồ thị
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Duyệt đồ thị
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/breadth-first-search.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Breadth First Search (BFS)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/depth-first-search.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Depth First Search (DFS)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_2" >
        
          
          <label class="md-nav__link" for="__nav_10_2" id="__nav_10_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Thành phần liên thông, cầu, khớp
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Thành phần liên thông, cầu, khớp
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/search-for-connected-components.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tìm thành phần liên thông
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/bridge-searching.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tìm cầu trong O(N+M)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/bridge-searching-online.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tìm cầu Online
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/cutpoints.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tìm khớp trong O(N+M)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/strongly-connected-components.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Thành phần liên thông mạnh và đồ thị nén
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/strong-orientation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Định hướng mạnh
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_3" >
        
          
          <label class="md-nav__link" for="__nav_10_3" id="__nav_10_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Đường đi ngắn nhất từ một nguồn
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Đường đi ngắn nhất từ một nguồn
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/dijkstra.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Dijkstra - tìm đường đi ngắn nhất từ một đỉnh
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/dijkstra_sparse.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Dijkstra trên đồ thị thưa
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/bellman_ford.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Bellman-Ford - tìm đường đi ngắn nhất với trọng số âm
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/01_bfs.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    0-1 BFS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/desopo_pape.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Thuật toán D´Esopo-Pape
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_4" >
        
          
          <label class="md-nav__link" for="__nav_10_4" id="__nav_10_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Đường đi ngắn nhất giữa mọi cặp đỉnh
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Đường đi ngắn nhất giữa mọi cặp đỉnh
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/all-pair-shortest-path-floyd-warshall.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Floyd-Warshall - tìm mọi đường đi ngắn nhất
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/fixed_length_paths.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Số đường đi độ dài cố định / Đường đi ngắn nhất độ dài cố định
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_5" >
        
          
          <label class="md-nav__link" for="__nav_10_5" id="__nav_10_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Cây khung
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Cây khung
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/mst_prim.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cây khung nhỏ nhất - Thuật toán Prim
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/mst_kruskal.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cây khung nhỏ nhất - Thuật toán Kruskal
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/mst_kruskal_with_dsu.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cây khung nhỏ nhất - Kruskal và DSU
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/second_best_mst.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cây khung nhỏ nhất thứ hai - Dùng Kruskal và LCA
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/kirchhoff-theorem.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Định lý Kirchhoff
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/pruefer_code.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Mã Prüfer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_6" >
        
          
          <label class="md-nav__link" for="__nav_10_6" id="__nav_10_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Chu trình
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Chu trình
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/finding-cycle.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kiểm tra tính không chu trình và tìm chu trình trong O(M)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/finding-negative-cycle-in-graph.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tìm chu trình âm trong đồ thị
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/euler_path.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Đường đi Euler
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_7" >
        
          
          <label class="md-nav__link" for="__nav_10_7" id="__nav_10_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Lowest Common Ancestor
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Lowest Common Ancestor
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/lca.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lowest Common Ancestor (LCA)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/lca_binary_lifting.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LCA - Binary Lifting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/lca_farachcoltonbender.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LCA - Thuật toán Farach-Colton và Bender
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/rmq_linear.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Giải RMQ bằng LCA
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/lca_tarjan.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LCA - Thuật toán Tarjan (Offline)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_8" >
        
          
          <label class="md-nav__link" for="__nav_10_8" id="__nav_10_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Luồng và các bài toán liên quan
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Luồng và các bài toán liên quan
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/edmonds_karp.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Luồng cực đại - Ford-Fulkerson và Edmonds-Karp
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/push-relabel.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Luồng cực đại - Thuật toán Push-relabel
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/push-relabel-faster.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Luồng cực đại - Thuật toán Push-relabel cải tiến
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/dinic.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Luồng cực đại - Thuật toán Dinic
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/mpm.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Luồng cực đại - Thuật toán MPM
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/flow_with_demands.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Luồng có yêu cầu (Flows with demands)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/min_cost_flow.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Luồng chi phí nhỏ nhất
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/Assignment-problem-min-flow.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Bài toán phân công
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_9" >
        
          
          <label class="md-nav__link" for="__nav_10_9" id="__nav_10_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Cặp ghép và các bài toán liên quan
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    Cặp ghép và các bài toán liên quan
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/bipartite-check.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kiểm tra đồ thị hai phía
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/kuhn_maximum_bipartite_matching.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Thuật toán Kuhn - Cặp ghép cực đại trên đồ thị hai phía
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/hungarian-algorithm.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Thuật toán Hungary
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_10" >
        
          
          <label class="md-nav__link" for="__nav_10_10" id="__nav_10_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Khác
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    Khác
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/topological-sort.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sắp xếp topo
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/edge_vertex_connectivity.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Độ liên thông cạnh / Độ liên thông đỉnh
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/tree_painting.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tô màu cây
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/2SAT.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2-SAT
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/hld.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Heavy-light decomposition (HLD)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Khác
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            
  
    Khác
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_1" >
        
          
          <label class="md-nav__link" for="__nav_11_1" id="__nav_11_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Dãy số
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Dãy số
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sequences/rmq.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Bài toán RMQ (Range Minimum Query - phần tử nhỏ nhất trong đoạn)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../others/maximum_average_segment.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tìm đoạn con có tổng lớn nhất/nhỏ nhất
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sequences/k-th.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tìm thống kê thứ K trong O(N)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sequences/mex.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Bài toán MEX (Phần tử nhỏ nhất không xuất hiện)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_2" >
        
          
          <label class="md-nav__link" for="__nav_11_2" id="__nav_11_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Lý thuyết trò chơi
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Lý thuyết trò chơi
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../game_theory/games_on_graphs.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Trò chơi trên đồ thị bất kỳ
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../game_theory/sprague-grundy-nim.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Định lý Sprague-Grundy. Trò chơi Nim
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_3" >
        
          
          <label class="md-nav__link" for="__nav_11_3" id="__nav_11_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Lập lịch
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Lập lịch
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../schedules/schedule_one_machine.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lập lịch trên một máy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../schedules/schedule_two_machines.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lập lịch trên hai máy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../schedules/schedule-with-completion-duration.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lịch tối ưu với deadline và thời lượng
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_4" >
        
          
          <label class="md-nav__link" for="__nav_11_4" id="__nav_11_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Khác
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Khác
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../others/tortoise_and_hare.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Thuật toán Rùa và Thỏ (Phát hiện chu trình trong danh sách liên kết)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../others/josephus_problem.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Bài toán Josephus
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../others/15-puzzle.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Trò chơi 15 Puzzle: Sự tồn tại của lời giải
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../others/stern_brocot_tree_farey_sequences.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cây Stern-Brocot và Dãy Farey
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  <script type="text/javascript">
  window.onload = function () {
    const newIssueURL = "https://github.com/cp-algorithms/cp-algorithms/issues/new";
    const issueTitle = "Problem on article " + "Li\u00ean ph\u00e2n s\u1ed1";
  const issueBody = `
**Article:** [`+ "Li\u00ean ph\u00e2n s\u1ed1" + `](${window.location.href})

**Problem:**
`;
  var issue_a = document.getElementById("report_issue_a");
  if (issue_a) {
    issue_a.href = `${newIssueURL}?` + `title=${encodeURIComponent(issueTitle)}&` + `body=${encodeURIComponent(issueBody)}`;
  }
}
</script>


<a href="https://github.com/deanqkhanhcoder/cp-algorithms-vi/edit/main/src/algebra/continued-fractions.md" title="Edit this page" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75z"/></svg>
</a>
<a id="report_issue_a" href="" title="Report a problem" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 14h-2V9h2m0 9h-2v-2h2M1 21h22L12 2z"/></svg>
</a>


<ul class="metadata page-metadata" data-bi-name="page info" lang="en-us" dir="ltr">
  
  
  <a href="../tags.html#tag:original" class="md-tag">
    Original
  </a>
  
  

  
</ul>


<!--?title Continued fractions -->
<h1 id="continued-fractions">Liên phân số (Continued fractions)<a class="headerlink" href="#continued-fractions" title="Permanent link">&para;</a></h1>
<p><strong>Liên phân số</strong> (continued fraction) là một biểu diễn của số thực dưới dạng một dãy số hữu tỷ hội tụ cụ thể. Chúng rất hữu ích trong lập trình thi đấu vì chúng dễ tính toán và có thể được sử dụng hiệu quả để tìm xấp xỉ hữu tỷ tốt nhất có thể của số thực cơ bản (trong số tất cả các số có mẫu số không vượt quá một giá trị nhất định).</p>
<p>Bên cạnh đó, liên phân số có liên quan chặt chẽ đến thuật toán Euclid, điều này làm cho chúng trở nên hữu ích trong một loạt các bài toán lý thuyết số.</p>
<h2 id="continued-fraction-representation">Biểu diễn liên phân số (Continued fraction representation)<a class="headerlink" href="#continued-fraction-representation" title="Permanent link">&para;</a></h2>
<div class="admonition info">
<p class="admonition-title">Định nghĩa</p>
<p>Cho <span class="arithmatex">$a_0, a_1, \dots, a_k \in \mathbb Z$</span> và <span class="arithmatex">$a_1, a_2, \dots, a_k \geq 1$</span>. Khi đó biểu thức</p>
<div class="arithmatex">$$r=a_0 + \frac{1}{a_1 + \frac{1}{\dots + \frac{1}{a_k}}},$$</div>
<p>được gọi là <strong>biểu diễn liên phân số</strong> của số hữu tỷ <span class="arithmatex">$r$</span> và được ký hiệu ngắn gọn là <span class="arithmatex">$r=[a_0;a_1,a_2,\dots,a_k]$</span>.</p>
</div>
<details class="example">
<summary>Example</summary>
<p>Cho <span class="arithmatex">$r = \frac{5}{3}$</span>. Có hai cách để biểu diễn nó dưới dạng liên phân số:</p>
<div class="arithmatex">$$
\begin{align}
r = [1;1,1,1] &amp;= 1+\frac{1}{1+\frac{1}{1+\frac{1}{1}}},\\
r = [1;1,2] &amp;= 1+\frac{1}{1+\frac{1}{2}}.
\end{align}
$$</div>
</details>
<p>Người ta chứng minh được rằng bất kỳ số hữu tỷ nào cũng có thể được biểu diễn dưới dạng liên phân số theo đúng <span class="arithmatex">$2$</span> cách:</p>
<div class="arithmatex">$$r = [a_0;a_1,\dots,a_k,1] = [a_0;a_1,\dots,a_k+1].$$</div>
<p>hơn nữa, độ dài <span class="arithmatex">$k$</span> của liên phân số như vậy được ước tính là <span class="arithmatex">$k = O(\log \min(p, q))$</span> đối với <span class="arithmatex">$r=\frac{p}{q}$</span>.</p>
<p>Lý do đằng sau điều này sẽ rõ ràng khi chúng ta đi sâu vào chi tiết của việc xây dựng liên phân số.</p>
<div class="admonition info">
<p class="admonition-title">Định nghĩa</p>
<p>Cho <span class="arithmatex">$a_0,a_1,a_2, \dots$</span> là một dãy số nguyên sao cho <span class="arithmatex">$a_1, a_2, \dots \geq 1$</span>. Gọi <span class="arithmatex">$r_k = [a_0; a_1, \dots, a_k]$</span>. Khi đó biểu thức</p>
<div class="arithmatex">$$r = a_0 + \frac{1}{a_1 + \frac{1}{a_2+\dots}} = \lim\limits_{k \to \infty} r_k.$$</div>
<p>được gọi là <strong>biểu diễn liên phân số</strong> của số vô tỷ <span class="arithmatex">$r$</span> và được ký hiệu ngắn gọn là <span class="arithmatex">$r = [a_0;a_1,a_2,\dots]$</span>.</p>
</div>
<p>Lưu ý rằng đối với <span class="arithmatex">$r=[a_0;a_1,\dots]$</span> và số nguyên <span class="arithmatex">$k$</span>, ta có <span class="arithmatex">$r+k = [a_0+k; a_1, \dots]$</span>.</p>
<p>Một quan sát quan trọng khác là <span class="arithmatex">$\frac{1}{r}=[0;a_0, a_1, \dots]$</span> khi <span class="arithmatex">$a_0 &gt; 0$</span> và <span class="arithmatex">$\frac{1}{r} = [a_1; a_2, \dots]$</span> khi <span class="arithmatex">$a_0 = 0$</span>.</p>
<div class="admonition info">
<p class="admonition-title">Định nghĩa</p>
<p>Trong định nghĩa trên, các số hữu tỷ <span class="arithmatex">$r_0, r_1, r_2, \dots$</span> được gọi là các <strong>giản phân</strong> (convergents) của <span class="arithmatex">$r$</span>.</p>
<p>Tương ứng, mỗi <span class="arithmatex">$r_k = [a_0; a_1, \dots, a_k] = \frac{p_k}{q_k}$</span> được gọi là <strong>giản phân</strong> thứ <span class="arithmatex">$k$</span> của <span class="arithmatex">$r$</span>.</p>
</div>
<details class="example">
<summary>Example</summary>
<p>Xét <span class="arithmatex">$r = [1; 1, 1, 1, \dots]$</span>. Người ta có thể chứng minh bằng quy nạp rằng <span class="arithmatex">$r_k = \frac{F_{k+2}}{F_{k+1}}$</span>, trong đó <span class="arithmatex">$F_k$</span> là dãy Fibonacci được định nghĩa là <span class="arithmatex">$F_0 = 0$</span>, <span class="arithmatex">$F_1 = 1$</span> và <span class="arithmatex">$F_{k} = F_{k-1} + F_{k-2}$</span>. Từ công thức Binet, người ta biết rằng</p>
<div class="arithmatex">$$r_k = \frac{\phi^{k+2} - \psi^{k+2}}{\phi^{k+1} - \psi^{k+1}},$$</div>
<p>trong đó <span class="arithmatex">$\phi = \frac{1+\sqrt{5}}{2} \approx 1.618$</span> là tỷ lệ vàng và <span class="arithmatex">$\psi = \frac{1-\sqrt{5}}{2} = -\frac{1}{\phi} \approx -0.618$</span>. Do đó,</p>
<div class="arithmatex">$$r = 1+\frac{1}{1+\frac{1}{1+\dots}}=\lim\limits_{k \to \infty} r_k = \phi = \frac{1+\sqrt{5}}{2}.$$</div>
<p>Lưu ý rằng trong trường hợp cụ thể này, một cách khác để tìm <span class="arithmatex">$r$</span> sẽ là giải phương trình</p>
<div class="arithmatex">$$r = 1+\frac{1}{r} \implies r^2 = r + 1. $$</div>
</details>
<div class="admonition info">
<p class="admonition-title">Định nghĩa</p>
<p>Cho <span class="arithmatex">$r_k = [a_0; a_1, \dots, a_{k-1}, a_k]$</span>. Các số <span class="arithmatex">$[a_0; a_1, \dots, a_{k-1}, t]$</span> với <span class="arithmatex">$1 \leq t \leq a_k$</span> được gọi là <strong>bán giản phân</strong> (semiconvergents).</p>
<p>Chúng ta thường sẽ gọi các (bán) giản phân lớn hơn <span class="arithmatex">$r$</span> là (bán) giản phân <strong>trên</strong> và những (bán) giản phân nhỏ hơn <span class="arithmatex">$r$</span> là (bán) giản phân <strong>dưới</strong>.</p>
</div>
<div class="admonition info">
<p class="admonition-title">Định nghĩa</p>
<p>Bổ sung cho các giản phân, chúng ta định nghĩa <strong><a href="https://en.wikipedia.org/wiki/Complete_quotient">thương đầy đủ</a></strong> (complete quotients) là <span class="arithmatex">$s_k = [a_k; a_{k+1}, a_{k+2}, \dots]$</span>.</p>
<p>Tương ứng, chúng ta sẽ gọi mỗi <span class="arithmatex">$s_k$</span> là thương đầy đủ thứ <span class="arithmatex">$k$</span> của <span class="arithmatex">$r$</span>.</p>
</div>
<p>Từ các định nghĩa trên, người ta có thể kết luận rằng <span class="arithmatex">$s_k \geq 1$</span> với <span class="arithmatex">$k \geq 1$</span>.</p>
<p>Xem <span class="arithmatex">$[a_0; a_1, \dots, a_k]$</span> như một biểu thức đại số hình thức và cho phép các số thực bất kỳ thay vì <span class="arithmatex">$a_i$</span>, chúng ta nhận được</p>
<div class="arithmatex">$$r = [a_0; a_1, \dots, a_{k-1}, s_k].$$</div>
<p>Cụ thể, <span class="arithmatex">$r = [s_0] = s_0$</span>. Mặt khác, chúng ta có thể biểu diễn <span class="arithmatex">$s_k$</span> dưới dạng</p>
<div class="arithmatex">$$s_k = [a_k; s_{k+1}] = a_k + \frac{1}{s_{k+1}},$$</div>
<p>có nghĩa là chúng ta có thể tính <span class="arithmatex">$a_k = \lfloor s_k \rfloor$</span> và <span class="arithmatex">$s_{k+1} = (s_k - a_k)^{-1}$</span> từ <span class="arithmatex">$s_k$</span>.</p>
<p>Dãy <span class="arithmatex">$a_0, a_1, \dots$</span> được xác định rõ trừ khi <span class="arithmatex">$s_k=a_k$</span>, điều này chỉ xảy ra khi <span class="arithmatex">$r$</span> là một số hữu tỷ.</p>
<p>Do đó, biểu diễn liên phân số được xác định duy nhất cho bất kỳ số vô tỷ <span class="arithmatex">$r$</span> nào.</p>
<h3 id="implementation">Cài đặt<a class="headerlink" href="#implementation" title="Permanent link">&para;</a></h3>
<p>Trong các đoạn mã, chúng ta hầu như sẽ giả sử các liên phân số hữu hạn.</p>
<p>Từ <span class="arithmatex">$s_k$</span>, chuyển đổi sang <span class="arithmatex">$s_{k+1}$</span> trông như sau</p>
<div class="arithmatex">$$s_k =\left\lfloor s_k \right\rfloor + \frac{1}{s_{k+1}}.$$</div>
<p>Từ biểu thức này, thương đầy đủ tiếp theo <span class="arithmatex">$s_{k+1}$</span> thu được là</p>
<div class="arithmatex">$$s_{k+1} = \left(s_k-\left\lfloor s_k\right\rfloor\right)^{-1}.$$</div>
<p>Đối với <span class="arithmatex">$s_k=\frac{p}{q}$</span> điều đó có nghĩa là</p>
<div class="arithmatex">$$
s_{k+1} = \left(\frac{p}{q}-\left\lfloor \frac{p}{q} \right\rfloor\right)^{-1} = \frac{q}{p-q\cdot \lfloor \frac{p}{q} \rfloor} = \frac{q}{p \bmod q}.
$$</div>
<p>Do đó, việc tính toán biểu diễn liên phân số cho <span class="arithmatex">$r=\frac{p}{q}$</span> tuân theo các bước của thuật toán Euclid cho <span class="arithmatex">$p$</span> và <span class="arithmatex">$q$</span>.</p>
<p>Từ điều này cũng suy ra rằng <span class="arithmatex">$\gcd(p_k, q_k) = 1$</span> đối với <span class="arithmatex">$\frac{p_k}{q_k} = [a_0; a_1, \dots, a_k]$</span>. Do đó, các giản phân luôn là tối giản.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">C++</label><label for="__tabbed_1_2">Python</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">auto</span><span class="w"> </span><span class="n">fraction</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">q</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">a</span><span class="p">;</span>
<span class="w">    </span><span class="k">while</span><span class="p">(</span><span class="n">q</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">a</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">q</span><span class="p">);</span>
<span class="w">        </span><span class="n">tie</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_pair</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">q</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">a</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">fraction</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">while</span> <span class="n">q</span><span class="p">:</span>
        <span class="n">a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span> <span class="o">//</span> <span class="n">q</span><span class="p">)</span>
        <span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">q</span><span class="p">,</span> <span class="n">p</span> <span class="o">%</span> <span class="n">q</span>
    <span class="k">return</span> <span class="n">a</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="key-results">Các kết quả chính<a class="headerlink" href="#key-results" title="Permanent link">&para;</a></h2>
<p>Để cung cấp một số động lực cho việc nghiên cứu sâu hơn về liên phân số, chúng tôi đưa ra một số sự thật chính ngay bây giờ.</p>
<details class="note">
<summary>Công thức truy hồi</summary>
<p>Đối với các giản phân <span class="arithmatex">$r_k = \frac{p_k}{q_k}$</span>, công thức truy hồi sau đây được áp dụng, cho phép tính toán nhanh chóng:</p>
<div class="arithmatex">$$\frac{p_k}{q_k}=\frac{a_k p_{k-1} + p_{k-2}}{a_k q_{k-1} + q_{k-2}},$$</div>
<p>trong đó <span class="arithmatex">$\frac{p_{-1}}{q_{-1}}=\frac{1}{0}$</span> và <span class="arithmatex">$\frac{p_{-2}}{q_{-2}}=\frac{0}{1}$</span>.</p>
</details>
<details class="note">
<summary>Độ lệch</summary>
<p>Độ lệch của <span class="arithmatex">$r_k = \frac{p_k}{q_k}$</span> so với <span class="arithmatex">$r$</span> có thể được ước tính chung là</p>
<div class="arithmatex">$$\left|\frac{p_k}{q_k}-r\right| \leq \frac{1}{q_k q_{k+1}} \leq \frac{1}{q_k^2}.$$</div>
<p>Nhân cả hai vế với <span class="arithmatex">$q_k$</span>, chúng ta nhận được ước tính thay thế:</p>
<div class="arithmatex">$$|p_k - q_k r| \leq \frac{1}{q_{k+1}}.$$</div>
<p>Từ công thức truy hồi ở trên suy ra rằng <span class="arithmatex">$q_k$</span> tăng nhanh ít nhất như số Fibonacci.</p>
<p>Trong hình dưới đây bạn có thể thấy trực quan hóa cách các giản phân <span class="arithmatex">$r_k$</span> tiến tới <span class="arithmatex">$r=\frac{1+\sqrt 5}{2}$</span>:</p>
<p><img alt="" src="https://upload.wikimedia.org/wikipedia/commons/b/b4/Golden_ration_convergents.svg" /></p>
<p><span class="arithmatex">$r=\frac{1+\sqrt 5}{2}$</span> được biểu thị bằng đường chấm xanh. Các giản phân lẻ tiến tới nó từ phía trên và các giản phân chẵn tiến tới nó từ phía dưới.</p>
</details>
<details class="note">
<summary>Bao lồi lưới</summary>
<p>Xem xét các bao lồi của các điểm nằm trên và dưới đường thẳng <span class="arithmatex">$y=rx$</span>.</p>
<p>Các giản phân lẻ <span class="arithmatex">$(q_k;p_k)$</span> là các đỉnh của bao lồi trên, trong khi các giản phân chẵn <span class="arithmatex">$(q_k;p_k)$</span> là các đỉnh của bao lồi dưới.</p>
<p>Tất cả các đỉnh nguyên trên các bao lồi thu được là <span class="arithmatex">$(q;p)$</span> sao cho</p>
<div class="arithmatex">$$\frac{p}{q} = \frac{tp_{k-1} + p_{k-2}}{tq_{k-1} + q_{k-2}}$$</div>
<p>đối với số nguyên <span class="arithmatex">$0 \leq t \leq a_k$</span>. Nói cách khác, tập hợp các điểm lưới trên các bao lồi tương ứng với tập hợp các bán giản phân.</p>
<p>Trong hình dưới đây, bạn có thể thấy các giản phân và bán giản phân (các điểm màu xám trung gian) của <span class="arithmatex">$r=\frac{9}{7}$</span>.</p>
<p><img alt="" src="https://upload.wikimedia.org/wikipedia/commons/9/92/Continued_convergents_geometry.svg" /></p>
</details>
<details class="note">
<summary>Xấp xỉ tốt nhất</summary>
<p>Cho <span class="arithmatex">$\frac{p}{q}$</span> là phân số để tối thiểu hóa <span class="arithmatex">$\left|r-\frac{p}{q}\right|$</span> với điều kiện <span class="arithmatex">$q \leq x$</span> cho một số <span class="arithmatex">$x$</span>.</p>
<p>Khi đó <span class="arithmatex">$\frac{p}{q}$</span> là một bán giản phân của <span class="arithmatex">$r$</span>.</p>
</details>
<p>Sự thật cuối cùng cho phép tìm các xấp xỉ hữu tỷ tốt nhất của <span class="arithmatex">$r$</span> bằng cách kiểm tra các bán giản phân của nó.</p>
<p>Dưới đây bạn sẽ tìm thấy giải thích thêm và một chút trực giác cũng như cách giải thích cho những sự thật này.</p>
<h2 id="convergents">Giản phân (Convergents)<a class="headerlink" href="#convergents" title="Permanent link">&para;</a></h2>
<p>Hãy xem xét kỹ hơn các giản phân đã được định nghĩa trước đó. Đối với <span class="arithmatex">$r=[a_0, a_1, a_2, \dots]$</span>, các giản phân của nó là</p>
<div class="arithmatex">$$\begin{gather}
r_0=[a_0],\\r_1=[a_0, a_1],\\ \dots,\\ r_k=[a_0, a_1, \dots, a_k].
\end{gather}$$</div>
<p>Giản phân là khái niệm cốt lõi của liên phân số, vì vậy việc nghiên cứu các tính chất của chúng là rất quan trọng.</p>
<p>Đối với số <span class="arithmatex">$r$</span>, giản phân thứ <span class="arithmatex">$k$</span> của nó <span class="arithmatex">$r_k = \frac{p_k}{q_k}$</span> có thể được tính như sau</p>
<div class="arithmatex">$$r_k = \frac{P_k(a_0,a_1,\dots,a_k)}{P_{k-1}(a_1,\dots,a_k)} = \frac{a_k p_{k-1} + p_{k-2}}{a_k q_{k-1} + q_{k-2}},$$</div>
<p>trong đó <span class="arithmatex">$P_k(a_0,\dots,a_k)$</span> là <a href="https://en.wikipedia.org/wiki/Continuant_(mathematics)">continuant</a>, một đa thức nhiều biến được định nghĩa là</p>
<div class="arithmatex">$$P_k(x_0,x_1,\dots,x_k) = \det \begin{bmatrix}
x_k &amp; 1 &amp; 0 &amp; \dots &amp; 0 \\
-1 &amp; x_{k-1} &amp; 1 &amp; \dots &amp; 0 \\
0 &amp; -1 &amp; x_2 &amp; . &amp; \vdots \\
\vdots &amp; \vdots &amp; . &amp; \ddots &amp; 1 \\
0 &amp; 0 &amp; \dots &amp; -1 &amp; x_0
\end{bmatrix}_{\textstyle .}$$</div>
<p>Do đó, <span class="arithmatex">$r_k$</span> là một <a href="https://en.wikipedia.org/wiki/Mediant_(mathematics)">mediant</a> có trọng số của <span class="arithmatex">$r_{k-1}$</span> và <span class="arithmatex">$r_{k-2}$</span>.</p>
<p>Để nhất quán, hai giản phân bổ sung <span class="arithmatex">$r_{-1} = \frac{1}{0}$</span> và <span class="arithmatex">$r_{-2} = \frac{0}{1}$</span> được định nghĩa.</p>
<details class="hint">
<summary>Giải thích chi tiết</summary>
<p>Tử số và mẫu số của <span class="arithmatex">$r_k$</span> có thể được xem như các đa thức nhiều biến của <span class="arithmatex">$a_0, a_1, \dots, a_k$</span>:</p>
<div class="arithmatex">$$r_k = \frac{P_k(a_0, a_1, \dots, a_k)}{Q_k(a_0,a_1, \dots, a_k)}.$$</div>
<p>Từ định nghĩa của các giản phân,</p>
<div class="arithmatex">$$r_k = a_0 + \frac{1}{[a_1;a_2,\dots, a_k]}= a_0 + \frac{Q_{k-1}(a_1, \dots, a_k)}{P_{k-1}(a_1, \dots, a_k)} = \frac{a_0 P_{k-1}(a_1, \dots, a_k) + Q_{k-1}(a_1, \dots, a_k)}{P_{k-1}(a_1, \dots, a_k)}.$$</div>
<p>Từ điều này suy ra <span class="arithmatex">$Q_k(a_0, \dots, a_k) = P_{k-1}(a_1, \dots, a_k)$</span>. Điều này mang lại mối quan hệ</p>
<div class="arithmatex">$$P_k(a_0, \dots, a_k) = a_0 P_{k-1}(a_1, \dots, a_k) + P_{k-2}(a_2, \dots, a_k).$$</div>
<p>Ban đầu, <span class="arithmatex">$r_0 = \frac{a_0}{1}$</span> và <span class="arithmatex">$r_1 = \frac{a_0 a_1 + 1}{a_1}$</span>, do đó</p>
<div class="arithmatex">$$\begin{align}P_0(a_0)&amp;=a_0,\\ P_1(a_0, a_1) &amp;= a_0 a_1 + 1.\end{align}$$</div>
<p>Để nhất quán, thuận tiện khi định nghĩa <span class="arithmatex">$P_{-1} = 1$</span> và <span class="arithmatex">$P_{-2}=0$</span> và nói một cách hình thức rằng <span class="arithmatex">$r_{-1} = \frac{1}{0}$</span> và <span class="arithmatex">$r_{-2}=\frac{0}{1}$</span>.</p>
<p>Từ giải tích số, người ta biết rằng định thức của một ma trận ba đường chéo tùy ý</p>
<div class="arithmatex">$$T_k = \det \begin{bmatrix}
a_0 &amp; b_0 &amp; 0 &amp; \dots &amp; 0 \\
c_0 &amp; a_1 &amp; b_1 &amp; \dots &amp; 0 \\
0 &amp; c_1 &amp; a_2 &amp; . &amp; \vdots \\
\vdots &amp; \vdots &amp; . &amp; \ddots &amp; c_{k-1} \\
0 &amp; 0 &amp; \dots &amp; b_{k-1} &amp; a_k
\end{bmatrix}$$</div>
<p>có thể được tính toán đệ quy là <span class="arithmatex">$T_k = a_k T_{k-1} - b_{k-1} c_{k-1} T_{k-2}$</span>. So sánh nó với <span class="arithmatex">$P_k$</span>, chúng ta có một biểu thức trực tiếp</p>
<div class="arithmatex">$$P_k = \det \begin{bmatrix}
x_k &amp; 1 &amp; 0 &amp; \dots &amp; 0 \\
-1 &amp; x_{k-1} &amp; 1 &amp; \dots &amp; 0 \\
0 &amp; -1 &amp; x_2 &amp; . &amp; \vdots \\
\vdots &amp; \vdots &amp; . &amp; \ddots &amp; 1 \\
0 &amp; 0 &amp; \dots &amp; -1 &amp; x_0
\end{bmatrix}_{\textstyle .}$$</div>
<p>Đa thức này còn được gọi là <a href="https://en.wikipedia.org/wiki/Continuant_(mathematics)">continuant</a> do mối quan hệ chặt chẽ của nó với liên phân số. Continuant sẽ không thay đổi nếu trình tự trên đường chéo chính bị đảo ngược. Điều này mang lại một công thức thay thế để tính toán nó:</p>
<div class="arithmatex">$$P_k(a_0, \dots, a_k) = a_k P_{k-1}(a_0, \dots, a_{k-1}) + P_{k-2}(a_0, \dots, a_{k-2}).$$</div>
</details>
<h3 id="implementation-1">Cài đặt<a class="headerlink" href="#implementation-1" title="Permanent link">&para;</a></h3>
<p>Chúng ta sẽ tính toán các giản phân dưới dạng một cặp các dãy <span class="arithmatex">$p_{-2}, p_{-1}, p_0, p_1, \dots, p_k$</span> và <span class="arithmatex">$q_{-2}, q_{-1}, q_0, q_1, \dots, q_k$</span>:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">C++</label><label for="__tabbed_2_2">Python</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">auto</span><span class="w"> </span><span class="n">convergents</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">};</span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">};</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="n">it</span><span class="o">:</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">p</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">p</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">p</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="p">]);</span>
<span class="w">        </span><span class="n">q</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="n">q</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">q</span><span class="p">[</span><span class="n">q</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="p">]);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">make_pair</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convergents</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">q</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="n">a</span><span class="p">:</span>
        <span class="n">p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">it</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">it</span> <span class="o">+</span> <span class="n">q</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">,</span> <span class="n">q</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="trees-of-continued-fractions">Cây liên phân số (Trees of continued fractions)<a class="headerlink" href="#trees-of-continued-fractions" title="Permanent link">&para;</a></h2>
<p>Có hai cách chính để hợp nhất tất cả các liên phân số có thể thành các cấu trúc cây hữu ích.</p>
<h3 id="stern-brocot-tree">Cây Stern-Brocot (Stern-Brocot tree)<a class="headerlink" href="#stern-brocot-tree" title="Permanent link">&para;</a></h3>
<p><a href="../others/stern_brocot_tree_farey_sequences.html">Cây Stern-Brocot</a> là một cây tìm kiếm nhị phân chứa tất cả các số hữu tỷ dương phân biệt.</p>
<p>Cây thường trông như sau:</p>
<figure>
<img src="https://upload.wikimedia.org/wikipedia/commons/3/37/SternBrocotTree.svg">
<figcaption>
<a href="https://commons.wikimedia.org/wiki/File:SternBrocotTree.svg">Hình ảnh</a> bởi <a href="https://commons.wikimedia.org/wiki/User:Aaron_Rotenberg">Aaron Rotenberg</a> được cấp phép theo <a href="https://creativecommons.org/licenses/by-sa/3.0/deed.en">CC BY-SA 3.0</a>
</figcaption>
</figure>

<p>Các phân số <span class="arithmatex">$\frac{0}{1}$</span> và <span class="arithmatex">$\frac{1}{0}$</span> được giữ "ảo" ở phía bên trái và bên phải của cây tương ứng.</p>
<p>Khi đó phân số trong một nút là mediant <span class="arithmatex">$\frac{a+c}{b+d}$</span> của hai phân số <span class="arithmatex">$\frac{a}{b}$</span> và <span class="arithmatex">$\frac{c}{d}$</span> phía trên nó.</p>
<p>Công thức truy hồi <span class="arithmatex">$\frac{p_k}{q_k}=\frac{a_k p_{k-1} + p_{k-2}}{a_k q_{k-1} + q_{k-2}}$</span> có nghĩa là biểu diễn liên phân số mã hóa đường dẫn đi đến <span class="arithmatex">$\frac{p_k}{q_k}$</span> trong cây. Để tìm <span class="arithmatex">$[a_0; a_1, \dots, a_{k}, 1]$</span>, người ta phải thực hiện <span class="arithmatex">$a_0$</span> bước sang phải, <span class="arithmatex">$a_1$</span> bước sang trái, <span class="arithmatex">$a_2$</span> bước sang phải vân vân cho đến <span class="arithmatex">$a_k$</span>.</p>
<p>Cha của <span class="arithmatex">$[a_0; a_1, \dots, a_k,1]$</span> khi đó là phân số thu được bằng cách lùi lại một bước theo hướng cuối cùng đã sử dụng.</p>
<p>Nói cách khác, đó là <span class="arithmatex">$[a_0; a_1, \dots, a_k-1,1]$</span> khi <span class="arithmatex">$a_k &gt; 1$</span> và <span class="arithmatex">$[a_0; a_1, \dots, a_{k-1}, 1]$</span> khi <span class="arithmatex">$a_k = 1$</span>.</p>
<p>Do đó, các con của <span class="arithmatex">$[a_0; a_1, \dots, a_k, 1]$</span> là <span class="arithmatex">$[a_0; a_1, \dots, a_k+1, 1]$</span> và <span class="arithmatex">$[a_0; a_1, \dots, a_k, 1, 1]$</span>.</p>
<p>Hãy đánh chỉ số cây Stern-Brocot. Đỉnh gốc được gán chỉ số <span class="arithmatex">$1$</span>. Sau đó đối với một đỉnh <span class="arithmatex">$v$</span>, chỉ số của con bên trái được gán bằng cách thay đổi bit dẫn đầu của <span class="arithmatex">$v$</span> từ <span class="arithmatex">$1$</span> thành <span class="arithmatex">$10$</span> và đối với con bên phải, nó được gán bằng cách thay đổi bit dẫn đầu từ <span class="arithmatex">$1$</span> thành <span class="arithmatex">$11$</span>:</p>
<figure><img src="https://upload.wikimedia.org/wikipedia/commons/1/18/Stern-brocot-index.svg" width="500px"/></figure>

<p>Trong cách đánh chỉ số này, biểu diễn liên phân số của một số hữu tỷ chỉ định <a href="https://en.wikipedia.org/wiki/Run-length_encoding">mã hóa độ dài chạy</a> (run-length encoding) của chỉ số nhị phân của nó.</p>
<p>Đối với <span class="arithmatex">$\frac{5}{2} = [2;2] = [2;1,1]$</span>, chỉ số của nó là <span class="arithmatex">$1011_2$</span> và mã hóa độ dài chạy của nó, xét các bit theo thứ tự tăng dần, là <span class="arithmatex">$[2;1,1]$</span>.</p>
<p>Một ví dụ khác là <span class="arithmatex">$\frac{2}{5} = [0;2,2]=[0;2,1,1]$</span>, có chỉ số <span class="arithmatex">$1100_2$</span> và mã hóa độ dài chạy của nó, quả thực, là <span class="arithmatex">$[0;2,2]$</span>.</p>
<p>Đáng chú ý là cây Stern-Brocot, trên thực tế, là một <a href="../data_structures/treap.html">treap</a>. Nghĩa là, nó là một cây tìm kiếm nhị phân theo <span class="arithmatex">$\frac{p}{q}$</span>, nhưng nó là một heap theo cả <span class="arithmatex">$p$</span> và <span class="arithmatex">$q$</span>.</p>
<div class="admonition example">
<p class="admonition-title">So sánh các liên phân số</p>
<p>Bạn được cho <span class="arithmatex">$A=[a_0; a_1, \dots, a_n]$</span> và <span class="arithmatex">$B=[b_0; b_1, \dots, b_m]$</span>. Phân số nào nhỏ hơn?</p>
</div>
<details class="hint">
<summary>Lời giải</summary>
<p>Giả sử rằng <span class="arithmatex">$A$</span> và <span class="arithmatex">$B$</span> là số vô tỷ và biểu diễn liên phân số của chúng biểu thị một sự đi xuống vô tận trong cây Stern-Brocot.</p>
<p>Như chúng ta đã đề cập, trong biểu diễn này <span class="arithmatex">$a_0$</span> biểu thị số lần rẽ phải trong quá trình đi xuống, <span class="arithmatex">$a_1$</span> biểu thị số lần rẽ trái tiếp theo, v.v. Do đó, khi chúng ta so sánh <span class="arithmatex">$a_k$</span> và <span class="arithmatex">$b_k$</span>, nếu <span class="arithmatex">$a_k = b_k$</span> chúng ta chỉ nên chuyển sang so sánh <span class="arithmatex">$a_{k+1}$</span> và <span class="arithmatex">$b_{k+1}$</span>. Ngược lại, nếu chúng ta đang ở các lần rẽ phải, chúng ta nên kiểm tra xem <span class="arithmatex">$a_k &lt; b_k$</span> và nếu chúng ta đang ở các lần rẽ trái, chúng ta nên kiểm tra xem <span class="arithmatex">$a_k &gt; b_k$</span> để biết liệu <span class="arithmatex">$A &lt; B$</span>.</p>
<p>Nói cách khác, đối với <span class="arithmatex">$A$</span> và <span class="arithmatex">$B$</span> vô tỷ, <span class="arithmatex">$A &lt; B$</span> khi và chỉ khi <span class="arithmatex">$(a_0, -a_1, a_2, -a_3, \dots) &lt; (b_0, -b_1, b_2, -b_3, \dots)$</span> với so sánh từ điển.</p>
<p>Bây giờ, sử dụng <span class="arithmatex">$\infty$</span> một cách hình thức như một phần tử của biểu diễn liên phân số, có thể mô phỏng các số vô tỷ <span class="arithmatex">$A-\varepsilon$</span> và <span class="arithmatex">$A+\varepsilon$</span>, nghĩa là, các phần tử nhỏ hơn (lớn hơn) <span class="arithmatex">$A$</span>, nhưng lớn hơn (nhỏ hơn) bất kỳ số thực nào khác. Cụ thể, đối với <span class="arithmatex">$A=[a_0; a_1, \dots, a_n]$</span>, một trong hai phần tử này có thể được mô phỏng là <span class="arithmatex">$[a_0; a_1, \dots, a_n, \infty]$</span> và phần tử kia có thể được mô phỏng là <span class="arithmatex">$[a_0; a_1, \dots, a_n - 1, 1, \infty]$</span>.</p>
<p>Cái nào tương ứng với <span class="arithmatex">$A-\varepsilon$</span> và cái nào với <span class="arithmatex">$A+\varepsilon$</span> có thể được xác định bởi tính chẵn lẻ của <span class="arithmatex">$n$</span> hoặc bằng cách so sánh chúng như các số vô tỷ.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:1"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">Python</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># check if a &lt; b assuming that a[-1] = b[-1] = infty and a != b</span>
<span class="k">def</span><span class="w"> </span><span class="nf">less</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="p">[(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">i</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">))]</span>
    <span class="n">b</span> <span class="o">=</span> <span class="p">[(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">i</span><span class="o">*</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">))]</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="n">b</span>

<span class="c1"># [a0; a1, ..., ak] -&gt; [a0, a1, ..., ak-1, 1]</span>
<span class="k">def</span><span class="w"> </span><span class="nf">expand</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">a</span><span class="p">:</span> <span class="c1"># empty a = inf</span>
        <span class="n">a</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="n">a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">a</span>

<span class="c1"># return a-eps, a+eps</span>
<span class="k">def</span><span class="w"> </span><span class="nf">pm_eps</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
    <span class="n">a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">))</span>
    <span class="n">b</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">))</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="k">if</span> <span class="n">less</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
</details>
<div class="admonition example">
<p class="admonition-title">Điểm trong tốt nhất</p>
<p>Bạn được cho <span class="arithmatex">$\frac{0}{1} \leq \frac{p_0}{q_0} &lt; \frac{p_1}{q_1} \leq \frac{1}{0}$</span>. Tìm số hữu tỷ <span class="arithmatex">$\frac{p}{q}$</span> sao cho <span class="arithmatex">$(q; p)$</span> nhỏ nhất theo thứ tự từ điển và <span class="arithmatex">$\frac{p_0}{q_0} &lt; \frac{p}{q} &lt; \frac{p_1}{q_1}$</span>.</p>
</div>
<details class="hint">
<summary>Lời giải</summary>
<p>Về mặt cây Stern-Brocot, điều đó có nghĩa là chúng ta cần tìm LCA của <span class="arithmatex">$\frac{p_0}{q_0}$</span> và <span class="arithmatex">$\frac{p_1}{q_1}$</span>. Do mối liên hệ giữa cây Stern-Brocot và liên phân số, LCA này sẽ tương ứng đại khái với tiền tố chung lớn nhất của các biểu diễn liên phân số cho <span class="arithmatex">$\frac{p_0}{q_0}$</span> và <span class="arithmatex">$\frac{p_1}{q_1}$</span>.</p>
<p>Vì vậy, nếu <span class="arithmatex">$\frac{p_0}{q_0} = [a_0; a_1, \dots, a_{k-1}, a_k, \dots]$</span> và <span class="arithmatex">$\frac{p_1}{q_1} = [a_0; a_1, \dots, a_{k-1}, b_k, \dots]$</span> là các số vô tỷ, LCA là <span class="arithmatex">$[a_0; a_1, \dots, \min(a_k, b_k)+1]$</span>.</p>
<p>Đối với <span class="arithmatex">$r_0$</span> và <span class="arithmatex">$r_1$</span> hữu tỷ, một trong số chúng có thể chính là LCA, điều này đòi hỏi chúng ta phải xét trường hợp. Để đơn giản hóa lời giải cho <span class="arithmatex">$r_0$</span> và <span class="arithmatex">$r_1$</span> hữu tỷ, có thể sử dụng biểu diễn liên phân số của <span class="arithmatex">$r_0 + \varepsilon$</span> và <span class="arithmatex">$r_1 - \varepsilon$</span> đã được rút ra trong bài toán trước.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:1"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">Python</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># finds lexicographically smallest (q, p)</span>
<span class="c1"># such that p0/q0 &lt; p/q &lt; p1/q1</span>
<span class="k">def</span><span class="w"> </span><span class="nf">middle</span><span class="p">(</span><span class="n">p0</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">q1</span><span class="p">):</span>
    <span class="n">a0</span> <span class="o">=</span> <span class="n">pm_eps</span><span class="p">(</span><span class="n">fraction</span><span class="p">(</span><span class="n">p0</span><span class="p">,</span> <span class="n">q0</span><span class="p">))[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">a1</span> <span class="o">=</span> <span class="n">pm_eps</span><span class="p">(</span><span class="n">fraction</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">q1</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">a</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a0</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">a1</span><span class="p">))):</span>
        <span class="n">a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">a0</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">a1</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">a0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">a1</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="k">break</span>
    <span class="n">a</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">convergents</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">q</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div>
</div>
</div>
</div>
</details>
<div class="admonition example">
<p class="admonition-title"><a href="https://codingcompetitions.withgoogle.com/codejam/round/0000000000051679/0000000000146184">GCJ 2019, Round 2 - New Elements: Part 2</a></p>
<p>Bạn được cho <span class="arithmatex">$N$</span> cặp số nguyên dương <span class="arithmatex">$(C_i, J_i)$</span>. Bạn cần tìm một cặp số nguyên dương <span class="arithmatex">$(x, y)$</span> sao cho <span class="arithmatex">$C_i x + J_i y$</span> là một dãy tăng nghiêm ngặt.</p>
<p>Trong số các cặp như vậy, hãy tìm cặp nhỏ nhất theo thứ tự từ điển.</p>
</div>
<details class="hint">
<summary>Lời giải</summary>
<p>Diễn giải lại đề bài, <span class="arithmatex">$A_i x + B_i y$</span> phải dương với mọi <span class="arithmatex">$i$</span>, trong đó <span class="arithmatex">$A_i = C_i - C_{i-1}$</span> và <span class="arithmatex">$B_i = J_i - J_{i-1}$</span>.</p>
<p>Trong số các phương trình như vậy, chúng ta có bốn nhóm quan trọng cho <span class="arithmatex">$A_i x + B_i y &gt; 0$</span>:</p>
<ol>
<li><span class="arithmatex">$A_i, B_i &gt; 0$</span> có thể bị bỏ qua vì chúng ta đang tìm kiếm <span class="arithmatex">$x, y &gt; 0$</span>.</li>
<li><span class="arithmatex">$A_i, B_i \leq 0$</span> sẽ cung cấp "IMPOSSIBLE" như một câu trả lời.</li>
<li><span class="arithmatex">$A_i &gt; 0$</span>, <span class="arithmatex">$B_i \leq 0$</span>. Các ràng buộc như vậy tương đương với <span class="arithmatex">$\frac{y}{x} &lt; \frac{A_i}{-B_i}$</span>.</li>
<li><span class="arithmatex">$A_i \leq 0$</span>, <span class="arithmatex">$B_i &gt; 0$</span>. Các ràng buộc như vậy tương đương với <span class="arithmatex">$\frac{y}{x} &gt; \frac{-A_i}{B_i}$</span>.</li>
</ol>
<p>Gọi <span class="arithmatex">$\frac{p_0}{q_0}$</span> là <span class="arithmatex">$\frac{-A_i}{B_i}$</span> lớn nhất từ nhóm thứ tư và <span class="arithmatex">$\frac{p_1}{q_1}$</span> là <span class="arithmatex">$\frac{A_i}{-B_i}$</span> nhỏ nhất từ nhóm thứ ba.</p>
<p>Bài toán bây giờ là, cho <span class="arithmatex">$\frac{p_0}{q_0} &lt; \frac{p_1}{q_1}$</span>, tìm một phân số <span class="arithmatex">$\frac{p}{q}$</span> sao cho <span class="arithmatex">$(q;p)$</span> nhỏ nhất theo thứ tự từ điển và <span class="arithmatex">$\frac{p_0}{q_0} &lt; \frac{p}{q} &lt; \frac{p_1}{q_1}$</span>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:1"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="__tabbed_5_1">Python</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>    <span class="k">def</span><span class="w"> </span><span class="nf">solve</span><span class="p">():</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">())</span>
    <span class="n">C</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span>
    <span class="n">J</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span>
    <span class="c1"># p0/q0 &lt; y/x &lt; p1/q1</span>
    <span class="n">p0</span><span class="p">,</span> <span class="n">q0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    <span class="n">p1</span><span class="p">,</span> <span class="n">q1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span>
    <span class="n">fail</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">J</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">A</span> <span class="o">=</span> <span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">B</span> <span class="o">=</span> <span class="n">J</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">J</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">A</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">B</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">fail</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="n">B</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">A</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># y/x &gt; (-A)/B if B &gt; 0</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">-</span><span class="n">A</span><span class="p">)</span><span class="o">*</span><span class="n">q0</span> <span class="o">&gt;</span> <span class="n">p0</span><span class="o">*</span><span class="n">B</span><span class="p">:</span>
                    <span class="n">p0</span><span class="p">,</span> <span class="n">q0</span> <span class="o">=</span> <span class="o">-</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span>
            <span class="k">elif</span> <span class="n">B</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">A</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># y/x &lt; A/(-B) if B &lt; 0</span>
                <span class="k">if</span> <span class="n">A</span><span class="o">*</span><span class="n">q1</span> <span class="o">&lt;</span> <span class="n">p1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">B</span><span class="p">):</span>
                    <span class="n">p1</span><span class="p">,</span> <span class="n">q1</span> <span class="o">=</span> <span class="n">A</span><span class="p">,</span> <span class="o">-</span><span class="n">B</span>
    <span class="k">if</span> <span class="n">p0</span><span class="o">*</span><span class="n">q1</span> <span class="o">&gt;=</span> <span class="n">p1</span><span class="o">*</span><span class="n">q0</span> <span class="ow">or</span> <span class="n">fail</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;IMPOSSIBLE&#39;</span>

    <span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">middle</span><span class="p">(</span><span class="n">p0</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">q1</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
</details>
<h3 id="calkin-wilf-tree">Cây Calkin-Wilf (Calkin-Wilf tree)<a class="headerlink" href="#calkin-wilf-tree" title="Permanent link">&para;</a></h3>
<p>Một cách đơn giản hơn để tổ chức các liên phân số trong một cây nhị phân là <a href="https://en.wikipedia.org/wiki/Calkin–Wilf_tree">cây Calkin-Wilf</a>.</p>
<p>Cây thường trông như sau:</p>
<figure>
<img src="https://upload.wikimedia.org/wikipedia/commons/8/82/Calkin–Wilf_tree.svg" width="500px"/>
<figcaption><a href="https://commons.wikimedia.org/wiki/File:Calkin–Wilf_tree.svg">Hình ảnh</a> bởi <a href="https://commons.wikimedia.org/wiki/User:Olli_Niemitalo">Olli Niemitalo</a>, <a href="https://commons.wikimedia.org/wiki/User:Proz">Proz</a> được cấp phép theo <a href="https://creativecommons.org/publicdomain/zero/1.0/deed.en">CC0 1.0</a></figcaption>
</figure>

<p>Ở gốc của cây, là số <span class="arithmatex">$\frac{1}{1}$</span>. Sau đó, đối với đỉnh có số <span class="arithmatex">$\frac{p}{q}$</span>, các con của nó là <span class="arithmatex">$\frac{p}{p+q}$</span> và <span class="arithmatex">$\frac{p+q}{q}$</span>.</p>
<p>Không giống như cây Stern-Brocot, cây Calkin-Wilf không phải là cây <em>tìm kiếm</em> nhị phân, vì vậy nó không thể được sử dụng để thực hiện tìm kiếm nhị phân hữu tỷ.</p>
<p>Trong cây Calkin-Wilf, cha trực tiếp của một phân số <span class="arithmatex">$\frac{p}{q}$</span> là <span class="arithmatex">$\frac{p-q}{q}$</span> khi <span class="arithmatex">$p&gt;q$</span> và <span class="arithmatex">$\frac{p}{q-p}$</span> khi ngược lại.</p>
<p>Đối với cây Stern-Brocot, chúng ta đã sử dụng công thức truy hồi cho các giản phân. Để vẽ mối liên hệ giữa liên phân số và cây Calkin-Wilf, chúng ta nên nhớ lại công thức truy hồi cho các thương đầy đủ. Nếu <span class="arithmatex">$s_k = \frac{p}{q}$</span>, thì <span class="arithmatex">$s_{k+1} = \frac{q}{p \mod q} = \frac{q}{p-\lfloor p/q \rfloor \cdot q}$</span>.</p>
<p>Mặt khác, nếu chúng ta liên tục đi từ <span class="arithmatex">$s_k = \frac{p}{q}$</span> đến cha của nó trong cây Calkin-Wilf khi <span class="arithmatex">$p &gt; q$</span>, chúng ta sẽ kết thúc ở <span class="arithmatex">$\frac{p \mod q}{q} = \frac{1}{s_{k+1}}$</span>. Nếu chúng ta tiếp tục làm như vậy, chúng ta sẽ kết thúc ở <span class="arithmatex">$s_{k+2}$</span>, sau đó là <span class="arithmatex">$\frac{1}{s_{k+3}}$</span> và cứ thế. Từ điều này chúng ta có thể suy ra rằng:</p>
<ol>
<li>Khi <span class="arithmatex">$a_0&gt; 0$</span>, cha trực tiếp của <span class="arithmatex">$[a_0; a_1, \dots, a_k]$</span> trong cây Calkin-Wilf là <span class="arithmatex">$\frac{p-q}{q}=[a_0 - 1; a_1, \dots, a_k]$</span>.</li>
<li>Khi <span class="arithmatex">$a_0 = 0$</span> và <span class="arithmatex">$a_1 &gt; 1$</span>, cha trực tiếp của nó là <span class="arithmatex">$\frac{p}{q-p} = [0; a_1 - 1, a_2, \dots, a_k]$</span>.</li>
<li>Và khi <span class="arithmatex">$a_0 = 0$</span> và <span class="arithmatex">$a_1 = 1$</span>, cha trực tiếp của nó là <span class="arithmatex">$\frac{p}{q-p} = [a_2; a_3, \dots, a_k]$</span>.</li>
</ol>
<p>Tương ứng, các con của <span class="arithmatex">$\frac{p}{q} = [a_0; a_1, \dots, a_k]$</span> là</p>
<ol>
<li><span class="arithmatex">$\frac{p+q}{q}=1+\frac{p}{q}$</span>, đó là <span class="arithmatex">$[a_0+1; a_1, \dots, a_k]$</span>,</li>
<li><span class="arithmatex">$\frac{p}{p+q} = \frac{1}{1+\frac{q}{p}}$</span>, đó là <span class="arithmatex">$[0, 1, a_0, a_1, \dots, a_k]$</span> đối với <span class="arithmatex">$a_0 &gt; 0$</span> và <span class="arithmatex">$[0, a_1+1, a_2, \dots, a_k]$</span> đối với <span class="arithmatex">$a_0=0$</span>.</li>
</ol>
<p>Đáng chú ý, nếu chúng ta liệt kê các đỉnh của cây Calkin-Wilf theo thứ tự tìm kiếm theo chiều rộng (tức là, gốc có số <span class="arithmatex">$1$</span>, và các con của đỉnh <span class="arithmatex">$v$</span> có chỉ số <span class="arithmatex">$2v$</span> và <span class="arithmatex">$2v+1$</span> tương ứng), chỉ số của số hữu tỷ trong cây Calkin-Wilf sẽ giống như trong cây Stern-Brocot.</p>
<p>Do đó, các số trên cùng một cấp của cây Stern-Brocot và cây Calkin-Wilf là giống nhau, nhưng thứ tự của chúng khác nhau thông qua <a href="https://en.wikipedia.org/wiki/Bit-reversal_permutation">bit-reversal permutation</a>.</p>
<h2 id="convergence">Sự hội tụ (Convergence)<a class="headerlink" href="#convergence" title="Permanent link">&para;</a></h2>
<p>Đối với số <span class="arithmatex">$r$</span> và giản phân thứ <span class="arithmatex">$k$</span> của nó <span class="arithmatex">$r_k=\frac{p_k}{q_k}$</span> công thức sau đây được áp dụng:</p>
<div class="arithmatex">$$r_k = a_0 + \sum\limits_{i=1}^k \frac{(-1)^{i-1}}{q_i q_{i-1}}.$$</div>
<p>Cụ thể, nó có nghĩa là</p>
<div class="arithmatex">$$r_k - r_{k-1} = \frac{(-1)^{k-1}}{q_k q_{k-1}}$$</div>
<p>và </p>
<div class="arithmatex">$$p_k q_{k-1} - p_{k-1} q_k = (-1)^{k-1}.$$</div>
<p>Từ điều này chúng ta có thể kết luận rằng</p>
<div class="arithmatex">$$\left| r-\frac{p_k}{q_k} \right| \leq \frac{1}{q_{k+1}q_k} \leq \frac{1}{q_k^2}.$$</div>
<p>Bất đẳng thức sau là do thực tế rằng <span class="arithmatex">$r_k$</span> và <span class="arithmatex">$r_{k+1}$</span> thường nằm ở các phía khác nhau của <span class="arithmatex">$r$</span>, do đó</p>
<div class="arithmatex">$$|r-r_k| = |r_k-r_{k+1}|-|r-r_{k+1}| \leq |r_k - r_{k+1}|.$$</div>
<details class="tip">
<summary>Giải thích chi tiết</summary>
<p>Để ước tính <span class="arithmatex">$|r-r_k|$</span>, chúng ta bắt đầu bằng cách ước tính sự khác biệt giữa các giản phân liền kề. Theo định nghĩa,</p>
<div class="arithmatex">$$\frac{p_k}{q_k} - \frac{p_{k-1}}{q_{k-1}} = \frac{p_k q_{k-1} - p_{k-1} q_k}{q_k q_{k-1}}.$$</div>
<p>Thay thế <span class="arithmatex">$p_k$</span> và <span class="arithmatex">$q_k$</span> trong tử số bằng các công thức truy hồi của chúng, chúng ta nhận được</p>
<div class="arithmatex">$$\begin{align} p_k q_{k-1} - p_{k-1} q_k &amp;= (a_k p_{k-1} + p_{k-2}) q_{k-1} - p_{k-1} (a_k q_{k-1} + q_{k-2})
\\&amp;= p_{k-2} q_{k-1} - p_{k-1} q_{k-2},\end{align}$$</div>
<p>do đó tử số của <span class="arithmatex">$r_k - r_{k-1}$</span> luôn là tử số phủ định của <span class="arithmatex">$r_{k-1} - r_{k-2}$</span>. Nó, đến lượt nó, bằng <span class="arithmatex">$1$</span> đối với</p>
<div class="arithmatex">$$r_1 - r_0=\left(a_0+\frac{1}{a_1}\right)-a_0=\frac{1}{a_1},$$</div>
<p>do đó</p>
<div class="arithmatex">$$r_k - r_{k-1} = \frac{(-1)^{k-1}}{q_k q_{k-1}}.$$</div>
<p>Điều này mang lại một biểu diễn thay thế của <span class="arithmatex">$r_k$</span> như một tổng riêng của chuỗi vô hạn:</p>
<div class="arithmatex">$$r_k = (r_k - r_{k-1}) + \dots + (r_1 - r_0) + r_0
= a_0 + \sum\limits_{i=1}^k \frac{(-1)^{i-1}}{q_i q_{i-1}}.$$</div>
<p>Từ quan hệ truy hồi suy ra rằng <span class="arithmatex">$q_k$</span> tăng đơn điệu nhanh ít nhất như số Fibonacci, do đó</p>
<div class="arithmatex">$$r = \lim\limits_{k \to \infty} r_k = a_0 + \sum\limits_{i=1}^\infty \frac{(-1)^{i-1}}{q_i q_{i-1}}$$</div>
<p>luôn được xác định rõ, vì chuỗi cơ bản luôn hội tụ. Đáng chú ý, chuỗi dư</p>
<div class="arithmatex">$$r-r_k = \sum\limits_{i=k+1}^\infty \frac{(-1)^{i-1}}{q_i q_{i-1}}$$</div>
<p>có cùng dấu với <span class="arithmatex">$(-1)^k$</span> do tốc độ <span class="arithmatex">$q_i q_{i-1}$</span> giảm. Do đó các <span class="arithmatex">$r_k$</span> có chỉ số chẵn tiến tới <span class="arithmatex">$r$</span> từ phía dưới trong khi các <span class="arithmatex">$r_k$</span> có chỉ số lẻ tiến tới nó từ phía trên:</p>
<p><figure><img src="https://upload.wikimedia.org/wikipedia/commons/b/b4/Golden_ration_convergents.svg" width="600px"/>
<figcaption><em>Các giản phân của <span class="arithmatex">$r=\phi = \frac{1+\sqrt{5}}{2}=[1;1,1,\dots]$</span> và khoảng cách của chúng tới <span class="arithmatex">$r$</span>.</em></figcaption></figure></p>
<p>Từ hình này chúng ta có thể thấy rằng</p>
<div class="arithmatex">$$|r-r_k| = |r_k - r_{k+1}| - |r-r_{k+1}| \leq |r_k - r_{k+1}|,$$</div>
<p>do đó khoảng cách giữa <span class="arithmatex">$r$</span> và <span class="arithmatex">$r_k$</span> không bao giờ lớn hơn khoảng cách giữa <span class="arithmatex">$r_k$</span> và <span class="arithmatex">$r_{k+1}$</span>:</p>
<div class="arithmatex">$$\left|r-\frac{p_k}{q_k}\right| \leq \frac{1}{q_k q_{k+1}} \leq \frac{1}{q_k^2}.$$</div>
</details>
<div class="admonition example">
<p class="admonition-title">Euclid mở rộng?</p>
<p>Bạn được cho <span class="arithmatex">$A, B, C \in \mathbb Z$</span>. Tìm <span class="arithmatex">$x, y \in \mathbb Z$</span> sao cho <span class="arithmatex">$Ax + By = C$</span>.</p>
</div>
<details class="hint">
<summary>Lời giải</summary>
<p>Mặc dù bài toán này thường được giải bằng <a href="extended-euclid-algorithm.html">thuật toán Euclid mở rộng</a>, có một giải pháp đơn giản và trực tiếp với liên phân số.</p>
<p>Cho <span class="arithmatex">$\frac{A}{B}=[a_0; a_1, \dots, a_k]$</span>. Đã được chứng minh ở trên rằng <span class="arithmatex">$p_k q_{k-1} - p_{k-1} q_k = (-1)^{k-1}$</span>. Thay thế <span class="arithmatex">$p_k$</span> và <span class="arithmatex">$q_k$</span> bằng <span class="arithmatex">$A$</span> và <span class="arithmatex">$B$</span>, chúng ta nhận được</p>
<div class="arithmatex">$$Aq_{k-1} - Bp_{k-1} = (-1)^{k-1} g,$$</div>
<p>trong đó <span class="arithmatex">$g = \gcd(A, B)$</span>. Nếu <span class="arithmatex">$C$</span> chia hết cho <span class="arithmatex">$g$</span>, thì nghiệm là <span class="arithmatex">$x = (-1)^{k-1}\frac{C}{g} q_{k-1}$</span> và <span class="arithmatex">$y = (-1)^{k}\frac{C}{g} p_{k-1}$</span>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:1"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="__tabbed_6_1">Python</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># return (x, y) such that Ax+By=C</span>
<span class="c1"># assumes that such (x, y) exists</span>
<span class="k">def</span><span class="w"> </span><span class="nf">dio</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">):</span>
    <span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">convergents</span><span class="p">(</span><span class="n">fraction</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">))</span>
    <span class="n">C</span> <span class="o">//=</span> <span class="n">A</span> <span class="o">//</span> <span class="n">p</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># divide by gcd(A, B)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="k">else</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">t</span><span class="o">*</span><span class="n">C</span><span class="o">*</span><span class="n">q</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="o">-</span><span class="n">t</span><span class="o">*</span><span class="n">C</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
</code></pre></div>
</div>
</div>
</div>
</details>
<h2 id="linear-fractional-transformations">Biến đổi phân tuyến tính (Linear fractional transformations)<a class="headerlink" href="#linear-fractional-transformations" title="Permanent link">&para;</a></h2>
<p>Một khái niệm quan trọng khác đối với liên phân số là cái gọi là <a href="https://en.wikipedia.org/wiki/Linear_fractional_transformation">biến đổi phân tuyến tính</a>.</p>
<div class="admonition info">
<p class="admonition-title">Định nghĩa</p>
<p>Một <strong>biến đổi phân tuyến tính</strong> là một hàm <span class="arithmatex">$f : \mathbb R \to \mathbb R$</span> sao cho <span class="arithmatex">$f(x) = \frac{ax+b}{cx+d}$</span> với một số <span class="arithmatex">$a,b,c,d \in \mathbb R$</span>.</p>
</div>
<p>Một hợp thành <span class="arithmatex">$(L_0 \circ L_1)(x) = L_0(L_1(x))$</span> của các biến đổi phân tuyến tính <span class="arithmatex">$L_0(x)=\frac{a_0 x + b_0}{c_0 x + d_0}$</span> và <span class="arithmatex">$L_1(x)=\frac{a_1 x + b_1}{c_1 x + d_1}$</span> chính nó là một biến đổi phân tuyến tính:</p>
<div class="arithmatex">$$\frac{a_0\frac{a_1 x + b_1}{c_1 x + d_1} + b_0}{c_0 \frac{a_1 x + b_1}{c_1 x + d_1} + d_0} = \frac{a_0(a_1 x + b_1) + b_0 (c_1 x + d_1)}{c_0 (a_1 x + b_1) + d_0 (c_1 x + d_1)} = \frac{(a_0 a_1 + b_0 c_1) x + (a_0 b_1 + b_0 d_1)}{(c_0 a_1 + d_0 c_1) x + (c_0 b_1 + d_0 d_1)}.$$</div>
<p>Nghịch đảo của một biến đổi phân tuyến tính, cũng là một biến đổi phân tuyến tính:</p>
<div class="arithmatex">$$y = \frac{ax+b}{cx+d} \iff y(cx+d) = ax + b \iff x = -\frac{dy-b}{cy-a}.$$</div>
<div class="admonition example">
<p class="admonition-title"><a href="https://dmoj.ca/problem/dmopc19c7p4">DMOPC '19 Contest 7 P4 - Bob and Continued Fractions</a></p>
<p>Bạn được cho một mảng các số nguyên dương <span class="arithmatex">$a_1, \dots, a_n$</span>. Bạn cần trả lời <span class="arithmatex">$m$</span> truy vấn. Mỗi truy vấn là để tính <span class="arithmatex">$[a_l; a_{l+1}, \dots, a_r]$</span>.</p>
</div>
<details class="hint">
<summary>Lời giải</summary>
<p>Chúng ta có thể giải quyết vấn đề này với segment tree nếu chúng ta có thể nối các liên phân số.</p>
<p>Một điều thường đúng là <span class="arithmatex">$[a_0; a_1, \dots, a_k, b_0, b_1, \dots, b_k] = [a_0; a_1, \dots, a_k, [b_1; b_2, \dots, b_k]]$</span>.</p>
<p>Hãy ký hiệu <span class="arithmatex">$L_{k}(x) = [a_k; x] = a_k + \frac{1}{x} = \frac{a_k\cdot x+1}{1\cdot x + 0}$</span>. Lưu ý rằng <span class="arithmatex">$L_k(\infty) = a_k$</span>. Trong ký hiệu này, điều sau đúng</p>
<div class="arithmatex">$$[a_0; a_1, \dots, a_k, x] = [a_0; [a_1; [\dots; [a_k; x]]]] = (L_0 \circ L_1 \circ \dots \circ L_k)(x) = \frac{p_k x + p_{k-1}}{q_k x + q_{k-1}}.$$</div>
<p>Do đó, bài toán quy về việc tính toán</p>
<div class="arithmatex">$$(L_l \circ L_{l+1} \circ \dots \circ L_r)(\infty).$$</div>
<p>Hợp thành của các biến đổi có tính kết hợp, vì vậy có thể tính toán trong mỗi nút của segment tree hợp thành của các biến đổi trong cây con của nó.</p>
</details>
<div class="admonition example">
<p class="admonition-title">Biến đổi phân tuyến tính của một liên phân số</p>
<p>Cho <span class="arithmatex">$L(x) = \frac{ax+b}{cx+d}$</span>. Tính biểu diễn liên phân số <span class="arithmatex">$[b_0; b_1, \dots, b_m]$</span> của <span class="arithmatex">$L(A)$</span> đối với <span class="arithmatex">$A=[a_0; a_1, \dots, a_n]$</span>.</p>
<p><em>Điều này cho phép tính <span class="arithmatex">$A + \frac{p}{q} = \frac{qA + p}{q}$</span> và <span class="arithmatex">$A \cdot \frac{p}{q} = \frac{p A}{q}$</span> với bất kỳ <span class="arithmatex">$\frac{p}{q}$</span>.</em></p>
</div>
<details class="hint">
<summary>Lời giải</summary>
<p>Như chúng ta đã lưu ý ở trên, <span class="arithmatex">$[a_0; a_1, \dots, a_k] = (L_{a_0} \circ L_{a_1} \circ \dots \circ L_{a_k})(\infty)$</span>, do đó <span class="arithmatex">$L([a_0; a_1, \dots, a_k]) = (L \circ L_{a_0} \circ L_{a_1} \circ \dots L_{a_k})(\infty)$</span>.</p>
<p>Vì vậy, bằng cách thêm <span class="arithmatex">$L_{a_0}$</span>, <span class="arithmatex">$L_{a_1}$</span> và vân vân một cách tuần tự, chúng ta sẽ có thể tính</p>
<div class="arithmatex">$$(L \circ L_{a_0} \circ \dots \circ L_{a_k})(x) = L\left(\frac{p_k x + p_{k-1}}{q_k x + q_{k-1}}\right)=\frac{a_k x + b_k}{c_k x + d_k}.$$</div>
<p>Vì <span class="arithmatex">$L(x)$</span> khả nghịch, nó cũng đơn điệu trong <span class="arithmatex">$x$</span>. Do đó, với bất kỳ <span class="arithmatex">$x \geq 0$</span> điều sau đúng <span class="arithmatex">$L(\frac{p_k x + p_{k-1}}{q_k x + q_{k-1}})$</span> nằm giữa <span class="arithmatex">$L(\frac{p_k}{q_k}) = \frac{a_k}{c_k}$</span> và <span class="arithmatex">$L(\frac{p_{k-1}}{q_{k-1}}) = \frac{b_k}{d_k}$</span>.</p>
<p>Hơn nữa, đối với <span class="arithmatex">$x=[a_{k+1}; \dots, a_n]$</span> nó bằng với <span class="arithmatex">$L(A)$</span>. Do đó, <span class="arithmatex">$b_0 = \lfloor L(A) \rfloor$</span> nằm giữa <span class="arithmatex">$\lfloor L(\frac{p_k}{q_k}) \rfloor$</span> và <span class="arithmatex">$\lfloor L(\frac{p_{k-1}}{q_{k-1}}) \rfloor$</span>. Khi chúng bằng nhau, chúng cũng bằng <span class="arithmatex">$b_0$</span>.</p>
<p>Lưu ý rằng <span class="arithmatex">$L(A) = (L_{b_0} \circ L_{b_1} \circ \dots \circ L_{b_m})(\infty)$</span>. Biết <span class="arithmatex">$b_0$</span>, chúng ta có thể hợp thành <span class="arithmatex">$L_{b_0}^{-1}$</span> với biến đổi hiện tại và tiếp tục thêm <span class="arithmatex">$L_{a_{k+1}}$</span>, <span class="arithmatex">$L_{a_{k+2}}$</span> và cứ thế, tìm kiếm các sàn (floors) mới để đồng ý, từ đó chúng ta sẽ có thể suy ra <span class="arithmatex">$b_1$</span> và cứ thế cho đến khi chúng ta khôi phục tất cả các giá trị của <span class="arithmatex">$[b_0; b_1, \dots, b_m]$</span>.</p>
</details>
<div class="admonition example">
<p class="admonition-title">Số học liên phân số</p>
<p>Cho <span class="arithmatex">$A=[a_0; a_1, \dots, a_n]$</span> và <span class="arithmatex">$B=[b_0; b_1, \dots, b_m]$</span>. Tính biểu diễn liên phân số của <span class="arithmatex">$A+B$</span> và <span class="arithmatex">$A \cdot B$</span>.</p>
</div>
<details class="hint">
<summary>Lời giải</summary>
<p>Ý tưởng ở đây tương tự như bài toán trước, nhưng thay vì <span class="arithmatex">$L(x) = \frac{ax+b}{cx+d}$</span> bạn nên xem xét biến đổi phân tuyến tính song tuyến (bilinear) <span class="arithmatex">$L(x, y) = \frac{axy+bx+cy+d}{exy+fx+gy+h}$</span>.</p>
<p>Thay vì <span class="arithmatex">$L(x) \mapsto L(L_{a_k}(x))$</span> bạn sẽ thay đổi biến đổi hiện tại của mình thành <span class="arithmatex">$L(x, y) \mapsto L(L_{a_k}(x), y)$</span> hoặc <span class="arithmatex">$L(x, y) \mapsto L(x, L_{b_k}(y))$</span>.</p>
<p>Sau đó, bạn kiểm tra xem nếu <span class="arithmatex">$\lfloor \frac{a}{e} \rfloor = \lfloor \frac{b}{f} \rfloor = \lfloor \frac{c}{g} \rfloor = \lfloor \frac{d}{h} \rfloor$</span> và nếu tất cả chúng đều đồng ý, bạn sử dụng giá trị này làm <span class="arithmatex">$c_k$</span> trong phân số kết quả và thay đổi biến đổi thành</p>
<div class="arithmatex">$$L(x, y) \mapsto \frac{1}{L(x, y) - c_k}.$$</div>
</details>
<div class="admonition info">
<p class="admonition-title">Định nghĩa</p>
<p>Một liên phân số <span class="arithmatex">$x = [a_0; a_1, \dots]$</span> được gọi là <strong>tuần hoàn</strong> nếu <span class="arithmatex">$x = [a_0; a_1, \dots, a_k, x]$</span> với một số <span class="arithmatex">$k$</span>.</p>
<p>Một liên phân số <span class="arithmatex">$x = [a_0; a_1, \dots]$</span> được gọi là <strong>tuần hoàn cuối cùng</strong> (eventually periodic) nếu <span class="arithmatex">$x = [a_0; a_1, \dots, a_k, y]$</span>, trong đó <span class="arithmatex">$y$</span> là tuần hoàn.</p>
</div>
<p>Đối với <span class="arithmatex">$x = [1; 1, 1, \dots]$</span> ta có <span class="arithmatex">$x = 1 + \frac{1}{x}$</span>, do đó <span class="arithmatex">$x^2 = x + 1$</span>. Có một mối liên hệ chung giữa các liên phân số tuần hoàn và phương trình bậc hai. Xem xét phương trình sau:</p>
<div class="arithmatex">$$ x = [a_0; a_1, \dots, a_k, x].$$</div>
<p>Một mặt, phương trình này có nghĩa là biểu diễn liên phân số của <span class="arithmatex">$x$</span> là tuần hoàn với chu kỳ <span class="arithmatex">$k+1$</span>.</p>
<p>Mặt khác, sử dụng công thức cho các giản phân, phương trình này có nghĩa là</p>
<div class="arithmatex">$$x = \frac{p_k x + p_{k-1}}{q_k x + q_{k-1}}.$$</div>
<p>Nghĩa là, <span class="arithmatex">$x$</span> là một biến đổi phân tuyến tính của chính nó. Từ phương trình suy ra rằng <span class="arithmatex">$x$</span> là nghiệm của phương trình bậc hai:</p>
<div class="arithmatex">$$q_k x^2 + (q_{k-1}-p_k)x - p_{k-1} = 0.$$</div>
<p>Lý luận tương tự cũng đúng cho các liên phân số tuần hoàn cuối cùng, nghĩa là <span class="arithmatex">$x = [a_0; a_1, \dots, a_k, y]$</span> đối với <span class="arithmatex">$y=[b_0; b_1, \dots, b_k, y]$</span>. Thật vậy, từ phương trình đầu tiên ta suy ra rằng <span class="arithmatex">$x = L_0(y)$</span> và từ phương trình thứ hai là <span class="arithmatex">$y = L_1(y)$</span>, trong đó <span class="arithmatex">$L_0$</span> và <span class="arithmatex">$L_1$</span> là các biến đổi phân tuyến tính. Do đó,</p>
<div class="arithmatex">$$x = (L_0 \circ L_1)(y) = (L_0 \circ L_1 \circ L_0^{-1})(x).$$</div>
<p>Người ta có thể chứng minh thêm (và điều đó lần đầu tiên được thực hiện bởi Lagrange) rằng đối với bất kỳ phương trình bậc hai <span class="arithmatex">$ax^2+bx+c=0$</span> nào với các hệ số nguyên, nghiệm <span class="arithmatex">$x$</span> của nó là một liên phân số tuần hoàn cuối cùng.</p>
<div class="admonition example">
<p class="admonition-title">Số vô tỷ bậc hai</p>
<p>Tìm liên phân số của <span class="arithmatex">$\alpha = \frac{x+y\sqrt{n}}{z}$</span> trong đó <span class="arithmatex">$x, y, z, n \in \mathbb Z$</span> và <span class="arithmatex">$n &gt; 0$</span> không phải là một số chính phương.</p>
</div>
<details class="hint">
<summary>Lời giải</summary>
<p>Đối với thương đầy đủ thứ <span class="arithmatex">$k$</span> là <span class="arithmatex">$s_k$</span> của số đó, điều chung sau đây đúng</p>
<div class="arithmatex">$$\alpha = [a_0; a_1, \dots, a_{k-1}, s_k] = \frac{s_k p_{k-1} + p_{k-2}}{s_k q_{k-1} + q_{k-2}}.$$</div>
<p>Do đó, </p>
<div class="arithmatex">$$s_k = -\frac{\alpha q_{k-1} - p_{k-1}}{\alpha q_k - p_k} = -\frac{q_{k-1} y \sqrt n + (x q_{k-1} - z p_{k-1})}{q_k y \sqrt n + (xq_k-zp_k)}.$$</div>
<p>Nhân tử số và mẫu số với <span class="arithmatex">$(xq_k - zp_k) - q_k y \sqrt n$</span>, chúng ta sẽ loại bỏ <span class="arithmatex">$\sqrt n$</span> ở mẫu số, do đó các thương đầy đủ có dạng</p>
<div class="arithmatex">$$s_k = \frac{x_k + y_k \sqrt n}{z_k}.$$</div>
<p>Hãy tìm <span class="arithmatex">$s_{k+1}$</span>, giả sử rằng <span class="arithmatex">$s_k$</span> đã biết.</p>
<p>Đầu tiên, <span class="arithmatex">$a_k = \lfloor s_k \rfloor = \left\lfloor \frac{x_k + y_k \lfloor \sqrt n \rfloor}{z_k} \right\rfloor$</span>. Sau đó,</p>
<div class="arithmatex">$$s_{k+1} = \frac{1}{s_k-a_k} = \frac{z_k}{(x_k - z_k a_k) + y_k \sqrt n} = \frac{z_k (x_k - y_k a_k) - y_k z_k \sqrt n}{(x_k - y_k a_k)^2 - y_k^2 n}.$$</div>
<p>Do đó, nếu chúng ta ký hiệu <span class="arithmatex">$t_k = x_k - y_k a_k$</span>, điều sau sẽ đúng</p>
<div class="arithmatex">$$\begin{align}x_{k+1} &amp;=&amp; z_k t_k, \\ y_{k+1} &amp;=&amp; -y_k z_k, \\ z_{k+1} &amp;=&amp; t_k^2 - y_k^2 n.\end{align}$$</div>
<p>Điều tuyệt vời về biểu diễn như vậy là nếu chúng ta rút gọn <span class="arithmatex">$x_{k+1}, y_{k+1}, z_{k+1}$</span> bằng ước chung lớn nhất của chúng, kết quả sẽ là duy nhất. Do đó, chúng ta có thể sử dụng nó để kiểm tra xem trạng thái hiện tại đã được lặp lại chưa và cũng để kiểm tra chỉ số trước đó có trạng thái này ở đâu.</p>
<p>Dưới đây là mã để tính toán biểu diễn liên phân số cho <span class="arithmatex">$\alpha = \sqrt n$</span>:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="7:1"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="__tabbed_7_1">Python</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># compute the continued fraction of sqrt(n)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">n0</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    <span class="n">a</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">step</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="n">a</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x</span> <span class="o">*</span> <span class="n">n0</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span> <span class="o">//</span> <span class="n">z</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">z</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="o">-</span><span class="n">z</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="o">*</span><span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">n</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">x</span> <span class="o">//</span> <span class="n">g</span><span class="p">,</span> <span class="n">y</span> <span class="o">//</span> <span class="n">g</span><span class="p">,</span> <span class="n">z</span> <span class="o">//</span> <span class="n">g</span>

    <span class="n">used</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">used</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">step</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span> <span class="ow">in</span> <span class="n">used</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">a</span>
</code></pre></div>
</div>
</div>
</div>
<p>Sử dụng cùng hàm <code>step</code> nhưng khác <span class="arithmatex">$x$</span>, <span class="arithmatex">$y$</span> và <span class="arithmatex">$z$</span> ban đầu, có thể tính toán nó cho <span class="arithmatex">$\frac{x+y \sqrt{n}}{z}$</span> bất kỳ.</p>
</details>
<div class="admonition example">
<p class="admonition-title"><a href="https://timus.online/problem.aspx?space=1&amp;num=1814">Tavrida NU Akai Contest - Continued Fraction</a></p>
<p>Bạn được cho <span class="arithmatex">$x$</span> và <span class="arithmatex">$k$</span>, <span class="arithmatex">$x$</span> không phải là số chính phương. Gọi <span class="arithmatex">$\sqrt x = [a_0; a_1, \dots]$</span>, tìm <span class="arithmatex">$\frac{p_k}{q_k}=[a_0; a_1, \dots, a_k]$</span> với <span class="arithmatex">$0 \leq k \leq 10^9$</span>.</p>
</div>
<details class="hint">
<summary>Lời giải</summary>
<p>Sau khi tính chu kỳ của <span class="arithmatex">$\sqrt x$</span>, có thể tính <span class="arithmatex">$a_k$</span> bằng lũy thừa nhị phân trên biến đổi phân tuyến tính được tạo ra bởi biểu diễn liên phân số. Để tìm biến đổi kết quả, bạn nén chu kỳ có kích thước <span class="arithmatex">$T$</span> thành một biến đổi duy nhất và lặp lại nó <span class="arithmatex">$\lfloor \frac{k-1}{T}\rfloor$</span> lần, sau đó bạn kết hợp nó thủ công với các biến đổi còn lại.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="8:1"><input checked="checked" id="__tabbed_8_1" name="__tabbed_8" type="radio" /><div class="tabbed-labels"><label for="__tabbed_8_1">Python</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">x</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>

<span class="n">mod</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="mi">9</span><span class="o">+</span><span class="mi">7</span>

<span class="c1"># compose (A[0]*x + A[1]) / (A[2]*x + A[3]) and (B[0]*x + B[1]) / (B[2]*x + B[3])</span>
<span class="k">def</span><span class="w"> </span><span class="nf">combine</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">t</span> <span class="o">%</span> <span class="n">mod</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="p">[</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">B</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">B</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">B</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">B</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">B</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">A</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">B</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">B</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">A</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">B</span><span class="p">[</span><span class="mi">3</span><span class="p">]]]</span>

<span class="n">A</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="c1"># (x + 0) / (0*x + 1) = x</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">T</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="c1"># period of a</span>

<span class="c1"># apply ak + 1/x = (ak*x+1)/(1x+0) to (Ax + B) / (Cx + D)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">))):</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">combine</span><span class="p">([</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">A</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">bpow</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">n</span> <span class="k">else</span> <span class="n">combine</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">bpow</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="k">else</span> <span class="n">bpow</span><span class="p">(</span><span class="n">combine</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">A</span><span class="p">),</span> <span class="n">n</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>


<span class="n">C</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="c1"># = 1 / 0</span>
<span class="k">while</span> <span class="n">k</span> <span class="o">%</span> <span class="n">T</span><span class="p">:</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">k</span> <span class="o">%</span> <span class="n">T</span>
    <span class="n">C</span> <span class="o">=</span> <span class="n">combine</span><span class="p">([</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">C</span><span class="p">)</span>
    <span class="n">k</span> <span class="o">-=</span> <span class="mi">1</span>

<span class="n">C</span> <span class="o">=</span> <span class="n">combine</span><span class="p">(</span><span class="n">bpow</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">k</span> <span class="o">//</span> <span class="n">T</span><span class="p">),</span> <span class="n">C</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">combine</span><span class="p">([</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">C</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">C</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">C</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
</code></pre></div>
</div>
</div>
</div>
</details>
<h2 id="geometric-interpretation">Ý nghĩa hình học (Geometric interpretation)<a class="headerlink" href="#geometric-interpretation" title="Permanent link">&para;</a></h2>
<p>Gọi <span class="arithmatex">$\vec r_k = (q_k;p_k)$</span> đối với giản phân <span class="arithmatex">$r_k = \frac{p_k}{q_k}$</span>. Khi đó, công thức truy hồi sau được áp dụng:</p>
<div class="arithmatex">$$\vec r_k = a_k \vec r_{k-1} + \vec r_{k-2}.$$</div>
<p>Gọi <span class="arithmatex">$\vec r = (1;r)$</span>. Khi đó, mỗi vectơ <span class="arithmatex">$(x;y)$</span> tương ứng với số bằng hệ số góc của nó <span class="arithmatex">$\frac{y}{x}$</span>.</p>
<p>Với khái niệm <a href="../geometry/basic-geometry.html">tích giả vô hướng</a> (pseudoscalar product) <span class="arithmatex">$(x_1;y_1) \times (x_2;y_2) = x_1 y_2 - x_2 y_1$</span>, có thể chứng minh (xem giải thích bên dưới) rằng</p>
<div class="arithmatex">$$s_k = -\frac{\vec r_{k-2} \times \vec r}{\vec r_{k-1} \times \vec r} = \left|\frac{\vec r_{k-2} \times \vec r}{\vec r_{k-1} \times \vec r}\right|.$$</div>
<p>Phương trình cuối cùng là do thực tế rằng <span class="arithmatex">$r_{k-1}$</span> và <span class="arithmatex">$r_{k-2}$</span> nằm ở các phía khác nhau của <span class="arithmatex">$r$</span>, do đó các tích giả vô hướng của <span class="arithmatex">$\vec r_{k-1}$</span> và <span class="arithmatex">$\vec r_{k-2}$</span> với <span class="arithmatex">$\vec r$</span> có dấu phân biệt. Với <span class="arithmatex">$a_k = \lfloor s_k \rfloor$</span> trong tâm trí, công thức cho <span class="arithmatex">$\vec r_k$</span> bây giờ trông như</p>
<div class="arithmatex">$$\vec r_k = \vec r_{k-2} + \left\lfloor \left| \frac{\vec r \times \vec r_{k-2}}{\vec r \times \vec r_{k-1}}\right|\right\rfloor \vec r_{k-1}.$$</div>
<p>Lưu ý rằng <span class="arithmatex">$\vec r_k \times r = (q;p) \times (1;r) = qr - p$</span>, do đó</p>
<div class="arithmatex">$$a_k = \left\lfloor \left| \frac{q_{k-1}r-p_{k-1}}{q_{k-2}r-p_{k-2}} \right| \right\rfloor.$$</div>
<details class="hint">
<summary>Giải thích</summary>
<p>Như chúng ta đã lưu ý, <span class="arithmatex">$a_k = \lfloor s_k \rfloor$</span>, trong đó <span class="arithmatex">$s_k = [a_k; a_{k+1}, a_{k+2}, \dots]$</span>. Mặt khác, từ truy hồi giản phân chúng ta suy ra rằng</p>
<div class="arithmatex">$$r = [a_0; a_1, \dots, a_{k-1}, s_k] = \frac{s_k p_{k-1} + p_{k-2}}{s_k q_{k-1} + q_{k-2}}.$$</div>
<p>Ở dạng vectơ, nó viết lại thành</p>
<div class="arithmatex">$$\vec r \parallel s_k \vec r_{k-1} + \vec r_{k-2},$$</div>
<p>có nghĩa là <span class="arithmatex">$\vec r$</span> và <span class="arithmatex">$s_k \vec r_{k-1} + \vec r_{k-2}$</span> cùng phương (tức là, có cùng hệ số góc). Lấy <a href="../geometry/basic-geometry.html">tích giả vô hướng</a> của cả hai phần với <span class="arithmatex">$\vec r$</span>, chúng ta nhận được</p>
<div class="arithmatex">$$0 = s_k (\vec r_{k-1} \times \vec r) + (\vec r_{k-2} \times \vec r),$$</div>
<p>mang lại công thức cuối cùng</p>
<div class="arithmatex">$$s_k = -\frac{\vec r_{k-2} \times \vec r}{\vec r_{k-1} \times \vec r}.$$</div>
</details>
<div class="admonition example">
<p class="admonition-title">Thuật toán kéo mũi (Nose stretching algorithm)</p>
<p>Mỗi lần bạn thêm <span class="arithmatex">$\vec r_{k-1}$</span> vào vectơ <span class="arithmatex">$\vec p$</span>, giá trị của <span class="arithmatex">$\vec p \times \vec r$</span> tăng thêm <span class="arithmatex">$\vec r_{k-1} \times \vec r$</span>.</p>
<p>Do đó, <span class="arithmatex">$a_k=\lfloor s_k \rfloor$</span> là số nguyên tối đa các vectơ <span class="arithmatex">$\vec r_{k-1}$</span> có thể được thêm vào <span class="arithmatex">$\vec r_{k-2}$</span> mà không thay đổi dấu của tích chéo với <span class="arithmatex">$\vec r$</span>.</p>
<p>Nói cách khác, <span class="arithmatex">$a_k$</span> là số lần nguyên tối đa bạn có thể thêm <span class="arithmatex">$\vec r_{k-1}$</span> vào <span class="arithmatex">$\vec r_{k-2}$</span> mà không cắt qua đường thẳng được xác định bởi <span class="arithmatex">$\vec r$</span>:</p>
<p><figure><img src="https://upload.wikimedia.org/wikipedia/commons/9/92/Continued_convergents_geometry.svg" width="700px"/>
<figcaption><em>Các giản phân của <span class="arithmatex">$r=\frac{7}{9}=[0;1,3,2]$</span>. Các bán giản phân tương ứng với các điểm trung gian giữa các mũi tên màu xám.</em></figcaption></figure></p>
<p>Trong hình trên, <span class="arithmatex">$\vec r_2 = (4;3)$</span> thu được bằng cách lặp lại việc thêm <span class="arithmatex">$\vec r_1 = (1;1)$</span> vào <span class="arithmatex">$\vec r_0 = (1;0)$</span>.</p>
<p>Khi không thể thêm <span class="arithmatex">$\vec r_1$</span> vào <span class="arithmatex">$\vec r_0$</span> nữa mà không cắt qua đường thẳng <span class="arithmatex">$y=rx$</span>, chúng ta đi sang phía bên kia và lặp lại việc thêm <span class="arithmatex">$\vec r_2$</span> vào <span class="arithmatex">$\vec r_1$</span> để thu được <span class="arithmatex">$\vec r_3 = (9;7)$</span>.</p>
<p>Quy trình này tạo ra các vectơ dài hơn theo cấp số nhân, tiếp cận đường thẳng.</p>
<p>Vì tính chất này, quy trình tạo ra các vectơ giản phân tiếp theo được Boris Delaunay đặt tên là <strong>thuật toán kéo mũi</strong> (nose stretching algorithm).</p>
</div>
<p>Nếu chúng ta nhìn vào tam giác được vẽ trên các điểm <span class="arithmatex">$\vec r_{k-2}$</span>, <span class="arithmatex">$\vec r_{k}$</span> và <span class="arithmatex">$\vec 0$</span> chúng ta sẽ nhận thấy rằng diện tích gấp đôi của nó là</p>
<div class="arithmatex">$$|\vec r_{k-2} \times \vec r_k| = |\vec r_{k-2} \times (\vec r_{k-2} + a_k \vec r_{k-1})| = a_k |\vec r_{k-2} \times \vec r_{k-1}| = a_k.$$</div>
<p>Kết hợp với <a href="../geometry/picks-theorem.html">Định lý Pick</a>, điều đó có nghĩa là không có điểm lưới nào nằm hoàn toàn bên trong tam giác và các điểm lưới duy nhất trên biên của nó là <span class="arithmatex">$\vec 0$</span> và <span class="arithmatex">$\vec r_{k-2} + t \cdot \vec r_{k-1}$</span> cho tất cả số nguyên <span class="arithmatex">$t$</span> sao cho <span class="arithmatex">$0 \leq t \leq a_k$</span>. Khi được nối lại cho tất cả các <span class="arithmatex">$k$</span> có thể, điều đó có nghĩa là không có điểm nguyên nào trong không gian giữa các đa giác được tạo bởi các vectơ giản phân có chỉ số chẵn và lẻ.</p>
                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      

<footer class="md-footer">
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Text is available under the <a href="https://github.com/deanqkhanhcoder/cp-algorithms-vi/blob/main/LICENSE">Creative Commons Attribution Share Alike 4.0 International</a> License<br/>Copyright &copy; 2014 - 2025 by <a href="https://github.com/deanqkhanhcoder/cp-algorithms-vi/graphs/contributors">cp-algorithms contributors</a>
          </div>
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
<div class="md-social">
  
</div>
    </div>
  </div>
</footer>

    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["navigation.top", "navigation.tracking", "toc.follow", "toc.integrate", "search.suggest", "content.code.copy"], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../javascript/config.js"></script>
      
        <script src="../javascript/donation-banner.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>